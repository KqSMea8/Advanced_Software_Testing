<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:46:24 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-667/HBASE-667.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-667] Hung regionserver; hung on hdfs: writeChunk, DFSClient.java:2126, DataStreamer socketWrite</title>
                <link>https://issues.apache.org/jira/browse/HBASE-667</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Internally, came across a hung regionserver.  Here is relevant excerpt from thread dump:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;ResponseProcessor &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; block blk_-6991279486194843565&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab3ac13c50 nid=0x7ad7 runnable [0x0000000043080000..0x0000000043080d00]
        at java.net.SocketInputStream.socketRead0(Native Method)
        at java.net.SocketInputStream.read(Unknown Source)
        at java.io.DataInputStream.readFully(Unknown Source)
        at java.io.DataInputStream.readLong(Unknown Source)
        at org.apache.hadoop.dfs.DFSClient$DFSOutputStream$ResponseProcessor.run(DFSClient.java:1734)

...

&lt;span class=&quot;code-quote&quot;&gt;&quot;IPC Server handler 3 on 60020&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab3c05abf0 nid=0x6b61 waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; monitor entry [0x0000000042878000..0x0000000042878d00]
        at org.apache.hadoop.hbase.HLog.append(HLog.java:371)
        - waiting to lock &amp;lt;0x00002aaab69d1180&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
        at org.apache.hadoop.hbase.HRegion.update(HRegion.java:1629)
        at org.apache.hadoop.hbase.HRegion.batchUpdate(HRegion.java:1432)
        at org.apache.hadoop.hbase.HRegionServer.batchUpdate(HRegionServer.java:1552)
        at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.apache.hadoop.hbase.ipc.HbaseRPC$Server.call(HbaseRPC.java:413)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:901)

.....

&lt;span class=&quot;code-quote&quot;&gt;&quot;IPC Server handler 1 on 60020&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab3c3220a0 nid=0x6b5f waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; monitor entry [0x0000000042676000..0x0000000042676c00]
        at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.writeChunk(DFSClient.java:2126)
        - waiting to lock &amp;lt;0x00002aaab69d1a28&amp;gt; (a java.util.LinkedList)
        at org.apache.hadoop.fs.FSOutputSummer.writeChecksumChunk(FSOutputSummer.java:141)
        at org.apache.hadoop.fs.FSOutputSummer.write1(FSOutputSummer.java:100)
        at org.apache.hadoop.fs.FSOutputSummer.write(FSOutputSummer.java:86)
        - locked &amp;lt;0x00002aaab69d15b0&amp;gt; (a org.apache.hadoop.dfs.DFSClient$DFSOutputStream)
        at org.apache.hadoop.fs.FSDataOutputStream$PositionCache.write(FSDataOutputStream.java:41)
        at java.io.DataOutputStream.write(Unknown Source)
        - locked &amp;lt;0x00002aaab69d1228&amp;gt; (a org.apache.hadoop.fs.FSDataOutputStream)
        at org.apache.hadoop.io.SequenceFile$Writer.append(SequenceFile.java:990)
        - locked &amp;lt;0x00002aaab69d1050&amp;gt; (a org.apache.hadoop.io.SequenceFile$Writer)
        at org.apache.hadoop.hbase.HLog.append(HLog.java:387)
        - locked &amp;lt;0x00002aaab69d1180&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
        at org.apache.hadoop.hbase.HRegion.update(HRegion.java:1629)
        at org.apache.hadoop.hbase.HRegion.batchUpdate(HRegion.java:1432)
        at org.apache.hadoop.hbase.HRegionServer.batchUpdate(HRegionServer.java:1552)
        at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.apache.hadoop.hbase.ipc.HbaseRPC$Server.call(HbaseRPC.java:413)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:901)

.....

&lt;span class=&quot;code-quote&quot;&gt;&quot;DataStreamer &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; file /hbase/aa0-005-2.u.powerset.com/log_208.76.45.223_1212443824255_60020/hlog.dat.000 block blk_-6991279486194843565&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab3c1b2e70 nid=0x6b50 runnable [0x0000000041969000..0x0000000041969c80]
        at java.net.SocketOutputStream.socketWrite0(Native Method)
        at java.net.SocketOutputStream.socketWrite(Unknown Source)
        at java.net.SocketOutputStream.write(Unknown Source)
        at java.io.BufferedOutputStream.write(Unknown Source)
        - locked &amp;lt;0x00002aaab7652b70&amp;gt; (a java.io.BufferedOutputStream)
        at java.io.DataOutputStream.write(Unknown Source)
        - locked &amp;lt;0x00002aaab7652288&amp;gt; (a java.io.DataOutputStream)
        at org.apache.hadoop.dfs.DFSClient$DFSOutputStream$DataStreamer.run(DFSClient.java:1631)
        - locked &amp;lt;0x00002aaab69d1a28&amp;gt; (a java.util.LinkedList)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve seen this before.  I saw this this morning where a pure hadoop client was hung in same way.  This is hadoop 0.16.4.  Seems like a pure hadoop prob.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12397502">HBASE-667</key>
            <summary>Hung regionserver; hung on hdfs: writeChunk, DFSClient.java:2126, DataStreamer socketWrite</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Jun 2008 19:30:59 +0000</created>
                <updated>Fri, 10 Sep 2010 17:57:28 +0000</updated>
                            <resolved>Fri, 10 Sep 2010 17:57:28 +0000</resolved>
                                    <version>0.1.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12602427" author="stack" created="Wed, 4 Jun 2008 19:32:36 +0000"  >&lt;p&gt;When in this state, regionserver will not go down.&lt;/p&gt;</comment>
                            <comment id="12602452" author="stack" created="Wed, 4 Jun 2008 20:51:39 +0000"  >&lt;p&gt;I&apos;ve found 4 servers in our cluster of 50 hung in this state.  I&apos;m having trouble running an update of all records in a particular table because of this issue.  Maybe its my job that is bringing out this issue?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[stack@X.X.X.X 0.1]$ more /tmp/script.py 
# To run &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; script, I did the following:

# $ HBASE_OPTS=&lt;span class=&quot;code-quote&quot;&gt;&quot;-Dpython.path=$JYTHON_HOME&quot;&lt;/span&gt; HBASE_CLASSPATH=$JYTHON_HOME/jython.jar ./bin/hbase org.python.util.jython select.jython
#
from org.apache.hadoop.hbase &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; HBaseConfiguration, HTable, HStoreKey
from org.apache.hadoop.hbase.util &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; Writables
from org.apache.hadoop.io &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; Text
from java.util &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; TreeMap
from jarray &lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; array

c = HBaseConfiguration()
c.set(&lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.master&quot;&lt;/span&gt;, X.X.X.X:60000&quot;)
t = HTable(c, Text(&lt;span class=&quot;code-quote&quot;&gt;&quot;TABLENAME&quot;&lt;/span&gt;))
b = Text(&lt;span class=&quot;code-quote&quot;&gt;&quot;page:url&quot;&lt;/span&gt;)
upload = Text(&lt;span class=&quot;code-quote&quot;&gt;&quot;misc:upload_time&quot;&lt;/span&gt;)
columns = array([b], Text)
scanner = t.obtainScanner(columns, Text(&quot;&quot;))
key = HStoreKey()
value = TreeMap()
timestamp = 1180501155000L
&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; 1:
    result = scanner.next(key, value)
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; not result:
        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;
    print key
    id = t.startUpdate(key.getRow())
    t.put(id, upload, Writables.longToBytes(timestamp))
    t.commit(id, timestamp)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12622669" author="stack" created="Thu, 14 Aug 2008 20:14:34 +0000"  >&lt;p&gt;Ryan Smith, AlphaOmega, saw this issue yesterday on his cluster.&lt;/p&gt;</comment>
                            <comment id="12649486" author="stack" created="Thu, 20 Nov 2008 21:02:49 +0000"  >&lt;p&gt;Saw this again on streamy cluster yesterday; hadoop 0.18.x and an hbase that is close to TRUNK.  Two regionservers I think, one at least, stuck in same place.  Wouldn&apos;t go down.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;IPC Server handler 9 on 60020&quot;&lt;/span&gt; daemon prio=10 tid=0x00007fef1c3f0400 nid=0x7470 waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; monitor entry [0x0000000042d18000..0x0000000042d189f0]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: BLOCKED (on object monitor)
	at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.writeChunk(DFSClient.java:2486)
	- waiting to lock &amp;lt;0x00007fef38ecc138&amp;gt; (a java.util.LinkedList)
	- locked &amp;lt;0x00007fef38ecbdb8&amp;gt; (a org.apache.hadoop.dfs.DFSClient$DFSOutputStream)
	at org.apache.hadoop.fs.FSOutputSummer.writeChecksumChunk(FSOutputSummer.java:155)
	at org.apache.hadoop.fs.FSOutputSummer.flushBuffer(FSOutputSummer.java:132)
	- locked &amp;lt;0x00007fef38ecbdb8&amp;gt; (a org.apache.hadoop.dfs.DFSClient$DFSOutputStream)
	at org.apache.hadoop.fs.FSOutputSummer.flushBuffer(FSOutputSummer.java:121)
	- locked &amp;lt;0x00007fef38ecbdb8&amp;gt; (a org.apache.hadoop.dfs.DFSClient$DFSOutputStream)
	at org.apache.hadoop.fs.FSOutputSummer.write1(FSOutputSummer.java:112)
	at org.apache.hadoop.fs.FSOutputSummer.write(FSOutputSummer.java:86)
	- locked &amp;lt;0x00007fef38ecbdb8&amp;gt; (a org.apache.hadoop.dfs.DFSClient$DFSOutputStream)
	at org.apache.hadoop.fs.FSDataOutputStream$PositionCache.write(FSDataOutputStream.java:47)
	at java.io.DataOutputStream.write(DataOutputStream.java:107)
	- locked &amp;lt;0x00007fef38e09fc0&amp;gt; (a org.apache.hadoop.fs.FSDataOutputStream)
	at org.apache.hadoop.io.SequenceFile$Writer.append(SequenceFile.java:1016)
	- locked &amp;lt;0x00007fef38e09f30&amp;gt; (a org.apache.hadoop.io.SequenceFile$Writer)
	at org.apache.hadoop.io.SequenceFile$Writer.append(SequenceFile.java:980)
	- locked &amp;lt;0x00007fef38e09f30&amp;gt; (a org.apache.hadoop.io.SequenceFile$Writer)
	at org.apache.hadoop.hbase.regionserver.HLog.doWrite(HLog.java:461)
	at org.apache.hadoop.hbase.regionserver.HLog.append(HLog.java:421)
	- locked &amp;lt;0x00007fef29ad9588&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
	at org.apache.hadoop.hbase.regionserver.HRegion.update(HRegion.java:1676)
	at org.apache.hadoop.hbase.regionserver.HRegion.batchUpdate(HRegion.java:1439)
	at org.apache.hadoop.hbase.regionserver.HRegion.batchUpdate(HRegion.java:1378)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.batchUpdates(HRegionServer.java:1184)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:616)
	at org.apache.hadoop.hbase.ipc.HbaseRPC$Server.call(HbaseRPC.java:622)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:888)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is the seemingly accompanying datastreamer for the probable log file:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;DataStreamer &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; file /hbase/log_72.34.249.212_1225407466779_60020/hlog.dat.1227075571390 block blk_-7436808403424765554_553837&quot;&lt;/span&gt; daemon prio=10 tid=0x0000000001c84c00 nid=0x7125 in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x00000000409b3000..0x00000000409b3d70]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (on object monitor)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:502)
	at org.apache.hadoop.ipc.Client.call(Client.java:709)
	- locked &amp;lt;0x00007fef39520bb8&amp;gt; (a org.apache.hadoop.ipc.Client$Call)
	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:216)
	at org.apache.hadoop.dfs.$Proxy4.getProtocolVersion(Unknown Source)
	at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:319)
	at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:306)
	at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:343)
	at org.apache.hadoop.ipc.RPC.waitForProxy(RPC.java:288)
	at org.apache.hadoop.dfs.DFSClient.createClientDatanodeProtocolProxy(DFSClient.java:139)
	at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.processDatanodeError(DFSClient.java:2185)
	at org.apache.hadoop.dfs.DFSClient$DFSOutputStream.access$1400(DFSClient.java:1735)
	at org.apache.hadoop.dfs.DFSClient$DFSOutputStream$DataStreamer.run(DFSClient.java:1889)
	- locked &amp;lt;0x00007fef38ecc138&amp;gt; (a java.util.LinkedList)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looks like above is stuck trying to set up proxy:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; VersionedProtocol waitForProxy(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; protocol,
                                               &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; clientVersion,
                                               InetSocketAddress addr,
                                               Configuration conf
                                               ) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) {
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; getProxy(protocol, clientVersion, addr, conf);
      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(ConnectException se) {  &lt;span class=&quot;code-comment&quot;&gt;// namenode has not been started
&lt;/span&gt;        LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Server at &quot;&lt;/span&gt; + addr + &lt;span class=&quot;code-quote&quot;&gt;&quot; not available yet, Zzzzz...&quot;&lt;/span&gt;);
      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(SocketTimeoutException te) {  &lt;span class=&quot;code-comment&quot;&gt;// namenode is busy
&lt;/span&gt;        LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Problem connecting to server: &quot;&lt;/span&gt; + addr);
      }
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(1000);
      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException ie) {
        &lt;span class=&quot;code-comment&quot;&gt;// IGNORE
&lt;/span&gt;      }
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is where first stack trace is hungup:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2466     &lt;span class=&quot;code-comment&quot;&gt;// @see FSOutputSummer#writeChunk()
&lt;/span&gt;2467     @Override
2468     &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; void writeChunk(&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] b, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; offset, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; len, &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] checksum)
2469                                                           &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
2470       checkOpen();
2471       isClosed();
2472 
2473       &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; cklen = checksum.length;
2474       &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; bytesPerChecksum = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.checksum.getBytesPerChecksum();
2475       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (len &amp;gt; bytesPerChecksum) {
2476         &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;writeChunk() buffer size is &quot;&lt;/span&gt; + len +
2477                               &lt;span class=&quot;code-quote&quot;&gt;&quot; is larger than supported  bytesPerChecksum &quot;&lt;/span&gt; +
2478                               bytesPerChecksum);
2479       }
2480       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (checksum.length != &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.checksum.getChecksumSize()) {
2481         &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;writeChunk() checksum size is supposed to be &quot;&lt;/span&gt; +
2482                               &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.checksum.getChecksumSize() +
2483                               &lt;span class=&quot;code-quote&quot;&gt;&quot; but found to be &quot;&lt;/span&gt; + checksum.length);
2484       }
2485 
2486       &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (dataQueue) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... &lt;/p&gt;

&lt;p&gt;trying to synchronize on dataQueue.&lt;/p&gt;

&lt;p&gt;DataQueue is held by DataStreamer#run.&lt;/p&gt;

&lt;p&gt;Its down in processDatanodeError trying to recover a problem with a block.&lt;/p&gt;

&lt;p&gt;One thing to try would be to enable hadoop ipc logging next time we see this.  I think its stuck trying to connect to a datanode that had just died.  Logging would help here.&lt;/p&gt;
</comment>
                            <comment id="12712459" author="stack" created="Sat, 23 May 2009 20:17:45 +0000"  >&lt;p&gt;Hairong called this as an hdfs race condition and suggested filing an hdfs issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-88&quot; title=&quot;Hung on hdfs: writeChunk, DFSClient.java:2126, DataStreamer socketWrite&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-88&quot;&gt;&lt;del&gt;HADOOP-5904&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12908122" author="tlipcon" created="Fri, 10 Sep 2010 17:57:28 +0000"  >&lt;p&gt;Resolving this old JIRA since HDFS has evolved quite a bit since it was filed, and I&apos;m pretty sure it got fixed somewhere along the line (at least we don&apos;t see this commonly anymore).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 10 Sep 2010 17:57:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25324</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 15 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h8pj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98673</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>