<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:05:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2827/HBASE-2827.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2827] HBase Client doesn&apos;t handle master failover</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2827</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;A client on our beta tier was stuck in this exception loop when we issued a new HMaster after the old one died:&lt;/p&gt;

&lt;p&gt;Exception while trying to connect hBase&lt;br/&gt;
java.lang.reflect.UndeclaredThrowableException&lt;br/&gt;
at $Proxy1.getClusterStatus(Unknown Source)&lt;br/&gt;
at org.apache.hadoop.hbase.client.HBaseAdmin.getClusterStatus(HBaseAdmin.java:912)&lt;br/&gt;
at org.apache.hadoop.hbase.client.HTable.getCurrentNrHRS(HTable.java:170)&lt;br/&gt;
at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:143)&lt;br/&gt;
...&lt;br/&gt;
at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:253)&lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885)&lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)&lt;br/&gt;
at java.lang.Thread.run(Thread.java:619)&lt;br/&gt;
Caused by: java.net.SocketTimeoutException: 20000 millis timeout while waiting for channel to be ready for connect. ch : java.nio.channels.SocketChannel&lt;span class=&quot;error&quot;&gt;&amp;#91;connection-pending remote=/10.18.34.212:60000&amp;#93;&lt;/span&gt;&lt;br/&gt;
at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:213)&lt;br/&gt;
at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:406)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.HBaseClient$Connection.setupIOstreams(HBaseClient.java:309)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.HBaseClient.getConnection(HBaseClient.java:856)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:724)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.HBaseRPC$Invoker.invoke(HBaseRPC.java:252)&lt;br/&gt;
... 20 more&lt;br/&gt;
12:52:55,863 &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-4-thread-5182&amp;#93;&lt;/span&gt; INFO PersistentUtil:153 - Retry after 1 second...&lt;/p&gt;

&lt;p&gt;Looking at the client code, the HConnectionManager does not watch ZK for NodeDeleted &amp;amp; NodeCreated of /hbase/master&lt;/p&gt;</description>
                <environment></environment>
        <key id="12468962">HBASE-2827</key>
            <summary>HBase Client doesn&apos;t handle master failover</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="streamy">Jonathan Gray</assignee>
                                    <reporter username="nspiegelberg">Nicolas Spiegelberg</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Jul 2010 23:46:47 +0000</created>
                <updated>Mon, 15 Apr 2013 22:45:10 +0000</updated>
                            <resolved>Mon, 15 Apr 2013 22:45:10 +0000</resolved>
                                    <version>0.90.0</version>
                                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12888074" author="nspiegelberg" created="Tue, 13 Jul 2010 22:52:36 +0000"  >&lt;p&gt;Downgrading priority after further investigation.  Still working on this issue, but &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2828&quot; title=&quot;HTable unnecessarily coupled with HMaster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2828&quot;&gt;&lt;del&gt;HBASE-2828&lt;/del&gt;&lt;/a&gt; was really the critical patch.&lt;/p&gt;

&lt;p&gt;11:47:48 AM Nicolas Spiegelberg: should I push 2828 to the titan hbase, or should we wait for the trunk refresh.  that jira should fix the Exception that we saw on our cluster&lt;br/&gt;
11:49:22 AM Kannan: this is the master failover for client?&lt;br/&gt;
11:49:48 AM Nicolas Spiegelberg: it&apos;s decoupling the HTable from the master&lt;br/&gt;
11:50:18 AM Nicolas Spiegelberg: HBaseAdmin is the one that has master failover problems, but a client only uses it when disabling tables, creating new tables, etc&lt;br/&gt;
11:50:57 AM Kannan: i was under the impression that HBaseAdmin was the more critical one... but I think you are right.&lt;br/&gt;
11:51:08 AM Nicolas Spiegelberg: still needs to be fixed, but our problem was that they used the HBaseAdmin code, which is almost never used and sometimes buggy, inside the HTable code, which is used all the time&lt;br/&gt;
11:54:05 AM Nicolas Spiegelberg: I&apos;m still working on 2827, which is the failover.  2828 just relies on zookeeper instead of the master.&lt;/p&gt;</comment>
                            <comment id="12902245" author="jdcryans" created="Wed, 25 Aug 2010 01:06:48 +0000"  >&lt;p&gt;Are you still on this Nicolas? What&apos;s the current situation like after 2828?&lt;/p&gt;</comment>
                            <comment id="12902264" author="nspiegelberg" created="Wed, 25 Aug 2010 01:29:49 +0000"  >&lt;p&gt;Unassigning myself from this issue.  I don&apos;t know if I&apos;d even list it as major currently, probably minor.  If you had a long-running HBaseAdmin client, this would be a problem.  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2828&quot; title=&quot;HTable unnecessarily coupled with HMaster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2828&quot;&gt;&lt;del&gt;HBASE-2828&lt;/del&gt;&lt;/a&gt; was the critical issue, as it affected the HTable API.  Should probably wait until after the master rewrite to work on this.&lt;/p&gt;</comment>
                            <comment id="12918193" author="streamy" created="Tue, 5 Oct 2010 21:11:26 +0000"  >&lt;p&gt;I will write a unit test for this on new master.&lt;/p&gt;</comment>
                            <comment id="12930484" author="stack" created="Wed, 10 Nov 2010 05:09:25 +0000"  >&lt;p&gt;Moving out.  Nicolas undid HTable reference on Master.  HBaseAdmin wil not ride over a Master restart but its just admin functions.... and not end of world if have to make a new one.  Would take a bit to make it work but bottom line I don&apos;t think this important, not right now.  Moving out (I added note to HBaseAdmin).&lt;/p&gt;</comment>
                            <comment id="12930486" author="stack" created="Wed, 10 Nov 2010 05:11:58 +0000"  >&lt;p&gt;Added a bit of a note to head of HBaseAdmin:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java
===================================================================
--- src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java        (revision 1033345)
+++ src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java        (working copy)
@@ -57,7 +57,9 @@
  * administrative functions.  Use HBaseAdmin to create, drop, list, enable and 
  * disable tables. Use it also to add and drop table column families. 
  * 
- * See {@link HTable} to add, update, and delete data from an individual table.
+ * &amp;lt;p&amp;gt;See {@link HTable} to add, update, and delete data from an individual table.
+ * &amp;lt;p&amp;gt;Currently HBaseAdmin instances are not expected to be &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;-lived.  For
+ * example, an HBaseAdmin instance will not ride over a Master restart.
  */
 &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class HBaseAdmin &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Abortable {
   &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Log LOG = LogFactory.getLog(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getClass().getName());
@@ -1151,4 +1153,4 @@
     copyOfConf.setInt(&lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.client.retries.number&quot;&lt;/span&gt;, 1);
     &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HBaseAdmin(copyOfConf);
   }
-}
\ No newline at end of file
+}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13070383" author="vams" created="Mon, 25 Jul 2011 09:09:35 +0000"  >&lt;p&gt;Hi jonathan,may be in this place this question is irrelevant. But please let me know whether we can implement a distributed hashing in HBase for fast lookup/ scanning purpose?? i want to implement scalable data structure i.e DHT in Hbase, for that how can i proceed? Thank you.&lt;/p&gt;</comment>
                            <comment id="13632325" author="jdcryans" created="Mon, 15 Apr 2013 22:45:10 +0000"  >&lt;p&gt;Resolving as invalid, AFAIK it works.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 25 Aug 2010 01:06:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26485</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 35 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02bfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>