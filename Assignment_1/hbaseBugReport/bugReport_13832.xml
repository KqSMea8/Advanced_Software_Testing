<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:47:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13832/HBASE-13832.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13832] Procedure V2: master fail to start due to WALProcedureStore sync failures when HDFS data nodes count is low</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13832</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;when the data node &amp;lt; 3, we got failure in WALProcedureStore#syncLoop() during master start.  The failure prevents master to get started.  &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-05-29 13:27:16,625 ERROR [WALProcedureStoreSyncThread] wal.WALProcedureStore: Sync slot failed, abort.
java.io.IOException: Failed to replace a bad datanode on the existing pipeline due to no more good datanodes being available to try. (Nodes: current=[DatanodeInfoWithStorage[10.333.444.555:50010,DS-3c7777ed-93f4-47b6-9c23-1426f7a6acdc,DISK], DatanodeInfoWithStorage[10.222.666.777:50010,DS-f9c983b4-1f10-4d5e-8983-490ece56c772,DISK]],                     original=[DatanodeInfoWithStorage[10.333.444.555:50010,DS-3c7777ed-93f4-47b6-9c23-1426f7a6acdc,DISK], DatanodeInfoWithStorage[10.222.666.777:50010,DS-f9c983b4-1f10-4d5e-8983-    490ece56c772,DISK]]). The current failed datanode replacement policy is DEFAULT, and a client may configure this via &apos;dfs.client.block.write.replace-datanode-on-failure.policy&apos;  in its configuration.
  at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.findNewDatanode(DFSOutputStream.java:951)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One proposal is to implement some similar logic as FSHLog: if IOException is thrown during syncLoop in WALProcedureStore#start(), instead of immediate abort, we could try to roll the log and see whether this resolve the issue; if the new log cannot be created or more exception from rolling the log, we then abort.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12835215">HBASE-13832</key>
            <summary>Procedure V2: master fail to start due to WALProcedureStore sync failures when HDFS data nodes count is low</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12860479">HBASE-14336</parent>
                                    <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mbertozzi">Matteo Bertozzi</assignee>
                                    <reporter username="syuanjiang">Stephen Yuan Jiang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Jun 2015 21:40:03 +0000</created>
                <updated>Sat, 29 Aug 2015 04:22:49 +0000</updated>
                            <resolved>Thu, 9 Jul 2015 17:58:04 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>1.1.0</version>
                    <version>1.2.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.1.2</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>master</component>
                    <component>proc-v2</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="14571697" author="syuanjiang" created="Wed, 3 Jun 2015 21:40:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; FYI&lt;/p&gt;</comment>
                            <comment id="14571737" author="enis" created="Wed, 3 Jun 2015 22:12:17 +0000"  >&lt;p&gt;I think we should copy the same semantics for the FSHlog sync / log roll behavior. What we have in FSHlog / LogRoller is this: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Log syncer catches IOException, and logs it, and requests log roll.&lt;/li&gt;
	&lt;li&gt;Log roller tries to roll the log, and if it gets an IOException in file close, or generic IOException while rolling, it aborts the RS.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The reason to have the same semantics is that we do not want to cause the master to abort prematurely in case of a recoverable IOException like the one in the jira title. If the RS can ride over generic IOExceptions, the master should do the same.  &lt;/p&gt;</comment>
                            <comment id="14588717" author="mbertozzi" created="Tue, 16 Jun 2015 20:29:45 +0000"  >&lt;p&gt;Added a patch which has more or less the same logic as FSHLog. it tries to roll on sync failure before aborting the master. &lt;br/&gt;
at some point I&apos;ll try to move out the FSHLog stuff and make a generic WAL, so we have a single implementation for the rolling/encryption and similar things.&lt;/p&gt;</comment>
                            <comment id="14594160" author="enis" created="Sat, 20 Jun 2015 00:11:48 +0000"  >&lt;p&gt;Thanks Matteo, I&apos;ll take a look. &lt;/p&gt;</comment>
                            <comment id="14596245" author="yuzhihong@gmail.com" created="Mon, 22 Jun 2015 17:09:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;&quot;hbase.procedure.store.wal.max.retry.before.roll&quot;;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&apos;retry&apos; -&amp;gt; &apos;retries&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
611	      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
612	        LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to roll the log&quot;&lt;/span&gt;, e);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please log i, the roll retry count.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
147	  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; class TestProcedure &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Procedure&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Void&lt;/span&gt;&amp;gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This class can be private, right ?&lt;/p&gt;</comment>
                            <comment id="14598604" author="jinghe" created="Tue, 23 Jun 2015 23:57:52 +0000"  >&lt;p&gt;I have recently seen similar failures on our HBase 1.1.0 clusters:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-06-22 18:20:20,240 INFO  [B.defaultRpcServer.handler=36,queue=0,port=60000] master.HMaster: Client=bigsql/null create &apos;bigsql.smoke_1820163205&apos;, {TABLE_ATTRIBUTES =&amp;gt; {METADATA =&amp;gt; {&apos;hbase.columns.mapping&apos; =&amp;gt; &apos;[{&quot;key&quot;:{&quot;c&quot;:[{&quot;n&quot;:&quot;c1&quot;,&quot;t&quot;:&quot;int&quot;}]}},{&quot;cmap&quot;:[{&quot;c&quot;:[{&quot;n&quot;:&quot;c2&quot;,&quot;t&quot;:&quot;int&quot;},{&quot;n&quot;:&quot;c3&quot;,&quot;t&quot;:&quot;int&quot;}],&quot;f&quot;:&quot;cf1&quot;,&quot;q&quot;:&quot;cq1&quot;}]},{&quot;def&quot;:{&quot;enc&quot;:{&quot;encName&quot;:&quot;binary&quot;},&quot;sep&quot;:&quot;\x5Cu0000&quot;}},{&quot;sqlc&quot;:&quot;c1,c2,c3&quot;}]&apos;}}, {NAME =&amp;gt; &apos;cf1&apos;, DATA_BLOCK_ENCODING =&amp;gt; &apos;NONE&apos;, BLOOMFILTER =&amp;gt; &apos;ROW&apos;, REPLICATION_SCOPE =&amp;gt; &apos;0&apos;, VERSIONS =&amp;gt; &apos;1&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, MIN_VERSIONS =&amp;gt; &apos;0&apos;, TTL =&amp;gt; &apos;FOREVER&apos;, KEEP_DELETED_CELLS =&amp;gt; &apos;FALSE&apos;, BLOCKSIZE =&amp;gt; &apos;65536&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;true&apos;}
2015-06-22 18:20:20,341 ERROR [WALProcedureStoreSyncThread] wal.WALProcedureStore: sync slot failed, abort.
java.io.IOException: Failed to replace a bad datanode on the existing pipeline due to no more good datanodes being available to try. (Nodes: current=[DatanodeInfoWithStorage[9.30.255.244:50010,DS-5fd53475-f1d1-4141-b732-4df6998996ca,DISK], DatanodeInfoWithStorage[9.30.255.245:50010,DS-9b9ed517-99e8-4d92-8d85-42650b6e97db,DISK]], original=[DatanodeInfoWithStorage[9.30.255.244:50010,DS-5fd53475-f1d1-4141-b732-4df6998996ca,DISK], DatanodeInfoWithStorage[9.30.255.245:50010,DS-9b9ed517-99e8-4d92-8d85-42650b6e97db,DISK]]). The current failed datanode replacement policy is DEFAULT, and a client may configure this via &apos;dfs.client.block.write.replace-datanode-on-failure.policy&apos; in its configuration.
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.findNewDatanode(DFSOutputStream.java:918)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.addDatanode2ExistingPipeline(DFSOutputStream.java:984)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.setupPipelineForAppendOrRecovery(DFSOutputStream.java:1131)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.processDatanodeError(DFSOutputStream.java:876)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:402)
2015-06-22 18:20:20,341 FATAL [WALProcedureStoreSyncThread] master.HMaster: Master server abort: loaded coprocessors are: []
2015-06-22 18:20:20,341 INFO  [WALProcedureStoreSyncThread] regionserver.HRegionServer: STOPPED: The Procedure Store lost the lease
2015-06-22 18:20:20,343 INFO  [master/bdls142.svl.ibm.com/9.30.255.242:60000] regionserver.HRegionServer: Stopping infoServer
2015-06-22 18:20:20,350 INFO  [master/bdls142.svl.ibm.com/9.30.255.242:60000] mortbay.log: Stopped SelectChannelConnector@0.0.0.0:60010
2015-06-22 18:20:20,351 INFO  [master/bdls142.svl.ibm.com/9.30.255.242:60000] procedure2.ProcedureExecutor: Stopping the procedure executor
2015-06-22 18:20:20,352 INFO  [master/bdls142.svl.ibm.com/9.30.255.242:60000] wal.WALProcedureStore: Stopping the WAL Procedure Store
2015-06-22 18:20:20,352 WARN  [master/bdls142.svl.ibm.com/9.30.255.242:60000] wal.WALProcedureStore: Unable to write the trailer: Failed to replace a bad datanode on the existing pipeline due to no more good datanodes being available to try. (Nodes: current=[DatanodeInfoWithStorage[9.30.255.244:50010,DS-5fd53475-f1d1-4141-b732-4df6998996ca,DISK], DatanodeInfoWithStorage[9.30.255.245:50010,DS-9b9ed517-99e8-4d92-8d85-42650b6e97db,DISK]], original=[DatanodeInfoWithStorage[9.30.255.244:50010,DS-5fd53475-f1d1-4141-b732-4df6998996ca,DISK], DatanodeInfoWithStorage[9.30.255.245:50010,DS-9b9ed517-99e8-4d92-8d85-42650b6e97db,DISK]]). The current failed datanode replacement policy is DEFAULT, and a client may configure this via &apos;dfs.client.block.write.replace-datanode-on-failure.policy&apos; in its configuration.
2015-06-22 18:20:20,352 ERROR [master/bdls142.svl.ibm.com/9.30.255.242:60000] wal.WALProcedureStore: Unable to close the stream
java.io.IOException: Failed to replace a bad datanode on the existing pipeline due to no more good datanodes being available to try. (Nodes: current=[DatanodeInfoWithStorage[9.30.255.244:50010,DS-5fd53475-f1d1-4141-b732-4df6998996ca,DISK], DatanodeInfoWithStorage[9.30.255.245:50010,DS-9b9ed517-99e8-4d92-8d85-42650b6e97db,DISK]], original=[DatanodeInfoWithStorage[9.30.255.244:50010,DS-5fd53475-f1d1-4141-b732-4df6998996ca,DISK], DatanodeInfoWithStorage[9.30.255.245:50010,DS-9b9ed517-99e8-4d92-8d85-42650b6e97db,DISK]]). The current failed datanode replacement policy is DEFAULT, and a client may configure this via &apos;dfs.client.block.write.replace-datanode-on-failure.policy&apos; in its configuration.
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.findNewDatanode(DFSOutputStream.java:918)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.addDatanode2ExistingPipeline(DFSOutputStream.java:984)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.setupPipelineForAppendOrRecovery(DFSOutputStream.java:1131)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.processDatanodeError(DFSOutputStream.java:876)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:402)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14598608" author="jinghe" created="Tue, 23 Jun 2015 23:59:03 +0000"  >&lt;p&gt;But in most cases, we have &amp;gt;3 data nodes.&lt;/p&gt;</comment>
                            <comment id="14601855" author="ndimiduk" created="Thu, 25 Jun 2015 20:17:14 +0000"  >&lt;p&gt;Failure of master to start is a problem. Bumping priority and setting some fix-version targets.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jinghe&quot; class=&quot;user-hover&quot; rel=&quot;jinghe&quot;&gt;Jerry He&lt;/a&gt; are you able to reproduce? Can you take the attached patch for a spin?&lt;/p&gt;</comment>
                            <comment id="14601868" author="mbertozzi" created="Thu, 25 Jun 2015 20:22:47 +0000"  >&lt;p&gt;even with the patch the master will not start until the 3rd data node is back.&lt;br/&gt;
in theory you should ping pong between the backup masters until something a DN is available.&lt;br/&gt;
what the patch does is just retry for some time hoping that a 3rd data node is online, before giving up.&lt;/p&gt;</comment>
                            <comment id="14602097" author="hadoopqa" created="Thu, 25 Jun 2015 22:51:56 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12739966/HBASE-13832-v0.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12739966/HBASE-13832-v0.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit e6ed79219966ce0dac3bc748261fce9478aa7550.&lt;br/&gt;
  ATTACHMENT ID: 12739966&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1908 checkstyle errors (more than the master&apos;s current 1907 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.util.TestHBaseFsck&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14577//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14577//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14577//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14577//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14577//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14577//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14577//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14577//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14602383" author="hadoopqa" created="Fri, 26 Jun 2015 04:35:51 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12742004/HBASE-13832-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12742004/HBASE-13832-v1.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 2ed058554c0b6d6da0388497562e254107f13d67.&lt;br/&gt;
  ATTACHMENT ID: 12742004&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1902 checkstyle errors (more than the master&apos;s current 1901 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14582//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14582//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14582//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14582//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14582//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14582//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14582//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14582//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14603860" author="enis" created="Sat, 27 Jun 2015 00:52:04 +0000"  >&lt;p&gt;Looks good overall. &lt;/p&gt;

&lt;p&gt;Why RTE, rather than rethrow? &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(e);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think we may have an issue about &lt;tt&gt;syncSlots()&lt;/tt&gt; never throwing an exception. If a procedure executor thread calls &lt;tt&gt;pushData()&lt;/tt&gt; which internally will wait on &lt;tt&gt;syncCond&lt;/tt&gt;. In case of an exception in syncer thread, &lt;tt&gt;syncSlots&lt;/tt&gt; will start the master abort process, but returning from master abort does not guarantee that the proc executor or rest of proc store is stopped. Since &lt;tt&gt;syncSlots&lt;/tt&gt; does not rethrow the exception,  &lt;tt&gt;syncLoop&lt;/tt&gt; will continue on and call  &lt;tt&gt;syncCond.signalAll()&lt;/tt&gt; which will cause the &lt;tt&gt;pushData&lt;/tt&gt; to return and think that the proc state is persisted, while it is not. &lt;/p&gt;

&lt;p&gt;This new code seems to be a fix for it: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isRunning()) {
+        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;code-quote&quot;&gt;&quot;sync aborted&quot;&lt;/span&gt;);
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but I think there is no guarantee that when &lt;tt&gt;master.abort()&lt;/tt&gt; returns, the WALProcedureStore may still be not stopped which means that there is a time window that the procedure can execute assuming persisted state. I maybe missing something in the above analysis though. &lt;/p&gt;</comment>
                            <comment id="14603897" author="mbertozzi" created="Sat, 27 Jun 2015 02:02:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why RTE, rather than rethrow?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;to avoid unecessary headache to the caller. the store will succeed or the master will abort. you don&apos;t have to write extra code to handle exceptions, because the master is going down anyway. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;but I think there is no guarantee that when master.abort() returns, the WALProcedureStore may still be not stopped&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;we spin until we have running == false&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
sendAbortProcessSignal();
&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (isRunning()) &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.yield();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14603914" author="enis" created="Sat, 27 Jun 2015 02:34:47 +0000"  >&lt;blockquote&gt;&lt;p&gt;we spin until we have running == false&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ok that would work. This is still a very indirect way of re-throwing the exception, and seems fragile. Can&apos;t we simply get an atomic ref to the exception in sync thread and rethrow it to the pushDate() caller, kind of like simulating SyncFuture ?  &lt;/p&gt;</comment>
                            <comment id="14606599" author="enis" created="Mon, 29 Jun 2015 22:55:53 +0000"  >&lt;p&gt;I was trying a test on top of the v1 patch for a different issue, but realized that the attached test causes a hang on the master. I think the reason is that Sync thread now exists abruptly because of RuntimeException from rollWriterOrDie(). The next pushData() call just hangs on &lt;tt&gt;syncCond.await()&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;jstack: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; prio=5 tid=0x00007fae5a000000 nid=0x1303 waiting on condition [0x000000010d37e000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (parking)
	at sun.misc.Unsafe.park(Native Method)
	- parking to wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;  &amp;lt;0x00000007ae9148a8&amp;gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)
	at java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2043)
	at org.apache.hadoop.hbase.procedure2.store.wal.WALProcedureStore.pushData(WALProcedureStore.java:464)
	at org.apache.hadoop.hbase.procedure2.store.wal.WALProcedureStore.insert(WALProcedureStore.java:325)
	at org.apache.hadoop.hbase.master.procedure.TestMasterFailoverWithProcedures.testWALfencingWithWALRolling(TestMasterFailoverWithProcedures.java:192)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</comment>
                            <comment id="14606642" author="hadoopqa" created="Mon, 29 Jun 2015 23:19:34 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12742624/hbase-13832-test-hang.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12742624/hbase-13832-test-hang.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 4f06279caaefa7dac795fb88d6711cc234a01600.&lt;br/&gt;
  ATTACHMENT ID: 12742624&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14609//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14609//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14609413" author="hadoopqa" created="Wed, 1 Jul 2015 01:31:22 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12742965/HBASE-13832-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12742965/HBASE-13832-v2.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 42d5ef017d3d629e6ca9ee93e15ac4f0f9e00ce1.&lt;br/&gt;
  ATTACHMENT ID: 12742965&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1898 checkstyle errors (more than the master&apos;s current 1897 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14631//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14631//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14631//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14631//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14631//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14631//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14631//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14631//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14611385" author="enis" created="Thu, 2 Jul 2015 03:02:07 +0000"  >&lt;p&gt;How about this one. We save the exception from sync thread, and re-throw it from pushData() so that we do not do an indirection through &lt;tt&gt;while (isRunning()) Thread.yield()&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="14611452" author="mbertozzi" created="Thu, 2 Jul 2015 04:27:40 +0000"  >&lt;p&gt;rethrowing the exception is ok to me, but that is not equivalent to the while (isRunning())&lt;/p&gt;

&lt;p&gt;in one of your comment above you said: &quot;I think there is no guarantee that when master.abort() returns, the WALProcedureStore may still be not stopped&quot;.&lt;br/&gt;
which is true in a generic way, even though currently we know that at least running will be set to false immediately.&lt;br/&gt;
what the while (isRunning()) is doing, was just spinning until running was set in case the abort will not be &quot;sync&quot; as it is now. &lt;/p&gt;

&lt;p&gt;to get the same behavior you need to force running to false when you set syncException. so you prevent other procedure to be added. &lt;/p&gt;</comment>
                            <comment id="14611530" author="hadoopqa" created="Thu, 2 Jul 2015 06:02:53 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12743215/hbase-13832-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12743215/hbase-13832-v3.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit f0e29c49a1f5f3773ba03b822805d863c149b443.&lt;br/&gt;
  ATTACHMENT ID: 12743215&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1898 checkstyle errors (more than the master&apos;s current 1897 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn post-site goal to fail.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.util.TestProcessBasedCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportExport&lt;br/&gt;
                  org.apache.hadoop.hbase.TestRegionRebalancing&lt;br/&gt;
                  org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 5 zombie test(s): 	at org.apache.hadoop.hbase.mapreduce.TestTableSnapshotInputFormat.testInitTableSnapshotMapperJobConfig(TestTableSnapshotInputFormat.java:146)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestTableInputFormatScanBase.testScan(TestTableInputFormatScanBase.java:244)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestTableInputFormatScan2.testScanOBBToQPP(TestTableInputFormatScan2.java:57)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestMultithreadedTableMapper.testMultithreadedTableMapper(TestMultithreadedTableMapper.java:133)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testRegionCrossingRowColBloom(TestLoadIncrementalHFiles.java:142)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestImportExport.testExportScannerBatching(TestImportExport.java:271)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14648//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14648//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14648//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14648//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14648//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14648//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14648//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14648//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14612488" author="enis" created="Thu, 2 Jul 2015 20:41:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;to get the same behavior you need to force running to false when you set syncException. so you prevent other procedure to be added.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Not sure whether we gain by ensuring that running is set to false before the next execution for syncLoop. Wal store will abort when the master calls abort. Before this happens, concurrent calls to &lt;tt&gt;pushData()&lt;/tt&gt; will still get the exception because the exception from sync is not cleared at all. So the semantics is that if &lt;tt&gt;snyc()&lt;/tt&gt; + wal roll fails, we effectively start rejecting all requests for &lt;tt&gt;pushData()&lt;/tt&gt;, which is kind of similar to making sure to check isRunning(). &lt;/p&gt;</comment>
                            <comment id="14612666" author="mbertozzi" created="Thu, 2 Jul 2015 23:13:36 +0000"  >&lt;p&gt;v4 is Enis patch with a fix and a new test for a case with queued writers that were hanging.&lt;/p&gt;

&lt;p&gt;still, that catched exception in the syncLoop() and the loop still going instead of aborting or at least spinning until !isRunning() seems strange to me. we know that we must die there. why not exit from that loop? (with the actual implementation of abort we know that running will be false after a sendAbortProcessSignal() but that may not be the case in the future)&lt;/p&gt;</comment>
                            <comment id="14612713" author="enis" created="Fri, 3 Jul 2015 00:39:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;we know that we must die there. why not exit from that loop?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We can call &lt;tt&gt;stop(true)&lt;/tt&gt; directly from Sync loop it is fine. It was not there in your original patch, that is why I did not change it. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;with the actual implementation of abort we know that running will be false after a sendAbortProcessSignal() but that may not be the case in the future&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The store can cause an abort to the whole procedure executor or the master itself. Right now, it does this through the ProcedureStoreListener calls. I&apos;m fine with sending an &lt;tt&gt;Abortable&lt;/tt&gt; directly to the store. These parts are mainly coming from the intiail proc v2 patch. &lt;/p&gt;

&lt;p&gt;Does the test rely on 1s / 2s timing? It may end up being flaky in slow jenkins hosts. Other than that +1 for the v4 patch. If you want to do the abort changes, we can do it here or a follow up. &lt;/p&gt;</comment>
                            <comment id="14612722" author="mbertozzi" created="Fri, 3 Jul 2015 00:56:41 +0000"  >&lt;p&gt;calling directly stop() was not what I was proposing. what I was saying was just exiting from the syncLoop(). before with the while (isRunning()) we were spinning after the signal, to make clear that there were no other run of the syncLoop(). in this case we may do another round of the loop and execute stuff which in theory is not what you expect after sending the abort signal.&lt;/p&gt;

&lt;p&gt;the test does not rely on the 1s/2s timing, it passes even without. but I was trying to make the problem more clear  to someone looking the code.&lt;/p&gt;</comment>
                            <comment id="14613622" author="hadoopqa" created="Sat, 4 Jul 2015 09:18:15 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12743415/HBASE-13832-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12743415/HBASE-13832-v4.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit e640f1e76af8f32015f475629610da127897f01e.&lt;br/&gt;
  ATTACHMENT ID: 12743415&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 1 warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1899 checkstyle errors (more than the master&apos;s current 1898 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14661//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14615561" author="hadoopqa" created="Mon, 6 Jul 2015 20:10:51 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12743753/HBASE-13832-v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12743753/HBASE-13832-v5.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 608c3aa15c34b9014f99e857b374645db58cbbe3.&lt;br/&gt;
  ATTACHMENT ID: 12743753&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 12 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 5 zombie test(s): 	at org.apache.hadoop.hbase.wal.TestWALSplit.testThreadingSlowWriterSmallBuffer(TestWALSplit.java:902)&lt;br/&gt;
	at org.apache.hadoop.hbase.wal.TestWALSplit.testSplitDeletedRegion(TestWALSplit.java:722)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14679//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14679//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14679//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14679//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14679//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14679//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14679//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14679//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14615871" author="enis" created="Mon, 6 Jul 2015 23:23:54 +0000"  >&lt;blockquote&gt;&lt;p&gt;org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is the new test from the patch. Seems related. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;before with the while (isRunning()) we were spinning after the signal, to make clear that there were no other run of the syncLoop(). in this case we may do another round of the loop and execute stuff which in theory is not what you expect after sending the abort signal.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I guess we can rethrow the exception after here: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable t) {
+          syncException.compareAndSet(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, t);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14619723" author="enis" created="Thu, 9 Jul 2015 01:39:24 +0000"  >&lt;p&gt;+1 for v6 patch. &lt;/p&gt;</comment>
                            <comment id="14619752" author="hadoopqa" created="Thu, 9 Jul 2015 02:21:46 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12744362/HBASE-13832-v6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12744362/HBASE-13832-v6.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit f5ad736282c8c9c27b14131919d60b72834ec9e4.&lt;br/&gt;
  ATTACHMENT ID: 12744362&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 12 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): 	at org.apache.qpid.server.queue.ProducerFlowControlTest.testCapacityExceededCausesBlock(ProducerFlowControlTest.java:123)&lt;br/&gt;
	at org.apache.qpid.test.utils.QpidBrokerTestCase.runBare(QpidBrokerTestCase.java:323)&lt;br/&gt;
	at org.apache.qpid.test.utils.QpidTestCase.run(QpidTestCase.java:155)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14709//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14709//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14709//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14709//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14709//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14709//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14709//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14709//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14621192" author="hudson" created="Thu, 9 Jul 2015 20:22:26 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.1 #580 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/580/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/580/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13832&quot; title=&quot;Procedure V2: master fail to start due to WALProcedureStore sync failures when HDFS data nodes count is low&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13832&quot;&gt;&lt;del&gt;HBASE-13832&lt;/del&gt;&lt;/a&gt; Procedure v2: try to roll the WAL master on sync failure before aborting (matteo.bertozzi: rev ac95c1a0b2dfea38ee414fa72c8f5133b36eeb22)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/MasterProcedureEnv.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/ProcedureTestingUtility.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestMasterFailoverWithProcedures.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestWALProcedureStoreOnHDFS.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14621198" author="hudson" created="Thu, 9 Jul 2015 20:26:30 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3 #46 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/46/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/46/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13832&quot; title=&quot;Procedure V2: master fail to start due to WALProcedureStore sync failures when HDFS data nodes count is low&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13832&quot;&gt;&lt;del&gt;HBASE-13832&lt;/del&gt;&lt;/a&gt; Procedure v2: try to roll the WAL master on sync failure before aborting (matteo.bertozzi: rev 22f0f3026ffaaa2f00b64616876ae817abc422d7)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStoreBase.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/ProcedureTestingUtility.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestWALProcedureStoreOnHDFS.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestMasterFailoverWithProcedures.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/MasterProcedureEnv.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/store/wal/TestWALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14621294" author="hudson" created="Thu, 9 Jul 2015 21:24:34 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.2 #60 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/60/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/60/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13832&quot; title=&quot;Procedure V2: master fail to start due to WALProcedureStore sync failures when HDFS data nodes count is low&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13832&quot;&gt;&lt;del&gt;HBASE-13832&lt;/del&gt;&lt;/a&gt; Procedure v2: try to roll the WAL master on sync failure before aborting (matteo.bertozzi: rev 246631d60e7b3b5ece039e67e8d3e9bb66d5f9a5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/MasterProcedureEnv.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/store/wal/TestWALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestMasterFailoverWithProcedures.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/ProcedureTestingUtility.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStoreBase.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestWALProcedureStoreOnHDFS.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14621295" author="hudson" created="Thu, 9 Jul 2015 21:24:38 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2-IT #46 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2-IT/46/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2-IT/46/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13832&quot; title=&quot;Procedure V2: master fail to start due to WALProcedureStore sync failures when HDFS data nodes count is low&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13832&quot;&gt;&lt;del&gt;HBASE-13832&lt;/del&gt;&lt;/a&gt; Procedure v2: try to roll the WAL master on sync failure before aborting (matteo.bertozzi: rev 246631d60e7b3b5ece039e67e8d3e9bb66d5f9a5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestWALProcedureStoreOnHDFS.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStoreBase.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestMasterFailoverWithProcedures.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/store/wal/TestWALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/MasterProcedureEnv.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/ProcedureTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14621311" author="hudson" created="Thu, 9 Jul 2015 21:35:30 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3-IT #32 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/32/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/32/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13832&quot; title=&quot;Procedure V2: master fail to start due to WALProcedureStore sync failures when HDFS data nodes count is low&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13832&quot;&gt;&lt;del&gt;HBASE-13832&lt;/del&gt;&lt;/a&gt; Procedure v2: try to roll the WAL master on sync failure before aborting (matteo.bertozzi: rev 22f0f3026ffaaa2f00b64616876ae817abc422d7)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/ProcedureTestingUtility.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestWALProcedureStoreOnHDFS.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/store/wal/TestWALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStoreBase.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestMasterFailoverWithProcedures.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/MasterProcedureEnv.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14621312" author="hudson" created="Thu, 9 Jul 2015 21:36:15 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #6641 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6641/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6641/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13832&quot; title=&quot;Procedure V2: master fail to start due to WALProcedureStore sync failures when HDFS data nodes count is low&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13832&quot;&gt;&lt;del&gt;HBASE-13832&lt;/del&gt;&lt;/a&gt; Procedure v2: try to roll the WAL master on sync failure before aborting (matteo.bertozzi: rev ae1f485ee8cb76965882b7a9c1c1647ec2912d08)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestMasterFailoverWithProcedures.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/store/wal/TestWALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/MasterProcedureEnv.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestWALProcedureStoreOnHDFS.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStoreBase.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/test/java/org/apache/hadoop/hbase/procedure2/ProcedureTestingUtility.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/ProcedureStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12739966" name="HBASE-13832-v0.patch" size="18840" author="mbertozzi" created="Tue, 16 Jun 2015 20:29:45 +0000"/>
                            <attachment id="12742004" name="HBASE-13832-v1.patch" size="18855" author="mbertozzi" created="Fri, 26 Jun 2015 00:44:10 +0000"/>
                            <attachment id="12742965" name="HBASE-13832-v2.patch" size="25261" author="mbertozzi" created="Tue, 30 Jun 2015 22:56:22 +0000"/>
                            <attachment id="12743415" name="HBASE-13832-v4.patch" size="31319" author="mbertozzi" created="Thu, 2 Jul 2015 23:14:32 +0000"/>
                            <attachment id="12743753" name="HBASE-13832-v5.patch" size="34203" author="mbertozzi" created="Mon, 6 Jul 2015 17:04:01 +0000"/>
                            <attachment id="12744362" name="HBASE-13832-v6.patch" size="35143" author="mbertozzi" created="Wed, 8 Jul 2015 23:35:43 +0000"/>
                            <attachment id="12739965" name="HDFSPipeline.java" size="5826" author="mbertozzi" created="Tue, 16 Jun 2015 20:29:45 +0000"/>
                            <attachment id="12742624" name="hbase-13832-test-hang.patch" size="4954" author="enis" created="Mon, 29 Jun 2015 22:55:53 +0000"/>
                            <attachment id="12743215" name="hbase-13832-v3.patch" size="26072" author="enis" created="Thu, 2 Jul 2015 03:02:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Jun 2015 22:12:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2flp3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>