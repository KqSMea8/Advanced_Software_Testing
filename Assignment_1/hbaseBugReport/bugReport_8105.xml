<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:52:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8105/HBASE-8105.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8105] RegionServer Doesn&apos;t Rejoin Cluster after Netsplit</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8105</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Running a 15-node HBase cluster. Testing various failure scenarios. Segregate one RegionServer from the cluster by firewalling off every port except SSH (because we need to be able to re-enable the node later).&lt;/p&gt;

&lt;p&gt;After the RS is automatically removed from the cluster, we re-enable all ports again, but RS never rejoins the cluster.&lt;/p&gt;

&lt;p&gt;I suspect the possibility this is desired behaviour, but haven&apos;t found proof so far. The code doesn&apos;t have any comment indicating this is the behaviour desired:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://grepcode.com/file/repo1.maven.org/maven2/org.apache.hbase/hbase/0.92.2/org/apache/hadoop/hbase/regionserver/HRegionServer.java/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://grepcode.com/file/repo1.maven.org/maven2/org.apache.hbase/hbase/0.92.2/org/apache/hadoop/hbase/regionserver/HRegionServer.java/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;See lines starting at 624, public void run(). It makes it through the first try/catch block, but then loops inside the second try/catch block. Our hypothesis is that it never gets out naturally.&lt;/p&gt;

&lt;p&gt;If we bounce the RegionServer process, then it rejoins the cluster.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux Ubuntu 10.04 LTS&lt;/p&gt;</environment>
        <key id="12637035">HBASE-8105</key>
            <summary>RegionServer Doesn&apos;t Rejoin Cluster after Netsplit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="philovivero">philo vivero</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Mar 2013 15:02:07 +0000</created>
                <updated>Fri, 15 Mar 2013 23:00:28 +0000</updated>
                                            <version>0.92.1</version>
                                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13602324" author="jmspaggi" created="Thu, 14 Mar 2013 15:04:37 +0000"  >&lt;p&gt;Is the RS still running when you re-open the ports? Since it losts the connection with ZooKeeper, it might have sent down already, no?&lt;/p&gt;</comment>
                            <comment id="13602334" author="timelessness@gmail.com" created="Thu, 14 Mar 2013 15:14:12 +0000"  >&lt;p&gt;The RS runs the whole time, so yes, still running when ports are re-opened.&lt;/p&gt;

&lt;p&gt;It definitely would lose its ZK connection. But then, I would expect when&lt;br/&gt;
it begins communicating again with ZK, it would note its &quot;I&apos;ve been ejected&lt;br/&gt;
from the cluster&quot; status and rejoin, or RS process die, or something. RS&lt;br/&gt;
process keeps running normally, but not part of the cluster seems an&lt;br/&gt;
erroneous state.&lt;/p&gt;


&lt;p&gt;On Thu, Mar 14, 2013 at 8:06 AM, Jean-Marc Spaggiari (JIRA) &amp;lt;jira@apache.org&lt;/p&gt;




&lt;p&gt;&amp;#8211; &lt;br/&gt;
*Tim Ellis: *Fifth Sigma, Inc. Multimedia and Technology++&lt;br/&gt;
*Contact: *time@fifthsigma.com, 510-761-6610&lt;br/&gt;
&lt;b&gt;Urgent Contact:&lt;/b&gt; timeless.phone@gmail.com (gtalk preferred. if email, CC&lt;br/&gt;
no-one)&lt;/p&gt;</comment>
                            <comment id="13602355" author="nkeywal" created="Thu, 14 Mar 2013 15:41:16 +0000"  >&lt;p&gt;I suppose you have a YouAreDeadException in the logs?&lt;br/&gt;
This would be expected. The logic is that the region server cannot be trusted anymore as it was ejected from the cluster. Then yes, it could abort. On the other hand you may want to look at it in details. Personally I would prefer to abort to be sure I don&apos;t have clients trying to use this dead server.&lt;/p&gt;

&lt;p&gt;Note that for questions or discussions, it&apos;s better to use the user mailing list.&lt;/p&gt;</comment>
                            <comment id="13603082" author="anoopsamjohn" created="Fri, 15 Mar 2013 03:44:46 +0000"  >&lt;p&gt;Can you attach RS logs?&lt;/p&gt;</comment>
                            <comment id="13603949" author="philovivero" created="Fri, 15 Mar 2013 22:52:56 +0000"  >&lt;p&gt;I do have copious logs for the time of the outage, on the order of megabytes. Do you want all of them, or should I grep for particular regexp&apos;s that would be more useful to you?&lt;/p&gt;

&lt;p&gt;In general, it starts with this:&lt;/p&gt;

&lt;p&gt;2013-03-12 17:11:43,241 FATAL org.apache.hadoop.hbase.regionserver.HRegionServer: ABORTING region server rs9,60020,1363131519016: IOE in log roller&lt;/p&gt;

&lt;p&gt;Then a bunch of things like this:&lt;/p&gt;

&lt;p&gt;2013-03-12 17:11:43,241 FATAL org.apache.hadoop.hbase.regionserver.wal.HLog: Could not append. Requesting close of hlog&lt;br/&gt;
2013-03-12 17:11:43,242 FATAL org.apache.hadoop.hbase.regionserver.wal.HLog: Could not append. Requesting close of hlog&lt;br/&gt;
2013-03-12 17:11:43,242 FATAL org.apache.hadoop.hbase.regionserver.wal.HLog: Could not append. Requesting close of hlog&lt;br/&gt;
2013-03-12 17:11:45,245 FATAL org.apache.hadoop.hbase.regionserver.wal.HLog: Could not sync. Requesting close of hlog&lt;br/&gt;
2013-03-12 17:11:45,246 ERROR org.apache.hadoop.hbase.regionserver.wal.HLog: Error while syncing, requesting close of hlog&lt;br/&gt;
2013-03-12 17:11:47,254 FATAL org.apache.hadoop.hbase.regionserver.wal.HLog: Could not sync. Requesting close of hlog&lt;br/&gt;
2013-03-12 17:11:47,254 ERROR org.apache.hadoop.hbase.regionserver.wal.HLog: Error while syncing, requesting close of hlog&lt;/p&gt;

&lt;p&gt;Those last two errors repeat alternately for a long time, then eventually:&lt;/p&gt;

&lt;p&gt;2013-03-12 17:26:13,888 ERROR org.apache.hadoop.hbase.regionserver.HRegionServer: Close and delete failed&lt;br/&gt;
2013-03-12 17:27:25,892 ERROR org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: ZooKeeper delete failed after 3 retries&lt;/p&gt;

&lt;p&gt;Once we allow RS back into the network and bounce the RS, these ERRORs appear:&lt;/p&gt;

&lt;p&gt;2013-03-12 17:51:15,908 ERROR org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: Node /hbase/replication/peers already exists and this is not a retry&lt;br/&gt;
2013-03-12 17:51:15,914 ERROR org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: Node /hbase/replication/rs already exists and this is not a retry&lt;br/&gt;
2013-03-12 17:51:15,925 ERROR org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper: Node /hbase/replication/state already exists and this is not a retry&lt;/p&gt;

&lt;p&gt;The full logs are 23MB, and &quot;egrep &apos;ERROR|FATAL&apos;&quot; for the affected time period is 112KB. Still want it attached?&lt;/p&gt;</comment>
                            <comment id="13603957" author="philovivero" created="Fri, 15 Mar 2013 23:00:28 +0000"  >&lt;p&gt;It occurs to me that I might not have understood the first question: &quot;is the RS still running?&quot; The RS process is still running on the node, but the logs seem to indicate that it&apos;s not doing anything until the restart.&lt;/p&gt;

&lt;p&gt;Perhaps a good re-wording of this would be &quot;RegionServer Process Doesn&apos;t Die on Abnormal Loss of Network Connectivity to the Cluster&quot;? But then maybe this is considered normal (though I&apos;d expect something in the logs along the lines of &quot;Ceasing normal activity, but keeping process alive &lt;span class=&quot;error&quot;&gt;&amp;#91;for whatever reason&amp;#93;&lt;/span&gt;.&quot;&lt;/p&gt;

&lt;p&gt;It seems the advice to move the discussion to the mailing list would be apropos if RegionServer process staying alive under this circumstance is normal.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 14 Mar 2013 15:04:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>317527</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 39 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1isfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>317868</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>