<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:54:26 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8355/HBASE-8355.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8355] BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8355</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;As pointed out in &lt;a href=&quot;https://github.com/forcedotcom/phoenix/pull/131&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/forcedotcom/phoenix/pull/131&lt;/a&gt;, BaseRegionObserver#preCompactScannerOpen returns null by default, which hoses any coprocessors down the line, making override of this method mandatory. The fix is trivial, patch coming momentarily.&lt;/p&gt;

&lt;p&gt;Update:&lt;br/&gt;
This same behavior is present in the Flush and Store versions of the same method - this should all be moved to the proposed &apos;return passed scanner&apos; default behavior.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12642789">HBASE-8355</key>
            <summary>BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jesse_yates">Jesse Yates</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Apr 2013 18:55:23 +0000</created>
                <updated>Tue, 4 Jun 2013 00:06:58 +0000</updated>
                            <resolved>Wed, 15 May 2013 21:51:11 +0000</resolved>
                                    <version>0.98.0</version>
                    <version>0.94.8</version>
                    <version>0.95.1</version>
                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.94.8</fixVersion>
                    <fixVersion>0.95.1</fixVersion>
                                    <component>Coprocessors</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                            <comments>
                            <comment id="13633247" author="jesse_yates" created="Tue, 16 Apr 2013 19:43:38 +0000"  >&lt;p&gt;Looks good. Thanks for the patch Andy! &lt;/p&gt;</comment>
                            <comment id="13633251" author="jesse_yates" created="Tue, 16 Apr 2013 19:45:35 +0000"  >&lt;p&gt;I wasn&apos;t sure what the protocol on changing the expected behavior for CPs was for 0.94... guess its ok?&lt;/p&gt;</comment>
                            <comment id="13633286" author="hadoopqa" created="Tue, 16 Apr 2013 20:07:11 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12578989/8355.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12578989/8355.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestFromClientSide&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5328//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13633403" author="apurtell" created="Tue, 16 Apr 2013 21:39:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;I wasn&apos;t sure what the protocol on changing the expected behavior for CPs was for 0.94... guess its ok?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In my view we should not expect this behavior out of BaseRegionObserver#preCompactScannerOpen. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13633408" author="apurtell" created="Tue, 16 Apr 2013 21:41:36 +0000"  >&lt;p&gt;Test failure in above HadoopQA precommit build is out of TestFromClientSide.testPoolBehavior, which is not related to coprocessors or could be influenced by this change.&lt;/p&gt;

&lt;p&gt;Testing locally now.&lt;/p&gt;</comment>
                            <comment id="13633706" author="ram_krish" created="Wed, 17 Apr 2013 03:08:27 +0000"  >&lt;p&gt;+1 on patch.&lt;/p&gt;</comment>
                            <comment id="13633786" author="anoop.hbase" created="Wed, 17 Apr 2013 04:48:39 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13633804" author="apurtell" created="Wed, 17 Apr 2013 05:33:10 +0000"  >&lt;p&gt;0.94 tests:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Results :

Tests run: 867, Failures: 0, Errors: 0, Skipped: 2

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Trunk results:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[INFO] HBase ............................................. SUCCESS [2.401s]
[INFO] HBase - Common .................................... SUCCESS [26.682s]
[INFO] HBase - Protocol .................................. SUCCESS [13.424s]
[INFO] HBase - Client .................................... SUCCESS [11.731s]
[INFO] HBase - Prefix Tree ............................... SUCCESS [9.108s]
[INFO] HBase - Hadoop Compatibility ...................... SUCCESS [1.715s]
[INFO] HBase - Hadoop One Compatibility .................. SUCCESS [4.861s]
[INFO] HBase - Server .................................... SUCCESS [3:51:24.840s]
[INFO] HBase - Integration Tests ......................... SUCCESS [2.659s]
[INFO] HBase - Examples .................................. SUCCESS [2.316s]
[INFO] HBase - Assembly .................................. SUCCESS [0.071s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13633805" author="apurtell" created="Wed, 17 Apr 2013 05:34:19 +0000"  >&lt;p&gt;Going to commit to trunk, 0.95, and 0.94 tomorrow if no objection.&lt;/p&gt;</comment>
                            <comment id="13634253" author="lhofhansl" created="Wed, 17 Apr 2013 17:58:24 +0000"  >&lt;p&gt;I don&apos;t think this is right. The internal scanner passed is not the right scanner to use. I am surprised that this does not break many more tests.&lt;/p&gt;

&lt;p&gt;In Compactor.compact the result of preCompactScannerOpen need to be null in order to have the default action happening.&lt;/p&gt;</comment>
                            <comment id="13634258" author="jesse_yates" created="Wed, 17 Apr 2013 18:02:49 +0000"  >&lt;p&gt;From the patch Andrew was referencing on github in the description, here&apos;s the issue:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/**
+   * We override &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; method to ensure that any scanner from a previous coprocessor is returned. The
+   * &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; behavior is to &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &amp;lt;tt&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;&amp;lt;/tt&amp;gt;, which completely hoses any other coprocessors
+   * setup before, making ordering of coprocessors very important. By returning the passed scanner,
+   * we can avoid easy to make configuration errors.
+   */ 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13634260" author="apurtell" created="Wed, 17 Apr 2013 18:05:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t think this is right. The internal scanner passed is not the right scanner to use. I am surprised that this does not break many more tests.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks for the review. I made a bad assumption, so the patch is invalid, but there is still an issue here. &lt;/p&gt;</comment>
                            <comment id="13634264" author="apurtell" created="Wed, 17 Apr 2013 18:07:20 +0000"  >&lt;p&gt;Whatever we decide to do I will add a test for it before resolving this issue.&lt;/p&gt;</comment>
                            <comment id="13634286" author="lhofhansl" created="Wed, 17 Apr 2013 18:27:58 +0000"  >&lt;p&gt;This is really my fault. I needed coprocessor hooks for compactions that could return a new scanner, but also indicate when the default is used, returning null to indicate using the default seemed the best approach then... I did not think about chaining. My bad.&lt;/p&gt;

&lt;p&gt;Would need to think about a good API, that can:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;return a scanner when needed from the hook&lt;/li&gt;
	&lt;li&gt;indicate that the default action should be used&lt;/li&gt;
	&lt;li&gt;allow for chaining&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13634290" author="apurtell" created="Wed, 17 Apr 2013 18:31:18 +0000"  >&lt;p&gt;It would be nice to have Go&apos;s multiple returns. Maybe we can do Pair&amp;lt;Boolean,RegionScanner&amp;gt; as a poor man&apos;s alternative?&lt;/p&gt;</comment>
                            <comment id="13634294" author="jesse_yates" created="Wed, 17 Apr 2013 18:35:21 +0000"  >&lt;p&gt;We could use the context to do multiple outputs - similar to how we already manange bypass, etc through the context.&lt;/p&gt;</comment>
                            <comment id="13634296" author="apurtell" created="Wed, 17 Apr 2013 18:38:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;We could use the context to do multiple outputs&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I like handling this with the return slightly better but it&apos;s just personal taste, either option works. Shall I put up a patch for consideration? Do we care about backwards compatibility? (I argue no until we get this right, and also for removing the existing back compat added the last time we changed this hook for that reason &amp;#8211; or at least keeping only one back compat option.)&lt;/p&gt;</comment>
                            <comment id="13634301" author="jesse_yates" created="Wed, 17 Apr 2013 18:41:18 +0000"  >&lt;p&gt;Either way is fine - I&apos;ve just never like using Pair to hack multiple returns &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; In keeping with the style though, doing the Pair return seems more consistent.&lt;/p&gt;

&lt;p&gt;Yeah, a new patch would be great Andy! I was just thinking about backwards compat - it would be nice to not lose it and just add a new method with the new return that does the correct delegate method calling in BaseRegionObserver.&lt;/p&gt;</comment>
                            <comment id="13634307" author="apurtell" created="Wed, 17 Apr 2013 18:48:15 +0000"  >&lt;blockquote&gt;&lt;p&gt;it would be nice to not lose it and just add a new method with the new return that does the correct delegate method calling in BaseRegionObserver.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ok let me see what I can do.&lt;/p&gt;</comment>
                            <comment id="13648892" author="jesse_yates" created="Fri, 3 May 2013 23:18:28 +0000"  >&lt;p&gt;Looking at this more, I think Lar&apos;s comment doesn&apos;t apply:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I don&apos;t think this is right. The internal scanner passed is not the right scanner to use. I am surprised that this does not break many more tests.&lt;/p&gt;

&lt;p&gt;In Compactor.compact the result of preCompactScannerOpen need to be null in order to have the default action happening.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The code that call this is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; InternalScanner preCompactScannerOpen(Store store, List&amp;lt;StoreFileScanner&amp;gt; scanners,
      ScanType scanType, &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; earliestPutTs, CompactionRequest request) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    ObserverContext&amp;lt;RegionCoprocessorEnvironment&amp;gt; ctx = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    InternalScanner s = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (RegionEnvironment env: coprocessors) {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (env.getInstance() &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; RegionObserver) {
        ctx = ObserverContext.createAndPrepare(env, ctx);
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
          s = ((RegionObserver) env.getInstance()).preCompactScannerOpen(ctx, store, scanners,
            scanType, earliestPutTs, s, request);
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable e) {
          handleCoprocessorThrowable(env,e);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ctx.shouldComplete()) {
          &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
        }
      }
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; s;
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which starts by passing in null as the InternalScanner and pulls an internal scanner back out. So returning the passed InternalScanner - s - should be the correct default. &lt;/p&gt;

&lt;p&gt;So back to +1 for Andy&apos;s original, unless I&apos;m missing something?&lt;/p&gt;

&lt;p&gt;This led to two other things (that shouldn&apos;t necessarily be tackled here):&lt;br/&gt;
1. This same logic is present in preFlushScannerOpen and preCompactScanner open, with the same consequences&lt;br/&gt;
2. There is no easy solution for nested CPs creating new scanners - creating a brand new scanner will ignore any previous and setting Context#complete will ignore later CPs. I&apos;m working on a first cut solution and will open a new jira (or at least blog about it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; when I figure out what it looks like... unless someone has a suggestions?&lt;/p&gt;</comment>
                            <comment id="13648903" author="apurtell" created="Fri, 3 May 2013 23:24:44 +0000"  >&lt;p&gt;Thanks for looking at this again &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jesse_yates&quot; class=&quot;user-hover&quot; rel=&quot;jesse_yates&quot;&gt;Jesse Yates&lt;/a&gt;. I haven&apos;t had time. Reassign to yourself?&lt;/p&gt;</comment>
                            <comment id="13649018" author="lhofhansl" created="Sat, 4 May 2013 05:29:23 +0000"  >&lt;p&gt;Hmm... Yes. So at least I got that part of my original patch right. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I seem to recall that I had a good reason for returning null in BaseRegionObserver, but since I can&apos;t remember why now and there appears to be no good reason for it I agree with Jesse.&lt;/p&gt;</comment>
                            <comment id="13649964" author="jesse_yates" created="Mon, 6 May 2013 18:37:26 +0000"  >&lt;p&gt;Attaching trunk fix for pre(Compact|Flush|Store)ScannerOpen that returns the passed scanner, rather than null. &lt;/p&gt;

&lt;p&gt;Backports to 0.95 and 0.94 should be nearly the same - I&apos;ll do them, if people are +1 on this.&lt;/p&gt;</comment>
                            <comment id="13649978" author="lhofhansl" created="Mon, 6 May 2013 18:50:00 +0000"  >&lt;p&gt;+1 on patch. Sorry for the noise earlier.&lt;/p&gt;</comment>
                            <comment id="13650351" author="jesse_yates" created="Tue, 7 May 2013 01:31:02 +0000"  >&lt;p&gt;I&apos;d like to commit tomorrow, unless there are objections.&lt;/p&gt;</comment>
                            <comment id="13650352" author="apurtell" created="Tue, 7 May 2013 01:34:14 +0000"  >&lt;p&gt;+1 on patch, +1 on backports, +1 on commit, thanks Jesse.&lt;/p&gt;</comment>
                            <comment id="13652454" author="jesse_yates" created="Wed, 8 May 2013 22:48:31 +0000"  >&lt;p&gt;Adding patch for trunk for HadoopQA - only difference from last patch is actually adding some testing around the changed logic.&lt;/p&gt;</comment>
                            <comment id="13657363" author="jesse_yates" created="Tue, 14 May 2013 18:46:47 +0000"  >&lt;p&gt;Hmm, QA seems a bit slow... Ran tests locally - looked good. Planning to commit this evening, unless there are any objections.&lt;/p&gt;</comment>
                            <comment id="13658860" author="jesse_yates" created="Wed, 15 May 2013 21:47:47 +0000"  >&lt;p&gt;Attaching patch submitted to 0.94. Basically the same as trunk, just a couple minor fix-ups for older interfaces.&lt;/p&gt;</comment>
                            <comment id="13658929" author="hudson" created="Wed, 15 May 2013 22:31:10 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #141 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/141/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/141/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8355&quot; title=&quot;BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8355&quot;&gt;&lt;del&gt;HBASE-8355&lt;/del&gt;&lt;/a&gt;: BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null (Andrew Purtell, Jesse Yates) (Revision 1483103)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jyates : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/coprocessor/TestRegionObserverScannerOpenHook.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13659156" author="hudson" created="Thu, 16 May 2013 02:35:38 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #4122 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4122/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4122/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8355&quot; title=&quot;BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8355&quot;&gt;&lt;del&gt;HBASE-8355&lt;/del&gt;&lt;/a&gt;: BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null (Andrew Purtell, Jesse Yates) (Revision 1483094)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jyates : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestRegionObserverScannerOpenHook.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13659220" author="hudson" created="Thu, 16 May 2013 04:50:41 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #984 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/984/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/984/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8355&quot; title=&quot;BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8355&quot;&gt;&lt;del&gt;HBASE-8355&lt;/del&gt;&lt;/a&gt;: BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null (Andrew Purtell, Jesse Yates) (Revision 1483103)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
jyates : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/coprocessor/TestRegionObserverScannerOpenHook.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13659236" author="hudson" created="Thu, 16 May 2013 05:19:50 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #532 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/532/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/532/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8355&quot; title=&quot;BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8355&quot;&gt;&lt;del&gt;HBASE-8355&lt;/del&gt;&lt;/a&gt;: BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null (Andrew Purtell, Jesse Yates) (Revision 1483094)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jyates : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestRegionObserverScannerOpenHook.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13659270" author="hudson" created="Thu, 16 May 2013 06:13:06 +0000"  >&lt;p&gt;Integrated in hbase-0.95-on-hadoop2 #101 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95-on-hadoop2/101/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95-on-hadoop2/101/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8355&quot; title=&quot;BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8355&quot;&gt;&lt;del&gt;HBASE-8355&lt;/del&gt;&lt;/a&gt;: BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null (Andrew Purtell, Jesse Yates) (Revision 1483095)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jyates : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestRegionObserverScannerOpenHook.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13659280" author="hudson" created="Thu, 16 May 2013 06:15:37 +0000"  >&lt;p&gt;Integrated in hbase-0.95 #197 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/197/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/197/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8355&quot; title=&quot;BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8355&quot;&gt;&lt;del&gt;HBASE-8355&lt;/del&gt;&lt;/a&gt;: BaseRegionObserver#pre(Compact|Flush|Store)ScannerOpen returns null (Andrew Purtell, Jesse Yates) (Revision 1483095)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jyates : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestRegionObserverScannerOpenHook.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12578988" name="8355-0.94.patch" size="687" author="apurtell" created="Tue, 16 Apr 2013 19:00:47 +0000"/>
                            <attachment id="12578989" name="8355.patch" size="687" author="apurtell" created="Tue, 16 Apr 2013 19:00:56 +0000"/>
                            <attachment id="12583381" name="hbase-8355-0.94-v0.patch" size="13682" author="jesse_yates" created="Wed, 15 May 2013 21:47:47 +0000"/>
                            <attachment id="12581928" name="hbase-8355-trunk-v0.patch" size="1518" author="jesse_yates" created="Mon, 6 May 2013 18:37:26 +0000"/>
                            <attachment id="12582373" name="hbase-8355-trunk-v1.patch" size="13797" author="jesse_yates" created="Wed, 8 May 2013 22:48:31 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12643027">HBASE-8363</subtask>
                            <subtask id="12643028">HBASE-8364</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Apr 2013 19:43:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323203</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 31 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jrhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323548</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>As pointed out in &lt;a href=&quot;https://github.com/forcedotcom/phoenix/pull/131,&quot;&gt;https://github.com/forcedotcom/phoenix/pull/131,&lt;/a&gt; BaseRegionObserver#preCompactScannerOpen returns null by default, which hoses any coprocessors down the line, making override of this method mandatory in all subclasses of BaseRegionObserver, when there are multiple levels of coprocessor stacking - this same behavior is present in preFlushScannerOpen and preStoreScannerOpen. &lt;br/&gt;
&lt;br/&gt;
Instead, we default to returning the passed scanner so earlier coprocessor changes are preserved and still support the default &amp;quot;no custom scanner&amp;quot; by returning null (default scanner passed to each hook).</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>