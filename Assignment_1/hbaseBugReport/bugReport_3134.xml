<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:07:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3134/HBASE-3134.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3134] [replication] Add the ability to enable/disable streams</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3134</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This jira was initially in the scope of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2201&quot; title=&quot;JRuby shell for replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2201&quot;&gt;&lt;del&gt;HBASE-2201&lt;/del&gt;&lt;/a&gt;, but was pushed out since it has low value compared to the required effort (and when want to ship 0.90.0 rather soonish).&lt;/p&gt;

&lt;p&gt;We need to design a way to enable/disable replication streams in a determinate fashion.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12477804">HBASE-3134</key>
            <summary>[replication] Add the ability to enable/disable streams</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tzenmyo">Teruyoshi Zenmyo</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                            <label>replication</label>
                    </labels>
                <created>Wed, 20 Oct 2010 00:19:58 +0000</created>
                <updated>Fri, 12 Oct 2012 05:34:58 +0000</updated>
                            <resolved>Tue, 3 Apr 2012 04:17:08 +0000</resolved>
                                                    <fixVersion>0.94.0</fixVersion>
                                    <component>Replication</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13047684" author="stack" created="Fri, 10 Jun 2011 22:58:20 +0000"  >&lt;p&gt;Moving out of 0.92.  Move it back in if you think differently.&lt;/p&gt;</comment>
                            <comment id="13047698" author="stack" created="Fri, 10 Jun 2011 22:58:22 +0000"  >&lt;p&gt;Moving out of 0.92.  Move it back in if you think differently.&lt;/p&gt;</comment>
                            <comment id="13193636" author="tzenmyo" created="Thu, 26 Jan 2012 07:48:20 +0000"  >&lt;p&gt;The patch introduces a znode which indicates that replication to a peer is disabled. ReplicationSource skips sending entries if the znode exists.&lt;/p&gt;</comment>
                            <comment id="13194385" author="zhihyu@ebaysf.com" created="Fri, 27 Jan 2012 03:00:51 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      ZKUtil.deleteNode(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.zookeeper, getPeerStateZNode(id));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;There might be confusion because whether the peer is enabled/disabled is represented by the presence of the peer state znode. A better way is to store data in corresponding peer state znode.&lt;/p&gt;

&lt;p&gt;I also see similarity between enablePeer() and disablePeer(). Is it possible to create a single method, changePeerState(String id, ChangeType ct) where ChangeType is an enum indicating what to change ?&lt;/p&gt;

&lt;p&gt;Uploading the patch onto reviewboard would allow other people to give more precise reviews.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13194386" author="hadoopqa" created="Fri, 27 Jan 2012 03:03:31 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12511955/HBASE-3134.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12511955/HBASE-3134.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -140 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 161 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestFromClientSide&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestReplicationPeer&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestHFileBlock&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/855//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/855//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/855//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/855//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/855//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/855//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13194458" author="lhofhansl" created="Fri, 27 Jan 2012 05:04:47 +0000"  >&lt;p&gt;Just so I understand... The difference to &lt;/p&gt;
{add|remove}
&lt;p&gt;Peer is that the ReplicationSource still keeps track of the logs to be transfered to just temporarily disables shipment?&lt;/p&gt;

&lt;p&gt;Maybe we can show the state via ReplicationZookeeper.listPeers, which is used by the shell to show all peers.&lt;/p&gt;

&lt;p&gt;Personally I like enablePeer() and disablePeer(), because it is entirely clear what they are doing.&lt;/p&gt;</comment>
                            <comment id="13194526" author="tzenmyo" created="Fri, 27 Jan 2012 07:27:32 +0000"  >&lt;p&gt;Thanks for feedbacks.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The difference to {add|remove}Peer is that the ReplicationSource still keeps track of the logs to be transfered to just temporarily disables shipment?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yes&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Maybe we can show the state via ReplicationZookeeper.listPeers, which is used by the shell to show all peers.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Should I do this in this ticket or file another issue?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Personally I like enablePeer() and disablePeer(), because it is entirely clear what they are doing.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think so, too. I&apos;d like to extract a method to remove duplicated parts.&lt;/p&gt;
</comment>
                            <comment id="13195189" author="stack" created="Fri, 27 Jan 2012 22:45:18 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should I do this in this ticket or file another issue?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Up to you.&lt;/p&gt;</comment>
                            <comment id="13195283" author="lhofhansl" created="Sat, 28 Jan 2012 00:30:57 +0000"  >&lt;p&gt;If it&apos;s not too much extra work I think we can add that here.&lt;br/&gt;
Should add support for &lt;/p&gt;
{enable|disable}
&lt;p&gt;Peer to the shell as well.&lt;/p&gt;

&lt;p&gt;So what happens when you disable a peer and forgot to enable it? Will it collect logs forever?&lt;/p&gt;</comment>
                            <comment id="13195573" author="tzenmyo" created="Sat, 28 Jan 2012 16:27:48 +0000"  >&lt;p&gt;Yes. The paths to WAL files are collected in the queue of the ReplicationSource.&lt;br/&gt;
I expect that it tolerates rather long suspension because the WAL rolling period would be relatively long.&lt;/p&gt;</comment>
                            <comment id="13197703" author="tzenmyo" created="Wed, 1 Feb 2012 09:21:26 +0000"  >&lt;p&gt;The attached file is a patch with list_peers support.&lt;/p&gt;</comment>
                            <comment id="13197731" author="hadoopqa" created="Wed, 1 Feb 2012 10:09:07 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12512737/HBASE-3134.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12512737/HBASE-3134.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -140 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 157 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/886//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/886//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/886//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/886//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/886//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/886//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13198028" author="zhihyu@ebaysf.com" created="Wed, 1 Feb 2012 18:29:51 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (sleepForRetries(&lt;span class=&quot;code-quote&quot;&gt;&quot;peer &quot;&lt;/span&gt; + peerId + &lt;span class=&quot;code-quote&quot;&gt;&quot; is disalbed&quot;&lt;/span&gt;,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Typo: disabled.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-comment&quot;&gt;// Values of znode which represents state of a peer&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please change &apos;represents&apos; to &apos;represent&apos;.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-comment&quot;&gt;// Name of a node which indicate whether a peer is enabled or not
&lt;/span&gt;+  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; peerStateNodeName;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Javadoc should be changed to &apos;Name of zk node which stores peer state&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.peerStateNodeName = conf.get(
+        &lt;span class=&quot;code-quote&quot;&gt;&quot;zookeeper.znode.replication.peers.state&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;state&quot;&lt;/span&gt;);
     &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.replicationStateNodeName =
         conf.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;zookeeper.znode.replication.state&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;state&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&quot;state&quot; has been taken. Would &quot;peer-state&quot; be a better default ?&lt;br/&gt;
We should also check that the values for these two states are different.&lt;/p&gt;</comment>
                            <comment id="13198032" author="zhihyu@ebaysf.com" created="Wed, 1 Feb 2012 18:33:36 +0000"  >&lt;p&gt;In changePeerState():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          Bytes.toBytes(state.name()));
+      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;peer &quot;&lt;/span&gt; + id + &lt;span class=&quot;code-quote&quot;&gt;&quot; is disabled&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please put state.name() in the log.&lt;/p&gt;</comment>
                            <comment id="13198493" author="tzenmyo" created="Thu, 2 Feb 2012 02:43:16 +0000"  >&lt;p&gt;Thank you for comments and sorry for my typos.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;We should also check that the values for these two states are different.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Could you explain the reason why we need the check?&lt;br/&gt;
Peer state zk nodes and a replication state zk node have a respectively different parent node.&lt;br/&gt;
The peer state zk nodes are created under each peer&apos;s zk node and the replication state zk node is created under the root replication zk node.&lt;br/&gt;
Therefore, it seemed to be no problem in case the values for these two states are same.&lt;/p&gt;</comment>
                            <comment id="13198496" author="zhihyu@ebaysf.com" created="Thu, 2 Feb 2012 02:48:13 +0000"  >&lt;p&gt;Thanks for the explanation.&lt;br/&gt;
I realized that is the case after putting in my comment.&lt;/p&gt;</comment>
                            <comment id="13198517" author="zhihyu@ebaysf.com" created="Thu, 2 Feb 2012 03:51:26 +0000"  >&lt;p&gt;@J-D:&lt;br/&gt;
Do you want to take a look ?&lt;/p&gt;</comment>
                            <comment id="13198567" author="lhofhansl" created="Thu, 2 Feb 2012 06:50:58 +0000"  >&lt;p&gt;Nit: In the test:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; NB_RETRIES; i++) {
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (i == NB_RETRIES - 1) {
+        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It is equivalent to &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; NB_RETRIES-1; i++)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And since we&apos;re just waiting for some to make sure that nothing was replicated, might as well go &apos;round one more time and just remove the if statement.&lt;/p&gt;

&lt;p&gt;Also this will always wait for 5s (not a big deal but would be nice to avoid this somehow).&lt;/p&gt;

&lt;p&gt;TestReplication.testStartStop() does exactly the same, though.&lt;/p&gt;

&lt;p&gt;+1 otherwise&lt;/p&gt;</comment>
                            <comment id="13200436" author="tzenmyo" created="Sat, 4 Feb 2012 13:36:26 +0000"  >&lt;p&gt;The patch is updated. A test and some comments and typos are modified.&lt;/p&gt;</comment>
                            <comment id="13200456" author="hadoopqa" created="Sat, 4 Feb 2012 14:30:08 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12513253/HBASE-3134.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12513253/HBASE-3134.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -136 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 156 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/903//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/903//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/903//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/903//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/903//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/903//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13200615" author="lhofhansl" created="Sun, 5 Feb 2012 01:04:07 +0000"  >&lt;p&gt;I think this is good to go. Let&apos;s get J-D to look at it once.&lt;/p&gt;</comment>
                            <comment id="13201862" author="jdcryans" created="Tue, 7 Feb 2012 00:17:48 +0000"  >&lt;p&gt;We can&apos;t hit ZK every time we replicate in order to see what the state is, each RS instead should have a watcher and the check should be done locally. The rest looks good, thanks a lot for working on this.&lt;/p&gt;</comment>
                            <comment id="13202217" author="tzenmyo" created="Tue, 7 Feb 2012 10:21:31 +0000"  >&lt;p&gt;Thanks for the feedback. I will update the patch in a couple of days.&lt;/p&gt;</comment>
                            <comment id="13203686" author="tzenmyo" created="Wed, 8 Feb 2012 15:55:04 +0000"  >&lt;p&gt;The attached file is the updated patch which is also uploaded to the reviewboard.&lt;/p&gt;</comment>
                            <comment id="13203731" author="hadoopqa" created="Wed, 8 Feb 2012 16:43:41 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12513828/HBASE-3134.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12513828/HBASE-3134.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -136 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 156 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestRegionRebalancing&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestHFileBlock&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/924//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/924//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/924//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/924//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/924//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/924//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13203737" author="zhihyu@ebaysf.com" created="Wed, 8 Feb 2012 16:49:12 +0000"  >&lt;p&gt;@Teruyoshi:&lt;br/&gt;
Can you publish the URL for review request on review board ?&lt;/p&gt;</comment>
                            <comment id="13203750" author="tzenmyo" created="Wed, 8 Feb 2012 17:08:46 +0000"  >&lt;p&gt;Here is the URL.&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3686/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3686/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13204581" author="zhihyu@ebaysf.com" created="Thu, 9 Feb 2012 15:15:30 +0000"  >&lt;p&gt;Patch from Teruyoshi&lt;/p&gt;</comment>
                            <comment id="13204609" author="hadoopqa" created="Thu, 9 Feb 2012 16:06:25 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12513966/3134.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12513966/3134.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -136 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 156 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.io.hfile.TestHFileBlock&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/928//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/928//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/928//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/928//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/928//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/928//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13204642" author="zhihyu@ebaysf.com" created="Thu, 9 Feb 2012 16:53:31 +0000"  >&lt;p&gt;@J-D:&lt;br/&gt;
Do you want to take another look at the patch ?&lt;/p&gt;</comment>
                            <comment id="13204891" author="zhihyu@ebaysf.com" created="Thu, 9 Feb 2012 21:26:24 +0000"  >&lt;p&gt;Added KeeperException as cause for IOException&lt;/p&gt;</comment>
                            <comment id="13204948" author="hadoopqa" created="Thu, 9 Feb 2012 22:12:36 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12514010/3134-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12514010/3134-v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -136 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 156 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.io.hfile.TestHFileBlock&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/931//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/931//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/931//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/931//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/931//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/931//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13205679" author="jdcryans" created="Fri, 10 Feb 2012 19:34:06 +0000"  >&lt;p&gt;On &quot;3134-v2.txt&quot;:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;HashMap won&apos;t work here, the watchers are triggered in a separate thread from the rest. Need a concurrent version.&lt;/li&gt;
	&lt;li&gt;It seems that ReplicationSourceManager.addPeer needs some changes too&lt;/li&gt;
	&lt;li&gt;Finally, it&apos;s not clear what&apos;s going to happen when you apply the patch on an existing setup where the znode doesn&apos;t exist... it seems it would fail on finding the znode.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We&apos;re progressing.&lt;/p&gt;</comment>
                            <comment id="13205707" author="zhihyu@ebaysf.com" created="Fri, 10 Feb 2012 20:04:07 +0000"  >&lt;p&gt;For #3 above, in changePeerState() etc, we should distinguish KeeperException.NoNodeException from other KeeperException&apos;s:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void changePeerState(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; id, PeerState state) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
...
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (KeeperException e) {
+      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to change state of the peer &quot;&lt;/span&gt; + id, e);
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Basically when a peer exists but peer state znode doesn&apos;t exist, we should add the peer state znode.&lt;/p&gt;</comment>
                            <comment id="13205710" author="zhihyu@ebaysf.com" created="Fri, 10 Feb 2012 20:08:55 +0000"  >&lt;p&gt;For #1 above, is it about peerStateTrackers ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.peerClusters = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, ReplicationPeer&amp;gt;();
+    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.peerStateTrackers = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, PeerStateTracker&amp;gt;();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Its usage is in line with that of peerClusters. Since the key is peer id and peer should be registered first, I don&apos;t see a problem here.&lt;/p&gt;</comment>
                            <comment id="13205764" author="jdcryans" created="Fri, 10 Feb 2012 21:20:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;Its usage is in line with that of peerClusters. Since the key is peer id and peer should be registered first, I don&apos;t see a problem here.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It should be changed too, originally it wasn&apos;t used by multiple threads because there was a maximum of one peer. Just to be safe.&lt;/p&gt;</comment>
                            <comment id="13206438" author="tzenmyo" created="Sun, 12 Feb 2012 15:51:42 +0000"  >&lt;blockquote&gt;
&lt;p&gt;It should be changed too, originally it wasn&apos;t used by multiple threads because there was a maximum of one peer. Just to be safe.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think it is better to remove the peerStateTrackers and manage peers with one HashMap(the peerClusters) by moving the PeerStateTracker to ReplicationPeer. Then the peerCluster should be fixed to be thread safe.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;It seems that ReplicationSourceManager.addPeer needs some changes too&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Is it about ReplicationSourceManager.addSource?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; ReplicationSourceInterface addSource(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; id) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    ReplicationSourceInterface src =
        getReplicationSource(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.conf, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fs, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, stopper, replicating, id);
    &lt;span class=&quot;code-comment&quot;&gt;// TODO set it to what&apos;s in ZK
&lt;/span&gt;    src.setSourceEnabled(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.hlogsById) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The sourceEnabled and ReplicationPeer.peerEnabled seem to have a same role. Can the sourceEnable be removed?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Basically when a peer exists but peer state znode doesn&apos;t exist, we should add the peer state znode.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I will fix this in the next patch.&lt;/p&gt;</comment>
                            <comment id="13207099" author="jdcryans" created="Mon, 13 Feb 2012 19:22:32 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think it is better to remove the peerStateTrackers and manage peers with one HashMap(the peerClusters) by moving the PeerStateTracker to ReplicationPeer&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah it&apos;d be worth trying.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The sourceEnabled and ReplicationPeer.peerEnabled seem to have a same role. Can the sourceEnable be removed?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah sourceEnabled was a placeholder, if you think it&apos;s better in ReplicationPeer then go for it. Just don&apos;t forget to do the check in there to verify what&apos;s in ZK.&lt;/p&gt;
</comment>
                            <comment id="13208412" author="jiraposter@reviews.apache.org" created="Wed, 15 Feb 2012 12:18:58 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3686/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3686/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2012-02-15 12:17:50.909795)&lt;/p&gt;


&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PeerStateTracker is moved to ReplicationPeer&lt;/li&gt;
	&lt;li&gt;ReplicationSource.sourceEnabled is removed&lt;br/&gt;
  (Each ReplicationSource checks what&apos;s in ZK through ReplicationZookeeper)&lt;/li&gt;
	&lt;li&gt;Existence of peer state zk nodes is checked and the zk node would be created if it does not exist.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;However, ReplicationZookeeper is still not thread safe. &lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;1. The patch introduces a znode which represents whether a peer is enabled or not. ReplicationSource skips sending entries if the replication is disabled.&lt;br/&gt;
2. The &quot;list_peers&quot; shows state of each peer and support for &lt;/p&gt;
{enable|disable}
&lt;p&gt;Peer is added.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3134&quot; title=&quot;[replication] Add the ability to enable/disable streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3134&quot;&gt;&lt;del&gt;HBASE-3134&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3134&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-3134&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/replication/ReplicationAdmin.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/replication/ReplicationAdmin.java&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationPeer.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationPeer.java&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/hbase/replication_admin.rb&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/hbase/replication_admin.rb&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/shell/commands/list_peers.rb&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/shell/commands/list_peers.rb&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/a&gt; 1244330 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/regionserver/TestReplicationSourceManager.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/regionserver/TestReplicationSourceManager.java&lt;/a&gt; 1244330 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3686/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3686/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;1. TestReplication passed.&lt;br/&gt;
2. Checked on a cluster with some updates (puts) from shell.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Teruyoshi&lt;/p&gt;
</comment>
                            <comment id="13211780" author="tzenmyo" created="Mon, 20 Feb 2012 11:31:49 +0000"  >&lt;p&gt;The patch is updated.&lt;br/&gt;
The peerClusters is still HashMap because making a concurrent version would require modifications irrelevant to this ability.&lt;/p&gt;</comment>
                            <comment id="13211796" author="zhihyu@ebaysf.com" created="Mon, 20 Feb 2012 11:56:20 +0000"  >&lt;p&gt;Patch v3 looks good.&lt;/p&gt;</comment>
                            <comment id="13211805" author="hadoopqa" created="Mon, 20 Feb 2012 12:25:07 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12515234/3134-v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12515234/3134-v3.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -136 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 159 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestAdmin&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/992//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/992//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/992//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/992//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/992//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/992//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13214984" author="jdcryans" created="Thu, 23 Feb 2012 19:44:39 +0000"  >&lt;p&gt;Patch looks good. Was it tested outside of unit tests?&lt;/p&gt;</comment>
                            <comment id="13215354" author="tzenmyo" created="Fri, 24 Feb 2012 03:55:38 +0000"  >&lt;p&gt;I have checked on a testing environment (coexisting cluster) with some updates (puts) from shell.&lt;/p&gt;</comment>
                            <comment id="13221060" author="zhihyu@ebaysf.com" created="Fri, 2 Mar 2012 17:06:36 +0000"  >&lt;p&gt;@J-D:&lt;br/&gt;
Can you outline the tests you were planning ?&lt;/p&gt;</comment>
                            <comment id="13234951" author="lhofhansl" created="Wed, 21 Mar 2012 20:01:06 +0000"  >&lt;p&gt;Is this ready for commit? Otherwise I&apos;ll push it to 0.96 (or maybe 0.94.1)&lt;/p&gt;</comment>
                            <comment id="13234965" author="jdcryans" created="Wed, 21 Mar 2012 20:10:08 +0000"  >&lt;p&gt;I&apos;m on it today.&lt;/p&gt;</comment>
                            <comment id="13235013" author="jdcryans" created="Wed, 21 Mar 2012 20:50:48 +0000"  >&lt;p&gt;I found one corner case:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;start replication with a peer&lt;/li&gt;
	&lt;li&gt;insert some data&lt;/li&gt;
	&lt;li&gt;kill the peer&lt;/li&gt;
	&lt;li&gt;disable replication&lt;/li&gt;
	&lt;li&gt;start the peer&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;The issue is that when the peer is restarted the region servers will be able to replicate the batch they are currently trying to send. Here&apos;s the log:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-03-21 20:40:14,775 INFO org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Slave cluster looks down: Failed setting up proxy interface org.apache.hadoop.hbase.ipc.HRegionInterface to sv4r9s44/10.4.9.44:62023 after attempts=1
2012-03-21 20:40:15,774 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Since we are unable to replicate, sleeping 1000 times 9
2012-03-21 20:40:24,786 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Replicating 149
2012-03-21 20:40:30,826 INFO org.apache.hadoop.hbase.replication.regionserver.ReplicationSourceManager: Going to report log #sv4r8s38%2C62023%2C1332361576338.1332361577015 for position 303630357 in hdfs://sv4r11s38:9100/hbase/.logs/sv4r8s38,62023,1332361576338/sv4r8s38%2C62023%2C1332361576338.1332361577015
2012-03-21 20:40:30,830 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Replicated in total: 149
2012-03-21 20:40:30,830 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Replication is disabled, sleeping 1000 times 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Right now &lt;tt&gt;shipEdits&lt;/tt&gt; won&apos;t let you throw an &lt;tt&gt;Exception&lt;/tt&gt; as it catches everything, so we could change that or we could change the loop at the end of the method to stay in there until replication is re-enabled (at which point the edits will be sent directly). I&apos;m also opened to other suggestions.&lt;/p&gt;

&lt;p&gt;Another thing I saw is that both &lt;tt&gt;enable_peer&lt;/tt&gt; and &lt;tt&gt;disable_peer&lt;/tt&gt; in the shell still show &quot;CURRENTLY UNSUPPORTED&quot; in their help.&lt;/p&gt;

&lt;p&gt;I&apos;m sorry it took me so long to get to this jira.&lt;/p&gt;</comment>
                            <comment id="13235055" author="jdcryans" created="Wed, 21 Mar 2012 21:35:11 +0000"  >&lt;p&gt;I did some more testing, couldn&apos;t find anything else.&lt;/p&gt;</comment>
                            <comment id="13235593" author="tzenmyo" created="Thu, 22 Mar 2012 14:16:16 +0000"  >&lt;p&gt;Thanks for feedbacks and testing J-D.&lt;br/&gt;
I&apos;ll update the patch (&lt;/p&gt;</comment>
                            <comment id="13235597" author="tzenmyo" created="Thu, 22 Mar 2012 14:24:23 +0000"  >&lt;p&gt;I&apos;m sorry, the above has sent on the way by mistake. &lt;/p&gt;

&lt;p&gt;Thanks for feedbacks and testing, J-D.&lt;br/&gt;
I&apos;ll update the patch (maybe tomorrow if I can)&lt;/p&gt;

&lt;p&gt;@Lars&lt;br/&gt;
Please push this to later version.&lt;br/&gt;
I hope that 0.94 is released faster.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13235644" author="lhofhansl" created="Thu, 22 Mar 2012 15:32:23 +0000"  >&lt;p&gt;Thanks Teruyoshi, moving it to 0.94.1 for now.&lt;/p&gt;</comment>
                            <comment id="13236450" author="jiraposter@reviews.apache.org" created="Fri, 23 Mar 2012 08:17:31 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3686/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3686/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2012-03-23 08:16:47.333041)&lt;/p&gt;


&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This update addresses the issue found by J-D.&lt;br/&gt;
A new test which fails without the modification to the shipEdits() is added to the TestReplication.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;1. The patch introduces a znode which represents whether a peer is enabled or not. ReplicationSource skips sending entries if the replication is disabled.&lt;br/&gt;
2. The &quot;list_peers&quot; shows state of each peer and support for &lt;/p&gt;
{enable|disable}
&lt;p&gt;Peer is added.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3134&quot; title=&quot;[replication] Add the ability to enable/disable streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3134&quot;&gt;&lt;del&gt;HBASE-3134&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3134&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-3134&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/replication/ReplicationAdmin.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/replication/ReplicationAdmin.java&lt;/a&gt; 1304172 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationPeer.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationPeer.java&lt;/a&gt; 1304190 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/a&gt; 1304190 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/a&gt; 1304190 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&lt;/a&gt; 1304190 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/a&gt; 1304190 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/hbase/replication_admin.rb&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/hbase/replication_admin.rb&lt;/a&gt; 1304172 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/shell/commands/disable_peer.rb&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/shell/commands/disable_peer.rb&lt;/a&gt; 1304172 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/shell/commands/enable_peer.rb&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/shell/commands/enable_peer.rb&lt;/a&gt; 1304172 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/shell/commands/list_peers.rb&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/main/ruby/shell/commands/list_peers.rb&lt;/a&gt; 1304172 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&lt;/a&gt; 1304172 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/a&gt; 1304172 &lt;br/&gt;
  &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/regionserver/TestReplicationSourceManager.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/regionserver/TestReplicationSourceManager.java&lt;/a&gt; 1304172 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3686/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3686/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;1. TestReplication passed.&lt;br/&gt;
2. Checked on a cluster with some updates (puts) from shell.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Teruyoshi&lt;/p&gt;
</comment>
                            <comment id="13238807" author="jdcryans" created="Mon, 26 Mar 2012 20:54:21 +0000"  >&lt;p&gt;+1 on the patch you put up on review board Teruyoshi, can you attach it here and grant the license so that I can commit? Thanks!&lt;/p&gt;</comment>
                            <comment id="13239156" author="tzenmyo" created="Tue, 27 Mar 2012 03:57:53 +0000"  >&lt;p&gt;@J-D&lt;br/&gt;
Thanks for the review.&lt;br/&gt;
I attached the patch with a trivial modification. (The constants in the new test are modified to the static variables of the TestReplication).&lt;/p&gt;</comment>
                            <comment id="13239185" author="hadoopqa" created="Tue, 27 Mar 2012 04:59:56 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12520058/3134-v4.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12520058/3134-v4.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 1 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestAtomicOperation&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1318//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1318//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1318//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1318//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1318//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1318//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13239199" author="lhofhansl" created="Tue, 27 Mar 2012 05:40:14 +0000"  >&lt;p&gt;Hmm... TestAtomicOperation still failing. Unrelated to this change, though.&lt;/p&gt;</comment>
                            <comment id="13239929" author="jdcryans" created="Tue, 27 Mar 2012 20:40:40 +0000"  >&lt;p&gt;Lars, do you want to pull this into 0.94.0 or are you too far down the process?&lt;/p&gt;</comment>
                            <comment id="13239944" author="lhofhansl" created="Tue, 27 Mar 2012 20:56:30 +0000"  >&lt;p&gt;Let&apos;s leave it out, unless I&apos;m pulling in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5656&quot; title=&quot;LoadIncrementalHFiles createTable should detect and set compression algorithm&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5656&quot;&gt;&lt;del&gt;HBASE-5656&lt;/del&gt;&lt;/a&gt; (since I&apos;d have to trigger a new build in that case).&lt;/p&gt;</comment>
                            <comment id="13239951" author="jdcryans" created="Tue, 27 Mar 2012 21:02:07 +0000"  >&lt;p&gt;No problem, next RC then &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13244747" author="lhofhansl" created="Mon, 2 Apr 2012 22:22:57 +0000"  >&lt;p&gt;Since I sunk 0.94.0rc0, could get it in now.&lt;br/&gt;
Everybody down with that?&lt;/p&gt;</comment>
                            <comment id="13244759" author="jdcryans" created="Mon, 2 Apr 2012 22:26:24 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13244959" author="lhofhansl" created="Tue, 3 Apr 2012 04:17:09 +0000"  >&lt;p&gt;Committed to 0.94 and 0.96.&lt;br/&gt;
Thanks for the patch Teruyoshi.&lt;br/&gt;
Thanks for the reviews.&lt;/p&gt;</comment>
                            <comment id="13244974" author="hudson" created="Tue, 3 Apr 2012 05:01:40 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #82 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/82/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/82/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3134&quot; title=&quot;[replication] Add the ability to enable/disable streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3134&quot;&gt;&lt;del&gt;HBASE-3134&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;replication&amp;#93;&lt;/span&gt; Add the ability to enable/disable streams (Teruyoshi Zenmyo) (Revision 1308676)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/replication/ReplicationAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationPeer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/hbase/replication_admin.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/shell/commands/disable_peer.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/shell/commands/enable_peer.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/shell/commands/list_peers.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/regionserver/TestReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13245001" author="hudson" created="Tue, 3 Apr 2012 05:54:30 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #156 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/156/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/156/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3134&quot; title=&quot;[replication] Add the ability to enable/disable streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3134&quot;&gt;&lt;del&gt;HBASE-3134&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;replication&amp;#93;&lt;/span&gt; Add the ability to enable/disable streams (Teruyoshi Zenmyo) (Revision 1308675)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/replication/ReplicationAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationPeer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/ruby/hbase/replication_admin.rb&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/ruby/shell/commands/disable_peer.rb&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/ruby/shell/commands/enable_peer.rb&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/ruby/shell/commands/list_peers.rb&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/regionserver/TestReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13245745" author="hudson" created="Tue, 3 Apr 2012 21:08:35 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2706 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2706/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2706/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3134&quot; title=&quot;[replication] Add the ability to enable/disable streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3134&quot;&gt;&lt;del&gt;HBASE-3134&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;replication&amp;#93;&lt;/span&gt; Add the ability to enable/disable streams (Teruyoshi Zenmyo) (Revision 1308675)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/replication/ReplicationAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationPeer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/ruby/hbase/replication_admin.rb&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/ruby/shell/commands/disable_peer.rb&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/ruby/shell/commands/enable_peer.rb&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/ruby/shell/commands/list_peers.rb&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/replication/regionserver/TestReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13246896" author="hudson" created="Thu, 5 Apr 2012 00:53:32 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #7 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/7/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/7/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3134&quot; title=&quot;[replication] Add the ability to enable/disable streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3134&quot;&gt;&lt;del&gt;HBASE-3134&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;replication&amp;#93;&lt;/span&gt; Add the ability to enable/disable streams (Teruyoshi Zenmyo) (Revision 1308676)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/replication/ReplicationAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationPeer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/hbase/replication_admin.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/shell/commands/disable_peer.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/shell/commands/enable_peer.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/shell/commands/list_peers.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/regionserver/TestReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12455801">HBASE-2201</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12514010" name="3134-v2.txt" size="16989" author="zhihyu@ebaysf.com" created="Thu, 9 Feb 2012 21:26:23 +0000"/>
                            <attachment id="12515234" name="3134-v3.txt" size="21956" author="tzenmyo" created="Mon, 20 Feb 2012 11:31:48 +0000"/>
                            <attachment id="12520058" name="3134-v4.txt" size="25300" author="tzenmyo" created="Tue, 27 Mar 2012 03:57:53 +0000"/>
                            <attachment id="12513966" name="3134.txt" size="16986" author="zhihyu@ebaysf.com" created="Thu, 9 Feb 2012 15:15:30 +0000"/>
                            <attachment id="12513828" name="HBASE-3134.patch" size="17103" author="tzenmyo" created="Wed, 8 Feb 2012 15:55:04 +0000"/>
                            <attachment id="12513253" name="HBASE-3134.patch" size="12021" author="tzenmyo" created="Sat, 4 Feb 2012 13:36:25 +0000"/>
                            <attachment id="12512737" name="HBASE-3134.patch" size="11351" author="tzenmyo" created="Wed, 1 Feb 2012 09:21:26 +0000"/>
                            <attachment id="12511955" name="HBASE-3134.patch" size="8408" author="tzenmyo" created="Thu, 26 Jan 2012 07:48:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 10 Jun 2011 22:58:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32917</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 37 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08r8f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49012</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>