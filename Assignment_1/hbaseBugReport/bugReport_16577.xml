<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:15:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-16577/HBASE-16577.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-16577] Toward a more useful slow query log</title>
                <link>https://issues.apache.org/jira/browse/HBASE-16577</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I was looking at the nature and distribution of responseTooSlow messages on our clusters. The majority of responseTooSlow warnings are for Scan or Multi. &lt;/p&gt;

&lt;p&gt;Scans may take a long time to return. It will totally depend on how much data is in the table, how the data is distributed, and the range and selectivity of the query. We are not measuring response time in a way to know what is proportionate to the work requested. Another problematic example is Multi. We don&apos;t get valid results considering a multi with 1 op and a multi with 100 ops to be equivalent as far as being &quot;too slow&quot;. &lt;/p&gt;

&lt;p&gt;If we aggressively filter responseTooSlow messages to just include the ops we can expect to be small, constant, request-independent units of work, this leaves us with Get and Mutate. This gives us no more information then we get from the Canary with read and write checks turned on. The Canary issues Get and Mutate ops and, better, measures availability and latency from the client perspective. &lt;/p&gt;

&lt;p&gt;Where I end up is I think my shop should ignore responseTooSlow as signal as being far too noisy. The trouble then is it is logged at WARN level. This implies there is something wrong that needs to be fixed. That may not be the case. It&apos;s going to require some analysis of the application and the request particulars extracted from the log line. WARN seems inappropriate for this type of indication. There&apos;s nothing (necessarily) wrong with HBase, or the app. Should be logged at more like INFO. &lt;/p&gt;

&lt;p&gt;Furthermore the response might not be too slow, so calling it &quot;responseTooSlow&quot; isn&apos;t quite right. More like &quot;responseMaybeSlow&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13003351">HBASE-16577</key>
            <summary>Toward a more useful slow query log</summary>
                <type id="13" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/genericissue.png">Brainstorming</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Sep 2016 18:45:27 +0000</created>
                <updated>Fri, 9 Sep 2016 19:34:45 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="15471760" author="enis" created="Wed, 7 Sep 2016 20:51:11 +0000"  >&lt;p&gt;Maybe have different limits to scan vs get vs multi? &lt;/p&gt;</comment>
                            <comment id="15472862" author="chenheng" created="Thu, 8 Sep 2016 05:43:31 +0000"  >&lt;p&gt;I make a statistic on one region of our real cluster (most requests are Get or Scan).   All &quot;responseTooSlow&quot; request number is 1451, and slow scan number is 1446.  As for the slow scan, i can&apos;t distinguish whether it is normal or not (I don&apos;t know if the request has too many items to scan),  so i have to ignore them.  &lt;br/&gt;
But as for slow get,  it is worthy log i can go deeper to figure out the reason.  Canary is not enough because slow get request is unusual, we can&apos;t turn it on all the time.&lt;/p&gt;

&lt;p&gt;So IMO we&apos;d better just keep the real slow request (Get, mutation) as &apos;WARN&apos; Level, ignore the uncertain ones (If we can&apos;t distinguish them, just remove them from &apos;WARN&apos; level).&lt;/p&gt;</comment>
                            <comment id="15475114" author="apurtell" created="Thu, 8 Sep 2016 21:44:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;So IMO we&apos;d better just keep the real slow request (Get, mutation) as &apos;WARN&apos; Level, ignore the uncertain ones (If we can&apos;t distinguish them, just remove them from &apos;WARN&apos; level).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The answer to the question &apos;What is a &quot;real&quot; slow request?&apos; is &quot;It depends&quot;, though. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Maybe have different limits to scan vs get vs multi?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is a generalization of the above suggestion. So we would have new configuration that sets a threshold for every op type, and one as a catch-all for op types that don&apos;t have a specific threshold set? Only warn if above the threshold? Default for &amp;lt; branch-2 is 1, a super small threshold leading to warns on anything like today. Default for &amp;gt;= branch-2 is 0, meaning no warn.&lt;/p&gt;</comment>
                            <comment id="15475115" author="apurtell" created="Thu, 8 Sep 2016 21:44:19 +0000"  >&lt;blockquote&gt;&lt;p&gt;So IMO we&apos;d better just keep the real slow request (Get, mutation) as &apos;WARN&apos; Level, ignore the uncertain ones (If we can&apos;t distinguish them, just remove them from &apos;WARN&apos; level).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The answer to the question &apos;What is a &quot;real&quot; slow request?&apos; is &quot;It depends&quot;, though. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Maybe have different limits to scan vs get vs multi?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is a generalization of the above suggestion. So we would have new configuration that sets a threshold for every op type, and one as a catch-all for op types that don&apos;t have a specific threshold set? Only warn if above the threshold? Default for &amp;lt; branch-2 is 1, a super small threshold leading to warns on anything like today. Default for &amp;gt;= branch-2 is 0, meaning no warn.&lt;/p&gt;</comment>
                            <comment id="15477232" author="chenheng" created="Fri, 9 Sep 2016 14:53:25 +0000"  >&lt;blockquote&gt;
&lt;p&gt;The answer to the question &apos;What is a &quot;real&quot; slow request?&apos; is &quot;It depends&quot;, though.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yeah,  but for single action request (Get, Append, Increment etc.) we can ensure the request is real slow request.  I think we can keep them as &apos;WARN&apos; level&lt;/p&gt;</comment>
                            <comment id="15478038" author="enis" created="Fri, 9 Sep 2016 19:34:45 +0000"  >&lt;p&gt;I would really prefer to have more false-positives than not having any indication that things are &quot;slow&quot;. We (in my place of work) typically see HBase run in a very varying set of environments that having an indication in the logs for slow queries usually helps narrow down the debugging.  &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 7 Sep 2016 20:51:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33cuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>