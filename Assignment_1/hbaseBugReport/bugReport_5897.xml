<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:31:57 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5897/HBASE-5897.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5897] prePut coprocessor hook causing substantial CPU usage</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5897</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I was running an insert workload against trunk under oprofile and saw that a significant portion of CPU usage was going to calling the &quot;prePut&quot; coprocessor hook inside doMiniBatchPut, even though I don&apos;t have any coprocessors installed. I ran a million-row insert and collected CPU time spent in the RS after commenting out the preput hook, and found CPU usage reduced by 33%.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12553263">HBASE-5897</key>
            <summary>prePut coprocessor hook causing substantial CPU usage</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tlipcon">Todd Lipcon</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Sun, 29 Apr 2012 02:24:37 +0000</created>
                <updated>Wed, 18 Sep 2013 22:15:56 +0000</updated>
                            <resolved>Tue, 1 May 2012 20:58:14 +0000</resolved>
                                    <version>0.92.0</version>
                                    <fixVersion>0.92.2</fixVersion>
                    <fixVersion>0.94.0</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13264449" author="tlipcon" created="Sun, 29 Apr 2012 02:29:02 +0000"  >&lt;p&gt;Test methodology: I&apos;m running a single standalone HBase on local filesystem. I rm the dir from /tmp, then start the master, create a table with a single column family, then restart the master with &quot;time bin/hbase master&quot;. I then insert 1M rows from YCSB, and hit ^C on the master. I ran the test with the preput hook left in, and with it commented out, and flipped between the two setups twice to make sure I could reproduce. I&apos;m reporting the user and system CPU here, since the wall clock time is sensitive to how quickly I ran the commands.&lt;/p&gt;

&lt;p&gt;with hook commented out:&lt;br/&gt;
run 1:&lt;br/&gt;
user    1m57.760s&lt;br/&gt;
sys     0m3.300s&lt;br/&gt;
run 2:&lt;br/&gt;
user    1m54.840s&lt;br/&gt;
sys     0m3.870s&lt;/p&gt;


&lt;p&gt;with cp hook left in:&lt;br/&gt;
run 1:&lt;br/&gt;
user    3m13.890s&lt;br/&gt;
sys     0m3.940s&lt;br/&gt;
run 2:&lt;br/&gt;
user    3m11.960s&lt;br/&gt;
sys     0m3.930s&lt;/p&gt;

&lt;p&gt;I also re-ran the original oprofile analysis and &quot;doMiniBatchPut&quot; basically dropped off the CPU profile results once I made this change.&lt;/p&gt;

&lt;p&gt;I verified for sure that I have no coprocessors installed by adding a println in RegionCoprocessorHost - it didn&apos;t print out.&lt;/p&gt;</comment>
                            <comment id="13264451" author="tlipcon" created="Sun, 29 Apr 2012 02:51:25 +0000"  >&lt;p&gt;Perhaps this has to do with the fact that the prePut hook runs through &lt;b&gt;all&lt;/b&gt; the BatchOperationInProgress during every mini-batch, instead of just that batch...&lt;/p&gt;</comment>
                            <comment id="13264453" author="tlipcon" created="Sun, 29 Apr 2012 03:10:25 +0000"  >&lt;p&gt;This patch fixes the CPU usage in my test case.&lt;/p&gt;

&lt;p&gt;Would be good if someone more familiar with coprocessors can look at this &amp;#8211; I think this is also fixing a behavioral bug with coprocessors. So if this seems like the correct fix we should also add a regression test for the behavior.&lt;/p&gt;</comment>
                            <comment id="13264469" author="hadoopqa" created="Sun, 29 Apr 2012 04:17:21 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12525000/hbase-5897.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12525000/hbase-5897.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestSplitLogManager&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1681//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1681//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1681//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1681//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1681//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1681//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13264477" author="lhofhansl" created="Sun, 29 Apr 2012 07:01:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;the prePut hook runs through all the BatchOperationInProgress during every mini-batch&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Interesting observation. I wonder whether we do something simple (like attached patch) in 0.94 and Todd&apos;s fix in 0.96.&lt;br/&gt;
The attached -simple patch at least makes sure we start from the current batch index. operations towards the end of the set of batches would still pass through prePut multiple times, which is bad.&lt;/p&gt;</comment>
                            <comment id="13264480" author="hadoopqa" created="Sun, 29 Apr 2012 07:46:58 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12525005/5897-simple.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12525005/5897-simple.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1682//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1682//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1682//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1682//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1682//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1682//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13264538" author="zhihyu@ebaysf.com" created="Sun, 29 Apr 2012 13:43:58 +0000"  >&lt;p&gt;+1 on Todd&apos;s patch.&lt;/p&gt;</comment>
                            <comment id="13264578" author="lhofhansl" created="Sun, 29 Apr 2012 16:04:27 +0000"  >&lt;p&gt;Alright then, let&apos;s get Todd&apos;s patch into 0.94. Marking as critical.&lt;/p&gt;</comment>
                            <comment id="13264586" author="apurtell" created="Sun, 29 Apr 2012 17:45:36 +0000"  >&lt;p&gt;+1 on the -simple patch (at least). This looks like a bug that wasn&apos;t caught because we didn&apos;t have multiput test coverage.&lt;/p&gt;

&lt;p&gt;Edit: But we do now, with LoadTestTool.&lt;/p&gt;</comment>
                            <comment id="13264669" author="anoopsamjohn" created="Mon, 30 Apr 2012 03:57:11 +0000"  >&lt;p&gt;We also saw this behaviour issue while doing a code walkthrough!...  But was not sure... &lt;/p&gt;</comment>
                            <comment id="13264735" author="anoopsamjohn" created="Mon, 30 Apr 2012 08:42:18 +0000"  >&lt;p&gt;As per the simple patch also, there can be more CP calls happening for one Put&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; batchOp.operations.length; i++) {
+      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = batchOp.nextIndexToProcess; i &amp;lt; batchOp.operations.length; i++) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Suppose in 2 calls to doMiniBatchPut() a put(List) with 100 puts operation is getting completed. For the 1st run it will call hook for all 100 Puts. Then in the next run previously it was calling again 100 times. Now it will be for all the remaining puts which were not handled in the 1st iteration. &lt;/p&gt;

&lt;p&gt;In Todd&apos;s patch this will not happen.&lt;span class=&quot;error&quot;&gt;&amp;#91;Calling all pre hook just before the 1st call to the doMiniBatchPut()&amp;#93;&lt;/span&gt; But that will call the pre hook much before the actual put operation. Is this correct? How some one can for sure get a pre hook call before the actual put() for a Put?&lt;/p&gt;</comment>
                            <comment id="13265028" author="lhofhansl" created="Mon, 30 Apr 2012 16:55:46 +0000"  >&lt;p&gt;Right. That&apos;s what I was trying to say when I attached my patch.&lt;/p&gt;

</comment>
                            <comment id="13265063" author="stack" created="Mon, 30 Apr 2012 18:03:05 +0000"  >&lt;p&gt;+1 on the more radical patch.&lt;/p&gt;</comment>
                            <comment id="13265197" author="lhofhansl" created="Mon, 30 Apr 2012 20:43:39 +0000"  >&lt;p&gt;Looked over Todd&apos;s patch. The only difference is that before the prePut&apos;s edits ended up in WALEdit before the family edits. Now that is reversed. Not sure if that even makes a difference. +1 otherwise&lt;/p&gt;</comment>
                            <comment id="13265399" author="lhofhansl" created="Mon, 30 Apr 2012 21:39:53 +0000"  >&lt;p&gt;Looking at the code some more... doMiniBactchPut will handle the entire batch unless it cannot lock the involved rows (see STEP 1. in doMiniBatchPut).&lt;br/&gt;
So calling doMiniBatchPut multiple times on behalf of the same Put operation should be happening relatively rarely.&lt;/p&gt;</comment>
                            <comment id="13265414" author="tlipcon" created="Mon, 30 Apr 2012 21:52:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;So calling doMiniBatchPut multiple times on behalf of the same Put operation should be happening relatively rarely.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;True, unless there&apos;s a lot of contention on some rows. In the test I was doing, I was slamming a fairly small number of rows with puts, so there was a lot of this &quot;back-off&quot; behavior.&lt;/p&gt;

&lt;p&gt;I bet we could improve performance by making it continue past a failed lock acquisition and acquire as many as possible, while pushing those it missed back onto the end of the list. Right now, as soon as it fails any lock acquisition, it stops the batch there (so we always do contiguous ranges of ops instead of arbitrary sets)&lt;/p&gt;</comment>
                            <comment id="13265445" author="lhofhansl" created="Mon, 30 Apr 2012 22:15:02 +0000"  >&lt;p&gt;Yep. I was just wondering whether this is a rather artificial scenario. Anyway, your patch makes it much better and actually ensures correct behavior.&lt;/p&gt;

&lt;p&gt;Let&apos;s commit, unless there&apos;re objections.&lt;/p&gt;</comment>
                            <comment id="13265457" author="zhihyu@ebaysf.com" created="Mon, 30 Apr 2012 22:27:26 +0000"  >&lt;p&gt;Running the patch against hadoop 1.0 and 0.22, I got TestRegionServerCoprocessorExceptionWithRemove hanging on MacBook.&lt;/p&gt;

&lt;p&gt;jstack attached.&lt;/p&gt;</comment>
                            <comment id="13265462" author="hadoopqa" created="Mon, 30 Apr 2012 22:32:13 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12525125/testRegionServerCoprocessorExceptionWithRemove.stack&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12525125/testRegionServerCoprocessorExceptionWithRemove.stack&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1697//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1697//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13265503" author="lhofhansl" created="Mon, 30 Apr 2012 23:27:02 +0000"  >&lt;p&gt;That&apos;s a huge stack dump. What sticks to me are these:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        at org.apache.hadoop.hbase.HBaseTestingUtility.shutdownMiniCluster(HBaseTestingUtility.java:711)
        at org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithRemove.teardownAfterClass(TestRegionServerCoprocessorExceptionWithRemove.java:77)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        at java.util.concurrent.locks.ReentrantReadWriteLock$WriteLock.lock(Reen
trantReadWriteLock.java:807)
        at org.apache.hadoop.hbase.regionserver.HRegion.doClose(HRegion.java:929
)
        at org.apache.hadoop.hbase.regionserver.HRegion.close(HRegion.java:879)
        - locked &amp;lt;7934dcbd0&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)
        at org.apache.hadoop.hbase.regionserver.handler.CloseRegionHandler.process(CloseRegionHandler.java:121)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the face of it, it does seem unrelated.&lt;/p&gt;</comment>
                            <comment id="13265507" author="lhofhansl" created="Mon, 30 Apr 2012 23:33:24 +0000"  >&lt;p&gt;I see. The call to doPrePut should be the try/catch block, so that closeRegionOperation is executed in case it throws an exception.&lt;/p&gt;</comment>
                            <comment id="13265513" author="zhihyu@ebaysf.com" created="Mon, 30 Apr 2012 23:42:50 +0000"  >&lt;p&gt;Patch v2 passes TestRegionServerCoprocessorExceptionWithRemove&lt;/p&gt;</comment>
                            <comment id="13265517" author="lhofhansl" created="Mon, 30 Apr 2012 23:45:39 +0000"  >&lt;p&gt;You beat me to it Ted &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I was also going to suggest to remove the new precondition checks. In both cases nothing incorrect will happen (if the prePut skips or the Put has writeToWal==false, the WAL is not applied), but we&apos;re changing the coprocessor protocol slightly.&lt;/p&gt;</comment>
                            <comment id="13265518" author="zhihyu@ebaysf.com" created="Mon, 30 Apr 2012 23:48:22 +0000"  >&lt;p&gt;Sorry, Lars.&lt;br/&gt;
Attaching jstack was to show that patch v1 needed a little refinement.&lt;br/&gt;
Then I went to talk to my manager, and ...&lt;/p&gt;</comment>
                            <comment id="13265540" author="lhofhansl" created="Tue, 1 May 2012 00:16:53 +0000"  >&lt;p&gt;How about this one. Just removes the precondition checks, applies prePut edit edits before the family edits. And removes an unused variable.&lt;/p&gt;</comment>
                            <comment id="13265555" author="hadoopqa" created="Tue, 1 May 2012 00:47:18 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12525137/5897-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12525137/5897-v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestShell&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1700//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1700//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1700//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1700//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1700//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1700//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13265569" author="hadoopqa" created="Tue, 1 May 2012 01:06:50 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12525142/5897-v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12525142/5897-v3.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 1 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestSplitLogManager&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestShell&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1701//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1701//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1701//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1701//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1701//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1701//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13265614" author="lhofhansl" created="Tue, 1 May 2012 02:44:48 +0000"  >&lt;p&gt;+1 on either v2 or v3, btw.&lt;/p&gt;

</comment>
                            <comment id="13265923" author="lhofhansl" created="Tue, 1 May 2012 17:25:14 +0000"  >&lt;p&gt;I would like to commit v3 and roll another RC of 0.94.0 in the next few hours. Any objections?&lt;/p&gt;</comment>
                            <comment id="13265982" author="stack" created="Tue, 1 May 2012 19:09:48 +0000"  >&lt;p&gt;None from me.&lt;/p&gt;</comment>
                            <comment id="13265983" author="lhofhansl" created="Tue, 1 May 2012 19:10:27 +0000"  >&lt;p&gt;Patch for 0.94&lt;/p&gt;</comment>
                            <comment id="13266091" author="lhofhansl" created="Tue, 1 May 2012 20:57:55 +0000"  >&lt;p&gt;0.92 patch&lt;/p&gt;</comment>
                            <comment id="13266092" author="lhofhansl" created="Tue, 1 May 2012 20:58:14 +0000"  >&lt;p&gt;Committed to 0.92, 0.94, and 0.96.&lt;/p&gt;</comment>
                            <comment id="13266129" author="hudson" created="Tue, 1 May 2012 21:28:02 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #25 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/25/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/25/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5897&quot; title=&quot;prePut coprocessor hook causing substantial CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5897&quot;&gt;&lt;del&gt;HBASE-5897&lt;/del&gt;&lt;/a&gt; prePut coprocessor hook causing substantial CPU usage (Revision 1332810)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13266147" author="hudson" created="Tue, 1 May 2012 21:42:33 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #165 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/165/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/165/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5897&quot; title=&quot;prePut coprocessor hook causing substantial CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5897&quot;&gt;&lt;del&gt;HBASE-5897&lt;/del&gt;&lt;/a&gt; prePut coprocessor hook causing substantial CPU usage (Revision 1332810)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13266164" author="hudson" created="Tue, 1 May 2012 21:51:22 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2834 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2834/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2834/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5897&quot; title=&quot;prePut coprocessor hook causing substantial CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5897&quot;&gt;&lt;del&gt;HBASE-5897&lt;/del&gt;&lt;/a&gt; prePut coprocessor hook causing substantial CPU usage (Revision 1332811)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13266244" author="hudson" created="Tue, 1 May 2012 23:31:28 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #395 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/395/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/395/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5897&quot; title=&quot;prePut coprocessor hook causing substantial CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5897&quot;&gt;&lt;del&gt;HBASE-5897&lt;/del&gt;&lt;/a&gt; prePut coprocessor hook causing substantial CPU usage (Revision 1332816)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13266373" author="hudson" created="Wed, 2 May 2012 06:03:40 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #189 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/189/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/189/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5897&quot; title=&quot;prePut coprocessor hook causing substantial CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5897&quot;&gt;&lt;del&gt;HBASE-5897&lt;/del&gt;&lt;/a&gt; prePut coprocessor hook causing substantial CPU usage (Revision 1332811)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13268870" author="hudson" created="Sat, 5 May 2012 02:28:21 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #106 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/106/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/106/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5897&quot; title=&quot;prePut coprocessor hook causing substantial CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5897&quot;&gt;&lt;del&gt;HBASE-5897&lt;/del&gt;&lt;/a&gt; prePut coprocessor hook causing substantial CPU usage (Revision 1332816)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12525005" name="5897-simple.txt" size="799" author="lhofhansl" created="Sun, 29 Apr 2012 07:01:01 +0000"/>
                            <attachment id="12525137" name="5897-v2.txt" size="4144" author="zhihyu@ebaysf.com" created="Mon, 30 Apr 2012 23:42:50 +0000"/>
                            <attachment id="12525218" name="5897-v3-0.92.txt" size="3353" author="lhofhansl" created="Tue, 1 May 2012 20:57:55 +0000"/>
                            <attachment id="12525198" name="5897-v3-0.94.txt" size="3935" author="lhofhansl" created="Tue, 1 May 2012 19:10:27 +0000"/>
                            <attachment id="12525142" name="5897-v3.txt" size="3981" author="lhofhansl" created="Tue, 1 May 2012 00:16:53 +0000"/>
                            <attachment id="12525000" name="hbase-5897.txt" size="4550" author="tlipcon" created="Sun, 29 Apr 2012 03:10:24 +0000"/>
                            <attachment id="12525125" name="testRegionServerCoprocessorExceptionWithRemove.stack" size="85968" author="zhihyu@ebaysf.com" created="Mon, 30 Apr 2012 22:27:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 29 Apr 2012 04:17:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>237372</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 32 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i068n3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34331</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>