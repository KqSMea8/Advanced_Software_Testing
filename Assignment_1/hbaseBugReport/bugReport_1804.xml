<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:56:31 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1804/HBASE-1804.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1804] Puts are permitted (and stored) when including an appended colon</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1804</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If I have a table with family &quot;testFamily&quot;, currently I can do Puts using the new API by specifying the family name with or without a colon.  The KV is then stored w/ or w/o depending on how the Put was done.&lt;/p&gt;

&lt;p&gt;If you try to Put.add(&quot;testFamily:&quot;, &quot;qualifier&quot;, &quot;value&quot;) this should throw a NoSuchColumnFamilyException&lt;/p&gt;</description>
                <environment></environment>
        <key id="12434449">HBASE-1804</key>
            <summary>Puts are permitted (and stored) when including an appended colon</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="streamy">Jonathan Gray</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Aug 2009 19:52:15 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:55 +0000</updated>
                            <resolved>Wed, 2 Sep 2009 18:58:51 +0000</resolved>
                                    <version>0.20.0</version>
                                    <fixVersion>0.20.0</fixVersion>
                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12749604" author="streamy" created="Mon, 31 Aug 2009 20:19:15 +0000"  >&lt;p&gt;Issue is because we use a special FAMILY_COMPARATOR for the HTD map... It currently ignores the delimiter when doing the comparison.  IMO, we should not ignore it, if we support old API stuff with delimiters, we should be stripping them before we do any family checking.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; RawComparator&amp;lt;&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; []&amp;gt; FAMILY_COMPARATOR =
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RawComparator&amp;lt;&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; []&amp;gt; () {
      &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compare(&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [] a, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; ao, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; al, &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [] b, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; bo, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; bl) {
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; indexa = KeyValue.getDelimiter(a, ao, al, COLUMN_FAMILY_DELIMITER);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (indexa &amp;lt; 0) {
          indexa = al;
        }
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; indexb = KeyValue.getDelimiter(b, bo, bl, COLUMN_FAMILY_DELIMITER);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (indexb &amp;lt; 0) {
          indexb = bl;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Bytes.compareTo(a, ao, indexa, b, bo, indexb);
      }

      &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compare(&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] a, &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] b) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; compare(a, 0, a.length, b, 0, b.length);
      }
    };
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12749611" author="streamy" created="Mon, 31 Aug 2009 20:27:43 +0000"  >&lt;p&gt;Removes usage of FAMILY_COMPARATOR.  Replaces with straight binary compare, Bytes.BYTES_COMPARATOR.&lt;/p&gt;

&lt;p&gt;Needs to be tested and discussed.  I don&apos;t see why or where we expect or need to be tolerant of a family with a colon.  It should be stripped from old api stuff, and is not even part of the equation of the new api.&lt;/p&gt;

&lt;p&gt;This does fix the original bug.  If you run a new API put with family: it will throw no such column family exception.&lt;/p&gt;</comment>
                            <comment id="12749612" author="streamy" created="Mon, 31 Aug 2009 20:28:06 +0000"  >&lt;p&gt;Please review.&lt;/p&gt;</comment>
                            <comment id="12749617" author="streamy" created="Mon, 31 Aug 2009 20:32:07 +0000"  >&lt;p&gt;This breaks stuff.&lt;/p&gt;</comment>
                            <comment id="12749643" author="stack" created="Mon, 31 Aug 2009 21:53:53 +0000"  >&lt;p&gt;Does your patch work?  Seems odd that it would.  Is family comparator used elsewhere?  Should it be purged?&lt;/p&gt;</comment>
                            <comment id="12749655" author="streamy" created="Mon, 31 Aug 2009 22:21:47 +0000"  >&lt;p&gt;As I said, it breaks stuff.&lt;/p&gt;

&lt;p&gt;There doesn&apos;t seem to be a fixed contract here.  Sometimes we pass it &quot;family&quot; other times we pass it &quot;family:qualifier&quot;.&lt;/p&gt;

&lt;p&gt;We should only ever be passing it &quot;family&quot; and should never pass it with a colon... We don&apos;t store the colon, we don&apos;t use the colon in the API, it&apos;s leftover from the old API.&lt;/p&gt;

&lt;p&gt;I will spend more time digging in where we&apos;d need to change things.&lt;/p&gt;

&lt;p&gt;Family comparator is used in the HRegion map of Stores and the HTD map of Families... in both cases, we should be able to deal strictly with &quot;family&quot;, there just seems to be some old API calls making it&apos;s way down to HR and HTD.&lt;/p&gt;</comment>
                            <comment id="12749948" author="jdcryans" created="Tue, 1 Sep 2009 15:35:18 +0000"  >&lt;p&gt;Shouldn&apos;t we just strip the colon in Put, Delete, Get, Scan when passed-in in a family,qualifier method? Or even throw an exception?&lt;/p&gt;</comment>
                            <comment id="12749960" author="streamy" created="Tue, 1 Sep 2009 16:06:01 +0000"  >&lt;p&gt;Yes.  I&apos;m working on a patch that does that, just need to run a lot of tests because it&apos;s hard to track down all the old API instances internally and in the tests themselves.&lt;/p&gt;</comment>
                            <comment id="12750285" author="stack" created="Wed, 2 Sep 2009 06:06:02 +0000"  >&lt;p&gt;Here&apos;s a v2.  Running tests now.  Its Jon&apos;s patch only it purges the family comparator from KV and it adds checks to Put, Get, Scan and Delete that throw exception if family is &apos;illegal&apos;.&lt;/p&gt;</comment>
                            <comment id="12750288" author="streamy" created="Wed, 2 Sep 2009 06:12:08 +0000"  >&lt;p&gt;Is it necessary to add these client-side checks in the new API?  Should have checks when creating HTD/HCD but if you put something wonky in normal methods you&apos;ll get NoSuchFam.&lt;/p&gt;

&lt;p&gt;The change of comparator does break some of the old API tests in the client package.  In calls like getClosest... we need to run KV.parseColumn() and remove the : and qualifier from family.&lt;/p&gt;</comment>
                            <comment id="12750290" author="streamy" created="Wed, 2 Sep 2009 06:20:26 +0000"  >&lt;p&gt;hmm... tests are passing for me now.&lt;/p&gt;</comment>
                            <comment id="12750451" author="stack" created="Wed, 2 Sep 2009 14:28:12 +0000"  >&lt;p&gt;The old api tests failed for me w/ NPEs.   Will remove the additions to Put/Get/Scan/Delete that I added.  Shouldn&apos;t be double checking.&lt;/p&gt;</comment>
                            <comment id="12750463" author="streamy" created="Wed, 2 Sep 2009 15:00:52 +0000"  >&lt;p&gt;I must have missed the patch somehow.  You should be able to add a few KV.parseColumn calls inside old-API HTable code so that we don&apos;t send something that&apos;s supposed to just be &quot;family&quot; with a color or qualifier&lt;/p&gt;</comment>
                            <comment id="12750577" author="stack" created="Wed, 2 Sep 2009 18:12:58 +0000"  >&lt;p&gt;Adds test to TestHRegion that checks whether Put does right thing when family has a colon.&lt;/p&gt;

&lt;p&gt;Adds handler to old api getclosest to handle case where passed a &apos;:&apos; on family.&lt;/p&gt;

&lt;p&gt;Most of rest of patch is like jgray&apos;s original.  I removed the check in Put/Get/Scan/Delete.&lt;/p&gt;</comment>
                            <comment id="12750583" author="streamy" created="Wed, 2 Sep 2009 18:19:01 +0000"  >&lt;p&gt;+1.  thanks for cleaning up the patch, stack&lt;/p&gt;</comment>
                            <comment id="12750585" author="jdcryans" created="Wed, 2 Sep 2009 18:21:18 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12750613" author="stack" created="Wed, 2 Sep 2009 18:58:51 +0000"  >&lt;p&gt;Thanks for review lads.  Committed branch and trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12418342" name="1804-v2.patch" size="7858" author="stack" created="Wed, 2 Sep 2009 06:06:02 +0000"/>
                            <attachment id="12418418" name="1804-v3.patch" size="5315" author="stack" created="Wed, 2 Sep 2009 18:12:58 +0000"/>
                            <attachment id="12418174" name="HBASE-1804-v1.patch" size="1342" author="streamy" created="Mon, 31 Aug 2009 20:27:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 31 Aug 2009 21:53:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25993</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 16 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hfcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99749</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>