<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:18:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10882/HBASE-10882.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10882] Bulkload process hangs on regions randomly and finally throws RegionTooBusyException</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10882</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I came across the problem in the early morning several days ago. It happened when I used hadoop completebulkload command to bulk load some hdfs files into hbase table. Several regions hung and after retried three times they all threw RegionTooBusyExceptions. Fortunately, I caught one of the exceptional region&#8217;s HRegionServer process&#8217;s jstack info just in time.&lt;br/&gt;
I found that the bulkload process was waiting for a write lock:&lt;br/&gt;
at java.util.concurrent.locks.ReentrantReadWriteLock$WriteLock.tryLock(ReentrantReadWriteLock.java:1115)&lt;br/&gt;
The lock id is 0x00000004054ecbf0.&lt;br/&gt;
In the meantime, many other Get/Scan operations were also waiting for the same lock id. And, of course, they were waiting for the read lock:&lt;br/&gt;
at java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.tryLock(ReentrantReadWriteLock.java:873)&lt;br/&gt;
The most ridiculous thing is NO ONE OWNED THE LOCK! I searched the jstack output carefully, but cannot find any process who claimed to own the lock.&lt;br/&gt;
When I restart the bulk load process, it failed at different regions but with the same RegionTooBusyExceptions. &lt;br/&gt;
I guess maybe the region was doing some compactions at that time and owned the lock, but I couldn&#8217;t find compaction info in the hbase-logs.&lt;br/&gt;
Finally, after several days&#8217; hard work, the only temporary solution to this problem was found, that is TRIGGERING A MAJOR COMPACTION BEFORE THE BULKLOAD, &lt;br/&gt;
So which process owned the lock? Has anyone came across the same problem before?&lt;/p&gt;</description>
                <environment>&lt;p&gt;rhel 5.6, jdk1.7.0_45, hadoop-2.2.0-cdh5.0.0&lt;/p&gt;</environment>
        <key id="12705843">HBASE-10882</key>
            <summary>Bulkload process hangs on regions randomly and finally throws RegionTooBusyException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="victorunique">Victor Xu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Apr 2014 02:56:28 +0000</created>
                <updated>Tue, 17 Jun 2014 04:48:46 +0000</updated>
                            <resolved>Tue, 1 Apr 2014 15:42:59 +0000</resolved>
                                    <version>0.94.10</version>
                                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13956045" author="victorunique" created="Tue, 1 Apr 2014 02:59:48 +0000"  >&lt;p&gt;Add jstack output file of the hanging region.&lt;/p&gt;</comment>
                            <comment id="13956398" author="xieliang007" created="Tue, 1 Apr 2014 11:17:25 +0000"  >&lt;p&gt;It would be better to ask at mail list in future&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Why you have such many table pool instances ?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&quot;The most ridiculous thing is NO ONE OWNED THE LOCK! I searched the jstack output carefully, but cannot find any process who claimed to own the lock.&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The thread dump doesn&apos;t show the lock holder while using Lock,  but you could see it if using Synchronized.&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13956658" author="apurtell" created="Tue, 1 Apr 2014 15:42:59 +0000"  >&lt;p&gt;Please ask for assistance on the user@hbase.apache.org mailing list.&lt;/p&gt;</comment>
                            <comment id="14033434" author="stack" created="Tue, 17 Jun 2014 04:48:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=victorunique&quot; class=&quot;user-hover&quot; rel=&quot;victorunique&quot;&gt;Victor Xu&lt;/a&gt; Yes, that is an odd looking stack trace. I agree it looks like &quot;NO ONE OWNED THE LOCK&quot;.   I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11368&quot; title=&quot;Multi-column family BulkLoad fails if compactions go on too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11368&quot;&gt;&lt;del&gt;HBASE-11368&lt;/del&gt;&lt;/a&gt; because this issue comes up from time to time.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12637987" name="jstack_5105.log" size="934279" author="victorunique" created="Tue, 1 Apr 2014 02:59:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 1 Apr 2014 11:17:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>384167</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 26 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1u6mv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>384435</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>