<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:17:28 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4275/HBASE-4275.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4275] RS should communicate fatal &quot;aborts&quot; back to the master</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4275</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When a region server aborts, it should attempt to send an RPC to the master that contains (a) the reason for aborting, and (b) the last several KB of log messages, if available. This should help a lot in debugging.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12520522">HBASE-4275</key>
            <summary>RS should communicate fatal &quot;aborts&quot; back to the master</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tlipcon">Todd Lipcon</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Mon, 29 Aug 2011 06:10:05 +0000</created>
                <updated>Fri, 20 Nov 2015 11:55:11 +0000</updated>
                            <resolved>Tue, 30 Aug 2011 19:27:34 +0000</resolved>
                                    <version>0.92.0</version>
                                    <fixVersion>0.92.0</fixVersion>
                                    <component>master</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13092969" author="jdcryans" created="Mon, 29 Aug 2011 16:58:29 +0000"  >&lt;p&gt;I see a few difficulties there, unless you have code ready would you mind punting to 0.94?&lt;/p&gt;</comment>
                            <comment id="13093031" author="tlipcon" created="Mon, 29 Aug 2011 18:06:47 +0000"  >&lt;p&gt;I don&apos;t have code ready, but I don&apos;t see why this shouldn&apos;t try to go in some dot-release of 0.92? It&apos;s not marked a blocker - what&apos;s the purpose in punting non-blockers, so long as they won&apos;t affect stability of the running system?&lt;/p&gt;</comment>
                            <comment id="13093041" author="jdcryans" created="Mon, 29 Aug 2011 18:13:48 +0000"  >&lt;p&gt;That&apos;s the thing I&apos;m afraid it will require some non-wire-compatible changes, but I might be wrong. Thought there would be no harm asking &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13093056" author="tlipcon" created="Mon, 29 Aug 2011 18:25:06 +0000"  >&lt;p&gt;Adding a new RPC shouldn&apos;t be wire-incompatible &amp;#8211; worst that happens is the RS gets an exception when trying to report its fatal error. But at that point it&apos;s shutting down anyway, and we aren&apos;t any worse off than before &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13093386" author="tlipcon" created="Tue, 30 Aug 2011 02:46:26 +0000"  >&lt;p&gt;Here&apos;s a patch which adds the new RPC.&lt;/p&gt;

&lt;p&gt;The master logs it locally and also keeps a ring-buffer of such log messages, constrained to 1MB by default.&lt;/p&gt;

&lt;p&gt;I&apos;ve tested this on a cluster in coordination with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4292&quot; title=&quot;Add a debugging dump servlet to the master and regionserver&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4292&quot;&gt;&lt;del&gt;HBASE-4292&lt;/del&gt;&lt;/a&gt; (which displays the ring buffer) and it&apos;s very useful for debugging.&lt;/p&gt;

&lt;p&gt;The RS-abort behavior should probably get its own unit test before commit (or add some assertions to existing tests)&lt;/p&gt;</comment>
                            <comment id="13093392" author="yuzhihong@gmail.com" created="Tue, 30 Aug 2011 03:00:05 +0000"  >&lt;p&gt;This is a useful feature.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        conf.getLong(&lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.master.rs-fatals-heapsize&quot;&lt;/span&gt;, 1*1024*1024));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should the config be called &quot;hbase.master.rs.fatals.heapsize&quot; ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; msg = &lt;span class=&quot;code-quote&quot;&gt;&quot;Region server &quot;&lt;/span&gt; + serverInfo + &lt;span class=&quot;code-quote&quot;&gt;&quot; reported a fatal error:\n&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If all master needs is a String, probably we should change the type of HServerInfo parameter accordingly.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+
+&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class TestMemoryBoundedLogMessageBuffer {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please add a short description for the test class.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; JP_TEXT = &lt;span class=&quot;code-quote&quot;&gt;&quot;&#12371;&#12435;&#12395;&#12385;&#12399;&quot;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Wonderful, I should learn Japanese &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13093397" author="tlipcon" created="Tue, 30 Aug 2011 03:07:25 +0000"  >&lt;p&gt;Fixes for Ted&apos;s review. Also, the previous patch had used some 0.90 types which are gone in trunk. This one should compile &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13093402" author="stack" created="Tue, 30 Aug 2011 03:13:54 +0000"  >&lt;p&gt;+1.  Looks great.&lt;/p&gt;</comment>
                            <comment id="13093948" author="jdcryans" created="Tue, 30 Aug 2011 18:03:09 +0000"  >&lt;p&gt;Looks good.&lt;/p&gt;

&lt;p&gt;One thing I&apos;m wondering is what happens if abort is called multiple times RS-side (let&apos;s say we get a big GC, then we abort with SessionExpired then again because some ZK call failed). IIRC there&apos;s another jira about adding a isAborted to HRS which might be useful.&lt;/p&gt;</comment>
                            <comment id="13093969" author="tlipcon" created="Tue, 30 Aug 2011 18:22:22 +0000"  >&lt;p&gt;I thought about adding a boolean or something there, but figured that, since this is just keeping a log on the master, adn not a Map&amp;lt;Server, String&amp;gt;, it would be OK. Even if there are multiple ABORTs for a given server, it&apos;s an improvement over what we have now, right?&lt;/p&gt;

&lt;p&gt;We can later extend this to hook into log4j and perhaps propagate other ERROR level messages in a nicely configurable (and throttled) way, but I think this feature is useful on its own. Sound good?&lt;/p&gt;</comment>
                            <comment id="13093980" author="jdcryans" created="Tue, 30 Aug 2011 18:32:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think this feature is useful on its own.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, but my concern was that the root cause might be too easily pushed out of the log buffer. In any case I&apos;m +1 on commit as is.&lt;/p&gt;</comment>
                            <comment id="13094149" author="hudson" created="Tue, 30 Aug 2011 22:04:59 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2162 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2162/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2162/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4275&quot; title=&quot;RS should communicate fatal &amp;quot;aborts&amp;quot; back to the master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4275&quot;&gt;&lt;del&gt;HBASE-4275&lt;/del&gt;&lt;/a&gt;  RS should communicate fatal &quot;aborts&quot; back to the master&lt;/p&gt;

&lt;p&gt;todd : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/ipc/HMasterRegionInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/monitoring/MemoryBoundedLogMessageBuffer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/monitoring/TestMemoryBoundedLogMessageBuffer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15016418" author="lars_francke" created="Fri, 20 Nov 2015 11:55:11 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12520670">HBASE-4292</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12492190" name="0005-HBASE-4275.-Report-fatals-to-HMaster-v2.patch" size="12763" author="tlipcon" created="Tue, 30 Aug 2011 03:07:25 +0000"/>
                            <attachment id="12492183" name="0005-HBASE-4275.-Report-fatals-to-HMaster.patch" size="12489" author="tlipcon" created="Tue, 30 Aug 2011 02:46:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 29 Aug 2011 16:58:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33468</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05i93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30054</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>