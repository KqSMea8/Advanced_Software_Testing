<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:54:21 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1537/HBASE-1537.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1537] Intra-row scanning</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1537</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;To continue scaling numbers of columns or versions in a single row, we need a mechanism to scan within a row so we can return some columns at a time.  Currently, an entire row must come back as one piece.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12428180">HBASE-1537</key>
            <summary>Intra-row scanning</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Jun 2009 21:41:54 +0000</created>
                <updated>Fri, 20 Nov 2015 13:01:24 +0000</updated>
                            <resolved>Sun, 18 Oct 2009 15:32:11 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="12720934" author="apurtell" created="Wed, 17 Jun 2009 22:06:31 +0000"  >&lt;p&gt;What we did for Stargate scanners is make them iterators over cells and then allow scanners to specify the number of cells they&apos;d like to have come back in one batch. The internal mechanics are more complicated for region servers to do this, but I think similar semantics would be good. How to handle crossing row boundaries presents a couple of options:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Include row key as well as column and timestamp with each cell value. This is not as expensive as it might sound if a simple string table encoding is used with a marker or two meaning &quot;use last given row key&quot; and &quot;use last given column&quot;. Either Thrift or pbufs can handle this by marking row and column keys as optional.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Make Result capable of holding more than one row.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Return early to the client at row boundary and make it do scanner.next() to start up again on the next row.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12720940" author="streamy" created="Wed, 17 Jun 2009 22:12:15 +0000"  >&lt;p&gt;Result is actually just KeyValue[]... Each KeyValue holds ALL the data, row, family, qualifier, timestamp, value, type.  So we already have all the information we need to put things back in any way we want.&lt;/p&gt;

&lt;p&gt;The byte [] row inside Result is actually computed when you ask for it, and it just grabs the row from the first KV, so it&apos;s actually already capable from a data structure perspective to hold multiple rows.&lt;/p&gt;

&lt;p&gt;Good stuff, Andrew.&lt;/p&gt;</comment>
                            <comment id="12720941" author="streamy" created="Wed, 17 Jun 2009 22:12:43 +0000"  >&lt;p&gt;The optimization you mention is a worthwhile one we might look into, in order to reduce RPC payload.&lt;/p&gt;</comment>
                            <comment id="12761685" author="apurtell" created="Fri, 2 Oct 2009 19:39:35 +0000"  >&lt;p&gt;Patch soon with first cut. Will add a bit of state to scanner and change next() semantics on the client such that more than one call to next may be needed to retireve the full row. Next() will not span rows. New next() behavior will be configurable, off by default, toggled by config var or Scan parameter.&lt;/p&gt;</comment>
                            <comment id="12764415" author="apurtell" created="Sun, 11 Oct 2009 03:25:42 +0000"  >&lt;p&gt;Naive implementation of per next() limits via new InternalScanner method. Aiming for a minimalist approach. Needs testing. Find where/if it doesn&apos;t work as expected.&lt;/p&gt;</comment>
                            <comment id="12764469" author="apurtell" created="Sun, 11 Oct 2009 15:45:42 +0000"  >&lt;p&gt;With simple testcase. Seems to work. &lt;/p&gt;</comment>
                            <comment id="12764946" author="stack" created="Tue, 13 Oct 2009 04:48:58 +0000"  >&lt;p&gt;Patch looks good.  Only think is that maybe the test should check that Result does not contain results that span a row?  (We&apos;re not supposed to cross rows inside a call to next, right?)&lt;/p&gt;</comment>
                            <comment id="12764980" author="apurtell" created="Tue, 13 Oct 2009 07:06:14 +0000"  >&lt;p&gt;Better test.&lt;/p&gt;</comment>
                            <comment id="12764983" author="apurtell" created="Tue, 13 Oct 2009 07:23:32 +0000"  >&lt;p&gt;Also versions Scan. &lt;/p&gt;

&lt;p&gt;If Scan had been versioned already, this could have been backported to 0.20 branch.&lt;/p&gt;</comment>
                            <comment id="12765884" author="streamy" created="Thu, 15 Oct 2009 03:13:35 +0000"  >&lt;p&gt;Patch looks great, Andrew.  I&apos;m probably going to apply this into a 0.20 branch dev cluster soon and play around with some gigantic rows.&lt;/p&gt;</comment>
                            <comment id="12767076" author="apurtell" created="Sun, 18 Oct 2009 15:32:11 +0000"  >&lt;p&gt;Thanks for the review. Committed. Reopen if insufficient.&lt;/p&gt;</comment>
                            <comment id="12767538" author="jdcryans" created="Mon, 19 Oct 2009 20:56:24 +0000"  >&lt;p&gt;Is it just me or this patch doesn&apos;t compile for org.apache.hadoop.hbase.regionserver.transactional.TransactionState?&lt;/p&gt;</comment>
                            <comment id="12767544" author="jdcryans" created="Mon, 19 Oct 2009 21:05:37 +0000"  >&lt;p&gt;Ok sorry false alarm.&lt;/p&gt;</comment>
                            <comment id="12845166" author="whitesky" created="Mon, 15 Mar 2010 01:47:10 +0000"  >&lt;p&gt;This feature looks very useful for my ongoing project, but the attached patches here can&apos;t be applied to my hbase 0.20.3. There&apos;re some unmatched hunks in Scan.java and HRegion.java, especially much difference in nextInternal method of HRegion.java. As a common user of HBase, I&apos;m not clear how to adjust the related code. Can anybody provide a patch for 0.20.3? Thanks very much!&lt;/p&gt;</comment>
                            <comment id="12852505" author="octo47" created="Thu, 1 Apr 2010 18:47:32 +0000"  >&lt;p&gt;Fixed version for 0.20.x. &lt;/p&gt;

&lt;p&gt;Only one difference: no SCAN_DESCRIPTOR_VERSION constant serialisation in Scan.&lt;/p&gt;</comment>
                            <comment id="12852573" author="stack" created="Thu, 1 Apr 2010 22:13:18 +0000"  >&lt;p&gt;Committed to branch. Thanks for backporting Andrey Stepachev. SCAN_DESCRIPTOR_VERSION being missing should be fine on branch.&lt;/p&gt;</comment>
                            <comment id="12875885" author="apurtell" created="Sat, 5 Jun 2010 08:56:33 +0000"  >&lt;p&gt;Apply limit across families.&lt;/p&gt;</comment>
                            <comment id="12880429" author="stack" created="Sat, 19 Jun 2010 06:21:28 +0000"  >&lt;p&gt;Reapply to branch.  We seem to have lost it (Or I never applied it in first place).&lt;/p&gt;</comment>
                            <comment id="12880442" author="apurtell" created="Sat, 19 Jun 2010 07:16:04 +0000"  >&lt;p&gt;I noticed this was dropped in the pivot from 0.20_pre_durability to 0.20. But as a matter of fact we have an open internal ticket on this. Unit tests and bugfixes coming. Will submit to reviewboard when ready.&lt;/p&gt;
</comment>
                            <comment id="12880443" author="ryanobjc" created="Sat, 19 Jun 2010 07:24:47 +0000"  >&lt;p&gt;The original patch was incompatible since it changed the Scan&lt;br/&gt;
serialization without versioning.&lt;/p&gt;

</comment>
                            <comment id="12880444" author="apurtell" created="Sat, 19 Jun 2010 07:30:22 +0000"  >&lt;p&gt;Right, this is only for trunk going forward.&lt;/p&gt;
</comment>
                            <comment id="12880448" author="ryanobjc" created="Sat, 19 Jun 2010 07:50:17 +0000"  >&lt;p&gt;stack just said he wanted to reapply to branch?&lt;/p&gt;

</comment>
                            <comment id="12880452" author="apurtell" created="Sat, 19 Jun 2010 08:06:49 +0000"  >&lt;p&gt;Current situation where this was dropped from 0.20 but is in trunk is a reasonable outcome in my opinion.  &lt;/p&gt;

</comment>
                            <comment id="12891474" author="hbasereviewboard" created="Fri, 23 Jul 2010 05:37:45 +0000"  >&lt;p&gt;Message from: &quot;Andrew Purtell&quot; &amp;lt;apurtell@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.hbase.org/r/376/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.hbase.org/r/376/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Query matcher will be confused if intra-row scanning. Avoid calling setRow() if the row has not changed. This requires a string comparison per next().&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1537&quot; title=&quot;Intra-row scanning&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1537&quot;&gt;&lt;del&gt;HBASE-1537&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-1537&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-1537&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java dc2e234 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.hbase.org/r/376/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.hbase.org/r/376/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Andrew&lt;/p&gt;

</comment>
                            <comment id="12891487" author="hbasereviewboard" created="Fri, 23 Jul 2010 06:18:53 +0000"  >&lt;p&gt;Message from: stack@duboce.net&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.hbase.org/r/376/#review463&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.hbase.org/r/376/#review463&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Ship it!&lt;/p&gt;


&lt;p&gt;+1 on commit.  Suggestion on how to make some minor savings.  Go ahead and commit with if it makes sense to you (or do w/o the suggestion).&lt;/p&gt;


&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.hbase.org/r/376/#comment1902&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.hbase.org/r/376/#comment1902&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Consider using method Ryan added today:&lt;/p&gt;

&lt;p&gt;        public boolean matchingRows(final KeyValue left, final byte [] right) {&lt;/p&gt;

&lt;p&gt;    Then you could do if (!KeyValue.matchingRows(matcher.row, peeked)&lt;/p&gt;

&lt;p&gt;    .. and only do a peeked.getRow when you know you&apos;ve changed rows..&lt;/p&gt;

&lt;p&gt;    Might same a bit of byte array making.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;stack&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12892127" author="hbasereviewboard" created="Sun, 25 Jul 2010 17:52:19 +0000"  >&lt;p&gt;Message from: &quot;Andrew Purtell&quot; &amp;lt;apurtell@apache.org&amp;gt;&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-07-22 23:11:32, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; +1 on commit.  Suggestion on how to make some minor savings.  Go ahead and commit with if it makes sense to you (or do w/o the suggestion).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Committed to branch and trunk, taking into account suggestions for savings in both cases. Also added a conditional to insure matcher.row is not null before testing it.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Andrew&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.hbase.org/r/376/#review463&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.hbase.org/r/376/#review463&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="12898006" author="jdcryans" created="Thu, 12 Aug 2010 23:44:50 +0000"  >&lt;p&gt;Taking it out of 0.20.6, although the last fix did go into it. Confusing.&lt;/p&gt;</comment>
                            <comment id="15017791" author="lars_francke" created="Fri, 20 Nov 2015 13:01:24 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12456059">HBASE-2214</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12446407" name="HBASE-1537-2.patch" size="5651" author="apurtell" created="Sat, 5 Jun 2010 08:56:33 +0000"/>
                            <attachment id="12421824" name="HBASE-1537-v1.patch" size="17208" author="apurtell" created="Sun, 11 Oct 2009 15:45:42 +0000"/>
                            <attachment id="12440533" name="HBASE-1537-v2-0.20.3.patch" size="16385" author="octo47" created="Thu, 1 Apr 2010 18:47:32 +0000"/>
                            <attachment id="12421959" name="HBASE-1537-v2.patch" size="18533" author="apurtell" created="Tue, 13 Oct 2009 07:23:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 17 Jun 2009 22:06:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32181</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hdtz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99503</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>