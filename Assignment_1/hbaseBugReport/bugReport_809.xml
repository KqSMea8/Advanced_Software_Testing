<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:47:43 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-809/HBASE-809.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-809] Deletall doesn&apos;t and inserts after delete don&apos;t work as expected.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-809</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-808&quot; title=&quot;MAX_VERSIONS not respected.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-808&quot;&gt;&lt;del&gt;HBASE-808&lt;/del&gt;&lt;/a&gt; describes program run in the below snippet from the list.  Describes unexpected behaviors.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;..

Test 2

A bit more surprising: I delete my row, using the delete-all command in
shell:


# SHELL 

hbase(main):001:0&amp;gt; scan &apos;proxy-0.2&apos;
ROW                          COLUMN+CELL
 testrow                     column=bytes:, timestamp=1100, value=valbytes
ts 1100
 testrow                     column=status:, timestamp=1100, value=valstat
ts1100
2 row(s) in 0.3560 seconds
hbase(main):002:0&amp;gt; deleteall &apos;proxy-0.2&apos;, &apos;testrow&apos;
0 row(s) in 0.1050 seconds
hbase(main):003:0&amp;gt; scan &apos;proxy-0.2&apos;
ROW                          COLUMN+CELL
0 row(s) in 0.2540 seconds


The table is now empty, and &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; I &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to launch my dumpRowHistory() method,
the emptiness is confirmed. Ok. Now I launch my test 1 again. Restarting
from timestamp 1000:


# OUTPUT

&amp;gt; &amp;gt; Connecting to hbase master...
 &amp;gt; -- Inserted ts 1000
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1010
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1020
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1030
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1040
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1050
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1060
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1070
 &amp;gt; Versions or row : testrow


It seems that the row are not inserted. Querying from shell:


# SHELL 

hbase(main):004:0&amp;gt; scan &apos;proxy-0.2&apos;
ROW                          COLUMN+CELL
0 row(s) in 0.2030 seconds


But, If I allow the program to make more iterations than the first time (ts
&amp;gt; &amp;gt; 1100), the newest timestamps are taken in account. As &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the table
remembers of the previous maximum value of the timestamp:

Relaunching the code of Test 1 :


# OUTPUT

&amp;gt; &amp;gt; Connecting to hbase master...
 &amp;gt; -- Inserted ts 1000
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1010
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1020
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1030
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1040
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1050
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1060
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1070
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1080
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1090
 &amp;gt; Versions or row : testrow
 &amp;gt; -- Inserted ts 1100
 &amp;gt; Versions or row : testrow
 &amp;gt; #1 MXTS[1100] bytes: =&amp;gt; valbytes ts 1100 [1100]
 &amp;gt; #2 MXTS[1090] bytes: =&amp;gt; valbytes ts 1090 [1090], status: =&amp;gt; valstat
ts1090 [1090]
 &amp;gt; #3 MXTS[1080] bytes: =&amp;gt; valbytes ts 1080 [1080], status: =&amp;gt; valstat
ts1080 [1080]
 &amp;gt; #4 MXTS[1070] bytes: =&amp;gt; valbytes ts 1070 [1070], status: =&amp;gt; valstat
ts1070 [1070]
 &amp;gt; #5 MXTS[1060] bytes: =&amp;gt; valbytes ts 1060 [1060], status: =&amp;gt; valstat
ts1060 [1060]
 &amp;gt; #6 MXTS[1050] bytes: =&amp;gt; valbytes ts 1050 [1050], status: =&amp;gt; valstat
ts1050 [1050]
 &amp;gt; #7 MXTS[1040] bytes: =&amp;gt; valbytes ts 1040 [1040], status: =&amp;gt; valstat
ts1040 [1040]
 &amp;gt; #8 MXTS[1030] bytes: =&amp;gt; valbytes ts 1030 [1030], status: =&amp;gt; valstat
ts1030 [1030]
 &amp;gt; #9 MXTS[1020] bytes: =&amp;gt; valbytes ts 1020 [1020], status: =&amp;gt; valstat
ts1020 [1020]
 &amp;gt; #10 MXTS[1010] bytes: =&amp;gt; valbytes ts 1010 [1010], status: =&amp;gt; valstat
ts1010 [1010]
 &amp;gt; #11 MXTS[1000] bytes: =&amp;gt; valbytes ts 1000 [1000], status: =&amp;gt; valstat
ts1000 [1000]
 &amp;gt; -- Inserted ts 1110
 &amp;gt; Versions or row : testrow
 &amp;gt; #1 MXTS[1110] bytes: =&amp;gt; valbytes ts 1110 [1110]
 &amp;gt; #2 MXTS[1100] bytes: =&amp;gt; valbytes ts 1100 [1100], status: =&amp;gt; valstat
ts1100 [1100]
 &amp;gt; #3 MXTS[1090] bytes: =&amp;gt; valbytes ts 1090 [1090], status: =&amp;gt; valstat
ts1090 [1090]
 &amp;gt; #4 MXTS[1080] bytes: =&amp;gt; valbytes ts 1080 [1080], status: =&amp;gt; valstat
ts1080 [1080]
 &amp;gt; #5 MXTS[1070] bytes: =&amp;gt; valbytes ts 1070 [1070], status: =&amp;gt; valstat
ts1070 [1070]
 &amp;gt; #6 MXTS[1060] bytes: =&amp;gt; valbytes ts 1060 [1060], status: =&amp;gt; valstat
ts1060 [1060]
 &amp;gt; #7 MXTS[1050] bytes: =&amp;gt; valbytes ts 1050 [1050], status: =&amp;gt; valstat
ts1050 [1050]
 &amp;gt; #8 MXTS[1040] bytes: =&amp;gt; valbytes ts 1040 [1040], status: =&amp;gt; valstat
ts1040 [1040]
 &amp;gt; #9 MXTS[1030] bytes: =&amp;gt; valbytes ts 1030 [1030], status: =&amp;gt; valstat
ts1030 [1030]
 &amp;gt; #10 MXTS[1020] bytes: =&amp;gt; valbytes ts 1020 [1020], status: =&amp;gt; valstat
ts1020 [1020]
 &amp;gt; #11 MXTS[1010] bytes: =&amp;gt; valbytes ts 1010 [1010], status: =&amp;gt; valstat
ts1010 [1010]
 &amp;gt; #12 MXTS[1000] bytes: =&amp;gt; valbytes ts 1000 [1000], status: =&amp;gt; valstat
ts1000 [1000]
 &amp;gt; -- Inserted ts 1120
 &amp;gt; Versions or row : testrow
 &amp;gt; #1 MXTS[1120] bytes: =&amp;gt; valbytes ts 1120 [1120]
 &amp;gt; #2 MXTS[1110] bytes: =&amp;gt; valbytes ts 1110 [1110], status: =&amp;gt; valstat
ts1110 [1110]
 &amp;gt; #3 MXTS[1100] bytes: =&amp;gt; valbytes ts 1100 [1100], status: =&amp;gt; valstat
ts1100 [1100]
 &amp;gt; #4 MXTS[1090] bytes: =&amp;gt; valbytes ts 1090 [1090], status: =&amp;gt; valstat
ts1090 [1090]
 &amp;gt; #5 MXTS[1080] bytes: =&amp;gt; valbytes ts 1080 [1080], status: =&amp;gt; valstat
ts1080 [1080]
 &amp;gt; #6 MXTS[1070] bytes: =&amp;gt; valbytes ts 1070 [1070], status: =&amp;gt; valstat
ts1070 [1070]
 &amp;gt; #7 MXTS[1060] bytes: =&amp;gt; valbytes ts 1060 [1060], status: =&amp;gt; valstat
ts1060 [1060]
 &amp;gt; #8 MXTS[1050] bytes: =&amp;gt; valbytes ts 1050 [1050], status: =&amp;gt; valstat
ts1050 [1050]
 &amp;gt; #9 MXTS[1040] bytes: =&amp;gt; valbytes ts 1040 [1040], status: =&amp;gt; valstat
ts1040 [1040]
 &amp;gt; #10 MXTS[1030] bytes: =&amp;gt; valbytes ts 1030 [1030], status: =&amp;gt; valstat
ts1030 [1030]
 &amp;gt; #11 MXTS[1020] bytes: =&amp;gt; valbytes ts 1020 [1020], status: =&amp;gt; valstat
ts1020 [1020]
 &amp;gt; #12 MXTS[1010] bytes: =&amp;gt; valbytes ts 1010 [1010], status: =&amp;gt; valstat
ts1010 [1010]
 &amp;gt; #13 MXTS[1000] bytes: =&amp;gt; valbytes ts 1000 [1000], status: =&amp;gt; valstat
ts1000 [1000]
 &amp;gt; -- Inserted ts 1130
 &amp;gt; Versions or row : testrow
 &amp;gt; #1 MXTS[1130] bytes: =&amp;gt; valbytes ts 1130 [1130]
 &amp;gt; #2 MXTS[1120] bytes: =&amp;gt; valbytes ts 1120 [1120], status: =&amp;gt; valstat
ts1120 [1120]
 &amp;gt; #3 MXTS[1110] bytes: =&amp;gt; valbytes ts 1110 [1110], status: =&amp;gt; valstat
ts1110 [1110]
 &amp;gt; #4 MXTS[1100] bytes: =&amp;gt; valbytes ts 1100 [1100], status: =&amp;gt; valstat
ts1100 [1100]
 &amp;gt; #5 MXTS[1090] bytes: =&amp;gt; valbytes ts 1090 [1090], status: =&amp;gt; valstat
ts1090 [1090]
 &amp;gt; #6 MXTS[1080] bytes: =&amp;gt; valbytes ts 1080 [1080], status: =&amp;gt; valstat
ts1080 [1080]
 &amp;gt; #7 MXTS[1070] bytes: =&amp;gt; valbytes ts 1070 [1070], status: =&amp;gt; valstat
ts1070 [1070]
 &amp;gt; #8 MXTS[1060] bytes: =&amp;gt; valbytes ts 1060 [1060], status: =&amp;gt; valstat
ts1060 [1060]
 &amp;gt; #9 MXTS[1050] bytes: =&amp;gt; valbytes ts 1050 [1050], status: =&amp;gt; valstat
ts1050 [1050]
 &amp;gt; #10 MXTS[1040] bytes: =&amp;gt; valbytes ts 1040 [1040], status: =&amp;gt; valstat
ts1040 [1040]
 &amp;gt; #11 MXTS[1030] bytes: =&amp;gt; valbytes ts 1030 [1030], status: =&amp;gt; valstat
ts1030 [1030]
 &amp;gt; #12 MXTS[1020] bytes: =&amp;gt; valbytes ts 1020 [1020], status: =&amp;gt; valstat
ts1020 [1020]
 &amp;gt; #13 MXTS[1010] bytes: =&amp;gt; valbytes ts 1010 [1010], status: =&amp;gt; valstat
ts1010 [1010]
 &amp;gt; #14 MXTS[1000] bytes: =&amp;gt; valbytes ts 1000 [1000], status: =&amp;gt; valstat
ts1000 [1000]


Since the timestamp reachs a newest value, the row is inserted. Moreover,
the previous insertions appears !

Notice another problem: the last insertion is missing one cell: the
&apos;status:&apos; column.

Using shell to scan the table give the same result:


# SHELL
hbase(main):003:0&amp;gt; scan &apos;proxy-0.2&apos;
ROW                          COLUMN+CELL
 testrow                     column=bytes:, timestamp=1130, value=valbytes
ts 1130


Relauching hbase with the stop-hbase.sh / start-hbase.sh scripts yields to
another unexpected behaviour:

When I run the scan command in the shell, I have the same result than above:


# SHELL
hbase(main):001:0&amp;gt; scan &apos;proxy-0.2&apos;
ROW                          COLUMN+CELL
 testrow                     column=bytes:, timestamp=1130, value=valbytes
ts 1130


but &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; I launch the dumpRowHistory method it appears that most of history of
the status: column is lost.

Notice that I tried many times and I never had the same behaviour twice
here, sometime the other column is missing, or the row is entirely lost
giving no result at all.


# OUTPUT

 &amp;gt; #1 MXTS[1130] bytes: =&amp;gt; valbytes ts 1130 [1130]
 &amp;gt; #2 MXTS[1120] bytes: =&amp;gt; valbytes ts 1120 [1120], status: =&amp;gt; valstat
ts1120 [1120]
 &amp;gt; #3 MXTS[1110] bytes: =&amp;gt; valbytes ts 1110 [1110]
 &amp;gt; #4 MXTS[1100] bytes: =&amp;gt; valbytes ts 1100 [1100]
 &amp;gt; #5 MXTS[1090] bytes: =&amp;gt; valbytes ts 1090 [1090]
 &amp;gt; #6 MXTS[1080] bytes: =&amp;gt; valbytes ts 1080 [1080]
 &amp;gt; #7 MXTS[1070] bytes: =&amp;gt; valbytes ts 1070 [1070]
 &amp;gt; #8 MXTS[1060] bytes: =&amp;gt; valbytes ts 1060 [1060]
 &amp;gt; #9 MXTS[1050] bytes: =&amp;gt; valbytes ts 1050 [1050]
 &amp;gt; #10 MXTS[1040] bytes: =&amp;gt; valbytes ts 1040 [1040]
 &amp;gt; #11 MXTS[1030] bytes: =&amp;gt; valbytes ts 1030 [1030]
 &amp;gt; #12 MXTS[1020] bytes: =&amp;gt; valbytes ts 1020 [1020]
 &amp;gt; #13 MXTS[1010] bytes: =&amp;gt; valbytes ts 1010 [1010]
 &amp;gt; #14 MXTS[1000] bytes: =&amp;gt; valbytes ts 1000 [1000]


I tried other tests, replacing only one column, using an existing timestamp
to modify one single value, inserting past values, and so on... My
conclusion is either I don&apos;t understand the general behaviour of that, or I
make a bad usage of the API. 

However, using normal insertion and normal query (I mean without any
timestamp) gives me coherent and predictable results. As well as normal
insertion and querying with past timestamps does.

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12402041">HBASE-809</key>
            <summary>Deletall doesn&apos;t and inserts after delete don&apos;t work as expected.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Aug 2008 22:43:11 +0000</created>
                <updated>Sat, 13 Sep 2008 23:22:44 +0000</updated>
                            <resolved>Wed, 13 Aug 2008 04:17:57 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.2.1</fixVersion>
                    <fixVersion>0.18.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12622087" author="stack" created="Wed, 13 Aug 2008 04:17:57 +0000"  >&lt;p&gt;Committed on branch and trunk.  See if helps with hbase-826.  Thanks for patch J-D.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25409</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 19 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h9kn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98813</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>