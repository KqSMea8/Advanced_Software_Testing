<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:51:28 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1189/HBASE-1189.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1189] Changing the map type used internally  for HbaseMapWritable. </title>
                <link>https://issues.apache.org/jira/browse/HBASE-1189</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;For the CellCache the need for a HbaseMapWritable that has a different kind of map used internally&lt;br/&gt;
has showed up. The problem is that the instantiation of the map is done static so you have no control &lt;br/&gt;
over it and if extending HMW you get both the memory usage for the parent as well as the child.&lt;br/&gt;
After trying out different ideas on how to solve this, it seems like the easiest way would be to have a setMapType&lt;br/&gt;
method and just set it to null in the code. If the old code would be kept you would need to instantiate 2&lt;br/&gt;
different maps. The problem with setting it to null is that all the old code needs to be changed to fit the new model,&lt;br/&gt;
and also be used in the future.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12414289">HBASE-1189</key>
            <summary>Changing the map type used internally  for HbaseMapWritable. </summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erikholstad@gmail.com">Erik Holstad</assignee>
                                    <reporter username="erikholstad@gmail.com">Erik Holstad</reporter>
                        <labels>
                    </labels>
                <created>Sat, 7 Feb 2009 02:44:15 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:24 +0000</updated>
                            <resolved>Thu, 26 Feb 2009 18:18:10 +0000</resolved>
                                    <version>0.20.0</version>
                                    <fixVersion>0.20.0</fixVersion>
                                    <component>io</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12671518" author="stack" created="Sat, 7 Feb 2009 20:06:43 +0000"  >&lt;p&gt;Hey Erik.  Which map are we talking of?  Is it CODE_TO_CLASS (and its inverse) or is it&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [], V&amp;gt; instance =
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [], V&amp;gt;(Bytes.BYTES_COMPARATOR);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the former, thats once for all instances of HBW.  If latter, you want to just something other than TreeMap?&lt;/p&gt;

&lt;p&gt;If you subclass, you think there much overhead?  8 bytes or so?  You trying to be parsimonious?  Good stuff.&lt;/p&gt;</comment>
                            <comment id="12671534" author="erikholstad@gmail.com" created="Sat, 7 Feb 2009 22:44:33 +0000"  >&lt;p&gt;A new version of the HbaseMapWritable that does not have a static constructor but implements an&lt;br/&gt;
interface that takes care of those static tasks.&lt;/p&gt;</comment>
                            <comment id="12674738" author="erikholstad@gmail.com" created="Wed, 18 Feb 2009 18:56:23 +0000"  >&lt;p&gt;Updated the HbaseMapWritable to not use a static constructor but instead&lt;br/&gt;
implement a static interface.&lt;/p&gt;</comment>
                            <comment id="12675086" author="stack" created="Thu, 19 Feb 2009 18:40:33 +0000"  >&lt;p&gt;Patch looks great.&lt;/p&gt;

&lt;p&gt;Would suggest giving the interface a name that is less of a mouthful.  Rather than StaticHBaseMapWritableLoader, how about CodeToClass (or CodeToClassAndBack)?&lt;/p&gt;

&lt;p&gt;Do these have to be public Erik?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt; CODE_TO_CLASS =
+    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;?&amp;gt;&amp;gt;();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What if the client class is not in same package?&lt;/p&gt;

&lt;p&gt;Does this need to be public since its only used inside this interface?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class InternalStaticLoader{
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Should it be static too as in +  public static class InternalStaticLoader{  (It might not work).&lt;/p&gt;

&lt;p&gt;Should this be private too since internal to this Interface?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;[] classList = {&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[].class, Cell.class};
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To add classes, I edit the code?  (Which is what we&apos;ve done up to this).&lt;/p&gt;

&lt;p&gt;Its interesting that we don&apos;t use it with HStoreKey nor ImmutableBytes anymore (I think thats probably good).&lt;/p&gt;

&lt;p&gt;Good stuff Erik.&lt;/p&gt;</comment>
                            <comment id="12675090" author="erikholstad@gmail.com" created="Thu, 19 Feb 2009 19:00:59 +0000"  >&lt;p&gt;New patch with some small fixes, changed the name of the static loader to be &lt;br/&gt;
better and shorter.&lt;br/&gt;
I think that the variables in the class needs to be public, tried to make them private&lt;br/&gt;
though it would make more sense but the complier didn&apos;t like that.&lt;br/&gt;
Not sure what will happened if you have the internal methods set to static too, but I would&lt;br/&gt;
assume that they would take up memory. &lt;br/&gt;
Yes was thinking that you edit the file if you want to add more classes, just like you did in &lt;br/&gt;
the past, not really sure how you would do it otherwise since it is static.&lt;/p&gt;</comment>
                            <comment id="12677081" author="stack" created="Thu, 26 Feb 2009 18:18:10 +0000"  >&lt;p&gt;Committed.  Thanks for the patch Erik.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12400437" name="HBASE-1189-v1.patch" size="6476" author="erikholstad@gmail.com" created="Wed, 18 Feb 2009 18:56:51 +0000"/>
                            <attachment id="12400541" name="HBASE-1189-v2.patch" size="6398" author="erikholstad@gmail.com" created="Thu, 19 Feb 2009 19:08:55 +0000"/>
                            <attachment id="12399740" name="HbaseMapWritable.java" size="7217" author="erikholstad@gmail.com" created="Sat, 7 Feb 2009 22:44:33 +0000"/>
                            <attachment id="12399741" name="StaticLoader.java" size="2090" author="erikholstad@gmail.com" created="Sat, 7 Feb 2009 22:44:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 7 Feb 2009 20:06:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32030</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 43 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hbuv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99183</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>