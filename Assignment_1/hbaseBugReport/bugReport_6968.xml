<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:41:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6968/HBASE-6968.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6968] Several HBase write perf improvement</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6968</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Here are 2 hbase write performance improvements recently:&lt;/p&gt;

&lt;p&gt;1) Avoid creating HBaseConfiguraiton object for each HLog. Every time when creating a HBaseConfiguraiton object, it would parse the xml configuration files from disk, which is not cheap operation.&lt;br/&gt;
In HLog.java:&lt;br/&gt;
orig:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;HLog.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  newWriter = createWriter(fs, newPath, HBaseConfiguration.create(conf));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;new:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  newWriter = createWriter(fs, newPath, conf);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;2) Change 2 hotspot synchronized functions into double locking pattern. So it shall remove the synchronization overhead in the normal case.&lt;br/&gt;
orig:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;HBaseRpcMetrics.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; void inc(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; amt) {	
    MetricsTimeVaryingRate m = get(name);	
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (m == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {	
      m = create(name);	
    }	
    m.inc(amt);	
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;new:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void inc(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; amt) {	
    MetricsTimeVaryingRate m = get(name);	
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (m == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {	
      &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;) {	
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((m = get(name)) == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {	
          m = create(name);	
        }	
      }	
    }	
    m.inc(amt);	
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;=====================&lt;br/&gt;
orig:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;MemStoreFlusher.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; void reclaimMemStoreMemory() {	
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.server.getGlobalMemstoreSize().get() &amp;gt;= globalMemStoreLimit) {	
      flushSomeRegions();	
    }
  }	
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;new:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void reclaimMemStoreMemory() {	
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.server.getGlobalMemstoreSize().get() &amp;gt;= globalMemStoreLimit) {	
      flushSomeRegions();	
    }
  }	
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; void flushSomeRegions() {	
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.server.getGlobalMemstoreSize().get() &amp;lt; globalMemStoreLimit) {	
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;; &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; check the global memstore size inside of the &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; block.	
&lt;/span&gt;    }	
 ...   
 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment></environment>
        <key id="12611091">HBASE-6968</key>
            <summary>Several HBase write perf improvement</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="liyin">Liyin Tang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Oct 2012 23:56:32 +0000</created>
                <updated>Wed, 16 Nov 2016 22:32:02 +0000</updated>
                            <resolved>Wed, 16 Nov 2016 22:32:02 +0000</resolved>
                                    <version>0.90.6</version>
                    <version>0.92.2</version>
                    <version>0.94.2</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13472978" author="ram_krish" created="Wed, 10 Oct 2012 04:18:55 +0000"  >&lt;p&gt;Nice one.&lt;/p&gt;</comment>
                            <comment id="13473027" author="lhofhansl" created="Wed, 10 Oct 2012 06:39:11 +0000"  >&lt;p&gt;Looks like the first two changes are (in one form or the other) in 0.94+ already.&lt;/p&gt;

&lt;p&gt;The 0.94 MemStoreFlusher.reclaimMemStoreMemory looks bad, though. We are taking a lock and are awaiting a condition &lt;b&gt;inside&lt;/b&gt; a synchronized method... It seems we can remove the synchronized there. The code inside the method does not need it and there are no other synchronized methods (or synchronized(this) blocks) in the class (which is also why it is not noticeably bad, because nothing is locked out).&lt;/p&gt;</comment>
                            <comment id="13482173" author="xieliang007" created="Tue, 23 Oct 2012 07:33:54 +0000"  >&lt;p&gt;I look through trunk code, there&apos;s no change needed,  so let&apos;s set this affects issue version on 0.90/0.92/0.94 only, right ?&lt;/p&gt;</comment>
                            <comment id="15671882" author="stack" created="Wed, 16 Nov 2016 22:32:02 +0000"  >&lt;p&gt;Resolving as not a problem anymore. &quot;I look through trunk code, there&apos;s no change needed, so let&apos;s set this affects issue version on 0.90/0.92/0.94 only, right ?&quot;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Oct 2012 04:18:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>246555</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i07r93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43181</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>