<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:43:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-366/HBASE-366.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-366] [hbase] Keep lazy cache of regions in client rather than an &apos;authoritative&apos; list</title>
                <link>https://issues.apache.org/jira/browse/HBASE-366</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Currently, when the client gets a NotServingRegionException &amp;#8211; usually because its in middle of being split or there has been a regionserver crash and region is being moved elsewhere &amp;#8211; the client does a complete refresh of its cache of region locations for a table.&lt;/p&gt;

&lt;p&gt;Chatting with Jim about a Paul Saab upload issue from Saturday night, when tables are big comprised of regions that are splitting fast (because of bulk upload), its unlikely a client will ever be able to obtain a stable list of all region locations.  Given that any update or scan requires that the list of all regions be in place before it proceeds, this can get in the way of the client succeeding when the cluster is under load.&lt;/p&gt;

&lt;p&gt;Chatting, we figure that it better the client holds a lazy region cache: on NSRE, figure out where that region has gone only and update the client-side cache for that entry only rather than throw out all we know of a table every time.&lt;/p&gt;

&lt;p&gt;Hopefully this will fix the issue PS was experiencing where during intense upload, he was unable to get/scan/hql the same table.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12384798">HBASE-366</key>
            <summary>[hbase] Keep lazy cache of regions in client rather than an &apos;authoritative&apos; list</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Dec 2007 18:02:29 +0000</created>
                <updated>Thu, 2 May 2013 02:29:12 +0000</updated>
                            <resolved>Thu, 17 Jan 2008 00:59:57 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12552523" author="stack" created="Mon, 17 Dec 2007 20:43:52 +0000"  >&lt;p&gt;Supposition is that currently the client will not work if it does not have all regions for a table.  If so, client should work even in the case where a region is completely missing serving all regions but the absent.&lt;/p&gt;</comment>
                            <comment id="12552529" author="bryanduxbury" created="Mon, 17 Dec 2007 20:54:44 +0000"  >&lt;p&gt;So, this issue indicates that clients keep a dense list of regions and locations. Is there a reason why they should keep a dense list instead of a sparse one? In production clusters, there could be hundreds or thousands of regions, and caching them all seems to be pretty inefficient. &lt;/p&gt;

&lt;p&gt;Instead, couldn&apos;t we just cache the regions we&apos;ve found through trying to use them? That is, when you&apos;re going to do some operation on a key, you ask the master/META regionserver to resolve where your key belongs, and just remember the location and bounds of that region. That way, you first check the cache to see if you already know where a key lives, and if it is a hit, you go out and talk to the region server. If the server hasn&apos;t got that region anymore, you get an NSRE, invalidate just the single cache item you used to get there. Isn&apos;t this how Bigtable does it?&lt;/p&gt;</comment>
                            <comment id="12555151" author="bryanduxbury" created="Mon, 31 Dec 2007 22:57:55 +0000"  >&lt;p&gt;I think I have a pretty good strategy in mind, but I&apos;ve sort of hit a snag. &lt;/p&gt;

&lt;p&gt;The problem is that when you&apos;re trying to determine which region a key lives in, the list of regions is keyed by the region&apos;s start key, and you&apos;re looking for the region that is closest to (without exceeding) the search key. That is, if you have regions &lt;span class=&quot;error&quot;&gt;&amp;#91;0, 10, 20&amp;#93;&lt;/span&gt; and you&apos;re trying to figure out where key 15 lives, you want the answer to be 10. Then data is all there for this sort of thing, but the interface of MapFile, which is where the .META. table is ultimately stored, doesn&apos;t have anything like this. &lt;/p&gt;

&lt;p&gt;What we need essentially is a method just like getClosest, but that returns the last key found after the one the goes over the search key. The alternative is doing a linear search of some sort manually, which would be pretty inefficient.&lt;/p&gt;</comment>
                            <comment id="12556650" author="bryanduxbury" created="Mon, 7 Jan 2008 18:56:23 +0000"  >&lt;p&gt;We need &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-274&quot; title=&quot;Add to MapFile a getClosest that returns key that comes just-before if key not present (Currently does just-after only).&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-274&quot;&gt;&lt;del&gt;HADOOP-2532&lt;/del&gt;&lt;/a&gt; to do efficient lookups. &lt;/p&gt;</comment>
                            <comment id="12557031" author="bryanduxbury" created="Tue, 8 Jan 2008 20:52:41 +0000"  >&lt;p&gt;Not quite done yet - a few tests don&apos;t pass, and there is no caching at all right now.&lt;/p&gt;</comment>
                            <comment id="12557432" author="bryanduxbury" created="Wed, 9 Jan 2008 20:57:07 +0000"  >&lt;p&gt;All tests are passing locally. This patch includes caching, so performance should be comparable to what you see with the other region location lookup approach.&lt;/p&gt;</comment>
                            <comment id="12557853" author="bryanduxbury" created="Fri, 11 Jan 2008 00:29:10 +0000"  >&lt;p&gt;The latest version of the patch removes getTableServers and related methods entirely and switches HTable$ClientScanner to use getRegionLocation.&lt;/p&gt;

&lt;p&gt;Unfortunately, I now have TestTableIndex and TestTableMapReduce failing all the time. The error seem to be related to scanners acting strangely with rows in the wrong regions, but I can&apos;t be sure of what&apos;s going on yet.&lt;/p&gt;</comment>
                            <comment id="12558171" author="bryanduxbury" created="Sat, 12 Jan 2008 00:16:07 +0000"  >&lt;p&gt;All the tests pass locally at this point, big improvement over the last version.&lt;/p&gt;</comment>
                            <comment id="12558285" author="bryanduxbury" created="Sat, 12 Jan 2008 19:52:22 +0000"  >&lt;p&gt;Another version, more cleaned up.&lt;/p&gt;</comment>
                            <comment id="12558300" author="stack" created="Sat, 12 Jan 2008 22:04:47 +0000"  >&lt;p&gt;Patch looks great.  Patch generates a javadoc warning... will fail on hudson: Run &apos;ant javadoc&apos; to see.  +1 after you fix the javadoc warning.&lt;/p&gt;</comment>
                            <comment id="12558301" author="bryanduxbury" created="Sat, 12 Jan 2008 22:10:03 +0000"  >&lt;p&gt;Fixed javadoc warning.&lt;/p&gt;</comment>
                            <comment id="12558302" author="bryanduxbury" created="Sat, 12 Jan 2008 22:10:27 +0000"  >&lt;p&gt;Trying on hudson.&lt;/p&gt;</comment>
                            <comment id="12558327" author="hadoopqa" created="Sun, 13 Jan 2008 01:35:51 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12373038/2443-v8.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12373038/2443-v8.patch&lt;/a&gt;&lt;br/&gt;
against trunk revision r611488.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    javadoc +1.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    javac +1.  The applied patch does not generate any new compiler warnings.&lt;/p&gt;

&lt;p&gt;    findbugs +1.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    core tests +1.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    contrib tests -1.  The patch failed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1564/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1564/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1564/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1564/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1564/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1564/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1564/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1564/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12558331" author="bryanduxbury" created="Sun, 13 Jan 2008 02:06:11 +0000"  >&lt;p&gt;Failure was in TestTableIndex in a place I&apos;d never seen problems before. It was down in Flusher. I&apos;m going to resubmit it and see if it passes again.&lt;/p&gt;</comment>
                            <comment id="12558358" author="hadoopqa" created="Sun, 13 Jan 2008 07:42:01 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12373038/2443-v8.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12373038/2443-v8.patch&lt;/a&gt;&lt;br/&gt;
against trunk revision r611537.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    patch -1.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1565/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1565/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12558430" author="bryanduxbury" created="Sun, 13 Jan 2008 17:48:30 +0000"  >&lt;p&gt;Merged in Jim&apos;s patch in this version.&lt;/p&gt;</comment>
                            <comment id="12558431" author="bryanduxbury" created="Sun, 13 Jan 2008 17:49:06 +0000"  >&lt;p&gt;Trying Hudson.&lt;/p&gt;</comment>
                            <comment id="12558454" author="hadoopqa" created="Sun, 13 Jan 2008 22:04:12 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12373058/2443-v9.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12373058/2443-v9.patch&lt;/a&gt;&lt;br/&gt;
against trunk revision r611553.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    javadoc +1.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    javac +1.  The applied patch does not generate any new compiler warnings.&lt;/p&gt;

&lt;p&gt;    findbugs +1.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    core tests +1.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    contrib tests -1.  The patch failed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1570/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1570/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1570/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1570/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1570/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1570/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1570/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1570/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12558456" author="bryanduxbury" created="Sun, 13 Jan 2008 22:47:16 +0000"  >&lt;p&gt;Tests failed by TestGet2 timing out. No idea what happened there, so I&apos;ll resubmit.&lt;/p&gt;</comment>
                            <comment id="12558466" author="hadoopqa" created="Sun, 13 Jan 2008 23:23:49 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12373058/2443-v9.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12373058/2443-v9.patch&lt;/a&gt;&lt;br/&gt;
against trunk revision r611629.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    patch -1.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1573/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1573/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12558473" author="bryanduxbury" created="Mon, 14 Jan 2008 00:30:45 +0000"  >&lt;p&gt;Ok, here&apos;s another go. The TestGet2 failure I had previously was actually correct, as I wasn&apos;t shutting down the test correctly. I fixed that, and in the process, merged in the changes from other recent patches.&lt;/p&gt;</comment>
                            <comment id="12558474" author="bryanduxbury" created="Mon, 14 Jan 2008 00:31:06 +0000"  >&lt;p&gt;Try the latest again.&lt;/p&gt;</comment>
                            <comment id="12558482" author="hadoopqa" created="Mon, 14 Jan 2008 02:00:54 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12373068/2443-v10.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12373068/2443-v10.patch&lt;/a&gt;&lt;br/&gt;
against trunk revision r611681.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    javadoc +1.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    javac +1.  The applied patch does not generate any new compiler warnings.&lt;/p&gt;

&lt;p&gt;    findbugs +1.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    core tests +1.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    contrib tests +1.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1575/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1575/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1575/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1575/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1575/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1575/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1575/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1575/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12558520" author="stack" created="Mon, 14 Jan 2008 06:54:56 +0000"  >&lt;p&gt;Committed.  Had some minor questions &amp;#8211; see below &amp;#8211; but it ain&apos;t enough to hold up patch and I&apos;m afraid patch would rot if left hang (It touches lots of classes).  Resolving.  Thanks for the patch Bryan.&lt;/p&gt;

&lt;p&gt;Here&apos;s the couple of items:&lt;/p&gt;

&lt;p&gt;Here in HConnectionManager:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          scannerId = server.openScanner(
+            metaLocation.getRegionInfo().getRegionName(),
+            COLUMN_FAMILY_ARRAY, EMPTY_START_ROW, LATEST_TIMESTAMP,
+            &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... EMPTY_START_ROW will work but &apos;startRow&apos; would be easier to read (It&apos;d work too &amp;#8211; right?).&lt;/p&gt;

&lt;p&gt;Here:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      } &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (startRow.compareTo(EMPTY_START_ROW) != 0);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;.. EMPTY_ROW or a new define, LAST_ROW, would have been more readable, don&apos;t you think?&lt;/p&gt;

&lt;p&gt;This 999... &apos;trick&apos; should be done as a method &amp;#8211; in HTableInfo? &amp;#8211; since you do it twice:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    Text tableKey = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Text(tableName.toString() + &lt;span class=&quot;code-quote&quot;&gt;&quot;,,99999999999999&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12558594" author="hudson" created="Mon, 14 Jan 2008 13:19:23 +0000"  >&lt;p&gt;Integrated in Hadoop-Nightly #365 (See &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/365/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/365/&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12558659" author="jimk" created="Mon, 14 Jan 2008 16:39:43 +0000"  >&lt;p&gt;Now that this works and has been committed, can we reduce the &apos;chattiness&apos; of the debug level logging?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12558702" author="bryanduxbury" created="Mon, 14 Jan 2008 18:07:45 +0000"  >&lt;p&gt;Resolving issue. I have opened new issues for dealing with the problems mentioned in comments above. See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-365&quot; title=&quot;[hbase] Remove chatty debug logging from 2443 patch&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-365&quot;&gt;&lt;del&gt;HADOOP-2598&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-319&quot; title=&quot;[hbase] Some minor improvements to changes in HADOOP-2443&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-319&quot;&gt;&lt;del&gt;HADOOP-2599&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12559753" author="clint.morgan" created="Thu, 17 Jan 2008 00:08:51 +0000"  >&lt;p&gt;Looks to me like this introduced a bug in HTable.getStartKeys():&lt;/p&gt;

&lt;p&gt;Line 231 breaks from the while loop if the HRegionInfo is not for this.tableName. Instead it should continue.&lt;/p&gt;</comment>
                            <comment id="12559759" author="bryanduxbury" created="Thu, 17 Jan 2008 00:25:54 +0000"  >&lt;p&gt;I&apos;m not sure I understand your logic. if I replaced line 231 with a continue, it would just continue the for loop that&apos;s iterating over the columns of the current result we pulled back. The reason that we break all the way out of the scanner iteration loop is because it is impossible for this scanner to ever yield another HRegionInfo that might match the current table. Continuing would only waste time traversing the rest of the scanner.&lt;/p&gt;

&lt;p&gt;This did, however, bring to my attention that if there are multiple .META. regions, and the table we&apos;re searching for is in the first .META. region, this code will actually search at least the first row of the second region too. So in reality, the break SCANNER_LOOP should be break REGION_LOOP. Does that make sense?&lt;/p&gt;</comment>
                            <comment id="12559768" author="clint.morgan" created="Thu, 17 Jan 2008 00:49:21 +0000"  >&lt;p&gt;Well, I don&apos;t fully understand the code, but had a problem where HTable.getStartKeys was returning empty array.&lt;/p&gt;

&lt;p&gt;I stepped through the execution and the first HRegionInfo it got was not for this table, so it would hit that break out of the loop, and so return empty array.&lt;/p&gt;

&lt;p&gt;I changed break to continue, then it hits this.tableName, and correctly returns my startKey.&lt;/p&gt;

&lt;p&gt;&quot;The reason that we break all the way out of the scanner iteration loop is because it is impossible for this scanner to ever yield another HRegionInfo that might match the current table.&quot;&lt;/p&gt;

&lt;p&gt;I don&apos;t understand this logic, but as I said I don&apos;t fully understand the code. Its seems to me you just break on the first HRegionInfo, and there is no reason to assume the one we want is not latter in the scanner...&lt;/p&gt;

&lt;p&gt;The way I read it, this code only works if the &lt;b&gt;first&lt;/b&gt; HRegionInfo you get is for this.tableName.&lt;/p&gt;</comment>
                            <comment id="12559769" author="bryanduxbury" created="Thu, 17 Jan 2008 00:59:44 +0000"  >&lt;p&gt;You know what, I think you&apos;re right. I must have only tested it in scenarios when there are single tables.&lt;/p&gt;

&lt;p&gt;I&apos;ve opened a new issue to track this problem, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-110&quot; title=&quot;[hbase] 2443 breaks HTable.getStartKeys when there is more than one table or table you are enumerating isn&amp;#39;t the first table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-110&quot;&gt;&lt;del&gt;HADOOP-2631&lt;/del&gt;&lt;/a&gt;. I am resolving this issue again, because it&apos;s already been committed.&lt;/p&gt;</comment>
                            <comment id="12565064" author="hudson" created="Sat, 2 Feb 2008 12:38:13 +0000"  >&lt;p&gt;Integrated in Hadoop-trunk #387 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/387/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Hadoop-trunk/387/&lt;/a&gt;)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12385631">HBASE-274</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12373068" name="2443-v10.patch" size="75666" author="bryanduxbury" created="Mon, 14 Jan 2008 00:30:45 +0000"/>
                            <attachment id="12372735" name="2443-v3.patch" size="36309" author="bryanduxbury" created="Tue, 8 Jan 2008 20:52:41 +0000"/>
                            <attachment id="12372840" name="2443-v4.patch" size="50407" author="bryanduxbury" created="Wed, 9 Jan 2008 20:57:07 +0000"/>
                            <attachment id="12372950" name="2443-v5.patch" size="62491" author="bryanduxbury" created="Fri, 11 Jan 2008 00:29:10 +0000"/>
                            <attachment id="12373019" name="2443-v6.patch" size="75100" author="bryanduxbury" created="Sat, 12 Jan 2008 00:16:07 +0000"/>
                            <attachment id="12373034" name="2443-v7.patch" size="75551" author="bryanduxbury" created="Sat, 12 Jan 2008 19:52:22 +0000"/>
                            <attachment id="12373038" name="2443-v8.patch" size="75515" author="bryanduxbury" created="Sat, 12 Jan 2008 22:10:03 +0000"/>
                            <attachment id="12373058" name="2443-v9.patch" size="75539" author="bryanduxbury" created="Sun, 13 Jan 2008 17:48:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 17 Dec 2007 20:54:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25150</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 46 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h6vj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98376</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>