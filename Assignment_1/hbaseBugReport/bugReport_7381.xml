<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:45:13 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7381/HBASE-7381.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7381] Lightweight data transfer for Class Result</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7381</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Currently,the data transferring between 2 Result objects in the same process, will cause additional/unnecessary data parsing &amp;amp; copying; as we have to do that via &quot;Writables.copyWritable(result1, result2)&quot;, which internally is serialization, data copying, and de-serialization.&lt;/p&gt;

&lt;p&gt;The use case are quite common when integrated with Hadoop job running;&lt;br/&gt;
The protocol org.apache.hadoop.mapred.RecordReader defined in Hadoop, provides 3 interfaces:&lt;br/&gt;
1) K createKey();&lt;br/&gt;
2) V createValue();&lt;br/&gt;
3) boolean next(K key, V value) throws IOException;&lt;/p&gt;

&lt;p&gt;In the 3rd method implementation, most likely requires the value (should be Result object) to be filled, with the Result object from HBase.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12624411">HBASE-7381</key>
            <summary>Lightweight data transfer for Class Result</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hcheng">Cheng Hao</assignee>
                                    <reporter username="chenghao">Cheng Hao</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Dec 2012 05:14:08 +0000</created>
                <updated>Thu, 2 May 2013 02:29:59 +0000</updated>
                            <resolved>Wed, 19 Dec 2012 06:54:43 +0000</resolved>
                                                    <fixVersion>0.94.4</fixVersion>
                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13534651" author="chenghao" created="Tue, 18 Dec 2012 05:19:41 +0000"  >&lt;p&gt;Provide a new API in Result class.&lt;/p&gt;</comment>
                            <comment id="13534653" author="hadoopqa" created="Tue, 18 Dec 2012 05:24:18 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561428/result_lightweight_copy.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561428/result_lightweight_copy.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3580//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3580//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13534671" author="yuzhihong@gmail.com" created="Tue, 18 Dec 2012 05:42:48 +0000"  >&lt;p&gt;@Hao:&lt;br/&gt;
Can you show us code snippet where the new API is used ?&lt;/p&gt;</comment>
                            <comment id="13534679" author="chenghao" created="Tue, 18 Dec 2012 05:55:51 +0000"  >&lt;p&gt;@Yu&lt;br/&gt;
    The following code is from the Hive HBaseHandler, you may need to notice the part I commented out.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;HiveHBaseTableInputFormat.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      @Override
      &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; next(ImmutableBytesWritable rowKey, Result value) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {

        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; next = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;

        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
          next = recordReader.nextKeyValue();

          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (next) {
            rowKey.set(recordReader.getCurrentValue().getRow());
            Writables.copyWritable(recordReader.getCurrentValue(), value);
            &lt;span class=&quot;code-comment&quot;&gt;//Result.copy(recordReader.getCurrentValue(), value);
&lt;/span&gt;          }
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException e) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(e);
        }

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; next;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="13534684" author="yuzhihong@gmail.com" created="Tue, 18 Dec 2012 05:59:20 +0000"  >&lt;p&gt;Makes sense.&lt;br/&gt;
It would be nice to link the Hive JIRA where the above Result.copy() first appears to this ticket.&lt;/p&gt;

&lt;p&gt;+1 on patch.&lt;/p&gt;

&lt;p&gt;Please also attach patch for trunk.&lt;/p&gt;</comment>
                            <comment id="13534688" author="chenghao" created="Tue, 18 Dec 2012 06:06:27 +0000"  >&lt;p&gt;Thanks @Yu&lt;/p&gt;

&lt;p&gt;Once this patch is applied, I will create another Jira issue for Hive.&lt;/p&gt;</comment>
                            <comment id="13534710" author="lhofhansl" created="Tue, 18 Dec 2012 06:55:12 +0000"  >&lt;p&gt;Result in trunk already has a copyFrom method. I added that while removing Writable from Result.&lt;br/&gt;
Let&apos;s call it the same in 0.94.&lt;/p&gt;

&lt;p&gt;Note that this is only needed to mapred (and API requiring mutable objects is an abomination - IMHO).&lt;/p&gt;

&lt;p&gt;I&apos;m fine making this change in 0.94, should then also fix TableRecordReaderImpl by calling this API.&lt;/p&gt;</comment>
                            <comment id="13535654" author="chenghao" created="Wed, 19 Dec 2012 05:24:17 +0000"  >&lt;p&gt;Thanks, Lars. I didn&apos;t notice that in trunk.&lt;/p&gt;

&lt;p&gt;It will be helpful if the changes can apply to 0.94, too. &lt;/p&gt;

&lt;p&gt;I created a new patch with slightly different changes compared to the trunk, but keep the same method name. &lt;/p&gt;
</comment>
                            <comment id="13535661" author="hadoopqa" created="Wed, 19 Dec 2012 05:33:51 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561644/result_lightweight_copy_v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561644/result_lightweight_copy_v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3605//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3605//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13535667" author="yuzhihong@gmail.com" created="Wed, 19 Dec 2012 05:42:55 +0000"  >&lt;p&gt;Here is Result.copyFrom() in trunk:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void copyFrom(Result other) {
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.row = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.familyMap = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.kvs = other.kvs;
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It is actually different from the method in patch.&lt;/p&gt;</comment>
                            <comment id="13535669" author="lhofhansl" created="Wed, 19 Dec 2012 05:44:45 +0000"  >&lt;p&gt;Well yeah, it&apos;s different. bytes is gone from trunk. But the API should be the same.&lt;/p&gt;</comment>
                            <comment id="13535671" author="lhofhansl" created="Wed, 19 Dec 2012 05:46:31 +0000"  >&lt;p&gt;I&apos;ll commit v2 tonight unless I hear objections.&lt;br/&gt;
(BTW... It it is typically better to keep the old attachments around so that comments referring to those still make sense when somebody sees this later)&lt;/p&gt;</comment>
                            <comment id="13535676" author="chenghao" created="Wed, 19 Dec 2012 05:51:01 +0000"  >&lt;p&gt;oh, sorry, I will take care of that next time.&lt;/p&gt;

&lt;p&gt;Thanks Lars.&lt;/p&gt;</comment>
                            <comment id="13535723" author="lhofhansl" created="Wed, 19 Dec 2012 06:54:43 +0000"  >&lt;p&gt;Committed to 0.94. Thanks for the patch Cheng.&lt;/p&gt;</comment>
                            <comment id="13535801" author="hudson" created="Wed, 19 Dec 2012 09:14:30 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #644 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/644/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/644/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7381&quot; title=&quot;Lightweight data transfer for Class Result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7381&quot;&gt;&lt;del&gt;HBASE-7381&lt;/del&gt;&lt;/a&gt; Lightweight data transfer for Class Result (Cheng Hao) (Revision 1423771)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/Result.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapred/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13537910" author="hudson" created="Fri, 21 Dec 2012 14:17:09 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #87 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/87/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/87/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7381&quot; title=&quot;Lightweight data transfer for Class Result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7381&quot;&gt;&lt;del&gt;HBASE-7381&lt;/del&gt;&lt;/a&gt; Lightweight data transfer for Class Result (Cheng Hao) (Revision 1423771)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/Result.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapred/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13544396" author="hudson" created="Sat, 5 Jan 2013 00:42:22 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #10 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/10/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/10/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7381&quot; title=&quot;Lightweight data transfer for Class Result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7381&quot;&gt;&lt;del&gt;HBASE-7381&lt;/del&gt;&lt;/a&gt; Lightweight data transfer for Class Result (Cheng Hao) (Revision 1423771)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/Result.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapred/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12624752">HIVE-3823</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12561644" name="result_lightweight_copy_v2.patch" size="1227" author="chenghao" created="Wed, 19 Dec 2012 05:24:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Dec 2012 05:24:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>299250</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i160j3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243218</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>