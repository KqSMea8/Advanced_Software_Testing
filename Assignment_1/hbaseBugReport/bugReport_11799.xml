<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:26:44 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11799/HBASE-11799.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11799] AsyncProcess can get locked when running PE</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11799</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;On a clean checkout of 0.98.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mvn clean &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; -DskipTests
bin/start-hbase.sh
bin/hbase pe --nomapred randomWrite  10 1000&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Everything runs fine for a while then the client hangs.&lt;/p&gt;

&lt;p&gt;The region server thinks that all requests have completed successfully. The PE process is all stuck on the final flush.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12735893">HBASE-11799</key>
            <summary>AsyncProcess can get locked when running PE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Aug 2014 20:51:21 +0000</created>
                <updated>Mon, 25 Aug 2014 11:48:53 +0000</updated>
                                            <version>0.98.7</version>
                                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="14106945" author="stack" created="Fri, 22 Aug 2014 15:16:46 +0000"  >&lt;p&gt;You want to look at this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14108955" author="nkeywal" created="Mon, 25 Aug 2014 09:44:43 +0000"  >&lt;p&gt;Let me try to repro.&lt;/p&gt;</comment>
                            <comment id="14108983" author="nkeywal" created="Mon, 25 Aug 2014 10:13:15 +0000"  >&lt;p&gt;using exactly what Elliott wrote, all values (heap &amp;amp; so on) being the default.&lt;/p&gt;

&lt;p&gt;On master, it does not work because the ZK thread embedded in the server stops (CancelledKey exception not managed in ZK code)&lt;/p&gt;



&lt;p&gt;On 0.98 top, for my first run, there are some nasty exceptions in the server, but the test completed. I will run it a few more more times.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-08-25 11:57:37,967 WARN  [defaultRpcServer.handler=19,queue=1,port=40554] regionserver.MemStoreFlusher: Memstore is above high water mark and block 71ms
2014-08-25 11:57:37,968 ERROR [MemStoreFlusher.1] regionserver.MemStoreFlusher: Cache flusher failed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; entry org.apache.hadoop.hbase.regionserver.MemStoreFlusher$WakeupFlushThread@291daa39
java.lang.IllegalStateException
        at com.google.common.base.Preconditions.checkState(Preconditions.java:133)
        at org.apache.hadoop.hbase.regionserver.MemStoreFlusher.flushOneForGlobalPressure(MemStoreFlusher.java:208)
        at org.apache.hadoop.hbase.regionserver.MemStoreFlusher.access$500(MemStoreFlusher.java:66)
        at org.apache.hadoop.hbase.regionserver.MemStoreFlusher$FlushHandler.run(MemStoreFlusher.java:238)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
2014-08-25 11:57:38,051 INFO  [MemStoreFlusher.0] regionserver.DefaultStoreFlusher: Flushed, sequenceid=144, memsize=138.5 M, hasBloomFilter=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, into tmp file file:/tmp/hbase-liochon/hbase/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/TestTable/0434b24c6f20a4fbc259a3a54eafbdb0/.tmp/2ee7375469d644e4b905c745f2374053
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</comment>
                            <comment id="14108995" author="nkeywal" created="Mon, 25 Aug 2014 10:28:43 +0000"  >&lt;p&gt;On the second run, I have also this exception&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-08-25 12:19:01,697 ERROR [SyncThread:0] server.NIOServerCnxn: Unexpected Exception:
java.nio.channels.CancelledKeyException
        at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
        at sun.nio.ch.SelectionKeyImpl.interestOps(SelectionKeyImpl.java:77)
        at org.apache.zookeeper.server.NIOServerCnxn.sendBuffer(NIOServerCnxn.java:151)
        at org.apache.zookeeper.server.NIOServerCnxn.sendResponse(NIOServerCnxn.java:1081)
        at org.apache.zookeeper.server.FinalRequestProcessor.processRequest(FinalRequestProcessor.java:170)
        at org.apache.zookeeper.server.SyncRequestProcessor.run(SyncRequestProcessor.java:169)
2014-08-25 12:19:01,697 INFO  [AM.ZK.Worker-pool2-t27] master.RegionStates: Transitioned &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; to {9da7992368bde5b8a0c38ad7a80cdc5d state=SPLITTING_NEW, ts=1408961941697, server=dumas.scaledrisk.com,42674,1408961692215}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I had this exception on the master as well. I though it was the cause of the server stops, likely I was wrong.&lt;/p&gt;

&lt;p&gt;Still the second run completed successfully.&lt;br/&gt;
When I look at the jstack it seems that there is a bug in the client for sure. Trying a 3rd time.&lt;/p&gt;</comment>
                            <comment id="14109029" author="nkeywal" created="Mon, 25 Aug 2014 11:48:53 +0000"  >&lt;p&gt;3rd ok as well. With only the MemStoreFlusher exception this time, not the NIOServerCnxn one.&lt;/p&gt;

&lt;p&gt;Do you have 100% repro on your side, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;?&lt;br/&gt;
I ran the test on Ubuntu, with the jdk 1.7.55&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12663499" name="jstack" size="34274" author="eclark" created="Thu, 21 Aug 2014 20:51:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 22 Aug 2014 15:16:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1z7a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>