<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:48:14 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-866/HBASE-866.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-866] Blocking for ten minutes at a time</title>
                <link>https://issues.apache.org/jira/browse/HBASE-866</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I&apos;ve been testing running biggish MR jobs uploading into hbase.  My jobs consistently fail with child task timing out its ten minute period.  Adding logging, was able to see that we&apos;re actual stuck in a commit.  Following the thread of the row we&apos;re committing, I see this in the log:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
2008-09-03 18:37:03,446 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Flush requested on TestTable,0029377106,1220466998108
2008-09-03 18:37:03,446 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Started memcache flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108. Current region memcache size 64.0m
2008-09-03 18:37:03,446 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 1 on 60020&apos; on region TestTable,0029377106,1220466998108: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 18:37:13,450 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 &apos;IPC Server handler 1 on 60020&apos;
2008-09-03 18:37:16,089 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 16 on 60020&apos; on region TestTable,0029377106,1220466998108: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 18:37:16,090 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 1 on 60020&apos; on region TestTable,0029377106,1220466998108: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 18:37:16,090 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 4 on 60020&apos; on region TestTable,0029377106,1220466998108: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 18:37:16,090 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 6 on 60020&apos; on region TestTable,0029377106,1220466998108: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 18:37:16,090 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 2 on 60020&apos; on region TestTable,0029377106,1220466998108: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 18:37:16,090 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 12 on 60020&apos; on region TestTable,0029377106,1220466998108: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 18:37:16,090 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 9 on 60020&apos; on region TestTable,0029377106,1220466998108: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 18:37:16,091 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 7 on 60020&apos; on region TestTable,0029377106,1220466998108: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 18:37:21,984 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Finished memcache flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 in 18538ms, sequence id=2852547, compaction requested=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2008-09-03 18:47:06,241 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Started memcache flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108. Current region memcache size 64.0m
2008-09-03 18:47:10,031 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Finished memcache flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 in 3790ms, sequence id=2919208, compaction requested=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2008-09-03 18:47:10,031 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 &apos;IPC Server handler 9 on 60020&apos;
2008-09-03 18:47:10,031 DEBUG org.apache.hadoop.hbase.regionserver.CompactSplitThread: Compaction requested &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region: TestTable,0029377106,1220466998108
2008-09-03 18:47:10,031 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 &apos;IPC Server handler 12 on 60020&apos;
2008-09-03 18:47:10,032 INFO org.apache.hadoop.hbase.regionserver.HRegion: starting compaction on region TestTable,0029377106,1220466998108
2008-09-03 18:47:10,032 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 &apos;IPC Server handler 7 on 60020&apos;
2008-09-03 18:47:10,035 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 &apos;IPC Server handler 6 on 60020&apos;
2008-09-03 18:47:10,035 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 &apos;IPC Server handler 4 on 60020&apos;
2008-09-03 18:47:10,035 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 &apos;IPC Server handler 2 on 60020&apos;
2008-09-03 18:47:10,037 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 &apos;IPC Server handler 16 on 60020&apos;
2008-09-03 18:47:10,043 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0029377106,1220466998108 &apos;IPC Server handler 1 on 60020&apos;
2008-09-03 18:47:18,403 INFO org.apache.hadoop.hbase.regionserver.HRegion: compaction completed on region TestTable,0029377106,1220466998108 in 8sec
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Notice how we&apos;re blocked for ten minutes until new flush runs.  My guess is that the flush that is going on concurrent with the blocking is clearing the flag &lt;/p&gt;</description>
                <environment></environment>
        <key id="12403641">HBASE-866</key>
            <summary>Blocking for ten minutes at a time</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Sep 2008 21:37:47 +0000</created>
                <updated>Fri, 21 Aug 2009 23:00:11 +0000</updated>
                            <resolved>Fri, 21 Aug 2009 23:00:11 +0000</resolved>
                                                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12628208" author="stack" created="Thu, 4 Sep 2008 00:04:19 +0000"  >&lt;p&gt;Here is another example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2008-09-03 23:35:54,899 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Flush requested on TestTable,0134223832,1220484926984
2008-09-03 23:35:54,899 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Started memcache flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984. Current region memcache size 64.0m
2008-09-03 23:35:54,899 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 10 on 60020&apos; on region TestTable,0134223832,1220484926984: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 23:35:54,901 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 &apos;IPC Server handler 10 on 60020&apos;
2008-09-03 23:36:05,287 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 1 on 60020&apos; on region TestTable,0134223832,1220484926984: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 23:36:05,287 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 8 on 60020&apos; on region TestTable,0134223832,1220484926984: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 23:36:05,287 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 0 on 60020&apos; on region TestTable,0134223832,1220484926984: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 23:36:05,287 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 2 on 60020&apos; on region TestTable,0134223832,1220484926984: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 23:36:05,288 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 10 on 60020&apos; on region TestTable,0134223832,1220484926984: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 23:36:05,288 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 9 on 60020&apos; on region TestTable,0134223832,1220484926984: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 23:36:05,288 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 7 on 60020&apos; on region TestTable,0134223832,1220484926984: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 23:36:05,288 INFO org.apache.hadoop.hbase.regionserver.HRegion: Blocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &apos;IPC Server handler 12 on 60020&apos; on region TestTable,0134223832,1220484926984: Memcache size 64.0m is &amp;gt;= than blocking 64.0m size
2008-09-03 23:36:05,650 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Finished memcache flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 in 10751ms, sequence id=12850777, compaction requested=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2008-09-03 23:46:00,731 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Started memcache flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984. Current region memcache size 64.0m
2008-09-03 23:46:00,731 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 &apos;IPC Server handler 9 on 60020&apos;
2008-09-03 23:46:00,732 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 &apos;IPC Server handler 10 on 60020&apos;
2008-09-03 23:46:00,732 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 &apos;IPC Server handler 12 on 60020&apos;
2008-09-03 23:46:00,732 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 &apos;IPC Server handler 0 on 60020&apos;
2008-09-03 23:46:00,741 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 &apos;IPC Server handler 8 on 60020&apos;
2008-09-03 23:46:00,741 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 &apos;IPC Server handler 1 on 60020&apos;
2008-09-03 23:46:00,741 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 &apos;IPC Server handler 7 on 60020&apos;
2008-09-03 23:46:00,742 INFO org.apache.hadoop.hbase.regionserver.HRegion: Unblocking updates &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 &apos;IPC Server handler 2 on 60020&apos;
2008-09-03 23:46:04,123 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Finished memcache flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region TestTable,0134223832,1220484926984 in 3392ms, sequence id=12916127, compaction requested=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Running the above, I&apos;d moved notification of blocking threads to just after clear of memcache rather than later down in the flush but didn&apos;t seem to matter:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: src/java/org/apache/hadoop/hbase/regionserver/HRegion.java
===================================================================
--- src/java/org/apache/hadoop/hbase/regionserver/HRegion.java  (revision 691805)
+++ src/java/org/apache/hadoop/hbase/regionserver/HRegion.java  (working copy)
@@ -1042,6 +1042,10 @@
     } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
       &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.updatesLock.writeLock().unlock();
     }
+    &lt;span class=&quot;code-comment&quot;&gt;// Notify anyone waiting on memcache to clear: e.g. checkResources().
&lt;/span&gt;+    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;) {
+      notifyAll();
+    }
 
     &lt;span class=&quot;code-comment&quot;&gt;// Any failure from here on out will be catastrophic requiring server
&lt;/span&gt;     &lt;span class=&quot;code-comment&quot;&gt;// restart so hlog content can be replayed and put back into the memcache.
&lt;/span&gt;@@ -1081,13 +1085,6 @@
     &lt;span class=&quot;code-comment&quot;&gt;//     log-sequence-ids can be safely ignored.
&lt;/span&gt;     &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.log.completeCacheFlush(getRegionName(),
         regionInfo.getTableDesc().getName(), completeSequenceId);
-
-    &lt;span class=&quot;code-comment&quot;&gt;// C. Finally notify anyone waiting on memcache to clear:
&lt;/span&gt;-    &lt;span class=&quot;code-comment&quot;&gt;// e.g. checkResources().
&lt;/span&gt;-    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;) {
-      notifyAll();
-    }
-    
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
       &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; timeTaken = StringUtils.formatTimeDiff(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis(), 
           startTime);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12628737" author="stack" created="Fri, 5 Sep 2008 20:39:15 +0000"  >&lt;p&gt;Ok. This issue is not as bad as I thought.   I had hbase.hregion.memcache.block.multiplier set to 1 &amp;#8211; and optional flushes to every ten minutes &amp;#8211; so was seeing loads of blocking.  Downgrading to minor.  The possibility for our blocking forever is still there so needs to be fixed; its just not too likely.  Have been able to load up a 4 node cluster w/ 1/4B rows using default heap sizes with about 300 regions per server without my MR loader failing a single task.&lt;/p&gt;</comment>
                            <comment id="12641107" author="stack" created="Mon, 20 Oct 2008 18:33:19 +0000"  >&lt;p&gt;Pirroh from #IRC had this issue w/ recent hbase.  He had set the flushsize down to 16MB.  Try doing this to see if it makes the issue come back.&lt;/p&gt;</comment>
                            <comment id="12662601" author="ryanobjc" created="Sat, 10 Jan 2009 01:49:38 +0000"  >&lt;p&gt;I got the stall as well... I was running a 9-in parallel load, and my cluster just stalled. Included is the logfile from 1 of the 2 (out of 3 total) stalled servers... the thread dump is embedded in the logfile, as I requested it via the web UI.&lt;/p&gt;</comment>
                            <comment id="12672469" author="apurtell" created="Wed, 11 Feb 2009 00:42:17 +0000"  >&lt;p&gt;Here is a Hertitrix hbase-writer thread stuck in RPC for over an hour:&lt;/p&gt;

&lt;p&gt;[ToeThread #96: &lt;a href=&quot;http://esinidc.onlinedown.net/down/NXSetup.zip&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://esinidc.onlinedown.net/down/NXSetup.zip&lt;/a&gt;&lt;br/&gt;
 CrawlURI &lt;a href=&quot;http://esinidc.onlinedown.net/down/NXSetup.zip&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://esinidc.onlinedown.net/down/NXSetup.zip&lt;/a&gt; LX &lt;a href=&quot;http://www.onlinedown.net/soft/2919.htm&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.onlinedown.net/soft/2919.htm&lt;/a&gt;    0 attempts&lt;br/&gt;
    in processor: Archiver&lt;br/&gt;
    ACTIVE for 1h21m41s176ms&lt;br/&gt;
    step: ABOUT_TO_BEGIN_PROCESSOR for 1h21m2s77ms&lt;br/&gt;
Java Thread State: WAITING&lt;br/&gt;
Blocked/Waiting On: NONE&lt;br/&gt;
    java.lang.Object.wait(Native Method)&lt;br/&gt;
    java.lang.Object.wait(Object.java:485)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:695)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseRPC$Invoker.invoke(HBaseRPC.java:321)&lt;br/&gt;
    $Proxy12.batchUpdates(Unknown Source)&lt;br/&gt;
    org.apache.hadoop.hbase.client.HConnectionManager$TableServers$2.call(HConnectionManager.java:953)&lt;br/&gt;
    org.apache.hadoop.hbase.client.HConnectionManager$TableServers$2.call(HConnectionManager.java:951)&lt;br/&gt;
    org.apache.hadoop.hbase.client.HConnectionManager$TableServers.getRegionServerWithRetries(HConnectionManager.java:845)&lt;br/&gt;
    org.apache.hadoop.hbase.client.HConnectionManager$TableServers.processBatchOfRows(HConnectionManager.java:950)&lt;br/&gt;
    org.apache.hadoop.hbase.client.HTable.flushCommits(HTable.java:1372)&lt;br/&gt;
    org.apache.hadoop.hbase.client.HTable.commit(HTable.java:1316)&lt;br/&gt;
    org.apache.hadoop.hbase.client.HTable.commit(HTable.java:1296)&lt;br/&gt;
    net.iridiant.heritrix.writer.HBaseWriter.write(Unknown Source)&lt;br/&gt;
    net.iridiant.heritrix.writer.HBaseWriterProcessor.write(Unknown Source)&lt;br/&gt;
    net.iridiant.heritrix.writer.HBaseWriterProcessor.innerProcessResult(Unknown Source)&lt;br/&gt;
    org.archive.modules.Processor.process(Processor.java:123)&lt;br/&gt;
    org.archive.crawler.framework.ToeThread.processCrawlUri(ToeThread.java:310)&lt;br/&gt;
    org.archive.crawler.framework.ToeThread.run(ToeThread.java:157)&lt;br/&gt;
]&lt;/p&gt;

&lt;p&gt;I have a pool of 100 TOE threads all stuck in Archiver, a few in RPC, but only on one node. There are two other nodes still writing at full speed into HBase.&lt;/p&gt;

&lt;p&gt;Intermittent synchronization/wake problem on the write path? Needs investigation.&lt;/p&gt;</comment>
                            <comment id="12672528" author="stack" created="Wed, 11 Feb 2009 06:53:18 +0000"  >&lt;p&gt;Were you able to look at logs on the node they were all hung on Andrew?  Did it have logging of &apos;Blocking updates&apos; with no corresponding &apos;unblocking&apos; messages?  Or could you get a thread dump out of the HRS to see why its hung up?  Thanks A.&lt;/p&gt;</comment>
                            <comment id="12672708" author="apurtell" created="Wed, 11 Feb 2009 18:26:21 +0000"  >&lt;p&gt;The information in the TOE report does not indicate what specific region is being contacted for the store, only the URL that the TOE is processing. For example we store a record for the URL, a record for the content (key is MD5 hash of the content), some other metadata records in other tables, etc. &lt;/p&gt;

&lt;p&gt;My cluster is constantly freezing up on the write path now and I am needing to restart it every couple of hours. I have taken a snapshot of all thread/stack traces just before the last restart, if you would like to take a look. &lt;/p&gt;</comment>
                            <comment id="12672717" author="apurtell" created="Wed, 11 Feb 2009 18:45:41 +0000"  >&lt;p&gt;Ok, I have figured out what is going on, at least in my case.&lt;/p&gt;

&lt;p&gt;OOME in IPC server handler causes the IPC handler to abort, but the client never learns about this, so it waits and waits and waits... I have seen Heritrix writer threads that have been waiting for 7+ hours. And, the OOME does not take down the HRS, so it stays up in some degraded state. See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1196&quot; title=&quot;OOME in HRS IPC server causes infinite client stall&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1196&quot;&gt;&lt;del&gt;HBASE-1196&lt;/del&gt;&lt;/a&gt;. Sorry to pollute this issue. &lt;/p&gt;
</comment>
                            <comment id="12672719" author="stack" created="Wed, 11 Feb 2009 18:49:04 +0000"  >&lt;p&gt;Those OOME&apos;s in the IPC handlers are bad for us.  If the request made it into the HRS, we&apos;d have a crack at it letting go of our memory resevoir and then shutting down.  Looks like we have another reason to mod our version of hadoop&apos;s RPC.&lt;/p&gt;</comment>
                            <comment id="12746336" author="stack" created="Fri, 21 Aug 2009 23:00:11 +0000"  >&lt;p&gt;Haven&apos;t seen in ages.  Closing as no longer valid.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12397585" name="thread_dump.txt" size="558138" author="ryanobjc" created="Sat, 10 Jan 2009 01:49:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 10 Jan 2009 01:49:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25446</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h9xj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98871</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>