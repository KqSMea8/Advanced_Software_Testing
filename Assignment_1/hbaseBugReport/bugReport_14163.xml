<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:50:23 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14163/HBASE-14163.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14163] hbase master stop loops both processes forever</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14163</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;It would appear that there is an infinite loop in the zk client connection code when performing a master stop when no external zk servers are configured.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12849735">HBASE-14163</key>
            <summary>hbase master stop loops both processes forever</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="aw">Allen Wittenauer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Jul 2015 20:18:08 +0000</created>
                <updated>Thu, 30 Jul 2015 22:55:22 +0000</updated>
                                            <version>2.0.0</version>
                                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14644985" author="aw" created="Tue, 28 Jul 2015 20:20:43 +0000"  >&lt;p&gt;I can reproduce this repeatedly using master.&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;untar a fresh install with nothing configured except what ships out of the box&lt;/li&gt;
	&lt;li&gt;bin/hbase master start&lt;/li&gt;
	&lt;li&gt;let it start up&lt;/li&gt;
	&lt;li&gt;in another window, bin/hbase master stop&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Both processes are now looping:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2015-07-28 13:16:11,985 INFO  [10.248.3.81:53113.activeMasterManager-SendThread(localhost:2181)] zookeeper.ClientCnxn: Opening socket connection to server localhost/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2015-07-28 13:16:11,985 WARN  [10.248.3.81:53113.activeMasterManager-SendThread(localhost:2181)] zookeeper.ClientCnxn: Session 0x14ed64a3ddd0004 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; server &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, unexpected error, closing socket connection and attempting reconnect
java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:739)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:361)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1081)
2015-07-28 13:16:12,603 INFO  [10.248.3.81:53113.activeMasterManager-SendThread(localhost:2181)] zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181. Will not attempt to authenticate using SASL (unknown error)
2015-07-28 13:16:12,603 WARN  [10.248.3.81:53113.activeMasterManager-SendThread(localhost:2181)] zookeeper.ClientCnxn: Session 0x14ed64a3ddd0004 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; server &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, unexpected error, closing socket connection and attempting reconnect
java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:739)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:361)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1081)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... until a kill or ctrl-c is sent. &lt;/p&gt;</comment>
                            <comment id="14645962" author="asamir" created="Wed, 29 Jul 2015 12:24:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aw&quot; class=&quot;user-hover&quot; rel=&quot;aw&quot;&gt;Allen Wittenauer&lt;/a&gt;, i was unable to reproduce this issue on my laptop (Fedora 22) but looking at log you provided this line looks suspicious &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2015-07-28 13:16:12,603 INFO  [10.248.3.81:53113.activeMasterManager-SendThread(localhost:2181)] zookeeper.ClientCnxn: Opening socket connection to server localhost/0:0:0:0:0:0:0:1:2181. Will not attempt to authenticate using SASL (unknown error)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looks like you resolve localhost to IPv6 address. Not sure where we are with supporting IPv6 on HBase&lt;/p&gt;</comment>
                            <comment id="14646153" author="aw" created="Wed, 29 Jul 2015 14:49:52 +0000"  >&lt;p&gt;How long did it take for your hbase master to shutdown?&lt;/p&gt;</comment>
                            <comment id="14646330" author="aw" created="Wed, 29 Jul 2015 16:14:06 +0000"  >&lt;p&gt;So, I just set -Djava.net.preferIPv4Stack=true for HBASE_OPTS in hbase-env.sh and still see the same behavior, minus trying to use IPv6.&lt;/p&gt;

&lt;p&gt;This is on Mac OS X 10.9.5 with JDK 1.7.0_67.&lt;/p&gt;</comment>
                            <comment id="14647317" author="asamir" created="Thu, 30 Jul 2015 08:04:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;How long did it take for your hbase master to shutdown?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;In my case 10-15s.&lt;br/&gt;
Here is my output from $hbase master stop:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2015-07-30 09:22:20,826 INFO  [main] zookeeper.ZooKeeper: Initiating client connection, connectString=localhost:2181 sessionTimeout=90000 watcher=hconnection-0x344ec9c40x0, quorum=localhost:2181, baseZNode=/hbase
2015-07-30 09:22:20,856 INFO  [main-SendThread(localhost.localdomain:2181)] zookeeper.ClientCnxn: Opening socket connection to server localhost.localdomain/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)
2015-07-30 09:22:20,861 INFO  [main-SendThread(localhost.localdomain:2181)] zookeeper.ClientCnxn: Socket connection established to localhost.localdomain/127.0.0.1:2181, initiating session
2015-07-30 09:22:20,870 INFO  [main-SendThread(localhost.localdomain:2181)] zookeeper.ClientCnxn: Session establishment complete on server localhost.localdomain/127.0.0.1:2181, sessionid = 0x14eddd660110008, negotiated timeout = 40000
2015-07-30 09:22:21,686 INFO  [main] client.ConnectionImplementation: Closing master protocol: MasterService
2015-07-30 09:22:21,686 INFO  [main] client.ConnectionImplementation: Closing zookeeper sessionid=0x14eddd660110008
2015-07-30 09:22:21,687 INFO  [main] zookeeper.ZooKeeper: Session: 0x14eddd660110008 closed
2015-07-30 09:22:21,687 INFO  [main-EventThread] zookeeper.ClientCnxn: EventThread shut down
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I have seen this strange behavior on OS X before in most cases it was network related or something with fact that in default configuration we write data in /tmp dir.  &lt;/p&gt;
</comment>
                            <comment id="14647987" author="aw" created="Thu, 30 Jul 2015 17:23:50 +0000"  >&lt;p&gt;I wonder if this is a race condition.&lt;/p&gt;</comment>
                            <comment id="14648436" author="apurtell" created="Thu, 30 Jul 2015 22:55:22 +0000"  >&lt;p&gt;I have a similar dev environment available, let me try to repro&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12781854">HBASE-13231</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 29 Jul 2015 12:24:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 20 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2i1c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>