<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:29:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5606/HBASE-5606.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5606] SplitLogManger async delete node hangs log splitting when ZK connection is lost </title>
                <link>https://issues.apache.org/jira/browse/HBASE-5606</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;1. One rs died, the servershutdownhandler found it out and started the distributed log splitting;&lt;br/&gt;
2. All tasks are failed due to ZK connection lost, so the all the tasks were deleted asynchronously;&lt;br/&gt;
3. Servershutdownhandler retried the log splitting;&lt;br/&gt;
4. The asynchronously deletion in step 2 finally happened for new task&lt;br/&gt;
5. This made the SplitLogManger in hanging state.&lt;/p&gt;

&lt;p&gt;This leads to .META. region not assigened for long time&lt;/p&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hbase-root-master-HOST-192-168-47-204.log.2012-03-14&quot;(55413,79):2012-03-14 19:28:47,932 DEBUG org.apache.hadoop.hbase.master.SplitLogManager: put up splitlog task at znode /hbase/splitlog/hdfs%3A%2F%2F192.168.47.205%3A9000%2Fhbase%2F.logs%2Flinux-114.site%2C60020%2C1331720381665-splitting%2Flinux-114.site%252C60020%252C1331720381665.1331752316170
hbase-root-master-HOST-192-168-47-204.log.2012-03-14&quot;(89303,79):2012-03-14 19:34:32,387 DEBUG org.apache.hadoop.hbase.master.SplitLogManager: put up splitlog task at znode /hbase/splitlog/hdfs%3A%2F%2F192.168.47.205%3A9000%2Fhbase%2F.logs%2Flinux-114.site%2C60020%2C1331720381665-splitting%2Flinux-114.site%252C60020%252C1331720381665.1331752316170
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hbase-root-master-HOST-192-168-47-204.log.2012-03-14&quot;(80417,99):2012-03-14 19:34:31,196 DEBUG org.apache.hadoop.hbase.master.SplitLogManager$DeleteAsyncCallback: deleted /hbase/splitlog/hdfs%3A%2F%2F192.168.47.205%3A9000%2Fhbase%2F.logs%2Flinux-114.site%2C60020%2C1331720381665-splitting%2Flinux-114.site%252C60020%252C1331720381665.1331752316170
hbase-root-master-HOST-192-168-47-204.log.2012-03-14&quot;(89456,99):2012-03-14 19:34:32,497 DEBUG org.apache.hadoop.hbase.master.SplitLogManager$DeleteAsyncCallback: deleted /hbase/splitlog/hdfs%3A%2F%2F192.168.47.205%3A9000%2Fhbase%2F.logs%2Flinux-114.site%2C60020%2C1331720381665-splitting%2Flinux-114.site%252C60020%252C1331720381665.1331752316170
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12547330">HBASE-5606</key>
            <summary>SplitLogManger async delete node hangs log splitting when ZK connection is lost </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="khemani">Prakash Khemani</assignee>
                                    <reporter username="gopinathan.av">Gopinathan A</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Mar 2012 04:27:24 +0000</created>
                <updated>Wed, 18 Sep 2013 22:18:17 +0000</updated>
                            <resolved>Tue, 3 Apr 2012 22:19:40 +0000</resolved>
                                    <version>0.92.0</version>
                                    <fixVersion>0.92.2</fixVersion>
                    <fixVersion>0.94.0</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                    <component>wal</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13234084" author="stack" created="Wed, 21 Mar 2012 04:45:51 +0000"  >&lt;p&gt;Pretty bad.  Look to fix for 0.92.2&lt;/p&gt;</comment>
                            <comment id="13234152" author="chinnalalam" created="Wed, 21 Mar 2012 06:28:27 +0000"  >&lt;p&gt;This situation can come in 0.92 when&lt;/p&gt;

&lt;p&gt;1)First time SplitLogManager installed one task after that it is not able to connect to Zookeeper(Because of CONNECTIONLOSS).&lt;/p&gt;

&lt;p&gt;so the GetDataAsyncCallback will fail and it will retry which is register at the time of createNode() in installTask() or in TimeoutMonitor.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;19:32:24,657 WARN org.apache.hadoop.hbase.master.SplitLogManager$GetDataAsyncCallback: getdata rc = CONNECTIONLOSS /hbase/splitlog/hdfs%3A%2F%2F192.168.47.205%3A9000%2Fhbase%2F.logs%2Flinux-114.site%2C60020.1331752316170 retry=0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2)When ever the GetDataAsyncCallback retry=0 it will call setDone() here it will increment batch.error and it will register one DeleteAsyncCallback.&lt;/p&gt;

&lt;p&gt;3)So here installed != done so SplilogManger will throw exception and it will submit again.&lt;/p&gt;

&lt;p&gt;4)&quot;failed to set data watch&quot; is happened 92 times so 92 DeleteAsyncCallback are registered and all 92 DeleteAsyncCallback will try till it success.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;19:34:30,874 WARN org.apache.hadoop.hbase.master.SplitLogManager: failed to set data watch /hbase/splitlog/hdfs%3A%2F%2F192.168.47.205%3A9000%2Fhbase%2F.logs%2Flinux-114.site%2C60020%2C1331720381665-splitting%2Flinux-114.site%252C60020%252C1331720381665.1331752316170
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;5) Because of Point:3 SplitLogManager will try to install the task but it found already installed task is FAILURE so it is waiting to change to DELETED&lt;/p&gt;

&lt;p&gt;6)Once it got the Zookeer connection one of the DeleteAsyncCallback deleted the node  and it will notify the task which is waiting at Point:5&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;19:34:31,196 DEBUG org.apache.hadoop.hbase.master.SplitLogManager$DeleteAsyncCallback: deleted /hbase/splitlog/hdfs%3A%2F%2F192.168.47.205%3A9000%2Fhbase%2F.logs%2Flinux-114.site%2C60020%2C1331720381665-splitting%2Flinux-114.site%252C60020%252C1331720381665.1331752316170
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;7) Point:5 after notified it will crete the node&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;19:34:32,387 DEBUG org.apache.hadoop.hbase.master.SplitLogManager: put up splitlog task at znode /hbase/splitlog/hdfs%3A%2F%2F192.168.47.205%3A9000%2Fhbase%2F.logs%2Flinux-114.site%2C60020%2C1331720381665-splitting%2Flinux-114.site%252C60020%252C1331720381665.1331752316170
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;8) But already registered DeleteAsyncCallback&apos;s will execute and it will delete newly created node at Point:7&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;19:34:32,497 DEBUG org.apache.hadoop.hbase.master.SplitLogManager$DeleteAsyncCallback: deleted /hbase/splitlog/hdfs%3A%2F%2F192.168.47.205%3A9000%2Fhbase%2F.logs%2Flinux-114.site%2C60020%2C1331720381665-splitting%2Flinux-114.site%252C60020%252C1331720381665.1331752316170
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;9) So because of the node is deleted and it removed form tasks map flow wont come to the piece of code to increment the batch.done or batch.error in setDone().&lt;br/&gt;
So waitTask() will be in infinite looping and it wont come out.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&quot;MASTER_META_SERVER_OPERATIONS-HOST-192-168-47-204,60000,1331719909985-1&quot; prio=10 tid=0x0000000040d7c000 nid=0x624b in Object.wait() [0x00007ff090482000]
   java.lang.Thread.State: TIMED_WAITING (on object monitor)
	at java.lang.Object.wait(Native Method)
	at org.apache.hadoop.hbase.master.SplitLogManager.waitTasks(SplitLogManager.java:316)
	- locked &amp;lt;0x000000078e6c4258&amp;gt; (a org.apache.hadoop.hbase.master.SplitLogManager$TaskBatch)
	at org.apache.hadoop.hbase.master.SplitLogManager.splitLogDistributed(SplitLogManager.java:262)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13234155" author="chinnalalam" created="Wed, 21 Mar 2012 06:29:57 +0000"  >&lt;p&gt;I am trying to fix this any suggestions pls welcome..&lt;/p&gt;</comment>
                            <comment id="13234247" author="ram_krish" created="Wed, 21 Mar 2012 10:05:36 +0000"  >&lt;p&gt;It is similar with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5081&quot; title=&quot;Distributed log splitting deleteNode races against splitLog retry &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5081&quot;&gt;&lt;del&gt;HBASE-5081&lt;/del&gt;&lt;/a&gt; I feel.&lt;/p&gt;</comment>
                            <comment id="13234592" author="khemani" created="Wed, 21 Mar 2012 17:53:29 +0000"  >&lt;p&gt;@Chinna&lt;/p&gt;

&lt;p&gt;It is the TimeoutMonitor that causes the so many Deletes to be queued.&lt;/p&gt;

&lt;p&gt;The fix will be the following&lt;/p&gt;

&lt;p&gt;In TimeoutMonitor do not call getDataSetWatch() if the task has already failed.&lt;/p&gt;

&lt;p&gt;Ignore the call to getDataSetWatch() if there is already a pending getDataSetWatch against the task.&lt;/p&gt;

&lt;p&gt;Thanks for finding this issue.&lt;/p&gt;</comment>
                            <comment id="13235039" author="zhihyu@ebaysf.com" created="Wed, 21 Mar 2012 21:24:44 +0000"  >&lt;p&gt;Initial patch according to Prakash&apos;s suggestion.&lt;/p&gt;

&lt;p&gt;Still need to find out the API querying whether there is outstanding watcher for a specific path&lt;/p&gt;</comment>
                            <comment id="13235098" author="hadoopqa" created="Wed, 21 Mar 2012 22:12:55 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12519319/5606.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12519319/5606.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestSplitTransactionOnCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestSplitLogManager&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1244//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1244//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1244//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1244//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1244//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1244//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13235297" author="khemani" created="Thu, 22 Mar 2012 02:39:46 +0000"  >&lt;p&gt;The getDataSetWatch() call in the timeout-monitor is only being done to check whether the znode still exists or not. If there is a failure in getting to the znode then we should ignore that failure.&lt;/p&gt;

&lt;p&gt;How about implementing the following&lt;/p&gt;

&lt;p&gt;in timeoutmonitor &lt;br/&gt;
call getDataSetWatch() only if task has not already failed. (This is just an optimization and it can be done without any locking)&lt;/p&gt;

&lt;p&gt;for this particular getDataSetWatch() call, store a IGNORE-ZK-ERROR flag in the zk async context. If a zk error happens silently then do nothing.&lt;/p&gt;
</comment>
                            <comment id="13235409" author="chinnalalam" created="Thu, 22 Mar 2012 07:05:35 +0000"  >&lt;p&gt;@Prakash&lt;br/&gt;
Thanks prakash for the points&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;in timeoutmonitor call getDataSetWatch() only if task has not already failed. (This is just an optimization and it can be done without any locking)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Here i am thinking call for getDataSetWatch() in timeoutmonitor should be sysnchronized because race condition may come in setDone() call and getDataSetWatch() in timeoutmonitor call.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;for this particular getDataSetWatch() call, store a IGNORE-ZK-ERROR flag in the zk async context. If a zk error happens silently then do nothing.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;can u elaborate little more on this point. Normally if any error comes we are retrying this. Now by introducing this IGNORE-ZK-ERROR need to skip the retry, who will set this and when can this flag be true? when task is FAILURE it will be true? (if my understanding is not wrong). &lt;/p&gt;</comment>
                            <comment id="13235536" author="hadoopqa" created="Thu, 22 Mar 2012 12:26:29 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12519319/5606.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12519319/5606.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1255//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1255//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1255//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1255//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1255//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1255//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13237647" author="jxiang" created="Sat, 24 Mar 2012 19:59:52 +0000"  >&lt;p&gt;This is similar issue as &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5081&quot; title=&quot;Distributed log splitting deleteNode races against splitLog retry &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5081&quot;&gt;&lt;del&gt;HBASE-5081&lt;/del&gt;&lt;/a&gt;, right?&lt;/p&gt;

&lt;p&gt;Will my original fix proposed for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5081&quot; title=&quot;Distributed log splitting deleteNode races against splitLog retry &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5081&quot;&gt;&lt;del&gt;HBASE-5081&lt;/del&gt;&lt;/a&gt; help: don&apos;t retry distributed log splitting before tasks are actually deleted?&lt;br/&gt;
We can abort the master after several retry to delete the tasks.&lt;/p&gt;</comment>
                            <comment id="13238786" author="khemani" created="Mon, 26 Mar 2012 20:30:11 +0000"  >&lt;p&gt;Do not do any error processing if the getDataSetWatch() call from SplitLogManager timeoutMonitor fails&lt;/p&gt;</comment>
                            <comment id="13238794" author="khemani" created="Mon, 26 Mar 2012 20:35:50 +0000"  >&lt;p&gt;@Jimmy This is similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5081&quot; title=&quot;Distributed log splitting deleteNode races against splitLog retry &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5081&quot;&gt;&lt;del&gt;HBASE-5081&lt;/del&gt;&lt;/a&gt; w.r.t what goes wrong - a pending delete creates havoc on the next create. But it is different from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5081&quot; title=&quot;Distributed log splitting deleteNode races against splitLog retry &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5081&quot;&gt;&lt;del&gt;HBASE-5081&lt;/del&gt;&lt;/a&gt; because the pending Delete is created at a different point in the code - in the timeoutMonitor and not when the task actually fails ...&lt;/p&gt;</comment>
                            <comment id="13238811" author="jxiang" created="Mon, 26 Mar 2012 20:55:23 +0000"  >&lt;p&gt;@Prakash,  could there be other places which failed delete can cause this issue?&lt;/p&gt;

&lt;p&gt;Is it a cleaner fix to change async delete to sync delete?  With sync delete, we can&lt;br/&gt;
avoid all these havoc racing problems, and the retry will get a fresh start each time.&lt;/p&gt;</comment>
                            <comment id="13238861" author="hadoopqa" created="Mon, 26 Mar 2012 21:27:08 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12520003/0001-HBASE-5606-SplitLogManger-async-delete-node-hangs-lo.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12520003/0001-HBASE-5606-SplitLogManger-async-delete-node-hangs-lo.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.io.hfile.TestForceCacheImportantBlocks&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestSplitLogManager&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1310//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1310//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1310//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1310//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1310//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1310//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13238920" author="yuzhihong@gmail.com" created="Mon, 26 Mar 2012 22:33:31 +0000"  >&lt;p&gt;Re-attaching Prakash&apos;s patch.&lt;/p&gt;</comment>
                            <comment id="13239043" author="hadoopqa" created="Tue, 27 Mar 2012 00:13:08 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12520026/0001-HBASE-5606-SplitLogManger-async-delete-node-hangs-lo.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12520026/0001-HBASE-5606-SplitLogManger-async-delete-node-hangs-lo.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1314//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1314//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1314//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1314//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1314//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1314//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13245407" author="stack" created="Tue, 3 Apr 2012 15:36:17 +0000"  >&lt;p&gt;ping on this patch.   What we thinking here?  Patch seems clean enough.  Jimmy, you think there might be other places where we need to do similar?  Prakash, what you think of Jimmy&apos;s suggestion of sync&apos;ing the delete (I think I know what you are going to say!).&lt;/p&gt;</comment>
                            <comment id="13245423" author="chinnalalam" created="Tue, 3 Apr 2012 15:47:20 +0000"  >&lt;p&gt;For me also patch looks clean.&lt;/p&gt;</comment>
                            <comment id="13245763" author="jxiang" created="Tue, 3 Apr 2012 21:18:35 +0000"  >&lt;p&gt;It is ok with me. Hopefully, there is no other place.&lt;/p&gt;</comment>
                            <comment id="13245767" author="zhihyu@ebaysf.com" created="Tue, 3 Apr 2012 21:28:55 +0000"  >&lt;p&gt;Will integrate later today if there is no objection.&lt;/p&gt;</comment>
                            <comment id="13245797" author="khemani" created="Tue, 3 Apr 2012 21:58:23 +0000"  >
&lt;p&gt;Making the deletes synchronous doesn&apos;t  theoretically remove the race condition. A master could send the delete to the zk-server it is connected to and die. The next master can (theoretically) still run into the pending delete race.&lt;/p&gt;


</comment>
                            <comment id="13245804" author="zhihyu@ebaysf.com" created="Tue, 3 Apr 2012 22:05:35 +0000"  >&lt;p&gt;Integrated to 0.92, 0.94 and trunk.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Prakash.&lt;/p&gt;

&lt;p&gt;Thanks for the review Stack, Jimmy and Chinna.&lt;/p&gt;</comment>
                            <comment id="13245873" author="hudson" created="Tue, 3 Apr 2012 23:13:09 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2707 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2707/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2707/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5606&quot; title=&quot;SplitLogManger async delete node hangs log splitting when ZK connection is lost &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5606&quot;&gt;&lt;del&gt;HBASE-5606&lt;/del&gt;&lt;/a&gt;  SplitLogManger async delete node hangs log splitting when ZK connection is lost  &lt;br/&gt;
               (Prakash) (Revision 1309173)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13245876" author="hudson" created="Tue, 3 Apr 2012 23:19:54 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #84 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/84/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/84/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5606&quot; title=&quot;SplitLogManger async delete node hangs log splitting when ZK connection is lost &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5606&quot;&gt;&lt;del&gt;HBASE-5606&lt;/del&gt;&lt;/a&gt;  SplitLogManger async delete node hangs log splitting when ZK connection is lost  &lt;br/&gt;
               (Prakash) (Revision 1309172)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13245936" author="hudson" created="Wed, 4 Apr 2012 00:50:49 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #352 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/352/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/352/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5606&quot; title=&quot;SplitLogManger async delete node hangs log splitting when ZK connection is lost &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5606&quot;&gt;&lt;del&gt;HBASE-5606&lt;/del&gt;&lt;/a&gt;  SplitLogManger async delete node hangs log splitting when ZK connection is lost  &lt;br/&gt;
               (Prakash) (Revision 1309171)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13246906" author="hudson" created="Thu, 5 Apr 2012 00:53:33 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #7 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/7/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/7/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5606&quot; title=&quot;SplitLogManger async delete node hangs log splitting when ZK connection is lost &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5606&quot;&gt;&lt;del&gt;HBASE-5606&lt;/del&gt;&lt;/a&gt;  SplitLogManger async delete node hangs log splitting when ZK connection is lost  &lt;br/&gt;
               (Prakash) (Revision 1309172)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13246957" author="hudson" created="Thu, 5 Apr 2012 02:52:05 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #104 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/104/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/104/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5606&quot; title=&quot;SplitLogManger async delete node hangs log splitting when ZK connection is lost &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5606&quot;&gt;&lt;del&gt;HBASE-5606&lt;/del&gt;&lt;/a&gt;  SplitLogManger async delete node hangs log splitting when ZK connection is lost  &lt;br/&gt;
               (Prakash) (Revision 1309171)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13247031" author="hudson" created="Thu, 5 Apr 2012 05:06:43 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #157 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/157/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/157/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5606&quot; title=&quot;SplitLogManger async delete node hangs log splitting when ZK connection is lost &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5606&quot;&gt;&lt;del&gt;HBASE-5606&lt;/del&gt;&lt;/a&gt;  SplitLogManger async delete node hangs log splitting when ZK connection is lost  &lt;br/&gt;
               (Prakash) (Revision 1309173)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12520026" name="0001-HBASE-5606-SplitLogManger-async-delete-node-hangs-lo.patch" size="2804" author="yuzhihong@gmail.com" created="Mon, 26 Mar 2012 22:33:31 +0000"/>
                            <attachment id="12520003" name="0001-HBASE-5606-SplitLogManger-async-delete-node-hangs-lo.patch" size="2804" author="khemani" created="Mon, 26 Mar 2012 20:30:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 21 Mar 2012 04:45:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>232488</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 37 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i016cv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4799</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>