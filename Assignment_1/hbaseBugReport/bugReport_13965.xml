<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:48:23 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13965/HBASE-13965.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13965] Stochastic Load Balancer JMX Metrics</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13965</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Today&#8217;s default HBase load balancer (the Stochastic load balancer) is cost function based. The cost function weights are tunable but no visibility into those cost function results is directly provided.&lt;/p&gt;

&lt;p&gt;A driving example is a cluster we have been tuning which has skewed rack size (one rack has half the nodes of the other few racks). We are tuning the cluster for uniform response time from all region servers with the ability to tolerate a rack failure. Balancing LocalityCost, RegionReplicaRack Cost and RegionCountSkew Cost is difficult without a way to attribute each cost function&#8217;s contribution to overall cost. &lt;br/&gt;
What this jira proposes is to provide visibility via JMX into each cost function of the stochastic load balancer, as well as the overall cost of the balancing plan.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12840346">HBASE-13965</key>
            <summary>Stochastic Load Balancer JMX Metrics</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="leochen4891">Lei Chen</assignee>
                                    <reporter username="leochen4891">Lei Chen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Jun 2015 21:39:45 +0000</created>
                <updated>Fri, 28 Aug 2015 19:21:03 +0000</updated>
                            <resolved>Thu, 6 Aug 2015 09:52:28 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>Balancer</component>
                    <component>metrics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="14600285" author="yuzhihong@gmail.com" created="Wed, 24 Jun 2015 22:35:58 +0000"  >&lt;p&gt;This is very useful feature.&lt;/p&gt;</comment>
                            <comment id="14603804" author="apurtell" created="Fri, 26 Jun 2015 23:58:07 +0000"  >&lt;p&gt;Are you planning on providing a patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=leochen4891&quot; class=&quot;user-hover&quot; rel=&quot;leochen4891&quot;&gt;Lei Chen&lt;/a&gt;? &lt;/p&gt;</comment>
                            <comment id="14606864" author="leochen4891" created="Tue, 30 Jun 2015 02:14:47 +0000"  >&lt;p&gt;Sorry for the delay. I propose the following changes which can be seen illustrated in the attached class diagram.&lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;StochasticLoadBalancer&lt;/tt&gt; extends &lt;tt&gt;BaseLoadBalancer&lt;/tt&gt; which has a class variable of type &lt;tt&gt;MetricsBalancer&lt;/tt&gt;. The &lt;tt&gt;MetricsBalancer&lt;/tt&gt; contains a private class variable of type &lt;tt&gt;MetricsBalancerSource&lt;/tt&gt;. The &lt;tt&gt;MetricsBalancerSource&lt;/tt&gt; is an interface which defines which metrics can be reported to JMX. This proves to make extension difficult for load balancer implementation specific metrics (e.g. the &lt;tt&gt;StochasticLoadBalancer&lt;/tt&gt;).&lt;/p&gt;

&lt;p&gt;Adding metrics to the generic interface is not appropriate being it is used by all load balancers and should not contain any load balancer specific metrics. I propose to create a class extending &lt;tt&gt;MetricsBalancer&lt;/tt&gt; to provide specific load balancer metrics. To use this class, I propose to add a constructor to &lt;tt&gt;BaseLoadBalancer&lt;/tt&gt; which allows for the balancer instance metrics class to be passed in. (Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; for code review and giving the constructor suggestion!)&lt;/p&gt;

&lt;p&gt;In the constructor of &lt;tt&gt;StochasticLoadBalancer&lt;/tt&gt;, an instance of &lt;tt&gt;MetricsStochasticBalancer&lt;/tt&gt; is created and passed to a new constructor added to &lt;tt&gt;BaseLoadBalancer&lt;/tt&gt;, which will use it to replace the default &lt;tt&gt;MetricsBalancer&lt;/tt&gt;. The function used to add metrics is declared as following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void updateStochasticCost(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tableName, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; costFunctionName, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; costFunctionDesc, &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; value);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In &lt;tt&gt;MetricsBalancer&lt;/tt&gt;, the &lt;tt&gt;private final&lt;/tt&gt; class variable &lt;tt&gt;source&lt;/tt&gt; was previously hardcoded and instantiated in its constructor; I propose a new function &lt;tt&gt;initSource&lt;/tt&gt; which can be overridden to set this variable. As such, in the subclass &lt;tt&gt;MetricsStochasticBalancer&lt;/tt&gt;, &lt;tt&gt;initSource&lt;/tt&gt; will create a &lt;tt&gt;MetricsStochasticBalancerSource&lt;/tt&gt; instance instead of the default &lt;tt&gt;MetricsBalancerSource&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Finally, to give good insight to the internal status of &lt;tt&gt;StochasticLoadBalancer&lt;/tt&gt;, we are considering adding metrics for each cost function, as well as the overall cost. For example, if the balancing is carried out for table &quot;MyTable1&quot; and the &lt;tt&gt;StochasticLoadBalancer&lt;/tt&gt; has 3 cost functions &quot;MoveCost&quot;, &quot;LocalityCost&quot;, and &quot;RegionReplicaHostCost&quot;, then 4 metrics will be added to &#8220;HBase -&amp;gt; Master -&amp;gt; Balancer&#8221; as following:&lt;br/&gt;
    MyTable1_Overall&lt;br/&gt;
    MyTable1_MoveCost&lt;br/&gt;
    MyTable1_LocalityCost&lt;br/&gt;
    MyTable1_RegionReplicaHostCost&lt;/p&gt;

&lt;p&gt;I&apos;m building the patch, any suggestion is appreciated.&lt;/p&gt;</comment>
                            <comment id="14606868" author="leochen4891" created="Tue, 30 Jun 2015 02:17:06 +0000"  >&lt;p&gt;Before and after the patch. Other balancers will works the same way as before.&lt;/p&gt;</comment>
                            <comment id="14609007" author="stack" created="Tue, 30 Jun 2015 20:29:00 +0000"  >&lt;p&gt;Thank you for the design and patch overview. Helps.&lt;/p&gt;

&lt;p&gt;The changes in your patch to hbase-env.sh are probably not intended. Ditto hbase-site.xml... and others.&lt;/p&gt;

&lt;p&gt;Add license to new classes (see adjacent classes for how), javadoc on Interfaces especially (no need of public qualifiers when an Interface), and see annotations in accompanying classes and apply as appropriate here (mark them private I&apos;d say).&lt;/p&gt;

&lt;p&gt;I wouldn&apos;t even bother offering DEFAULT vs STOCHASTIC. No one runs any balancer but stochastic (Besides default is the Stochastic).  Remove the choice.&lt;/p&gt;

&lt;p&gt;Otherwise, patch looking good. Suggest you past example of what it looks like when it is working.&lt;/p&gt;

&lt;p&gt;FYI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="14609072" author="clayb" created="Tue, 30 Jun 2015 21:07:15 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; as to the DEFAULT versus STOCHASTIC, you&apos;re in favor of collapsing the metrics provider to be stochastic-centric opposed to pluggable? If so, I&apos;m a bit concerned as &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6721&quot; title=&quot;RegionServer Group based Assignment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6721&quot;&gt;&lt;del&gt;HBASE-6721&lt;/del&gt;&lt;/a&gt; proposes a new balancer who&apos;s functionality we appreciate and which would likely need some visibility too.&lt;/p&gt;</comment>
                            <comment id="14609187" author="stack" created="Tue, 30 Jun 2015 22:33:19 +0000"  >&lt;blockquote&gt;&lt;p&gt;...you&apos;re in favor of collapsing the metrics provider to be stochastic-centric opposed to pluggable?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes sir. It is what is run by all. We should purge all others (FavoredNodes, GroupBased...) and redo these unused (or rarely used) exotica instead as attributes on the stochastic balancer, the balancer we near-all run (and trust).&lt;/p&gt;

&lt;p&gt;Feel free to ignore the above opinion. Just change patch so DEFAULT is STOCHASTIC. Then. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=clayb&quot; class=&quot;user-hover&quot; rel=&quot;clayb&quot;&gt;Clay B.&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14609390" author="enis" created="Wed, 1 Jul 2015 01:07:27 +0000"  >&lt;p&gt;Thanks Lei for the patch. Looks good overall. A couple of feedback items: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Can you create the patch so that it is a one commit. Current stacked patch is not reviewable. See &lt;a href=&quot;https://hbase.apache.org/book.html#submitting.patches&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hbase.apache.org/book.html#submitting.patches&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;As per Stack, please only include changes needed for the patch. &lt;tt&gt;conf/&lt;/tt&gt; and some others are not needed.&lt;/li&gt;
	&lt;li&gt;We usually use: &lt;tt&gt;(name != null)&lt;/tt&gt;  rather than &lt;tt&gt;(null != name)&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;This map is ever growing:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;&amp;gt; stochasticCosts =
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In a dynamic cluster where tables are short lived, it can cause OOM. Not sure whether there is an easy way to phase out stuff from that map. &lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="14609392" author="enis" created="Wed, 1 Jul 2015 01:09:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;Feel free to ignore the above opinion. Just change patch so DEFAULT is STOCHASTIC. Then&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think that part is gone already, instead the StochasticLB instantiates the object and send it via constructor to the super class. The attached patch is a set of stacked patches. &lt;/p&gt;</comment>
                            <comment id="14609412" author="leochen4891" created="Wed, 1 Jul 2015 01:30:59 +0000"  >&lt;p&gt;Thanks for the feedback. I appreciate your detailed review and help. I will modify the patch.  &lt;/p&gt;</comment>
                            <comment id="14610601" author="leochen4891" created="Wed, 1 Jul 2015 16:31:26 +0000"  >&lt;p&gt;I agree that the unused balancers should be purged or made into attributes of the stochastic load balancer. I think it may be better to do it in another Jira, since &#8220;One thing at a time&#8221;.&lt;/p&gt;

&lt;p&gt;About the ever growing map, I&#8217;m thinking of two ways to solve this problem. &lt;br/&gt;
1.	Besides updateStochasticCost, add another method (or add a boolean parameter) which should be called when the table is deleted. This will allow the map to contain only existing tables&lt;br/&gt;
2.	Use a fixed-size most recent used (MRU) cache to store the map. The size can be configurable. &lt;/p&gt;

&lt;p&gt;Any suggestion?&lt;/p&gt;</comment>
                            <comment id="14610833" author="leochen4891" created="Wed, 1 Jul 2015 19:06:46 +0000"  >&lt;p&gt;Changes:&lt;br/&gt;
1. License added for new classes.&lt;br/&gt;
2. Javadoc updated.&lt;br/&gt;
3. Several commits squashed into one.&lt;br/&gt;
4. Use &quot; != null&quot;, not &quot;null != &quot;&lt;/p&gt;

&lt;p&gt;TODO:&lt;br/&gt;
1. The ever growing map in MetricsStochasticBalancerSourceImpl.java&lt;/p&gt;</comment>
                            <comment id="14614448" author="hadoopqa" created="Sun, 5 Jul 2015 23:51:56 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12743132/HBASE-13965_v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12743132/HBASE-13965_v2.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 1f9bf419c1c9040504de1b36fb85d0be7163eadf.&lt;br/&gt;
  ATTACHMENT ID: 12743132&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1903 checkstyle errors (more than the master&apos;s current 1898 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14670//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14670//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14670//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14670//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14670//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14670//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14670//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14670//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14615221" author="leochen4891" created="Mon, 6 Jul 2015 15:55:38 +0000"  >&lt;p&gt;Update:&lt;br/&gt;
1. The max size of the ever growing map is limited to 1000 (hard-coded) using a Most-Recent-Used (MRU) cache. &lt;br/&gt;
2. Checkstyle warnings fixed.&lt;/p&gt;

&lt;p&gt;TODO:&lt;br/&gt;
1. Make the hard-coded map size configurable?&lt;/p&gt;
</comment>
                            <comment id="14615265" author="yuzhihong@gmail.com" created="Mon, 6 Jul 2015 16:20:06 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
32	  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void updateStochasticCost(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tableName, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; costFunctionName,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should tableName parameter be of type TableName ?&lt;/p&gt;

&lt;p&gt;For MetricsStochasticBalancerSourceImpl.java , it should be annotated with @InterfaceAudience.Private&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
56	   * The function that report stochastic load balancer costs to JMX
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;that report&apos; -&amp;gt; &apos;that reports&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
58	  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void updateStochasticCost(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tableName, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; costFunctionName,
59	      &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; costFunctionDesc, &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; value) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;costFunctionDesc isn&apos;t used in the method.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
82	          &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; attrName = tableName + ((tableName.length() &amp;lt;= 0) ? &quot;&quot; : TABLE_FUNCTION_SEP) + key;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When would tableName.length() be &amp;lt;= 0 ? There is check at the beginning of updateStochasticCost().&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
124	  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;[] lastSubcosts;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;nit: Uppercase &apos;c&apos; of &apos;costs&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
470	      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.lastSubcosts[i] = multiplier*cost;
471	      total += multiplier * cost;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;There is no need to perform the same multiplication twice.&lt;/p&gt;</comment>
                            <comment id="14615467" author="hadoopqa" created="Mon, 6 Jul 2015 18:52:23 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12743741/HBASE-13965-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12743741/HBASE-13965-v3.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit cff1a5f1f5cc8f5e1e99c6aecb39e2e69f86bf7e.&lt;br/&gt;
  ATTACHMENT ID: 12743741&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14678//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14678//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14678//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14678//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14678//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14678//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14678//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14678//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14615518" author="leochen4891" created="Mon, 6 Jul 2015 19:32:55 +0000"  >&lt;p&gt;Thanks for your review and great feedback. I will update an updated patch.&lt;/p&gt;</comment>
                            <comment id="14615519" author="leochen4891" created="Mon, 6 Jul 2015 19:36:37 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. &quot;report&quot; -&amp;gt; &quot;reports&quot;&lt;br/&gt;
2. costFunctionDesc added to JMX&lt;br/&gt;
3. Unnecessary table name length check is removed. &lt;br/&gt;
4. &quot;lastSubcosts&quot; -&amp;gt; &quot;lastSubCosts&quot;&lt;br/&gt;
5. total += this.lastSubCosts&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;;&lt;/p&gt;

&lt;p&gt;TODO:&lt;br/&gt;
1. Make hard-coded map size configurable?&lt;/p&gt;</comment>
                            <comment id="14615800" author="hadoopqa" created="Mon, 6 Jul 2015 22:48:03 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12743774/HBASE-13965-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12743774/HBASE-13965-v4.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 608c3aa15c34b9014f99e857b374645db58cbbe3.&lt;br/&gt;
  ATTACHMENT ID: 12743774&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14680//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14680//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14680//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14680//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14680//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14680//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14680//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14680//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14615805" author="yuzhihong@gmail.com" created="Mon, 6 Jul 2015 22:48:48 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
79	    costs.put(costFunctionName, descAndValue);
80	    stochasticCosts.put(tableName, costs);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;For any specific cost function, its description should be fixed.&lt;br/&gt;
In the above model, description for the same cost function is stored once per table.&lt;br/&gt;
Can we reduce the number of times description for same function is stored ?&lt;/p&gt;</comment>
                            <comment id="14615909" author="leochen4891" created="Mon, 6 Jul 2015 23:45:33 +0000"  >&lt;p&gt;Good point. It can be more memory efficient if description is stored only once for each cost function. Patch will be updated.&lt;/p&gt;</comment>
                            <comment id="14615934" author="leochen4891" created="Tue, 7 Jul 2015 00:10:08 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. One copy of description is saved for each cost function, in a separate map&lt;/p&gt;

&lt;p&gt;TODO:&lt;br/&gt;
1. Make hard-coded map size configurable?&lt;/p&gt;</comment>
                            <comment id="14616118" author="hadoopqa" created="Tue, 7 Jul 2015 03:32:24 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12743848/HBASE-13965-v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12743848/HBASE-13965-v5.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit c220635c7893c96db675cb2b80af6ade4a44e3d4.&lt;br/&gt;
  ATTACHMENT ID: 12743848&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): &lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14685//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14685//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14685//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14685//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14685//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14685//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14685//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14685//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14617464" author="yuzhihong@gmail.com" created="Tue, 7 Jul 2015 21:32:19 +0000"  >&lt;p&gt;Loaded patch v5 on a small cluster and obtained the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  }, {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;Hadoop:service=HBase,name=Master,sub=Balancer&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;modelerType&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;Master,sub=Balancer&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;tag.Context&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;master&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;tag.Hostname&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;cn013.l42scl.hortonworks.com&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_StoreFileCostFunction&quot;&lt;/span&gt; : 3.262317387568032,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_LocalityCostFunction&quot;&lt;/span&gt; : 2.473958333333334,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_TableSkewCostFunction&quot;&lt;/span&gt; : 5.605468749999999,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_Overall&quot;&lt;/span&gt; : 35.09174447090137,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_WriteRequestCostFunction&quot;&lt;/span&gt; : 0.0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_RegionCountSkewCostFunction&quot;&lt;/span&gt; : 0.0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_ReadRequestCostFunction&quot;&lt;/span&gt; : 5.0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_MemstoreSizeCostFunction&quot;&lt;/span&gt; : 0.0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_RegionReplicaHostCostFunction&quot;&lt;/span&gt; : 0.0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_RegionReplicaRackCostFunction&quot;&lt;/span&gt; : 0.0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;IntegrationTestBigLinkedList_MoveCostFunction&quot;&lt;/span&gt; : 18.75,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Do you think it makes sense to expose each cost (other than Overall) as percentage ?&lt;br/&gt;
This way, it is easier for user to figure out which cost is the dominant factor.&lt;/p&gt;</comment>
                            <comment id="14617919" author="leochen4891" created="Wed, 8 Jul 2015 03:38:49 +0000"  >&lt;p&gt;I&apos;m having difficulties creating a request on reviewboard. When I&apos;m uploading a patch file generated by &quot;git diff --no-prefix master&quot;, always get &quot;No valid separator after the filename was found in the diff header&quot; error. Working on it.&lt;br/&gt;
Temporarily still uploading patch file. &lt;/p&gt;

&lt;p&gt;Updates: (trivial changes from v5 to v6)&lt;br/&gt;
1. rename some variables with more accurate names&lt;br/&gt;
2. use percent for each cost function&lt;/p&gt;

&lt;p&gt;TODO:&lt;br/&gt;
1. Make hard-coded map size configurable?&lt;/p&gt;</comment>
                            <comment id="14617922" author="leochen4891" created="Wed, 8 Jul 2015 03:41:54 +0000"  >&lt;p&gt;Thanks for testing the patch and posting the result metrics.&lt;br/&gt;
I agree that using percentage is easier for quick look. &lt;br/&gt;
I will update the patch.&lt;/p&gt;</comment>
                            <comment id="14617931" author="hadoopqa" created="Wed, 8 Jul 2015 03:57:36 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12744125/HBASE-13965-v6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12744125/HBASE-13965-v6.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit f5ad736282c8c9c27b14131919d60b72834ec9e4.&lt;br/&gt;
  ATTACHMENT ID: 12744125&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14697//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14697//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14618960" author="yuzhihong@gmail.com" created="Wed, 8 Jul 2015 17:17:19 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tableName != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
+        }
+          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tableName != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;You can return tableName on line of the first break. This way the second return won&apos;t be needed.&lt;/p&gt;

&lt;p&gt;For CostFunctions whose value is 0, can we omit them in the metrics ?&lt;/p&gt;</comment>
                            <comment id="14618991" author="hadoopqa" created="Wed, 8 Jul 2015 17:29:12 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12744232/HBASE-13965-v6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12744232/HBASE-13965-v6.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit f5ad736282c8c9c27b14131919d60b72834ec9e4.&lt;br/&gt;
  ATTACHMENT ID: 12744232&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestJMXListener&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14701//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14701//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14701//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14701//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14701//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14701//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14701//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14701//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14618997" author="leochen4891" created="Wed, 8 Jul 2015 17:31:44 +0000"  >&lt;p&gt;Yes, sounds good, since the full list of cost functions should be known to the user.&lt;/p&gt;</comment>
                            <comment id="14619044" author="stack" created="Wed, 8 Jul 2015 17:51:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;For CostFunctions whose value is 0, can we omit them in the metrics ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So metrics can come and go (not show if zero then show when non-zero)? That will be confusing I&apos;d say.&lt;/p&gt;</comment>
                            <comment id="14619064" author="clayb" created="Wed, 8 Jul 2015 17:59:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt; I agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; as for Graphite there which I load my metrics into, there is a difference between a null (no value) and a zero. Often we run arithmetic functions on our metrics for alarming for example.&lt;/p&gt;</comment>
                            <comment id="14619554" author="leochen4891" created="Wed, 8 Jul 2015 23:13:22 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=clayb&quot; class=&quot;user-hover&quot; rel=&quot;clayb&quot;&gt;Clay B.&lt;/a&gt; for giving suggestion.&lt;br/&gt;
I have found that the stochastic load balancer holds a reference to HMaster, which can be used to get the number of tables, therefore the size of the map can be determined. No need to use configurable value. I will update the patch soon.&lt;/p&gt;</comment>
                            <comment id="14621457" author="leochen4891" created="Thu, 9 Jul 2015 23:40:43 +0000"  >&lt;p&gt;I have found a problem related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5231&quot; title=&quot;Backport HBASE-3373 (per-table load balancing) to 0.92&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5231&quot;&gt;&lt;del&gt;HBASE-5231&lt;/del&gt;&lt;/a&gt;(per-table load balancing).&lt;br/&gt;
It seems that the balancing is done by an iteration of tables. &lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hbase/blob/master/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java#L1219-L1228&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hbase/blob/master/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java#L1219-L1228&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This can be configured to be in per-table mode or ensemble mode. &lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hbase/blob/master/hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java#L956-L962&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hbase/blob/master/hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java#L956-L962&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In ensemble mode, all the tables are copied into an &quot;ensemble&quot; table for balancing. The configuration is set by&lt;br/&gt;
 &lt;tt&gt;hbase.master.loadbalancer.bytable&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;My question is how to name the metrics if the balancing is in ensemble mode.&lt;/p&gt;

&lt;p&gt;For example, suppose we have two tables, &quot;Table1&quot; and &quot;Table2&quot;, and N cost functions.&lt;br/&gt;
In the per-table mode, each table will have an overall cost and one for each cost function.&lt;br/&gt;
    &lt;tt&gt;Table1_Overall&lt;/tt&gt;&lt;br/&gt;
    &lt;tt&gt;Table1_costFunction&lt;/tt&gt; x N&lt;br/&gt;
    &lt;tt&gt;Table2_Overall&lt;/tt&gt;&lt;br/&gt;
    &lt;tt&gt;Table2_costFunction&lt;/tt&gt; x N&lt;br/&gt;
In the ensemble mode, there will be only one overall and one set of function costs.&lt;br/&gt;
    &lt;tt&gt;ensemble_Overall&lt;/tt&gt;&lt;br/&gt;
    &lt;tt&gt;ensemble_costFunction&lt;/tt&gt; x N&lt;/p&gt;

&lt;p&gt;Can we use a special name for the combined table, e.g. &quot;ensemble&quot;? The problem is that the user may have already created a table named &quot;ensemble&quot;, which may cause confusion. &lt;/p&gt;

&lt;p&gt;Any idea on this problem?&lt;/p&gt;</comment>
                            <comment id="14621641" author="leochen4891" created="Fri, 10 Jul 2015 02:59:24 +0000"  >&lt;p&gt;I also found that when &lt;tt&gt;hbase.master.loadbalancer.bytable&lt;/tt&gt; is set to true, balancing will also be performed on table hbase:namespace, which is a system table. Should the costs of hbase:namespace be reported to JMX the same way as user tables? &lt;br/&gt;
Any idea?&lt;/p&gt;</comment>
                            <comment id="14621657" author="yuzhihong@gmail.com" created="Fri, 10 Jul 2015 03:26:39 +0000"  >&lt;p&gt;I assume user(s) would not be interested in the costs for system tables.&lt;/p&gt;</comment>
                            <comment id="14622376" author="yuzhihong@gmail.com" created="Fri, 10 Jul 2015 14:26:43 +0000"  >&lt;p&gt;w.r.t.  ensemble mode, one option is to leave table name blank.&lt;br/&gt;
We then have:&lt;br/&gt;
_Overall&lt;br/&gt;
_costFunction X N&lt;/p&gt;</comment>
                            <comment id="14622624" author="stack" created="Fri, 10 Jul 2015 17:30:38 +0000"  >&lt;p&gt;If a table is being balanced by the balancer, I would think an operator would want to know metrics on why.&lt;/p&gt;

&lt;p&gt;A blank table name given table is not a dimension when in ensemble mode would be reasonable &amp;#8211; I&apos;d remove the &apos;_&apos; prefix though... in fact, so we don&apos;t surprise operators, what about flipping the metric name so it is Overall_Table1 rather than Table1_Overall. If we start with Overall, operator will know where to look for this metric in the list... if table prefix, could be anywhere in the list?&lt;/p&gt;
</comment>
                            <comment id="14622705" author="leochen4891" created="Fri, 10 Jul 2015 18:20:34 +0000"  >&lt;p&gt;Ted, Clay, and stack, thanks for offering suggestions. &lt;/p&gt;

&lt;p&gt;Currently, in the ensemble mode, the combined table is named &quot;ensemble&quot;, I somehow feel that it might be a good idea to use the name directly. For example, &quot;ensemble_Overall&quot; or &quot;ensemble_costFunction1&quot;. &lt;/p&gt;

&lt;p&gt;In a similar way, when in the per-table mode, the system table hbase:namespace can be reported to JMX using it&apos;s name directly as well. The benefit is that we can avoid any special case handling in the balancer. The balancer just calculate and report whatever tables given by hmaster. &lt;/p&gt;

&lt;p&gt;I&apos;m updating the unit test to cover both modes. &lt;/p&gt;</comment>
                            <comment id="14622773" author="stack" created="Fri, 10 Jul 2015 19:09:03 +0000"  >&lt;p&gt;Is ensemble a system table? Is it a logical table only? Prefix with system namespace?&lt;/p&gt;</comment>
                            <comment id="14622782" author="leochen4891" created="Fri, 10 Jul 2015 19:13:10 +0000"  >&lt;p&gt;I think the ensemble table is more like a temporary table, and it is not in any namespace.&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/hbase/blob/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java#L792&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hbase/blob/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java#L792&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14622858" author="leochen4891" created="Fri, 10 Jul 2015 20:27:38 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. Overloaded balanceCluster() to pass the table name to balancer&lt;br/&gt;
2. Moved some string constants to HConstants.java&lt;br/&gt;
3. Stochastic balancer auto adjust JMX metrics size by the number of tables&lt;br/&gt;
4. Stochastic handles both ensemble and per-table modes.&lt;br/&gt;
5. Updated tests to cover both modes.&lt;/p&gt;

&lt;p&gt;TODO:&lt;br/&gt;
1. The tests currently only use the miniCluster to save and read JMX metrics, which means that the tables are not actually stored in hbase. I&apos;m NOT sure if this method is adequate or we need to save real tables to miniCluster and balance them for real?&lt;/p&gt;

&lt;p&gt;Sorry guys, I still cannot upload the patch file to review board. The diff file always gets &quot;No valid separator after the filename was found in the diff header&quot; error. If I manually touch up the file by adding (revision xxxx) or (working copy), I got &quot;revision xxxx cannot be found&quot; error. The command line rbt has the same problem.&lt;/p&gt;</comment>
                            <comment id="14622894" author="stack" created="Fri, 10 Jul 2015 21:09:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think the ensemble table is more like a temporary table, and it is not in any namespace.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It is not a table at all &amp;#8211; smile. It is a key in a map usually keyed by tablename... it can be anything it looks like. So, put it in system namespace and then it won&apos;t clash with anyone or put it in an impossible namespace, &apos;ephemeral&apos;. See here for what is legal: &lt;a href=&quot;http://grepcode.com/file/repo1.maven.org/maven2/org.apache.hbase/hbase-common/1.0.0/org/apache/hadoop/hbase/TableName.java#70&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://grepcode.com/file/repo1.maven.org/maven2/org.apache.hbase/hbase-common/1.0.0/org/apache/hadoop/hbase/TableName.java#70&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14622900" author="leochen4891" created="Fri, 10 Jul 2015 21:18:21 +0000"  >&lt;p&gt;Thanks for clarifying. &lt;br/&gt;
I will use &quot;hbase:ensemble&quot; for this cute table-like thing - smile.&lt;/p&gt;</comment>
                            <comment id="14623151" author="hadoopqa" created="Sat, 11 Jul 2015 00:51:22 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12744790/HBASE-13965-v7.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12744790/HBASE-13965-v7.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit c16bbf47cbb1017b92960e15edfaa81cfd104b1d.&lt;br/&gt;
  ATTACHMENT ID: 12744790&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +      if (!server.getConfiguration().getBoolean(HConstants.HBASE_MASTER_LOADBALANCE_BYTABLE, false)) {&lt;br/&gt;
+      ((MetricsStochasticBalancer) metricsBalancer).updateStochasticCost(tableName.getNameAsString(), &quot;Overall&quot;,&lt;br/&gt;
+        ((MetricsStochasticBalancer) metricsBalancer).updateStochasticCost(tableName.getNameAsString(),&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14745//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14745//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14745//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14745//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14745//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14745//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14745//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14745//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14623634" author="yuzhihong@gmail.com" created="Sun, 12 Jul 2015 00:09:59 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  /** Config &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; balancing the cluster by each table */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;by each table&apos; -&amp;gt; &apos;by table&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  /** The name of the combined table when bytable is off*/
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;combined table&apos; -&amp;gt; &apos;combined tables&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-comment&quot;&gt;// Use Most Recent Used(MRU) cache&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;Most Recent&apos; -&amp;gt; &apos;Most Recently&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (stochasticCosts) {
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (stochasticCosts != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Looks like the null check is not needed.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void updateStochasticCosts(TableName tableName, &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; overall, &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;[] subCosts) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should we do early return if the table is system table ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          &lt;span class=&quot;code-comment&quot;&gt;//TODO: should hbase:mespace be passed in by HMaster?&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can the above TODO be dropped ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      ((MetricsStochasticBalancer) metricsBalancer).updateStochasticCost(tableName.getNameAsString(), &lt;span class=&quot;code-quote&quot;&gt;&quot;Overall&quot;&lt;/span&gt;,
+        &lt;span class=&quot;code-quote&quot;&gt;&quot;Overall cost&quot;&lt;/span&gt;, overall);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Since metricsBalancer would be cast in the loop that follows, you can use local variable of type MetricsStochasticBalancer to save the casts in the loop.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; == tableName)
+      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;nit: move return on the same line as if statement to save a pair of curly braces.&lt;/p&gt;</comment>
                            <comment id="14623933" author="leochen4891" created="Sun, 12 Jul 2015 18:24:53 +0000"  >&lt;p&gt;Thanks for the feedback.&lt;/p&gt;

{Should we do early return if the table is system table ?}
&lt;p&gt;Should filtering tables happen before/outside updateStochasticCosts? (e.g in HMaster?) &lt;br/&gt;
Since HMaster sends hbase:namespace for balancing, there might be a reason for that, and I feel it may help to include its costs in JMX, just in case.&lt;/p&gt;</comment>
                            <comment id="14623975" author="yuzhihong@gmail.com" created="Sun, 12 Jul 2015 19:51:56 +0000"  >&lt;p&gt;Including costs for system table in JMX metrics is fine.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!t.getTableName().isSystemTable()) {
+              tablesCount++;
+            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In that case the above can be removed.&lt;/p&gt;</comment>
                            <comment id="14624048" author="leochen4891" created="Sun, 12 Jul 2015 22:26:38 +0000"  >&lt;p&gt;Thanks for pointing it out.&lt;/p&gt;

&lt;p&gt;I had some test and found that there are two system tables, hbase:meta and hbase:namespace.&lt;br/&gt;
The first one, hbase:meta, will not be given to balancer while hbase:namespace will.&lt;/p&gt;

&lt;p&gt;Maybe I can just get the number of all tables, and -1 for removing hbase:meta? That will avoid the looping.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;tablesCount = services.getTableDescriptors().getAll().size();
&lt;span class=&quot;code-comment&quot;&gt;// -1 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; removing a system table, hbase:meta, which will not be balanced.
&lt;/span&gt;tablesCount--;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, this is based on an assumption that only one non-balancing system table exists. Is there any better solution?&lt;/p&gt;</comment>
                            <comment id="14624235" author="eclark" created="Mon, 13 Jul 2015 05:50:00 +0000"  >&lt;p&gt;Lets just fully remove the per table balancing. I&apos;ve wanted to do that for a while.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;However, this is based on an assumption that only one non-balancing system table exists.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If we move the security tables currently, then we should stop.&lt;/p&gt;</comment>
                            <comment id="14624668" author="leochen4891" created="Mon, 13 Jul 2015 13:55:15 +0000"  >&lt;p&gt;Do you mean removing all the code for the per-table balancing, as well as documents if any?&lt;br/&gt;
If the balancing is always performed on the ensemble table, then no table name is needed for the metrics name in JMX, right?&lt;/p&gt;</comment>
                            <comment id="14627009" author="leochen4891" created="Tue, 14 Jul 2015 20:39:35 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. Use the number of all tables (including system tables) to calculate the size of the MRU map. This should be fine since we are trying to avoid OOM, not necessarily calculate the exact number of metrics needed.&lt;br/&gt;
2. formatting and spelling improvements&lt;/p&gt;

&lt;p&gt;TODO:&lt;br/&gt;
1. The unit test uses 61120 as the JMX registry port. I noticed that in one of the recent QA test results, it reports a &quot;Port already in use&quot; error. Should I change the port?&lt;br/&gt;
2. The last two patches failed the core tests. However I&apos;m not sure that the failed test, TestWALProcedureStoreOnHDFS.testWalRollOnLowReplication, is related to this patch.&lt;br/&gt;
3. About removing the per-table mode entirely, I&apos;m not sure it should be included in this JIRA.&lt;/p&gt;</comment>
                            <comment id="14627012" author="yuzhihong@gmail.com" created="Tue, 14 Jul 2015 20:43:11 +0000"  >&lt;p&gt;w.r.t. test failure of TestWALProcedureStoreOnHDFS: it is not related to your patch.&lt;/p&gt;

&lt;p&gt;For #3, it should be done in separate JIRA.&lt;/p&gt;</comment>
                            <comment id="14627088" author="eclark" created="Tue, 14 Jul 2015 21:38:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do you mean removing all the code for the per-table balancing, as well as documents if any?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yep, that greatly simplifies lots of things, and cleans up some code that was put in as a stop gap measure.&lt;/p&gt;</comment>
                            <comment id="14627240" author="hadoopqa" created="Tue, 14 Jul 2015 23:00:37 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12745330/HBASE-13965-v8.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12745330/HBASE-13965-v8.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 2f327c911056d02813f642503db9a4383e8b4a2f.&lt;br/&gt;
  ATTACHMENT ID: 12745330&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): &lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14636112" author="enis" created="Wed, 22 Jul 2015 01:39:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;Lets just fully remove the per table balancing. I&apos;ve wanted to do that for a while.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sounds good. Lets do a follow jira after this. &lt;/p&gt;</comment>
                            <comment id="14639877" author="leochen4891" created="Fri, 24 Jul 2015 03:55:12 +0000"  >&lt;p&gt;I&apos;ve been trying to apply the patch on a test hbase cluster for verifying.&lt;br/&gt;
Currently experiencing some compatibility issues. &lt;br/&gt;
Will update status once got results.&lt;/p&gt;</comment>
                            <comment id="14641992" author="yuzhihong@gmail.com" created="Sun, 26 Jul 2015 15:23:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14771//testReport&lt;/a&gt; is no longer accessible.&lt;/p&gt;

&lt;p&gt;Mind attaching patch again ?&lt;/p&gt;</comment>
                            <comment id="14642069" author="leochen4891" created="Sun, 26 Jul 2015 19:29:40 +0000"  >&lt;p&gt;I will attach a summary and a patch soon. Thanks for reminding.&lt;/p&gt;

</comment>
                            <comment id="14642777" author="leochen4891" created="Mon, 27 Jul 2015 14:25:50 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. added a null pointer check in getMetrics( )&lt;/p&gt;</comment>
                            <comment id="14643084" author="hadoopqa" created="Mon, 27 Jul 2015 17:31:54 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12747339/HBASE-13965-v9.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12747339/HBASE-13965-v9.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 3f80e0ea4f101298d9dbd574ffcf388afb621d55.&lt;br/&gt;
  ATTACHMENT ID: 12747339&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14897//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14897//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14897//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14897//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14897//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14897//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14897//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14897//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14643092" author="yuzhihong@gmail.com" created="Mon, 27 Jul 2015 17:37:50 +0000"  >&lt;p&gt;StochasticLoadBalancer related tests passed.&lt;/p&gt;

&lt;p&gt;The two failed tests are not related to the patch:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Failed tests: 
  TestDistributedLogSplitting.testLogReplayTwoSequentialRSDown:653 expected:&amp;lt;1000&amp;gt; but was:&amp;lt;961&amp;gt;
  TestReplicationKillSlaveRS.killOneSlaveRS:34-&amp;gt;TestReplicationKillRS.loadTableAndKillRS:89 Waited too much time &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; queueFailover replication. Waited 12639ms.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14643544" author="yuzhihong@gmail.com" created="Mon, 27 Jul 2015 22:41:18 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * This constructor that accepts an instance of MetricsBalancer,
+   * which will be used instead of creating a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; one
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;This constructor&apos; -&amp;gt; &apos;Constructor&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; BaseLoadBalancer(MetricsBalancer metricsBalancer) {
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (metricsBalancer != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
+      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.metricsBalancer = metricsBalancer;
+    &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.metricsBalancer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MetricsBalancer();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Either put the assignment on the same line as if / else, or enclose assignment in curly braces.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
+      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;failed to get the size of all tables, exception = &quot;&lt;/span&gt; + e.getMessage());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above log should be at error level.&lt;/p&gt;
</comment>
                            <comment id="14652015" author="leochen4891" created="Mon, 3 Aug 2015 15:52:59 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. Spelling and formatting&lt;br/&gt;
2. LOG level changed to error when failed to get size of all tables.&lt;/p&gt;</comment>
                            <comment id="14652037" author="yuzhihong@gmail.com" created="Mon, 3 Aug 2015 16:06:15 +0000"  >&lt;p&gt;Planning to commit once QA run passes.&lt;/p&gt;</comment>
                            <comment id="14652252" author="hadoopqa" created="Mon, 3 Aug 2015 18:50:16 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12748476/HBASE-13965-v10.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12748476/HBASE-13965-v10.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 4b6598e394bae67b54d6f741dd262afe03b2c133.&lt;br/&gt;
  ATTACHMENT ID: 12748476&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 1 release audit warnings (more than the master&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): 	at org.apache.sentry.tests.e2e.hive.hiveserver.AbstractHiveServer.createConnection(AbstractHiveServer.java:63)&lt;br/&gt;
	at org.apache.sentry.tests.e2e.hive.Context.createConnection(Context.java:92)&lt;br/&gt;
	at org.apache.sentry.tests.e2e.hive.AbstractTestWithStaticConfiguration.setupAdmin(AbstractTestWithStaticConfiguration.java:472)&lt;br/&gt;
	at org.apache.sentry.tests.e2e.dbprovider.TestDatabaseProvider.testGrantRevokeRoleToGroups(TestDatabaseProvider.java:2037)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//artifact/patchprocess/patchReleaseAuditWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//artifact/patchprocess/patchReleaseAuditWarnings.txt&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14963//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14652270" author="yuzhihong@gmail.com" created="Mon, 3 Aug 2015 18:57:00 +0000"  >&lt;p&gt;@Lei :&lt;br/&gt;
The following file triggered release audit warning:&lt;br/&gt;
hbase-hadoop2-compat/src/main/resources/x/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/p&gt;

&lt;p&gt;Take a look at ./hbase-hadoop2-compat/src/test/resources/META-INF/services/org.apache.hadoop.hbase.HadoopShims to see how license is added.&lt;/p&gt;

&lt;p&gt;I will commit the next patch with the above fix.&lt;/p&gt;</comment>
                            <comment id="14652314" author="leochen4891" created="Mon, 3 Aug 2015 19:19:37 +0000"  >&lt;p&gt;thanks, I will update soon&lt;/p&gt;</comment>
                            <comment id="14652337" author="leochen4891" created="Mon, 3 Aug 2015 19:31:33 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. License added for &lt;tt&gt;hbase-hadoop2-compat/src/main/resources/x/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="14652376" author="yuzhihong@gmail.com" created="Mon, 3 Aug 2015 19:54:55 +0000"  >&lt;p&gt;Thanks for the patch, Lei.&lt;/p&gt;</comment>
                            <comment id="14652650" author="hudson" created="Mon, 3 Aug 2015 22:18:05 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #67 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/67/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/67/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; Stochastic Load Balancer JMX Metrics (Lei Chen) (tedyu: rev c215b900f49685989083df3786bd8441700c248a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSource.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14652654" author="hudson" created="Mon, 3 Aug 2015 22:19:21 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #85 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/85/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/85/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; Stochastic Load Balancer JMX Metrics (Lei Chen) (tedyu: rev c215b900f49685989083df3786bd8441700c248a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSource.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14652658" author="hadoopqa" created="Mon, 3 Aug 2015 22:21:21 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12748522/HBASE-13965-v11.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12748522/HBASE-13965-v11.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 4b6598e394bae67b54d6f741dd262afe03b2c133.&lt;br/&gt;
  ATTACHMENT ID: 12748522&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14964//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14964//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14964//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14964//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14964//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14964//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14964//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14964//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14652685" author="yuzhihong@gmail.com" created="Mon, 3 Aug 2015 22:33:28 +0000"  >&lt;p&gt;Test failure in TestAssignmentManager is reproducible.&lt;br/&gt;
Reverted from branch-1 for now.&lt;/p&gt;</comment>
                            <comment id="14652688" author="hudson" created="Mon, 3 Aug 2015 22:37:09 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6694 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6694/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6694/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; Stochastic Load Balancer JMX Metrics (Lei Chen) (tedyu: rev 20d1fa36e7ffa1c8d274def831223bff9b04fa69)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-hadoop-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSource.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancer.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; Stochastic Load Balancer JMX Metrics (Lei Chen) (tedyu: rev 598cfeb77563a3fea9d0ed467025514662e52ca0)&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/filter/Filter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/filter/FilterWrapper.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14652720" author="yuzhihong@gmail.com" created="Mon, 3 Aug 2015 22:57:24 +0000"  >&lt;p&gt;Addendum deals with the scenario where connector port has been taken on the test machine.&lt;/p&gt;</comment>
                            <comment id="14652765" author="leochen4891" created="Mon, 3 Aug 2015 23:17:42 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14652936" author="hudson" created="Tue, 4 Aug 2015 01:46:36 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #68 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/68/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/68/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; Revert due to test failure in TestAssignmentManager (tedyu: rev 24dbe25e95d0a355b2e07aa94b5921ff4b4865e9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-hadoop-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSource.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14652947" author="hudson" created="Tue, 4 Aug 2015 01:54:56 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3 #86 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/86/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/86/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; Revert due to test failure in TestAssignmentManager (tedyu: rev 24dbe25e95d0a355b2e07aa94b5921ff4b4865e9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSource.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14653005" author="hudson" created="Tue, 4 Aug 2015 03:10:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6695 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6695/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6695/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; Addendum tries different connector ports if BindException is encountered (tedyu: rev 931e77d4507e1650c452cefadda450e0bf3f0528)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14658720" author="leochen4891" created="Wed, 5 Aug 2015 19:19:43 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. Included 13965-addendum which tries 5 different ports for JMX connection&lt;br/&gt;
2. Fix &quot;balancer already exists&quot; error in TestAssignmentManager.&lt;/p&gt;</comment>
                            <comment id="14659136" author="hadoopqa" created="Wed, 5 Aug 2015 22:57:42 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12748903/HBASE-13965-branch-1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12748903/HBASE-13965-branch-1.patch&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit 18c9bb8b54a5bb101f793e555272cbc74b8288cb.&lt;br/&gt;
  ATTACHMENT ID: 12748903&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 12 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +      for (Entry&amp;lt;TableName, Map&amp;lt;ServerName, List&amp;lt;HRegionInfo&amp;gt;&amp;gt;&amp;gt; e : assignmentsByTable.entrySet()) {&lt;br/&gt;
+          JMXConnectorFactory.connect(JMXListener.buildJMXServiceURL(connectorPort, connectorPort));&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14984//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14984//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14984//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14984//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14984//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14984//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14984//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14984//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14659279" author="leochen4891" created="Thu, 6 Aug 2015 00:52:19 +0000"  >&lt;p&gt;Updates:&lt;br/&gt;
1. wrapped a long line (&amp;gt; 100)&lt;/p&gt;

&lt;p&gt;The failed test from last patch seems not related. Here is the log:&lt;/p&gt;

&lt;p&gt;testWalRollOnLowReplication(org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS)  Time elapsed: 3.804 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!&lt;br/&gt;
java.lang.RuntimeException: sync aborted&lt;br/&gt;
	at org.apache.hadoop.hbase.procedure2.store.wal.WALProcedureStore.pushData(WALProcedureStore.java:491)&lt;br/&gt;
	at org.apache.hadoop.hbase.procedure2.store.wal.WALProcedureStore.insert(WALProcedureStore.java:334)&lt;br/&gt;
	at org.apache.hadoop.hbase.master.procedure.TestWALProcedureStoreOnHDFS.testWalRollOnLowReplication(TestWALProcedureStoreOnHDFS.java:189)&lt;br/&gt;
Caused by: org.apache.hadoop.ipc.RemoteException: File /test-logs/state-00000000000000000006.log could only be replicated to 2 nodes instead of minReplication (=3).  There are 3 datanode(s) running and 3 node(s) are excluded in this operation.&lt;br/&gt;
	at org.apache.hadoop.hdfs.server.blockmanagement.BlockManager.chooseTarget(BlockManager.java:1471)&lt;br/&gt;
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:2791)&lt;br/&gt;
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.addBlock(NameNodeRpcServer.java:606)&lt;br/&gt;
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.addBlock(ClientNamenodeProtocolServerSideTranslatorPB.java:455)&lt;br/&gt;
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)&lt;br/&gt;
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:585)&lt;br/&gt;
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:928)&lt;br/&gt;
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2013)&lt;br/&gt;
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2009)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at javax.security.auth.Subject.doAs(Subject.java:415)&lt;br/&gt;
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1614)&lt;br/&gt;
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2007)&lt;/p&gt;

&lt;p&gt;	at org.apache.hadoop.ipc.Client.call(Client.java:1411)&lt;br/&gt;
	at org.apache.hadoop.ipc.Client.call(Client.java:1364)&lt;br/&gt;
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:206)&lt;br/&gt;
	at com.sun.proxy.$Proxy20.addBlock(Unknown Source)&lt;br/&gt;
	at sun.reflect.GeneratedMethodAccessor8.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:606)&lt;br/&gt;
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)&lt;br/&gt;
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)&lt;br/&gt;
	at com.sun.proxy.$Proxy20.addBlock(Unknown Source)&lt;br/&gt;
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.addBlock(ClientNamenodeProtocolTranslatorPB.java:368)&lt;br/&gt;
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.locateFollowingBlock(DFSOutputStream.java:1449)&lt;br/&gt;
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.nextBlockOutputStream(DFSOutputStream.java:1270)&lt;br/&gt;
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:526)&lt;/p&gt;</comment>
                            <comment id="14659463" author="hadoopqa" created="Thu, 6 Aug 2015 04:10:14 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12748968/HBASE-13965-branch-1-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12748968/HBASE-13965-branch-1-v2.patch&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit 18c9bb8b54a5bb101f793e555272cbc74b8288cb.&lt;br/&gt;
  ATTACHMENT ID: 12748968&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 12 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.util.TestProcessBasedCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportExport&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14987//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14987//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14987//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14987//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14987//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14987//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14987//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14987//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14659508" author="hudson" created="Thu, 6 Aug 2015 05:20:44 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3-IT #72 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/72/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/72/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; Stochastic Load Balancer JMX Metrics (Lei Chen) (tedyu: rev 6a2b618d97c13320bb91a5f555827437099e3a26)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSource.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestAssignmentManager.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14659522" author="hudson" created="Thu, 6 Aug 2015 05:37:47 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #90 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/90/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/90/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; Stochastic Load Balancer JMX Metrics (Lei Chen) (tedyu: rev 6a2b618d97c13320bb91a5f555827437099e3a26)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestAssignmentManager.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSource.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14720350" author="hudson" created="Fri, 28 Aug 2015 18:14:33 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #1103 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/1103/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/1103/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14289&quot; title=&quot;Backport HBASE-13965 &amp;#39;Stochastic Load Balancer JMX Metrics&amp;#39; to 0.98&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14289&quot;&gt;&lt;del&gt;HBASE-14289&lt;/del&gt;&lt;/a&gt; Backport &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; &apos;Stochastic Load Balancer JMX Metrics&apos; to 0.98 (tedyu: rev 7a0d36fecfebb1f61811181347f90a9b88a9d09b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-hadoop1-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSource.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop1-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestAssignmentManager.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14720429" author="hudson" created="Fri, 28 Aug 2015 19:21:03 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #1057 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1057/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1057/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14289&quot; title=&quot;Backport HBASE-13965 &amp;#39;Stochastic Load Balancer JMX Metrics&amp;#39; to 0.98&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14289&quot;&gt;&lt;del&gt;HBASE-14289&lt;/del&gt;&lt;/a&gt; Backport &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13965&quot; title=&quot;Stochastic Load Balancer JMX Metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13965&quot;&gt;&lt;del&gt;HBASE-13965&lt;/del&gt;&lt;/a&gt; &apos;Stochastic Load Balancer JMX Metrics&apos; to 0.98 (tedyu: rev 7a0d36fecfebb1f61811181347f90a9b88a9d09b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestAssignmentManager.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestStochasticBalancerJmxMetrics.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/RegionStates.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop1-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSourceImpl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop2-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-hadoop1-compat/src/main/resources/META-INF/services/org.apache.hadoop.hbase.master.balancer.MetricsStochasticBalancerSource&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-hadoop-compat/src/main/java/org/apache/hadoop/hbase/master/balancer/MetricsStochasticBalancerSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12748553" name="13965-addendum.txt" size="1191" author="yuzhihong@gmail.com" created="Mon, 3 Aug 2015 23:00:04 +0000"/>
                            <attachment id="12748968" name="HBASE-13965-branch-1-v2.patch" size="49701" author="leochen4891" created="Thu, 6 Aug 2015 00:52:19 +0000"/>
                            <attachment id="12748903" name="HBASE-13965-branch-1.patch" size="49698" author="leochen4891" created="Wed, 5 Aug 2015 19:19:43 +0000"/>
                            <attachment id="12748476" name="HBASE-13965-v10.patch" size="45150" author="leochen4891" created="Mon, 3 Aug 2015 15:52:59 +0000"/>
                            <attachment id="12748522" name="HBASE-13965-v11.patch" size="45958" author="leochen4891" created="Mon, 3 Aug 2015 19:31:33 +0000"/>
                            <attachment id="12743741" name="HBASE-13965-v3.patch" size="28746" author="leochen4891" created="Mon, 6 Jul 2015 15:55:38 +0000"/>
                            <attachment id="12743774" name="HBASE-13965-v4.patch" size="29427" author="leochen4891" created="Mon, 6 Jul 2015 19:36:37 +0000"/>
                            <attachment id="12743848" name="HBASE-13965-v5.patch" size="29147" author="leochen4891" created="Tue, 7 Jul 2015 00:10:08 +0000"/>
                            <attachment id="12744232" name="HBASE-13965-v6.patch" size="29810" author="leochen4891" created="Wed, 8 Jul 2015 15:10:01 +0000"/>
                            <attachment id="12744790" name="HBASE-13965-v7.patch" size="45412" author="leochen4891" created="Fri, 10 Jul 2015 20:27:38 +0000"/>
                            <attachment id="12745330" name="HBASE-13965-v8.patch" size="44927" author="leochen4891" created="Tue, 14 Jul 2015 20:39:35 +0000"/>
                            <attachment id="12747339" name="HBASE-13965-v9.patch" size="45203" author="leochen4891" created="Mon, 27 Jul 2015 14:25:50 +0000"/>
                            <attachment id="12743132" name="HBASE-13965_v2.patch" size="26597" author="leochen4891" created="Wed, 1 Jul 2015 19:06:46 +0000"/>
                            <attachment id="12747221" name="HBase-13965-JConsole.png" size="81563" author="leochen4891" created="Sun, 26 Jul 2015 06:05:44 +0000"/>
                            <attachment id="12742916" name="HBase-13965-v1.patch" size="51472" author="leochen4891" created="Tue, 30 Jun 2015 20:11:08 +0000"/>
                            <attachment id="12742697" name="stochasticloadbalancerclasses_v2.png" size="137709" author="leochen4891" created="Tue, 30 Jun 2015 02:17:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 24 Jun 2015 22:35:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 16 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ggjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>