<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:57:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14906/HBASE-14906.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14906] Improvements on FlushLargeStoresPolicy</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14906</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When checking FlushLargeStoragePolicy, found below possible improving points:&lt;/p&gt;

&lt;p&gt;1. Currently in selectStoresToFlush, we will do the selection no matter how many actual families, which is not necessary for one single family&lt;/p&gt;

&lt;p&gt;2. Default value for hbase.hregion.percolumnfamilyflush.size.lower.bound could not fit in all cases, and requires user to know details of the implementation to properly set it. We propose to use &quot;hbase.hregion.memstore.flush.size/column_family_number&quot; instead:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.hregion.percolumnfamilyflush.size.lower.bound&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;16777216&amp;lt;/value&amp;gt;
    &amp;lt;description&amp;gt;
    If FlushLargeStoresPolicy is used and there are multiple column families,
    then every time that we hit the total memstore limit, we find out all the
    column families whose memstores exceed a &quot;lower bound&quot; and only flush them
    while retaining the others in memory. The &quot;lower bound&quot; will be
    &quot;hbase.hregion.memstore.flush.size / column_family_number&quot; by default
    unless value of this property is larger than that. If none of the families
    have their memstore size more than lower bound, all the memstores will be
    flushed (just as usual).
    &amp;lt;/description&amp;gt;
  &amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12917495">HBASE-14906</key>
            <summary>Improvements on FlushLargeStoresPolicy</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="carp84">Yu Li</assignee>
                                    <reporter username="carp84">Yu Li</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Dec 2015 07:57:36 +0000</created>
                <updated>Fri, 11 Dec 2015 03:53:33 +0000</updated>
                            <resolved>Fri, 11 Dec 2015 00:50:50 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="15035434" author="carp84" created="Wed, 2 Dec 2015 07:58:44 +0000"  >&lt;p&gt;Attaching the initial patch&lt;/p&gt;</comment>
                            <comment id="15035442" author="carp84" created="Wed, 2 Dec 2015 08:01:44 +0000"  >&lt;p&gt;The result of TestPerColumnFamilyFlush#testCompareStoreFileCount shows a promising improvement (further less flush for small cf):&lt;/p&gt;

&lt;p&gt;w/o patch:&lt;br/&gt;
2015-12-01 22:15:39,749 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-1&amp;#93;&lt;/span&gt; regionserver.TestPerColumnFamilyFlush(637): disable selective flush: f1=&amp;gt;11, f2=&amp;gt;11, f3=&amp;gt;11&lt;br/&gt;
2015-12-01 22:15:39,749 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-1&amp;#93;&lt;/span&gt; regionserver.TestPerColumnFamilyFlush(640): enable selective flush: f1=&amp;gt;6, f2=&amp;gt;9, f3=&amp;gt;12&lt;/p&gt;

&lt;p&gt;w/ patch:&lt;br/&gt;
2015-12-01 22:23:21,649 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-1&amp;#93;&lt;/span&gt; regionserver.TestPerColumnFamilyFlush(634): disable selective flush: f1=&amp;gt;11, f2=&amp;gt;11, f3=&amp;gt;11&lt;br/&gt;
2015-12-01 22:23:21,649 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-1&amp;#93;&lt;/span&gt; regionserver.TestPerColumnFamilyFlush(637): enable selective flush: f1=&amp;gt;6, f2=&amp;gt;7, f3=&amp;gt;13&lt;/p&gt;</comment>
                            <comment id="15035450" author="carp84" created="Wed, 2 Dec 2015 08:12:53 +0000"  >&lt;p&gt;Also applied the same test case as &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201?focusedCommentId=14171950&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14171950&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;HBASE-10201&lt;/a&gt; in real cluster, allow me to repeat the test method:&lt;/p&gt;

&lt;p&gt;3 CFs, 16B value for CF1, 256B value for CF2 and 4K value for CF3, 1M rows, 128M memstore flush size, 16M CF flush size.&lt;/p&gt;

&lt;p&gt;And the result is:&lt;/p&gt;

&lt;p&gt;w/o patch:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;metric_storeCount : 3,
metric_storeFileCount : 9,
metric_memStoreSize : 112519968,
metric_storeFileSize : 4396528692,
metric_compactionsCompletedCount : 17,
metric_numBytesCompactedCount : 18891018964,
metric_numFilesCompactedCount : 89
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;w/ patch:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;metric_storeCount : 3,
metric_storeFileCount : 13,
metric_memStoreSize : 58168928,
metric_storeFileSize : 4446829180,
metric_compactionsCompletedCount : 15,
metric_numBytesCompactedCount : 15101162833,
metric_numFilesCompactedCount : 82
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Flush numbers of different column family:&lt;br/&gt;
w/o patch:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CF1: 9 times
CF2: 19 times
CF3: 39 times
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;w/ patch:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;CF1: 4 times
CF2: 8 times
CF3: 53 times
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the metrics we could see both compaction times and bytes involved in compaction reduced.&lt;/p&gt;

&lt;p&gt;We could also see there&apos;re less flushes of small CF but more of large CF. This makes sense by theory since more memstores of small cf retain in memory causing flush for large CF becoming more frequent, until small cf also reaches the flush line.&lt;/p&gt;</comment>
                            <comment id="15035452" author="carp84" created="Wed, 2 Dec 2015 08:14:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaurav.menghani&quot; class=&quot;user-hover&quot; rel=&quot;gaurav.menghani&quot;&gt;Gaurav Menghani&lt;/a&gt;, could you take a look here and share your thoughts? Thanks.&lt;/p&gt;</comment>
                            <comment id="15035610" author="apache9" created="Wed, 2 Dec 2015 10:34:14 +0000"  >&lt;p&gt;+1 on the idea.&lt;/p&gt;

&lt;p&gt;Only one thing, I think we should still use &lt;tt&gt;region.getMemstoreFlushSize() / familyNumber&lt;/tt&gt; even if we have a table config in the table description? In the patch you only compare the value with global config.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="15036035" author="carp84" created="Wed, 2 Dec 2015 16:06:55 +0000"  >&lt;p&gt;Thanks for the quick response &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;About config in table description, I think we need to preserve a way for experts to override the default value, in case they really need to set a &lt;b&gt;smaller&lt;/b&gt; value than &lt;tt&gt;region.getMemstoreFlushSize() / familyNumber&lt;/tt&gt; for their use case (setting the global config to a smaller value won&apos;t take effect by current design). Agree?&lt;/p&gt;</comment>
                            <comment id="15037101" author="stack" created="Thu, 3 Dec 2015 02:28:17 +0000"  >&lt;p&gt;This is nice work. +1 on patch. I like the test results.&lt;/p&gt;</comment>
                            <comment id="15037148" author="apache9" created="Thu, 3 Dec 2015 02:52:29 +0000"  >&lt;blockquote&gt;
&lt;p&gt;About config in table description, I think we need to preserve a way for experts to override the default value, in case they really need to set a smaller value than region.getMemstoreFlushSize() / familyNumber for their use case&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sounds reasonable. What about introduce two configurations here? One is the lower bound of lower bound, one is the exact lower bound? Make global config and table config have different meanings is a little confusing I think.&lt;/p&gt;</comment>
                            <comment id="15037238" author="carp84" created="Thu, 3 Dec 2015 04:38:11 +0000"  >&lt;blockquote&gt;
&lt;p&gt;What about introduce two configurations here? One is the lower bound of lower bound, one is the exact lower bound? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Make sense, will rename the global config name to &lt;tt&gt;hbase.hregion.percolumnfamilyflush.size.lower.bound.min&lt;/tt&gt; to better reflect what the property means, or if you have a better name in mind, just let me know. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;This change will invalidate user&apos;s previous setting on &lt;tt&gt;hbase.hregion.percolumnfamilyflush.size.lower.bound&lt;/tt&gt;, but this would be by-design since we have a better default (&lt;tt&gt;region.getMemstoreFlushSize() / familyNumber&lt;/tt&gt;) now. Will add the note into ReleaseNote.&lt;/p&gt;</comment>
                            <comment id="15037239" author="carp84" created="Thu, 3 Dec 2015 04:38:56 +0000"  >&lt;p&gt;Update patch according to Duo&apos;s comment&lt;/p&gt;</comment>
                            <comment id="15037396" author="carp84" created="Thu, 3 Dec 2015 06:57:14 +0000"  >&lt;p&gt;Add release note and submit patch to see what HadoopQA will say&lt;/p&gt;</comment>
                            <comment id="15037519" author="hadoopqa" created="Thu, 3 Dec 2015 08:55:39 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  &lt;br/&gt;
        &lt;font color=&quot;green&quot;&gt;+1 core zombie tests &amp;#8211; no zombies!&lt;/font&gt;.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16749//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16749//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16749//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16749//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16749//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16749//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16749//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16749//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15037561" author="carp84" created="Thu, 3 Dec 2015 09:32:19 +0000"  >&lt;p&gt;From the HadoopQA report, observe below failures (errors) although it says +1:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Tests in error: 
org.apache.hadoop.hbase.regionserver.TestBulkLoad.bulkHLogShouldThrowErrorWhenFamilySpecifiedAndHFileExistsButNotInTableDescriptor(org.apache.hadoop.hbase.regionserver.TestBulkLoad)
  Run 1: TestBulkLoad.bulkHLogShouldThrowErrorWhenFamilySpecifiedAndHFileExistsButNotInTableDescriptor &#239;&#191;&#189; 
  Run 2: TestBulkLoad.bulkHLogShouldThrowErrorWhenFamilySpecifiedAndHFileExistsButNotInTableDescriptor &#239;&#191;&#189; 
  Run 3: TestBulkLoad.bulkHLogShouldThrowErrorWhenFamilySpecifiedAndHFileExistsButNotInTableDescriptor &#239;&#191;&#189; 

org.apache.hadoop.hbase.regionserver.TestBulkLoad.shouldThrowErrorIfBadFamilySpecifiedAsFamilyPath(org.apache.hadoop.hbase.regionserver.TestBulkLoad)
  Run 1: TestBulkLoad.shouldThrowErrorIfBadFamilySpecifiedAsFamilyPath &#239;&#191;&#189;  Unexpected ex...
  Run 2: TestBulkLoad.shouldThrowErrorIfBadFamilySpecifiedAsFamilyPath &#239;&#191;&#189;  Unexpected ex...
  Run 3: TestBulkLoad.shouldThrowErrorIfBadFamilySpecifiedAsFamilyPath &#239;&#191;&#189;  Unexpected ex...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And detailed exception:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;shouldThrowErrorIfBadFamilySpecifiedAsFamilyPath(org.apache.hadoop.hbase.regionserver.TestBulkLoad)  Time elapsed: 0.043 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
java.lang.Exception: Unexpected exception, expected&amp;lt;org.apache.hadoop.hbase.DoNotRetryIOException&amp;gt; but was&amp;lt;java.lang.ArithmeticException&amp;gt;
	at org.apache.hadoop.hbase.regionserver.FlushLargeStoresPolicy.configureForRegion(FlushLargeStoresPolicy.java:59)
	at org.apache.hadoop.hbase.regionserver.FlushPolicyFactory.create(FlushPolicyFactory.java:52)
	at org.apache.hadoop.hbase.regionserver.HRegion.initializeRegionInternals(HRegion.java:845)
	at org.apache.hadoop.hbase.regionserver.HRegion.initialize(HRegion.java:786)
	at org.apache.hadoop.hbase.regionserver.HRegion.createHRegion(HRegion.java:6195)
	at org.apache.hadoop.hbase.regionserver.HRegion.createHRegion(HRegion.java:6204)
	at org.apache.hadoop.hbase.regionserver.TestBulkLoad.testRegionWithFamiliesAndSpecifiedTableName(TestBulkLoad.java:239)
	at org.apache.hadoop.hbase.regionserver.TestBulkLoad.testRegionWithFamilies(TestBulkLoad.java:249)
	at org.apache.hadoop.hbase.regionserver.TestBulkLoad.shouldThrowErrorIfBadFamilySpecifiedAsFamilyPath(TestBulkLoad.java:207)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since these are Errors not Failures, the test stop at the middle phase.&lt;/p&gt;

&lt;p&gt;The issue is caused by the patch here since it doesn&apos;t handle the case that column family number is zero, although this won&apos;t happen in real world, it&apos;s possible in our unit test case like TestBulkload.&lt;/p&gt;</comment>
                            <comment id="15037564" author="carp84" created="Thu, 3 Dec 2015 09:34:38 +0000"  >&lt;p&gt;Update patch to resolve UT failure, and retry HadoopQA&lt;/p&gt;</comment>
                            <comment id="15037731" author="hadoopqa" created="Thu, 3 Dec 2015 12:37:46 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  &lt;br/&gt;
        &lt;font color=&quot;green&quot;&gt;+1 core zombie tests &amp;#8211; no zombies!&lt;/font&gt;.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16750//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16750//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16750//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16750//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16750//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16750//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16750//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16750//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15037774" author="carp84" created="Thu, 3 Dec 2015 13:30:12 +0000"  >&lt;p&gt;Another patch to resolve regression UT failure caused by not updating property name in TestPerColumnFamilyFlush after renaming global config &lt;tt&gt;hbase.hregion.percolumnfamilyflush.size.lower.bound&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="15038063" author="hadoopqa" created="Thu, 3 Dec 2015 16:43:56 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  &lt;br/&gt;
        &lt;font color=&quot;green&quot;&gt;+1 core zombie tests &amp;#8211; no zombies!&lt;/font&gt;.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16755//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16755//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16755//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16755//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16755//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16755//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16755//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16755//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15038139" author="carp84" created="Thu, 3 Dec 2015 17:20:03 +0000"  >&lt;p&gt;Confirmed no more UT failure from the testReport. However, the report still looks strange: summary about core tests, javadoc, etc. seems to disappear. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; could you please take a look here sir?&lt;/p&gt;</comment>
                            <comment id="15038201" author="stack" created="Thu, 3 Dec 2015 17:51:45 +0000"  >&lt;p&gt;This is my fault &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=carp84&quot; class=&quot;user-hover&quot; rel=&quot;carp84&quot;&gt;Yu Li&lt;/a&gt; Will rerun the patch in a minute after I fix the reporting...&lt;/p&gt;</comment>
                            <comment id="15038218" author="stack" created="Thu, 3 Dec 2015 18:06:36 +0000"  >&lt;p&gt;Retry after making change in test-patch.sh&lt;/p&gt;</comment>
                            <comment id="15038605" author="hadoopqa" created="Thu, 3 Dec 2015 21:15:57 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12775599/HBASE-14906.v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12775599/HBASE-14906.v4.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a154ecda00d9d9a58e83d322dae7ffd3518b633c.&lt;br/&gt;
  ATTACHMENT ID: 12775599&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;. The applied patch does not generate new checkstyle errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;br/&gt;
        &lt;font color=&quot;green&quot;&gt;+1 core zombie tests &amp;#8211; no zombies!&lt;/font&gt;.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16757//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16757//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16757//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16757//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16757//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16757//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16757//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16757//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15038608" author="hadoopqa" created="Thu, 3 Dec 2015 21:17:32 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12775599/HBASE-14906.v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12775599/HBASE-14906.v4.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a154ecda00d9d9a58e83d322dae7ffd3518b633c.&lt;br/&gt;
  ATTACHMENT ID: 12775599&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;. The applied patch does not generate new checkstyle errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;br/&gt;
        &lt;font color=&quot;green&quot;&gt;+1 core zombie tests &amp;#8211; no zombies!&lt;/font&gt;.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16758//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16758//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16758//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16758//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16758//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16758//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16758//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16758//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15039587" author="apache9" created="Fri, 4 Dec 2015 02:05:03 +0000"  >&lt;p&gt;So there is no exact lower bound in global config?&lt;/p&gt;</comment>
                            <comment id="15039630" author="carp84" created="Fri, 4 Dec 2015 02:36:56 +0000"  >&lt;blockquote&gt;
&lt;p&gt;So there is no exact lower bound in global config?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, there&apos;s only a &quot;minimum lower bound&quot; in global config, or say the default value for lower bound would be &quot;dynamic&quot; and table-specific now instead of any fixed value, unless the auto computed one is smaller than the minimum config.&lt;/p&gt;

&lt;p&gt;After the change there&apos;s no way for user to specify a &lt;em&gt;uniform small&lt;/em&gt; lower bound for &lt;b&gt;all&lt;/b&gt; tables any more, which is also unnecessary IMHO. Expert user who wants to specify a smaller lower bound for any specified table could still achieve the goal by setting &lt;tt&gt;hbase.hregion.percolumnfamilyflush.size.lower.bound&lt;/tt&gt; in table descriptor&lt;/p&gt;

&lt;p&gt;Feel free to let me know if any concern here. Thanks.&lt;/p&gt;</comment>
                            <comment id="15039657" author="apache9" created="Fri, 4 Dec 2015 02:57:01 +0000"  >&lt;p&gt;I&apos;m OK with it.&lt;/p&gt;

&lt;p&gt;+1 on the newest patch.&lt;/p&gt;</comment>
                            <comment id="15039665" author="carp84" created="Fri, 4 Dec 2015 03:07:46 +0000"  >&lt;p&gt;Thanks for the review and comments Duo!&lt;/p&gt;</comment>
                            <comment id="15043916" author="carp84" created="Sun, 6 Dec 2015 15:05:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaurav.menghani&quot; class=&quot;user-hover&quot; rel=&quot;gaurav.menghani&quot;&gt;Gaurav Menghani&lt;/a&gt;, any comments on this one? Thanks.&lt;/p&gt;</comment>
                            <comment id="15051291" author="carp84" created="Thu, 10 Dec 2015 17:25:39 +0000"  >&lt;p&gt;Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15051933" author="stack" created="Fri, 11 Dec 2015 00:50:50 +0000"  >&lt;p&gt;Pushed to master. Thanks you for the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=carp84&quot; class=&quot;user-hover&quot; rel=&quot;carp84&quot;&gt;Yu Li&lt;/a&gt; Thats a nice release note. I was tempted to pull it back to 1.2 since that is first release with per column family flushing enabled by default but it is a bit late in the game for 1.2 at this stage. Nice patch.&lt;/p&gt;</comment>
                            <comment id="15052062" author="carp84" created="Fri, 11 Dec 2015 02:53:13 +0000"  >&lt;p&gt;Thanks for help review and commit sir! &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15052117" author="hudson" created="Fri, 11 Dec 2015 03:53:33 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-Trunk_matrix #545 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/545/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/545/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14906&quot; title=&quot;Improvements on FlushLargeStoresPolicy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14906&quot;&gt;&lt;del&gt;HBASE-14906&lt;/del&gt;&lt;/a&gt; Improvements on FlushLargeStoresPolicy (Yu Li) (stack: rev c15e0af84aeb4ab992482a957c2b242d2ab57d76)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/resources/hbase-default.xml&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushLargeStoresPolicy.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestPerColumnFamilyFlush.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12775237" name="HBASE-14906.patch" size="7356" author="carp84" created="Wed, 2 Dec 2015 07:58:44 +0000"/>
                            <attachment id="12775482" name="HBASE-14906.v2.patch" size="8110" author="carp84" created="Thu, 3 Dec 2015 04:38:56 +0000"/>
                            <attachment id="12775521" name="HBASE-14906.v3.patch" size="8183" author="carp84" created="Thu, 3 Dec 2015 09:34:38 +0000"/>
                            <attachment id="12775599" name="HBASE-14906.v4.patch" size="9970" author="stack" created="Thu, 3 Dec 2015 18:06:36 +0000"/>
                            <attachment id="12775552" name="HBASE-14906.v4.patch" size="9970" author="carp84" created="Thu, 3 Dec 2015 13:30:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 2 Dec 2015 10:34:14 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 1 week ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2p5pb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>In &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14906&quot; title=&quot;Improvements on FlushLargeStoresPolicy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14906&quot;&gt;&lt;strike&gt;HBASE-14906&lt;/strike&gt;&lt;/a&gt; we use &amp;quot;hbase.hregion.memstore.flush.size/column_family_number&amp;quot; as the default threshold for memstore flush instead of the fixed value through &amp;quot;hbase.hregion.percolumnfamilyflush.size.lower.bound&amp;quot; property, which makes  the default threshold more flexible to various use case. We also introduce a new property in name of &amp;quot;hbase.hregion.percolumnfamilyflush.size.lower.bound.min&amp;quot; with 16M as the default value to avoid small flush in cases like hundreds of column families.&lt;br/&gt;
&lt;br/&gt;
After this change setting &amp;quot;hbase.hregion.percolumnfamilyflush.size.lower.bound&amp;quot; in hbase-site.xml won&amp;#39;t take effect anymore, but expert users could still set this property in table descriptor to override the default value just as before</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>