<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:13:21 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3811/HBASE-3811.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3811] Allow adding attributes to Scan</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3811</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;There&apos;s sometimes a need to add custom attribute to Scan object so that it can be accessed on server side.&lt;br/&gt;
Example of the case where it is needed discussed here: &lt;a href=&quot;http://search-hadoop.com/m/v3Jtb2GkiO&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://search-hadoop.com/m/v3Jtb2GkiO&lt;/a&gt;. There might be other cases where it is useful, which are mostly about logging/gathering stats on server side.&lt;/p&gt;

&lt;p&gt;Alternative to allowing adding any custom attributes to scan could be adding some fixed field, like &quot;type&quot; to the class.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12504899">HBASE-3811</key>
            <summary>Allow adding attributes to Scan</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="alexb">Alex Baranau</assignee>
                                    <reporter username="alexb">Alex Baranau</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Apr 2011 15:31:46 +0000</created>
                <updated>Fri, 20 Nov 2015 12:43:09 +0000</updated>
                            <resolved>Wed, 25 May 2011 20:41:58 +0000</resolved>
                                                    <fixVersion>0.92.0</fixVersion>
                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13025522" author="stack" created="Tue, 26 Apr 2011 23:59:30 +0000"  >&lt;p&gt;You could change Scan so it passes an optional Map.   Add an attributes method to Scan.  If attributes &amp;gt; 0, instantiate a Map and then serialize it out.  On other end, have check for null or non-null Map when deserializing (We don&apos;t want to carry the Map for every Scan I&apos;d say &amp;#8211; just carry it when attributes present... but perhaps I&apos;m doing premature optimization here).&lt;/p&gt;

&lt;p&gt;This could become more important now we have CPs.&lt;/p&gt;</comment>
                            <comment id="13027546" author="yuzhihong@gmail.com" created="Mon, 2 May 2011 04:28:41 +0000"  >&lt;p&gt;We can follow the example of HTableDescriptor.write():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    out.writeInt(families.size());
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;(Iterator&amp;lt;HColumnDescriptor&amp;gt; it = families.values().iterator();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13031147" author="alexb" created="Tue, 10 May 2011 12:36:33 +0000"  >&lt;p&gt;Attached patch. There&apos;s small Q about it (you can see it in comments): since we changing the data format of serialized scan, should we change scan implementation version and/or should we support previous format (this way we will support &quot;older&quot; clients)?&lt;/p&gt;</comment>
                            <comment id="13031150" author="alexb" created="Tue, 10 May 2011 12:38:07 +0000"  >&lt;p&gt;I was going to submit patch for review on review board, but had problems accessing it at &lt;a href=&quot;https://reviews.apache.org/account/login/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/account/login/&lt;/a&gt; (looks like my existing account doesn&apos;t work, nor password recovery/register functionality) &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13031202" author="yuzhihong@gmail.com" created="Tue, 10 May 2011 14:17:47 +0000"  >&lt;p&gt;Should we generalize the type of value in attributes map to be of byte [] ?&lt;/p&gt;</comment>
                            <comment id="13031206" author="alexb" created="Tue, 10 May 2011 14:32:05 +0000"  >&lt;p&gt;Hm. I thought about scan attributes as usual attributes/settings map, which is comparable to e.g. org.apache.hadoop.conf.Configuration or similar.&lt;/p&gt;

&lt;p&gt;Does anyone see we are going to use byte[] values? Are we going to put in values e.g. serialized objects, or smth related?&lt;/p&gt;
</comment>
                            <comment id="13031218" author="yuzhihong@gmail.com" created="Tue, 10 May 2011 14:39:54 +0000"  >&lt;p&gt;If we use &quot;sourceScan&quot; attribute to store the unique ID for distributed scan, a natural choice would be byte array representing the start/end row(s) of the original Scan.&lt;/p&gt;</comment>
                            <comment id="13031572" author="alexb" created="Wed, 11 May 2011 07:02:23 +0000"  >&lt;p&gt;Attached new patch. Major change:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;attributes map is changed from Map&amp;lt;String, String&amp;gt; to Map&amp;lt;String, byte[]&amp;gt;.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13031708" author="yuzhihong@gmail.com" created="Wed, 11 May 2011 13:57:57 +0000"  >&lt;p&gt;I ran TestScan, TestScannerTimeout and TestFromClientSide based on today&apos;s patch and they passed.&lt;br/&gt;
I then commented out the persistence of attributes map in write(final DataOutput out), TestScannerTimeout passed too.&lt;/p&gt;</comment>
                            <comment id="13032019" author="alexb" created="Wed, 11 May 2011 20:04:44 +0000"  >&lt;p&gt;&amp;gt; I then commented out the persistence of attributes map in &lt;br/&gt;
&amp;gt; write(final DataOutput out), TestScannerTimeout passed too.&lt;/p&gt;

&lt;p&gt;Any specific reason for that? Just wondering...&lt;/p&gt;</comment>
                            <comment id="13032026" author="yuzhihong@gmail.com" created="Wed, 11 May 2011 20:15:20 +0000"  >&lt;p&gt;I wanted to test backward compatibility of the read() method.&lt;br/&gt;
The result means we don&apos;t have to increase the version number of Scan.&lt;/p&gt;</comment>
                            <comment id="13032048" author="alexb" created="Wed, 11 May 2011 20:45:10 +0000"  >&lt;p&gt;That was expected by me since I added the code below to handle this case:&lt;/p&gt;

&lt;p&gt;    int numAttributes = 0;&lt;br/&gt;
    try &lt;/p&gt;
{
      numAttributes = in.readInt();
    }
&lt;p&gt; catch (EOFException e) &lt;/p&gt;
{ // indicates that serialized scan doesn&apos;t support attributes
      // DO NOTHING
      // TODO: should we really care about it? or should we increase scan version number and handle/not handle
      // attributes depending on version?
    }

&lt;p&gt;Still one may think that using Scan version is cleaner variant. Not sure what are the plans for Scan version and when it is ok to change it &lt;b&gt;by initial design&lt;/b&gt;.&lt;/p&gt;</comment>
                            <comment id="13036513" author="stack" created="Thu, 19 May 2011 21:47:29 +0000"  >&lt;p&gt;Why do you extend TestCase Alex?  Its a new test.  Junit4 doesn&apos;t use TestCase?  Or does it?&lt;/p&gt;

&lt;p&gt;Do isEmpty rather than &apos;+      if (attributes.size() == 0) {&apos;&lt;/p&gt;

&lt;p&gt;It seems strange we would catch an EOFE on deserialization when we have the version available to us.  Can we use the SCAN_VERSION?  Up it to 2 and have version 2 able to deserialize both versions?&lt;/p&gt;

&lt;p&gt;Otherwise patch looks great Alex.&lt;/p&gt;
</comment>
                            <comment id="13039233" author="alexb" created="Wed, 25 May 2011 17:44:45 +0000"  >&lt;p&gt;qt. Why do you extend TestCase Alex? Its a new test. Junit4 doesn&apos;t use TestCase? Or does it?&lt;/p&gt;

&lt;p&gt;Just tried to follow the &quot;coding style&quot; here, as I saw other test cases use this design. Cleaning it.&lt;/p&gt;

&lt;p&gt;qt. It seems strange we would catch an EOFE on deserialization when we have the version available to us. Can we use the SCAN_VERSION? Up it to 2 and have version 2 able to deserialize both versions?&lt;/p&gt;

&lt;p&gt;Exactly. That is what I meant by saying/asking &quot;Still one may think that using Scan version is cleaner variant. Not sure what are the plans for Scan version and when it is ok to change it by initial design.&quot;&lt;/p&gt;</comment>
                            <comment id="13039235" author="alexb" created="Wed, 25 May 2011 17:46:08 +0000"  >&lt;p&gt;Submitted updated patch (fixed the nits mentioned by Stack).&lt;/p&gt;</comment>
                            <comment id="13039238" author="alexb" created="Wed, 25 May 2011 17:50:12 +0000"  >&lt;p&gt;Sorry, attached new one: my IDE shuffled the imports in the previous one &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13039319" author="stack" created="Wed, 25 May 2011 20:41:58 +0000"  >&lt;p&gt;Committed to TRUNK.  Thanks for the patch Alex (I made you a contributor and so in future you should be able to assign yourself issues).&lt;/p&gt;</comment>
                            <comment id="13039343" author="alexb" created="Wed, 25 May 2011 21:27:27 +0000"  >&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="13039408" author="hudson" created="Wed, 25 May 2011 23:00:43 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #1939 (See &lt;a href=&quot;https://builds.apache.org/hudson/job/HBase-TRUNK/1939/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/hudson/job/HBase-TRUNK/1939/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3811&quot; title=&quot;Allow adding attributes to Scan&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3811&quot;&gt;&lt;del&gt;HBASE-3811&lt;/del&gt;&lt;/a&gt; Allow adding attributes to Scan&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3811&quot; title=&quot;Allow adding attributes to Scan&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3811&quot;&gt;&lt;del&gt;HBASE-3811&lt;/del&gt;&lt;/a&gt; Allow adding attributes to Scan&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/client/TestScan.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/Scan.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15017443" author="lars_francke" created="Fri, 20 Nov 2015 12:43:09 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12501996">HBASE-3679</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12508367">HBASE-3921</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12480438" name="HBASE-3811.patch" size="8381" author="alexb" created="Wed, 25 May 2011 17:50:12 +0000"/>
                            <attachment id="12480436" name="HBASE-3811.patch" size="8850" author="alexb" created="Wed, 25 May 2011 17:46:08 +0000"/>
                            <attachment id="12478775" name="HBASE-3811.patch" size="8256" author="alexb" created="Wed, 11 May 2011 07:02:23 +0000"/>
                            <attachment id="12478694" name="HBASE-3811.patch" size="7701" author="alexb" created="Tue, 10 May 2011 12:36:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 26 Apr 2011 23:59:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33217</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ho07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101151</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>