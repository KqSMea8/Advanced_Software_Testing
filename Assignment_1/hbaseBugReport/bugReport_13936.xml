<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:48:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13936/HBASE-13936.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13936] Improve configuration framework</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13936</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Here&apos;s the design doc: &lt;a href=&quot;https://docs.google.com/document/d/1WiO2bqguR2DaVT-J2SZTCONbQ3pEhpbOI_bbLMaXRjE/edit#&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://docs.google.com/document/d/1WiO2bqguR2DaVT-J2SZTCONbQ3pEhpbOI_bbLMaXRjE/edit#&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Main changes:&lt;br/&gt;
get*(&quot;foo.bar&quot;, default_value)  ---&amp;gt; get*(HConfig.FOO_BAR)  // using enums&lt;br/&gt;
Robust framework and better documentation for dynamic configurations.&lt;/p&gt;

&lt;p&gt;Basic overview of new design:&lt;br/&gt;
&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12740557/12740557_design.png&quot; align=&quot;absmiddle&quot; border=&quot;0&quot; /&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12838892">HBASE-13936</key>
            <summary>Improve configuration framework</summary>
                <type id="14" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/genericissue.png">Umbrella</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="appy">Appy</assignee>
                                    <reporter username="appy">Appy</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Jun 2015 18:50:43 +0000</created>
                <updated>Fri, 9 Sep 2016 22:03:32 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                                                            <comments>
                            <comment id="14592313" author="appy" created="Thu, 18 Jun 2015 18:54:20 +0000"  >&lt;p&gt;Depending on scope of work done in this jira, link to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3909&quot; title=&quot;Add dynamic config&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3909&quot;&gt;HBASE-3909&lt;/a&gt; may later be updated to duplicate/supersede.&lt;/p&gt;</comment>
                            <comment id="14596237" author="apurtell" created="Mon, 22 Jun 2015 17:05:33 +0000"  >&lt;p&gt;Here&apos;s the Google doc downloaded in Word format, for posterity.&lt;/p&gt;</comment>
                            <comment id="14603266" author="enis" created="Fri, 26 Jun 2015 17:34:12 +0000"  >&lt;p&gt;This is interesting work. A couple of comments: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Prefixing &apos;H&apos; is deprecated. Please refrain from that old pattern.&lt;/li&gt;
	&lt;li&gt;Showing every possible configuration value to a single class is an anti-pattern. HConstants was that, and it went bad. The configurations should be defined close to where they are used.&lt;/li&gt;
	&lt;li&gt;Please take a look at TableConfiguration, and why it was introduced. In a lot of places, the configuration parsing becomes the bottleneck especially in the hot code paths. Going forward we should only be passing small parsed POJO style objects holding the configuration for that specific sub system. A bad example is CacheConfig. It holds the defaults, config names, and actual values together with the actual Block cache reference. But the idea should be keeping the parsing / deprecation handling / business logic and the actual parsed values related to a single system together and use that object to pass it around.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14603577" author="appy" created="Fri, 26 Jun 2015 21:05:23 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;.&lt;br/&gt;
Comments inlined.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Prefixing &apos;H&apos; is deprecated. Please refrain from that old pattern.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Will keep in mind.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Showing every possible configuration value to a single class is an anti-pattern. HConstants was that, and it went bad. The configurations should be defined close to where they are used.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s right. I didn&apos;t realize that until &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; explained it to me yesterday. We have decided to change the design in favor of grouping configurations at client, server, common, etc level. What do you think?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Please take a look at TableConfiguration, and why it was introduced. In a lot of places, the configuration parsing becomes the bottleneck especially in the hot code paths. Going forward we should only be passing small parsed POJO style objects holding the configuration for that specific sub system. A bad example is CacheConfig. It holds the defaults, config names, and actual values together with the actual Block cache reference. But the idea should be keeping the parsing / deprecation handling / business logic and the actual parsed values related to a single system together and use that object to pass it around.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree with you, I have seen and used this design in other places, and I like it most because it is very clean. However, do you think there is something we can change in the design of configuration framework i.e. Configuration , ConfigurationManager and other core classes (i&apos;ll be adding some new classes, will add you on review board), to promote or push this design? Because it seems to me that it&apos;s more about educating the community.&lt;/p&gt;</comment>
                            <comment id="14603582" author="yuzhihong@gmail.com" created="Fri, 26 Jun 2015 21:09:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;will add you on review board&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Please include hbase group in review request&lt;/p&gt;</comment>
                            <comment id="14603586" author="appy" created="Fri, 26 Jun 2015 21:11:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;Please include hbase group in review request&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Definitely, isn&apos;t that default? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14603595" author="yuzhihong@gmail.com" created="Fri, 26 Jun 2015 21:14:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;isn&apos;t that default? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No&lt;/p&gt;</comment>
                            <comment id="14603641" author="appy" created="Fri, 26 Jun 2015 21:41:42 +0000"  >&lt;p&gt;While we are at it, I&apos;d like to throw some other big questions/doubts/ideas here. Starting with this one,&lt;/p&gt;

&lt;p&gt;I feel like having set*() function for configurations isn&apos;t a good idea. It essentially makes the Configuration object a big container of 100s of variables being changed and passed around.&lt;br/&gt;
In our code, &apos;conf&apos; is copied around, values are overwritten, then passed around again. Scary. Makes it quite easy to screw up.&lt;/p&gt;

&lt;p&gt;I believe that a better design would be having a single immutable Configuration object. Any case which requires overwriting a configuration property inside the code should be refactor-able into a better design.&lt;br/&gt;
What do others think? Is there any case where overwriting a property inside code is the only or the best way? (unit-tests aside)&lt;/p&gt;</comment>
                            <comment id="14603821" author="apurtell" created="Sat, 27 Jun 2015 00:14:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;Moving from Configuration to ConfigurationManager &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;(In the doc)&lt;/p&gt;

&lt;p&gt;Are you are referring to o.a.h.conf.Configuration? If so, we inherited this, and XML site files, back in the distant past when we were part of the Hadoop project. If we&apos;re going to move away from Hadoop-style configuration for 2.0 or later then we can get away from that class somewhat, however, use of Configuration (or classes derived from it) will still required when interacting with Hadoop&apos;s filesystem abstractions and HDFS. &lt;/p&gt;

&lt;p&gt;Ideally we don&apos;t just outright replace our configuration with a new format. This implies keeping Configuration or emulating Hadoop style site files with whatever we are replacing it with. Consider Log4j as an example. If you try to go from v1 to v2, you go from properties style configuration to a new XML format that might as well come from Mars, and depending on configuration it can be impossible to come up with an identical configuration for v2. Whatever the outcome of this project, can we agree not to subject our users to that type of experience?&lt;/p&gt;</comment>
                            <comment id="14604404" author="appy" created="Sat, 27 Jun 2015 22:40:28 +0000"  >&lt;p&gt;I think that Hadoop style site files is an good design and it should be left as such. The scope of this project and the design changes we have thought so far (in the doc) will be invisible to the users and will only impact dev.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Moving from Configuration to ConfigurationManager&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So the basic idea is to encapsulate Configuration within ConfigurationManager and provide a better API for handling configurations. That will help in building a better framework for dynamic configurations, type check configuration values, and get rid of few other bad patterns.&lt;br/&gt;
Since the aim here is to promote right patterns (and possibly design the framework so that it&apos;s not possible to go otherwise), I will highlight major issues here and get everyone&apos;s opinions.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt; On that note, what do you about the issue of set*() functions (my last post).&lt;/p&gt;</comment>
                            <comment id="14606001" author="apurtell" created="Mon, 29 Jun 2015 17:54:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;On that note, what do you about the issue of set*() functions (my last post).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree Configuration is a god object. ConfigurationManager could become the same if care isn&apos;t taken to avoid that outcome. &lt;/p&gt;</comment>
                            <comment id="14606007" author="apurtell" created="Mon, 29 Jun 2015 17:57:21 +0000"  >&lt;p&gt;HTableDescriptor and HColumnDescriptor also include getters and setters for details from several subsystems that should be pushed out. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12507918">HBASE-3909</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13003942">HBASE-16601</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12741075" name="DynamicConfigs.v01.docx" size="15006" author="apurtell" created="Mon, 22 Jun 2015 17:05:33 +0000"/>
                            <attachment id="12740557" name="design.png" size="50279" author="appy" created="Fri, 19 Jun 2015 02:31:24 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12839963">HBASE-13957</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 22 Jun 2015 17:05:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 24 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2g853:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>