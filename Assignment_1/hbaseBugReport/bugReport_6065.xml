<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:33:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6065/HBASE-6065.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6065] Log for flush would append a non-sequential edit in the hlog, leading to possible data loss</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6065</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;After completing flush region, we will append a log edit in the hlog file through HLog#completeCacheFlush.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void completeCacheFlush(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [] encodedRegionName,
      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [] tableName, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; logSeqId, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isMetaRegion)
{
...
HLogKey key = makeKey(encodedRegionName, tableName, logSeqId,
            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis(), HConstants.DEFAULT_CLUSTER_ID);
...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;p&gt;when we make the hlog key, we use the seqId from the parameter, and it is generated by HLog#startCacheFlush,&lt;br/&gt;
Here, we may append a lower seq id edit than the last edit in the hlog file.&lt;/p&gt;

&lt;p&gt;If it is the last edit log in the file, it may cause data loss.&lt;br/&gt;
because &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

HRegion#replayRecoveredEditsIfAny{
...
maxSeqId = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.abs(&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.parseLong(fileName));
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (maxSeqId &amp;lt;= minSeqId) {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; msg = &lt;span class=&quot;code-quote&quot;&gt;&quot;Maximum sequenceid &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; log is &quot;&lt;/span&gt; + maxSeqId
            + &lt;span class=&quot;code-quote&quot;&gt;&quot; and minimum sequenceid &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region is &quot;&lt;/span&gt; + minSeqId
            + &lt;span class=&quot;code-quote&quot;&gt;&quot;, skipped the whole file, path=&quot;&lt;/span&gt; + edits;
        LOG.debug(msg);
        &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
      }
...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We may skip the splitted log file, because we use the lase edit&apos;s seq id as its file name, and consider this seqId as the max seq id in this log file.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12556798">HBASE-6065</key>
            <summary>Log for flush would append a non-sequential edit in the hlog, leading to possible data loss</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zjushch">chunhui shen</assignee>
                                    <reporter username="zjushch">chunhui shen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 May 2012 03:29:43 +0000</created>
                <updated>Tue, 26 Feb 2013 08:16:19 +0000</updated>
                            <resolved>Mon, 28 May 2012 04:35:50 +0000</resolved>
                                                    <fixVersion>0.94.1</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                    <component>wal</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13280697" author="zjushch" created="Tue, 22 May 2012 03:44:36 +0000"  >&lt;p&gt;In the patch, I obtainSeqNum() for the flush log edit rather than the seqId from parameter.&lt;br/&gt;
So we could ensure the log seq id is always sequential in the file.&lt;br/&gt;
BTW, do we use the flush log edit anywhere?&lt;/p&gt;

&lt;p&gt;There is another solution: change the splitted log file&apos;s name to the real max seq id, rather than the last seq id &lt;/p&gt;</comment>
                            <comment id="13280701" author="zhihyu@ebaysf.com" created="Tue, 22 May 2012 04:00:31 +0000"  >&lt;p&gt;Can you provide a test that shows this defect ?&lt;/p&gt;

&lt;p&gt;If logSeqId is not used by completeCacheFlush(), can we omit this parameter in the call ?&lt;/p&gt;</comment>
                            <comment id="13280707" author="ram_krish" created="Tue, 22 May 2012 04:25:09 +0000"  >&lt;p&gt;So this applies to 0.94 and above only right?&lt;/p&gt;</comment>
                            <comment id="13280717" author="ram_krish" created="Tue, 22 May 2012 04:45:23 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
What type of dataloass you see here? is it the edit with HBASE::CACHEFLUSH that gets missed here?&lt;br/&gt;
Ideally by design that edit is actually needed to show up to what point the flush has been done and the same is added as an entry in HLog.&lt;br/&gt;
Even while recovering we tend to skip this entry.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
           &lt;span class=&quot;code-comment&quot;&gt;// Check &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; edit is &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; me. Also, guard against writing the special
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// METACOLUMN info such as HBASE::CACHEFLUSH entries
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (kv.matchingFamily(HLog.METAFAMILY) ||
                !Bytes.equals(key.getEncodedRegionName(), &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regionInfo.getEncodedNameAsBytes())) {
              skippedEdits++;
              &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Did you find any other type of dataloss which i am not able to foresee here? Correct me if am wrong.&lt;/p&gt;</comment>
                            <comment id="13280731" author="zjushch" created="Tue, 22 May 2012 05:09:05 +0000"  >&lt;p&gt;Suppose region A on the regionserver B,&lt;br/&gt;
The issue could reproduce as the following step:&lt;/p&gt;

&lt;p&gt;1.put one data to region A (append seq 1 in the hlog)&lt;br/&gt;
2.put one data to region A (append seq 2 in the hlog)&lt;br/&gt;
3.region A start flush,  it will call HLog#startCacheFlush (current seq num is 3 in the hlog)&lt;br/&gt;
4.put one data to region A (append seq 4 in the hlog)&lt;br/&gt;
5.region A complete flush, it will call HLog#completeCacheFlush  (append seq 3 in the hlog)&lt;br/&gt;
6.kill regionserver B.&lt;/p&gt;

&lt;p&gt;So, the hlog file has four edit:&lt;br/&gt;
seq 1&lt;br/&gt;
seq 2&lt;br/&gt;
seq 4&lt;br/&gt;
seq 3&lt;/p&gt;

&lt;p&gt;when splitting this hlog file, we generate the recoverd.edits file for region A which is named 3.(About the name, we could see HLogSplitter#splitLogFileToTemp)&lt;/p&gt;

&lt;p&gt;Now, when replaying recoverd.edits file for region A, we will skip this file and cause data loss.&lt;/p&gt;


</comment>
                            <comment id="13280734" author="zjushch" created="Tue, 22 May 2012 05:20:52 +0000"  >&lt;p&gt;I have tried to write a test, but it is a little hard.&lt;/p&gt;

&lt;p&gt;We also could fix the issue using another solution (patchv2):&lt;br/&gt;
In current logic, we consider the last edit&apos;s seq id as the maximal seq id in the recoverd.edits file, however it is wrong because we can&apos;t ensure the sequentia edit in the hlog.&lt;br/&gt;
So we should changed the logic of find the maximal seq id for the recoverd.edits file, &lt;br/&gt;
We only need do a little for the method HLogSplitter#updateRegionMaximumEditLogSeqNum.&lt;/p&gt;</comment>
                            <comment id="13280735" author="ram_krish" created="Tue, 22 May 2012 05:21:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;splitted log file&apos;s name to the real max seq id, rather than the last seq id &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think this way should be fine. i.e the recovered.edits file name should have the real max seq id (was thinking that is how it is).  Or the HBASE::CACHEFLUSH will have some other edit which is not actually the flushed seq id.&lt;/p&gt;</comment>
                            <comment id="13280783" author="zhihyu@ebaysf.com" created="Tue, 22 May 2012 07:48:42 +0000"  >&lt;p&gt;updateRegionMaximumEditLogSeqNum() is called by two methods. I think we should make it synchronized.&lt;/p&gt;</comment>
                            <comment id="13280787" author="hadoopqa" created="Tue, 22 May 2012 07:55:35 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12528556/HBASE-6065v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12528556/HBASE-6065v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 33 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestAtomicOperation&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestMultiSlaveReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestMasterReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1956//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1956//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1956//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1956//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1956//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1956//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13280788" author="zjushch" created="Tue, 22 May 2012 07:56:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;updateRegionMaximumEditLogSeqNum() is called by two methods. I think we should make it synchronized&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In the patch v2, I has already added synchronized&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  void updateRegionMaximumEditLogSeqNum(Entry entry) {
-      regionMaximumEditLogSeqNum.put(entry.getKey().getEncodedRegionName(),
-          entry.getKey().getLogSeqNum());
+      &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (regionMaximumEditLogSeqNum) {
+        &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; currentMaxSeqNum=regionMaximumEditLogSeqNum.get(entry.getKey().getEncodedRegionName());
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (currentMaxSeqNum == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
+            || entry.getKey().getLogSeqNum() &amp;gt; currentMaxSeqNum) {
+          regionMaximumEditLogSeqNum.put(entry.getKey().getEncodedRegionName(),
+              entry.getKey().getLogSeqNum());
+        }
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13281090" author="zhihyu@ebaysf.com" created="Tue, 22 May 2012 16:35:08 +0000"  >&lt;p&gt;I ran TestAtomicOperation 3 times on MacBook and they passed.&lt;/p&gt;

&lt;p&gt;+1 on patch v2.&lt;/p&gt;</comment>
                            <comment id="13281406" author="ram_krish" created="Wed, 23 May 2012 05:05:38 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
Again thinking on this patch&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5782&quot; title=&quot;Edits can be appended out of seqid order since HBASE-4487&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5782&quot;&gt;&lt;del&gt;HBASE-5782&lt;/del&gt;&lt;/a&gt; ensures that the seqid should be in sequence.  It is only the CACHEFLUSH entry that deviates from the fact that the seq id can be ordered.&lt;br/&gt;
I feel that instead of checking the real max seq id we can just avoid this entry from adding to regionMaximumEditLogSeqNum.&lt;br/&gt;
This will ensure that finally when we create the recovered.edits file we will have only the max entry.  What do you feel?  It should be simple also.&lt;/p&gt;</comment>
                            <comment id="13281408" author="zjushch" created="Wed, 23 May 2012 05:15:57 +0000"  >&lt;p&gt;@ram&lt;br/&gt;
I think both ok.&lt;/p&gt;

&lt;p&gt;Since current patchV2 could fix the issue and maybe in the future we allow to append edit non-sequentially, thus we don&apos;t need to change this logic. I think patchV2 would be OK.&lt;/p&gt;</comment>
                            <comment id="13281726" author="zhihyu@ebaysf.com" created="Wed, 23 May 2012 17:05:00 +0000"  >&lt;p&gt;Will integrate patch v2 later today if there is no objection.&lt;/p&gt;</comment>
                            <comment id="13281868" author="zhihyu@ebaysf.com" created="Wed, 23 May 2012 20:18:31 +0000"  >&lt;p&gt;Integrated to 0.94 and trunk.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Chunhui.&lt;/p&gt;

&lt;p&gt;Thanks for the review, Ramkrishna.&lt;/p&gt;</comment>
                            <comment id="13281927" author="hudson" created="Wed, 23 May 2012 21:24:16 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #212 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/212/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/212/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6065&quot; title=&quot;Log for flush would append a non-sequential edit in the hlog, leading to possible data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6065&quot;&gt;&lt;del&gt;HBASE-6065&lt;/del&gt;&lt;/a&gt; Log for flush would append a non-sequential edit in the hlog, leading to possible data loss (Chunhui) (Revision 1342017)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13281977" author="hudson" created="Wed, 23 May 2012 22:13:00 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2917 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2917/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2917/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6065&quot; title=&quot;Log for flush would append a non-sequential edit in the hlog, leading to possible data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6065&quot;&gt;&lt;del&gt;HBASE-6065&lt;/del&gt;&lt;/a&gt; Log for flush would append a non-sequential edit in the hlog, leading to possible data loss (Chunhui) (Revision 1342019)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13282091" author="hudson" created="Thu, 24 May 2012 01:02:15 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #15 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/15/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/15/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6065&quot; title=&quot;Log for flush would append a non-sequential edit in the hlog, leading to possible data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6065&quot;&gt;&lt;del&gt;HBASE-6065&lt;/del&gt;&lt;/a&gt; Log for flush would append a non-sequential edit in the hlog, leading to possible data loss (Chunhui) (Revision 1342019)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13284511" author="hudson" created="Mon, 28 May 2012 18:47:55 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2940 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2940/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2940/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6118&quot; title=&quot;Add a testcase for HBASE-6065&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6118&quot;&gt;&lt;del&gt;HBASE-6118&lt;/del&gt;&lt;/a&gt; Add a testcase for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6065&quot; title=&quot;Log for flush would append a non-sequential edit in the hlog, leading to possible data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6065&quot;&gt;&lt;del&gt;HBASE-6065&lt;/del&gt;&lt;/a&gt; (Ashutosh) (Revision 1343338)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13284516" author="hudson" created="Mon, 28 May 2012 19:00:48 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #222 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/222/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/222/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6118&quot; title=&quot;Add a testcase for HBASE-6065&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6118&quot;&gt;&lt;del&gt;HBASE-6118&lt;/del&gt;&lt;/a&gt; Add a testcase for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6065&quot; title=&quot;Log for flush would append a non-sequential edit in the hlog, leading to possible data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6065&quot;&gt;&lt;del&gt;HBASE-6065&lt;/del&gt;&lt;/a&gt; (Ashutosh) (Revision 1343336)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13284584" author="hudson" created="Tue, 29 May 2012 00:00:53 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #30 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/30/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/30/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6118&quot; title=&quot;Add a testcase for HBASE-6065&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6118&quot;&gt;&lt;del&gt;HBASE-6118&lt;/del&gt;&lt;/a&gt; Add a testcase for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6065&quot; title=&quot;Log for flush would append a non-sequential edit in the hlog, leading to possible data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6065&quot;&gt;&lt;del&gt;HBASE-6065&lt;/del&gt;&lt;/a&gt; (Ashutosh) (Revision 1343338)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13284690" author="lhofhansl" created="Tue, 29 May 2012 09:29:13 +0000"  >&lt;p&gt;Sorry for coming in late here. Was busy with HBaseCon, day after hack-a-thon and then traveling to Germany.&lt;/p&gt;

&lt;p&gt;Looking back through this issue, I agree with Ram. We should never write edits non-sequentially into the HLogs (or ignore cache flush meta edit).&lt;br/&gt;
I imagine there is other code that scans through an HLog that might get confused about non sequential edits.&lt;/p&gt;</comment>
                            <comment id="13284692" author="lhofhansl" created="Tue, 29 May 2012 09:30:02 +0000"  >&lt;p&gt;Lastly, since this can lose data, I think this warrants a 0.94.1 release soon.&lt;/p&gt;</comment>
                            <comment id="13287170" author="hudson" created="Fri, 1 Jun 2012 05:42:54 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #33 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/33/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/33/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6118&quot; title=&quot;Add a testcase for HBASE-6065&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6118&quot;&gt;&lt;del&gt;HBASE-6118&lt;/del&gt;&lt;/a&gt; Add a testcase for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6065&quot; title=&quot;Log for flush would append a non-sequential edit in the hlog, leading to possible data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6065&quot;&gt;&lt;del&gt;HBASE-6065&lt;/del&gt;&lt;/a&gt; (Ashutosh) (Revision 1343336)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12558337">HBASE-6118</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12528549" name="HBASE-6065.patch" size="866" author="zjushch" created="Tue, 22 May 2012 03:44:36 +0000"/>
                            <attachment id="12528556" name="HBASE-6065v2.patch" size="1070" author="zjushch" created="Tue, 22 May 2012 05:21:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 22 May 2012 04:00:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245420</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 29 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i068ev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34294</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>