<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:47:14 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7594/HBASE-7594.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7594] TestLocalHBaseCluster failing on ubuntu2</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7594</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.io.IOException: java.io.IOException: java.io.IOException: java.lang.InstantiationException: org.apache.hadoop.io.RawComparator
	at org.apache.hadoop.hbase.regionserver.HRegion.initializeRegionInternals(HRegion.java:612)
	at org.apache.hadoop.hbase.regionserver.HRegion.initialize(HRegion.java:533)
	at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4092)
	at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4042)
	at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.openRegion(OpenRegionHandler.java:427)
	at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.process(OpenRegionHandler.java:130)
	at org.apache.hadoop.hbase.executor.EventHandler.run(EventHandler.java:202)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.io.IOException: java.io.IOException: java.lang.InstantiationException: org.apache.hadoop.io.RawComparator
	at org.apache.hadoop.hbase.regionserver.HStore.loadStoreFiles(HStore.java:450)
	at org.apache.hadoop.hbase.regionserver.HStore.&amp;lt;init&amp;gt;(HStore.java:215)
	at org.apache.hadoop.hbase.regionserver.HRegion.instantiateHStore(HRegion.java:3060)
	at org.apache.hadoop.hbase.regionserver.HRegion$1.call(HRegion.java:585)
	at org.apache.hadoop.hbase.regionserver.HRegion$1.call(HRegion.java:583)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	... 3 more
Caused by: java.io.IOException: java.lang.InstantiationException: org.apache.hadoop.io.RawComparator
	at org.apache.hadoop.hbase.io.hfile.FixedFileTrailer.createComparator(FixedFileTrailer.java:607)
	at org.apache.hadoop.hbase.io.hfile.FixedFileTrailer.createComparator(FixedFileTrailer.java:615)
	at org.apache.hadoop.hbase.io.hfile.HFileReaderV2.&amp;lt;init&amp;gt;(HFileReaderV2.java:115)
	at org.apache.hadoop.hbase.io.hfile.HFile.pickReaderVersion(HFile.java:564)
	at org.apache.hadoop.hbase.io.hfile.HFile.createReaderWithEncoding(HFile.java:599)
	at org.apache.hadoop.hbase.regionserver.StoreFile$Reader.&amp;lt;init&amp;gt;(StoreFile.java:1294)
	at org.apache.hadoop.hbase.regionserver.StoreFile.open(StoreFile.java:525)
	at org.apache.hadoop.hbase.regionserver.StoreFile.createReader(StoreFile.java:628)
	at org.apache.hadoop.hbase.regionserver.HStore$1.call(HStore.java:426)
	at org.apache.hadoop.hbase.regionserver.HStore$1.call(HStore.java:422)
	... 8 more
Caused by: java.lang.InstantiationException: org.apache.hadoop.io.RawComparator
	at java.lang.Class.newInstance0(Class.java:340)
	at java.lang.Class.newInstance(Class.java:308)
	at org.apache.hadoop.hbase.io.hfile.FixedFileTrailer.createComparator(FixedFileTrailer.java:605)
	... 17 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12627949">HBASE-7594</key>
            <summary>TestLocalHBaseCluster failing on ubuntu2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Jan 2013 23:36:55 +0000</created>
                <updated>Mon, 23 Sep 2013 18:30:17 +0000</updated>
                            <resolved>Wed, 23 Jan 2013 19:49:27 +0000</resolved>
                                    <version>0.95.2</version>
                                    <fixVersion>0.95.0</fixVersion>
                                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13555641" author="apurtell" created="Thu, 17 Jan 2013 00:09:46 +0000"  >&lt;p&gt;I&apos;ve tested this test individually with a script that runs it 100 times locally using both 6u37 and 7u10 and don&apos;t see this failure, but I have not run the full suite that many times.&lt;/p&gt;</comment>
                            <comment id="13555653" author="apurtell" created="Thu, 17 Jan 2013 00:18:15 +0000"  >&lt;p&gt;Looks like a failure specific to ubuntu2?&lt;/p&gt;

&lt;p&gt;Going back a few builds on &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/&lt;/a&gt;, TestLocalHBaseCluster passes until it gets to 3755 on ubuntu2 and fails. Then the next build is aborted. Then the next build back is on ubuntu1 and is good. More builds on ubuntu1,3,4 pass further back until back on ubuntu2 for build 3750. Then it passes again in 3749 because the build is on ubuntu1. More builds on ubuntu1,3,4 pass until build 3745, when it is again back on ubuntu2.&lt;/p&gt;</comment>
                            <comment id="13555768" author="zjushch" created="Thu, 17 Jan 2013 02:34:10 +0000"  >&lt;p&gt;I have noticed this failure since we committed &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7414&quot; title=&quot;Convert some HFile metadata to PB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7414&quot;&gt;&lt;del&gt;HBASE-7414&lt;/del&gt;&lt;/a&gt;. I&apos;m not sure whether they are related. FYI&lt;/p&gt;

&lt;p&gt;The first failure in PreCommit-build is&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3923/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3923/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Another problem in recent PreCommit-build:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Build step &apos;Execute shell&apos; marked build as failure
Archiving artifacts
Recording test results
ERROR: Failed to archive test reports
...
Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.util.Arrays.copyOfRange(Arrays.java:3209)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13555784" author="apurtell" created="Thu, 17 Jan 2013 03:07:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;I have noticed this failure since we committed &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7414&quot; title=&quot;Convert some HFile metadata to PB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7414&quot;&gt;&lt;del&gt;HBASE-7414&lt;/del&gt;&lt;/a&gt;. I&apos;m not sure whether they are related. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes I have noticed this too but as I have stated several times this is not reproducable locally nor apparently on any other host than ubuntu2. While I am concerned about it, I am not in favor of a revert. I think anyone who wants to revert &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7414&quot; title=&quot;Convert some HFile metadata to PB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7414&quot;&gt;&lt;del&gt;HBASE-7414&lt;/del&gt;&lt;/a&gt; it is incumbent to demonstrate the patch is actually in error. Then I will happily do it, and fix it.&lt;/p&gt;</comment>
                            <comment id="13555798" author="apurtell" created="Thu, 17 Jan 2013 03:18:00 +0000"  >&lt;p&gt;The next steps I plan to take on this jira are:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Create a test branch&lt;/li&gt;
	&lt;li&gt;Create a Jenkins job that only runs on ubuntu2&lt;/li&gt;
	&lt;li&gt;Commit some patches for aiding debugging to the test branch&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13555876" author="stack" created="Thu, 17 Jan 2013 05:30:16 +0000"  >&lt;p&gt;Why bother creating a test branch?  Just commit your debugging Andrew to trunk?&lt;/p&gt;

&lt;p&gt;I wonder if you instantiate that Comparator before cluster.startup in TestLocalHBaseCluster?&lt;/p&gt;

&lt;p&gt;So something about the way we have these Master and RegionServer subclasses in TestLHC is messing us up, like their classloader won&apos;t allow us load from the hadoop jar.&lt;/p&gt;

&lt;p&gt;It is a medium test so it is forking IIRC.  What if you made it a small test &amp;#8211; they all run in the one jvm.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://docs.oracle.com/javase/6/docs/api/java/lang/InstantiationException.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://docs.oracle.com/javase/6/docs/api/java/lang/InstantiationException.html&lt;/a&gt; says:&lt;/p&gt;

&lt;p&gt;the class object represents an abstract class, an interface, an array class, a primitive type, or void&lt;br/&gt;
the class has no nullary constructor&lt;/p&gt;

&lt;p&gt;Its a good one.&lt;/p&gt;</comment>
                            <comment id="13555882" author="apurtell" created="Thu, 17 Jan 2013 05:40:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why bother creating a test branch? Just commit your debugging Andrew to trunk?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Could do that. The notion was to avoid polluting trunk history. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I wonder if you instantiate that Comparator before cluster.startup in TestLocalHBaseCluster?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I was thinking of making the static assignment in fixedfiletrailer an instantiable class. Could just be treating the symptom. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It is a medium test so it is forking IIRC. What if you made it a small test &#8211; they all run in the one jvm.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good idea.&lt;/p&gt;</comment>
                            <comment id="13558015" author="yuzhihong@gmail.com" created="Sat, 19 Jan 2013 14:49:28 +0000"  >&lt;p&gt;I saw the following on my Mac when TestLocalHBaseCluster picked up local data from preivous (other) test runs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-01-19 06:37:06,649 INFO  [Master:0;192.168.0.23,62776,1358606221236] master.SplitLogManager(858): found 0 orphan tasks and 0 rescan nodes
WARNING! File system needs to be upgraded.  You have version &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; and I want version 7.  Run the &apos;${HBASE_HOME}/bin/hbase migrate&apos; script.
2013-01-19 06:37:06,677 FATAL [Master:0;192.168.0.23,62776,1358606221236] master.HMaster(1924): Unhandled exception. Starting shutdown.
org.apache.hadoop.hbase.util.FileSystemVersionException: File system needs to be upgraded.  You have version &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; and I want version 7.  Run the &apos;${HBASE_HOME}/bin/hbase migrate&apos; script.
  at org.apache.hadoop.hbase.util.FSUtils.checkVersion(FSUtils.java:391)
  at org.apache.hadoop.hbase.master.MasterFileSystem.checkRootDir(MasterFileSystem.java:409)
  at org.apache.hadoop.hbase.master.MasterFileSystem.createInitialFileSystemLayout(MasterFileSystem.java:147)
  at org.apache.hadoop.hbase.master.MasterFileSystem.&amp;lt;init&amp;gt;(MasterFileSystem.java:131)
  at org.apache.hadoop.hbase.master.HMaster.finishInitialization(HMaster.java:655)
  at org.apache.hadoop.hbase.master.HMaster.run(HMaster.java:476)
  at org.apache.hadoop.hbase.TestLocalHBaseCluster$MyHMaster.run(TestLocalHBaseCluster.java:99)
  at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:680)
2013-01-19 06:37:06,678 INFO  [Master:0;192.168.0.23,62776,1358606221236] master.HMaster(2096): Aborting
2013-01-19 06:37:06,679 DEBUG [Master:0;192.168.0.23,62776,1358606221236] master.HMaster(1078): Stopping service threads
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;After clearing /tmp/hbase-tyu/hbase, TestLocalHBaseCluster passes.&lt;/p&gt;</comment>
                            <comment id="13558109" author="stack" created="Sat, 19 Jan 2013 22:33:10 +0000"  >&lt;p&gt;That seems like a sensible exception if reading data from a different version.&lt;/p&gt;

&lt;p&gt;Its not what we are seeing on jenkins though.&lt;/p&gt;</comment>
                            <comment id="13558153" author="apurtell" created="Sun, 20 Jan 2013 03:28:36 +0000"  >&lt;p&gt;I was roped in on some stuff the past couple of days, I&apos;ll get to this Monday.&lt;/p&gt;</comment>
                            <comment id="13559042" author="apurtell" created="Mon, 21 Jan 2013 20:05:29 +0000"  >&lt;p&gt;Treat the symptom.&lt;/p&gt;</comment>
                            <comment id="13559046" author="stack" created="Mon, 21 Jan 2013 20:07:17 +0000"  >&lt;p&gt;go for it&lt;/p&gt;</comment>
                            <comment id="13559072" author="hadoopqa" created="Mon, 21 Jan 2013 20:32:35 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12565838/7594-1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12565838/7594-1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.io.hfile.TestHFile&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4116//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13559147" author="apurtell" created="Mon, 21 Jan 2013 21:59:39 +0000"  >&lt;p&gt;The instantiation check flagged TestHFile as doing something bogus. This is interesting. TestHFile#testComparator creates an anonymous class which does not have a nullary constructor so cannot be instantiated. See this disassembly with javap:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Compiled from &quot;TestHFile.java&quot;
class org.apache.hadoop.hbase.io.hfile.TestHFile$2 extends org.apache.hadoop.hbase.KeyValue$KeyComparator{
final org.apache.hadoop.hbase.io.hfile.TestHFile this$0;
  Signature: Lorg/apache/hadoop/hbase/io/hfile/TestHFile;
org.apache.hadoop.hbase.io.hfile.TestHFile$2(org.apache.hadoop.hbase.io.hfile.TestHFile);
  Signature: (Lorg/apache/hadoop/hbase/io/hfile/TestHFile;)V
public int compare(byte[], int, int, byte[], int, int);
  Signature: ([BII[BII)I
public int compare(byte[], byte[]);
  Signature: ([B[B)I
public int compare(java.lang.Object, java.lang.Object);
  Signature: (Ljava/lang/Object;Ljava/lang/Object;)I
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note the constructor.&lt;/p&gt;

&lt;p&gt;This minor change to TestHFile fixes the problem locally:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;--- hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFile.java	(revision 1436569)
+++ hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFile.java	(working copy)
@@ -347,21 +347,25 @@
     assertTrue(Compression.Algorithm.LZ4.ordinal() == 4);
   }
 
+  // This can&apos;t be an anonymous class because the compiler will not generate
+  // a nullary constructor for it.
+  static class CustomKeyComparator extends KeyComparator {
+    @Override
+    public int compare(byte[] b1, int s1, int l1, byte[] b2, int s2,
+        int l2) {
+      return -Bytes.compareTo(b1, s1, l1, b2, s2, l2);
+    }
+    @Override
+    public int compare(byte[] o1, byte[] o2) {
+      return compare(o1, 0, o1.length, o2, 0, o2.length);
+    }
+  }
+
   public void testComparator() throws IOException {
     if (cacheConf == null) cacheConf = new CacheConfig(conf);
     Path mFile = new Path(ROOT_DIR, &quot;meta.tfile&quot;);
     FSDataOutputStream fout = createFSOutput(mFile);
-    KeyComparator comparator = new KeyComparator() {
-      @Override
-      public int compare(byte[] b1, int s1, int l1, byte[] b2, int s2,
-          int l2) {
-        return -Bytes.compareTo(b1, s1, l1, b2, s2, l2);
-      }
-      @Override
-      public int compare(byte[] o1, byte[] o2) {
-        return compare(o1, 0, o1.length, o2, 0, o2.length);
-      }
-    };
+    KeyComparator comparator = new CustomKeyComparator();
     Writer writer = HFile.getWriterFactory(conf, cacheConf)
         .withOutputStream(fout)
         .withBlockSize(minBlockSize)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Will update the patch to include this and try again.&lt;/p&gt;</comment>
                            <comment id="13559156" author="stack" created="Mon, 21 Jan 2013 22:06:28 +0000"  >&lt;p&gt;Nice find Andrew.  +1&lt;/p&gt;</comment>
                            <comment id="13559189" author="hadoopqa" created="Mon, 21 Jan 2013 22:54:42 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12565861/7594-2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12565861/7594-2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestLocalHBaseCluster&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4119//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13559191" author="apurtell" created="Mon, 21 Jan 2013 23:01:26 +0000"  >&lt;p&gt;Precommit builds don&apos;t save individual test results so I can&apos;t get the detailed output of the test. I don&apos;t have Jenkins karma to change this configuration. Would be good to change this so I don&apos;t have to check stuff in on trunk.&lt;/p&gt;</comment>
                            <comment id="13559420" author="apurtell" created="Tue, 22 Jan 2013 06:08:34 +0000"  >&lt;p&gt;v3 patch removes where comparatorClassName is set directly and instead assigns through setComparatorClass, which does an instantiation check. Might catch the problem earlier. Needs precommit builds to save test logs.&lt;/p&gt;</comment>
                            <comment id="13559735" author="hadoopqa" created="Tue, 22 Jan 2013 16:08:34 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12565909/7594-3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12565909/7594-3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.constraint.TestConstraint&lt;br/&gt;
                  org.apache.hadoop.hbase.TestLocalHBaseCluster&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4124//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13559877" author="apurtell" created="Tue, 22 Jan 2013 18:55:14 +0000"  >&lt;p&gt;Really treat the symptom this time, see what else fails.&lt;/p&gt;</comment>
                            <comment id="13559922" author="stack" created="Tue, 22 Jan 2013 19:39:42 +0000"  >&lt;p&gt;I just enabled saving test output.  Hopefully will show up in future builds.&lt;/p&gt;</comment>
                            <comment id="13559944" author="hadoopqa" created="Tue, 22 Jan 2013 19:56:02 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12565988/7594-4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12565988/7594-4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestLocalHBaseCluster&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4128//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13559957" author="apurtell" created="Tue, 22 Jan 2013 20:05:11 +0000"  >&lt;p&gt;Thanks. Now we can see what&apos;s actually going on after treating the symptom in FixedFileTrailer:&lt;/p&gt;

&lt;p&gt;I&apos;m guessing a &amp;lt; v2 HFile is being opened as a v2? Hence the trouble with the comparator. &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2013-01-22 19:42:47,914 ERROR [RS_OPEN_ROOT-asf000.sp2.ygridcore.net,40563,1358883761837-0] handler.OpenRegionHandler(443): Failed open of region=-ROOT-,,0.70236052, starting to roll back the global memstore size.
java.io.IOException: java.io.IOException: java.io.IOException: Expected block of type ROOT_INDEX but found DATA
	at org.apache.hadoop.hbase.regionserver.HRegion.initializeRegionInternals(HRegion.java:616)
	at org.apache.hadoop.hbase.regionserver.HRegion.initialize(HRegion.java:537)
	at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4033)
	at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:3983)
	at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.openRegion(OpenRegionHandler.java:427)
	at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.process(OpenRegionHandler.java:130)
	at org.apache.hadoop.hbase.executor.EventHandler.run(EventHandler.java:202)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:662)
Caused by: java.io.IOException: java.io.IOException: Expected block of type ROOT_INDEX but found DATA
	at org.apache.hadoop.hbase.regionserver.HStore.loadStoreFiles(HStore.java:466)
	at org.apache.hadoop.hbase.regionserver.HStore.&amp;lt;init&amp;gt;(HStore.java:220)
	at org.apache.hadoop.hbase.regionserver.HRegion.instantiateHStore(HRegion.java:3016)
	at org.apache.hadoop.hbase.regionserver.HRegion$1.call(HRegion.java:589)
	at org.apache.hadoop.hbase.regionserver.HRegion$1.call(HRegion.java:587)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	... 3 more
Caused by: java.io.IOException: Expected block of type ROOT_INDEX but found DATA
	at org.apache.hadoop.hbase.io.hfile.HFileBlock$AbstractFSReader$1.nextBlockWithBlockType(HFileBlock.java:1215)
	at org.apache.hadoop.hbase.io.hfile.HFileReaderV2.&amp;lt;init&amp;gt;(HFileReaderV2.java:129)
	at org.apache.hadoop.hbase.io.hfile.HFile.pickReaderVersion(HFile.java:564)
	at org.apache.hadoop.hbase.io.hfile.HFile.createReaderWithEncoding(HFile.java:599)
	at org.apache.hadoop.hbase.regionserver.StoreFile$Reader.&amp;lt;init&amp;gt;(StoreFile.java:1294)
	at org.apache.hadoop.hbase.regionserver.StoreFile.open(StoreFile.java:525)
	at org.apache.hadoop.hbase.regionserver.StoreFile.createReader(StoreFile.java:628)
	at org.apache.hadoop.hbase.regionserver.HStore$1.call(HStore.java:442)
	at org.apache.hadoop.hbase.regionserver.HStore$1.call(HStore.java:438)
	... 8 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So this is crapping out trying to open some store file previously flushed for &lt;del&gt;ROOT&lt;/del&gt;. Detritus from an earlier test?&lt;/p&gt;

&lt;p&gt;Right above we can see it&apos;s using /tmp/hbase-jenkins:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2013-01-22 19:42:47,811 DEBUG [RS_OPEN_ROOT-asf000.sp2.ygridcore.net,40563,1358883761837-0] wal.SequenceFileLogWriter(193): Path=file:/tmp/hbase-jenkins/hbase/.logs/asf000.sp2.ygridcore.net,40563,1358883761837/asf000.sp2.ygridcore.net%2C40563%2C1358883761837.1358883767809.meta, compression=false
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maybe picking up some junk.&lt;/p&gt;</comment>
                            <comment id="13559960" author="apurtell" created="Tue, 22 Jan 2013 20:07:12 +0000"  >&lt;p&gt;I have to head out for a bit but will try next a patch that fixes TestLocalHBaseCluster to not use /tmp/hbase-$&lt;/p&gt;
{user.name}
&lt;p&gt; as the data dir.&lt;/p&gt;</comment>
                            <comment id="13559961" author="apurtell" created="Tue, 22 Jan 2013 20:08:25 +0000"  >&lt;p&gt;By the way thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; for enabling this. Now we can throw things at Jenkins specials without needing to patch trunk, via patches on precommit builds.&lt;/p&gt;</comment>
                            <comment id="13560415" author="apurtell" created="Wed, 23 Jan 2013 06:08:22 +0000"  >&lt;p&gt;Patch v5 makes a minor change to HBaseTestingUtility to add a facility for creating a LocalHBaseCluster with custom master and regionserver classes by way of the HBaseTestingUtility methods. This way we get per-test data dirs set up for us, and HBaseTestingUtility uses LocalHBaseCluster internally anyway. Most of TestLocalHBaseCluster goes away. We also retain some of the changes in earlier patches that sets the default comparator in FixedFileTrailer to KeyComparator, validates that the comparator can be instantiated in FixedFileTrailer#setComparatorClass, and the fix to TestHFile described above.&lt;/p&gt;</comment>
                            <comment id="13560444" author="hadoopqa" created="Wed, 23 Jan 2013 07:07:26 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12566096/7594-5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12566096/7594-5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4144//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13560449" author="stack" created="Wed, 23 Jan 2013 07:29:15 +0000"  >&lt;p&gt;Wahoo!&lt;/p&gt;</comment>
                            <comment id="13561017" author="apurtell" created="Wed, 23 Jan 2013 19:49:27 +0000"  >&lt;p&gt;Committed v5 patch with a tiny change to update Javadoc in HBaseTestingUtility for the new method.&lt;/p&gt;</comment>
                            <comment id="13561086" author="hudson" created="Wed, 23 Jan 2013 21:07:05 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3785 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3785/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3785/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7594&quot; title=&quot;TestLocalHBaseCluster failing on ubuntu2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7594&quot;&gt;&lt;del&gt;HBASE-7594&lt;/del&gt;&lt;/a&gt;. TestLocalHBaseCluster failing on ubuntu2 (Revision 1437658)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/FixedFileTrailer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/TestLocalHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFile.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13561244" author="hudson" created="Wed, 23 Jan 2013 23:52:31 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #369 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/369/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/369/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7594&quot; title=&quot;TestLocalHBaseCluster failing on ubuntu2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7594&quot;&gt;&lt;del&gt;HBASE-7594&lt;/del&gt;&lt;/a&gt;. TestLocalHBaseCluster failing on ubuntu2 (Revision 1437658)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/FixedFileTrailer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/TestLocalHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFile.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13774886" author="stack" created="Mon, 23 Sep 2013 18:30:17 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12626697">HBASE-7522</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12565838" name="7594-1.patch" size="1538" author="apurtell" created="Mon, 21 Jan 2013 20:08:44 +0000"/>
                            <attachment id="12565861" name="7594-2.patch" size="3719" author="apurtell" created="Mon, 21 Jan 2013 22:00:24 +0000"/>
                            <attachment id="12565909" name="7594-3.patch" size="4521" author="apurtell" created="Tue, 22 Jan 2013 06:08:34 +0000"/>
                            <attachment id="12565988" name="7594-4.patch" size="6267" author="apurtell" created="Tue, 22 Jan 2013 18:55:14 +0000"/>
                            <attachment id="12566096" name="7594-5.patch" size="11549" author="apurtell" created="Wed, 23 Jan 2013 06:08:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 17 Jan 2013 02:34:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>304797</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17w13:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>254158</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>