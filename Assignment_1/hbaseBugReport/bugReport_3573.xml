<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:11:19 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3573/HBASE-3573.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3573] Move shutdown messaging OFF hearbeat; prereq for fix of hbase-1502</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3573</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description></description>
                <environment></environment>
        <key id="12499792">HBASE-3573</key>
            <summary>Move shutdown messaging OFF hearbeat; prereq for fix of hbase-1502</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Sat, 26 Feb 2011 07:26:30 +0000</created>
                <updated>Fri, 20 Nov 2015 12:43:58 +0000</updated>
                            <resolved>Tue, 1 Mar 2011 20:54:44 +0000</resolved>
                                                    <fixVersion>0.92.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12999736" author="stack" created="Sat, 26 Feb 2011 07:30:44 +0000"  >&lt;p&gt;I think moving this off of heartbeats should be easy enough; can read master memory state instead (I think).&lt;/p&gt;</comment>
                            <comment id="12999846" author="stack" created="Sat, 26 Feb 2011 21:27:19 +0000"  >&lt;p&gt;Here&apos;s a patch that removes the shutdown from  HMsg and instead has the master just wait till only catalog regions online.  I thought this would be enough but it isn&apos;t; current shutdown has RSs close regions w/o updating ZK so master is never &apos;informed&apos; about the closed regions.&lt;/p&gt;

&lt;p&gt;Next up is a patch that does what we currently do via heartbeat; i.e. master just waits till &amp;lt;=2 servers but instead of telling remote RS shutdown via heartbeat, will add new graceful_shutdown RCP... we need it for rolling restart anyways.&lt;/p&gt;</comment>
                            <comment id="13000537" author="stack" created="Mon, 28 Feb 2011 21:39:40 +0000"  >&lt;p&gt;Minimal patch.  If only servers carrying catalog regions online, send unassign of catalog regions.  Did not add new rpc for shutdown of individual regionserver.  Can do that elsewhere.&lt;/p&gt;

&lt;p&gt;Removes TestHMsg because HMsg has little left in it for test making.&lt;/p&gt;

&lt;p&gt;Review please.&lt;/p&gt;</comment>
                            <comment id="13000613" author="streamy" created="Tue, 1 Mar 2011 00:01:01 +0000"  >&lt;p&gt;not sure if it matters, but one check returns true if it the server holds a catalog region.  then another check uses that check to determine that the last two server &lt;b&gt;only&lt;/b&gt; hold catalogs.  so in that case, they could still be holding other user regions?&lt;/p&gt;</comment>
                            <comment id="13000622" author="stack" created="Tue, 1 Mar 2011 00:17:03 +0000"  >&lt;p&gt;Yeah.&lt;/p&gt;

&lt;p&gt;The notion is that we set the cluster shutdown flag then wait.  When regionservers notice the cluster shutdown flag, they will close their user regions.  Regionservers shut themselves down if all regions are closed and the cluster shutdown flag is set.  So, a regionserver carrying user regions only will just go shut itself down. Servers carrying catalog regions will stick around.  So, the cited check is just waiting till the only servers running are those carrying catalog regions. When we are in this state, the thinking is that near all user regions are closed.... so its safe to close out the catalog regions.&lt;/p&gt;

&lt;p&gt;So, yeah, they could be holding user regions but should be ok... the user regions are at least closed if not closed.  This is basically how shutdown currently works.  Trying to do minimal change for now.  Can come back and review shutdown process after the heartbeat removal (It might make sense having the close go via zk instead of skipping it as we currently do &amp;#8211; using bulk close facility) &lt;/p&gt;</comment>
                            <comment id="13000654" author="streamy" created="Tue, 1 Mar 2011 01:31:41 +0000"  >&lt;p&gt;Yeah, that all makes sense.  Just making sure that&apos;s what you intended.  +1 if tests pass and you tried it up on cluster.&lt;/p&gt;</comment>
                            <comment id="13001110" author="stack" created="Tue, 1 Mar 2011 20:54:44 +0000"  >&lt;p&gt;I tried it up on cluster and it seems to be working.  All tests pass for me locally (Hudson has some flakeyness going on  &amp;#8211; need to dig in, presuming not related).&lt;/p&gt;

&lt;p&gt;Am going to go for 1502 next, the total remove of heartbeats.&lt;/p&gt;</comment>
                            <comment id="13001111" author="stack" created="Tue, 1 Mar 2011 20:54:56 +0000"  >&lt;p&gt;Oh, thanks for reviews jgray.&lt;/p&gt;</comment>
                            <comment id="13002418" author="hudson" created="Fri, 4 Mar 2011 02:55:00 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #1767 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/HBase-TRUNK/1767/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/HBase-TRUNK/1767/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="15017668" author="lars_francke" created="Fri, 20 Nov 2015 12:43:58 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12427420">HBASE-1502</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12472239" name="3573.txt" size="4083" author="stack" created="Mon, 28 Feb 2011 21:39:40 +0000"/>
                            <attachment id="12472076" name="3573.txt" size="12074" author="stack" created="Sat, 26 Feb 2011 21:27:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 1 Mar 2011 00:01:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33094</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hmu7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100962</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>