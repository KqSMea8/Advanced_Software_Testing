<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:27:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5418/HBASE-5418.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5418] use different memstoreTS for different operations in the same RowMutation.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5418</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Assigning different memstoreTS will enable us to guarantee that the&lt;br/&gt;
operations will appear to take effect, along the same order, in which&lt;br/&gt;
they were added to create the RowMutation.&lt;/p&gt;

&lt;p&gt;Based on the diff after renaming to RowMutations.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12542951">HBASE-5418</key>
            <summary>use different memstoreTS for different operations in the same RowMutation.</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12499999">HBASE-3584</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="amitanand">Amitanand Aiyer</assignee>
                                    <reporter username="amitanand">Amitanand Aiyer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Feb 2012 22:15:42 +0000</created>
                <updated>Tue, 23 Apr 2013 23:21:09 +0000</updated>
                                                                            <component>Client</component>
                    <component>Coprocessors</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13209818" author="phabricator@reviews.facebook.net" created="Thu, 16 Feb 2012 22:28:58 +0000"  >&lt;p&gt;aaiyer requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5418&quot; title=&quot;use different memstoreTS for different operations in the same RowMutation.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5418&quot;&gt;HBASE-5418&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; use different memstoreTS for different operations in the same RowMutation.&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5418&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-5418&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Use different memstoreTS for distinct operations in the same RowMutation.&lt;/p&gt;

&lt;p&gt;  Assigning different memstoreTS will enable us to guarantee that the&lt;br/&gt;
  operations will appear to take effect, along the same order, in which&lt;br/&gt;
  they were added to create the RowMutation.&lt;/p&gt;

&lt;p&gt;  Based on the diff after renaming to RowMutations.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1761&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1761&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConsistencyControl.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/3753/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/3753/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13209906" author="phabricator@reviews.facebook.net" created="Fri, 17 Feb 2012 00:13:59 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5418&quot; title=&quot;use different memstoreTS for different operations in the same RowMutation.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5418&quot;&gt;HBASE-5418&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; use different memstoreTS for different operations in the same RowMutation.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java:4245 Should ctr be lifted to above the try block so that we only call mvcc.completeMemstoreInsert() for the WriteEntry&apos;s we actually touched ?&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConsistencyControl.java:121 Should we simplify beginMemstoreInsert() by letting it call this new method ?&lt;br/&gt;
  This would allow maintaining one method instead of two in case we add something in the future.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1761&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1761&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13210072" author="lhofhansl" created="Fri, 17 Feb 2012 05:43:36 +0000"  >&lt;p&gt;This would address some (but not all) of my concerns with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5241&quot; title=&quot;Deletes should not mask Puts that come after it.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5241&quot;&gt;HBASE-5241&lt;/a&gt;.&lt;br/&gt;
I still find the notion that we have an order that is different from the one implied by the timestamps &quot;dangerous&quot;, especially because the sort order of the KVs is not according to the memstoreTSs.&lt;/p&gt;</comment>
                            <comment id="13219654" author="phabricator@reviews.facebook.net" created="Wed, 29 Feb 2012 23:33:54 +0000"  >&lt;p&gt;aaiyer has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5418&quot; title=&quot;use different memstoreTS for different operations in the same RowMutation.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5418&quot;&gt;HBASE-5418&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; use different memstoreTS for different operations in the same RowMutation.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java:4245 I think we should completeMemstoreInsert for all the writeEntries, regardless of weather they suceed or not.&lt;/p&gt;

&lt;p&gt;  If we do not call completeMemstoreInsert (for a incomplete operation), then none of the puts/deletes that start after that operation can ever complete.&lt;/p&gt;

&lt;p&gt;  As long as we are &quot;totally giving up&quot; on retrying the operation, technically, it should be fine to call completeMemstoreInsert. All it does, as far as I can tell, is to remove the writeEntry from the list of &quot;current writes&quot;.&lt;/p&gt;

&lt;p&gt;  (Although, from code inspection, it seems unlikely why one will suceed and the other does not &amp;#8212; because applyFamilyMapToMemstore does not seem to throw exceptions).&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1761&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1761&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13219655" author="phabricator@reviews.facebook.net" created="Wed, 29 Feb 2012 23:33:55 +0000"  >&lt;p&gt;aaiyer has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5418&quot; title=&quot;use different memstoreTS for different operations in the same RowMutation.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5418&quot;&gt;HBASE-5418&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; use different memstoreTS for different operations in the same RowMutation.&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConsistencyControl.java:121 I&apos;ll do that.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1761&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1761&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13234588" author="lhofhansl" created="Wed, 21 Mar 2012 17:50:17 +0000"  >&lt;p&gt;Moving out of 0.94.&lt;/p&gt;</comment>
                            <comment id="13639814" author="stack" created="Tue, 23 Apr 2013 23:21:09 +0000"  >&lt;p&gt;Moving issue w/ no movement out of 0.95&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12514900" name="ASF.LICENSE.NOT.GRANTED--HBASE-5418.D1761.1.patch" size="2782" author="phabricator@reviews.facebook.net" created="Thu, 16 Feb 2012 22:28:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 16 Feb 2012 22:28:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228237</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 34 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0htdr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102022</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>