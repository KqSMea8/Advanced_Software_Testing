<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:34:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6134/HBASE-6134.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6134] Improvement for split-worker to speed up distributed log splitting</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6134</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;First&#65292;we do the test between local-master-splitting and distributed-log-splitting&lt;/p&gt;

&lt;p&gt;Environment&#65306;34 hlog files, 5 regionservers,(after kill one, only 4 rs do ths splitting work), 400 regions in one hlog file&lt;/p&gt;

&lt;p&gt;local-master-split:60s+&lt;br/&gt;
distributed-log-splitting:165s+&lt;/p&gt;

&lt;p&gt;In fact, in our production environment, distributed-log-splitting also took 60s with 30 regionservers for 34 hlog files (regionserver may be in high load)&lt;/p&gt;

&lt;p&gt;We found split-worker split one log file took about 20s&lt;br/&gt;
(30ms~50ms per writer.close(); 10ms per create writers )&lt;/p&gt;

&lt;p&gt;I think we could do the improvement for this:&lt;br/&gt;
Parallelizing the create and close writers in threads&lt;/p&gt;

&lt;p&gt;In the patch, change the logic for  distributed-log-splitting same as the local-master-splitting and parallelizing the close in threads.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12558546">HBASE-6134</key>
            <summary>Improvement for split-worker to speed up distributed log splitting</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zjushch">chunhui shen</assignee>
                                    <reporter username="zjushch">chunhui shen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 May 2012 06:33:38 +0000</created>
                <updated>Mon, 23 Sep 2013 18:31:33 +0000</updated>
                            <resolved>Thu, 14 Jun 2012 06:31:01 +0000</resolved>
                                                    <fixVersion>0.95.0</fixVersion>
                                    <component>wal</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>22</watches>
                                                                <comments>
                            <comment id="13285442" author="zhihyu@ebaysf.com" created="Wed, 30 May 2012 06:59:05 +0000"  >&lt;p&gt;So your suggestion is to estimate log splitting duration based on number of HLog files ?&lt;br/&gt;
If the estimate is low, we stay with master log splitting.&lt;/p&gt;</comment>
                            <comment id="13285496" author="zjushch" created="Wed, 30 May 2012 08:21:50 +0000"  >&lt;p&gt;@ted&lt;/p&gt;

&lt;p&gt;In my opition, we could do the improvement for split-worker.&lt;/p&gt;


&lt;p&gt;In the patch , I change the split logic which executed by the split-worker same as local-master-split.&lt;/p&gt;

&lt;p&gt;It means, there are multi threads to creater writer and append hlog entry.&lt;/p&gt;

&lt;p&gt;Also, we found closing writer is quite slow, so make the closeStreams() executed by multi threads.&lt;/p&gt;

&lt;p&gt;With the patch, we test the time of distribued split log again, and reduce the time from 165s+ to 38s+&lt;br/&gt;
(34hlog files 4 regionervers)&lt;/p&gt;</comment>
                            <comment id="13285498" author="zjushch" created="Wed, 30 May 2012 08:24:59 +0000"  >&lt;p&gt;Review Board &lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5294/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5294/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13285502" author="ram_krish" created="Wed, 30 May 2012 08:27:27 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
Nice work.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Also, we found closing writer is quite slow&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Any reason why it was slow?&lt;/p&gt;</comment>
                            <comment id="13285511" author="zjushch" created="Wed, 30 May 2012 08:44:11 +0000"  >&lt;p&gt;@ram&lt;br/&gt;
Through the log, we found writer.close() took about 30ms~50ms.&lt;/p&gt;

&lt;p&gt;So, it will took about 20s if there are 400 regions in one hlog file.&lt;/p&gt;</comment>
                            <comment id="13285513" author="zjushch" created="Wed, 30 May 2012 08:47:20 +0000"  >&lt;p&gt;@ram&lt;br/&gt;
Could you take a look at your environment, hom much time writer.close() took?&lt;/p&gt;

&lt;p&gt;Through the log:&lt;br/&gt;
LOG.info(&quot;Closed path &quot; + wap.p + &quot; (wrote &quot; + wap.editsWritten&lt;br/&gt;
                + &quot; edits in &quot; + (wap.nanosSpent / 1000 / 1000) + &quot;ms)&quot;); &lt;/p&gt;</comment>
                            <comment id="13285515" author="ram_krish" created="Wed, 30 May 2012 08:51:51 +0000"  >&lt;p&gt;Ok.  I will check that but may not be today. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13285623" author="hadoopqa" created="Wed, 30 May 2012 12:37:09 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12530177/HBASE-6134.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12530177/HBASE-6134.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to cause Findbugs (version 1.3.9) to fail.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.wal.TestWALReplayCompressed&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestWALReplay&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2051//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2051//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2051//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2051//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13285891" author="zhihyu@ebaysf.com" created="Wed, 30 May 2012 18:39:54 +0000"  >&lt;p&gt;Test failed with NPE at:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (FileStatus fileStatus : listStatus1) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Checking for null wouldn&apos;t help either:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Failed tests:   testSequentialEditLogSeqNum(org.apache.hadoop.hbase.regionserver.wal.TestWALReplay): The sequence number of the recoverd.edits and the current edit seq should be same expected:&amp;lt;17&amp;gt; but was:&amp;lt;0&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13285923" author="stack" created="Wed, 30 May 2012 19:06:40 +0000"  >&lt;p&gt;Marking critical.  This improves our MTTR.&lt;/p&gt;</comment>
                            <comment id="13286294" author="zjushch" created="Thu, 31 May 2012 03:52:31 +0000"  >&lt;p&gt;Updating patch to pass the failed test case(org.apache.hadoop.hbase.regionserver.wal.TestWALReplayCompressed&lt;br/&gt;
org.apache.hadoop.hbase.regionserver.wal.TestWALReplay&lt;br/&gt;
)&lt;br/&gt;
and fetching ted&apos;s review comments in.&lt;/p&gt;</comment>
                            <comment id="13286313" author="hadoopqa" created="Thu, 31 May 2012 04:43:29 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12530321/HBASE-6134v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12530321/HBASE-6134v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to cause Findbugs (version 1.3.9) to fail.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2070//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2070//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2070//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2070//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13286320" author="stack" created="Thu, 31 May 2012 05:02:17 +0000"  >&lt;p&gt;I added some comments over on rb on latest version of patch.&lt;/p&gt;</comment>
                            <comment id="13286366" author="zjushch" created="Thu, 31 May 2012 06:30:49 +0000"  >&lt;p&gt;In the patch v3,&lt;br/&gt;
Fetching stack&apos;s review comments,&lt;br/&gt;
Making new class DistributedLogSplittingHelper in HLogSplitter, &lt;br/&gt;
Putting method and variable in that class which are only used in distributed log splitting &lt;/p&gt;</comment>
                            <comment id="13286385" author="hadoopqa" created="Thu, 31 May 2012 07:23:44 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12530341/HBASE-6134v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12530341/HBASE-6134v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to cause Findbugs (version 1.3.9) to fail.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.coprocessor.TestClassLoading&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestHLog&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2074//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2074//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2074//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2074//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13286638" author="kannanm" created="Thu, 31 May 2012 15:04:10 +0000"  >&lt;p&gt;The SequenceFile writer does its own buffering. And so, my guess is that, at close time, the flushing of these buffers for every region&apos;s recovered.edits (SequenceFile) file is what is causing the close to be slow because it is serialized on these flushes and then DN reporting back to NN that it has received the blocks. Parallelizing the close in threads makes sense.&lt;/p&gt;

&lt;p&gt;Good catch Chunhui! May I request you to update the description for the JIRA with a summary of what the fix does, so it is useful for future readers of this JIRA.&lt;/p&gt;</comment>
                            <comment id="13286691" author="zhihyu@ebaysf.com" created="Thu, 31 May 2012 16:09:59 +0000"  >&lt;p&gt;From &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2074//testReport/org.apache.hadoop.hbase.regionserver.wal/TestHLog/testAppendClose/:&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2074//testReport/org.apache.hadoop.hbase.regionserver.wal/TestHLog/testAppendClose/:&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.net.BindException: Problem binding to localhost/127.0.0.1:55283 : Address already in use
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13289067" author="zjushch" created="Tue, 5 Jun 2012 01:37:20 +0000"  >&lt;p&gt;In the review board ,Prakash Khemani saied&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&quot;But the old code had a serious drawback &#8211; it would read the entire log file in memory before writing it out. Also the old code assumed that multiple log files were being split at the same time, but that is no longer true with distributed log splitting.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Whatever approach we take, I don&#8217;t think we should re-introduce buffering of the entire log file in memory.&quot;&lt;/p&gt;

&lt;p&gt;Since we set maximal buffer size 128MB, I don&apos;t know what effect would cause if using buffer. Anyway, splitting log happens infrequently.&lt;/p&gt;

&lt;p&gt;what others consider?&lt;/p&gt;
</comment>
                            <comment id="13289136" author="stack" created="Tue, 5 Jun 2012 04:13:25 +0000"  >&lt;p&gt;@Chunhui You are saying we only buffer 128M worth of the WAL, not the entire log file as Prakash says (You sure?  Do we not read it all up into memory to bucket it by region and then after that is done, then we start writing out the recovered.edits file?  I could be wrong &amp;#8211; going by memory).  If we are only using a 128M buffer flushing to the recovered.edits file as we go, then that&apos;d be fine I&apos;d say.   Are there other improvements to be had given the circumstance is now one reader only writing multiple files?  Good on you.&lt;/p&gt;</comment>
                            <comment id="13289155" author="anoopsamjohn" created="Tue, 5 Jun 2012 05:11:48 +0000"  >&lt;p&gt;From the patch and current HLogSplitter code I can see that 128M (def value) buffer only is used. From the WAL data is read into this buffer and parallel writers get data from buffer and write to appropriate recovered.edits file corresponding to region. Reading into the buffer and write by the writers done parallely like producer consumer.&lt;/p&gt;

&lt;p&gt;This way split happens when RS doing split for one file. If the same RS doing split of another file another HLogSplitter instance will be created for that which will contain another buffer. &lt;/p&gt;</comment>
                            <comment id="13289162" author="stack" created="Tue, 5 Jun 2012 05:29:45 +0000"  >&lt;p&gt;@Anoop So we flush to recovered.edits how often?  If each recovered.edits has a buffer of 16megs and we have 1000 recovered.edits that we have not yet flushed, can that happen?&lt;/p&gt;</comment>
                            <comment id="13289166" author="zjushch" created="Tue, 5 Jun 2012 05:36:06 +0000"  >&lt;p&gt;@stack&lt;br/&gt;
It won&apos;t happen.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;So we flush to recovered.edits how often?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Writers are flushing data all along&lt;/p&gt;</comment>
                            <comment id="13289168" author="zjushch" created="Tue, 5 Jun 2012 05:38:10 +0000"  >&lt;p&gt;Writers#doRun&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

      LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Writer thread &quot;&lt;/span&gt; + &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; + &lt;span class=&quot;code-quote&quot;&gt;&quot;: starting&quot;&lt;/span&gt;);
      &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;) {
        RegionEntryBuffer buffer = entryBuffers.getChunkToWrite();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (buffer == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
          &lt;span class=&quot;code-comment&quot;&gt;// No data currently available, wait on some more to show up
&lt;/span&gt;          &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (dataAvailable) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (shouldStop) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
              dataAvailable.wait(1000);
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException ie) {
              &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!shouldStop) {
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(ie);
              }
            }
          }
          &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
        }

        &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; buffer != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
          writeBuffer(buffer);
        } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
          entryBuffers.doneWriting(buffer);
        }
      }
    &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;entryBuffers.getChunkToWrite() won&apos;t return null as long as there is data in the buffer&lt;/p&gt;</comment>
                            <comment id="13289178" author="anoopsamjohn" created="Tue, 5 Jun 2012 05:59:51 +0000"  >&lt;p&gt;Yes agree with Chunhui&lt;br/&gt;
One buffer per HLogSplitter and one HLogSplitter instance per one log file that the RS is splitting.  Correct me if I am wrong Chunhui&lt;/p&gt;</comment>
                            <comment id="13292743" author="zjushch" created="Mon, 11 Jun 2012 10:45:33 +0000"  >&lt;p&gt;Create new review request &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://review.cloudera.org/r/2137/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://review.cloudera.org/r/2137/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13293302" author="zjushch" created="Tue, 12 Jun 2012 02:46:40 +0000"  >&lt;p&gt;Uploading patchv3 for 0.92&lt;/p&gt;</comment>
                            <comment id="13293345" author="hadoopqa" created="Tue, 12 Jun 2012 04:42:19 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12531760/HBASE-6134v3-92.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12531760/HBASE-6134v3-92.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2142//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2142//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13293362" author="zjushch" created="Tue, 12 Jun 2012 05:13:33 +0000"  >&lt;p&gt;Updating pach v4 with Ted&apos;s comments in review board :&lt;br/&gt;
Keep the config param: conf.getInt(&quot;hbase.splitlog.report.openedfiles&quot;, 3);&lt;/p&gt;</comment>
                            <comment id="13293602" author="hadoopqa" created="Tue, 12 Jun 2012 13:13:22 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12531772/HBASE-6134v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12531772/HBASE-6134v4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 6 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.io.hfile.TestForceCacheImportantBlocks&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestSplitLogManager&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2147//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2147//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2147//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2147//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2147//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2147//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2147//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2147//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13294008" author="zhihyu@ebaysf.com" created="Tue, 12 Jun 2012 23:55:02 +0000"  >&lt;p&gt;TestSplitLogManager passes locally.&lt;/p&gt;

&lt;p&gt;Reattaching patch v4.&lt;/p&gt;</comment>
                            <comment id="13294048" author="hadoopqa" created="Wed, 13 Jun 2012 01:25:32 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12531893/6134v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12531893/6134v4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 6 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestServerCustomProtocol&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2155//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2155//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2155//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2155//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2155//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2155//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2155//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2155//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13294053" author="zhihyu@ebaysf.com" created="Wed, 13 Jun 2012 01:38:31 +0000"  >&lt;p&gt;TestServerCustomProtocol passes locally.&lt;br/&gt;
Will integrate later if there is no objection.&lt;/p&gt;</comment>
                            <comment id="13294137" author="zhihyu@ebaysf.com" created="Wed, 13 Jun 2012 04:35:44 +0000"  >&lt;p&gt;Patch v4 integrated to trunk.&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Chunhui.&lt;/p&gt;

&lt;p&gt;Thanks for the review, Stack, Kannan, Anoop and Prakash.&lt;/p&gt;</comment>
                            <comment id="13294195" author="hudson" created="Wed, 13 Jun 2012 06:35:52 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3021 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3021/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3021/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6134&quot; title=&quot;Improvement for split-worker to speed up distributed log splitting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6134&quot;&gt;&lt;del&gt;HBASE-6134&lt;/del&gt;&lt;/a&gt; Improvement for split-worker to speed up distributed log splitting (Chunhui) (Revision 1349632)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13294394" author="hudson" created="Wed, 13 Jun 2012 12:04:07 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #52 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/52/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/52/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6134&quot; title=&quot;Improvement for split-worker to speed up distributed log splitting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6134&quot;&gt;&lt;del&gt;HBASE-6134&lt;/del&gt;&lt;/a&gt; Improvement for split-worker to speed up distributed log splitting (Chunhui) (Revision 1349632)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13395981" author="ram_krish" created="Mon, 18 Jun 2012 16:01:49 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
You have patch for 0.94? If so can you upload it here? There is a patch for 0.92 but not for 0.94. Thanks.&lt;/p&gt;</comment>
                            <comment id="13396502" author="ram_krish" created="Tue, 19 Jun 2012 04:27:32 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
Thanks a lot.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13406014" author="stack" created="Tue, 3 Jul 2012 20:32:58 +0000"  >&lt;p&gt;The patch did not make it into 0.92 and 0.94?  Is it supposed to?&lt;/p&gt;</comment>
                            <comment id="13406017" author="stack" created="Tue, 3 Jul 2012 20:38:08 +0000"  >&lt;p&gt;@Ram or @Chunhui You fellas remember an issue that moves a rename out of zk handling path?  I seem to remember such a beast but can&apos;t remember the issue number.  I&apos;m wondering if you fellas fixed hbase-6140 already and afraid in case we let it drop.  Thanks.&lt;/p&gt;</comment>
                            <comment id="13406032" author="jxiang" created="Tue, 3 Jul 2012 20:48:06 +0000"  >&lt;p&gt;Distributed log splitting is not working any more. See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6318&quot; title=&quot;SplitLogWorker exited due to ConcurrentModificationException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6318&quot;&gt;&lt;del&gt;HBASE-6318&lt;/del&gt;&lt;/a&gt; for trace.  Is it related to this patch?&lt;/p&gt;</comment>
                            <comment id="13406264" author="ram_krish" created="Wed, 4 Jul 2012 04:22:17 +0000"  >&lt;p&gt;@Stack&lt;br/&gt;
We have not fixed &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6140&quot; title=&quot;Make distributed log splitting faster by changing call site of tmp log renaming&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6140&quot;&gt;&lt;del&gt;HBASE-6140&lt;/del&gt;&lt;/a&gt;.  Recently JD raised an issue &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6309&quot; title=&quot;[MTTR] Do NN operations outside of the ZK EventThread in SplitLogManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6309&quot;&gt;HBASE-6309&lt;/a&gt;.&lt;br/&gt;
@Chunhui&lt;br/&gt;
You have any patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6140&quot; title=&quot;Make distributed log splitting faster by changing call site of tmp log renaming&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6140&quot;&gt;&lt;del&gt;HBASE-6140&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13406299" author="stack" created="Wed, 4 Jul 2012 06:32:01 +0000"  >&lt;p&gt;Ok.  Then it was a pigment of my emancipation that you had.  You fellas fix so much, seemed possible.&lt;/p&gt;</comment>
                            <comment id="13442019" author="lhofhansl" created="Sun, 26 Aug 2012 03:43:21 +0000"  >&lt;p&gt;Are the 0.92 and 0.94 patches good to go?&lt;/p&gt;</comment>
                            <comment id="13481895" author="enis" created="Mon, 22 Oct 2012 22:51:06 +0000"  >&lt;p&gt;With the numbers 60s vs 160s, this seems pretty important to backport to 0.94. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; any interest / feedback? &lt;/p&gt;</comment>
                            <comment id="13482005" author="lhofhansl" created="Tue, 23 Oct 2012 01:03:27 +0000"  >&lt;p&gt;This is a large&apos;ish change of code that I do not understand well.&lt;/p&gt;

&lt;p&gt;+0 from me. If you feel this is important (and attest that this is low risk &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ), we can get it in.&lt;/p&gt;</comment>
                            <comment id="13482690" author="sershe" created="Tue, 23 Oct 2012 21:06:36 +0000"  >&lt;p&gt;Updating the 0.94 patch&lt;/p&gt;</comment>
                            <comment id="13655106" author="siyu_828" created="Sat, 11 May 2013 01:55:24 +0000"  >&lt;p&gt;Hi,when I apply the patch in Hbase-0.94.2 ,I find error in the HLogSplitter.java:&lt;br/&gt;
The object DistributedLogSplittingHelper can&apos;t find its defination,what&apos;s the matter?&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="13655137" author="lhofhansl" created="Sat, 11 May 2013 03:46:20 +0000"  >&lt;p&gt;Patch probably went stale.&lt;br/&gt;
We never got closure in the 0.94 thing. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;Sergey Shelukhin&lt;/a&gt;, you want this in 0.94? What&apos;s your confidence level in this patch?&lt;/p&gt;</comment>
                            <comment id="13775459" author="stack" created="Mon, 23 Sep 2013 18:31:33 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12551766">HBASE-5843</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12597337">HBASE-6318</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12531893" name="6134v4.patch" size="21665" author="zhihyu@ebaysf.com" created="Tue, 12 Jun 2012 23:55:02 +0000"/>
                            <attachment id="12530177" name="HBASE-6134.patch" size="18795" author="zjushch" created="Wed, 30 May 2012 08:16:38 +0000"/>
                            <attachment id="12530321" name="HBASE-6134v2.patch" size="19748" author="zjushch" created="Thu, 31 May 2012 03:52:30 +0000"/>
                            <attachment id="12531760" name="HBASE-6134v3-92.patch" size="22525" author="zjushch" created="Tue, 12 Jun 2012 02:46:40 +0000"/>
                            <attachment id="12530341" name="HBASE-6134v3.patch" size="21361" author="zjushch" created="Thu, 31 May 2012 06:30:49 +0000"/>
                            <attachment id="12532497" name="HBASE-6134v4-94.patch" size="21433" author="zjushch" created="Tue, 19 Jun 2012 02:29:32 +0000"/>
                            <attachment id="12550529" name="HBASE-6134v4-94v2.patch" size="22163" author="sershe" created="Tue, 23 Oct 2012 21:06:36 +0000"/>
                            <attachment id="12531772" name="HBASE-6134v4.patch" size="21665" author="zjushch" created="Tue, 12 Jun 2012 05:13:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 30 May 2012 06:59:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249690</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0aggf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58939</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>