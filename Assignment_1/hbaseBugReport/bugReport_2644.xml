<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:03:35 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2644/HBASE-2644.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2644] Investigate sync &apos;voodoo&apos; splitting WALs</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2644</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The sequence file sync seems to actually help for some weird reason when recovering parts of edits (odd &amp;#8211; it looks like it just adds a marker to the file).  Investigate.  This comes of review of hbase-2437.   Below is copied from &lt;a href=&quot;http://review.hbase.org/r/74/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.hbase.org/r/74/&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
no point to call .sync() here, it just wastes a bunch of IO to write &lt;span class=&quot;code-quote&quot;&gt;&quot;sync markers&quot;&lt;/span&gt; which we don&apos;t make any real use of.
Cosmin Lehene 6 days, 23 hours ago (May 25th, 2010, 9:07 a.m.)
sync() used to call syncFs(). It looks like HBASE-2544 changed things a bit, but it doesn&apos;t only add the SequenceFile sync marker.

I added &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; after I&apos;ve seen inconsistent results when running splitLog on bigger hlogs. Try copying a log from the cluster locally and run splitLog from the command line a few times without flushing it after each append. I used to get inconsistent results between runs and calling sync fixed it.

There&apos;s &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-comment&quot;&gt;//TODO: test the split of a large (lots of regions &amp;gt; 500 file). In my tests it seems without hflush&quot;&lt;/span&gt;  in the TestHLogSplit. 
&lt;/span&gt;
We could &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; some testing to figure out why would log entries be lost when running locally.

What would be a better way to flush the writer?
Todd Lipcon 5 days, 19 hours ago (May 26th, 2010, 1:31 p.m.)
This seems really voodoo.. &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; anything we&apos;re probably masking a real bug by doing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;. Can you write a unit test which shows &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; problem (even &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; it takes 30 minutes to run, would be good to have in our arsenal)
Cosmin Lehene 2 days, 18 hours ago (May 29th, 2010, 2:13 p.m.)
I can&apos;t reproduce it on hdfs-0.20. I can&apos;t compile hdfs-0.21 (again) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; some reason. I&apos;ll give it another &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; some other time. 

Added the test. Also tried with a real 60MB log file. 
I&apos;m not sure &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; we should leave the test active.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12465885">HBASE-2644</key>
            <summary>Investigate sync &apos;voodoo&apos; splitting WALs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Jun 2010 17:10:18 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:22 +0000</updated>
                            <resolved>Tue, 5 Oct 2010 22:24:14 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12875497" author="tlipcon" created="Fri, 4 Jun 2010 06:15:52 +0000"  >&lt;p&gt;Mind if I downgrade this to major, since we can&apos;t reproduce on 0.20, and no one plans on deploying on 0.21 in short term?&lt;br/&gt;
(if we want to start really supporting HDFS 0.21 we should add a Hudson build for trunk on 0.21)&lt;/p&gt;</comment>
                            <comment id="12875508" author="stack" created="Fri, 4 Jun 2010 06:41:53 +0000"  >&lt;p&gt;Go for it.&lt;/p&gt;

&lt;p&gt;Should we move it out even?  Should running on 0.21 and 0.20 hadoop be a target for the next major hbase release?&lt;/p&gt;</comment>
                            <comment id="12875511" author="tlipcon" created="Fri, 4 Jun 2010 06:46:45 +0000"  >&lt;p&gt;IMO support for 0.21 is &quot;nice to have&quot; but if it doesnt quite work right at first I don&apos;t think it&apos;s a big deal. 0.21 itself is being billed as &quot;might have some issues, 0.21.0 not for production uses&quot;&lt;/p&gt;</comment>
                            <comment id="12918270" author="ryanobjc" created="Tue, 5 Oct 2010 22:24:13 +0000"  >&lt;p&gt;we removed sync markers after we found at SU they could cause apparent corruption of HLogs (ouch!).  They don&apos;t exist anymore. Fixed.&lt;/p&gt;</comment>
                            <comment id="15016960" author="lars_francke" created="Fri, 20 Nov 2015 12:41:22 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 4 Jun 2010 06:15:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26402</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hikv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100272</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>