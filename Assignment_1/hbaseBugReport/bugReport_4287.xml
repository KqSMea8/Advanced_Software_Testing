<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:17:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4287/HBASE-4287.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4287] If region opening fails, try to transition region back to &quot;offline&quot; in ZK</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4287</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In the case that region-opening fails, we currently just close the region again, but don&apos;t do anything to the node in ZK. Instead, we should attempt to transition it from the OPENING state back to an OFFLINE state, or perhaps a new FAILED_OPEN state. Otherwise, we have to wait for the full timeoutMonitor period to elapse, which can be quite a long time.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12520654">HBASE-4287</key>
            <summary>If region opening fails, try to transition region back to &quot;offline&quot; in ZK</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tlipcon">Todd Lipcon</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Mon, 29 Aug 2011 23:17:54 +0000</created>
                <updated>Fri, 20 Nov 2015 11:53:00 +0000</updated>
                            <resolved>Wed, 14 Sep 2011 06:45:50 +0000</resolved>
                                    <version>0.90.4</version>
                                    <fixVersion>0.92.0</fixVersion>
                                    <component>master</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13093337" author="yuzhihong@gmail.com" created="Tue, 30 Aug 2011 00:37:10 +0000"  >&lt;p&gt;In the discussion of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4015&quot; title=&quot;Refactor the TimeoutMonitor to make it less racy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4015&quot;&gt;&lt;del&gt;HBASE-4015&lt;/del&gt;&lt;/a&gt;, introduction of a new state was not considered the best choice.&lt;/p&gt;</comment>
                            <comment id="13093385" author="tlipcon" created="Tue, 30 Aug 2011 02:44:40 +0000"  >&lt;p&gt;Here&apos;s a patch which I&apos;ve tested and basically works on a cluster (well, an 0.90.x cluster).&lt;/p&gt;

&lt;p&gt;I didn&apos;t follow the 4015 work closely, but I think this state makes sense.&lt;/p&gt;</comment>
                            <comment id="13093395" author="tlipcon" created="Tue, 30 Aug 2011 03:03:57 +0000"  >&lt;p&gt;Previous patch was more of a 90-branch change. This one applies/compiles in trunk (or should, at least)&lt;/p&gt;</comment>
                            <comment id="13093398" author="stack" created="Tue, 30 Aug 2011 03:07:26 +0000"  >&lt;p&gt;Why a new state?  Don&apos;t we have enough to manage already?  Looks like its processed same as RS_ZK_REGION_CLOSED but for the different logging.  Otherwise, having RS update zk on failed close seems fine (long as timeout monitor tolerant of the znode changing under it).&lt;/p&gt;</comment>
                            <comment id="13093450" author="ram_krish" created="Tue, 30 Aug 2011 05:44:33 +0000"  >&lt;p&gt;@Todd&lt;br/&gt;
The updation of the state on failure of open region should also be done here&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!transitionToOpened(region)) {
        cleanupFailedOpen(region);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Because here also there a chance for failure due to some zk exception.&lt;/p&gt;</comment>
                            <comment id="13093463" author="tlipcon" created="Tue, 30 Aug 2011 06:12:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why a new state? Don&apos;t we have enough to manage already?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;My personal preference is that each state is only used for one specific thing &amp;#8211; this makes it easier to understand when looking at logs. We&apos;ll see that it transitioned from OPENING to FAILED_OPEN, rather than OPENING to OFFLINE or CLOSED &amp;#8211; makes it more obvious what actually happened. In the future we could also include some more data in there (eg, the exception message)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Because here also there a chance for failure due to some zk exception.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If it fails due to ZK exception, then the options are (a) this RS lost its ZK lease, in which case it will be handled by the server shutdown handler, or (b) someone else ended up opening the region and thus the version numbers didn&apos;t match. In that latter case, the transition to FAILED_OPEN would fail for the same reason.&lt;/p&gt;</comment>
                            <comment id="13093557" author="ram_krish" created="Tue, 30 Aug 2011 08:46:05 +0000"  >&lt;p&gt;@Todd&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
region = openRegion();
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (region == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;May be here we can update the zk node state. Otherwise it will be in opening state and only the timeout needs to detect it.Correct me if am wrong Todd?&lt;/p&gt;
</comment>
                            <comment id="13103268" author="tlipcon" created="Tue, 13 Sep 2011 01:47:50 +0000"  >&lt;p&gt;Updated patch with some unit tests, plus addressing Ram&apos;s idea above.&lt;/p&gt;</comment>
                            <comment id="13103316" author="stack" created="Tue, 13 Sep 2011 04:01:32 +0000"  >&lt;p&gt;Patch looks good.  The new state I&apos;m not mad about, not without our first having done a review in toto of all possible states to figure what new states we&apos;re missing, but I&apos;m grand with this going in.&lt;/p&gt;</comment>
                            <comment id="13103322" author="ram_krish" created="Tue, 13 Sep 2011 04:11:10 +0000"  >&lt;p&gt;+1 on patch. &lt;/p&gt;</comment>
                            <comment id="13104138" author="stack" created="Wed, 14 Sep 2011 01:17:16 +0000"  >&lt;p&gt;Pulling into 0.92.  Patch has two +1s.  Any reason not to have it in 0.92?&lt;/p&gt;</comment>
                            <comment id="13104303" author="tlipcon" created="Wed, 14 Sep 2011 06:45:50 +0000"  >&lt;p&gt;OK. You win. Committed to trunk for 0.92. Thanks for reviewing.&lt;/p&gt;</comment>
                            <comment id="13104633" author="hudson" created="Wed, 14 Sep 2011 16:34:11 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2208 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2208/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2208/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4287&quot; title=&quot;If region opening fails, try to transition region back to &amp;quot;offline&amp;quot; in ZK&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4287&quot;&gt;&lt;del&gt;HBASE-4287&lt;/del&gt;&lt;/a&gt;  If region opening fails, change region in transition into a FAILED_OPEN state so that it can be retried quickly.&lt;/p&gt;

&lt;p&gt;todd : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/executor/EventHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/executor/ExecutorService.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/handler/OpenRegionHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/handler/TestOpenRegionHandler.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13104893" author="hudson" created="Wed, 14 Sep 2011 21:23:27 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2209 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2209/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2209/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4406&quot; title=&quot;TestOpenRegionHandler failing after HBASE-4287&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4406&quot;&gt;&lt;del&gt;HBASE-4406&lt;/del&gt;&lt;/a&gt;  TestOpenRegionHandler failing after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4287&quot; title=&quot;If region opening fails, try to transition region back to &amp;quot;offline&amp;quot; in ZK&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4287&quot;&gt;&lt;del&gt;HBASE-4287&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;todd : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/handler/TestOpenRegionHandler.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15015881" author="lars_francke" created="Fri, 20 Nov 2015 11:53:00 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12523090">HBASE-4406</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12492187" name="0004-HBASE-4287.-FAILED_OPEN-state-in-ZK-v2.patch" size="6043" author="tlipcon" created="Tue, 30 Aug 2011 03:03:57 +0000"/>
                            <attachment id="12492182" name="0004-HBASE-4287.-FAILED_OPEN-state-in-ZK.patch" size="6046" author="tlipcon" created="Tue, 30 Aug 2011 02:44:40 +0000"/>
                            <attachment id="12494161" name="hbase-4287.txt" size="13991" author="tlipcon" created="Tue, 13 Sep 2011 01:47:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 30 Aug 2011 00:37:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33476</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hq9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101516</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>