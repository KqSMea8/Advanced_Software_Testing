<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:59:31 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8897/HBASE-8897.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8897] Add Suspend and Resume to Chaos Monkey</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8897</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We should add suspend and resume to chaos monkey.  They are already exposed through HBaseClusterManager.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12656690">HBASE-8897</key>
            <summary>Add Suspend and Resume to Chaos Monkey</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Jul 2013 21:01:01 +0000</created>
                <updated>Sat, 27 Dec 2014 00:47:18 +0000</updated>
                                                                            <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13702825" author="eclark" created="Tue, 9 Jul 2013 03:07:39 +0000"  >&lt;p&gt;Patch that adds Suspend and Resume to chaos monkey.&lt;br/&gt;
I had to change the way waitForRegionServerToStart worked.  I had to make it so that it waits for a new server load.&lt;/p&gt;</comment>
                            <comment id="13703076" author="hadoopqa" created="Tue, 9 Jul 2013 09:03:31 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12591362/HBASE-8897-0.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12591362/HBASE-8897-0.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 15 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6267//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13703533" author="sershe" created="Tue, 9 Jul 2013 17:31:28 +0000"  >&lt;p&gt;Nice... When real RS is SIGSTOP-ped, it will be pronounced dead only after ZK timeout, right?&lt;br/&gt;
Maybe this could be the way to make sure ZK dies without insta-recovery, by suspending it for some time and then killing, for more realistic MTTR.&lt;br/&gt;
Why did TIMEOUT have to increase?&lt;/p&gt;</comment>
                            <comment id="13703559" author="eclark" created="Tue, 9 Jul 2013 17:53:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why did TIMEOUT have to increase?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Because it&apos;s possible that the old server is still in the cluster status (the zk hasn&apos;t timed out), I had to make it that a new server load to be heartbeated.  This can add a decent amount of time, so I upped to timeout to keep it from getting flakey.&lt;/p&gt;</comment>
                            <comment id="13703600" author="sershe" created="Tue, 9 Jul 2013 18:29:07 +0000"  >&lt;p&gt;This timeout is used when waiting for bunch of things though, waiting for RS/master to both start and stop. I guess the value is arbitrary anyway...&lt;/p&gt;</comment>
                            <comment id="13703625" author="eclark" created="Tue, 9 Jul 2013 18:47:49 +0000"  >&lt;p&gt;Yes waiting for the RS was changed.  The only one affected not changed was master.  But that&apos;s not a big deal.&lt;/p&gt;</comment>
                            <comment id="13703768" author="enis" created="Tue, 9 Jul 2013 20:49:52 +0000"  >&lt;p&gt;Patch looks good overall. &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;My only concern is that if the server is suspended, and somehow CM fails to resume, or user aborts CM, the regionsrver will stay suspended until the process is manually killed by the user. Not sure what the best way to fix this would be. Maybe send resume signal in restoreClusterStatus() to every RS?&lt;/li&gt;
	&lt;li&gt;In resumeRS() you resume, but wait for ONE_MIN instead of TIMEOUT. Is there a reason. Restarting after resume should be fine.&lt;/li&gt;
	&lt;li&gt;Resulting behavior after suspending for 1 min will depend on zk timeout. Should we do two different actions, one for suspending for zkTimeout/2 and other for zkTimeout + 5sec? These will test GC pauses and zk timeouts separately.&lt;/li&gt;
	&lt;li&gt;Changes for waitForRegionServerToStart() looks good. I guess it is needed to make sure that a suspended RS is not thought to be alive.&lt;/li&gt;
	&lt;li&gt;Can bring this to 0.94 as well.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13703893" author="eclark" created="Tue, 9 Jul 2013 22:19:47 +0000"  >&lt;blockquote&gt;&lt;p&gt;Not sure what the best way to fix this would be. Maybe send resume signal in restoreClusterStatus() to every RS?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I thought about that but I wasn&apos;t sure how that would affect time to restore a cluster.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;In resumeRS() you resume, but wait for ONE_MIN instead of TIMEOUT.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I could make it TIMEOUT.&lt;/p&gt;</comment>
                            <comment id="14259256" author="eclark" created="Sat, 27 Dec 2014 00:47:18 +0000"  >&lt;p&gt;Free&apos;ing since this patch no longer applies and I don&apos;t have a cluster that uses ssh.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12591362" name="HBASE-8897-0.patch" size="12278" author="eclark" created="Tue, 9 Jul 2013 03:07:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 9 Jul 2013 09:03:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>336913</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1m43r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>337236</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>