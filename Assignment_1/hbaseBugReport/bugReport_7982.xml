<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:50:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7982/HBASE-7982.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7982] TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &apos;Filesystem closed&apos;, has an NPE, and still passes?</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7982</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I was trying to look at why the odd time Hudson OOMEs trying to make a report on 0.95 build #4 &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/4/console:&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/4/console:&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ERROR: Failed to archive test reports
hudson.util.IOException2: remote file operation failed: /home/jenkins/jenkins-slave/workspace/hbase-0.95 at hudson.remoting.Channel@151a4e3e:ubuntu3
	at hudson.FilePath.act(FilePath.java:861)
	at hudson.FilePath.act(FilePath.java:838)
	at hudson.tasks.junit.JUnitParser.parse(JUnitParser.java:87)
	at 
...

Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.nio.HeapCharBuffer.&amp;lt;init&amp;gt;(HeapCharBuffer.java:57)
	at java.nio.CharBuffer.allocate(CharBuffer.java:329)
	at java.nio.charset.CharsetDecoder.decode(CharsetDecoder.java:792)
	at java.nio.charset.Charset.decode(Charset.java:791)
	at hudson.tasks.junit.SuiteResult.&amp;lt;init&amp;gt;(SuiteResult.java:215)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We are trying to allocate a big buffer and failing.&lt;/p&gt;

&lt;p&gt;Looking at reports being generated, we have quite a few that are &amp;gt; 10MB in size:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
durruti:0.95 stack$ find hbase-* -type f -size +10000k -exec ls -la {} \;
-rw-r--r--@ 1 stack  staff  11126492 Feb 27 06:14 hbase-server/target/surefire-reports/org.apache.hadoop.hbase.backup.TestHFileArchiving-output.txt
-rw-r--r--@ 1 stack  staff  13296009 Feb 27 05:47 hbase-server/target/surefire-reports/org.apache.hadoop.hbase.client.TestFromClientSide3-output.txt
-rw-r--r--@ 1 stack  staff  10541898 Feb 27 05:47 hbase-server/target/surefire-reports/org.apache.hadoop.hbase.client.TestMultiParallel-output.txt
-rw-r--r--@ 1 stack  staff  25344601 Feb 27 05:51 hbase-server/target/surefire-reports/org.apache.hadoop.hbase.client.TestRestoreSnapshotFromClient-output.txt
-rw-r--r--@ 1 stack  staff  17966969 Feb 27 06:12 hbase-server/target/surefire-reports/org.apache.hadoop.hbase.regionserver.TestEndToEndSplitTransaction-output.txt
-rw-r--r--@ 1 stack  staff  17699068 Feb 27 06:09 hbase-server/target/surefire-reports/org.apache.hadoop.hbase.regionserver.wal.TestHLogSplit-output.txt
-rw-r--r--@ 1 stack  staff  17701832 Feb 27 06:07 hbase-server/target/surefire-reports/org.apache.hadoop.hbase.regionserver.wal.TestHLogSplitCompressed-output.txt
-rw-r--r--@ 1 stack  staff  717853709 Feb 27 06:17 hbase-server/target/surefire-reports/org.apache.hadoop.hbase.replication.TestReplicationQueueFailover-output.txt
-rw-r--r--@ 1 stack  staff  563616793 Feb 27 06:17 hbase-server/target/surefire-reports/org.apache.hadoop.hbase.replication.TestReplicationQueueFailoverCompressed-output.txt
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... with TestReplicationQueueFailover* being order of magnitude bigger than the others.&lt;/p&gt;

&lt;p&gt;Looking in the test I see both spewing between 800 and 900 thousand lines in about a minute.  Here is their fixation:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
8908998 2013-02-27 06:17:48,176 ERROR [RegionServer:1;hemera.apache.org,35712,1361945801803.logSyncer] wal.FSHLog$LogSyncer(1012): Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; syncing, requesting close of hlog.
8908999 java.io.IOException: Filesystem closed
8909000 ,...at org.apache.hadoop.hdfs.DFSClient.checkOpen(DFSClient.java:319)
8909001 ,...at org.apache.hadoop.hdfs.DFSClient.access$1200(DFSClient.java:78)
8909002 ,...at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.sync(DFSClient.java:3843)
8909003 ,...at org.apache.hadoop.fs.FSDataOutputStream.sync(FSDataOutputStream.java:97)
8909004 ,...at org.apache.hadoop.io.SequenceFile$Writer.syncFs(SequenceFile.java:999)
8909005 ,...at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogWriter.sync(SequenceFileLogWriter.java:248)
8909006 ,...at org.apache.hadoop.hbase.regionserver.wal.FSHLog.syncer(FSHLog.java:1120)
8909007 ,...at org.apache.hadoop.hbase.regionserver.wal.FSHLog.syncer(FSHLog.java:1058)
8909008 ,...at org.apache.hadoop.hbase.regionserver.wal.FSHLog.sync(FSHLog.java:1228)
8909009 ,...at org.apache.hadoop.hbase.regionserver.wal.FSHLog$LogSyncer.run(FSHLog.java:1010)
8909010 ,...at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
8909011 2013-02-27 06:17:48,176 FATAL [RegionServer:1;hemera.apache.org,35712,1361945801803.logSyncer] wal.FSHLog(1140): Could not sync. Requesting close of hlog
8909012 java.io.IOException: Filesystem closed
8909013 ,...at org.apache.hadoop.hdfs.DFSClient.checkOpen(DFSClient.java:319)
8909014 ,...at org.apache.hadoop.hdfs.DFSClient.access$1200(DFSClient.java:78)
8909015 ,...at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.sync(DFSClient.java:3843)
8909016 ,...at org.apache.hadoop.fs.FSDataOutputStream.sync(FSDataOutputStream.java:97)
8909017 ,...at org.apache.hadoop.io.SequenceFile$Writer.syncFs(SequenceFile.java:999)
8909018 ,...at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogWriter.sync(SequenceFileLogWriter.java:248)
8909019 ,...at org.apache.hadoop.hbase.regionserver.wal.FSHLog.syncer(FSHLog.java:1120)
8909020 ,...at org.apache.hadoop.hbase.regionserver.wal.FSHLog.syncer(FSHLog.java:1058)
8909021 ,...at org.apache.hadoop.hbase.regionserver.wal.FSHLog.sync(FSHLog.java:1228)
8909022 ,...at org.apache.hadoop.hbase.regionserver.wal.FSHLog$LogSyncer.run(FSHLog.java:1010)
8909023 ,...at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;These tests are &apos;succeeding&apos;?&lt;/p&gt;

&lt;p&gt;I also see in both:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   3891 java.lang.NullPointerException
   3892 ,...at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.seek(SequenceFileLogReader.java:261)
   3893 ,...at org.apache.hadoop.hbase.replication.regionserver.ReplicationHLogReaderManager.seek(ReplicationHLogReaderManager.java:103)
   3894 ,...at org.apache.hadoop.hbase.replication.regionserver.ReplicationSource.readAllEntriesToReplicateOrNextFile(ReplicationSource.java:415)
   3895 ,...at org.apache.hadoop.hbase.replication.regionserver.ReplicationSource.run(ReplicationSource.java:333)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12634989">HBASE-7982</key>
            <summary>TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &apos;Filesystem closed&apos;, has an NPE, and still passes?</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jeffreyz">Jeffrey Zhong</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Sat, 2 Mar 2013 22:47:27 +0000</created>
                <updated>Mon, 23 Sep 2013 18:31:18 +0000</updated>
                            <resolved>Thu, 7 Mar 2013 07:03:11 +0000</resolved>
                                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                    <component>build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13591555" author="stack" created="Sat, 2 Mar 2013 23:02:34 +0000"  >&lt;p&gt;This is a blocker because looks like an issue in replication and could be one of the reasons we fail a test copying test results.&lt;/p&gt;</comment>
                            <comment id="13591558" author="stack" created="Sat, 2 Mar 2013 23:15:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/1/artifact/0.95/hbase-server/target/surefire-reports/org.apache.hadoop.hbase.replication.TestReplicationQueueFailover-output.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/1/artifact/0.95/hbase-server/target/surefire-reports/org.apache.hadoop.hbase.replication.TestReplicationQueueFailover-output.txt&lt;/a&gt; fails to copy over test results and in there is a TestReplicationQueuFailover that is nearly 900MB in size.  Then in the next build, the TestReplicationQueue* both pass but the logs are small and the copy of the results succeeds.&lt;/p&gt;</comment>
                            <comment id="13591562" author="nkeywal" created="Sat, 2 Mar 2013 23:28:56 +0000"  >&lt;p&gt;For the build part, may be it&apos;s fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-800&quot; title=&quot;redirectTestOutputToFile is not taken into account in all cases with JUnit47 provider&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-800&quot;&gt;&lt;del&gt;SUREFIRE-800&lt;/del&gt;&lt;/a&gt; in 2.13. Worth trying if you don&apos;t want to wait for the 2.14 (it&apos;s a question of a couple of week for the later imho).&lt;/p&gt;</comment>
                            <comment id="13591592" author="stack" created="Sun, 3 Mar 2013 01:30:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; Which part boss?&lt;/p&gt;</comment>
                            <comment id="13591881" author="jeffreyz" created="Sun, 3 Mar 2013 22:02:43 +0000"  >&lt;p&gt;I checked the error log which wasn&apos;t available now and found the test case failed due to &quot;utility1.loadTable&quot; failing. It&apos;s the same error we got from job 6 &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/6/testReport/junit/org.apache.hadoop.hbase.replication/TestReplicationQueueFailoverCompressed/queueFailover/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/6/testReport/junit/org.apache.hadoop.hbase.replication/TestReplicationQueueFailoverCompressed/queueFailover/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For the NPE, it is an old issue and uncovered by my recent check in where we set internal reader to null after we close the reader inside function repLogReader.closeReader(). The root cause is that we don&apos;t reset this.reader when we close repLogReader. Since the NPE is triggered when &quot;nothing to replicate&quot;, the test case passes even with the exception. &lt;/p&gt;

&lt;p&gt;Both variables are pointing at the same object. We should not have this.reader variable in the first place to save the effort to keep them in sync.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
          &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.repLogReader.closeReader();
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
          gotIOE = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
          LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to finalize the tailing of a file&quot;&lt;/span&gt;, e);
        }
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I attached a patch to handle the NPE case and will spend more time on the table loading issue.&lt;/p&gt;</comment>
                            <comment id="13592423" author="nkeywal" created="Mon, 4 Mar 2013 18:08:35 +0000"  >&lt;blockquote&gt;&lt;p&gt;nkeywal Which part boss?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Surefire has multiple internal buffer, surefire-800 removes one of them, so may be it will manage the error properly.&lt;/p&gt;</comment>
                            <comment id="13592473" author="stack" created="Mon, 4 Mar 2013 18:41:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; Thanks for taking a look sir and attaching the patch.  The patch is a little odd here:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.reader == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || !&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.lastPath.equals(path)) {
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.reader != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.closeReader();
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... in that we check this.reader for nullness twice in two lines.  If this.reader == null, nothing happens right?  So, just remove the check?&lt;/p&gt;

&lt;p&gt;Will I wait on your table loading issue examination before committing this NPE fix?  Do you think it responsible for the log being so big?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; Let me try.  Will wait see what Jeffrey says on above and will put the two patches together....&lt;/p&gt;</comment>
                            <comment id="13592484" author="jeffreyz" created="Mon, 4 Mar 2013 18:46:53 +0000"  >&lt;p&gt;yeah, the following check isn&apos;t needed because closeReader will do that check internally. The closeReader() here is to close the old reader before we create a new one.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.reader != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13592985" author="devaraj" created="Tue, 5 Mar 2013 02:52:59 +0000"  >&lt;p&gt;I and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; was looking at the logs, and it seemed like an RS didn&apos;t successfully abort. It was kind of aborted, that led to the filesystem closing, but then it was trying to do some filesystem operation and continuously failing. Jeffrey is looking at what is preventing the RS from really aborting.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2013-02-26 09:56:22,351 ERROR [RegionServer:1;juno.apache.org,53545,1361872469173.logSyncer] wal.FSHLog$LogSyncer(1012): Error while syncing, requesting close of hlog
java.io.IOException: Filesystem closed
        at org.apache.hadoop.hdfs.DFSClient.checkOpen(DFSClient.java:319)
        at org.apache.hadoop.hdfs.DFSClient.access$1200(DFSClient.java:78)
        at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.sync(DFSClient.java:3843)
        at org.apache.hadoop.fs.FSDataOutputStream.sync(FSDataOutputStream.java:97)
        at org.apache.hadoop.io.SequenceFile$Writer.syncFs(SequenceFile.java:999)
        at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogWriter.sync(SequenceFileLogWriter.java:248)
        at org.apache.hadoop.hbase.regionserver.wal.FSHLog.syncer(FSHLog.java:1120)
        at org.apache.hadoop.hbase.regionserver.wal.FSHLog.syncer(FSHLog.java:1058)
        at org.apache.hadoop.hbase.regionserver.wal.FSHLog.sync(FSHLog.java:1228)
        at org.apache.hadoop.hbase.regionserver.wal.FSHLog$LogSyncer.run(FSHLog.java:1010)
        at java.lang.Thread.run(Thread.java:722)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13593149" author="jeffreyz" created="Tue, 5 Mar 2013 07:44:38 +0000"  >&lt;p&gt;Finally I got the root cause of the huge log files. It&apos;s a tricky issue. &lt;/p&gt;

&lt;p&gt;When RS aborts, one LogSyncer doesn&apos;t quit after we close lease so it throw following exceptions in a while loop:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-02-26 09:55:13,951 FATAL [RegionServer:1;juno.apache.org,53545,1361872469173.logSyncer] wal.FSHLog(1140): Could not sync. Requesting close of hlog
java.io.IOException: Filesystem closed
	at org.apache.hadoop.hdfs.DFSClient.checkOpen(DFSClient.java:319)
	at org.apache.hadoop.hdfs.DFSClient.access$1200(DFSClient.java:78)
	at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.sync(DFSClient.java:3843)
	at org.apache.hadoop.fs.FSDataOutputStream.sync(FSDataOutputStream.java:97)
	at org.apache.hadoop.io.SequenceFile$Writer.syncFs(SequenceFile.java:999)
	at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogWriter.sync(SequenceFileLogWriter.java:248)
	at org.apache.hadoop.hbase.regionserver.wal.FSHLog.syncer(FSHLog.java:1120)
	at org.apache.hadoop.hbase.regionserver.wal.FSHLog.syncer(FSHLog.java:1058)
	at org.apache.hadoop.hbase.regionserver.wal.FSHLog.sync(FSHLog.java:1228)
	at org.apache.hadoop.hbase.regionserver.wal.FSHLog$LogSyncer.run(FSHLog.java:1010)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
2013-02-26 09:55:13,951 ERROR [RegionServer:1;juno.apache.org,53545,1361872469173.logSyncer] wal.FSHLog$LogSyncer(1012): Error &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; syncing, requesting close of hlog 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The reason we left one LogSyncer instance open as you can see in the following line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void closeWAL(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; delete) {
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.hlogForMeta != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        &lt;span class=&quot;code-comment&quot;&gt;//All hlogs (meta and non-meta) are in the same directory. Don&apos;t call 
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;//closeAndDelete here since that would delete all hlogs not just the 
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;//meta ones. We will just &apos;close&apos; the hlog &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; meta here, and leave
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;//the directory cleanup to the follow-on closeAndDelete call.
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.hlogForMeta.close();
      }
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.hlog != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (delete) {
          hlog.closeAndDelete();
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
          hlog.close();
        }
      }
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable e) {
      LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Close and delete failed&quot;&lt;/span&gt;, RemoteExceptionHandler.checkThrowable(e));
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.hlogForMeta.close();&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; throws exception then the hlog won&apos;t be closed. Below is the log message which shows hlogForMeta.close() throws an exception:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-02-26 09:55:13,335 ERROR [IPC Server handler 0 on 56091] security.UserGroupInformation(1139): PriviledgedActionException as:jenkins.hfs.1 cause:org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: No lease on /user/jenkins/hbase/.logs/juno.apache.org,53545,1361872469173/juno.apache.org%2C53545%2C1361872469173.1361872473259.meta File does not exist. [Lease.  Holder: DFSClient_hb_rs_juno.apache.org,53545,1361872469173_-70821669_153, pendingcreates: 2]
2013-02-26 09:55:13,336 ERROR [RegionServer:1;juno.apache.org,53545,1361872469173] regionserver.HRegionServer(1178): Close and delete failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In addition, I also fixed a potential loop situation in the replication source code. &lt;/p&gt;</comment>
                            <comment id="13593151" author="jeffreyz" created="Tue, 5 Mar 2013 07:51:56 +0000"  >&lt;p&gt;update the NPE patch by incorporating Stack&apos;s comments.&lt;/p&gt;</comment>
                            <comment id="13593221" author="devaraj" created="Tue, 5 Mar 2013 08:22:48 +0000"  >&lt;p&gt;Great catch, Jeff. Let me validate your findings.&lt;/p&gt;</comment>
                            <comment id="13593789" author="stack" created="Tue, 5 Mar 2013 19:18:13 +0000"  >&lt;p&gt;Excellent work lads.&lt;/p&gt;

&lt;p&gt;Want to put the two patches together Jeffrey?  They could go in as one under the aegis of this issue?  Second patch may have NPE leakage anyways.&lt;/p&gt;

&lt;p&gt;I&apos;d be +1 on commit.&lt;/p&gt;</comment>
                            <comment id="13593802" author="jeffreyz" created="Tue, 5 Mar 2013 19:30:04 +0000"  >&lt;p&gt;combined the tow fixes into the new patch. I&apos;ve run the TestReplicationQueueFailover in a loop for 10times without any issue on my dev box.&lt;/p&gt;</comment>
                            <comment id="13593816" author="stack" created="Tue, 5 Mar 2013 19:43:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=devaraj&quot; class=&quot;user-hover&quot; rel=&quot;devaraj&quot;&gt;Devaraj Das&lt;/a&gt; You good w/ this being committed?&lt;/p&gt;</comment>
                            <comment id="13593824" author="devaraj" created="Tue, 5 Mar 2013 19:47:15 +0000"  >&lt;p&gt;Looking.&lt;/p&gt;</comment>
                            <comment id="13593835" author="devaraj" created="Tue, 5 Mar 2013 19:54:59 +0000"  >&lt;p&gt;The change in HRegionServer.java looks fine to me. I am not sure on the other changes in the patch but it seems like they have been reviewed / discussed.&lt;/p&gt;</comment>
                            <comment id="13593857" author="jeffreyz" created="Tue, 5 Mar 2013 20:14:55 +0000"  >&lt;p&gt;I found the test case still fail with the following message once a while:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Waited too much time &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; queueFailover replication. Waited 12028ms.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let me dig the error a little more though the above issue is unrelated to the JIRA&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13594083" author="stack" created="Tue, 5 Mar 2013 23:17:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; Thank you for digging in.&lt;/p&gt;</comment>
                            <comment id="13594088" author="stack" created="Tue, 5 Mar 2013 23:26:30 +0000"  >&lt;p&gt;The OOME happened in the recent &lt;a href=&quot;https://builds.apache.org/view/G-L/view/HBase/job/hbase-0.95/26/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/view/G-L/view/HBase/job/hbase-0.95/26/console&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13594157" author="jeffreyz" created="Wed, 6 Mar 2013 00:45:47 +0000"  >&lt;p&gt;The OOME should be handled by my previous patch. &lt;/p&gt;

&lt;p&gt;The root cause of &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Waited too much time &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; queueFailover replication.&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; is caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7723&quot; title=&quot;Remove NameNode URI from ZK splitlogs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7723&quot;&gt;&lt;del&gt;HBASE-7723&lt;/del&gt;&lt;/a&gt;. I&apos;ll comment there and submit my patch soon.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13594209" author="jeffreyz" created="Wed, 6 Mar 2013 01:34:52 +0000"  >&lt;p&gt;The patch contains fixes for large log file &amp;amp; wait too long errors.&lt;/p&gt;

&lt;p&gt;The NPE has been already checked in.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13594228" author="stack" created="Wed, 6 Mar 2013 01:54:33 +0000"  >&lt;p&gt;Excellent work Jeffrey.&lt;/p&gt;

&lt;p&gt;I wonder if we could do better than this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  5 +    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; rootPathString = rootdir.toString();
  4 +    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (logfile.startsWith(rootPathString)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What if the rootdir is fully qualified but the logfile is not or some other such issues that can arise comparing Paths?  For example, say rootdir was:&lt;/p&gt;

&lt;p&gt;hdfs://example.org:12345/hbase and the logfile was /hbase/.logs/server/123.log, the above test would make a bogus logfile Path.&lt;/p&gt;

&lt;p&gt;What you reckon?&lt;/p&gt;</comment>
                            <comment id="13594255" author="jeffreyz" created="Wed, 6 Mar 2013 02:25:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; Good question. &lt;/p&gt;

&lt;p&gt;The reason has the check is to support backward compatibility when we&apos;re upgrading to the new release from previous release. After upgrade the check won&apos;t do anything.&lt;/p&gt;

&lt;p&gt;log file paths are set in ZK by SplitLogManager when kicking off a log splitting work and later consumed by SplitLogManager when a log file is done with log splitting. I think the situation you mentioned should not happen. The value of root dir should NOT change in between. &lt;/p&gt;</comment>
                            <comment id="13594920" author="jeffreyz" created="Wed, 6 Mar 2013 18:14:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; Are you ok with the patch? I hope we can get patch in soon. &lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13595062" author="stack" created="Wed, 6 Mar 2013 20:21:34 +0000"  >&lt;p&gt;Jeffrey&apos;s patch but have it use new utility in FSUtils for matching path component of a Path URI.&lt;/p&gt;

&lt;p&gt;You ok w/ this addition Jeffrey?  Was afraid we&apos;d get the unexpected just when we needed it most... in middle of a recovery...&lt;/p&gt;</comment>
                            <comment id="13595197" author="jeffreyz" created="Wed, 6 Mar 2013 22:27:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; Two thumbs up for your changes. I like the new isMatchingPath method which basically removes all noises.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey &lt;/p&gt;</comment>
                            <comment id="13595232" author="jeffreyz" created="Wed, 6 Mar 2013 22:49:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; Oh, actually the line &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (FSUtils.isMatchingPath(rootdir, logfile)) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; doesn&apos;t check prefix. My origin intention is to check if logfile already contains rootdir or not. If not, just append the rootdir. I think we could use your isMatchPath to create a new function such as startWithPath(rootdir, logfile)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isStarignWithPath(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path pathToSearch, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path pathTail) {
    Path tmpPath = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(pathTail.toString());
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (pathToSearch.depth() &amp;gt; tmpPath.depth()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;(tmpPath.depth() &amp;gt; pathToSearch.depth()){
      tmpPath = tmpPath.getParent();
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; isMatchingPath(pathToSearch, tmpPath);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13595238" author="jeffreyz" created="Wed, 6 Mar 2013 22:54:56 +0000"  >&lt;p&gt;fix some typo:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isStartingWithPath(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path pathToSearch,&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path pathTail) {
    Path tmpPath = pathTail;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (pathToSearch.depth() &amp;gt; tmpPath.depth()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;(tmpPath.depth() &amp;gt; pathToSearch.depth()){
      tmpPath = tmpPath.getParent();
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; isMatchingPath(pathToSearch, tmpPath);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13595283" author="jeffreyz" created="Wed, 6 Mar 2013 23:35:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; For your connivence, I combined all the changes together.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13595505" author="stack" created="Thu, 7 Mar 2013 03:27:03 +0000"  >&lt;p&gt;v4 is the last patch with more tests.  Redid the isStartingWithPath.  Looked at Path.  Each of those calls to depth was doing full scan (smile).&lt;/p&gt;

&lt;p&gt;Let me run it by hadoopqa then commit.&lt;/p&gt;</comment>
                            <comment id="13595538" author="hadoopqa" created="Thu, 7 Mar 2013 04:31:36 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12572481/7982v4.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12572481/7982v4.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4708//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13595622" author="stack" created="Thu, 7 Mar 2013 07:03:11 +0000"  >&lt;p&gt;Committed to trunk and 0.95.  Nice work &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13595684" author="hudson" created="Thu, 7 Mar 2013 08:45:23 +0000"  >&lt;p&gt;Integrated in hbase-0.95 #34 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/34/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/34/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7982&quot; title=&quot;TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &amp;#39;Filesystem closed&amp;#39;, has an NPE, and still passes?&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7982&quot;&gt;&lt;del&gt;HBASE-7982&lt;/del&gt;&lt;/a&gt; TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &apos;Filesystem closed&apos;, has an NPE, and still passes? (Revision 1453713)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13595710" author="hudson" created="Thu, 7 Mar 2013 09:24:37 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3923 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3923/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3923/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7982&quot; title=&quot;TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &amp;#39;Filesystem closed&amp;#39;, has an NPE, and still passes?&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7982&quot;&gt;&lt;del&gt;HBASE-7982&lt;/del&gt;&lt;/a&gt; TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &apos;Filesystem closed&apos;, has an NPE, and still passes? (Revision 1453712)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13595811" author="hudson" created="Thu, 7 Mar 2013 12:12:21 +0000"  >&lt;p&gt;Integrated in hbase-0.95-on-hadoop2 #15 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95-on-hadoop2/15/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95-on-hadoop2/15/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7982&quot; title=&quot;TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &amp;#39;Filesystem closed&amp;#39;, has an NPE, and still passes?&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7982&quot;&gt;&lt;del&gt;HBASE-7982&lt;/del&gt;&lt;/a&gt; TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &apos;Filesystem closed&apos;, has an NPE, and still passes? (Revision 1453713)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13595857" author="hudson" created="Thu, 7 Mar 2013 13:03:39 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #434 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/434/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/434/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7982&quot; title=&quot;TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &amp;#39;Filesystem closed&amp;#39;, has an NPE, and still passes?&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7982&quot;&gt;&lt;del&gt;HBASE-7982&lt;/del&gt;&lt;/a&gt; TestReplicationQueueFailover* runs for a minute, spews 3/4million lines complaining &apos;Filesystem closed&apos;, has an NPE, and still passes? (Revision 1453712)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13775344" author="stack" created="Mon, 23 Sep 2013 18:31:18 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12572383" name="7982v3.txt" size="9108" author="stack" created="Wed, 6 Mar 2013 20:21:34 +0000"/>
                            <attachment id="12572481" name="7982v4.txt" size="10584" author="stack" created="Thu, 7 Mar 2013 03:27:03 +0000"/>
                            <attachment id="12571826" name="hbase-7982-NPE.patch" size="1621" author="jeffreyz" created="Sun, 3 Mar 2013 22:03:21 +0000"/>
                            <attachment id="12572049" name="hbase-7982-NPE_2.patch" size="1576" author="jeffreyz" created="Tue, 5 Mar 2013 07:51:56 +0000"/>
                            <attachment id="12572145" name="hbase-7982-combined.patch" size="3781" author="jeffreyz" created="Tue, 5 Mar 2013 19:30:04 +0000"/>
                            <attachment id="12572223" name="hbase-7982-combined_1.patch" size="2782" author="jeffreyz" created="Wed, 6 Mar 2013 01:34:52 +0000"/>
                            <attachment id="12572048" name="hbase-7982-huge-logging.patch" size="2650" author="jeffreyz" created="Tue, 5 Mar 2013 07:45:02 +0000"/>
                            <attachment id="12572437" name="hbase-7982-with-Stack-changes-02.patch" size="10311" author="jeffreyz" created="Wed, 6 Mar 2013 23:35:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 2 Mar 2013 23:28:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315482</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ifuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315826</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>