<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:48:32 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-897/HBASE-897.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-897] Backup/Export/Import Tool</title>
                <link>https://issues.apache.org/jira/browse/HBASE-897</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Attached is a simple import, export, and backup utility. Mahalo.com has been using this in production for several months to back up our HBase clusters as well as to migrate data from production to development clusters, etc.&lt;/p&gt;

&lt;p&gt;Documentation included below is from the readme.&lt;/p&gt;

&lt;p&gt;HBase Backup&lt;br/&gt;
author: Dan Zinngrabe dan@mahalo.com&lt;/p&gt;

&lt;p&gt;------------------&lt;br/&gt;
Summary:&lt;br/&gt;
Simple MapReduce job for exporting data from an HBase table. The exported data is in a simple, flat format that can then be imported using another MapReduce job. This gives you both a backup capability, and a simple way to import and export data from tables.&lt;/p&gt;

&lt;p&gt;Backup File Format&lt;br/&gt;
------------------&lt;/p&gt;

&lt;p&gt;The output of a backup job is a flat text file, or series of flat text files. Each row is represented by a single line, with each item tab delimited. Column names are plain text, while column values are base 64 encoded. This helps us deal with tabs and line breaks in the data. Generally you should not have to worry about this at all.&lt;/p&gt;

&lt;p&gt;Setup and installation&lt;br/&gt;
------------------&lt;/p&gt;

&lt;p&gt;First, make sure your Hadoop installation is properly configured to load the HBase classes. This can easily be done by editing the hadoop-env.sh file to include HBase&apos;s jar libraries. You can add the following to hadoop-env.sh to have it load HBase classes:&lt;/p&gt;

&lt;p&gt;export HBASE_HOME=/Users/quellish/Desktop/hadoop/hbase-0.1.2&lt;br/&gt;
export HADOOP_CLASSPATH=$HBASE_HOME/hbase-0.1.2.jar:$HBASE_HOME/conf:$HBASE_HOME/hbase-0.1.2-test.jar&lt;/p&gt;

&lt;p&gt;Second, make sure the hbase-backup.jar file is on the classpath for Hadoop as well. While you can put this into a system-wide class path directory such as $&lt;/p&gt;
{JAVA_HOME}
&lt;p&gt;/lib , it&apos;s much easier to just put it into&lt;/p&gt;

&lt;p&gt;$&lt;/p&gt;
{HADOOP_HOME}/lib&lt;br/&gt;
&lt;br/&gt;
With that done, you are ready to go. Start up hadoop and HBase normally and you will be able to run a backup and restore.&lt;br/&gt;
&lt;br/&gt;
Backing up&lt;br/&gt;
------------------&lt;br/&gt;
&lt;br/&gt;
Backups are run using the Exporter class. From  ${HADOOP_HOME}
&lt;p&gt; :&lt;/p&gt;

&lt;p&gt;bin/hadoop com.mahalo.hadoop.hbase.Exporter -output backup -table text -columns text_flags: text_data:&lt;/p&gt;

&lt;p&gt;This will output the backup into the new directory &quot;backup&quot; in the Hadoop File System, and will back up the columns &quot;old_flags&quot; and &quot;old_text&quot;, with whatever the table&apos;s row identifier is. Colons are required in the column names, and this will produce multiple files in the output directory (simply &apos;cat&apos; them together to form a single file). Note that if the backup directory exists it will stop. This may be changed in a future version. The output directory can also be any file system path or URL that Hadoop can understand, such as an S3 URL.&lt;/p&gt;

&lt;p&gt;Restoring from a backup&lt;br/&gt;
------------------&lt;/p&gt;

&lt;p&gt;From  $&lt;/p&gt;
{HADOOP_HOME}
&lt;p&gt; :&lt;/p&gt;

&lt;p&gt;bin/hadoop com.mahalo.hadoop.hbase.Importer backup/backup.tsv text&lt;/p&gt;

&lt;p&gt;This will load a single file (that you &apos;cat&apos;d together from parts), backup/backup.tsv into the table text. Note that the table must already exist, and it can have data in it - those values can be overwritten by the restore process. You can create the table easily using HBase&apos;s Shell. The backup file can be loaded from any URL that Hadoop understands, such as a file URL or S3 URL. A path not formatted as URL (such as shown above) assumes a path from your user directory in the hadoop filesystem.&lt;/p&gt;

&lt;p&gt;Combining a file from pieces using cat&lt;br/&gt;
------------------&lt;/p&gt;

&lt;p&gt;As mentioned above, typically a MapReduce job will produce several files of output that must be assembled together to make a single file. On a unix system, this is fairly easy to do, using cat and the find command: First, export your data from the hadoop filesystem to the local filesystem:&lt;/p&gt;

&lt;p&gt;bin/hadoop dfs -copyToLocal backup ~/mybackups&lt;/p&gt;

&lt;p&gt;Then:&lt;/p&gt;

&lt;p&gt;cd ~/&lt;br/&gt;
find mybackups/. -name &quot;part-00*&quot; | xargs cat &amp;gt;&amp;gt; backup.tsv&lt;/p&gt;

&lt;p&gt;This will take all the files in the &quot;backup&quot; directory matching the pattern &quot;part-00*&quot; and combine them into a file &quot;backup.tsv&quot;&lt;/p&gt;

&lt;p&gt;Troubleshooting&lt;br/&gt;
------------------&lt;/p&gt;

&lt;p&gt;During a restore/import, regionservers splitting or becoming unavailable is normal, and the application will recover from it. You may see errors in the logs, but this is normal.&lt;/p&gt;</description>
                <environment>&lt;p&gt;MacOS 10.5.4, CentOS 5.1&lt;/p&gt;</environment>
        <key id="12404917">HBASE-897</key>
            <summary>Backup/Export/Import Tool</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="danmahalo">Dan Zinngrabe</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Sep 2008 23:01:33 +0000</created>
                <updated>Wed, 22 Jul 2009 22:07:09 +0000</updated>
                            <resolved>Wed, 22 Jul 2009 22:07:09 +0000</resolved>
                                    <version>0.1.2</version>
                    <version>0.1.3</version>
                                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12633549" author="danmahalo" created="Mon, 22 Sep 2008 23:03:06 +0000"  >&lt;p&gt;Unzip and run &apos;ant build&apos; to create the binary. Documentation is included in the readme. Note that while this has primarily been used with 0.1.2 and 0.1.3, it should be usable on newer versions with little or no modifications.&lt;/p&gt;</comment>
                            <comment id="12633613" author="stack" created="Tue, 23 Sep 2008 04:16:53 +0000"  >&lt;p&gt;This looks excellent Dan.&lt;/p&gt;

&lt;p&gt;I tried to build it but the lib dir is empty; my guess is its supposed to be populated with some subset of hadoop and hbase jars and lib content.&lt;/p&gt;

&lt;p&gt;But more important, do you think we should bundle this tool with hbase itself?  What would you suggest?  Perhaps add it as subpackage under hbase mapred?  The README could be redone as package-level documentation?  Or do you think it better it remain its own self-contained thing?  If so, where should it live other than as a JIRA attachment?&lt;/p&gt;

&lt;p&gt;Good stuff (Just back from Hawaii so I know what Mahalo means now).&lt;/p&gt;</comment>
                            <comment id="12633774" author="danmahalo" created="Tue, 23 Sep 2008 15:45:23 +0000"  >&lt;p&gt;Yes, you need the hbase and hadoop jars either in the lib directory or on your classpath for it to build properly.&lt;/p&gt;

&lt;p&gt;This hasn&apos;t been tested with the most recent HBase and Hadoop releases but there is no reason I can find that it would not work other than class name changes. I think including it in hbase may be a good idea - being able to export and import data even just for testing purposes is valuable to developers, and the backup capability is something people have asked for quite a bit. Until there is a more robust backup tool like what has been suggested for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-50&quot; title=&quot;Snapshot of table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-50&quot;&gt;&lt;del&gt;HBASE-50&lt;/del&gt;&lt;/a&gt;, this would certainly be a reasonable stopgap.&lt;/p&gt;

&lt;p&gt;Since for backup purposes the tool is likely to be deployed and used by systems administrator, the README should probably remain separate for now - it makes it easier to get it in their hands.&lt;/p&gt;</comment>
                            <comment id="12633833" author="stack" created="Tue, 23 Sep 2008 18:16:34 +0000"  >&lt;p&gt;Mind making a patch then?  Add it to mapred package or into a subpackage of mapred.&lt;/p&gt;

&lt;p&gt;Regards the README, where do you think it would live?   If its package-level documentation, its beside the code and (hopefully) evolves with it.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12633955" author="danmahalo" created="Tue, 23 Sep 2008 22:53:38 +0000"  >&lt;p&gt;I&apos;ll give that a shot, it shouldn&apos;t present any problems that I can see.&lt;br/&gt;
I&apos;ll put most of the readme into the package docs, and I&apos;ll see if I can do a version of it targetted at sysadmins for the wiki.&lt;/p&gt;</comment>
                            <comment id="12634272" author="stack" created="Wed, 24 Sep 2008 20:14:51 +0000"  >&lt;p&gt;Dan: Thanks.  One minor thing, rather than put the doc. in wiki, if its in the javadoc, it can evolve along with the hbase versions.  Also, to be clear, you&apos;ve run this MR job against a &apos;live&apos; instance (Just asking.  Someone off-the-mailing-list was looking for such a thing and I pointed them here).  Finally, any chance of adding mahola to the powered-by page.  I&apos;m making the rounds trying to get fellas to add their names; its empty now and that gives off a bad impression.  Good stuff.&lt;/p&gt;</comment>
                            <comment id="12634279" author="danmahalo" created="Wed, 24 Sep 2008 20:33:32 +0000"  >&lt;p&gt;That&apos;s correct: look at www.mahalo.com . All the markup that power the wiki is stored in HBase, and backed up using this tool every hour. It&apos;s been in use for a few months now. MediaWiki - same software that power Wikipedia - has version/revision control. Mahalo&apos;s in-house editors produce a &lt;b&gt;lot&lt;/b&gt; of revisions per day, which was not working well in a RDBMS. An hbase-based solution for this was built and tested, and the data migrated out of MySQL using this tool (and a few python scripts) and into HBase. Right now it&apos;s at something like 6 million items in HBase. The tool runs every hour from a shell script to back up that data, and on 6 nodes takes about 5-10 minutes to run - and does not slow down production at all. So its not just a backup, it&apos;s a hot backup.&lt;/p&gt;

&lt;p&gt;Mahalo has no problem with being added to the powered-by page &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; . &lt;/p&gt;</comment>
                            <comment id="12634286" author="stack" created="Wed, 24 Sep 2008 20:45:18 +0000"  >&lt;p&gt;Great stuff Dan.  Info should make Lars George happy &amp;#8211; the fellow asking.  He&apos;s dataset size sounds about same as yours.&lt;/p&gt;

&lt;p&gt;I&apos;ll make first cut at adding a Mahalo entry to the powered-by page.  Take a cut at it if I misrepresent.  Thanks.&lt;/p&gt;</comment>
                            <comment id="12644246" author="sishen" created="Fri, 31 Oct 2008 09:30:48 +0000"  >&lt;p&gt;Dan Zinngrabe.&lt;/p&gt;

&lt;p&gt;Thanks for your wonderful tool.  It&apos;s really very helpful, &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;In the jira, it&apos;s recorded as affect the hbase 0.1.2, 0.1.3.  Now hbase 0.19.1 is release and i found that it&apos;s not compatible with that.&lt;/p&gt;

&lt;p&gt;I want to know that do you have the new version which will fix the problems?  Thanks.   &lt;/p&gt;</comment>
                            <comment id="12732851" author="atppp" created="Sat, 18 Jul 2009 06:14:02 +0000"  >&lt;p&gt;Spent a little bit time on this and made it work with hadoop/0.19.1 and hbase/0.19.2. Fixed a handful of bugs.&lt;/p&gt;</comment>
                            <comment id="12732921" author="streamy" created="Sat, 18 Jul 2009 18:06:46 +0000"  >&lt;p&gt;Good stuff, atppp.  FYI there was another issue opened for an 0.19 version &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-974&quot; title=&quot;New Backup Export/Import MR for 0.18/0.19&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-974&quot;&gt;&lt;del&gt;HBASE-974&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m working on a new one for 0.20 soon, will have it up next week in a new issue and will post here.&lt;/p&gt;</comment>
                            <comment id="12734353" author="streamy" created="Wed, 22 Jul 2009 22:07:09 +0000"  >&lt;p&gt;Issue contains tools to perform this on really old versions and also on 0.19.  No plans to commit any of this into branches.&lt;/p&gt;

&lt;p&gt;Other implementations for 0.18/0.19 available in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-974&quot; title=&quot;New Backup Export/Import MR for 0.18/0.19&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-974&quot;&gt;&lt;del&gt;HBASE-974&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Closing issue as Won&apos;t Fix.  0.20 backup now being worked on in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1684&quot; title=&quot;Backup (Export/Import) contrib tool for 0.20&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1684&quot;&gt;&lt;del&gt;HBASE-1684&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12390698" name="hbase_backup_release.tar.gz" size="8070" author="danmahalo" created="Mon, 22 Sep 2008 23:03:06 +0000"/>
                            <attachment id="12413909" name="hbase_backup_with_hbase_0.19.x.tar.gz" size="7856" author="atppp" created="Sat, 18 Jul 2009 06:14:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 23 Sep 2008 04:16:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31893</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 22 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ha47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98901</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>