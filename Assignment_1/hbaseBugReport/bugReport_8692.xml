<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:57:38 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8692/HBASE-8692.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8692] [AccessController] Restrict HTableDescriptor enumeration</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8692</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Some users are concerned about having table schema exposed to every user and would like it protected, similar to the rest of the admin operations for schema. &lt;/p&gt;

&lt;p&gt;This used to be hopeless because META would leak HTableDescriptors in HRegionInfo, but that is no longer the case in 0.94+.&lt;/p&gt;

&lt;p&gt;Consider adding CP hooks in the master for intercepting HMasterInterface#getHTableDescriptors and HMasterInterface#getHTableDescriptors(List&amp;lt;String&amp;gt;).  Add support in the AccessController for only allowing GLOBAL ADMIN to the first method. Add support in the AccessController for allowing access to the descriptors for the table names in the list of the second method only if the user has TABLE ADMIN privilege for all of the listed table names.&lt;/p&gt;

&lt;p&gt;Then, fix the code in HBaseAdmin (and elsewhere) that expects to be able to enumerate all table descriptors e.g. in deleteTable. A TABLE ADMIN can delete a table but won&#8217;t have GLOBAL ADMIN privilege to enumerate the total list. So a minor fixup is needed here, and in other places like this which make the same assumption.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12651063">HBASE-8692</key>
            <summary>[AccessController] Restrict HTableDescriptor enumeration</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Jun 2013 09:29:36 +0000</created>
                <updated>Fri, 25 Apr 2014 00:38:55 +0000</updated>
                            <resolved>Mon, 24 Jun 2013 22:22:05 +0000</resolved>
                                    <version>0.98.0</version>
                    <version>0.95.1</version>
                    <version>0.94.9</version>
                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.95.2</fixVersion>
                    <fixVersion>0.94.10</fixVersion>
                                    <component>Coprocessors</component>
                    <component>security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13684072" author="apurtell" created="Sat, 15 Jun 2013 04:51:54 +0000"  >&lt;p&gt;Review request at &lt;a href=&quot;https://reviews.apache.org/r/11890/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/11890/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13684079" author="hadoopqa" created="Sat, 15 Jun 2013 05:07:15 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12587955/8692-0.94.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12587955/8692-0.94.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6039//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6039//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13684256" author="apurtell" created="Sat, 15 Jun 2013 18:37:29 +0000"  >&lt;p&gt;Got a +1 on RB. Updated release notes. Going to commit to trunk and 0.94 after running the full unit test suite.&lt;/p&gt;</comment>
                            <comment id="13684432" author="apurtell" created="Sat, 15 Jun 2013 23:06:53 +0000"  >&lt;p&gt;Refreshed patches against latest SVN. All tests pass on 0.94. No new failures on trunk. Will hold off commit actually until I can stand up a secure cluster and test this change. Probably Monday.&lt;/p&gt;</comment>
                            <comment id="13690769" author="apurtell" created="Fri, 21 Jun 2013 21:57:11 +0000"  >&lt;p&gt;Testing and committing this today.&lt;/p&gt;</comment>
                            <comment id="13690989" author="apurtell" created="Sat, 22 Jun 2013 01:14:02 +0000"  >&lt;p&gt;Attached updated patches that fix a race upon table delete. New unit test covers this case.&lt;/p&gt;

&lt;p&gt;The consequence of the change is it&apos;s now possible to discover table names by throwing guesses or random strings at the cluster with HBaseAdmin#getHTableDescriptor(List&amp;lt;String&amp;gt;). If the table exists the result will be an AccessDeniedException; if it does not exist, then a null result. I don&apos;t find this to be a practical problem, there is no actual schema exposure. &lt;/p&gt;</comment>
                            <comment id="13690991" author="apurtell" created="Sat, 22 Jun 2013 01:16:27 +0000"  >&lt;p&gt;Going to commit to trunk and 0.94 tomorrow if no objection.&lt;/p&gt;</comment>
                            <comment id="13691016" author="hadoopqa" created="Sat, 22 Jun 2013 01:54:04 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12589223/8692-0.94.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12589223/8692-0.94.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6099//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6099//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13692415" author="apurtell" created="Mon, 24 Jun 2013 21:39:11 +0000"  >&lt;p&gt;About to commit. Just fixing the shell &apos;describe&apos; command to work as expected.&lt;/p&gt;</comment>
                            <comment id="13692451" author="apurtell" created="Mon, 24 Jun 2013 22:22:41 +0000"  >&lt;p&gt;What I committed. Final set of changes are in admin.rb and admin_test.rb. TestShell and TestAccessController pass locally.&lt;/p&gt;</comment>
                            <comment id="13692577" author="hudson" created="Mon, 24 Jun 2013 23:50:49 +0000"  >&lt;p&gt;Integrated in hbase-0.95-on-hadoop2 #147 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95-on-hadoop2/147/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95-on-hadoop2/147/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8692&quot; title=&quot;[AccessController] Restrict HTableDescriptor enumeration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8692&quot;&gt;&lt;del&gt;HBASE-8692&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;AccessController&amp;#93;&lt;/span&gt; Restrict HTableDescriptor enumeration (Revision 1496239)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/MasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterCoprocessorHost.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/security/access/TestAccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/ruby/hbase/admin_test.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13692584" author="hudson" created="Mon, 24 Jun 2013 23:53:42 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #180 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/180/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/180/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8692&quot; title=&quot;[AccessController] Restrict HTableDescriptor enumeration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8692&quot;&gt;&lt;del&gt;HBASE-8692&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;AccessController&amp;#93;&lt;/span&gt; Restrict HTableDescriptor enumeration (Revision 1496240)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/security/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/security/src/test/java/org/apache/hadoop/hbase/security/access/TestAccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/MasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/ipc/HMasterInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterCoprocessorHost.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/coprocessor/TestMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/ruby/hbase/admin_test.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13692594" author="apurtell" created="Tue, 25 Jun 2013 00:00:23 +0000"  >&lt;p&gt;By the way, don&apos;t blame this for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8799&quot; title=&quot;TestAccessController#testBulkLoad failing on trunk/0.95&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8799&quot;&gt;&lt;del&gt;HBASE-8799&lt;/del&gt;&lt;/a&gt; - it&apos;s an unrelated issue on trunk that predates this change. I haven&apos;t been around the AccessController or trunk for a while. I&apos;m not sure when this started failing. Will follow up on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8799&quot; title=&quot;TestAccessController#testBulkLoad failing on trunk/0.95&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8799&quot;&gt;&lt;del&gt;HBASE-8799&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13692633" author="hudson" created="Tue, 25 Jun 2013 00:44:06 +0000"  >&lt;p&gt;Integrated in hbase-0.95 #266 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/266/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/266/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8692&quot; title=&quot;[AccessController] Restrict HTableDescriptor enumeration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8692&quot;&gt;&lt;del&gt;HBASE-8692&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;AccessController&amp;#93;&lt;/span&gt; Restrict HTableDescriptor enumeration (Revision 1496239)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/MasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterCoprocessorHost.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/security/access/TestAccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/ruby/hbase/admin_test.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13692636" author="hudson" created="Tue, 25 Jun 2013 00:48:49 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #1025 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1025/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1025/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8692&quot; title=&quot;[AccessController] Restrict HTableDescriptor enumeration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8692&quot;&gt;&lt;del&gt;HBASE-8692&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;AccessController&amp;#93;&lt;/span&gt; Restrict HTableDescriptor enumeration (Revision 1496240)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/security/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/security/src/test/java/org/apache/hadoop/hbase/security/access/TestAccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/MasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/ipc/HMasterInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterCoprocessorHost.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/coprocessor/TestMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/ruby/hbase/admin_test.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13692656" author="hudson" created="Tue, 25 Jun 2013 01:17:43 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #582 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/582/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/582/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8692&quot; title=&quot;[AccessController] Restrict HTableDescriptor enumeration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8692&quot;&gt;&lt;del&gt;HBASE-8692&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;AccessController&amp;#93;&lt;/span&gt; Restrict HTableDescriptor enumeration (Revision 1496238)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/MasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterCoprocessorHost.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/AccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestMasterObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/security/access/TestAccessController.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/ruby/hbase/admin_test.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13694869" author="stack" created="Thu, 27 Jun 2013 17:04:12 +0000"  >&lt;p&gt;This looks to have broke TestAccessController.  See &lt;a href=&quot;http://54.241.6.143/job/HBase-0.95-Hadoop-2/org.apache.hbase$hbase-server/508/testReport/org.apache.hadoop.hbase.security.access/TestAccessController/testBulkLoad/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://54.241.6.143/job/HBase-0.95-Hadoop-2/org.apache.hbase$hbase-server/508/testReport/org.apache.hadoop.hbase.security.access/TestAccessController/testBulkLoad/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I added debug to the exception:&lt;/p&gt;

&lt;p&gt;Expected action to pass for user &apos;rwuser&apos; but was denied: org.apache.hadoop.hbase.exceptions.AccessDeniedException: org.apache.hadoop.hbase.exceptions.AccessDeniedException: Insufficient permissions (user=rwuser, scope=testBulkLoad, family=, action=CREATE)  at org.apache.hadoop.hbase.security.access.AccessController.requirePermission(AccessController.java:351)  at org.apache.hadoop.hbase.security.access.AccessController.preGetTableDescriptors(AccessController.java:1391)  at org.apache.hadoop.hbase.master.MasterCoprocessorHost.preGetTableDescriptors(MasterCoprocessorHost.java:1125)  at org.apache.hadoop.hbase.master.HMaster.getTableDescriptors(HMaster.java:2418)  at org.apache.hadoop.hbase.protobuf.generated.MasterMonitorProtos$MasterMonitorService$2.callBlockingMethod(MasterMonitorProtos.java:2702)  at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2122)  at org.apache.hadoop.hbase.ipc.RpcServer$Handler.run(RpcServer.java:1829) &lt;/p&gt;


&lt;p&gt;The rwuser does not have the now required CREATE permission.&lt;/p&gt;

&lt;p&gt;The testBulkLoad has been failing solidly for a while now.  I&apos;ll disable it for the moment till this addressed over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8799&quot; title=&quot;TestAccessController#testBulkLoad failing on trunk/0.95&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8799&quot;&gt;&lt;del&gt;HBASE-8799&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13694877" author="stack" created="Thu, 27 Jun 2013 17:12:10 +0000"  >&lt;p&gt;Here is another sample failure: &lt;a href=&quot;http://54.241.6.143/job/HBase-0.95/518/org.apache.hbase$hbase-server/testReport/org.apache.hadoop.hbase.security.access/TestAccessController/testBulkLoad/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://54.241.6.143/job/HBase-0.95/518/org.apache.hbase$hbase-server/testReport/org.apache.hadoop.hbase.security.access/TestAccessController/testBulkLoad/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13695029" author="apurtell" created="Thu, 27 Jun 2013 20:25:35 +0000"  >&lt;p&gt;I saw that failure on trunk without the htabledescriptor change. Doesn&apos;t matter will fix the failing case regardless. &lt;/p&gt;</comment>
                            <comment id="13735363" author="toffer" created="Fri, 9 Aug 2013 21:52:42 +0000"  >&lt;p&gt;It seems this patch causes calling list on the CLI to no longer work. Is that the expected behavior?&lt;/p&gt;

&lt;p&gt;Will this be enforced on the admin page as well?&lt;/p&gt;

&lt;p&gt;So it&apos;s ok to list the table names but not get the descriptors? Should we add a separate api in HMaster to provide this service then?&lt;/p&gt;</comment>
                            <comment id="13735380" author="apurtell" created="Fri, 9 Aug 2013 22:04:10 +0000"  >&lt;blockquote&gt;&lt;p&gt;It seems this patch causes calling list on the CLI to no longer work.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It works if the shell is authenticated as a principal with admin privilege. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Will this be enforced on the admin page as well?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No, because the page is rendered by the HBase daemon running under the service account, which is given superuser privilege. It&apos;s expected the UIs are protected since they leak other sensitive information. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;So it&apos;s ok to list the table names but not get the descriptors? Should we add a separate api in HMaster to provide this service then?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The requirement we had was to protect the descriptors. An expansive reading would include the table names, but I have no opinion here. A separate API for that sounds good to me. &lt;/p&gt;</comment>
                            <comment id="13735428" author="toffer" created="Fri, 9 Aug 2013 22:46:29 +0000"  >&lt;blockquote&gt;
&lt;p&gt;It works if the shell is authenticated as a principal with admin privilege.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yeah sorry that&apos;s what I meant as majority of users aren&apos;t admins and &quot;list&quot; to me is one of the first thing users do after opening the CLI. Is that the intent then? Non-admin users can&apos;t list tables?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;No, because the page is rendered by the HBase daemon running under the service account, which is given superuser privilege. It&apos;s expected the UIs are protected since they leak other sensitive information.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Instead of blocking access why not secure it like the other hadoop admin pages?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The requirement we had was to protect the descriptors. An expansive reading would include the table names, but I have no opinion here. A separate API for that sounds good to me.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I see, I&apos;m trying to come up with a clear picture of what should be secured and what&apos;s not in this context. As I&apos;m trying to how things tie in with namespaces (See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8409&quot; title=&quot;Security support for namespaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8409&quot;&gt;&lt;del&gt;HBASE-8409&lt;/del&gt;&lt;/a&gt;). Presently there&apos;s an api to list all the table descriptors of a given namespace. It sounds like that api should return table names instead.&lt;/p&gt;
</comment>
                            <comment id="13735435" author="apurtell" created="Fri, 9 Aug 2013 22:51:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;Yeah sorry that&apos;s what I meant as majority of users aren&apos;t admins and &quot;list&quot; to me is one of the first thing users do after opening the CLI. Is that the intent then? Non-admin users can&apos;t list tables?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes that is the intent, but it is a side effect of the fact the API used by the shell retrieves descriptors.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Instead of blocking access why not secure it like the other hadoop admin pages?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This patch doesn&apos;t block access to the UI. We may be talking past each other. &lt;/p&gt;

&lt;p&gt;The secure deployment model I use is only admins/operations see the UIs. Is there a JIRA open for presenting different levels of information on the UI to users authenticating with different levels of privilege? I haven&apos;t seen it. Should we have one? &lt;/p&gt;</comment>
                            <comment id="13735456" author="toffer" created="Fri, 9 Aug 2013 23:10:27 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Yes that is the intent, but it is a side effect of the fact the API used by the shell retrieves descriptors.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I see, that needs to be fixed then opened &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9182&quot; title=&quot;Allow non-admin users to list all table names&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9182&quot;&gt;&lt;del&gt;HBASE-9182&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;blockquote&gt;
&lt;p&gt;This patch doesn&apos;t block access to the UI. We may be talking past each other.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No sorry I got your message. Using the wrong words. What I meant to say was instead of recommending to protect the page. Secure it instead.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The secure deployment model I use is only admins/operations see the UIs. Is there a JIRA open for presenting different levels of information on the UI to users authenticating with different levels of privilege? I haven&apos;t seen it. Should we have one?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think we should as the other components behave in such a manner, created &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9183&quot; title=&quot;Secure Admin Page when in secure mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9183&quot;&gt;HBASE-9183&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13751479" author="jdcryans" created="Tue, 27 Aug 2013 17:34:07 +0000"  >&lt;p&gt;Fixing the &quot;Fix Version&quot; from 0.94.9 to 0.94.10, the former&apos;s RC was cut just before this was committed.&lt;/p&gt;

&lt;p&gt;Also this caused &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9314&quot; title=&quot;Dropping a table always prints a TableInfoMissingException in the master log&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9314&quot;&gt;&lt;del&gt;HBASE-9314&lt;/del&gt;&lt;/a&gt;, so now every time we delete a table we get a TableInfoMissingException+stack trace in the master log.&lt;/p&gt;</comment>
                            <comment id="13752163" author="apurtell" created="Wed, 28 Aug 2013 06:45:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;Also this caused &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9314&quot; title=&quot;Dropping a table always prints a TableInfoMissingException in the master log&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9314&quot;&gt;&lt;del&gt;HBASE-9314&lt;/del&gt;&lt;/a&gt;, so now every time we delete a table we get a TableInfoMissingException+stack trace in the master log.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Would you like this change reverted?&lt;/p&gt;</comment>
                            <comment id="13752182" author="apurtell" created="Wed, 28 Aug 2013 07:29:15 +0000"  >&lt;p&gt;Never mind, I see &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9314&quot; title=&quot;Dropping a table always prints a TableInfoMissingException in the master log&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9314&quot;&gt;&lt;del&gt;HBASE-9314&lt;/del&gt;&lt;/a&gt; marked as minor and will address this there. Apologies, when testing I had the minicluster logging at DEBUG in a terminal at 120x60 but missed it. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12709532">HBASE-11043</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12654623">HBASE-8799</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12662986">HBASE-9182</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12589499" name="8692-0.94.patch" size="23688" author="apurtell" created="Mon, 24 Jun 2013 22:22:41 +0000"/>
                            <attachment id="12589223" name="8692-0.94.patch" size="22194" author="apurtell" created="Sat, 22 Jun 2013 01:14:02 +0000"/>
                            <attachment id="12587995" name="8692-0.94.patch" size="19361" author="apurtell" created="Sat, 15 Jun 2013 23:06:53 +0000"/>
                            <attachment id="12587955" name="8692-0.94.patch" size="21377" author="apurtell" created="Sat, 15 Jun 2013 04:51:54 +0000"/>
                            <attachment id="12589498" name="8692.patch" size="23218" author="apurtell" created="Mon, 24 Jun 2013 22:22:41 +0000"/>
                            <attachment id="12589222" name="8692.patch" size="21720" author="apurtell" created="Sat, 22 Jun 2013 01:14:02 +0000"/>
                            <attachment id="12587996" name="8692.patch" size="18305" author="apurtell" created="Sat, 15 Jun 2013 23:06:53 +0000"/>
                            <attachment id="12587954" name="8692.patch" size="20079" author="apurtell" created="Sat, 15 Jun 2013 04:51:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 15 Jun 2013 05:07:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331389</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1l65b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331721</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>This change adds support for restricting access to table schema. Only a user with GLOBAL ADMIN privilege can enumerate the full list of table schemas. If passed a list of specific tables, the AccessController will check that the user has either GLOBAL ADMIN privs, or TABLE ADMIN or TABLE CREATE privs for all of the listed tables before allowing the request.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>