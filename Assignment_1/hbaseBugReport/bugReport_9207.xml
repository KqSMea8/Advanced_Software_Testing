<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:02:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-9207/HBASE-9207.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-9207] An Offline SplitParent Region can be assigned breaking split references</title>
                <link>https://issues.apache.org/jira/browse/HBASE-9207</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;An offline split parent region can be assigned by using &apos;assign&apos; from shell.&lt;/p&gt;

&lt;p&gt;This may trigger a compaction on the split parent region that should be offline, breaking the references of the two daughters.&lt;/p&gt;

&lt;p&gt;The easy way to test this is:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;disable compactions&lt;/li&gt;
	&lt;li&gt;create a table and insert some row&lt;/li&gt;
	&lt;li&gt;split&lt;/li&gt;
	&lt;li&gt;shutdown the master (otherwise there&apos;s a state checked inside the AssignmentManager)&lt;/li&gt;
	&lt;li&gt;start the master&lt;/li&gt;
	&lt;li&gt;assign the region marked as OFFLINE =&amp;gt; true, SPLIT =&amp;gt; true (the compaction on region startup will probably break the reference of the two  daughters)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12663504">HBASE-9207</key>
            <summary>An Offline SplitParent Region can be assigned breaking split references</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jxiang">Jimmy Xiang</assignee>
                                    <reporter username="mbertozzi">Matteo Bertozzi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Aug 2013 20:20:37 +0000</created>
                <updated>Tue, 24 Sep 2013 20:32:57 +0000</updated>
                            <resolved>Thu, 15 Aug 2013 20:11:42 +0000</resolved>
                                    <version>0.98.0</version>
                    <version>0.95.1</version>
                    <version>0.94.10</version>
                                    <fixVersion>0.94.12</fixVersion>
                                    <component>Region Assignment</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13738767" author="lhofhansl" created="Tue, 13 Aug 2013 20:22:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt;, since you are both good with the patch, I am planning to commit soon.&lt;/p&gt;</comment>
                            <comment id="13738782" author="yuzhihong@gmail.com" created="Tue, 13 Aug 2013 20:28:57 +0000"  >&lt;p&gt;LOG says &quot;Skipping assign of &quot;, but the flow continues ?&lt;/p&gt;</comment>
                            <comment id="13738786" author="jxiang" created="Tue, 13 Aug 2013 20:31:52 +0000"  >&lt;p&gt;Good catch, Ted.  Missed the return line. Thanks.&lt;/p&gt;</comment>
                            <comment id="13738792" author="lhofhansl" created="Tue, 13 Aug 2013 20:35:29 +0000"  >&lt;p&gt;Thanks Ted.&lt;/p&gt;</comment>
                            <comment id="13738824" author="jxiang" created="Tue, 13 Aug 2013 21:02:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;, the patch may not be good. It doesn&apos;t handle partial split well. We can fix it in 0.94.12.&lt;/p&gt;</comment>
                            <comment id="13738992" author="lhofhansl" created="Tue, 13 Aug 2013 23:12:41 +0000"  >&lt;p&gt;Should I delay the whole change into 0.94.12, or is the partial fix here fine?&lt;/p&gt;</comment>
                            <comment id="13739019" author="jxiang" created="Tue, 13 Aug 2013 23:33:07 +0000"  >&lt;p&gt;The whole change.  In 0.94, the parent is offline but the daughter may not be added.&lt;/p&gt;</comment>
                            <comment id="13739024" author="lhofhansl" created="Tue, 13 Aug 2013 23:38:43 +0000"  >&lt;p&gt;K... Pushing to 0.94.12&lt;/p&gt;</comment>
                            <comment id="13740272" author="hadoopqa" created="Wed, 14 Aug 2013 22:09:10 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12598063/0.94-9207_v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12598063/0.94-9207_v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6750//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6750//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13741177" author="mbertozzi" created="Thu, 15 Aug 2013 16:55:34 +0000"  >&lt;p&gt;+1, v3 looks good to me,&lt;/p&gt;

&lt;p&gt;doing some testing I ended up with the client stuck waiting for the offline region to be available &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9233&quot; title=&quot;isTableAvailable() may be stuck if an offline parent was never assigned&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9233&quot;&gt;&lt;del&gt;HBASE-9233&lt;/del&gt;&lt;/a&gt;. so an older client talking to a newer server with this patch may end up waiting until the timeout. but that is only in the case of meta recovery, and in my opinion is better waiting a bit longer instead of assigning a parent region and break the daughter&apos; references.&lt;/p&gt;</comment>
                            <comment id="13741200" author="jxiang" created="Thu, 15 Aug 2013 17:13:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;, could you take a look at v3?&lt;/p&gt;</comment>
                            <comment id="13741218" author="yuzhihong@gmail.com" created="Thu, 15 Aug 2013 17:25:09 +0000"  >&lt;p&gt;Minor comment:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCreateTableHandlerIfCalledTwoTimesAndFirstOneIsUnderProgress() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
+    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] tableName = Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;testCreateTableHandlerIfCalledTwoTimes&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should table name match test case ?&lt;/p&gt;

&lt;p&gt;For testCreateTableWithSplitRegion():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    fs.delete(tempTableDir, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// Clean up temp table dir &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should return value be checked ?&lt;/p&gt;</comment>
                            <comment id="13741228" author="jxiang" created="Thu, 15 Aug 2013 17:29:09 +0000"  >&lt;p&gt;The test case name is too long that&apos;s why I cut it short.  It is still unique.&lt;br/&gt;
For the return value, I didn&apos;t check it since this is a test, which will fail anyway if deletion fails.&lt;/p&gt;</comment>
                            <comment id="13741245" author="yuzhihong@gmail.com" created="Thu, 15 Aug 2013 17:38:30 +0000"  >&lt;p&gt;How about naming the test testCreateTableHdlrIfCalledTwicesAndFirstIsInProgress ?&lt;/p&gt;</comment>
                            <comment id="13741275" author="jxiang" created="Thu, 15 Aug 2013 17:56:32 +0000"  >&lt;p&gt;Sure, I will rename the test case.&lt;/p&gt;</comment>
                            <comment id="13741287" author="yuzhihong@gmail.com" created="Thu, 15 Aug 2013 18:06:55 +0000"  >&lt;p&gt;+1 from me.&lt;/p&gt;</comment>
                            <comment id="13741290" author="jxiang" created="Thu, 15 Aug 2013 18:13:20 +0000"  >&lt;p&gt;Attached v4, addressed some review comments.&lt;/p&gt;</comment>
                            <comment id="13741296" author="jdcryans" created="Thu, 15 Aug 2013 18:19:01 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13741337" author="lhofhansl" created="Thu, 15 Aug 2013 18:49:29 +0000"  >&lt;p&gt;lgtm (not really the area of the code I know well, though). Also removing some dead code, which is nice.&lt;br/&gt;
+1&lt;/p&gt;</comment>
                            <comment id="13741397" author="hadoopqa" created="Thu, 15 Aug 2013 19:46:00 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12598258/0.94-9207_v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12598258/0.94-9207_v4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6764//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6764//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13741429" author="jxiang" created="Thu, 15 Aug 2013 20:11:42 +0000"  >&lt;p&gt;Integrated into 0.94.  Thanks all.&lt;/p&gt;</comment>
                            <comment id="13741492" author="hudson" created="Thu, 15 Aug 2013 21:18:55 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94 #1112 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1112/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1112/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9207&quot; title=&quot;An Offline SplitParent Region can be assigned breaking split references&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9207&quot;&gt;&lt;del&gt;HBASE-9207&lt;/del&gt;&lt;/a&gt; An Offline SplitParent Region can be assigned breaking split references (jxiang: rev 1514464)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/handler/TestCreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransactionOnCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13741494" author="hudson" created="Thu, 15 Aug 2013 21:22:55 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94-security #258 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/258/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/258/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9207&quot; title=&quot;An Offline SplitParent Region can be assigned breaking split references&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9207&quot;&gt;&lt;del&gt;HBASE-9207&lt;/del&gt;&lt;/a&gt; An Offline SplitParent Region can be assigned breaking split references (jxiang: rev 1514464)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/handler/TestCreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransactionOnCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="12663415">HBASE-9204</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12653553">HBASE-8760</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12597806" name="0.94-9204.patch" size="715" author="lhofhansl" created="Tue, 13 Aug 2013 20:20:38 +0000"/>
                            <attachment id="12597815" name="0.94-9204_v2.patch" size="730" author="jxiang" created="Tue, 13 Aug 2013 20:31:52 +0000"/>
                            <attachment id="12598063" name="0.94-9207_v3.patch" size="13986" author="jxiang" created="Wed, 14 Aug 2013 21:22:38 +0000"/>
                            <attachment id="12598258" name="0.94-9207_v4.patch" size="14391" author="jxiang" created="Thu, 15 Aug 2013 18:13:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Aug 2013 20:22:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343505</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n8m7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343809</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>