<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:56:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1851/HBASE-1851.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1851] Broken master failover</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1851</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Master crashed, SIGSEGV (0xb) at pc=0x00000031a40fea07, pid=14689, tid=1133910336.  Four other masters running ready to take the failover.  I see where we move to new master but there is an error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2009-09-13 22:07:02,061 DEBUG org.apache.hadoop.hbase.zookeeper.ZooKeeperWrapper: Wrote master address XX.XX.XX.251:20000 to ZooKeeper
2009-09-13 22:07:02,064 WARN org.apache.hadoop.hbase.zookeeper.ZooKeeperWrapper: Failed to set state node in ZooKeeper
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase/shutdown
        at org.apache.zookeeper.KeeperException.create(KeeperException.java:110)
        at org.apache.zookeeper.KeeperException.create(KeeperException.java:42)
        at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:522)
        at org.apache.hadoop.hbase.zookeeper.ZooKeeperWrapper.setClusterState(ZooKeeperWrapper.java:279)
        at org.apache.hadoop.hbase.master.HMaster.writeAddressToZooKeeper(HMaster.java:270)
        at org.apache.hadoop.hbase.master.HMaster.&amp;lt;init&amp;gt;(HMaster.java:255)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)
        at java.lang.reflect.Constructor.newInstance(Unknown Source)
        at org.apache.hadoop.hbase.master.HMaster.doMain(HMaster.java:1200)
        at org.apache.hadoop.hbase.master.HMaster.main(HMaster.java:1241)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is /hbase/shutdown now ephemeral?&lt;/p&gt;

&lt;p&gt;Otherwise, the transition went off well it seems.&lt;/p&gt;

&lt;p&gt;Except, if I look in zk &amp;#8211; this is a good while after teh event &amp;#8211; I do not see a master.. its empty.  Do we not record in zk on failover?&lt;/p&gt;

&lt;p&gt;But then a split comes in:&lt;/p&gt;

&lt;p&gt;2009-09-17 05:50:05,070 INFO org.apache.hadoop.hbase.master.BaseScanner: All 1 .META. region(s) scanned&lt;br/&gt;
2009-09-17 05:50:30,745 INFO org.apache.hadoop.hbase.master.ServerManager: Processing MSG_REPORT_SPLIT: enwikibase_dumpurls,,1253145470066: Daughters; enwikibase_dum&lt;br/&gt;
purls,,1253166628107, enwikibase_dumpurls,EzAdzwPBtG_o9BLsEqu4bV\x3D\x3D,1253166628107 from aa0-018-6.u.powerset.com,20020,1251458355425; 1 of 3&lt;br/&gt;
2009-09-17 05:50:30,745 DEBUG org.apache.hadoop.hbase.master.RegionManager: Assigning for address: XX.XX.44.91:20020, startcode: 1251458355425, load: (requests=0, r&lt;br/&gt;
egions=3, usedHeap=490, maxHeap=2031): total nregions to assign=2, nregions to reach balance=4, isMetaAssign=false&lt;br/&gt;
2009-09-17 05:50:30,838 DEBUG org.apache.hadoop.hbase.master.RegionManager: Assigning for address: XX.XX.44.49:20020, startcode: 1250638276455, load: (requests=3, r&lt;br/&gt;
egions=4, usedHeap=134, maxHeap=2031): total nregions to assign=2, nregions to reach balance=4, isMetaAssign=false&lt;br/&gt;
2009-09-17 05:50:31,117 DEBUG org.apache.hadoop.hbase.master.RegionManager: Assigning for address: XX.XX.45.128:20020, startcode: 1250638269214, load: (requests=5, &lt;br/&gt;
regions=4, usedHeap=130, maxHeap=2031): total nregions to assign=2, nregions to reach balance=4, isMetaAssign=false&lt;br/&gt;
2009-09-17 05:50:31,119 DEBUG org.apache.hadoop.hbase.master.RegionManager: Assigning for address: XX.XX.45.221:20020, startcode: 1250638268709, load: (requests=5, &lt;br/&gt;
regions=4, usedHeap=82, maxHeap=2031): total nregions to assign=2, nregions to reach balance=4, isMetaAssign=false&lt;br/&gt;
2009-09-17 05:50:31,150 DEBUG org.apache.hadoop.hbase.master.RegionManager: Assigning for address: XX.XX.44.75:20020, startcode: 1250638276632, load: (requests=9, r&lt;br/&gt;
egions=4, usedHeap=284, maxHeap=2031): total nregions to assign=2, nregions to reach balance=4, isMetaAssign=false&lt;br/&gt;
2009-09-17 05:50:31,215 DEBUG org.apache.hadoop.hbase.master.RegionManager: Assigning for address: XX.XX.45.180:20020, startcode: 1250638269143, load: (requests=11,&lt;br/&gt;
 regions=4, usedHeap=132, maxHeap=2031): total nregions to assign=2, nregions to reach balance=4, isMetaAssign=false&lt;br/&gt;
2009-09-17 05:50:31,265 DEBUG org.apache.hadoop.hbase.master.RegionManager: Assigning for address: XX.XX.45.121:20020, startcode: 1250638269297, load: (requests=5, &lt;br/&gt;
regions=4, usedHeap=54, maxHeap=2031): total nregions to assign=2, nregions to reach balance=4, isMetaAssign=false&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;And we never recover from the above (12 hours and still at it).&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12435986">HBASE-1851</key>
            <summary>Broken master failover</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="streamy">Jonathan Gray</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Sep 2009 19:38:16 +0000</created>
                <updated>Thu, 2 Dec 2010 03:52:25 +0000</updated>
                            <resolved>Thu, 2 Dec 2010 03:52:25 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12756738" author="jdcryans" created="Thu, 17 Sep 2009 19:54:12 +0000"  >&lt;p&gt;The shutdown node exception is ok, this is just a warn that tells us the cluster is running... it could be clearer tho.&lt;/p&gt;

&lt;p&gt;Also we see that the master znode was written just before so it should have stayed there. The region servers at the same moment should be telling in the logs that they found a new master. Something else happened after that?&lt;/p&gt;</comment>
                            <comment id="12756749" author="stack" created="Thu, 17 Sep 2009 20:15:28 +0000"  >&lt;p&gt;Regionservers seemed to ride over the new master fine.  When split came in, assignment went wacky and the master seemed uncontactable:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2009-09-17 17:42:55,981 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 3 time(s).
2009-09-17 17:42:57,001 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 4 time(s).
2009-09-17 17:42:58,021 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 5 time(s).
2009-09-17 17:42:59,031 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 6 time(s).
2009-09-17 17:43:00,041 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 7 time(s).
2009-09-17 17:43:01,051 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 8 time(s).
2009-09-17 17:43:02,061 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 9 time(s).
2009-09-17 17:43:02,062 ERROR org.apache.hadoop.hbase.regionserver.HRegionServer: Exceeded max retries: 10
java.net.ConnectException: Connection refused
        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
        at sun.nio.ch.SocketChannelImpl.finishConnect(Unknown Source)
        at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
        at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:404)
        at org.apache.hadoop.hbase.ipc.HBaseClient$Connection.setupIOstreams(HBaseClient.java:307)
        at org.apache.hadoop.hbase.ipc.HBaseClient.getConnection(HBaseClient.java:831)
        at org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:712)
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Invoker.invoke(HBaseRPC.java:328)
        at $Proxy0.regionServerReport(Unknown Source)
        at org.apache.hadoop.hbase.regionserver.HRegionServer.run(HRegionServer.java:476)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(Unknown Source)
2009-09-17 17:43:03,071 WARN org.apache.hadoop.hbase.regionserver.HRegionServer: unable to report to master &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 329804129 milliseconds - retrying
2009-09-17 17:43:04,091 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 0 time(s).
2009-09-17 17:43:05,101 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 1 time(s).
2009-09-17 17:43:06,111 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 2 time(s).
2009-09-17 17:43:07,121 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 3 time(s).
2009-09-17 17:43:08,131 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 4 time(s).
2009-09-17 17:43:09,151 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 5 time(s).
2009-09-17 17:43:10,171 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 6 time(s).
2009-09-17 17:43:11,181 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 7 time(s).
2009-09-17 17:43:12,191 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 8 time(s).
2009-09-17 17:43:13,201 INFO org.apache.hadoop.ipc.HBaseClient: Retrying connect to server: /XX.XX.XX.231:20000. Already tried 9 time(s).
2009-09-17 17:43:13,201 ERROR org.apache.hadoop.hbase.regionserver.HRegionServer: Exceeded max retries: 10
java.net.ConnectException: Connection refused
        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
        at sun.nio.ch.SocketChannelImpl.finishConnect(Unknown Source)
        at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
        at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:404)
        at org.apache.hadoop.hbase.ipc.HBaseClient$Connection.setupIOstreams(HBaseClient.java:307)
        at org.apache.hadoop.hbase.ipc.HBaseClient.getConnection(HBaseClient.java:831)
        at org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:712)
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Invoker.invoke(HBaseRPC.java:328)
        at $Proxy0.regionServerReport(Unknown Source)
        at org.apache.hadoop.hbase.regionserver.HRegionServer.run(HRegionServer.java:476)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(Unknown Source)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="12886951" author="streamy" created="Fri, 9 Jul 2010 23:58:51 +0000"  >&lt;p&gt;Changes being done in the master rewrite branch will fix this issue.&lt;/p&gt;</comment>
                            <comment id="12904891" author="stack" created="Wed, 1 Sep 2010 03:45:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2692&quot; title=&quot;Master rewrite and cleanup for 0.90&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2692&quot;&gt;&lt;del&gt;HBASE-2692&lt;/del&gt;&lt;/a&gt; went in.  Write a unit test to prove that this has been fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2692&quot; title=&quot;Master rewrite and cleanup for 0.90&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2692&quot;&gt;&lt;del&gt;HBASE-2692&lt;/del&gt;&lt;/a&gt; changes.&lt;/p&gt;</comment>
                            <comment id="12965982" author="streamy" created="Thu, 2 Dec 2010 03:52:25 +0000"  >&lt;p&gt;Not applicable anymore&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12466475">HBASE-2692</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 17 Sep 2009 19:54:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26016</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 3 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hfm7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99792</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>