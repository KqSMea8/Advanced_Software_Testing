<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:42:15 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13337/HBASE-13337.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13337] Table regions are not assigning back, after restarting all regionservers at once.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13337</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Regions of the table are continouly in state=FAILED_CLOSE.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Region					State																				RIT time (ms)
8f62e819b356736053e06240f7f7c6fd	t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd. state=FAILED_CLOSE, ts=Thu Mar 26 15:05:36 IST 2015 (113s ago), server=VM1,16040,1427362531818	113929
caf59209ae65ea80fca6bdc6996a7d68	t1,dddddddd,1427362431330.caf59209ae65ea80fca6bdc6996a7d68. state=FAILED_CLOSE, ts=Thu Mar 26 15:05:36 IST 2015 (113s ago), server=VM2,16040,1427362533691	113929
db52a74988f71e5cf257bbabf31f26f3	t1,44444444,1427362431330.db52a74988f71e5cf257bbabf31f26f3. state=FAILED_CLOSE, ts=Thu Mar 26 15:05:36 IST 2015 (113s ago), server=VM3,16040,1427362533691	113920
43f3a65b9f9ff283f598c5450feab1f8	t1,88888888,1427362431330.43f3a65b9f9ff283f598c5450feab1f8. state=FAILED_CLOSE, ts=Thu Mar 26 15:05:36 IST 2015 (113s ago), server=VM1,16040,1427362531818	113920
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;b&gt;Steps to reproduce:&lt;/b&gt;&lt;br/&gt;
1. Start HBase cluster with more than one regionserver.&lt;br/&gt;
2. Create a table with precreated regions. (lets say 15 regions)&lt;br/&gt;
3. Make sure the regions are well balanced.&lt;br/&gt;
4. Restart all the Regionservers process at once across the cluster, except HMaster process&lt;br/&gt;
5. After restarting the Regionservers, successfully will connect to the HMaster.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Bug:&lt;/b&gt;&lt;br/&gt;
But no regions are assigning back to the Regionservers.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Master log shows as follows:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-03-26 15:05:36,201 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.RegionStates: Transition {8f62e819b356736053e06240f7f7c6fd state=OFFLINE, ts=1427362536106, server=VM2,16040,1427362242602} to {8f62e819b356736053e06240f7f7c6fd state=PENDING_OPEN, ts=1427362536201, server=VM1,16040,1427362531818}
2015-03-26 15:05:36,202 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.RegionStateStore: Updating row t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd. with state=PENDING_OPEN&amp;amp;sn=VM1,16040,1427362531818
2015-03-26 15:05:36,244 DEBUG [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Force region state offline {8f62e819b356736053e06240f7f7c6fd state=PENDING_OPEN, ts=1427362536201, server=VM1,16040,1427362531818}
2015-03-26 15:05:36,244 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.RegionStates: Transition {8f62e819b356736053e06240f7f7c6fd state=PENDING_OPEN, ts=1427362536201, server=VM1,16040,1427362531818} to {8f62e819b356736053e06240f7f7c6fd state=PENDING_CLOSE, ts=1427362536244, server=VM1,16040,1427362531818}
2015-03-26 15:05:36,244 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.RegionStateStore: Updating row t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd. with state=PENDING_CLOSE
2015-03-26 15:05:36,248 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=1 of 10
2015-03-26 15:05:36,248 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=2 of 10
2015-03-26 15:05:36,249 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=3 of 10
2015-03-26 15:05:36,249 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=4 of 10
2015-03-26 15:05:36,249 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=5 of 10
2015-03-26 15:05:36,250 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=6 of 10
2015-03-26 15:05:36,250 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=7 of 10
2015-03-26 15:05:36,250 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=8 of 10
2015-03-26 15:05:36,251 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=9 of 10
2015-03-26 15:05:36,251 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.AssignmentManager: Server VM1,16040,1427362531818 returned java.nio.channels.ClosedChannelException for t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd., try=10 of 10
2015-03-26 15:05:36,251 WARN  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.RegionStates: Failed to open/close 8f62e819b356736053e06240f7f7c6fd on VM1,16040,1427362531818, set to FAILED_CLOSE
2015-03-26 15:05:36,251 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.RegionStates: Transition {8f62e819b356736053e06240f7f7c6fd state=PENDING_CLOSE, ts=1427362536244, server=VM1,16040,1427362531818} to {8f62e819b356736053e06240f7f7c6fd state=FAILED_CLOSE, ts=1427362536251, server=VM1,16040,1427362531818}
2015-03-26 15:05:36,251 INFO  [VM2,16020,1427362216887-GeneralBulkAssigner-0] master.RegionStateStore: Updating row t1,55555555,1427362431330.8f62e819b356736053e06240f7f7c6fd. with state=FAILED_CLOSE
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12785836">HBASE-13337</key>
            <summary>Table regions are not assigning back, after restarting all regionservers at once.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="asamir">Samir Ahmic</assignee>
                                    <reporter username="sreenivasulureddy">Y. SREENIVASULU REDDY</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Mar 2015 10:26:40 +0000</created>
                <updated>Tue, 15 Sep 2015 20:39:13 +0000</updated>
                            <resolved>Thu, 9 Jul 2015 00:25:02 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.1.2</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>Region Assignment</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>21</watches>
                                                                <comments>
                            <comment id="14381665" author="ram_krish" created="Thu, 26 Mar 2015 10:29:56 +0000"  >&lt;p&gt;I think the same thing happens when there is one RS.  When we stop and start the RS we are not able to get any regions assigned.&lt;/p&gt;</comment>
                            <comment id="14381714" author="ashish singhi" created="Thu, 26 Mar 2015 11:06:58 +0000"  >&lt;p&gt;I am assigning this to me.&lt;br/&gt;
If any one else wants to take over, please feel free.&lt;/p&gt;</comment>
                            <comment id="14382761" author="lhofhansl" created="Thu, 26 Mar 2015 21:52:57 +0000"  >&lt;p&gt;I thought we had fixed that a long time ago. I assume when you restarted the cluster the default HMaster&apos;s wait fime (4.5s) is long enough for all former region server to startup and sign-in?&lt;/p&gt;</comment>
                            <comment id="14382767" author="lhofhansl" created="Thu, 26 Mar 2015 21:54:17 +0000"  >&lt;p&gt;Oh wait. You&apos;re &lt;b&gt;not&lt;/b&gt; restarting the HMaster. I see, yeah possible - but not excusable - that we missed that.&lt;/p&gt;</comment>
                            <comment id="14382773" author="lhofhansl" created="Thu, 26 Mar 2015 21:56:17 +0000"  >&lt;p&gt;On the other hand, what is the HMaster to do? When an RS dies we want to assign its region as fast as possible. If you bring down all region servers by killing the processes we have a fail fast logic that immediately reassigns the regions.&lt;br/&gt;
So when somebody plans to bring down all region server, the HMaster should be brought down as well.&lt;/p&gt;</comment>
                            <comment id="14383335" author="sreenivasulureddy" created="Fri, 27 Mar 2015 05:00:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;br/&gt;
All regionservers are restarted graceful, &lt;/p&gt;

&lt;p&gt;I tested one more scenario like out of 3 regionservers make down one regionserver graceful, in this case it is assigning properly.&lt;/p&gt;

&lt;p&gt;All regionservers making down and startup again only causing problem.&lt;/p&gt;</comment>
                            <comment id="14383352" author="lhofhansl" created="Fri, 27 Mar 2015 05:22:40 +0000"  >&lt;p&gt;Right. But when all region servers are gone, HMaster cannot assign any regions. As soon as the first few region servers are seen by the master again, it&apos;ll assign all the regions to them.&lt;br/&gt;
In some case that might be what you want, in others it&apos;s not. Unless we tell the master it can&apos;t know.&lt;/p&gt;

&lt;p&gt;We can add some guessing of course. Maybe when more than 1/2 of the region server are suddenly gone, wait a bit before reassigning the regions. But I will bet that any guessing we do will have somebody complain.&lt;/p&gt;

&lt;p&gt;Or we can invent a new API to tell the master to hold off assigning regions.&lt;/p&gt;

&lt;p&gt;In the end the the solution is simple: If you plan to bring down many region servers, stop the HMaster first.&lt;/p&gt;</comment>
                            <comment id="14383357" author="ram_krish" created="Fri, 27 Mar 2015 05:29:47 +0000"  >&lt;p&gt;I think the intent here is that previously when such thing happen when all RS were stopped, and again brought up the HMaster was in a position to assign regions and not making the cluster hang.  Same was the case with a single RS set up also.  The HMaster was able to assign once the RS was restarted. Now it is not so.  &lt;br/&gt;
Am i right about the intention of this issue &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sreenivasulu&quot; class=&quot;user-hover&quot; rel=&quot;sreenivasulu&quot;&gt;sreenivasulu&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14383361" author="mantonov" created="Fri, 27 Mar 2015 05:34:00 +0000"  >&lt;p&gt;Just to make sure I understood correctly - so when all RS&apos;s are restarted simultaneously, HMaster decides not to assign to prevent re-assignment storm? I thought in such situation master will start assignment as soon as restarted RSs start checking back in, and in next minutes (or may be tens of minutes) the regions would be reassigned?&lt;/p&gt;</comment>
                            <comment id="14383379" author="sreenivasulureddy" created="Fri, 27 Mar 2015 05:53:38 +0000"  >&lt;p&gt;correct &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt; &lt;br/&gt;
I verified the same scenario in HBase-0.98.11 version, there it is assigning properly back to the newly restarted regionservers, and able to perform the operations on those regions.&lt;/p&gt;</comment>
                            <comment id="14383430" author="octo47" created="Fri, 27 Mar 2015 06:58:40 +0000"  >&lt;p&gt;that was changed to prevent assignment storm. you can try to ping balancer&lt;br/&gt;
manually, it should start assignments&lt;/p&gt;

&lt;p&gt;On Friday, March 27, 2015, Y. SREENIVASULU REDDY (JIRA) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;



&lt;p&gt;&amp;#8211; &lt;br/&gt;
Andrey.&lt;/p&gt;</comment>
                            <comment id="14383439" author="ashish singhi" created="Fri, 27 Mar 2015 07:05:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;you can try to ping balancer manually, it should start assignments&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No it will not, as the regions are in transition.&lt;/p&gt;</comment>
                            <comment id="14384291" author="lhofhansl" created="Fri, 27 Mar 2015 18:20:31 +0000"  >&lt;p&gt;Wait, what&apos;s the issue? Looks like I have misunderstood. I read it as &quot;the HMaster is not assigning the region back to the &lt;em&gt;original&lt;/em&gt; region server, destroying data locality&quot;.&lt;/p&gt;

&lt;p&gt;But you are saying no regions are assigned all, to any region server?&lt;/p&gt;

&lt;p&gt;That&apos;d definitely bad! And I agree with the blocker status then. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt;, wanna have a quick look?&lt;/p&gt;
</comment>
                            <comment id="14384353" author="jxiang" created="Fri, 27 Mar 2015 18:46:38 +0000"  >&lt;p&gt;At step 4, all the region servers are down, master needs to split log and recover those regions. In ServerShutdownHandler, we have&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;          while (!this.server.isStopped() &amp;amp;&amp;amp; serverManager.countOfRegionServers() &amp;lt; 2) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to wait till some regionserver joins in before assigning any region. &lt;/p&gt;

&lt;p&gt;This looks like a racing issue. Although all regionservers are down, master doesn&apos;t know it yet. So SSH starts to assign regions, which fails.&lt;/p&gt;</comment>
                            <comment id="14384394" author="jxiang" created="Fri, 27 Mar 2015 19:02:41 +0000"  >&lt;p&gt;Or master doesn&apos;t know it soon enough. It is a racing between SSH and master ZK event handling (for regionserver is gone). Possible fixes could be (1) fail the region assignments and re-queue the dead server for SSH, (2) fail the master process (by shutting down itself) if such a scenario is detected.&lt;/p&gt;</comment>
                            <comment id="14384483" author="lhofhansl" created="Fri, 27 Mar 2015 19:42:41 +0000"  >&lt;p&gt;I think this is graceful shutdown of the RSs, so log splitting would not come into play... But the 2nd case could happen.&lt;/p&gt;</comment>
                            <comment id="14384489" author="jxiang" created="Fri, 27 Mar 2015 19:47:27 +0000"  >&lt;p&gt;For graceful shutdown, no need for log splitting. Those regions on the dead server are still re-assigned by SSH if the master is not restarted.&lt;/p&gt;</comment>
                            <comment id="14384523" author="jxiang" created="Fri, 27 Mar 2015 20:11:35 +0000"  >&lt;p&gt;By the way, as a work-around, if you restart the master as step 6, all regions should be assigned as expected.&lt;/p&gt;</comment>
                            <comment id="14385517" author="sreenivasulureddy" created="Sat, 28 Mar 2015 20:40:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt;&lt;br/&gt;
In the above scenario all regionservers are graceful down.&lt;/p&gt;

&lt;p&gt;and you are correct as a step 6, if we restart the hmaster, all regions are assigning back, and able to continue with client operations.&lt;/p&gt;</comment>
                            <comment id="14385920" author="jxiang" created="Sun, 29 Mar 2015 20:05:19 +0000"  >&lt;p&gt;Thanks a lot for verifying it.&lt;/p&gt;</comment>
                            <comment id="14391637" author="jxiang" created="Wed, 1 Apr 2015 22:36:07 +0000"  >&lt;p&gt;Attached a patch that checks for such a scenario in case a region is forced to assign with a new plan. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sreenivasulureddy&quot; class=&quot;user-hover&quot; rel=&quot;sreenivasulureddy&quot;&gt;Y. SREENIVASULU REDDY&lt;/a&gt;, could you give it a try?&lt;/p&gt;</comment>
                            <comment id="14391860" author="hadoopqa" created="Thu, 2 Apr 2015 00:31:52 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12708834/HBASE-13337.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12708834/HBASE-13337.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 485800830a58da1af31beaac859d99b56d823f99.&lt;br/&gt;
  ATTACHMENT ID: 12708834&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 4 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 1 release audit warnings (more than the master&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//artifact/patchprocess/patchReleaseAuditWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//artifact/patchprocess/patchReleaseAuditWarnings.txt&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13529//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14391886" author="enis" created="Thu, 2 Apr 2015 00:54:37 +0000"  >&lt;p&gt;Does this only affect 2.0 or branch-1 as well?&lt;/p&gt;</comment>
                            <comment id="14392835" author="jxiang" created="Thu, 2 Apr 2015 15:29:29 +0000"  >&lt;p&gt;Branch-1 is affected if ZK-less assignment is turned on.&lt;/p&gt;</comment>
                            <comment id="14393279" author="jxiang" created="Thu, 2 Apr 2015 20:05:50 +0000"  >&lt;p&gt;I looked into it again and tried to reproduce it. Whenever a server is restarted, we get lots of java.nio.channels.ClosedChannelException. This is something new. So I tried with some old code, and  found out there is no such problem with the master branch commit 1723245282ba39567f7da4234cdd31ba534cb869 (Add in an hbasecon2015 logo for the banner).&lt;/p&gt;

&lt;p&gt;This seems not to be a problem with assignment. I am not sure if branch-1 is affected now.&lt;/p&gt;

&lt;p&gt;It looks like this has something to do with the aysc RPC changes. Connections seem not to be able to recover from server restarts.&lt;/p&gt;</comment>
                            <comment id="14545307" author="asamir" created="Fri, 15 May 2015 10:59:15 +0000"  >&lt;p&gt;I can confirm that this is still issue on master branch and here is what i have concluded from testing (distributed cluster):&lt;/p&gt;

&lt;p&gt;1. RS restart is enough to reproduce this issue.&lt;br/&gt;
2. As &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt;] suggested this is not problem with AM. Issue is probably related to RSRpcService on regionserver side.&lt;br/&gt;
3.  I was able to trace this issue in case of assign operation to (ServerManager.java):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
734          &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; RegionOpeningState sendRegionOpen(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ServerName server,
               HRegionInfo region, List&amp;lt;ServerName&amp;gt; favoredNodes)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;master never gets response from regionserver because of java.nio.channels.ClosedChannelException.&lt;br/&gt;
4.  From logs i have notices that when RS is in this state ServerManager#sendRegionWarmup is also failing with java.nio.channels.ClosedChannelException.&lt;br/&gt;
5. When issue is present nothing about this requests is logged on RS side so my assumption is that RPC server on rs side in some strange state.&lt;/p&gt;

&lt;p&gt;I will try to dig some more info from rs side and post it here.&lt;/p&gt;
</comment>
                            <comment id="14558272" author="asamir" created="Mon, 25 May 2015 13:52:36 +0000"  >&lt;p&gt;I was able to find root cause of this issue it is in ServerManager#getRsAdmin(), after regionserver  is restarted  &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; ClusterConnection connection &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; becomes staled and need to be recreated in order to master establish connection with restarted regionserver. Here is diff of what i did in order to fix this issue: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java
index 1ed2514..a05df3b 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java
@@ -930,8 +930,10 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class ServerManager {
         &lt;span class=&quot;code-comment&quot;&gt;// A master is also a region server now, see HBASE-10569 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; details
&lt;/span&gt;         admin = ((HRegionServer)master).getRSRpcServices();
       } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
-        admin = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.connection.getAdmin(sn);
-      }
+        Configuration conf = master.getConfiguration();
+        ClusterConnection connection = (ClusterConnection) ConnectionFactory.createConnection(conf);
+        admin = connection.getAdmin(sn);
+      }      
       &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.rsAdmins.put(sn, admin);
     }
     &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; admin;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Should i create patch or there is some better way to resolve this issue ? &lt;/p&gt;</comment>
                            <comment id="14562461" author="asamir" created="Thu, 28 May 2015 08:03:32 +0000"  >&lt;p&gt;Here is patch creating new ClusterConnection inside ServerManager#getRsAdmin()&lt;/p&gt;</comment>
                            <comment id="14562683" author="hadoopqa" created="Thu, 28 May 2015 10:55:03 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12735824/HBASE-13337-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12735824/HBASE-13337-v2.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 81b9abab0c93cb338dc3c9b91d5a917bb7f9972a.&lt;br/&gt;
  ATTACHMENT ID: 12735824&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14217//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14217//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14217//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14217//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14217//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14217//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14217//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14217//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14569330" author="eclark" created="Tue, 2 Jun 2015 15:59:34 +0000"  >&lt;p&gt;Don&apos;t you need to close the connection after you are done with the admin?&lt;/p&gt;</comment>
                            <comment id="14570474" author="asamir" created="Wed, 3 Jun 2015 08:28:21 +0000"  >&lt;p&gt;Thanks for review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;,&lt;br/&gt;
I agree connection should be closed, I will try to resolve this some some other way. Any suggestions ?&lt;/p&gt;</comment>
                            <comment id="14570685" author="asamir" created="Wed, 3 Jun 2015 11:31:28 +0000"  >&lt;p&gt;Issue is directly related with changing rpc client implementation from RpcClientImpl to AsyncRpcClient. I was testing master branch with RpcClientImpl and issue is gone. Maybe we should check how we handle connection failures in AsyncRpcClient.&lt;/p&gt;</comment>
                            <comment id="14573571" author="stack" created="Thu, 4 Jun 2015 20:58:25 +0000"  >&lt;p&gt;How is connection getting closed then &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=asamir&quot; class=&quot;user-hover&quot; rel=&quot;asamir&quot;&gt;Samir Ahmic&lt;/a&gt;? I see connection removed from rsAdmins but it is not being closed. Otherwise, patch makes sense.&lt;/p&gt;</comment>
                            <comment id="14574205" author="asamir" created="Fri, 5 Jun 2015 09:34:32 +0000"  >&lt;p&gt;Thanks for review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;,&lt;br/&gt;
As far as i can see we have two options for fixing this issue and handling connection correctly:&lt;/p&gt;

&lt;p&gt;1. Change default connection to non final and instead of creating new connection object  recreate existing connection in  ServerManager#getRsAdmin(),&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
156    -  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ClusterConnection connection;
156    +  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; ClusterConnection connection;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      Configuration conf = master.getConfiguration();
+       &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.connection = (ClusterConnection) ConnectionFactory.createConnection(conf);     
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This connection will be closed when master is shutdown.&lt;/p&gt;

&lt;p&gt;2. We can implement additional logic in ServerManager that will take care of creating new connection when rs is restarted and close/remove it when becomes staled.  &lt;/p&gt;

&lt;p&gt;I have tested first option and issue is fixed. Which method we prefer ? &lt;/p&gt;</comment>
                            <comment id="14575854" author="lhofhansl" created="Sat, 6 Jun 2015 18:03:28 +0000"  >&lt;p&gt;How does the ClusterConnection become stale? That should not happen. The whole point is that the connection is stable even as machine in the cluster (or indeed the entire cluster) have problems and are restarted.&lt;/p&gt;</comment>
                            <comment id="14585657" author="asamir" created="Mon, 15 Jun 2015 08:54:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;How does the ClusterConnection become stale?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I have already mention that issue is somewhere in  AsyncRpcClient.java and i think i have found cause why connection becomes stale. Here is code snippet from AsyncRpcClient#crateRpcChannel():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
362     rpcChannel = connections.get(hashCode);
363        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rpcChannel == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
364          rpcChannel = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AsyncRpcChannel(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.bootstrap, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, ticket, serviceName, location);
355          connections.put(hashCode, rpcChannel);
266       }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;  
&lt;p&gt;We are getting connection (actually RPC channel ) from:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
94     &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; PoolMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, AsyncRpcChannel&amp;gt; connections;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 
&lt;p&gt;without checking if channel is alive and ending up with closed channel when regioserver is restarted.  I have fixed this issue by checking if channel is  alive and replacing old one with new channel if is not.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
363        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rpcChannel == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || !rpcChannel.isAlive()) {
364          rpcChannel = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AsyncRpcChannel(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.bootstrap, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, ticket, serviceName, location);
355          connections.put(hashCode, rpcChannel);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 
&lt;p&gt;A will attach patch in few minutes.&lt;/p&gt;</comment>
                            <comment id="14585670" author="asamir" created="Mon, 15 Jun 2015 09:05:24 +0000"  >&lt;p&gt;Here is new patch tested in distributed cluster. After regionserver is restarted i was able to move regions to it without  any issues. I was using&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ graceful_stop.sh --restart --reload rsServer
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;for testing.&lt;/p&gt;</comment>
                            <comment id="14585815" author="anoop.hbase" created="Mon, 15 Jun 2015 11:41:29 +0000"  >&lt;p&gt;This change looks reasonable to me. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14585817" author="hadoopqa" created="Mon, 15 Jun 2015 11:44:01 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12739578/HBASE-13337-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12739578/HBASE-13337-v3.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 714668a40dff6d7aa9207a0846d6f8ed800276ee.&lt;br/&gt;
  ATTACHMENT ID: 12739578&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14410//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14410//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14410//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14410//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14410//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14410//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14410//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14410//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14614971" author="ram_krish" created="Mon, 6 Jul 2015 12:33:31 +0000"  >&lt;p&gt;+1 on it. Some one needs to take a look at this? &lt;/p&gt;</comment>
                            <comment id="14614986" author="anoop.hbase" created="Mon, 6 Jul 2015 12:48:30 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14616227" author="ram_krish" created="Tue, 7 Jul 2015 05:57:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=larsh&quot; class=&quot;user-hover&quot; rel=&quot;larsh&quot;&gt;larsh&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;&lt;br/&gt;
You all ok to commit this?&lt;/p&gt;</comment>
                            <comment id="14617056" author="lhofhansl" created="Tue, 7 Jul 2015 17:46:26 +0000"  >&lt;p&gt;v3 looks reasonable to me. At the very least it won&apos;t hurt &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Nice find. +1&lt;/p&gt;</comment>
                            <comment id="14619641" author="stack" created="Thu, 9 Jul 2015 00:25:02 +0000"  >&lt;p&gt;Pushed to 1.1.2+ Thanks for the fix &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=asamir&quot; class=&quot;user-hover&quot; rel=&quot;asamir&quot;&gt;Samir Ahmic&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14619666" author="hudson" created="Thu, 9 Jul 2015 00:47:22 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2-IT #43 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2-IT/43/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2-IT/43/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13337&quot; title=&quot;Table regions are not assigning back, after restarting all regionservers at once.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13337&quot;&gt;&lt;del&gt;HBASE-13337&lt;/del&gt;&lt;/a&gt; Table regions are not assigning back, after restarting all regionservers at once (Samir Ahmic) (stack: rev 035d882c7b77669c931cf5090bace2e1ce1c5c6c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/ipc/AsyncRpcClient.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14619677" author="hudson" created="Thu, 9 Jul 2015 00:55:11 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #28 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/28/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/28/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13337&quot; title=&quot;Table regions are not assigning back, after restarting all regionservers at once.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13337&quot;&gt;&lt;del&gt;HBASE-13337&lt;/del&gt;&lt;/a&gt; Table regions are not assigning back, after restarting all regionservers at once (Samir Ahmic) (stack: rev 24cf287df44d1b6d84d5f14fbf5cf254f3df3bcb)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/ipc/AsyncRpcClient.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14619744" author="hudson" created="Thu, 9 Jul 2015 02:05:34 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.1 #578 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/578/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/578/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13337&quot; title=&quot;Table regions are not assigning back, after restarting all regionservers at once.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13337&quot;&gt;&lt;del&gt;HBASE-13337&lt;/del&gt;&lt;/a&gt; Table regions are not assigning back, after restarting all regionservers at once (Samir Ahmic) (stack: rev 43397fa9c2168e36e5c6ba493e09ae820a945550)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/ipc/AsyncRpcClient.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14619750" author="hudson" created="Thu, 9 Jul 2015 02:19:24 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #43 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/43/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/43/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13337&quot; title=&quot;Table regions are not assigning back, after restarting all regionservers at once.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13337&quot;&gt;&lt;del&gt;HBASE-13337&lt;/del&gt;&lt;/a&gt; Table regions are not assigning back, after restarting all regionservers at once (Samir Ahmic) (stack: rev 24cf287df44d1b6d84d5f14fbf5cf254f3df3bcb)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/ipc/AsyncRpcClient.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14619784" author="hudson" created="Thu, 9 Jul 2015 02:56:04 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2 #58 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/58/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/58/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13337&quot; title=&quot;Table regions are not assigning back, after restarting all regionservers at once.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13337&quot;&gt;&lt;del&gt;HBASE-13337&lt;/del&gt;&lt;/a&gt; Table regions are not assigning back, after restarting all regionservers at once (Samir Ahmic) (stack: rev 035d882c7b77669c931cf5090bace2e1ce1c5c6c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/ipc/AsyncRpcClient.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14745455" author="stack" created="Tue, 15 Sep 2015 13:37:49 +0000"  >&lt;p&gt;Pushed to master branch too (mistakenly not applied along with push to branch-1+)&lt;/p&gt;</comment>
                            <comment id="14746126" author="hudson" created="Tue, 15 Sep 2015 20:39:13 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6808 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6808/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6808/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13337&quot; title=&quot;Table regions are not assigning back, after restarting all regionservers at once.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13337&quot;&gt;&lt;del&gt;HBASE-13337&lt;/del&gt;&lt;/a&gt; Table regions are not assigning back, after restarting all regionservers at once. (stack: rev f51c79076d2d4c87443dc04bc154c57093dade68)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/ipc/AsyncRpcClient.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12833404">HBASE-13792</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12735824" name="HBASE-13337-v2.patch" size="1275" author="asamir" created="Thu, 28 May 2015 08:03:32 +0000"/>
                            <attachment id="12739578" name="HBASE-13337-v3.patch" size="1185" author="asamir" created="Mon, 15 Jun 2015 09:05:24 +0000"/>
                            <attachment id="12708834" name="HBASE-13337.patch" size="2345" author="jxiang" created="Wed, 1 Apr 2015 22:36:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 26 Mar 2015 10:29:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 13 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i27e1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>