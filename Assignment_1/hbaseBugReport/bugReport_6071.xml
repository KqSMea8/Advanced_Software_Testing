<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:33:33 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6071/HBASE-6071.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6071] getRegionServerWithRetires, should log unsuccessful attempts and exceptions.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6071</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;HConnectionImplementation.getRegionServerWithRetries might terminate w/ an exception different then a DoNotRetryIOException, thus silently drops exceptions from previous attempts.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ted_yu&quot; class=&quot;user-hover&quot; rel=&quot;ted_yu&quot;&gt;Ted Yu&lt;/a&gt; suggested (&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/hbase-user/201205.mbox/%3CCAFebPXBq9V9BVdzRTNr-MB3a1Lz78SZj6gvP6On0b%2Bajt9StAg%40mail.gmail.com%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;) adding a log message inside the catch block describing the exception type and details.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12557009">HBASE-6071</key>
            <summary>getRegionServerWithRetires, should log unsuccessful attempts and exceptions.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="igalshilman">Igal Shilman</reporter>
                        <labels>
                            <label>client</label>
                            <label>ipc</label>
                    </labels>
                <created>Wed, 23 May 2012 14:23:19 +0000</created>
                <updated>Sat, 11 Apr 2015 00:22:18 +0000</updated>
                            <resolved>Sat, 11 Apr 2015 00:22:18 +0000</resolved>
                                    <version>0.92.0</version>
                    <version>0.94.0</version>
                                                    <component>Client</component>
                    <component>IPC/RPC</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13282504" author="hadoopqa" created="Thu, 24 May 2012 13:34:05 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12528963/HConnectionManager_HBASE-6071-0.90.0.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12528963/HConnectionManager_HBASE-6071-0.90.0.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1983//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1983//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13282792" author="igalshilman" created="Thu, 24 May 2012 21:36:44 +0000"  >&lt;p&gt;I didn&apos;t know that patches has to be submitted against trunk first.&lt;br/&gt;
And also, I didn&apos;t know that diff&apos;s has to be created with --no-prefix &lt;/p&gt;</comment>
                            <comment id="13282821" author="zhihyu@ebaysf.com" created="Thu, 24 May 2012 22:56:24 +0000"  >&lt;p&gt;--no-prefix is not required now - Hadoop QA is smart.&lt;/p&gt;</comment>
                            <comment id="13282889" author="igalshilman" created="Fri, 25 May 2012 01:25:38 +0000"  >&lt;p&gt;I&apos;ve created a unit test (&lt;a href=&quot;http://pastebin.com/tFDfCZP2&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://pastebin.com/tFDfCZP2&lt;/a&gt;), which is omitted from this patch and made sure that the log messages are present manually.&lt;/p&gt;</comment>
                            <comment id="13283105" author="hadoopqa" created="Fri, 25 May 2012 04:05:46 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12529461/HBASE-6071.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12529461/HBASE-6071.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 33 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1991//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1991//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1991//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1991//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1991//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1991//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13283285" author="igalshilman" created="Fri, 25 May 2012 10:20:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhihyu%40ebaysf.com&quot; class=&quot;user-hover&quot; rel=&quot;zhihyu@ebaysf.com&quot;&gt;Ted Yu&lt;/a&gt;, can you please help clarifying core tests score? I went thru the test results and didn&apos;t find any failures. Also, browsing around recently submitted patches I see the same findbugs warning count, should I conclude that this is not necessary related to this patch?&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="13283301" author="zhihyu@ebaysf.com" created="Fri, 25 May 2012 11:03:29 +0000"  >&lt;p&gt;I used my script to scan &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1991/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1991/console&lt;/a&gt; and didn&apos;t find hanging test.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; message = &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Exception during &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; #%d (out of %d):&quot;&lt;/span&gt;,tries+1, numRetries);
+          LOG.debug(message,t);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;nit: space should be inserted between comma and tries, between comma and t.&lt;/p&gt;

&lt;p&gt;My original intention was using the above debug log to facilitate finding root cause.&lt;br/&gt;
It would be nice if debug log is added to 0.90 release you&apos;re using and see what we get.&lt;/p&gt;</comment>
                            <comment id="13283302" author="zhihyu@ebaysf.com" created="Fri, 25 May 2012 11:09:35 +0000"  >&lt;p&gt;If you look at ScannerCallable.java in trunk, you would see the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; LOG_SCANNER_ACTIVITY = &lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.client.log.scanner.activity&quot;&lt;/span&gt;;
...
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (logScannerActivity) {
            LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Got exception in fetching from scanner=&quot;&lt;/span&gt;
              + scannerId, e);
          }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;You can backport related code and set hbase.client.log.scanner.activity to true.&lt;br/&gt;
This way you would see the exception in log.&lt;/p&gt;</comment>
                            <comment id="13283986" author="igalshilman" created="Sat, 26 May 2012 14:13:01 +0000"  >&lt;p&gt;Thanks for commenting, I would like to clarify:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;My original intention was using the above debug log to facilitate finding root cause.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Our 0.90.4 production clients are already patched, following your suggestion from the mailing list.&lt;br/&gt;
We are still waiting for the original error to occur (it happens infrequently) and when it&apos;ll happen I&apos;ll report back w/ the details.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It would be nice if debug log is added to 0.90 release you&apos;re using and see what we get.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I have also prepared a patch for the 0.90 branch, backporting hbase.client.log.scanner.activity to the ScannerCallable. If it has any value besides debugging our case, I&apos;d be happy to submit it.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;getRegionServerWithRetires, should log unsuccessful attempts and exceptions.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I understand that trunk&apos;s ScannerCallable has a hbase.client.log.scanner.activity option, that enables logging failures from the scanner&apos;s side, yet ServerCallable along w/ its retry facility is being used by others as well, so they are still affected by the issue reported in this JIRA. Therefore, following your initial intention, I&apos;m suggesting the patch for the trunk (+ backport, if approved) that simply logs an exception at each retry.&lt;/p&gt;</comment>
                            <comment id="13283987" author="hadoopqa" created="Sat, 26 May 2012 14:21:48 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12529868/HBASE-6071.v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12529868/HBASE-6071.v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2008//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2008//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13284013" author="zhihyu@ebaysf.com" created="Sat, 26 May 2012 16:12:45 +0000"  >&lt;p&gt;Thanks for the explanation, Igal.&lt;/p&gt;

&lt;p&gt;I&apos;d be happy to see the output from your patch running in 0.90.4 production.&lt;/p&gt;

&lt;p&gt;FYI &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4336&quot; title=&quot;Convert source tree into maven modules&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4336&quot;&gt;&lt;del&gt;HBASE-4336&lt;/del&gt;&lt;/a&gt; has changed source structure.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; message = &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Exception during &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; #%d (out of %d):&quot;&lt;/span&gt;, tries+1, numRetries);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above line is beyond 100 chars, please wrap the last parameter.&lt;/p&gt;</comment>
                            <comment id="13431083" author="igalshilman" created="Wed, 8 Aug 2012 12:31:30 +0000"  >&lt;p&gt;We&apos;ve managed to catch another lease exception, this time with the patched client. Attaching the relevant bits from the logs (client &amp;amp; region server).&lt;/p&gt;</comment>
                            <comment id="13431090" author="hadoopqa" created="Wed, 8 Aug 2012 12:44:41 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12539860/lease-exception.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12539860/lease-exception.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2534//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2534//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13459660" author="qwertymaniac" created="Thu, 20 Sep 2012 15:14:38 +0000"  >&lt;p&gt;Nice patch. I&apos;d prefer if we logged this at INFO itself though. This sorta retry is also known to kill remote bulkloads with tons of re-requests presently and we wouldn&apos;t know that if we didn&apos;t catch it via logs.&lt;/p&gt;

&lt;p&gt;Secondly, it is tough on many older versions of Hadoop to enable DEBUG level logs in MR (where this (LE) is often reported from).&lt;/p&gt;</comment>
                            <comment id="13460372" author="igalshilman" created="Fri, 21 Sep 2012 09:01:17 +0000"  >&lt;p&gt;Changing debug level to info.&lt;/p&gt;</comment>
                            <comment id="13460415" author="qwertymaniac" created="Fri, 21 Sep 2012 10:45:40 +0000"  >&lt;p&gt;Thanks for addressing my comment Igal, this looks good to me (am not a committer on HBase).&lt;/p&gt;</comment>
                            <comment id="13460429" author="igalshilman" created="Fri, 21 Sep 2012 11:07:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qwertymaniac&quot; class=&quot;user-hover&quot; rel=&quot;qwertymaniac&quot;&gt;Harsh J&lt;/a&gt; n/p.   &lt;/p&gt;</comment>
                            <comment id="13460433" author="hadoopqa" created="Fri, 21 Sep 2012 11:39:28 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12546017/HBASE-6071.v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12546017/HBASE-6071.v4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated 139 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 7 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestMultiParallel&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestForceCacheImportantBlocks&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2915//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13460709" author="stack" created="Fri, 21 Sep 2012 18:57:20 +0000"  >&lt;p&gt;How much more log does this patch generate Igal?  As I read it, it is logging every retry.&lt;/p&gt;

&lt;p&gt;Maybe we should commit this even if it ups the log noise in buckets so we get more conscious about the retrying that is going on mostly silently currently .... we might do something more about it in client?&lt;/p&gt;</comment>
                            <comment id="13460806" author="qwertymaniac" created="Fri, 21 Sep 2012 20:33:08 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Maybe we can log it only for SocketTimeoutExceptions as shown in Igal&apos;s log?&lt;/li&gt;
	&lt;li&gt;Would it be wise of the client to dynamically-increase its timeout factor by a small (configurable) margin, if it receives a socket timeout when waiting for a response, such as in this case? Doesn&apos;t help for all sorta issues, but may help those who can enable the small increment feature. (Gets into the way of MTTR if its put into the wrong config files (such as RS&apos;s) though).&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13461129" author="igalshilman" created="Sat, 22 Sep 2012 11:56:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;How much more log does this patch generate Igal? As I read it, it is logging every retry.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;From what we&apos;ve seen, most of the calls complete within a single attempt, if a retry occurs then it&apos;s pretty much fatal (next attempt is LE), so, in our case, it&apos;s up to a single exception being logged.&lt;br/&gt;
I guess folks running long lived clients will see more of these logs. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;we might do something more about it in client?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Maybe log just the abnormal exits?&lt;br/&gt;
I mean: If a call eventually succeeds, then failed retries won&apos;t be logged,&lt;br/&gt;
otherwise we log all the ThrowableWithExtraContext that were accumulated during previous attempts.&lt;/p&gt;

&lt;p&gt;for example, a single iteration of withRetries() might look:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        beforeCall();
        connect(tries != 0);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; call();
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable t) {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
          handleFailedAttempt(t, numRetries, tries, exceptions);
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (RetriesExhaustedException e) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; e;
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
          LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Giving up&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RetriesExhaustedException(numRetries, exceptions));
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; e;
        }
} &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
        afterCall();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13461523" author="igalshilman" created="Sun, 23 Sep 2012 21:56:43 +0000"  >&lt;p&gt;Attaching a version, that logs unsuccessful attempts only if withRetires() exits abnormally (neither returns a value, nor RetriesExhaustedException is thrown).&lt;/p&gt;</comment>
                            <comment id="13461533" author="hadoopqa" created="Sun, 23 Sep 2012 22:53:46 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12546227/HBASE-6071.v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12546227/HBASE-6071.v5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated 139 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 7 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2925//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13464972" author="stack" created="Thu, 27 Sep 2012 18:47:42 +0000"  >&lt;p&gt;Patch looks fine.  I&apos;d change the below to throw an InterruptedIOException:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        logAndGiveUp(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Giving up after tries=&quot;&lt;/span&gt; + tries, e), tries, exceptions);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... but I can do that on commit.&lt;/p&gt;

&lt;p&gt;Are you running this change?  Does it work for you?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12529461" name="HBASE-6071.patch" size="1590" author="igalshilman" created="Fri, 25 May 2012 01:00:49 +0000"/>
                            <attachment id="12529868" name="HBASE-6071.v2.patch" size="1592" author="igalshilman" created="Sat, 26 May 2012 14:13:42 +0000"/>
                            <attachment id="12529878" name="HBASE-6071.v3.patch" size="1515" author="igalshilman" created="Sat, 26 May 2012 18:01:35 +0000"/>
                            <attachment id="12546017" name="HBASE-6071.v4.patch" size="1627" author="igalshilman" created="Fri, 21 Sep 2012 09:01:17 +0000"/>
                            <attachment id="12546227" name="HBASE-6071.v5.patch" size="5212" author="igalshilman" created="Sun, 23 Sep 2012 21:56:43 +0000"/>
                            <attachment id="12528963" name="HConnectionManager_HBASE-6071-0.90.0.patch" size="872" author="igalshilman" created="Thu, 24 May 2012 12:21:05 +0000"/>
                            <attachment id="12539860" name="lease-exception.txt" size="12463" author="igalshilman" created="Wed, 8 Aug 2012 12:31:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 24 May 2012 13:34:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239599</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 12 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00rjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2396</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>