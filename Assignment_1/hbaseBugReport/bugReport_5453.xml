<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:27:54 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5453/HBASE-5453.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5453] Switch on-disk formats (reference files, HFile meta fields, etc) to PB</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5453</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description></description>
                <environment></environment>
        <key id="12543631">HBASE-5453</key>
            <summary>Switch on-disk formats (reference files, HFile meta fields, etc) to PB</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12540505">HBASE-5305</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Feb 2012 06:52:24 +0000</created>
                <updated>Mon, 23 Sep 2013 18:31:34 +0000</updated>
                            <resolved>Fri, 18 May 2012 20:20:51 +0000</resolved>
                                                    <fixVersion>0.95.0</fixVersion>
                                    <component>IPC/RPC</component>
                    <component>master</component>
                    <component>migration</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                <comments>
                            <comment id="13271855" author="stack" created="Wed, 9 May 2012 21:59:10 +0000"  >&lt;p&gt;Files to move over:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/${HBASE_ROOTDIR}/hbase.version
/${HBASE_ROOTDIR}/hbase.id
/${HBASE_ROOTDIR}/TABLENAME/.tableinfo
/${HBASE_ROOTDIR}/TABLENAME/REGIONNAME/.regioninfo
/${HBASE_ROOTDIR}/TABLENAME/REGIONNAME/COLUMN_FAMILY/reference
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let me see too where else we write; e.g. into hfiles.   Is it necessary bringing these over?  They are versioned already w/ readers than can do v1, v2, etc.&lt;/p&gt;

&lt;p&gt;Let me see if I can do it in a portable way.&lt;/p&gt;</comment>
                            <comment id="13271859" author="eclark" created="Wed, 9 May 2012 22:01:56 +0000"  >&lt;p&gt;Are you talking about KeyValue as well ?&lt;/p&gt;</comment>
                            <comment id="13271864" author="stack" created="Wed, 9 May 2012 22:05:27 +0000"  >&lt;p&gt;no to kv&lt;/p&gt;</comment>
                            <comment id="13271963" author="stack" created="Thu, 10 May 2012 00:02:07 +0000"  >&lt;p&gt;Move over the hbase.version file.&lt;/p&gt;</comment>
                            <comment id="13272503" author="jxiang" created="Thu, 10 May 2012 17:10:51 +0000"  >&lt;p&gt;Good stuff.  Are the proto file and the generated java file in a different patch?&lt;/p&gt;</comment>
                            <comment id="13272528" author="stack" created="Thu, 10 May 2012 17:35:20 +0000"  >&lt;p&gt;Ooops.  Thanks Jimmy.  You think I should change over the hfile metadata to pb too?  I suppose its MapWritable currently so should go over if we want to purge Writables...&lt;/p&gt;</comment>
                            <comment id="13272539" author="jxiang" created="Thu, 10 May 2012 17:44:48 +0000"  >&lt;p&gt;That would be great, I think. Thanks.&lt;/p&gt;</comment>
                            <comment id="13272549" author="hadoopqa" created="Thu, 10 May 2012 17:52:06 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12526378/5453v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12526378/5453v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestColumnSeeking&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1834//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1834//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1834//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1834//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1834//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1834//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13272718" author="tlipcon" created="Thu, 10 May 2012 20:25:02 +0000"  >&lt;p&gt;Agree it would be great if HFile used protobuf where possible. But I don&apos;t think it needs to block 0.96, since we already have decent compatibility paths here, and the writables used are already fairly generic (mostly maps if I remember correctly).&lt;/p&gt;</comment>
                            <comment id="13274159" author="jxiang" created="Sun, 13 May 2012 03:48:03 +0000"  >&lt;p&gt;v2 looks good to me.&lt;/p&gt;</comment>
                            <comment id="13276259" author="stack" created="Tue, 15 May 2012 21:52:27 +0000"  >&lt;p&gt;Trying against hadoopqa.&lt;/p&gt;

&lt;p&gt;Moves over the five listed files to pb:&lt;/p&gt;

&lt;p&gt;.tableinfo, .regioninfo, reference, hbase.id and hbase.version&lt;/p&gt;

&lt;p&gt;Will post on pb w/ a better commit note now.&lt;/p&gt;</comment>
                            <comment id="13276269" author="hadoopqa" created="Tue, 15 May 2012 22:02:15 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12527528/5453v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12527528/5453v3.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 24 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1879//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1879//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13276276" author="jiraposter@reviews.apache.org" created="Tue, 15 May 2012 22:15:04 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;br/&gt;
  New  class to hold clusterid in.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;br/&gt;
  Make it so can do pb serialization.  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;br/&gt;
  Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;br/&gt;
  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;br/&gt;
  Make it so can do pb serialization.  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;br/&gt;
  ClusterId under ZK got renamed as ZKClusterId&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;br/&gt;
  Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;br/&gt;
  Make it so can do pb serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;br/&gt;
  Use new methods on Reference for getting top and bottom.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  ClusterId under zk has been renamed ZKClusterId.&lt;br/&gt;
  Use new ClusterId class too.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;br/&gt;
  Use new clusterid class.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;br/&gt;
  Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;br/&gt;
  Added generic toDelimitedByteArray helper.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;br/&gt;
  Use HRegionInfo convertions instead.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;br/&gt;
  Use HRegionInfo convertions instead.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
  Use new utility writing out .regioninfo files.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  Formatting.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  Range in Reference is no longer public.&lt;br/&gt;
  Range in Reference is no longer public.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;br/&gt;
  ClusterId got renamed ZKClusterId&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;br/&gt;
  Use new serialization utlity in HTD.&lt;br/&gt;
M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;br/&gt;
  Generic method for writing dot file content.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;br/&gt;
  Reference#Range is not public any more&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;br/&gt;
  Deprecated getHRegionInfo, etc.&lt;br/&gt;
D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;br/&gt;
A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;br/&gt;
  Rename&lt;br/&gt;
A b/src/main/protobuf/ClusterId.proto&lt;br/&gt;
  Added file for ClusterId only since its written to fs and to zk.&lt;br/&gt;
A b/src/main/protobuf/FS.proto&lt;br/&gt;
  Protos for fs files.&lt;br/&gt;
M b/src/main/protobuf/ZooKeeper.proto&lt;br/&gt;
  Moved ClusterId out to own proto file&lt;br/&gt;
M b/src/main/protobuf/hbase.proto&lt;br/&gt;
  Added TableSchema and ColumnFamilySchema&lt;/p&gt;


&lt;p&gt;This addresses bug hbase-5453.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 9d3898c &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;br/&gt;
  src/main/protobuf/ClusterId.proto PRE-CREATION &lt;br/&gt;
  src/main/protobuf/FS.proto PRE-CREATION &lt;br/&gt;
  src/main/protobuf/ZooKeeper.proto b72cb28 &lt;br/&gt;
  src/main/protobuf/hbase.proto 30a4c3f &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Michael&lt;/p&gt;
</comment>
                            <comment id="13276320" author="jiraposter@reviews.apache.org" created="Tue, 15 May 2012 23:09:04 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/#review7916&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#review7916&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Do we have a story for when we can remove the writable stuff?&lt;/p&gt;


&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17217&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17217&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Looks like we are stepping on each other&apos;s toes a bit; I defined my own protos for this and HTableDescriptor (see the review request for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5445&quot; title=&quot;Add PB-based calls to HMasterInterface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5445&quot;&gt;&lt;del&gt;HBASE-5445&lt;/del&gt;&lt;/a&gt;).  Your definitions are pretty close though; I&apos;ll convert mine over.&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17218&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17218&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    &quot;not be what ou want&quot; -&amp;gt; &quot;not be what you want&quot;&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17219&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17219&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Did you give any thought to storing the actual data in a TableSchema rather than converting?  Perhaps it&apos;s not worth it because:&lt;br/&gt;
    1) we still need to maintain the writable for now, so would require rewriting that part, which is a waste&lt;br/&gt;
    2) might not perform well, because we have to call copyFrom a bunch of times.&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17220&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17220&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Nice.  I wrote up similar things for HTableDescriptor/HColumnDescriptor; I can just get rid of them and use your convert functions.&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17226&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17226&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Are we sure this assumption is valid (that if the file lengths are the same, the files are the same format)?&lt;/p&gt;

&lt;p&gt;    We can&apos;t check if there is a pb-prefix at the start of file or something? &lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17223&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17223&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Same here, is this assumption valid?&lt;/p&gt;



&lt;p&gt;src/main/protobuf/FS.proto&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17221&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17221&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    extra whitespace&lt;/p&gt;



&lt;p&gt;src/main/protobuf/hbase.proto&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17222&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17222&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    extra whitespace&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Gregory&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2012-05-15 22:14:17, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2012-05-15 22:14:17)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;New  class to hold clusterid in.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under ZK got renamed as ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new methods on Reference for getting top and bottom.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under zk has been renamed ZKClusterId.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new ClusterId class too.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new clusterid class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added generic toDelimitedByteArray helper.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new utility writing out .regioninfo files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Formatting.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId got renamed ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new serialization utlity in HTD.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Generic method for writing dot file content.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Reference#Range is not public any more&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated getHRegionInfo, etc.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/ClusterId.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added file for ClusterId only since its written to fs and to zk.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/FS.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Protos for fs files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/ZooKeeper.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Moved ClusterId out to own proto file&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/hbase.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added TableSchema and ColumnFamilySchema&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug hbase-5453.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 9d3898c &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ClusterId.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/FS.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ZooKeeper.proto b72cb28 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/hbase.proto 30a4c3f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13276327" author="stack" created="Tue, 15 May 2012 23:19:07 +0000"  >&lt;p&gt;Stashing v6 here for the moment.  Does not address yet Gregory&apos;s comments.   Working on that now in a v7.&lt;/p&gt;</comment>
                            <comment id="13276330" author="jiraposter@reviews.apache.org" created="Tue, 15 May 2012 23:27:05 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2012-05-15 23:08:35, Gregory Chanan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; Do we have a story for when we can remove the writable stuff?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No.  Smile.  Being optimistic.  Have to start somewhere.  No harm marking this stuff deprecated in  meantime as heads-up.&lt;/p&gt;

&lt;p&gt;I think we won&apos;t be able to migrate over these old classes.  I&apos;m thinking we&apos;ll have to do new ones and deprecate the old given they inherit from Writable.  It&apos;ll be a bit of a pain though given some of these classes come out in our public API.&lt;/p&gt;

&lt;p&gt;But we have to start somewhere.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2012-05-15 23:08:35, Gregory Chanan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java, line 1017&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/diff/1/?file=109035#file109035line1017&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff/1/?file=109035#file109035line1017&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Looks like we are stepping on each other&apos;s toes a bit; I defined my own protos for this and HTableDescriptor (see the review request for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5445&quot; title=&quot;Add PB-based calls to HMasterInterface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5445&quot;&gt;&lt;del&gt;HBASE-5445&lt;/del&gt;&lt;/a&gt;).  Your definitions are pretty close though; I&apos;ll convert mine over.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Well, Andrew beat us both to it over in his REST pb stuff.  We need to reconcile his w/ ours too....&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2012-05-15 23:08:35, Gregory Chanan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/HRegionInfo.java, line 954&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/diff/1/?file=109036#file109036line954&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff/1/?file=109036#file109036line954&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &quot;not be what ou want&quot; -&amp;gt; &quot;not be what you want&quot;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Fixed&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2012-05-15 23:08:35, Gregory Chanan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java, line 1240&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/diff/1/?file=109037#file109037line1240&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff/1/?file=109037#file109037line1240&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Did you give any thought to storing the actual data in a TableSchema rather than converting?  Perhaps it&apos;s not worth it because:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     1) we still need to maintain the writable for now, so would require rewriting that part, which is a waste&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     2) might not perform well, because we have to call copyFrom a bunch of times.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah.  Thought about it but we want Writable still converting old serializations.  Mostly I reasoned that these classes are rarely, relatively serialized, and performance is not important when we do want to pass these classes serialized.  Yeah, it&apos;d be a pain converting.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2012-05-15 23:08:35, Gregory Chanan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java, line 748&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/diff/1/?file=109050#file109050line748&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff/1/?file=109050#file109050line748&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Are we sure this assumption is valid (that if the file lengths are the same, the files are the same format)?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     We can&apos;t check if there is a pb-prefix at the start of file or something?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is my way of figuring if I need to convert the file.  There is an off chance that file could be same length though serialized with Writables.  Good one.  Let me fix that.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Michael&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/#review7916&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#review7916&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2012-05-15 22:14:17, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2012-05-15 22:14:17)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;New  class to hold clusterid in.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under ZK got renamed as ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new methods on Reference for getting top and bottom.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under zk has been renamed ZKClusterId.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new ClusterId class too.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new clusterid class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added generic toDelimitedByteArray helper.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new utility writing out .regioninfo files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Formatting.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId got renamed ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new serialization utlity in HTD.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Generic method for writing dot file content.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Reference#Range is not public any more&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated getHRegionInfo, etc.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/ClusterId.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added file for ClusterId only since its written to fs and to zk.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/FS.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Protos for fs files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/ZooKeeper.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Moved ClusterId out to own proto file&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/hbase.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added TableSchema and ColumnFamilySchema&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug hbase-5453.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 9d3898c &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ClusterId.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/FS.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ZooKeeper.proto b72cb28 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/hbase.proto 30a4c3f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13276883" author="stack" created="Wed, 16 May 2012 16:59:11 +0000"  >&lt;p&gt;Address Gregory&apos;s comments.&lt;/p&gt;

&lt;p&gt;I&apos;ve changed the format of .regioninfo and .tableinfo.  Now instead of serialized Writable followed by toString of the serialized object, instead its just the serialized pb.&lt;/p&gt;

&lt;p&gt;This removes our having a human readable .regioninfo/.tablinfo file but my guess no one relied on this anyways.&lt;/p&gt;

&lt;p&gt;Having just serialized content in the file means a check of file length should be enough figuring whether the file properly serialized.    If ever a chance that a Writable + its toString + two &apos;\n&apos; characters was equal to a serialized pb, I&apos;d think this likely a pathological state.  If this state is not cleared up &apos;naturally&apos; by splits or a schema change, then lets deal if it happens.&lt;/p&gt;

&lt;p&gt;I only need this length-checking in one place on region open.  I want to avoid reading the .regioninfo file on region open.  The alternative means more load on NN and DNs at region open time which could be problematic at big-bang cluster start (Thinking 500 nodes w/ 80k regions, an actual known case).&lt;/p&gt;

&lt;p&gt;Otherwise, Gregory&apos;s comments led to me to check and I was missing convertion of fs files to pb in all cases.  This should be fixed now.&lt;/p&gt;

&lt;p&gt;There are some failing tests still but running by hadoopqa to see what it says anyways.  Also putting up on rb to get feedback if problem w/ this approach.&lt;/p&gt;</comment>
                            <comment id="13276887" author="jiraposter@reviews.apache.org" created="Wed, 16 May 2012 17:04:04 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2012-05-16 17:02:35.527708)&lt;/p&gt;


&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Gregory.  I addressed your comments.&lt;/p&gt;

&lt;p&gt;I&apos;ve changed the format of .regioninfo and .tableinfo. Now instead of serialized Writable followed by toString of the serialized object, instead its just the serialized pb. This removes our having a human readable .regioninfo/.tablinfo file but my guess no one relied on this anyways.&lt;/p&gt;

&lt;p&gt;Having just serialized content in the file means a check of file length should be enough figuring whether the file properly serialized. If ever a chance that a Writable + its toString + two &apos;\n&apos; characters was equal to a serialized pb, I&apos;d think this a pathological state. If this state is not cleared up &apos;naturally&apos; by splits or a schema change, then lets deal if it happens.&lt;/p&gt;

&lt;p&gt;I only need this length-checking in one place on region open. I want to avoid reading the .regioninfo file on region open. The alternative means more load on NN and DNs at region open time which could be problematic at big-bang cluster start (Thinking 500 nodes w/ 80k regions, an actual known case &amp;#8211; this is the case I have in mind when I&apos;m trying to avoid more load on NN/DNs).&lt;/p&gt;

&lt;p&gt;Otherwise, Gregory&apos;s comments led to me to check and I was missing convertion of fs files to pb in all cases (I was just reading the clusterid and hbase.version files, not converting if still Writable). This should be fixed now.&lt;/p&gt;

&lt;p&gt;There are some failing tests still but running by hadoopqa to see what it says anyways. Also putting up on rb to get feedback if problem w/ this approach.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;br/&gt;
  New  class to hold clusterid in.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;br/&gt;
  Make it so can do pb serialization.  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;br/&gt;
  Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;br/&gt;
  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;br/&gt;
  Make it so can do pb serialization.  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;br/&gt;
  ClusterId under ZK got renamed as ZKClusterId&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;br/&gt;
  Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;br/&gt;
  Make it so can do pb serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;br/&gt;
  Use new methods on Reference for getting top and bottom.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  ClusterId under zk has been renamed ZKClusterId.&lt;br/&gt;
  Use new ClusterId class too.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;br/&gt;
  Use new clusterid class.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;br/&gt;
  Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;br/&gt;
  Added generic toDelimitedByteArray helper.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;br/&gt;
  Use HRegionInfo convertions instead.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;br/&gt;
  Use HRegionInfo convertions instead.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
  Use new utility writing out .regioninfo files.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  Formatting.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  Range in Reference is no longer public.&lt;br/&gt;
  Range in Reference is no longer public.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;br/&gt;
  ClusterId got renamed ZKClusterId&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;br/&gt;
  Use new serialization utlity in HTD.&lt;br/&gt;
M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;br/&gt;
  Generic method for writing dot file content.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;br/&gt;
  Reference#Range is not public any more&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;br/&gt;
  Deprecated getHRegionInfo, etc.&lt;br/&gt;
D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;br/&gt;
A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;br/&gt;
  Rename&lt;br/&gt;
A b/src/main/protobuf/ClusterId.proto&lt;br/&gt;
  Added file for ClusterId only since its written to fs and to zk.&lt;br/&gt;
A b/src/main/protobuf/FS.proto&lt;br/&gt;
  Protos for fs files.&lt;br/&gt;
M b/src/main/protobuf/ZooKeeper.proto&lt;br/&gt;
  Moved ClusterId out to own proto file&lt;br/&gt;
M b/src/main/protobuf/hbase.proto&lt;br/&gt;
  Added TableSchema and ColumnFamilySchema&lt;/p&gt;


&lt;p&gt;This addresses bug hbase-5453.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6dc0517 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;br/&gt;
  src/main/protobuf/ClusterId.proto PRE-CREATION &lt;br/&gt;
  src/main/protobuf/FS.proto PRE-CREATION &lt;br/&gt;
  src/main/protobuf/ZooKeeper.proto b72cb28 &lt;br/&gt;
  src/main/protobuf/hbase.proto 30a4c3f &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Michael&lt;/p&gt;
</comment>
                            <comment id="13277143" author="stack" created="Wed, 16 May 2012 21:00:35 +0000"  >&lt;p&gt;Fix bug in my Reference file serialize/deserialize&lt;/p&gt;</comment>
                            <comment id="13277200" author="jiraposter@reviews.apache.org" created="Wed, 16 May 2012 22:13:05 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/#review7944&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#review7944&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;In a previous comment you said (about the HTableDescriptor/HColumnDesriptor pb stuff):&lt;br/&gt;
&quot;Well, Andrew beat us both to it over in his REST pb stuff.  We need to reconcile his w/ ours too....&quot;&lt;/p&gt;

&lt;p&gt;Where is his stuff?  I couldn&apos;t find it.  Should we create a JIRA about reconciling? It would be nice to have something, however imperfect, up in trunk to work against, then we could fix up later.&lt;/p&gt;


&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17274&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17274&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This isn&apos;t ever read?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17273&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17273&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This constructor sets pbMade to false, but it should be true in this case, right?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Gregory&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2012-05-16 17:02:35, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2012-05-16 17:02:35)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;New  class to hold clusterid in.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under ZK got renamed as ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new methods on Reference for getting top and bottom.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under zk has been renamed ZKClusterId.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new ClusterId class too.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new clusterid class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added generic toDelimitedByteArray helper.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new utility writing out .regioninfo files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Formatting.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId got renamed ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new serialization utlity in HTD.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Generic method for writing dot file content.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Reference#Range is not public any more&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated getHRegionInfo, etc.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/ClusterId.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added file for ClusterId only since its written to fs and to zk.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/FS.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Protos for fs files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/ZooKeeper.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Moved ClusterId out to own proto file&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/hbase.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added TableSchema and ColumnFamilySchema&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug hbase-5453.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6dc0517 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ClusterId.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/FS.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ZooKeeper.proto b72cb28 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/hbase.proto 30a4c3f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13277272" author="jiraposter@reviews.apache.org" created="Wed, 16 May 2012 23:57:03 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2012-05-16 22:12:10, Gregory Chanan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; In a previous comment you said (about the HTableDescriptor/HColumnDesriptor pb stuff):&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &quot;Well, Andrew beat us both to it over in his REST pb stuff.  We need to reconcile his w/ ours too....&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; Where is his stuff?  I couldn&apos;t find it.  Should we create a JIRA about reconciling? It would be nice to have something, however imperfect, up in trunk to work against, then we could fix up later.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Its under src/main/resources/org....  I just tripped over it myself yesterday.   I made &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6026&quot; title=&quot;Reconcile .proto files after the dust settles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6026&quot;&gt;&lt;del&gt;HBASE-6026&lt;/del&gt;&lt;/a&gt; to do the reconcile (after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6000&quot; title=&quot;Cleanup where we keep .proto files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6000&quot;&gt;HBASE-6000&lt;/a&gt; goes in).&lt;/p&gt;

&lt;p&gt;Are you down w/ the change in .regioninfo Gregory as means of &apos;ensuring&apos; we don&apos;t have a Writable and pb serialization end up as same size?&lt;/p&gt;

&lt;p&gt;Thanks for review.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2012-05-16 22:12:10, Gregory Chanan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java, line 276&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/diff/1-2/?file=109037#file109037line276&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff/1-2/?file=109037#file109037line276&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     This isn&apos;t ever read?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is gone now.  I used another technique figuring if object serialized &amp;#8211; read file fully into byte array and test for the pb prefix &amp;#8211; rather than this hacky setting attribute on class.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Michael&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/#review7944&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#review7944&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2012-05-16 17:02:35, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2012-05-16 17:02:35)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;New  class to hold clusterid in.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under ZK got renamed as ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new methods on Reference for getting top and bottom.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under zk has been renamed ZKClusterId.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new ClusterId class too.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new clusterid class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added generic toDelimitedByteArray helper.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new utility writing out .regioninfo files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Formatting.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId got renamed ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new serialization utlity in HTD.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Generic method for writing dot file content.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Reference#Range is not public any more&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated getHRegionInfo, etc.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/ClusterId.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added file for ClusterId only since its written to fs and to zk.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/FS.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Protos for fs files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/ZooKeeper.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Moved ClusterId out to own proto file&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/hbase.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added TableSchema and ColumnFamilySchema&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug hbase-5453.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6dc0517 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ClusterId.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/FS.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ZooKeeper.proto b72cb28 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/hbase.proto 30a4c3f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13277273" author="jiraposter@reviews.apache.org" created="Wed, 16 May 2012 23:57:06 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2012-05-16 23:56:18.496225)&lt;/p&gt;


&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;v10... the last thing I added to JIRA&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;br/&gt;
  New  class to hold clusterid in.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;br/&gt;
  Make it so can do pb serialization.  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;br/&gt;
  Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;br/&gt;
  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;br/&gt;
  Make it so can do pb serialization.  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;br/&gt;
  ClusterId under ZK got renamed as ZKClusterId&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;br/&gt;
  Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;br/&gt;
  Make it so can do pb serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;br/&gt;
  Use new methods on Reference for getting top and bottom.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  ClusterId under zk has been renamed ZKClusterId.&lt;br/&gt;
  Use new ClusterId class too.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;br/&gt;
  Use new clusterid class.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;br/&gt;
  Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;br/&gt;
  Added generic toDelimitedByteArray helper.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;br/&gt;
  Use HRegionInfo convertions instead.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;br/&gt;
  Use HRegionInfo convertions instead.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
  Use new utility writing out .regioninfo files.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  Formatting.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  Range in Reference is no longer public.&lt;br/&gt;
  Range in Reference is no longer public.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;br/&gt;
  ClusterId got renamed ZKClusterId&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;br/&gt;
  Use new serialization utlity in HTD.&lt;br/&gt;
M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;br/&gt;
  Generic method for writing dot file content.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;br/&gt;
  Reference#Range is not public any more&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;br/&gt;
  Deprecated getHRegionInfo, etc.&lt;br/&gt;
D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;br/&gt;
A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;br/&gt;
  Rename&lt;br/&gt;
A b/src/main/protobuf/ClusterId.proto&lt;br/&gt;
  Added file for ClusterId only since its written to fs and to zk.&lt;br/&gt;
A b/src/main/protobuf/FS.proto&lt;br/&gt;
  Protos for fs files.&lt;br/&gt;
M b/src/main/protobuf/ZooKeeper.proto&lt;br/&gt;
  Moved ClusterId out to own proto file&lt;br/&gt;
M b/src/main/protobuf/hbase.proto&lt;br/&gt;
  Added TableSchema and ColumnFamilySchema&lt;/p&gt;


&lt;p&gt;This addresses bug hbase-5453.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6dc0517 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Bytes.java 2ccda17 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;br/&gt;
  src/main/protobuf/ClusterId.proto PRE-CREATION &lt;br/&gt;
  src/main/protobuf/FS.proto PRE-CREATION &lt;br/&gt;
  src/main/protobuf/ZooKeeper.proto b72cb28 &lt;br/&gt;
  src/main/protobuf/hbase.proto 30a4c3f &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransaction.java 98c09eb &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Michael&lt;/p&gt;
</comment>
                            <comment id="13277589" author="jiraposter@reviews.apache.org" created="Thu, 17 May 2012 05:48:48 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/#review7951&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#review7951&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17291&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17291&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This is still here?  Or just reviewboard showing it for some reason?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17290&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17290&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This is what you are using to ensure the sizes cannot be the same?  Very nice!&lt;/p&gt;

&lt;p&gt;    I cannot find a call-site for this, though, maybe I missed it?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Gregory&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2012-05-16 23:56:18, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2012-05-16 23:56:18)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;New  class to hold clusterid in.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under ZK got renamed as ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new methods on Reference for getting top and bottom.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under zk has been renamed ZKClusterId.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new ClusterId class too.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new clusterid class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added generic toDelimitedByteArray helper.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new utility writing out .regioninfo files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Formatting.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId got renamed ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new serialization utlity in HTD.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Generic method for writing dot file content.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Reference#Range is not public any more&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated getHRegionInfo, etc.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/ClusterId.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added file for ClusterId only since its written to fs and to zk.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/FS.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Protos for fs files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/ZooKeeper.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Moved ClusterId out to own proto file&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/hbase.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added TableSchema and ColumnFamilySchema&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug hbase-5453.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6dc0517 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Bytes.java 2ccda17 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ClusterId.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/FS.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ZooKeeper.proto b72cb28 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/hbase.proto 30a4c3f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransaction.java 98c09eb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13277593" author="jiraposter@reviews.apache.org" created="Thu, 17 May 2012 05:58:15 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2012-05-17 05:41:53, Gregory Chanan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java, line 275&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/diff/3/?file=109313#file109313line275&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff/3/?file=109313#file109313line275&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     This is still here?  Or just reviewboard showing it for some reason?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Flotsam.  An abandoned direction that I failed to clean up.  Thanks.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2012-05-17 05:41:53, Gregory Chanan wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/util/FSUtils.java, line 91&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/diff/3/?file=109334#file109334line91&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff/3/?file=109334#file109334line91&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     This is what you are using to ensure the sizes cannot be the same?  Very nice!&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     I cannot find a call-site for this, though, maybe I missed it?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ditto. I was going to use this to write .regioninfo and .tableinfo but then I ran into your review.  Study this method which I&apos;ll purge in the next version.  See how it puts serialized class at top, two &apos;\n&apos;s, and then a toString on the class?  Thats how .regioninfo files and .tableinfo files are currently written.  My patch now changes it so these files only contained the serialized object... no &apos;\n&apos; and no toString.  I do this so its very unlikely a Writable length will class w/ the length of a pb&apos;d content (See HRegion for where we write .regioninfo and in FSTableDescriptors for where we write .tableinfo only we don&apos;t need the &apos;trick&apos; here since we have actually read the file and can see if its pb&apos;d).&lt;/p&gt;

&lt;p&gt;Thanks for the review G.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Michael&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/#review7951&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#review7951&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2012-05-16 23:56:18, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2012-05-16 23:56:18)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;New  class to hold clusterid in.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under ZK got renamed as ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new methods on Reference for getting top and bottom.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under zk has been renamed ZKClusterId.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new ClusterId class too.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new clusterid class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added generic toDelimitedByteArray helper.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new utility writing out .regioninfo files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Formatting.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId got renamed ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new serialization utlity in HTD.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Generic method for writing dot file content.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Reference#Range is not public any more&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated getHRegionInfo, etc.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/ClusterId.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added file for ClusterId only since its written to fs and to zk.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/FS.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Protos for fs files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/ZooKeeper.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Moved ClusterId out to own proto file&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/hbase.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added TableSchema and ColumnFamilySchema&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug hbase-5453.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6dc0517 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Bytes.java 2ccda17 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ClusterId.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/FS.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ZooKeeper.proto b72cb28 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/hbase.proto 30a4c3f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransaction.java 98c09eb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13277595" author="stack" created="Thu, 17 May 2012 05:59:12 +0000"  >&lt;p&gt;v11 addressing Gregory&apos;s last review comments.&lt;/p&gt;</comment>
                            <comment id="13277596" author="jiraposter@reviews.apache.org" created="Thu, 17 May 2012 06:00:05 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2012-05-17 05:58:11.354772)&lt;/p&gt;


&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Address Gregory&apos;s two review comments.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;br/&gt;
  New  class to hold clusterid in.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;br/&gt;
  Make it so can do pb serialization.  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;br/&gt;
  Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;br/&gt;
  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;br/&gt;
  Make it so can do pb serialization.  Deprecated Writable serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;br/&gt;
  ClusterId under ZK got renamed as ZKClusterId&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;br/&gt;
  Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;br/&gt;
  Make it so can do pb serialization.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;br/&gt;
  Use new methods on Reference for getting top and bottom.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  ClusterId under zk has been renamed ZKClusterId.&lt;br/&gt;
  Use new ClusterId class too.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;br/&gt;
  Use new clusterid class.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;br/&gt;
  Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;br/&gt;
  Added generic toDelimitedByteArray helper.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;br/&gt;
  Use HRegionInfo convertions instead.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;br/&gt;
  Use HRegionInfo convertions instead.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
  Use new utility writing out .regioninfo files.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  Formatting.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  Range in Reference is no longer public.&lt;br/&gt;
  Range in Reference is no longer public.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;br/&gt;
  ClusterId got renamed ZKClusterId&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;br/&gt;
  Use new serialization utlity in HTD.&lt;br/&gt;
M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;br/&gt;
  Generic method for writing dot file content.&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;br/&gt;
  Reference#Range is not public any more&lt;br/&gt;
M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;br/&gt;
  Deprecated getHRegionInfo, etc.&lt;br/&gt;
D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;br/&gt;
A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;br/&gt;
  Rename&lt;br/&gt;
A b/src/main/protobuf/ClusterId.proto&lt;br/&gt;
  Added file for ClusterId only since its written to fs and to zk.&lt;br/&gt;
A b/src/main/protobuf/FS.proto&lt;br/&gt;
  Protos for fs files.&lt;br/&gt;
M b/src/main/protobuf/ZooKeeper.proto&lt;br/&gt;
  Moved ClusterId out to own proto file&lt;br/&gt;
M b/src/main/protobuf/hbase.proto&lt;br/&gt;
  Added TableSchema and ColumnFamilySchema&lt;/p&gt;


&lt;p&gt;This addresses bug hbase-5453.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6dc0517 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Bytes.java 2ccda17 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;br/&gt;
  src/main/protobuf/ClusterId.proto PRE-CREATION &lt;br/&gt;
  src/main/protobuf/FS.proto PRE-CREATION &lt;br/&gt;
  src/main/protobuf/ZooKeeper.proto b72cb28 &lt;br/&gt;
  src/main/protobuf/hbase.proto 30a4c3f &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransaction.java 98c09eb &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Michael&lt;/p&gt;
</comment>
                            <comment id="13277620" author="hadoopqa" created="Thu, 17 May 2012 06:50:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12527785/5453v11.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12527785/5453v11.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 32 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestMultipleTimestamps&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestMetaMigrationRemovingHTD&lt;br/&gt;
                  org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildOverlap&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestTimestampsFilter&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestMultiSlaveReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestFromClientSide&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportExport&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestMasterReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1906//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1906//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1906//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1906//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1906//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1906//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13278263" author="jiraposter@reviews.apache.org" created="Thu, 17 May 2012 21:03:04 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/5130/#review7963&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#review7963&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Ship it!&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/5130/#comment17303&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/#comment17303&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Your logic sounds correct and I agree we should avoid having to read the file each time.&lt;/p&gt;

&lt;p&gt;    It would be cool to just see an example of the old writable vs new pb size to ensure our intuition is correct.&lt;/p&gt;

&lt;p&gt;    Worst case (let&apos;s say they happen to be the same) we could write out the new pb stuff concatenated with the old way of writing and then they are guaranteed to be different sizes.  Hopefully we don&apos;t have to do something like that, though.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Gregory&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2012-05-17 05:58:11, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/5130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2012-05-17 05:58:11)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;New  class to hold clusterid in.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so methods in here follow the pattern in HCD an HTD pb &apos;ing.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.  Deprecated Writable serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under ZK got renamed as ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Hide the Reference#Range enums.  Don&apos;t let them out of this class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Make it so can do pb serialization.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new methods on Reference for getting top and bottom.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId under zk has been renamed ZKClusterId.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new ClusterId class too.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new clusterid class.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Move the RegionInfo convertion up into HRegionInfo instead of here.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added generic toDelimitedByteArray helper.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use HRegionInfo convertions instead.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new utility writing out .regioninfo files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Formatting.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Range in Reference is no longer public.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;ClusterId got renamed ZKClusterId&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Use new serialization utlity in HTD.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M  b/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Generic method for writing dot file content.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Reference#Range is not public any more&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/java/org/apache/hadoop/hbase/util/Writables.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Deprecated getHRegionInfo, etc.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;D b/src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Rename&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/ClusterId.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added file for ClusterId only since its written to fs and to zk.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;A b/src/main/protobuf/FS.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Protos for fs files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/ZooKeeper.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Moved ClusterId out to own proto file&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;M b/src/main/protobuf/hbase.proto&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Added TableSchema and ColumnFamilySchema&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug hbase-5453.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/hbase-5453&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/hbase-5453&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HColumnDescriptor.java 5862f15 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HRegionInfo.java 8d83ff3 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java af89e3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java 5cac9af &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/io/Reference.java 6360059 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java 9e4ada9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java 947ec5f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 5052878 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java ccc964e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/RequestConverter.java dabfbab &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/ResponseConverter.java 45cb6cf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ClusterIdProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/FSProtos.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/HBaseProtos.java 058c006 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/protobuf/generated/ZooKeeperProtos.java 20c7738 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 9f16fee &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6dc0517 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java 6a9f2fe &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java 5e1e16d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java 5050df0 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSecretManager.java 049ed8d &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Bytes.java 2ccda17 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java efb2b84 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3d35d3e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/HBaseFsck.java 7b4f4a2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/Writables.java 3d20723 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ClusterId.java f804810 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/zookeeper/ZKClusterId.java PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ClusterId.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/FS.proto PRE-CREATION &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/ZooKeeper.proto b72cb28 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/protobuf/hbase.proto 30a4c3f &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHColumnDescriptor.java e7fa8b2 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java f7c0cca &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/catalog/TestCatalogTracker.java 83d8408 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/MockRegionServer.java 69ccc65 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java 1020374 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegionInfo.java 6dfba41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitTransaction.java 98c09eb &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java 988d0bf &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java 339a120 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/5130/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5130/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13278995" author="stack" created="Fri, 18 May 2012 17:34:24 +0000"  >&lt;p&gt;Fixed nasty bug.  Default value system and deserialization of HColumnDescriptor clashed.  Resulting in cryptic odd failed scanner issue.  Yuck.&lt;/p&gt;</comment>
                            <comment id="13279053" author="hadoopqa" created="Fri, 18 May 2012 18:30:02 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12528107/5453v12.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12528107/5453v12.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 30 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 32 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildOverlap&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestSplitTransactionOnCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestMultiSlaveReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestClassLoading&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestMasterReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1934//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1934//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1934//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1934//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1934//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1934//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13279103" author="stack" created="Fri, 18 May 2012 19:21:44 +0000"  >&lt;p&gt;Fix the hbck failure (was creating a .regioninfo using old serializations)&lt;/p&gt;</comment>
                            <comment id="13279116" author="hadoopqa" created="Fri, 18 May 2012 19:41:52 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12528129/5453v13.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12528129/5453v13.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 33 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 33 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestColumnSeeking&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1937//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1937//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1937//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1937//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1937//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1937//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13279134" author="stack" created="Fri, 18 May 2012 20:02:08 +0000"  >&lt;p&gt;The failed test passes locally.  Will commit soon unless objection.&lt;/p&gt;</comment>
                            <comment id="13279137" author="zhihyu@ebaysf.com" created="Fri, 18 May 2012 20:10:23 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; This instance serialized with pb with pb magic prefix
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Remove redundant &apos;with pb &apos;.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Convert &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; instance to a the pb column family type
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Remove &apos;a &apos;&lt;/p&gt;</comment>
                            <comment id="13279152" author="stack" created="Fri, 18 May 2012 20:20:51 +0000"  >&lt;p&gt;Committed to trunk.  Thanks for review Gregory.&lt;/p&gt;</comment>
                            <comment id="13279646" author="zhihyu@ebaysf.com" created="Sun, 20 May 2012 01:20:15 +0000"  >&lt;p&gt;Since integration of this JIRA, TestGetClosestAtOrBefore#testUsingMetaAndBinary has been failing since build #2902.&lt;/p&gt;

&lt;p&gt;Replication-related tests have been failing for Hadoop QA since build #1938.&lt;/p&gt;</comment>
                            <comment id="13282118" author="hudson" created="Thu, 24 May 2012 02:05:26 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2919 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2919/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2919/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6063&quot; title=&quot;Replication related failures on trunk after HBASE-5453&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6063&quot;&gt;&lt;del&gt;HBASE-6063&lt;/del&gt;&lt;/a&gt; Replication related failures on trunk after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5453&quot; title=&quot;Switch on-disk formats (reference files, HFile meta fields, etc) to PB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5453&quot;&gt;&lt;del&gt;HBASE-5453&lt;/del&gt;&lt;/a&gt; (Gregory Channan) (Revision 1342095)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13283833" author="hudson" created="Sat, 26 May 2012 00:06:50 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #16 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/16/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/16/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6063&quot; title=&quot;Replication related failures on trunk after HBASE-5453&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6063&quot;&gt;&lt;del&gt;HBASE-6063&lt;/del&gt;&lt;/a&gt; Replication related failures on trunk after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5453&quot; title=&quot;Switch on-disk formats (reference files, HFile meta fields, etc) to PB&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5453&quot;&gt;&lt;del&gt;HBASE-5453&lt;/del&gt;&lt;/a&gt; (Gregory Channan) (Revision 1342095)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/ClusterId.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13775464" author="stack" created="Mon, 23 Sep 2013 18:31:34 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526246" name="5453.txt" size="12091" author="stack" created="Thu, 10 May 2012 00:01:58 +0000"/>
                            <attachment id="12527707" name="5453v10.txt" size="323743" author="stack" created="Wed, 16 May 2012 21:00:35 +0000"/>
                            <attachment id="12527785" name="5453v11.txt" size="320465" author="stack" created="Thu, 17 May 2012 05:59:12 +0000"/>
                            <attachment id="12527784" name="5453v11.txt" size="320787" author="stack" created="Thu, 17 May 2012 05:59:12 +0000"/>
                            <attachment id="12528107" name="5453v12.txt" size="328344" author="stack" created="Fri, 18 May 2012 17:34:24 +0000"/>
                            <attachment id="12528129" name="5453v13.txt" size="329006" author="stack" created="Fri, 18 May 2012 19:21:44 +0000"/>
                            <attachment id="12526378" name="5453v2.txt" size="32121" author="stack" created="Thu, 10 May 2012 17:35:20 +0000"/>
                            <attachment id="12527528" name="5453v3.txt" size="318687" author="stack" created="Tue, 15 May 2012 21:52:26 +0000"/>
                            <attachment id="12527541" name="5453v6.txt" size="318508" author="stack" created="Tue, 15 May 2012 23:19:07 +0000"/>
                            <attachment id="12527658" name="5453v9.txt" size="320527" author="stack" created="Wed, 16 May 2012 16:59:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 9 May 2012 21:59:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228870</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0htg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102033</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Convert Reference, .tableinfo, .regioninfo, hbase.version, and hbase.id files to have pb content.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>