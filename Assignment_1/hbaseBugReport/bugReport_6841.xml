<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:40:20 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6841/HBASE-6841.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6841] Meta prefetching is slower than doing multiple meta lookups</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6841</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I got myself into a situation where I needed to truncate a massive table while it was getting hits and surprisingly the clients were not recovering. What I see in the logs is that every time we prefetch .META. we setup a new HConnection because we close it on the way out. It&apos;s awfully slow.&lt;/p&gt;

&lt;p&gt;We should just turn it off or make it useful. jstacks coming up.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12608284">HBASE-6841</key>
            <summary>Meta prefetching is slower than doing multiple meta lookups</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Sep 2012 17:52:20 +0000</created>
                <updated>Sat, 11 Apr 2015 00:30:52 +0000</updated>
                            <resolved>Sat, 11 Apr 2015 00:30:52 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13458897" author="stack" created="Wed, 19 Sep 2012 17:56:35 +0000"  >&lt;p&gt;Turn it off by default.  Enable it again when we have hbase-2600 committed when it makes sense.&lt;/p&gt;</comment>
                            <comment id="13458898" author="jdcryans" created="Wed, 19 Sep 2012 17:56:49 +0000"  >&lt;p&gt;I saw while jstack&apos;ing that we&apos;re spending a lot of time in ensureZookeeperTrackers:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1253)
	- locked &amp;lt;0x000000057cad4918&amp;gt; (a org.apache.zookeeper.ClientCnxn$Packet)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1016)
	at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.exists(RecoverableZooKeeper.java:166)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.watchAndCheckExists(ZKUtil.java:230)
	at org.apache.hadoop.hbase.zookeeper.ZooKeeperNodeTracker.start(ZooKeeperNodeTracker.java:82)
	- locked &amp;lt;0x000000057cad4808&amp;gt; (a org.apache.hadoop.hbase.MasterAddressTracker)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.ensureZookeeperTrackers(HConnectionManager.java:591)
	- locked &amp;lt;0x000000057cac1258&amp;gt; (a org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:827)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:810)
	at org.apache.hadoop.hbase.client.HTable.finishSetup(HTable.java:234)
	at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:174)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:160)
	at org.apache.hadoop.hbase.client.MetaScanner.access$000(MetaScanner.java:54)
	at org.apache.hadoop.hbase.client.MetaScanner$1.connect(MetaScanner.java:133)
	at org.apache.hadoop.hbase.client.MetaScanner$1.connect(MetaScanner.java:130)
	at org.apache.hadoop.hbase.client.HConnectionManager.execute(HConnectionManager.java:360)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:130)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:105)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.prefetchRegionCache(HConnectionManager.java:903)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegionInMeta(HConnectionManager.java:958)
	- locked &amp;lt;0x00000005848519f0&amp;gt; (a java.lang.Object)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:845)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:810)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.processBatchCallback(HConnectionManager.java:1492)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.processBatch(HConnectionManager.java:1377)
	at org.apache.hadoop.hbase.client.HTable.batch(HTable.java:702)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then it would do other stuff like:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1253)
	- locked &amp;lt;0x0000000580dd7158&amp;gt; (a org.apache.zookeeper.ClientCnxn$Packet)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1016)
	at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.exists(RecoverableZooKeeper.java:166)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.watchAndCheckExists(ZKUtil.java:230)
	at org.apache.hadoop.hbase.zookeeper.ZooKeeperNodeTracker.start(ZooKeeperNodeTracker.java:82)
	- locked &amp;lt;0x0000000580dd7048&amp;gt; (a org.apache.hadoop.hbase.MasterAddressTracker)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.ensureZookeeperTrackers(HConnectionManager.java:591)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then we finish creating the HTable:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;	at org.apache.hadoop.hbase.zookeeper.ZKUtil.getData(ZKUtil.java:467)
	at org.apache.hadoop.hbase.zookeeper.ClusterId.readClusterIdZNode(ClusterId.java:62)
	at org.apache.hadoop.hbase.zookeeper.ClusterId.getId(ClusterId.java:50)
	at org.apache.hadoop.hbase.zookeeper.ClusterId.hasId(ClusterId.java:44)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getHRegionConnection(HConnectionManager.java:1287)
	- locked &amp;lt;0x000000057d819bf8&amp;gt; (a java.lang.String)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getHRegionConnection(HConnectionManager.java:1250)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getHRegionConnection(HConnectionManager.java:1237)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegionInMeta(HConnectionManager.java:946)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:841)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:810)
	at org.apache.hadoop.hbase.client.HTable.finishSetup(HTable.java:234)
	at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:174)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then the actual pre-fetching:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:1007)
	- locked &amp;lt;0x000000057ed6cf90&amp;gt; (a org.apache.hadoop.hbase.ipc.HBaseClient$Call)
	at org.apache.hadoop.hbase.ipc.WritableRpcEngine$Invoker.invoke(WritableRpcEngine.java:150)
	at $Proxy11.openScanner(Unknown Source)
	at org.apache.hadoop.hbase.client.ScannerCallable.openScanner(ScannerCallable.java:218)
	at org.apache.hadoop.hbase.client.ScannerCallable.call(ScannerCallable.java:120)
	at org.apache.hadoop.hbase.client.ScannerCallable.call(ScannerCallable.java:42)
	at org.apache.hadoop.hbase.client.ServerCallable.withRetries(ServerCallable.java:163)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:206)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then we close the connection:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1253)
	- locked &amp;lt;0x000000057f29bdc8&amp;gt; (a org.apache.zookeeper.ClientCnxn$Packet)
	at org.apache.zookeeper.ClientCnxn.close(ClientCnxn.java:1229)
	at org.apache.zookeeper.ZooKeeper.close(ZooKeeper.java:672)
	- locked &amp;lt;0x000000057e9291d8&amp;gt; (a org.apache.zookeeper.ZooKeeper)
	at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.close(RecoverableZooKeeper.java:553)
	at org.apache.hadoop.hbase.zookeeper.ZooKeeperWatcher.close(ZooKeeperWatcher.java:452)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.close(HConnectionManager.java:1751)
	at org.apache.hadoop.hbase.client.HConnectionManager.deleteConnection(HConnectionManager.java:273)
	- locked &amp;lt;0x0000000583b59498&amp;gt; (a org.apache.hadoop.hbase.client.HConnectionManager$1)
	at org.apache.hadoop.hbase.client.HConnectionManager.deleteConnection(HConnectionManager.java:257)
	- locked &amp;lt;0x0000000583b59498&amp;gt; (a org.apache.hadoop.hbase.client.HConnectionManager$1)
	at org.apache.hadoop.hbase.client.HConnectionManager.access$300(HConnectionManager.java:133)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.close(HConnectionManager.java:1759)
	at org.apache.hadoop.hbase.client.HConnectionManager.execute(HConnectionManager.java:365)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:130)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:105)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.prefetchRegionCache(HConnectionManager.java:903)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then do it all over again:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;	- locked &amp;lt;0x000000057f16eab8&amp;gt; (a org.apache.zookeeper.ClientCnxn$Packet)
	at org.apache.zookeeper.ZooKeeper.getData(ZooKeeper.java:1129)
	at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.getData(RecoverableZooKeeper.java:284)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.getDataInternal(ZKUtil.java:522)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.getDataAndWatch(ZKUtil.java:498)
	at org.apache.hadoop.hbase.zookeeper.ZooKeeperNodeTracker.start(ZooKeeperNodeTracker.java:83)
	- locked &amp;lt;0x000000057f16dae0&amp;gt; (a org.apache.hadoop.hbase.MasterAddressTracker)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.ensureZookeeperTrackers(HConnectionManager.java:591)
	- locked &amp;lt;0x000000057f149dc8&amp;gt; (a org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:827)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:810)
	at org.apache.hadoop.hbase.client.HTable.finishSetup(HTable.java:234)
	at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:174)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:160)
	at org.apache.hadoop.hbase.client.MetaScanner.access$000(MetaScanner.java:54)
	at org.apache.hadoop.hbase.client.MetaScanner$1.connect(MetaScanner.java:133)
	at org.apache.hadoop.hbase.client.MetaScanner$1.connect(MetaScanner.java:130)
	at org.apache.hadoop.hbase.client.HConnectionManager.execute(HConnectionManager.java:360)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:130)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:105)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.prefetchRegionCache(HConnectionManager.java:903)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13459753" author="lhofhansl" created="Thu, 20 Sep 2012 17:13:24 +0000"  >&lt;p&gt;ensureZookeeperTrackers only does any work when ZK was not setup already. Previously this was sprinkled all over, but did the same amount of work. That part is OK, I think (in 0.94 HConnection needs a working ZK connection to function).&lt;/p&gt;

&lt;p&gt;Just checked, HConnectionManager.execute is called all over the place (12 different places in HConnectionManager and HTable).&lt;br/&gt;
We do some weird stuff. For example setting the prefetching is also done through execute (i.e. get a - potentially - new HConntionImplementation, call setPrefetching on it, then close it).&lt;/p&gt;

&lt;p&gt;On the face of it, this does not look like it&apos;s specific to region prefetching, but the fact that repeatedly do something with a new connection.&lt;/p&gt;

&lt;p&gt;@J-D: Did you disable this path and found faster?&lt;/p&gt;</comment>
                            <comment id="13459757" author="jdcryans" created="Thu, 20 Sep 2012 17:18:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;ensureZookeeperTrackers only does any work when ZK was not setup already.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right, but since we always close the connection at the end of execute() we always end up re-creating it.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Did you disable this path and found faster?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No, currently it&apos;s just an educated observation that&apos;s things are broken.&lt;/p&gt;</comment>
                            <comment id="13459893" author="apurtell" created="Thu, 20 Sep 2012 19:49:29 +0000"  >&lt;p&gt;Given J-D&apos;s observations, perhaps we should default meta prefetch to off, like Stack suggests. &lt;/p&gt;

&lt;p&gt;Some time ago I patched our private Frankenbase to allow disable of meta prefetch on a per table basis. This was because meta prefetch was causing heap limited MR clients to OOME, and for that particular application table prefetch wasn&apos;t helpful.&lt;/p&gt;</comment>
                            <comment id="13459910" author="lhofhansl" created="Thu, 20 Sep 2012 20:15:06 +0000"  >&lt;p&gt;I&apos;d be OK with that. I&apos;d also be worried that this is just a symptom. HConnectionManager.getConnection(...) and HConnection.close() should just do some reference counting rather than actually creating/destroying connection; which means sometime we&apos;re coming in there with a new Configuration every time...? And even that should be handled by the Configuration equivalence code we&apos;re using now.&lt;br/&gt;
So if, in this case, we&apos;d remove prefetching, we&apos;d still have the expensive Connection setup every time.&lt;/p&gt;

&lt;p&gt;Then again and just to state the obvious, the prefetching is only useful for long lived connections and then only if these connections actually use a larg&apos;ish portion of the prefetched entries (otherwise we&apos;re doing a lot of unnecessary work cache, and wasting memory).&lt;/p&gt;

&lt;p&gt;Let&apos;s just disable it by default. I guess we&apos;d do that by reversing the meaning (and name) of regionCachePrefetchDisabledTables). Happy to make a patch if you folks agree.&lt;/p&gt;</comment>
                            <comment id="13459927" author="lhofhansl" created="Thu, 20 Sep 2012 20:37:00 +0000"  >&lt;p&gt;Trivial patch.&lt;br/&gt;
For 0.94. Looks like trunk has the same problem.&lt;/p&gt;</comment>
                            <comment id="13459952" author="stack" created="Thu, 20 Sep 2012 20:54:14 +0000"  >&lt;p&gt;Its kinda ugly we have setRegionCachePrefetch up in HTable...  Is the meaning of the enable flag up in this public API changed by this patch?  Patch looks good otherwise.&lt;/p&gt;
</comment>
                            <comment id="13459962" author="lhofhansl" created="Thu, 20 Sep 2012 21:00:37 +0000"  >&lt;p&gt;Yeah the stuff we in HTable is a disaster (if you ask me... probably has to do with multiple threads using HTables that share the same HConnection, not sure), but I think that&apos;s for another patch.&lt;/p&gt;

&lt;p&gt;The meaning of the flag is not changed, just the default (unless I made mistake in the patch).&lt;/p&gt;</comment>
                            <comment id="13459985" author="lhofhansl" created="Thu, 20 Sep 2012 21:40:02 +0000"  >&lt;p&gt;0.96 patch for Hadoop QA&lt;/p&gt;</comment>
                            <comment id="13460021" author="hadoopqa" created="Thu, 20 Sep 2012 22:46:23 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12545967/6841-0.96.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12545967/6841-0.96.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated 139 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 14 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestHCM&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2909//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13460023" author="stack" created="Thu, 20 Sep 2012 22:47:58 +0000"  >&lt;p&gt;+1 on patch but whats that TestHCM fail about?&lt;/p&gt;</comment>
                            <comment id="13460024" author="lhofhansl" created="Thu, 20 Sep 2012 22:48:16 +0000"  >&lt;p&gt;Heh. TestHCM.testRegionCaching  looks relevant &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Looking.&lt;/p&gt;</comment>
                            <comment id="13460069" author="lhofhansl" created="Fri, 21 Sep 2012 00:01:07 +0000"  >&lt;p&gt;Not sure what the test issue is, yet.&lt;/p&gt;

&lt;p&gt;Also looking at the code again I notice the prefetchRegionLimit is already defaulted to 10. &lt;/p&gt;</comment>
                            <comment id="13460254" author="lhofhansl" created="Fri, 21 Sep 2012 06:06:47 +0000"  >&lt;p&gt;Haven&apos;t been able to track down that test failure, yet. It shouldn&apos;t happen, but yet somehow it does.&lt;br/&gt;
@J-D: Since this is (presumably) a long standing condition, how do you feel about moving this to 0.94.3?&lt;/p&gt;</comment>
                            <comment id="13460619" author="lhofhansl" created="Fri, 21 Sep 2012 16:58:32 +0000"  >&lt;p&gt;Which client did you jstack? There&apos;re at least two clients at work here: The one the attempts the truncate and the ones that still perform the requests.&lt;br/&gt;
I assume the stuck ones are the those that are still performing the requests.&lt;/p&gt;

&lt;p&gt;I am beginning to doubt that prefetching is a issue here. This has to do with how these clients connect. There should not need to be a connection setup each time.&lt;/p&gt;</comment>
                            <comment id="13460666" author="lhofhansl" created="Fri, 21 Sep 2012 18:12:24 +0000"  >&lt;p&gt;I&apos;d like to move this to 0.94.3. Please pull back if you disagree.&lt;/p&gt;</comment>
                            <comment id="13460674" author="jdcryans" created="Fri, 21 Sep 2012 18:24:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;@J-D: Since this is (presumably) a long standing condition, how do you feel about moving this to 0.94.3?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m ok.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Which client did you jstack? There&apos;re at least two clients at work here: The one the attempts the truncate and the ones that still perform the requests.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The clients. I truncated separately.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I am beginning to doubt that prefetching is a issue here. This has to do with how these clients connect. There should not need to be a connection setup each time.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Something is broken, we agree there &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13482987" author="lhofhansl" created="Wed, 24 Oct 2012 05:27:05 +0000"  >&lt;p&gt;Moving to 0.94.4&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt; Have you seen this again?&lt;/p&gt;</comment>
                            <comment id="13484210" author="jdcryans" created="Thu, 25 Oct 2012 15:54:50 +0000"  >&lt;p&gt;I&apos;m not seeing it again because I disabled prefetching in our production clusters.&lt;/p&gt;</comment>
                            <comment id="13558529" author="lhofhansl" created="Mon, 21 Jan 2013 04:38:13 +0000"  >&lt;p&gt;I am not convinced that this was due to prefetching. (it only does 10 regions by default anyway).&lt;br/&gt;
Removing from 0.94. Pull back if you disagree.&lt;/p&gt;</comment>
                            <comment id="13609585" author="amitanand" created="Thu, 21 Mar 2013 22:18:34 +0000"  >&lt;p&gt;I have seen some issues recently when there are large failures in our cluster. &lt;/p&gt;

&lt;p&gt;Looking at the jstacks taken during the failures, It looks like all client threads are blocking on the synchronized (regionLockObject) call,&lt;br/&gt;
in locateRegionInMeta.&lt;/p&gt;

&lt;p&gt;Seems like the threads go in and do the cache warmup; although the cache might have been already warmed up by an earlier thread. &lt;/p&gt;</comment>
                            <comment id="14490618" author="apurtell" created="Sat, 11 Apr 2015 00:30:52 +0000"  >&lt;p&gt;Reopen if still an issue with current code&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12545961" name="6841-0.94.txt" size="1452" author="lhofhansl" created="Thu, 20 Sep 2012 20:37:00 +0000"/>
                            <attachment id="12545967" name="6841-0.96.txt" size="1519" author="lhofhansl" created="Thu, 20 Sep 2012 21:40:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 19 Sep 2012 17:56:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239617</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 35 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00rt3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2437</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>