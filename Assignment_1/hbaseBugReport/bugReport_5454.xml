<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:27:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5454/HBASE-5454.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5454] Refuse operations from Admin before master is initialized</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5454</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In our testing environment,&lt;br/&gt;
When master is initializing, we found conflict problems between master#assignAllUserRegions and EnableTable event, causing assigning region throw exception so that master abort itself.&lt;/p&gt;

&lt;p&gt;We think we&apos;d better refuse operations from Admin, such as CreateTable, EnableTable,etc, It could reduce error.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12543636">HBASE-5454</key>
            <summary>Refuse operations from Admin before master is initialized</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zjushch">chunhui shen</assignee>
                                    <reporter username="zjushch">chunhui shen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Feb 2012 08:11:29 +0000</created>
                <updated>Fri, 12 Oct 2012 05:35:13 +0000</updated>
                            <resolved>Thu, 1 Mar 2012 07:00:28 +0000</resolved>
                                                    <fixVersion>0.94.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13214144" author="stack" created="Thu, 23 Feb 2012 00:51:34 +0000"  >&lt;p&gt;This patch is a good idea Chunhui.&lt;/p&gt;

&lt;p&gt;I don&apos;t think you need to have this message &quot;Master is not initialized&quot; on an exception whose type is: MasterNotInitializedException.  It seems redundant.&lt;/p&gt;

&lt;p&gt;Remove this line:&lt;/p&gt;

&lt;p&gt;+ * Copyright 2007 The Apache Software Foundation&lt;/p&gt;

&lt;p&gt;Maybe you don&apos;t need these two methods?&lt;/p&gt;

&lt;p&gt;+  public MasterNotInitializedException(String s) &lt;/p&gt;
{
+    super(s);
+  }
&lt;p&gt;+&lt;br/&gt;
+  /**&lt;br/&gt;
+   * Constructor taking another exception.&lt;br/&gt;
+   * &lt;br/&gt;
+   * @param e Exception to grab data from.&lt;br/&gt;
+   */&lt;br/&gt;
+  public MasterNotInitializedException(Exception e) {&lt;/p&gt;
</comment>
                            <comment id="13214186" author="zjushch" created="Thu, 23 Feb 2012 01:41:16 +0000"  >&lt;p&gt;@Stack&lt;br/&gt;
What about we define the safemode for master like namenode, where master is aborting and initializing.&lt;/p&gt;

&lt;p&gt;In the safemode, we maybe could also refuse ServerShutdownHandler which simplify solution of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5270&quot; title=&quot;Handle potential data loss due to concurrent processing of processFaileOver and ServerShutdownHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5270&quot;&gt;&lt;del&gt;HBASE-5270&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13214202" author="zhihyu@ebaysf.com" created="Thu, 23 Feb 2012 02:11:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;could also refuse ServerShutdownHandler&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What is the server carrying .META. needs to run ServerShutdownHandler ?&lt;/p&gt;</comment>
                            <comment id="13214244" author="zjushch" created="Thu, 23 Feb 2012 02:54:54 +0000"  >&lt;blockquote&gt;&lt;p&gt;What is the server carrying .META. needs to run ServerShutdownHandler ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;In that case, we could just split log. Instead expireIfOnline, add a method splitLogIfOnline.&lt;/p&gt;</comment>
                            <comment id="13214246" author="zjushch" created="Thu, 23 Feb 2012 02:56:14 +0000"  >&lt;p&gt;To be exact, we don&apos;t refuse SSH, but delay process SSH after master is initialized.&lt;/p&gt;</comment>
                            <comment id="13214252" author="zhihyu@ebaysf.com" created="Thu, 23 Feb 2012 03:14:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;Instead expireIfOnline, add a method splitLogIfOnline.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The approach should work.&lt;/p&gt;

&lt;p&gt;We just need to cleanly refactor ServerShutdownHandler so that maximum code reuse is achieved.&lt;/p&gt;</comment>
                            <comment id="13214314" author="stack" created="Thu, 23 Feb 2012 05:07:22 +0000"  >&lt;p&gt;Chunhui Want to do that other stuff in a different issue?  This one is nice and simple as is if you make the changes suggested I can commit.&lt;/p&gt;</comment>
                            <comment id="13214416" author="zjushch" created="Thu, 23 Feb 2012 07:34:56 +0000"  >&lt;p&gt;@stack&lt;br/&gt;
I add safe mode for master in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5270&quot; title=&quot;Handle potential data loss due to concurrent processing of processFaileOver and ServerShutdownHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5270&quot;&gt;&lt;del&gt;HBASE-5270&lt;/del&gt;&lt;/a&gt;&#8217;s V4 patch to fix this issue too.&lt;br/&gt;
Please review it.&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="13214870" author="stack" created="Thu, 23 Feb 2012 17:30:50 +0000"  >&lt;p&gt;So, you want to mash this patch into hbase-5270?  If so, close this one as won&apos;t fix?&lt;/p&gt;</comment>
                            <comment id="13215296" author="zjushch" created="Fri, 24 Feb 2012 01:32:08 +0000"  >&lt;p&gt;Yes, I think so, close this one as won&apos;t fix.&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="13219737" author="zjushch" created="Thu, 1 Mar 2012 02:21:39 +0000"  >&lt;p&gt;In patch v2, master will throw PleaseHoldException when master is initializing and client call admin operations.&lt;/p&gt;</comment>
                            <comment id="13219803" author="hadoopqa" created="Thu, 1 Mar 2012 04:45:38 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12516635/hbase-5454v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12516635/hbase-5454v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -131 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 155 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1065//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1065//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1065//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1065//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1065//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1065//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13219807" author="stack" created="Thu, 1 Mar 2012 04:50:25 +0000"  >&lt;p&gt;Reopening since Chunhui added a v2.&lt;/p&gt;</comment>
                            <comment id="13219808" author="stack" created="Thu, 1 Mar 2012 04:51:09 +0000"  >&lt;p&gt;I&apos;m +1 on commit for this.  We can figure something similar for handling of zk callbacks in another issue.&lt;/p&gt;</comment>
                            <comment id="13219860" author="stack" created="Thu, 1 Mar 2012 07:00:29 +0000"  >&lt;p&gt;Committed to trunk.  Thanks for the patch Chunhui.&lt;/p&gt;</comment>
                            <comment id="13219891" author="lhofhansl" created="Thu, 1 Mar 2012 07:58:44 +0000"  >&lt;p&gt;0.94?&lt;/p&gt;</comment>
                            <comment id="13220177" author="stack" created="Thu, 1 Mar 2012 17:41:03 +0000"  >&lt;p&gt;Committed to 0.94.0 too.&lt;/p&gt;

&lt;p&gt;The patch is incomplete in that it disables the public table modification apis only during master initialization.  Other stuff like zk callbacks can still run.  I think though that even though incomplete, its helps.&lt;/p&gt;</comment>
                            <comment id="13220245" author="hudson" created="Thu, 1 Mar 2012 18:56:38 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #6 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/6/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/6/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5454&quot; title=&quot;Refuse operations from Admin before master is initialized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5454&quot;&gt;&lt;del&gt;HBASE-5454&lt;/del&gt;&lt;/a&gt; Refuse operations from Admin before master is initialized (Revision 1295693)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/PleaseHoldException.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13220257" author="hudson" created="Thu, 1 Mar 2012 19:05:12 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2671 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2671/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2671/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5454&quot; title=&quot;Refuse operations from Admin before master is initialized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5454&quot;&gt;&lt;del&gt;HBASE-5454&lt;/del&gt;&lt;/a&gt; Refuse operations from Admin before master is initialized (Revision 1295433)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/PleaseHoldException.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13253245" author="xufeng" created="Fri, 13 Apr 2012 09:32:22 +0000"  >&lt;p&gt;@chunhui&lt;br/&gt;
Does it need to be added in HMaster#createTable?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12515553" name="hbase-5454.patch" size="7033" author="zjushch" created="Wed, 22 Feb 2012 08:33:10 +0000"/>
                            <attachment id="12516635" name="hbase-5454v2.patch" size="4662" author="zjushch" created="Thu, 1 Mar 2012 02:20:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 23 Feb 2012 00:51:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228875</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 36 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08qgv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48888</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>