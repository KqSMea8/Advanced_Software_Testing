<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:10:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3523/HBASE-3523.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3523] Rewrite our client (client 2.0)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3523</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Is it just me or do others sense that there is pressure building to redo the client?  If just me, ignore the below... I&apos;ll just keep notes in here.  Otherwise, what would the requirements for a client rewrite look like?&lt;/p&gt;

&lt;p&gt;+ Let out InterruptedException&lt;br/&gt;
+ Enveloping of messages or space for metadata that can be passed by client to server and by server to client; e.g. the region a.b.c moved to server x.y.z. or scanner is finished or timeout&lt;br/&gt;
+ A different RPC? One with tighter serialization.&lt;br/&gt;
+ More sane timeout/retry policy.&lt;/p&gt;

&lt;p&gt;Does it have to support async communication?  Do callbacks?&lt;/p&gt;

&lt;p&gt;What else?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12498300">HBASE-3523</key>
            <summary>Rewrite our client (client 2.0)</summary>
                <type id="13" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/genericissue.png">Brainstorming</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Feb 2011 23:41:38 +0000</created>
                <updated>Sat, 11 Apr 2015 01:16:48 +0000</updated>
                            <resolved>Sat, 11 Apr 2015 01:16:48 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                <comments>
                            <comment id="12993276" author="ryanobjc" created="Thu, 10 Feb 2011 23:58:42 +0000"  >&lt;p&gt;Things that are issues:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the use of proxy means that the interfaces &lt;em&gt;must have&lt;/em&gt; InterruptedException on the interface, or else you get &quot;undeclared throwable exception&quot;, but now you are conflating a business contract (the interfaces) and networking/execution realities. Futhermore going through a proxy object isn&apos;t necessary, its just more layers, since few people directly code against the interfaces.&lt;/li&gt;
	&lt;li&gt;multiple level of timeouts causes unnecessary confusion. Also the retry loops in HCM cause confusion and issues.&lt;/li&gt;
	&lt;li&gt;client should support parallelism more directly, no more thread pools that just sleep!&lt;/li&gt;
	&lt;li&gt;lots of callables make the code harder to read, either get rid of them or use more inner classes. Jumping around files makes for difficult comprehension.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Some good things:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the base socket handling is actually in good shape. 1 socket per client-rs pair is about where we want to be.&lt;/li&gt;
	&lt;li&gt;multiplexing requests on the same socket is good, not spawning extra threads server side just to handle more clients is also good. since every client will have an open socket to at least the META region, this is very important!&lt;/li&gt;
	&lt;li&gt;the handler pool is a natural side effect of the previous point, unbounding it might not be a good idea.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Other constraints:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;we will want to provide an efficient blocking API, it&apos;s what is expected.&lt;/li&gt;
	&lt;li&gt;an async api might be nice, perhaps it can layer on or something.&lt;/li&gt;
	&lt;li&gt;Making HTable thread agnostic might be useful. Pooling the write buffer or doing something else interesting there would be necessary.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12993279" author="streamy" created="Fri, 11 Feb 2011 00:04:15 +0000"  >&lt;p&gt;A binary, language agnostic underlying RPC and wire protocol.  Async, as an option, would be nice as well.&lt;/p&gt;

&lt;p&gt;I&apos;d like more visibility and control into what is happening underneath with respect to connections to RegionServers and such.  I don&apos;t like all the staticness and voodoo magic, at least not as the only option.  The usage of like a hash of Configuration has always been weird to me.&lt;/p&gt;

&lt;p&gt;A better API for how errors are returned, for example, I can never understand how the MultiAction stuff without digging into code.&lt;/p&gt;

&lt;p&gt;+1 to your suggestions.  We can already do stuff off the back of ZK for region movement if we wanted, but the opportunity for little hints in RPCs would be neat as well.&lt;/p&gt;

&lt;p&gt;Thanks for filing this stack.&lt;/p&gt;</comment>
                            <comment id="12994018" author="apurtell" created="Sun, 13 Feb 2011 06:16:20 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Run time interface extension, consider the existing dynamic RPC stuff though it doesn&apos;t have to be done exactly that way. Regarding use (or not) of proxy objects, right now we have &amp;lt;T&amp;gt; HTable.coprocessorProxy(...) which if users adopt will produce user code that does need it.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Option for async interaction.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Use executors instead of threads. Allow the user to pass in an executor pool of desired construction.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Resurrect &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1015&quot; title=&quot;HBase Native Client Library&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1015&quot;&gt;&lt;del&gt;HBASE-1015&lt;/del&gt;&lt;/a&gt;?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12994019" author="ryanobjc" created="Sun, 13 Feb 2011 06:31:11 +0000"  >&lt;p&gt;Are not executors thread pools? Right now HCM will use the executor passed to it from HTable to do parallel queries (multi). But there is no good reason to layer more threads on top of the socket/proxy layer. &lt;/p&gt;</comment>
                            <comment id="12994022" author="apurtell" created="Sun, 13 Feb 2011 07:26:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;Are not executors thread pools?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I meant merely no creation of internal thread pools. So users can create executors with their own thread factories, etc.&lt;/p&gt;



</comment>
                            <comment id="12994025" author="ryanobjc" created="Sun, 13 Feb 2011 07:31:43 +0000"  >&lt;p&gt;wouldn&apos;t it be better not to need thread pools? Right now we are using them to merely wait on sync APIs that underneath async/multiplexing. A big waste of threads to me...!&lt;/p&gt;</comment>
                            <comment id="12994026" author="apurtell" created="Sun, 13 Feb 2011 07:35:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;wouldn&apos;t it be better not to need thread pools?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m not opposed to the idea. Not sure how far people want to go. &lt;/p&gt;</comment>
                            <comment id="13173906" author="stack" created="Wed, 21 Dec 2011 06:32:36 +0000"  >&lt;p&gt;Breathing some life back into this issue:&lt;/p&gt;

&lt;p&gt;Reasons for new client, updates:&lt;/p&gt;

&lt;p&gt;+ The Jonathan Payne accounting of unaccounted off-heap socket buffers per thread which makes our client OOME when lots of threads (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4956&quot; title=&quot;Control direct memory buffer consumption by HBaseClient&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4956&quot;&gt;&lt;del&gt;HBASE-4956&lt;/del&gt;&lt;/a&gt;)&lt;br/&gt;
+ &quot;complex&quot;, lots of layers, long-lived zk connection (not necessary on client?)&lt;br/&gt;
+ Should work against multiple versions of hbase (but that might be another issue, an rpc issue... this issue could be distinct from rpc fixup?)&lt;/p&gt;

&lt;p&gt;See also Lars comment here: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5058?focusedCommentId=13173364&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13173364&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-5058?focusedCommentId=13173364&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13173364&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12499999">HBASE-3584</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12461156">HBASE-2408</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12435773">HBASE-1844</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12472662">HBASE-2937</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12533914">HBASE-4956</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12435772">HBASE-1843</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12493811">HBASE-3382</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12446756">HBASE-2170</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12455264">HBASE-2182</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 10 Feb 2011 23:58:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33071</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02bbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11434</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>