<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:38:52 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13022/HBASE-13022.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13022] &quot;RegionException: Retries exhausted...&quot; ERROR in HBaseAdmin.disableTable(...) if hbase.client.pause=0</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13022</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If hbase.client.pause set to 0 it breaks retry back-off logic in HbaseAdmin.getPauseTime() for DDL operations. Operation succeeds because it happens asynchronously but caller get an Exception because caller thread did not wait for operation to complete:&lt;br/&gt;
...&lt;br/&gt;
Caused by: org.apache.hadoop.hbase.RegionException: Retries exhausted, it took too long to wait for the table FOO to be disabled.&lt;br/&gt;
	at org.apache.hadoop.hbase.client.HBaseAdmin.disableTable(HBaseAdmin.java:997)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.HBaseAdmin.disableTable(HBaseAdmin.java:1005)&lt;br/&gt;
...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12774396">HBASE-13022</key>
            <summary>&quot;RegionException: Retries exhausted...&quot; ERROR in HBaseAdmin.disableTable(...) if hbase.client.pause=0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ssmirnov">Sergey Smirnov</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Feb 2015 00:15:54 +0000</created>
                <updated>Thu, 12 Feb 2015 20:32:57 +0000</updated>
                                                                            <component>Admin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="14317257" author="ssmirnov" created="Thu, 12 Feb 2015 00:21:08 +0000"  >&lt;p&gt;Attaching patch to illustrate problem and provide potential fix&lt;/p&gt;</comment>
                            <comment id="14318042" author="octo47" created="Thu, 12 Feb 2015 11:47:10 +0000"  >&lt;p&gt;Thank you for patch, but why in the first place pause was set to 0? &lt;br/&gt;
Can you share your usecase where you need zero pause?&lt;/p&gt;

&lt;p&gt;In my sense code works as expected, with zero pause there will be no &lt;br/&gt;
pauses between retries and as expected fast fall of retry cycle?&lt;br/&gt;
This logic used across the code, for example one more place &lt;br/&gt;
where pause will be zero too org.apache.hadoop.hbase.client.ConnectionUtils#getPauseTime.&lt;/p&gt;
</comment>
                            <comment id="14318781" author="ssmirnov" created="Thu, 12 Feb 2015 19:08:43 +0000"  >&lt;p&gt;I am not sure what was exact intention of setting it to 0 - probably have 0 pause between DML attempts to fail fast. So it is fine in case of get operation: we tried once, did not succeed, immediately tried second time and fail if there is no success again.&lt;/p&gt;

&lt;p&gt;For DDL operations (disable, create, etc) it is a different story. Because most of these operations happen asynchronously there is some additional logic to wait longer until executing thread finishes. e.g. in case of disableTable (HbaseAdmin.disableTable(...)) waiting loop is defined as:&lt;br/&gt;
for (int tries = 0; tries &amp;lt; (this.numRetries * this.retryLongerMultiplier); tries++)&lt;br/&gt;
where is retryLongerMultiplier = hbase.client.retries.longer.multiplier and is 10 by default&lt;br/&gt;
And in each iteration of this waiting loop we try to gradually increase waiting time: getPauseTime(tries)&lt;br/&gt;
Even if hbase.client.pause=1 it works perfectly but 0 brakes it because getPauseTime(tries) always return 0 and this waiting loop is broken - we exit almost immediately&lt;br/&gt;
So in my opinion it should either be fixed for DDL case or at least mentioned explicitly in documentation warning users that setting it to 0 will cause exceptions fore some of the DDL operations &lt;/p&gt;</comment>
                            <comment id="14318931" author="octo47" created="Thu, 12 Feb 2015 20:32:57 +0000"  >&lt;p&gt;That would introduce discrepancy in what this property is for. Here should be either different property or just warning.&lt;br/&gt;
I&apos;d not change this behaviour as you propose because currently it behaves as expected: zero pause is exactly zero. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12698249" name="HBASE-13022__RegionException__Retries_exhausted.patch" size="854" author="ssmirnov" created="Thu, 12 Feb 2015 00:21:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 12 Feb 2015 11:47:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i25ijj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>