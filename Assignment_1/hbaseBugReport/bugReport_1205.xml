<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:51:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1205/HBASE-1205.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1205] RegionServers should find new master when a new master comes up.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1205</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description></description>
                <environment></environment>
        <key id="12415107">HBASE-1205</key>
            <summary>RegionServers should find new master when a new master comes up.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nitay">Nitay Joffe</assignee>
                                    <reporter username="nitay">Nitay Joffe</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Feb 2009 00:50:52 +0000</created>
                <updated>Thu, 2 May 2013 02:29:20 +0000</updated>
                            <resolved>Fri, 3 Apr 2009 01:24:55 +0000</resolved>
                                    <version>0.20.0</version>
                                    <fixVersion>0.20.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12675087" author="stack" created="Thu, 19 Feb 2009 18:41:56 +0000"  >&lt;p&gt;Is this about regionserver polling zk when without a master?&lt;/p&gt;</comment>
                            <comment id="12675088" author="nitay" created="Thu, 19 Feb 2009 18:43:24 +0000"  >&lt;p&gt;Either that, or each region server can put a watcher on the master address node so that when it is deleted/recreated they update their stored master address.&lt;/p&gt;</comment>
                            <comment id="12693895" author="nitay" created="Mon, 30 Mar 2009 20:16:02 +0000"  >&lt;p&gt;In this patch:&lt;/p&gt;

&lt;p&gt;We register the HRegionServer as a watcher on the master address ephemeral ZNode in ZooKeeper. The HRegionServer watches for &quot;NodeCreated&quot; events on that ZNode, which means a new master has come up and written its address to the ZNode. When that event is received, we call getMaster() to set the hbaseMaster instance variable to the new master address. Any current operations going on which were using the old master will fail their retries eventually and get automatically switched over to the new master next time.&lt;/p&gt;

&lt;p&gt;I made the sleeper variable that&apos;s used in run() an instance variable so that I can use it in other places like watchMasterAddress().&lt;/p&gt;


&lt;p&gt;I tested this by taking down the master on my 4 node cluster and bringing it up elsewhere. I&apos;ve attached the log from a regionserver. This is the cool part:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2009-03-30 07:57:13,977 INFO org.apache.hadoop.ipc.HBaseClass: Retrying connect to server: /208.76.44.158:60007. Already tried 0 time(s).
2009-03-30 07:57:14,987 INFO org.apache.hadoop.ipc.HBaseClass: Retrying connect to server: /208.76.44.158:60007. Already tried 1 time(s).
2009-03-30 07:57:15,232 DEBUG org.apache.hadoop.hbase.regionserver.HRegionServer: Got ZooKeeper event, state: SyncConnected, type: NodeCreated, path: /hbase/master
2009-03-30 07:57:15,233 DEBUG org.apache.hadoop.hbase.zookeeper.ZooKeeperWrapper: Read ZNode /hbase/master got 208.76.44.139:60007
2009-03-30 07:57:15,233 DEBUG org.apache.hadoop.hbase.regionserver.HRegionServer: Telling master at 208.76.44.139:60007 that we are up
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12693902" author="stack" created="Mon, 30 Mar 2009 20:47:02 +0000"  >&lt;p&gt;Minor (Don&apos;t bother making another patch &amp;#8211; I can do it when I commit):&lt;/p&gt;

&lt;p&gt;Switching masters is probably deserving of info-level logging.&lt;/p&gt;

&lt;p&gt;Is that all it takes to make the regionservers notice a new master and then sign on?  What  happens to the regions the regionserver was carrying?  Do they carry on serving them?  From attached log, it looks like we start over?&lt;/p&gt;
</comment>
                            <comment id="12693908" author="nitay" created="Mon, 30 Mar 2009 21:14:07 +0000"  >&lt;p&gt;Yes, this doesn&apos;t change what the master does on startup. It just makes the regionserver find the new master so it doesn&apos;t go retrying on the dead master endlessly. That means we&apos;ll still go reassigning all of the regions, which is not ideal, as you mention. Shall I open a separate issue for it?&lt;/p&gt;</comment>
                            <comment id="12693954" author="apurtell" created="Tue, 31 Mar 2009 00:09:02 +0000"  >&lt;p&gt;+1 on this patch.&lt;/p&gt;

&lt;p&gt;+1 on opening an issue to let regionservers continue carrying region assignments from an earlier master.&lt;/p&gt;</comment>
                            <comment id="12695206" author="apurtell" created="Fri, 3 Apr 2009 01:24:45 +0000"  >&lt;p&gt;Committed to trunk. Passes all local tests. &lt;br/&gt;
Included stack&apos;s suggestion about info level logging on master change.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12421690">HBASE-1302</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12412929">HBASE-1145</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12404169" name="hbase-1205.patch" size="7972" author="nitay" created="Mon, 30 Mar 2009 20:16:02 +0000"/>
                            <attachment id="12404170" name="hbase-nitay-regionserver-aa0-000-12.u.powerset.com.log" size="36396" author="nitay" created="Mon, 30 Mar 2009 20:16:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 19 Feb 2009 18:41:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32041</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 38 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hby7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99198</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>