<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:07:02 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3062/HBASE-3062.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3062] ZooKeeper KeeperException$ConnectionLossException is a &quot;recoverable&quot; exception; we should retry a while on server startup at least.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3062</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;On startup of daemons we&apos;ll sometimes fail (new master) with something like the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2010-09-30 23:38:36,979 INFO org.apache.hadoop.hbase.zookeeper.ZKUtil: regionserver60020 opening connection to ZooKeeper with quorum (sv2borg182:20001,sv2borg181:20001,sv2borg180:20001)
2010-09-30 23:38:36,979 INFO org.apache.zookeeper.ZooKeeper: Initiating client connection, connectString=sv2borg182:20001,sv2borg181:20001,sv2borg180:20001 sessionTimeout=60000 watcher=regionserver60020
2010-09-30 23:38:36,980 INFO org.apache.zookeeper.ClientCnxn: Opening socket connection to server sv2borg182/10.20.20.182:20001
2010-09-30 23:38:36,980 INFO org.apache.zookeeper.ClientCnxn: Socket connection established to sv2borg182/10.20.20.182:20001, initiating session
2010-09-30 23:38:36,981 INFO org.apache.zookeeper.ClientCnxn: Unable to read additional data from server sessionid 0x0, likely server has closed socket, closing socket connection and attempting reconnect
2010-09-30 23:38:37,083 ERROR org.apache.hadoop.hbase.zookeeper.ZooKeeperWatcher: regionserver60020 Unexpected KeeperException creating base node
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
    at org.apache.zookeeper.KeeperException.create(KeeperException.java:90)
    at org.apache.zookeeper.KeeperException.create(KeeperException.java:42)
    at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:637)
    at org.apache.hadoop.hbase.zookeeper.ZKUtil.createAndFailSilent(ZKUtil.java:807)
    at org.apache.hadoop.hbase.zookeeper.ZooKeeperWatcher.&amp;lt;init&amp;gt;(ZooKeeperWatcher.java:107)
    at org.apache.hadoop.hbase.regionserver.HRegionServer.initializeZooKeeper(HRegionServer.java:438)
    at org.apache.hadoop.hbase.regionserver.HRegionServer.initialize(HRegionServer.java:420)
    at org.apache.hadoop.hbase.regionserver.HRegionServer.&amp;lt;init&amp;gt;(HRegionServer.java:305)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at org.apache.hadoop.hbase.regionserver.HRegionServer.constructRegionServer(HRegionServer.java:2436)
    at org.apache.hadoop.hbase.regionserver.HRegionServerCommandLine.start(HRegionServerCommandLine.java:60)
    at org.apache.hadoop.hbase.regionserver.HRegionServerCommandLine.run(HRegionServerCommandLine.java:75)
    at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
    at org.apache.hadoop.hbase.util.ServerCommandLine.doMain(ServerCommandLine.java:76)
    at org.apache.hadoop.hbase.regionserver.HRegionServer.main(HRegionServer.java:2460)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll see it over on master too the odd time.&lt;/p&gt;

&lt;p&gt;Currently we fail out (though in above case, because of order in which we do startup the regionserver actually hung up because RPC was started before zk)&lt;/p&gt;

&lt;p&gt;We should retry this error some at least on startup because its &apos;recoverable&apos; (See &lt;a href=&quot;http://wiki.apache.org/hadoop/ZooKeeper/ErrorHandling&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/ZooKeeper/ErrorHandling&lt;/a&gt;).  In fact, we should probably retry always until we get a session expired.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12475576">HBASE-3062</key>
            <summary>ZooKeeper KeeperException$ConnectionLossException is a &quot;recoverable&quot; exception; we should retry a while on server startup at least.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Oct 2010 04:59:32 +0000</created>
                <updated>Fri, 20 Nov 2015 12:43:03 +0000</updated>
                            <resolved>Sat, 9 Oct 2010 17:55:42 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12916782" author="stack" created="Fri, 1 Oct 2010 05:01:09 +0000"  >&lt;p&gt;This patch retries connection loss a configurable amount of time.  It also changes startup order in hrs so we have zk before we startup up rpc.&lt;/p&gt;

&lt;p&gt;Need to test this patch still.&lt;/p&gt;</comment>
                            <comment id="12916785" author="stack" created="Fri, 1 Oct 2010 05:08:22 +0000"  >&lt;p&gt;This one will let let cluster start (No NPE when go to get port in zk).&lt;/p&gt;</comment>
                            <comment id="12916917" author="streamy" created="Fri, 1 Oct 2010 15:40:44 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12919521" author="stack" created="Sat, 9 Oct 2010 17:53:44 +0000"  >&lt;p&gt;Patch seems to be doing the right thing. See here (zk quorum was down at the time):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2010-10-09 10:52:33,731 INFO  [main] zookeeper.ZKUtil(94): master:51876 opening connection to ZooKeeper with quorum (localhost:21810)
2010-10-09 10:52:33,877 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 9889ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:34,010 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 9756ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:34,615 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 9151ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:36,052 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 7714ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:36,715 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 7051ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:37,509 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 6257ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:39,069 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 4697ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:39,618 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 4148ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:39,982 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 3784ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:41,886 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 1880ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:42,577 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 1189ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:43,377 DEBUG [main] zookeeper.ZooKeeperWatcher(122): Retrying zk create &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; another 389ms; set &apos;hbase.zookeeper.recoverable.waittime&apos; to change wait time); KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
2010-10-09 10:52:45,335 ERROR [main] zookeeper.ZooKeeperWatcher(135): master:51876 Unexpected KeeperException creating base node
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:90)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:42)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:637)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12919522" author="stack" created="Sat, 9 Oct 2010 17:55:42 +0000"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="12919523" author="stack" created="Sat, 9 Oct 2010 17:56:40 +0000"  >&lt;p&gt;Here is what I committed.  Slightly different from what Jon reviewed in that log messages format was changed and prefixed with an isDebugEnabled check.&lt;/p&gt;</comment>
                            <comment id="12919525" author="streamy" created="Sat, 9 Oct 2010 18:18:20 +0000"  >&lt;p&gt;We should open a JIRA to do this across all zk operations.  Not sure what the cleanest way for us to get this retry logic across ZKUtil would be.&lt;/p&gt;</comment>
                            <comment id="12919529" author="stack" created="Sat, 9 Oct 2010 18:47:27 +0000"  >&lt;p&gt;Already did.  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3065&quot; title=&quot;Retry all &amp;#39;retryable&amp;#39; zk operations; e.g. connection loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3065&quot;&gt;&lt;del&gt;HBASE-3065&lt;/del&gt;&lt;/a&gt;.  Sorry.  Should have made mention of it in this issue.&lt;/p&gt;</comment>
                            <comment id="15017417" author="lars_francke" created="Fri, 20 Nov 2015 12:43:03 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12456778" name="3062-v3.txt" size="3335" author="stack" created="Sat, 9 Oct 2010 17:56:40 +0000"/>
                            <attachment id="12456085" name="3063-v2.txt" size="2819" author="stack" created="Fri, 1 Oct 2010 05:08:22 +0000"/>
                            <attachment id="12456083" name="3063.txt" size="2611" author="stack" created="Fri, 1 Oct 2010 05:01:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 1 Oct 2010 15:40:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26621</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hkkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100596</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>