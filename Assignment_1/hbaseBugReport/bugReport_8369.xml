<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:54:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8369/HBASE-8369.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8369] MapReduce over snapshot files</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8369</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The idea is to add an InputFormat, which can run the mapreduce job over snapshot files directly bypassing hbase server layer. The IF is similar in usage to TableInputFormat, taking a Scan object from the user, but instead of running from an online table, it runs from a table snapshot. We do one split per region in the snapshot, and open an HRegion inside the RecordReader. A RegionScanner is used internally for doing the scan without any HRegionServer bits. &lt;/p&gt;

&lt;p&gt;Users have been asking and searching for ways to run MR jobs by reading directly from hfiles, so this allows new use cases if reading from stale data is ok:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Take snapshots periodically, and run MR jobs only on snapshots.&lt;/li&gt;
	&lt;li&gt;Export snapshots to remote hdfs cluster, run the MR jobs at that cluster without HBase cluster.&lt;/li&gt;
	&lt;li&gt;(Future use case) Combine snapshot data with online hbase data: Scan from yesterday&apos;s snapshot, but read today&apos;s data from online hbase cluster.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12643055">HBASE-8369</key>
            <summary>MapReduce over snapshot files</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="enis">Enis Soztutar</assignee>
                                    <reporter username="enis">Enis Soztutar</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Apr 2013 22:28:28 +0000</created>
                <updated>Fri, 20 Nov 2015 11:52:45 +0000</updated>
                            <resolved>Mon, 18 Nov 2013 22:20:38 +0000</resolved>
                                                    <fixVersion>0.98.0</fixVersion>
                                    <component>mapreduce</component>
                    <component>snapshots</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>39</watches>
                                                                                                            <comments>
                            <comment id="13634533" author="lhofhansl" created="Wed, 17 Apr 2013 22:31:37 +0000"  >&lt;p&gt;That sounds awesome. All new code, I assume, so I&apos;d be OK with this in 0.94 as well (but I don&apos;t have a strong preference).&lt;/p&gt;</comment>
                            <comment id="13634536" author="enis" created="Wed, 17 Apr 2013 22:32:42 +0000"  >&lt;p&gt;Attaching a prototype patch which seems to work for the test case. There are a lot of TODO&apos;s in the patch, and needs some polishing. Also no test done on actual clusters. But it should be enough to give an idea to the approach. &lt;/p&gt;</comment>
                            <comment id="13634538" author="enis" created="Wed, 17 Apr 2013 22:34:03 +0000"  >&lt;p&gt;Yes, this can go into 0.94 once finished. No fundamental changes to the core path.  &lt;/p&gt;</comment>
                            <comment id="13634972" author="mbertozzi" created="Thu, 18 Apr 2013 08:06:14 +0000"  >&lt;p&gt;in general I&apos;m against having another way to direct access the data, since it means that you&apos;re giving up on optimizing the main one.&lt;/p&gt;

&lt;p&gt;but if the final implementation will be like this one using the HRegion object, I&apos;ll be +1.&lt;/p&gt;</comment>
                            <comment id="13635167" author="jmspaggi" created="Thu, 18 Apr 2013 13:49:43 +0000"  >&lt;p&gt;I very like the idea.&lt;/p&gt;

&lt;p&gt;Are the initCredentials modifications in TableMapReduceUtil required for the scope of this patch? Or they are coming from another scope?&lt;/p&gt;</comment>
                            <comment id="13635428" author="enis" created="Thu, 18 Apr 2013 17:55:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;in general I&apos;m against having another way to direct access the data, since it means that you&apos;re giving up on optimizing the main one.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Conceptually, this is similar to the short circuit reads for HDFS. I agree that we should not need these kinds of optimizations, since in the long term, it will be impossible to implement QoS for IO if you give direct access to local files (for SSR) / hdfs files (for snapshot). &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;if the final implementation will be like this one using the HRegion object, I&apos;ll be +1.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, that is the plan.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Are the initCredentials modifications in TableMapReduceUtil required for the scope of this patch?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, we do not need to initCredentials, since we are not talking to any hbase server. &lt;/p&gt;</comment>
                            <comment id="13635453" author="ghelmling" created="Thu, 18 Apr 2013 18:05:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;Yes, we do not need to initCredentials, since we are not talking to any hbase server.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So would this completely bypass security?  I also want this functionality for certain use cases, we should just be clear on this caveat.&lt;/p&gt;</comment>
                            <comment id="13635708" author="enis" created="Thu, 18 Apr 2013 21:19:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;So would this completely bypass security?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Underlying hFiles are owned by the hbase user. For reading the files from MR files, a couple of options comes to my mind:&lt;br/&gt;
(1) open the files directly from hdfs, in which case, the user has to be in the same group and have group permissions to read the files, or the user has to be the hbase user. Similar to current SSR.&lt;br/&gt;
(2) have HBase servers open the file, and pass the file handlers to the MR job, similar to the approach in &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-347&quot; title=&quot;DFS read performance suboptimal when client co-located on nodes with data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-347&quot;&gt;&lt;del&gt;HDFS-347&lt;/del&gt;&lt;/a&gt;. This is obviously more involved and require a live HBase cluster.&lt;br/&gt;
(3) Copy snapshot files as different user. This will only be applicable to exported snapshots. Copying data for in-place snapshots would be costly.&lt;br/&gt;
any other ideas?&lt;/p&gt;</comment>
                            <comment id="13635739" author="ghelmling" created="Thu, 18 Apr 2013 21:53:34 +0000"  >&lt;p&gt;For the short term, #1 (reading user has to be in the same group), seems fine as a restriction.  In fact, given that the whole point is to read directly from HDFS, I don&apos;t see any other straightforward solution than relying on what controls HDFS gives us.  In that vein, I&apos;m really not in favor of #2.  I just wanted to be clear on the restrictions.&lt;/p&gt;

&lt;p&gt;I don&apos;t see #3 as really adding anything that couldn&apos;t be coordinated through group perms and membership anyway.&lt;/p&gt;

&lt;p&gt;If HDFS ever implemented full ACLs for files, then I guess we could maintain separate ACLs for snapshot files, allowing read access by designated users.&lt;/p&gt;</comment>
                            <comment id="13635790" author="enis" created="Thu, 18 Apr 2013 22:57:05 +0000"  >&lt;p&gt;Agreed that we need proper ACL&apos;s from HDFS to correctly manage this, but I am not holding my breath on it. Let&apos;s go with (1) for now to see the actual usage of this feature. We can improve later. &lt;/p&gt;</comment>
                            <comment id="13635797" author="ghelmling" created="Thu, 18 Apr 2013 23:03:41 +0000"  >&lt;p&gt;Yes, agree (1) is the right approach for now.  If new capabilities in HDFS show up, then we can reassess.&lt;/p&gt;</comment>
                            <comment id="13635880" author="ndimiduk" created="Fri, 19 Apr 2013 00:13:13 +0000"  >&lt;p&gt;(1) seems like the best approach to me as well. We already ask the user to struggle with permissions issues between creation of and loading of HFiles for bulk loading. This is simplest to implement and consistent with existing tools.&lt;/p&gt;</comment>
                            <comment id="13636931" author="yuzhihong@gmail.com" created="Fri, 19 Apr 2013 22:09:37 +0000"  >&lt;p&gt;Quickly went through the code.&lt;br/&gt;
Will revisit when TODO&apos;s are addressed in next patch.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void close() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.scanner != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.scanner.close();
+      }
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (region != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+        region.closeRegionOperation();
+        region.close(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think region.closeRegionOperation() should be placed inside finally block because this.scanner.close() may throw IOException.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * @param rootDir Root directory &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; HBase instance
+   * @param conf
...
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; HRegion createHRegion(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HRegionInfo info, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path rootDir, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path tableDir,
+                                      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Configuration conf,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Param tableDir missing in javadoc.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void restoreWALs() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void restoreWALs() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I don&apos;t see the above method referenced in the patch. Why making it public ?&lt;/p&gt;</comment>
                            <comment id="13640583" author="ndimiduk" created="Wed, 24 Apr 2013 16:06:30 +0000"  >&lt;p&gt;I like this looks of this patch, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;. I noticed this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+    Path tableDir = new Path(new Path(&quot;/users/enis&quot;), UUID.randomUUID().toString()); //TODO change this, delete afterwards
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In mind of establishing the working directory, MR jobs working with HFiles should have something similar. Ie, the partitions file used by &lt;tt&gt;HFileOutputFormat&lt;/tt&gt; really shouldn&apos;t assume tmp (see this &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4285?focusedCommentId=13620294&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13620294&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;comment&lt;/a&gt;), and I&apos;ll need a working directory to implement &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8073&quot; title=&quot;HFileOutputFormat support for offline operation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8073&quot;&gt;HBASE-8073&lt;/a&gt;. It would be nice to consolidate this concept into a single user-configured place. Separate JIRA?&lt;/p&gt;</comment>
                            <comment id="13646189" author="sershe" created="Wed, 1 May 2013 00:10:22 +0000"  >&lt;p&gt;Skimmed the patch... should it be reviewed now or is just an example? &lt;/p&gt;</comment>
                            <comment id="13646295" author="enis" created="Wed, 1 May 2013 01:55:07 +0000"  >&lt;p&gt;Thanks for looking. This will correspond to the skeleton of the final patch. I want to add more testing and address the TODO&apos;s in the patch. But reviews are always welcome in any phase. &lt;/p&gt;</comment>
                            <comment id="13697189" author="bryanck" created="Mon, 1 Jul 2013 21:16:36 +0000"  >&lt;p&gt;Snapshot MR scan functionality for 0.94&lt;/p&gt;</comment>
                            <comment id="13697205" author="bryanck" created="Mon, 1 Jul 2013 21:24:40 +0000"  >&lt;p&gt;This patch is based on Enis&apos;s patch and backported to 0.94. I added a couple of things, like factoring in data locality when assigning splits, and making the temp directory a parameter. The big downside so far to these patches is that the map-reduce job needs to be run by a user that has write access to files in the HBase data directory.&lt;/p&gt;</comment>
                            <comment id="13697214" author="hadoopqa" created="Mon, 1 Jul 2013 21:32:49 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12590305/HBASE-8369-0.94.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12590305/HBASE-8369-0.94.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6177//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6177//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13697229" author="bryanck" created="Mon, 1 Jul 2013 21:43:57 +0000"  >&lt;p&gt;Sorry about that, my patch only works with 0.94, not trunk. I&apos;m not sure how that works. Maybe I need to create a different issue?&lt;/p&gt;</comment>
                            <comment id="13697261" author="enis" created="Mon, 1 Jul 2013 22:16:47 +0000"  >&lt;p&gt;No worries. The pre-commit builds only work with trunk patches right now. We did not set it up for older branches.&lt;/p&gt;</comment>
                            <comment id="13697288" author="bryanck" created="Mon, 1 Jul 2013 22:45:42 +0000"  >&lt;p&gt;The unit tests were broken in my first patch, this should fix it.&lt;/p&gt;</comment>
                            <comment id="13697291" author="hadoopqa" created="Mon, 1 Jul 2013 22:52:43 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12590321/HBASE-8369-0.94_v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12590321/HBASE-8369-0.94_v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 5 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6180//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6180//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13697301" author="bryanck" created="Mon, 1 Jul 2013 23:06:09 +0000"  >&lt;p&gt;Test improvement&lt;/p&gt;</comment>
                            <comment id="13697305" author="stack" created="Mon, 1 Jul 2013 23:08:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bryanck&quot; class=&quot;user-hover&quot; rel=&quot;bryanck&quot;&gt;Bryan Keller&lt;/a&gt; Any chance of your making this work on trunk?  Thanks sir.&lt;/p&gt;</comment>
                            <comment id="13697308" author="bryanck" created="Mon, 1 Jul 2013 23:11:42 +0000"  >&lt;p&gt;Sure, should only take a minute.&lt;/p&gt;</comment>
                            <comment id="13697312" author="hadoopqa" created="Mon, 1 Jul 2013 23:12:44 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12590324/HBASE-8369-0.94_v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12590324/HBASE-8369-0.94_v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6181//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6181//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13697348" author="bryanck" created="Tue, 2 Jul 2013 00:03:32 +0000"  >&lt;p&gt;Patch for trunk&lt;/p&gt;</comment>
                            <comment id="13697355" author="yuzhihong@gmail.com" created="Tue, 2 Jul 2013 00:17:18 +0000"  >&lt;p&gt;w.r.t. latest trunk patch:&lt;/p&gt;

&lt;p&gt;There are 3 TODO&apos;s.&lt;br/&gt;
Indentation is off: two spaces for tab.&lt;br/&gt;
The first item in comment below wasn&apos;t addressed:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8369?focusedCommentId=13636931&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13636931&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-8369?focusedCommentId=13636931&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13636931&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please put the next patch on review board.&lt;/p&gt;

&lt;p&gt;Thanks Bryan.&lt;/p&gt;</comment>
                            <comment id="13697367" author="bryanck" created="Tue, 2 Jul 2013 00:37:26 +0000"  >&lt;p&gt;There is no straightforward solution regarding the file permissions TODO, as far as I know. The file link creation seems to increment a reference counter on the source file, thus you need write permission on the hbase data files. I tried scanning the snapshot without creating a temp table directory but was unsuccessful. If that worked, no file links would need to be created and in theory no write access would be required.&lt;/p&gt;</comment>
                            <comment id="13697433" author="hadoopqa" created="Tue, 2 Jul 2013 02:36:58 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12590328/HBASE-8369-trunk_v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12590328/HBASE-8369-trunk_v1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 1 release audit warnings (more than the trunk&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6183//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13697438" author="yuzhihong@gmail.com" created="Tue, 2 Jul 2013 02:48:08 +0000"  >&lt;p&gt;TestSnapshotInputFormatScan.java needs license header.&lt;/p&gt;</comment>
                            <comment id="13697515" author="stack" created="Tue, 2 Jul 2013 05:21:30 +0000"  >&lt;p&gt;Nice patch Bryan.&lt;/p&gt;

&lt;p&gt;Yeah, license missing.  The test is copied from elsewhere?  It works.  Its good.&lt;/p&gt;

&lt;p&gt;Camelcase is a little unorthodox for hadoop configs. &quot;hbase.SnapshotInputFormat.snapshot.name&quot;  We can change on commit.&lt;/p&gt;

&lt;p&gt;This is probably not needed &quot;...implements Writable&quot;... (just say no to Writables) Maybe Enis can fix that on next version.&lt;/p&gt;

&lt;p&gt;Yeah, would be grand to do away w/ Writables.&lt;/p&gt;

&lt;p&gt;This patch is great.  Nice &apos;trick&apos;.&lt;/p&gt;

</comment>
                            <comment id="13697524" author="bryanck" created="Tue, 2 Jul 2013 05:36:33 +0000"  >&lt;p&gt;The test is copied from TestTableInputFormatScanBase. I will upload a new patch tomorrow that fixes some of the issues mentioned.&lt;/p&gt;</comment>
                            <comment id="13697906" author="bryanck" created="Tue, 2 Jul 2013 15:54:36 +0000"  >&lt;p&gt;Applied feedback&lt;/p&gt;</comment>
                            <comment id="13697907" author="bryanck" created="Tue, 2 Jul 2013 15:54:49 +0000"  >&lt;p&gt;Applied feedback&lt;/p&gt;</comment>
                            <comment id="13697994" author="hadoopqa" created="Tue, 2 Jul 2013 17:13:29 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12590450/HBASE-8369-trunk_v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12590450/HBASE-8369-trunk_v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6189//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13699364" author="bryanck" created="Wed, 3 Jul 2013 19:49:47 +0000"  >&lt;p&gt;New patch only uses top node when assigning splits for better locality&lt;/p&gt;</comment>
                            <comment id="13699435" author="hadoopqa" created="Wed, 3 Jul 2013 21:02:38 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12590700/HBASE-8369-trunk_v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12590700/HBASE-8369-trunk_v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 2 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6209//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13699664" author="enis" created="Thu, 4 Jul 2013 01:02:35 +0000"  >&lt;p&gt;Bryan thanks for working on the patch. A couple of comments: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I see you renamed TableSnapshotIF to SnapshotIF. I would prefer TableSnapshot, since it is explicit that this is a snapshot of a table (although we only have table snapshots currently)&lt;/li&gt;
	&lt;li&gt;What happened to the tests in TestTableSnapshotInputFormat? I see you have some unit tests, but I failed to see any verification there.&lt;/li&gt;
	&lt;li&gt;In 0.94 writables are fine, but for trunk we would need to use PB for encoding the data for the wire. My first patch contains PB classes for SnapshotRegionSplits.&lt;/li&gt;
	&lt;li&gt;There were still TODO&apos;s to be addressed, especially on the testing side.&lt;br/&gt;
Do you want to continue working on this? I can help with the testing and PB stuff next week. &lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13699816" author="bryanck" created="Thu, 4 Jul 2013 07:24:54 +0000"  >&lt;p&gt;My main goal was to back port it to 0.94, but then I migrated that 0.94 patch to trunk as requested, which is how I ended up with my trunk patch. Most TODOs should be addressed except for how to deal with file permissions. I also added data locality to split assignment. The tests are new and based on the TableInputFormat tests, which seemed a logical set of tests to mimic. The PB stuff would be better left to you I imagine, as are any additional tests you feel are required. I prefer the name SnapshotInputFormat, for brevity and to differentiate from TableInputFormat, but that&apos;s a personal preference.&lt;/p&gt;</comment>
                            <comment id="13702433" author="enis" created="Mon, 8 Jul 2013 21:15:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;The tests are new and based on the TableInputFormat tests, which seemed a logical set of tests to mimic&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sounds good. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Most TODOs should be addressed except for how to deal with file permissions.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ok, let me work on that this week. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The PB stuff would be better left to you I imagine, as are any additional tests you feel are required&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sounds good.&lt;/p&gt;</comment>
                            <comment id="13725620" author="mbertozzi" created="Wed, 31 Jul 2013 19:25:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; any update on this? or the latest patch is still trunk-v3, 94-v5&lt;/p&gt;</comment>
                            <comment id="13725730" author="enis" created="Wed, 31 Jul 2013 21:20:12 +0000"  >&lt;p&gt;Sorry, no update just yet. My focus was on elsewhere. I have to merge the two patches, since Bryan&apos;s patch does not include all the parts from my patch. I also have to add some more tests to this. &lt;/p&gt;

&lt;p&gt;I don&apos;t think this is a requirement for 0.96.0 though. We can get this in later releases of 0.96.x. &lt;/p&gt;</comment>
                            <comment id="13725763" author="lhofhansl" created="Wed, 31 Jul 2013 22:02:15 +0000"  >&lt;p&gt;We&apos;re very interested in this (in the medium term), I&apos;ll see if we have cycles to work on this.&lt;/p&gt;</comment>
                            <comment id="13725769" author="bryanck" created="Wed, 31 Jul 2013 22:10:07 +0000"  >&lt;p&gt;FWIW, I am using this (slightly tweaked) in our production system now, and it has been a huge improvement to scan performance, up to 2.5x. The bottleneck is now in HRegion rather than region server. Setting up permissions in HDFS to allow these scans is the tricky part.&lt;/p&gt;</comment>
                            <comment id="13757366" author="enis" created="Wed, 4 Sep 2013 01:37:05 +0000"  >&lt;p&gt;Ok, finally, I have uploaded the first candidate patch for this issue. I have tested this with a real cluster of 10 nodes, and it seems ok. Have not done any performance testing yet.  &lt;/p&gt;

&lt;p&gt;Let&apos;s get this to trunk first, then we can think about 0.96.1 and 0.94.x. &lt;/p&gt;

&lt;p&gt;Reviews welcome: &lt;a href=&quot;https://reviews.apache.org/r/13958/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/13958/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13757927" author="yuzhihong@gmail.com" created="Wed, 4 Sep 2013 16:30:32 +0000"  >&lt;p&gt;Can you attach the patch for QA run ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13805748" author="enis" created="Fri, 25 Oct 2013 22:02:46 +0000"  >&lt;p&gt;Uploaded the slides about this issue here: &lt;a href=&quot;http://www.slideshare.net/enissoz/mapreduce-over-snapshots&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.slideshare.net/enissoz/mapreduce-over-snapshots&lt;/a&gt;. It also contains some numbers for performaance comparison. &lt;br/&gt;
Here are the raw numbers (in MB/s)&lt;/p&gt;

&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Data size&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;	6.6 G&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;	13.2G&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;	19.8 G&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;	26.4 G&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;StoreFileCount per region&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;	3&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;	6&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;	9&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;	12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Scan(MB/s)	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;8.2	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;7.6	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;11.2	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;7.2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;SnapshotScan(MB/s)	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;60.8	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;59.5	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;55.3	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;46.7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;ScanMR(MB/s)	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;75.9	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;80.4	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;82.3	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;140.7&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;SnapshotScanMR(MB/s)	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;198.6	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;275.6	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;311.6	&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;329.4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;Main takeaway, seems to be the single scanner speeds improve 5-6x, from 11MB/s to 55MB/s. That is also half of raw disk speed (for a single disk). Do not read much into MR test speed improvements when store file increases. That is due to job launch costs taking relatively smaller percentage when data sizes increase. &lt;/p&gt;</comment>
                            <comment id="13805986" author="lhofhansl" created="Sat, 26 Oct 2013 03:50:54 +0000"  >&lt;p&gt;I want that in 0.94. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13808667" author="enis" created="Wed, 30 Oct 2013 01:53:30 +0000"  >&lt;p&gt;latest patch from RB.&lt;/p&gt;</comment>
                            <comment id="13808681" author="hadoopqa" created="Wed, 30 Oct 2013 02:26:16 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12610963/hbase-8369_v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12610963/hbase-8369_v5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 16 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7673//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7673//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13809617" author="enis" created="Wed, 30 Oct 2013 20:59:57 +0000"  >&lt;p&gt;Rebased patch&lt;/p&gt;</comment>
                            <comment id="13809624" author="hadoopqa" created="Wed, 30 Oct 2013 21:04:28 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12611171/hbase-8369_v6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12611171/hbase-8369_v6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 16 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 hadoop1.0&lt;/font&gt;.  The patch failed to compile against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7680//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7680//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13809829" author="lhofhansl" created="Thu, 31 Oct 2013 01:26:11 +0000"  >&lt;p&gt;If you make a 0.94 patch I&apos;ll offer to try on a real cluster &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13811706" author="apurtell" created="Fri, 1 Nov 2013 22:10:25 +0000"  >&lt;p&gt;This is a fine feature for performance but needs a fat release note indicating it is incompatible with security features we have now and planned. &lt;/p&gt;

&lt;p&gt;ACLs: Since the AccessController is bypassed, only file level permissions can provide protection. Perhaps someday if HDFS has file ACLs we can push CF ACLs down, that would be a useful improvement and maybe the best we can do here. &lt;/p&gt;

&lt;p&gt;Cell ACLs and visibility labels: The code that does access or visibility checking lives in the regionserver and cannot be trusted to filter cell if running in a mapreduce task with untrustable user code. &lt;/p&gt;

&lt;p&gt;Encryption: Unless the reader has access to the cluster master key the files won&apos;t be readable. That&apos;s the desired outcome. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Shipping the master key to a MR job where untrustable user code can steal it would not be advisable. &lt;/p&gt;</comment>
                            <comment id="13813555" author="enis" created="Tue, 5 Nov 2013 02:02:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;If you make a 0.94 patch I&apos;ll offer to try on a real cluster&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Will do a backport soon.  Thanks for the offer. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.purtell%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;andrew.purtell@gmail.com&quot;&gt;Andrew Purtell&lt;/a&gt; Let me write up something. Please feel free to add / edit. &lt;/p&gt;</comment>
                            <comment id="13813591" author="enis" created="Tue, 5 Nov 2013 03:13:37 +0000"  >&lt;p&gt;Patch from RB. &lt;/p&gt;</comment>
                            <comment id="13813808" author="hadoopqa" created="Tue, 5 Nov 2013 09:40:33 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12612097/hbase-8369_v7.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12612097/hbase-8369_v7.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 16 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 1 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 7 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): 	at org.apache.hadoop.hbase.TestZooKeeper.testRegionAssignmentAfterMasterRecoveryDueToZKExpiry(TestZooKeeper.java:486)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7735//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13820855" author="enis" created="Wed, 13 Nov 2013 02:42:03 +0000"  >&lt;p&gt;Patch from RB. &lt;/p&gt;</comment>
                            <comment id="13820927" author="hadoopqa" created="Wed, 13 Nov 2013 04:30:51 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12613507/hbase-8369_v8.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12613507/hbase-8369_v8.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 16 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 hadoop1.0&lt;/font&gt;.  The patch failed to compile against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7830//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7830//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13821927" author="enis" created="Wed, 13 Nov 2013 22:35:12 +0000"  >&lt;p&gt;Update patch from RB. &lt;/p&gt;</comment>
                            <comment id="13822149" author="hadoopqa" created="Thu, 14 Nov 2013 04:13:51 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12613728/hbase-8369_v9.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12613728/hbase-8369_v9.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 16 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 3 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7851//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13822171" author="devaraj" created="Thu, 14 Nov 2013 05:15:03 +0000"  >&lt;p&gt;LGTM. The javadoc warnings from hadoopqa are valid though. They should be fixed.&lt;/p&gt;</comment>
                            <comment id="13825850" author="enis" created="Mon, 18 Nov 2013 22:20:38 +0000"  >&lt;p&gt;I&apos;ve finally committed this to trunk. Thanks everyone for reviews and discussions. &lt;/p&gt;

&lt;p&gt;Unfortunately, I did not have any time for 0.94 backport. Not sure about 0.96 branch as well. If we are doing 0.94 backport, it seems that we should have it in 0.96 as well. &lt;/p&gt;</comment>
                            <comment id="13826183" author="hudson" created="Tue, 19 Nov 2013 04:18:36 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #843 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/843/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/843/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8369&quot; title=&quot;MapReduce over snapshot files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8369&quot;&gt;&lt;del&gt;HBASE-8369&lt;/del&gt;&lt;/a&gt; MapReduce over snapshot files (enis: rev 1543195)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/client/AbstractClientScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/client/ClientScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/CellUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/test/java/org/apache/hadoop/hbase/TestCellUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-it/src/test/java/org/apache/hadoop/hbase/mapreduce/IntegrationTestTableSnapshotInputFormat.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/MapReduceProtos.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-protocol/src/main/protobuf/MapReduce.proto&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/HDFSBlocksDistribution.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/client/ClientSideRegionScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/client/TableSnapshotScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableMapReduceUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableSnapshotInputFormat.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/util/AbstractHBaseTool.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/ScanPerformanceEvaluation.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestTableSnapshotScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestTableSnapshotInputFormat.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestRegionPlacement.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13826190" author="enis" created="Tue, 19 Nov 2013 04:33:50 +0000"  >&lt;p&gt;Forgot to attach the latest committed version from RB. The only difference is fixed javadoc between v10 from RB and v11. &lt;/p&gt;</comment>
                            <comment id="13826323" author="hudson" created="Tue, 19 Nov 2013 08:58:59 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #4687 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4687/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4687/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8369&quot; title=&quot;MapReduce over snapshot files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8369&quot;&gt;&lt;del&gt;HBASE-8369&lt;/del&gt;&lt;/a&gt; MapReduce over snapshot files (enis: rev 1543195)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/client/AbstractClientScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/client/ClientScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/CellUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/test/java/org/apache/hadoop/hbase/TestCellUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-it/src/test/java/org/apache/hadoop/hbase/mapreduce/IntegrationTestTableSnapshotInputFormat.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/MapReduceProtos.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-protocol/src/main/protobuf/MapReduce.proto&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/HDFSBlocksDistribution.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/client/ClientSideRegionScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/client/TableSnapshotScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableMapReduceUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableSnapshotInputFormat.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/util/AbstractHBaseTool.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/util/ModifyRegionUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/ScanPerformanceEvaluation.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestTableSnapshotScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestTableSnapshotInputFormat.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestRegionPlacement.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13846804" author="lhofhansl" created="Thu, 12 Dec 2013 22:06:26 +0000"  >&lt;p&gt;I filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10076&quot; title=&quot;Backport MapReduce over snapshot files [0.94]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10076&quot;&gt;&lt;del&gt;HBASE-10076&lt;/del&gt;&lt;/a&gt; for the 0.94 backport. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;, how about 0.96? (mostly new code and incredibly helpful in some cases)&lt;/p&gt;</comment>
                            <comment id="13846826" author="stack" created="Thu, 12 Dec 2013 22:23:53 +0000"  >&lt;p&gt;You know my story on &apos;features&apos; in 0.96 boss.&lt;/p&gt;</comment>
                            <comment id="13846846" author="lhofhansl" created="Thu, 12 Dec 2013 22:42:43 +0000"  >&lt;p&gt;You OK with this in 0.94, but not in 0.96?&lt;br/&gt;
For Salesforce this would be very useful in 0.94, since a lot of our backup logic is implemented as M/R.&lt;/p&gt;</comment>
                            <comment id="13846851" author="enis" created="Thu, 12 Dec 2013 22:45:00 +0000"  >&lt;p&gt;It will be super confusing for users if it comes in 0.94, but not in 0.96. Either 0.94 version should come with a very visible warning that this feature won&apos;t be available in 0.96, or it should not come at all. &lt;/p&gt;</comment>
                            <comment id="13846864" author="bryanck" created="Thu, 12 Dec 2013 22:59:42 +0000"  >&lt;p&gt;FWIW, you can use the 0.94 patch I submitted without modifying the 0.94 release if a couple of minor changes are implemented (mostly naming). I have been using it in production for a while now with 0.94. Perhaps it could be tweaked and offered separately in a &quot;contrib&quot; directory or something in 0.94, along with the caveat about file permissions.&lt;/p&gt;</comment>
                            <comment id="13846883" author="lhofhansl" created="Thu, 12 Dec 2013 23:11:57 +0000"  >&lt;p&gt;We have a backport patch already in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10076&quot; title=&quot;Backport MapReduce over snapshot files [0.94]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10076&quot;&gt;&lt;del&gt;HBASE-10076&lt;/del&gt;&lt;/a&gt;. We can always just maintain it locally in our own repo.&lt;/p&gt;

&lt;p&gt;This is very low risk change, though... Almost no existing classes changed. And would be a good story for HBase&apos;s bad scan performance (even with M/R). What do you say &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13846909" author="enis" created="Thu, 12 Dec 2013 23:29:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;We can always just maintain it locally in our own repo.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;BTW, I am not against to commit this to 0.94, although 0.96 may or may not have it. Just that we should be very explicit about it (with javadoc, or maybe @deprecated notification?) &lt;/p&gt;</comment>
                            <comment id="13846918" author="jesse_yates" created="Thu, 12 Dec 2013 23:40:14 +0000"  >&lt;p&gt;It would be also be odd to have it deprecated in 0.94, gone in 0.96 and then back again in 0.98 - makes users wonder about what happened in the middle there (since they probably won&apos;t read this jira to get context). &lt;/p&gt;

&lt;p&gt;Guess if we are explicit in the javadocs then it would be alright, just funky&lt;/p&gt;</comment>
                            <comment id="13846957" author="apurtell" created="Fri, 13 Dec 2013 00:15:50 +0000"  >&lt;p&gt;No, I think the incongruity of having something in 0.94, missing in 0.96, and again in 0.98 is bad practice. If we are blocked getting it in to 0.96, then it has to start &amp;gt; 0.96. &lt;/p&gt;</comment>
                            <comment id="13846958" author="stack" created="Fri, 13 Dec 2013 00:16:03 +0000"  >&lt;p&gt;I want to hold to no new features post release of a branch unless extraordinary circumstances.  This one is very nice but doesn&apos;t seem to qualify as &apos;extraordinary&apos; given anyone who wants to do this in 0.96 can just take the two mapreduce classes and include them in their mapreduce job &amp;#8211; or go get the 0.98 jar (won&apos;t that work?).&lt;/p&gt;</comment>
                            <comment id="13846963" author="eclark" created="Fri, 13 Dec 2013 00:20:49 +0000"  >&lt;p&gt;I&apos;m -0.5 on getting this into older releases.  To me it seems like the community drew a line in the sand on what features made it into 0.96.  We held that line for some things (security, etc).  So it seems weird that we would pull this into older releases without extraordinary circumstances, and we were strict other places.&lt;/p&gt;

&lt;p&gt;We&apos;ve started faster release trains and 0.98 is on the way.  I would vote for holding a very strict no new features into old releases now that we have addressed concerns over release timings.&lt;/p&gt;</comment>
                            <comment id="13846968" author="lhofhansl" created="Fri, 13 Dec 2013 00:29:21 +0000"  >&lt;p&gt;We will use this in our setup, which is based on 0.94. Like us some folks are stuck at a certain release of HBase, which does not mean they are not interested in new features.&lt;/p&gt;

&lt;p&gt;We are going to have to start to go down the Facebook path of forking HBase for things like this then and our contribution will become less useful over time. So be it.&lt;/p&gt;</comment>
                            <comment id="13846976" author="lhofhansl" created="Fri, 13 Dec 2013 00:40:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;anyone who wants to do this in 0.96 can just take the two mapreduce classes and include them in their mapreduce job&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That could work as long as we put the necessary hooks into HBase itself - the small changes to the existing classes. Like an appropriate HRegion constructor, etc.&lt;/p&gt;</comment>
                            <comment id="13846979" author="stack" created="Fri, 13 Dec 2013 00:42:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;We are going to have to start to go down the Facebook path of forking HBase for things like this then and our contribution will become less useful over time.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why not add in the changes to core you need to support this feature into 0.94?&lt;/p&gt;

&lt;p&gt;Lets not break up over whether a couple of mapreduce classes are in core or not.&lt;/p&gt;</comment>
                            <comment id="13846981" author="apurtell" created="Fri, 13 Dec 2013 00:42:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;Like an appropriate HRegion constructor, etc.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Something like that could go into 0.96 surely. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; ?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We are going to have to start to go down the Facebook path of forking HBase for things like this then and our contribution will become less useful over time. So be it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;To put this politely (I have strong opinions) the FB fork was a matter of a tight internal deployment schedule as opposed to any unwillingness of the community to work with their contributions. &lt;/p&gt;

&lt;p&gt;The addition of a couple of extra classes to a private build does not make a fork, just like the enhancements to reduce byte copies for &quot;smart clients&quot; that Jesse was working that went mainly into Phoenix didn&apos;t produce a fork. If and when the time comes that truly an incompatible change must be introduced that constitutes a real break, we should definitely look hard at that.&lt;/p&gt;</comment>
                            <comment id="13847004" author="lhofhansl" created="Fri, 13 Dec 2013 01:01:25 +0000"  >&lt;p&gt;The only changes to existing HBase classes are exactly these hooks, though. Without them it cannot be done with outside code. When those are in place anyway, might as well add some new classes for M/R stuff; but it&apos;s fine to keep these outside, they just become part of the M/R job then.&lt;/p&gt;

&lt;p&gt;To explain my comment above:&lt;br/&gt;
Adding a few classes is not a fork of course, but it starts a slippery slope. Once you started it&apos;s easy to pile on top of that. And there are some HBase changes needed, so it is an actual patch we need to maintain.&lt;br/&gt;
We have so far completely avoided that (except for some hopefully temporary security related changes to HDFS), and I have been a strong advocate for that in our organization. We have also always forward ported any changes we made to 0.96+. So it is frustrating having to start this even (or especially) for such a small change.&lt;/p&gt;

&lt;p&gt;So please pardon my frustration.&lt;br/&gt;
I do not understand the reluctance with this, as it is almost no risk and some folks will be using 0.94 for a while.&lt;br/&gt;
Whether it&apos;s a new &quot;feature&quot; or not is not relevant (IMHO). HBase&apos;s slow M/R performance could be considered a bug too, and then this would be bug fix.&lt;/p&gt;

&lt;p&gt;We&apos;re not breaking up over this &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;So it seems a good compromise would be to get the required hooks into HBase...?&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jesse_yates&quot; class=&quot;user-hover&quot; rel=&quot;jesse_yates&quot;&gt;Jesse Yates&lt;/a&gt;, FYI.&lt;/p&gt;</comment>
                            <comment id="13847005" author="stack" created="Fri, 13 Dec 2013 01:05:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;Something like that could go into 0.96 surely. stack ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Could do that (looking at the patch it doesn&apos;t look needed in 0.96).&lt;/p&gt;

&lt;p&gt;No objection from me adding in hooks into 0.94 as long as... you know what I&apos;m going to say.&lt;/p&gt;

&lt;p&gt;I&apos;ll bring flowers next time we meet &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13847940" author="lhofhansl" created="Fri, 13 Dec 2013 21:50:24 +0000"  >&lt;p&gt;I&apos;ll look forward to the flowers &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thinking about this more, it is a good exercise to keep the M/R code out of HBase anyway to then see what we need to add to core HBase in order to allow for that. Hopefully that would enable other M/R usecases without any core patches needed.&lt;/p&gt;

&lt;p&gt;Note, though, that the only risky bits (if any) of this are exactly these hooks. Everything else is just additional classes.&lt;/p&gt;</comment>
                            <comment id="13847951" author="bryanck" created="Fri, 13 Dec 2013 21:58:13 +0000"  >&lt;p&gt;The hooks are not strictly required (e.g. the patch I submitted uses the stock 0.94 distribution without hooks). In case the hooks are deemed &quot;risky&quot;, it should be possible to modify the current patch not to use the hooks.&lt;/p&gt;</comment>
                            <comment id="13847972" author="sershe" created="Fri, 13 Dec 2013 22:12:11 +0000"  >&lt;p&gt;If there are no hooks, would it also work in 96 by adding jars? Perhaps we should put it into release notes.&lt;br/&gt;
Although if it&apos;s so non-intrusive I&apos;d be +1 on putting into both 96 and 94 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13847987" author="jesse_yates" created="Fri, 13 Dec 2013 22:26:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bryanck&quot; class=&quot;user-hover&quot; rel=&quot;bryanck&quot;&gt;Bryan Keller&lt;/a&gt; wouldn&apos;t be against a no-hook version going into 0.94, but its significantly smaller than what Enis originally implemented. Maybe you can shed some light on why you didn&apos;t need to do things like have a custom ClientScanner or copy over the snapshot files into a new directory(1) &lt;/p&gt;

&lt;p&gt;Maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; can mention the logic on why for some of these kinds of things?&lt;/p&gt;

&lt;p&gt;(1) now that I think about it, maybe trying avoid the snapshot being deleted out from under you. I&apos;ll let the authors comment more though &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13848128" author="lhofhansl" created="Sat, 14 Dec 2013 01:17:40 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bryanck&quot; class=&quot;user-hover&quot; rel=&quot;bryanck&quot;&gt;Bryan Keller&lt;/a&gt;. I too am interested why your patch is smaller. You say you run it in production, which is great. I&apos;ll try the patch and see if it works without any additional hooks - that would be awesome.&lt;/p&gt;</comment>
                            <comment id="13848463" author="bryanck" created="Sat, 14 Dec 2013 21:29:14 +0000"  >&lt;p&gt;One reason it is much smaller is I&apos;m not using any of the Protobuf code, which is pretty sizable.&lt;/p&gt;</comment>
                            <comment id="13848467" author="bryanck" created="Sat, 14 Dec 2013 21:34:24 +0000"  >&lt;p&gt;Btw my patch is based off of Enis&apos;s original patch. The functionality should be the same AFAIK, i.e. a new table directory is assembled from the snapshot.&lt;/p&gt;</comment>
                            <comment id="13848478" author="stack" created="Sat, 14 Dec 2013 22:43:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;Thinking about this more, it is a good exercise to keep the M/R code out of HBase anyway...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;d be coolio. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; looked at doing the first step, making a new mr module but apparently a web of circular depdencies (client and server)&lt;/p&gt;</comment>
                            <comment id="13848481" author="enis" created="Sat, 14 Dec 2013 23:28:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;Maybe Enis Soztutar can mention the logic on why for some of these kinds of things?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;These are the list of high level things in the final version(v11) of the patch, which are different from Bryan&apos;s version (trunk-v3)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ClientScanner / AbstractClientScanner / TableRecordReaderImpl changes: the ClientSideRegion scanner keeps track of ScanMetrics, and exports those via MR job counters or Scan.&lt;/li&gt;
	&lt;li&gt;CellUtil changes : these are at a different place in Bryan&apos;s patch.&lt;/li&gt;
	&lt;li&gt;PB of MR data&lt;/li&gt;
	&lt;li&gt;HDFSBlocksDistribution: in v3, we are providing 3 servers with highest locality to the input split. In v11, we are using all the servers with 80% of the locality for the top locality server. This ensures better locality.&lt;/li&gt;
	&lt;li&gt;ClientSideRegionScanner / TableSnapshotScanner: not present in v3. ClientSideRegionScanner is an internal class to do the scanning. Both TableSnapshotScanner and TableSnapshotInputFormat uses it. TableSnapshotScanner is a client API, to scan snapshots without MR.&lt;/li&gt;
	&lt;li&gt;TableMapreduceUtil changes (other than the new method): needed in case security is enabled. We should not talk with the HBase cluster at all.&lt;/li&gt;
	&lt;li&gt;HRegion changes: v3 patch does send the parent dir for the region snapshot by assuming that table dir is the parent dir of the region dir. We do not want to make that assumption in trunk.&lt;/li&gt;
	&lt;li&gt;RestoreSnapshotHelper / ModifyRegionUtils : code organization&lt;/li&gt;
	&lt;li&gt;Other than these, general test, integration test, or performance evaluation tools.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;For 0.94, we can do a less intrusive patch which combines some of the changes above (like RestoreSnapshotHelper changes going into the new classes), and get rid of some of the changes like HRegion changes. &lt;/p&gt;</comment>
                            <comment id="13848504" author="lhofhansl" created="Sun, 15 Dec 2013 02:02:23 +0000"  >&lt;p&gt;These seems inmportant:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;TableMapreduceUtil changes (other than the new method): needed in case security is enabled. We should not talk with the HBase cluster at all.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;HDFSBlocksDistribution: in v3, we are providing 3 servers with highest locality to the input split. In v11, we are using all the servers with 80% of the locality for the top locality server. This ensures better locality.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This seems nice to have: &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;ClientScanner / AbstractClientScanner / TableRecordReaderImpl changes: the ClientSideRegion scanner keeps track of ScanMetrics, and exports those via MR job counters or Scan.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;To track what/how the mappers are doing.&lt;br/&gt;
The rest we can do without in 0.94. Let&apos;s also move the discussion to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10076&quot; title=&quot;Backport MapReduce over snapshot files [0.94]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10076&quot;&gt;&lt;del&gt;HBASE-10076&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14012085" author="dvdreddy" created="Thu, 29 May 2014 05:27:26 +0000"  >&lt;p&gt;In the patch that is merged in the trunk (hbase-8369_v9.patch and also on the head in github), I think there is a very minor bug (or a mistake in my understanding).  In the below function &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void setInput(Job job, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; snapshotName, Path restoreDir) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to restore the snapshot we do this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
restoreDir = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(restoreDir, UUID.randomUUID().toString());

&lt;span class=&quot;code-comment&quot;&gt;// TODO: restore from record readers to parallelize.
&lt;/span&gt;RestoreSnapshotHelper.restoreSnapshotForScanner(conf, fs, rootDir, restoreDir, snapshotName);
conf.set(TABLE_DIR_KEY, restoreDir.toString());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think the restoreDir here will be the root directory of the restored snapshot and hence the conf.set should not set restoreDir as the&lt;br/&gt;
tableDir, rather it should be doing the following &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
conf.set(TABLE_DIR_KEY, FSUtils.getTableDir(rootDir, tableDesc.getTableName()));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can somebody correct me if I am wrong ?&lt;/p&gt;

</comment>
                            <comment id="14012422" author="dvdreddy" created="Thu, 29 May 2014 15:05:12 +0000"  >&lt;p&gt;Sorry forgot to mention the class in the above comment it is &lt;b&gt;TableSnapshotInputFormat&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="14012727" author="enis" created="Thu, 29 May 2014 19:02:12 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think the restoreDir here will be the root directory of the restored snapshot and hence the conf.set should not set restoreDir as the tableDir, rather it should be doing the following&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We are restoring the snapshot to the restoreDir, which would create the sym-link files for the table. We are setting the table dir to the restore directory, so that we can open the table&apos;s regions from the restore directory. We cannot use the root directory since that would mean we are reading from the actual table&apos;s regions rather than snapshot&apos;s regions. &lt;br/&gt;
Did you run into a problem with this patch? Why do you think this is a problem? &lt;/p&gt;</comment>
                            <comment id="14012769" author="dvdreddy" created="Thu, 29 May 2014 19:27:56 +0000"  >&lt;p&gt;Sorry for the confusion, in my comment I meant that &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
conf.set(TABLE_DIR_KEY, FSUtils.getTableDir(restoreDir, tableDesc.getTableName()));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This similar  statement in the 0.94 is  &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Path tableDir = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(restoreDir, htd.getNameAsString());
 conf.set(TABLE_DIR_KEY, tableDir.toString());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;My concern is that instead of setting the TABLE_DIR_KEY to the tableDir under restoreDir, you are directly setting it to restoreDir&lt;br/&gt;
I mean the tableDir will contain the tablesRegions and simlinks for the HFiles, but where as the restoreDir will contain &lt;em&gt;/data/&amp;lt;namespace&amp;gt;/tableName/&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;As far as my understanding, setting this parameter wrong may not cause any real problems but the weight calculation of HDFS blocks&lt;br/&gt;
will go wrong and thus leading to non local tasks,&lt;/p&gt;

&lt;p&gt;The reason for above is because of the following lines in the record reader&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      Path tmpRootDir = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(conf.get(TABLE_DIR_KEY)); &lt;span class=&quot;code-comment&quot;&gt;// This is the user specified root
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// directory where snapshot was restored&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;so while creating record reader we are using this in the right way i.e as root directory&lt;/p&gt;

&lt;p&gt;But while using for the calculation of weights in the getInputSplits&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    Path tableDir = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(conf.get(TABLE_DIR_KEY));

    List&amp;lt;InputSplit&amp;gt; splits = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;InputSplit&amp;gt;();
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (SnapshotRegionManifest regionManifest : regionManifests) {
      &lt;span class=&quot;code-comment&quot;&gt;// load region descriptor
&lt;/span&gt;      HRegionInfo hri = HRegionInfo.convert(regionManifest.getRegionInfo());

      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (CellUtil.overlappingKeys(scan.getStartRow(), scan.getStopRow(),
        hri.getStartKey(), hri.getEndKey())) {
        &lt;span class=&quot;code-comment&quot;&gt;// compute HDFS locations from snapshot files (which will get the locations &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// referred hfiles)
&lt;/span&gt;        List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; hosts = getBestLocations(conf,
          HRegion.computeHDFSBlocksDistribution(conf, htd, hri, tableDir));

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;we are sending the rootDir from the &lt;tt&gt;conf.get(TABLE_DIR_KEY)&lt;/tt&gt; as the tableDir in the &lt;tt&gt;HRegion.computeHDFSBlocksDistribution(conf, htd, hri, tableDir)&lt;/tt&gt; This will lead to returning a empty *&lt;b&gt;HDFSBlocksDistribution&lt;/b&gt;*&lt;br/&gt;
class which will lead to scheduling of non local tasks.&lt;/p&gt;

&lt;p&gt;Again there might be some mistake in my understanding, if so please correct me&lt;/p&gt;



</comment>
                            <comment id="14013045" author="enis" created="Thu, 29 May 2014 22:48:59 +0000"  >&lt;p&gt;It seems you are right. I think we changed the purpose of TABLE_DIR_KEY some time ago in one of the patch iterations. I think we should still pass the root dir for restore, but send the actual table dir to computeHDFSBlocksDistribution. Can you please open a new issue. You can also attach a patch if you don&apos;t mind working on it. Thanks. &lt;/p&gt;</comment>
                            <comment id="14013089" author="dvdreddy" created="Thu, 29 May 2014 23:16:14 +0000"  >&lt;p&gt;will create a jira and upload a patch&lt;/p&gt;</comment>
                            <comment id="14028466" author="enis" created="Wed, 11 Jun 2014 22:00:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dvdreddy&quot; class=&quot;user-hover&quot; rel=&quot;dvdreddy&quot;&gt;deepankar&lt;/a&gt; did you end up creating an issue? I might have missed it. &lt;/p&gt;</comment>
                            <comment id="14028522" author="dvdreddy" created="Wed, 11 Jun 2014 22:43:30 +0000"  >&lt;p&gt;sorry did not create yet, but I am working on the patch, &lt;br/&gt;
will create the jira with the patches uploaded by end of the day&lt;/p&gt;</comment>
                            <comment id="14028620" author="dvdreddy" created="Thu, 12 Jun 2014 00:04:18 +0000"  >&lt;p&gt;created the jira &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11335&quot; title=&quot;Fix the TABLE_DIR param in TableSnapshotInputFormat&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11335&quot;&gt;&lt;del&gt;HBASE-11335&lt;/del&gt;&lt;/a&gt; and attached the patches&lt;/p&gt;</comment>
                            <comment id="15015822" author="lars_francke" created="Fri, 20 Nov 2015 11:52:45 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12682613">HBASE-10076</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12590305" name="HBASE-8369-0.94.patch" size="23138" author="bryanck" created="Mon, 1 Jul 2013 21:16:36 +0000"/>
                            <attachment id="12590321" name="HBASE-8369-0.94_v2.patch" size="24629" author="bryanck" created="Mon, 1 Jul 2013 22:45:42 +0000"/>
                            <attachment id="12590324" name="HBASE-8369-0.94_v3.patch" size="24666" author="bryanck" created="Mon, 1 Jul 2013 23:06:09 +0000"/>
                            <attachment id="12590449" name="HBASE-8369-0.94_v4.patch" size="24781" author="bryanck" created="Tue, 2 Jul 2013 15:54:36 +0000"/>
                            <attachment id="12590699" name="HBASE-8369-0.94_v5.patch" size="24778" author="bryanck" created="Wed, 3 Jul 2013 19:49:47 +0000"/>
                            <attachment id="12590328" name="HBASE-8369-trunk_v1.patch" size="24663" author="bryanck" created="Tue, 2 Jul 2013 00:03:32 +0000"/>
                            <attachment id="12590450" name="HBASE-8369-trunk_v2.patch" size="24727" author="bryanck" created="Tue, 2 Jul 2013 15:54:49 +0000"/>
                            <attachment id="12590700" name="HBASE-8369-trunk_v3.patch" size="24724" author="bryanck" created="Wed, 3 Jul 2013 19:49:47 +0000"/>
                            <attachment id="12579216" name="hbase-8369_v0.patch" size="75029" author="enis" created="Wed, 17 Apr 2013 22:32:42 +0000"/>
                            <attachment id="12614550" name="hbase-8369_v11.patch" size="155526" author="enis" created="Tue, 19 Nov 2013 04:33:50 +0000"/>
                            <attachment id="12610963" name="hbase-8369_v5.patch" size="163396" author="enis" created="Wed, 30 Oct 2013 01:53:30 +0000"/>
                            <attachment id="12611171" name="hbase-8369_v6.patch" size="151975" author="enis" created="Wed, 30 Oct 2013 20:59:57 +0000"/>
                            <attachment id="12612097" name="hbase-8369_v7.patch" size="154766" author="enis" created="Tue, 5 Nov 2013 03:13:37 +0000"/>
                            <attachment id="12613507" name="hbase-8369_v8.patch" size="154144" author="enis" created="Wed, 13 Nov 2013 02:42:03 +0000"/>
                            <attachment id="12613728" name="hbase-8369_v9.patch" size="154097" author="enis" created="Wed, 13 Nov 2013 22:35:12 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12699659">HBASE-10707</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>15.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 17 Apr 2013 22:31:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323465</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jt3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323810</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Added TableSnapshotInputFormat and TableSnapshotScanner for performing scans over hbase table snapshots from the client side, bypassing the hbase servers. The former configures a mapreduce job, while the latter does single client side scan over snapshot files. Can also be used with offline HBase with in-place or exported snapshot files. &lt;br/&gt;
&lt;br/&gt;
WARNING: This feature bypasses HBase-level security completely since the files are read from the hdfs directly. The user who is running the scan / job has to have read permissions to the data files and snapshot files. &lt;br/&gt;
&lt;br/&gt;
</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>