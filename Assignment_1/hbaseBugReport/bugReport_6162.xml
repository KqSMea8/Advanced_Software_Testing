<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:34:20 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6162/HBASE-6162.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6162] Move KeyValue to hbase-common module</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6162</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;ul&gt;
	&lt;li&gt;pull KeyValue up to hbase-common module&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This is part of the modularization strategy in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5977&quot; title=&quot;Usage of modules &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5977&quot;&gt;&lt;del&gt;HBASE-5977&lt;/del&gt;&lt;/a&gt;, and is specifically necessary to modularize &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4676&quot; title=&quot;Prefix Compression - Trie data block encoding&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4676&quot;&gt;&lt;del&gt;HBASE-4676&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;also brings these classes to hbase-common:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;ClassSize, HeapSize&lt;/li&gt;
	&lt;li&gt;HTestConst&lt;/li&gt;
	&lt;li&gt;TestKeyValue, KeyValueTestUtil&lt;/li&gt;
	&lt;li&gt;LoadTestKVGenerator, TestLoadTestKVGenerator&lt;/li&gt;
	&lt;li&gt;MD5Hash&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;moves a trivial constant (HRegionInfo.DELIMITER) from HRegionInfo to HConstants&lt;/p&gt;</description>
                <environment></environment>
        <key id="12559337">HBASE-6162</key>
            <summary>Move KeyValue to hbase-common module</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mcorgan">Matt Corgan</assignee>
                                    <reporter username="mcorgan">Matt Corgan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jun 2012 08:16:58 +0000</created>
                <updated>Mon, 23 Sep 2013 18:31:08 +0000</updated>
                            <resolved>Thu, 14 Jun 2012 19:33:27 +0000</resolved>
                                    <version>0.95.2</version>
                                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13289237" author="mcorgan" created="Tue, 5 Jun 2012 08:20:03 +0000"  >&lt;p&gt;Attaching patch matching the description&lt;/p&gt;</comment>
                            <comment id="13289515" author="stack" created="Tue, 5 Jun 2012 16:28:06 +0000"  >&lt;p&gt;Who is &apos;clarence&apos;?&lt;/p&gt;

&lt;p&gt;Seems whack that hbase-commons needs to know about the &apos;REGIONINFO_DELIMITER&apos;... but we can do finer grained cleanup later.&lt;/p&gt;

&lt;p&gt;I won&apos;t bring over TestConst.  These top-level constants only interface I think an ugly anti-pattern.  I&apos;ll take care of making things work w/o bringing over TestConst, no worries.&lt;/p&gt;

&lt;p&gt;Otherwise, looks good.  Lets see how hadoopqa does.&lt;/p&gt;

&lt;p&gt;Good on you Matt&lt;/p&gt;
</comment>
                            <comment id="13289526" author="mcorgan" created="Tue, 5 Jun 2012 16:48:59 +0000"  >&lt;p&gt;haha - he is the late Clarence Clemons from the E-street Band.  He actually passed away after i named my computer after him.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Seems whack that hbase-commons needs to know about the &apos;REGIONINFO_DELIMITER&apos;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This looks related to a bigger problem where META and ROOT tables can&apos;t share the same comparator as normal tables.  Do you know if that is a fixable problem?  It adds some complication for the prefix trie.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I won&apos;t bring over TestConst.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yeah - sorry, doesn&apos;t look like it&apos;s needed anymore.  I forget why I had pulled it up in the first place.  thanks for fixing&lt;/p&gt;</comment>
                            <comment id="13289530" author="stack" created="Tue, 5 Jun 2012 16:53:35 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do you know if that is a fixable problem? It adds some complication for the prefix trie.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah.  Its a PITA.  If &lt;del&gt;ROOT&lt;/del&gt; goes away, that&apos;ll simplify things some.  IIRC, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2600&quot; title=&quot;Change how we do meta tables; from tablename+STARTROW+randomid to instead, tablename+ENDROW+randomid&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2600&quot;&gt;HBASE-2600&lt;/a&gt; would simplify this comparison again though you&apos;d still need a custom compare on .META.&lt;/p&gt;</comment>
                            <comment id="13289716" author="lhofhansl" created="Tue, 5 Jun 2012 21:05:19 +0000"  >&lt;p&gt;Can we remove all the comparators from KeyValue and leave the ROOT/META/REGION ones in the server module?&lt;br/&gt;
Looks like that would be a bigger refactor, but maybe a necessary one...?&lt;/p&gt;</comment>
                            <comment id="13289729" author="stack" created="Tue, 5 Jun 2012 21:17:55 +0000"  >&lt;p&gt;That would make some sense Lars.&lt;/p&gt;</comment>
                            <comment id="13289808" author="mcorgan" created="Tue, 5 Jun 2012 22:44:06 +0000"  >&lt;p&gt;I started going down that path, but i believe it turned out to be an even bigger refactoring than is obvious at first.  I also think it&apos;s ok for the common module to contain code that only the server knows about as long as it is small, unit-testable, and has few dependencies.  This kind of code can be tightly verified with unit tests and actually helps to de-clutter the bigger server module.  I figured these two comparators were just some simple byte operations (no exceptions, threads, IO, reflection, etc), so they are simple enough to be in common.&lt;/p&gt;

&lt;p&gt;Another way to look at it is that the higher up the module tree you go (towards util/common), the more bullet-proof the code needs to be, and I thought these two comparators should be as bullet-proof as can be.  We&apos;d like the server module to be bullet-proof, but it will never be as rock-solid as common.  And by the time you get down to the web or avro modules or other 3rd party contributions things can get pretty hairy.&lt;/p&gt;

&lt;p&gt;It&apos;s a discussion that will keep popping up though.  I&apos;m happy to give it another stab the other way... just wanted to explain some of the thinking.&lt;/p&gt;</comment>
                            <comment id="13290290" author="mcorgan" created="Wed, 6 Jun 2012 17:34:20 +0000"  >&lt;p&gt;Stack - based on your recent maven wrangling, does it look like i did the right thing with TestKeyValue?  I removed the @SmallTests annotation and removed these lines at the bottom:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@org.junit.Rule  	
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; org.apache.hadoop.hbase.ResourceCheckerJUnitRule cu = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.hadoop.hbase.ResourceCheckerJUnitRule();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Just want to make sure the test still gets run by the automated test suite.  I think Jesse did the same thing with TestBytes.&lt;/p&gt;</comment>
                            <comment id="13290305" author="zhihyu@ebaysf.com" created="Wed, 6 Jun 2012 18:05:51 +0000"  >&lt;p&gt;Hadoop QA didn&apos;t run any test.&lt;br/&gt;
See &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2108/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2108/console&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13290525" author="zhihyu@ebaysf.com" created="Wed, 6 Jun 2012 22:29:46 +0000"  >&lt;p&gt;The patch produces a lot of compilation errors:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[ERROR] /home/hduser/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java:[29,30] cannot find symbol
[ERROR] symbol  : class HTestConst
[ERROR] location: &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.apache.hadoop.hbase
[ERROR] 
[ERROR] /home/hduser/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedWriter.java:[121,11] cannot find symbol
[ERROR] symbol  : variable LoadTestKVGenerator
[ERROR] location: class org.apache.hadoop.hbase.util.MultiThreadedWriter
[ERROR] 
[ERROR] /home/hduser/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedWriter.java:[128,58] cannot find symbol
[ERROR] symbol  : class LoadTestKVGenerator
[ERROR] location: class org.apache.hadoop.hbase.util.MultiThreadedWriter.HBaseWriterThread
[ERROR] 
[ERROR] /home/hduser/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedWriter.java:[191,24] cannot find symbol
[ERROR] symbol  : variable LoadTestKVGenerator
[ERROR] location: class org.apache.hadoop.hbase.util.MultiThreadedWriter.HBaseWriterThread
[ERROR] 
[ERROR] /home/hduser/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedReader.java:[226,10] cannot find symbol
[ERROR] symbol  : variable LoadTestKVGenerator
[ERROR] location: class org.apache.hadoop.hbase.util.MultiThreadedReader.HBaseReaderThread
[ERROR] 
[ERROR] /home/hduser/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedReader.java:[282,17] cannot find symbol
[ERROR] symbol  : variable LoadTestKVGenerator
[ERROR] location: class org.apache.hadoop.hbase.util.MultiThreadedReader.HBaseReaderThread
[ERROR] 
[ERROR] /home/hduser/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestColumnRangeFilter.java:[192,24] cannot find symbol
[ERROR] symbol  : variable KeyValueTestUtil
[ERROR] location: class org.apache.hadoop.hbase.filter.TestColumnRangeFilter
[ERROR] 
[ERROR] /home/hduser/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreScanner.java:[80,8] cannot find symbol
[ERROR] symbol  : variable KeyValueTestUtil
[ERROR] location: class org.apache.hadoop.hbase.regionserver.TestStoreScanner
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13290531" author="stack" created="Wed, 6 Jun 2012 22:35:47 +0000"  >&lt;p&gt;Ok.  Lets leave comparators as they are for now.  Can break them out in another jira.&lt;/p&gt;

&lt;p&gt;Locally, tests seem to do the right thing w/ patch applied:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.....
[INFO] --- maven-surefire-plugin:2.12-TRUNK-HBASE-2:test (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-test) @ hbase-common ---
[INFO] Surefire report directory: /Users/stack/checkouts/trunk/hbase-common/target/surefire-reports
[INFO] Using configured provider org.apache.maven.surefire.junitcore.JUnitCoreProvider

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running org.apache.hadoop.hbase.TestKeyValue
Tests run: 14, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.056 sec
Running org.apache.hadoop.hbase.util.TestBytes
Tests run: 13, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.04 sec
Running org.apache.hadoop.hbase.util.TestLoadTestKVGenerator
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.626 sec

Results :

Tests run: 30, Failures: 0, Errors: 0, Skipped: 0

...

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13290556" author="stack" created="Wed, 6 Jun 2012 23:01:10 +0000"  >&lt;p&gt;When hbase-server compiles its tests, it does not include hbase-common jar so the compile fails.  Jesse?&lt;/p&gt;</comment>
                            <comment id="13290682" author="jesse_yates" created="Thu, 7 Jun 2012 01:30:01 +0000"  >&lt;p&gt;@stack - yup, that&apos;s what I was going on about in the comments in the poms. Essentially, it doesn&apos;t build the tests jar for commons until the package phase, which doesn&apos;t get reached if you just do a &quot;test-compile&quot; (or just test). Therefore, you aren&apos;t going to see the classes in hbase-common/src/test in hbase-server. There are three ways around this.&lt;/p&gt;

&lt;p&gt;(1) Move the test classes to needed by other modules to the hbase-common/src/main/java/...&lt;/p&gt;
{package}
&lt;p&gt;/test. Basically, just append test to their package names. This separates out the test oriented class from the regular ones, but still makes it easy to get them when running tests&lt;br/&gt;
(2) Always run tests by doing mvn package. This sucks because you need to do a lot more work for testing.&lt;br/&gt;
(3) Fix that maven issue. A ton of work and then everyone needs to use the patched maven. Probably the worst option.&lt;/p&gt;

&lt;p&gt;I&apos;m in favor of just doing (1). Its pretty simple, doesn&apos;t clutter the code too much, and doesn&apos;t require a ton of work.&lt;/p&gt;</comment>
                            <comment id="13290744" author="mcorgan" created="Thu, 7 Jun 2012 02:57:58 +0000"  >&lt;p&gt;I think we are finally starting to grasp the problem Jesse =).  That does suck.&lt;/p&gt;

&lt;p&gt;Is there an alternative 1b: put the tests in hbase-common/src/main/java/org/apache/hbase/test/&lt;/p&gt;
{package}
&lt;p&gt;?  At hotpads we even put a lot of tests at the bottom of the class they&apos;re testing.  I wouldn&apos;t care between 1a and 1b, but perhaps 1b is more similar to the current system.  For a package like hbase-common where it&apos;s simple unit tests, anything should work ok.&lt;/p&gt;

&lt;p&gt;One problem we&apos;ll run into with option 1a or 1b is that some of the tests actually have a hidden dependency on the package they&apos;re in because they call package-private constructors and methods on classes in their src/main package.  I personally don&apos;t like relying on package-private scope, especially across src folders, so in my opinion option 1 would help us find and eliminate those hidden dependencies.&lt;/p&gt;</comment>
                            <comment id="13290821" author="stack" created="Thu, 7 Jun 2012 06:09:43 +0000"  >&lt;p&gt;Yeah, lets undo these dependencies.  TestConst we agreed shouldn&apos;t be moved.  That&apos;ll take care of a few of these issues.  Why is KeyValueTestUtil going into hbase-common when it seems it only used in hbase-server?&lt;/p&gt;

&lt;p&gt;An hbase-test that had test util under src/main would be OTT?&lt;/p&gt;</comment>
                            <comment id="13290833" author="mcorgan" created="Thu, 7 Jun 2012 06:31:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why is KeyValueTestUtil going into hbase-common&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Just the line of thinking that core, fundamental classes and their tests should sit in hbase-common.  I guess we could wait until things are explicitly needed to pull them up, but the question i was asking myself was &quot;if i&apos;m writing hbase from scratch and sketching out the necessary classes and modules, which module would KeyValueTestUtil go into?&quot;.  KeyValueTestUtil seemed to pass the &quot;fundamental&quot; test.  I suspect we&apos;ll need some other simple classes like this up in hbase-common when we add the other modules, but i guess we can wait until then to move them.&lt;/p&gt;

&lt;p&gt;Thought it might help to move them earlier to simplify hbase-server.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;An hbase-test that had test util under src/main would be OTT?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;doesn&apos;t offend me, although if we&apos;re ok modifying the package names, it might be easier to have less open projects in eclipse (less modules).  either way, we could consider it a temporary solution until maven is fixed.&lt;/p&gt;</comment>
                            <comment id="13291053" author="stack" created="Thu, 7 Jun 2012 14:59:01 +0000"  >&lt;p&gt;@Matt Makes sense.  I&apos;d have seen that if I looked closer.  Maybe can undo the classes in hbase-server depending on this utility.  I hear you on making an hbase-test.&lt;/p&gt;</comment>
                            <comment id="13292445" author="mcorgan" created="Sat, 9 Jun 2012 23:31:59 +0000"  >&lt;p&gt;Attaching v2 patch which moves the test classes into individual .test packages in src/main/java.  Not sure of the best place to put them, but had to choose something.&lt;/p&gt;

&lt;p&gt;running &quot;mvn compile -pl hbase-common -am&quot; now gives the below error though.  Anyone know why it can&apos;t find junit... maybe only the src/test/java folders have the dependency on it?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.0.2:compile (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-compile) on project hbase-common: Compilation failure: Compilation failure:
[ERROR] /home/mcorgan/hadoop/hbase/hbase-common/src/main/java/org/apache/hadoop/hbase/test/TestKeyValue.java:[28,22] &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; junit.framework does not exist&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13294799" author="mcorgan" created="Thu, 14 Jun 2012 04:16:36 +0000"  >&lt;p&gt;Maybe we want to avoid messing with the tests for now.  Here is a v3 patch that does the minimum possible to move KeyValue to hbase-common.  It brings HeapSize and ClassSize with it, and it moves a couple constants around.&lt;/p&gt;

&lt;p&gt;After this jira I&apos;ll move the DataBlockEncoding base classes and then add the prefix-trie module.&lt;/p&gt;</comment>
                            <comment id="13294820" author="yuzhihong@gmail.com" created="Thu, 14 Jun 2012 05:58:10 +0000"  >&lt;p&gt;From &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2166/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2166/console&lt;/a&gt;, looks like there might be compilation issue.&lt;/p&gt;

&lt;p&gt;I don&apos;t see ClassSize.java added to hbase-common module.&lt;/p&gt;</comment>
                            <comment id="13294842" author="mcorgan" created="Thu, 14 Jun 2012 06:56:36 +0000"  >&lt;p&gt;shoot - made the patch before committing so git diff didn&apos;t get the &quot;new&quot; files.  i am no good at git&lt;/p&gt;

&lt;p&gt;hopefully this v4 will work.  i tested applying it to latest trunk&lt;/p&gt;</comment>
                            <comment id="13294848" author="yuzhihong@gmail.com" created="Thu, 14 Jun 2012 07:07:56 +0000"  >&lt;p&gt;Patch looks good.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+++ b/hbase-common/src/main/java/org/apache/hadoop/hbase/KeyValue.java
@@ -0,0 +1,2563 @@
+/**
+ * Copyright 2009 The Apache Software Foundation
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can year be removed from the above file ?&lt;br/&gt;
Same for HeapSize.java and ClassSize.java&lt;/p&gt;</comment>
                            <comment id="13294857" author="mcorgan" created="Thu, 14 Jun 2012 07:22:51 +0000"  >&lt;p&gt;v5 patch removes the apache header years in HeapSize, ClassSize, and KeyValue&lt;/p&gt;</comment>
                            <comment id="13294871" author="hadoopqa" created="Thu, 14 Jun 2012 07:48:31 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12532043/HBASE-6162-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12532043/HBASE-6162-v4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 6 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestSplitLogManager&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2168//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2168//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2168//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2168//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2168//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2168//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2168//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2168//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13294918" author="hadoopqa" created="Thu, 14 Jun 2012 09:26:03 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12532046/HBASE-6162-v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12532046/HBASE-6162-v5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 6 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2169//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2169//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2169//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2169//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2169//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2169//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2169//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2169//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13295254" author="stack" created="Thu, 14 Jun 2012 19:33:27 +0000"  >&lt;p&gt;Committed to trunk.  Thanks Matt.&lt;/p&gt;

&lt;p&gt;I wasn&apos;t mad about the machinations where we try to fake the push test dependencies into src/main.  I was thinking that rather we should refactor the unit test so its module scoped? (At least for the stuff that doesn&apos;t need minihbasecluster, etc.)&lt;/p&gt;</comment>
                            <comment id="13295308" author="hudson" created="Thu, 14 Jun 2012 20:52:07 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3025 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3025/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3025/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6162&quot; title=&quot;Move KeyValue to hbase-common module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6162&quot;&gt;&lt;del&gt;HBASE-6162&lt;/del&gt;&lt;/a&gt; Move KeyValue to hbase-common module (Revision 1350378)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/KeyValue.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/io/HeapSize.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/util/ClassSize.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/KeyValue.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/catalog/MetaReader.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/HeapSize.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/GetClosestRowBeforeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/util/ClassSize.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestGetClosestAtOrBefore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13295379" author="hudson" created="Thu, 14 Jun 2012 23:24:09 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #54 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6162&quot; title=&quot;Move KeyValue to hbase-common module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6162&quot;&gt;&lt;del&gt;HBASE-6162&lt;/del&gt;&lt;/a&gt; Move KeyValue to hbase-common module (Revision 1350378)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/KeyValue.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/io/HeapSize.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/util/ClassSize.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/HRegionInfo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/KeyValue.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/catalog/MetaReader.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/HeapSize.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/GetClosestRowBeforeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/util/ClassSize.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestGetClosestAtOrBefore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13295812" author="mcorgan" created="Fri, 15 Jun 2012 18:05:08 +0000"  >&lt;p&gt;No worries stack - i just wasn&apos;t sure of the best approach for the tests so decided to punt for now.  I think we all agree they would be best in hbase-common/src/test/java, but are foiled by maven again.  &lt;/p&gt;

&lt;p&gt;I actually tried putting them in hbase-common/src/main/java/org/apache/hbase/test (removed hadoop package), but it made for a very confusing package tree in eclipse since the non-test classes were still in org/apache/hadoop/hbase.  Looking at it made me think we should drop the hadoop package for everything all at once and not move things peicemeal.&lt;/p&gt;

&lt;p&gt;It would be nice to pull the tests up somehow to help us untangle things... what do you think is the best approach now?  I can live with new modules, funny package trees, etc.  Just need to pick our poison i guess.  I unfortunately don&apos;t know enough about maven to even make a suggestion.  You thinking an hbase-common-tests module is the best approach for now?&lt;/p&gt;</comment>
                            <comment id="13396003" author="jesse_yates" created="Mon, 18 Jun 2012 16:25:38 +0000"  >&lt;p&gt;-1 on an hbase-common-tests module until its really necessary. Generally, we should be able to split tests into two groups: (1) strict unit tests, (2) tests using the mini-cluster. &lt;/p&gt;

&lt;p&gt;Those with the mini-cluster should be somewhat refactored to test much of the same functionality, but with more mocking and smaller pieces. &lt;/p&gt;

&lt;p&gt;The bigger tests might need to be pulled into an hbase-tests module or hbase-&lt;/p&gt;
{module}&lt;del&gt;tests module that depends on an hbase-test module. hbase-test would contain the mini-cluster, LargeTest, etc. and  also just depends on the &lt;em&gt;all&lt;/em&gt; hbase&lt;/del&gt;{module}
&lt;p&gt; modules (so hbase-test depends on hbase-common, hbase-server, etc).&lt;/p&gt;</comment>
                            <comment id="13396069" author="mcorgan" created="Mon, 18 Jun 2012 17:50:15 +0000"  >&lt;p&gt;Jesse - have you by chance tried getting tests to run when the test classes are in src/main/java?  I don&apos;t think they do by default... any idea how?&lt;/p&gt;

&lt;p&gt;And what did you think of putting the tests in org.apache.hadoop.hbase.test rather than scattering test packages throughout - do you have a preference there?&lt;/p&gt;

&lt;p&gt;I&apos;ll make a patch for the tests if we can figure out how to make sure they run.&lt;/p&gt;</comment>
                            <comment id="13396128" author="stack" created="Mon, 18 Jun 2012 18:46:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;Jesse - have you by chance tried getting tests to run when the test classes are in src/main/java?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why you ask Matt?  Because if we have an hbase-tests, you think the tests should go into src/main/java rather than into src/test/java?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;...hbase-common/src/test/java, but are foiled by maven again.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If you put them there, aren&apos;t they run as part of the mvn test goal?  (Or are you trying to fix tests in a later module have dependency on code in src/test/java in an earlier one?)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Looking at it made me think we should drop the hadoop package for everything all at once and not move things piecemeal.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;ll break the world unfortunately.  We could do it internally but our exterior APIs have the hadoop on them.... so we would have to do call through from old APIs to the new ones.  You don&apos;t think it ok just adding new stuff at o.a.hbase?  Maybe when we go to HBase 2.0?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It would be nice to pull the tests up somehow to help us untangle things... what do you think is the best approach now?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes... but regards the tests you included in earlier versions of the patch, these were dirty because they had dependencies used by tests that were left behind in hbase-server?  I&apos;d think the test needs teasing apart?  Or would that not work for the said test?  Could the dependencies the test relies on be moved into src/main/java..... tools?&lt;/p&gt;

&lt;p&gt;Good on you Matt.&lt;/p&gt;</comment>
                            <comment id="13396152" author="mcorgan" created="Mon, 18 Jun 2012 19:03:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;You don&apos;t think it ok just adding new stuff at o.a.hbase? Maybe when we go to HBase 2.0?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I&apos;m generally in favor of starting to move towards the long term goal as soon as possible, but thought i&apos;d throw out a warning that it&apos;s a pretty ugly transitionary state =)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(Or are you trying to fix tests in a later module have dependency on code in src/test/java in an earlier one?)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yep - the hbase-common/src/test/java classes are unfortunately not visible to classes in hbase-server/src/test/java.  We want things in hbase-common/src/test/java to be visible by downstream tests, for example LoadTestKVGenerator is pretty fundamental and can be useful for tests in all modules.&lt;/p&gt;

&lt;p&gt;Jesse and I are proposing that we put the tests that would go in hbase-common/src/test/java into hbase-common/src/main/java so they becomes visible downstream.  I like this solution (at least until maven gets fixed), but now the problem is that &quot;mvn -pl hbase-common test&quot; doesn&apos;t run tests if they&apos;re in src/main/java&lt;/p&gt;</comment>
                            <comment id="13396203" author="zhihyu@ebaysf.com" created="Mon, 18 Jun 2012 20:08:02 +0000"  >&lt;p&gt;I think we should put more efforts into fixing maven so that we don&apos;t devise transitional fixes in hbase code base.&lt;/p&gt;</comment>
                            <comment id="13396205" author="jesse_yates" created="Mon, 18 Jun 2012 20:08:43 +0000"  >&lt;blockquote&gt;&lt;p&gt;Jesse and I are proposing that we put the tests that would go in hbase-common/src/test/java into hbase-common/src/main/java so they becomes visible downstream.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not quite. I&apos;d rather see the test &lt;em&gt;utilities&lt;/em&gt; go into src/main, for downstream visibility, but keep the tests themselves in src/test. I don&apos;t think we actually do any test heirarchy, so this shouldn&apos;t be a problem. If we do have some inheritance, then those classes will need to be together (same module), but this should be rare. &lt;/p&gt;

&lt;p&gt;hbase-tests might then have the testing utils in src/main and the tests in src/tests&lt;/p&gt;

&lt;p&gt;FWIW, you can hack the locations to look for test classes with the &amp;lt;testResources\&amp;gt; tag in the pom. Its not pretty, but does provide a route to putting test classes in src/main/test/&lt;/p&gt;</comment>
                            <comment id="13396262" author="mcorgan" created="Mon, 18 Jun 2012 21:18:16 +0000"  >&lt;p&gt;Jesse - thanks.  I understand now and agree that&apos;s better.&lt;/p&gt;

&lt;p&gt;I created &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6234&quot; title=&quot;Move simple KeyValue tests to hbase-common module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6234&quot;&gt;&lt;del&gt;HBASE-6234&lt;/del&gt;&lt;/a&gt; with a patch reflecting my latest interpretation of the discussion.&lt;/p&gt;</comment>
                            <comment id="13775272" author="stack" created="Mon, 23 Sep 2013 18:31:08 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12528782">HBASE-4676</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12557129">HBASE-6087</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12554576">HBASE-5977</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12530915" name="HBASE-6162-v1.patch" size="284553" author="mcorgan" created="Tue, 5 Jun 2012 08:20:03 +0000"/>
                            <attachment id="12531587" name="HBASE-6162-v2.patch" size="315474" author="mcorgan" created="Sat, 9 Jun 2012 23:31:59 +0000"/>
                            <attachment id="12532038" name="HBASE-6162-v3.patch" size="110035" author="mcorgan" created="Thu, 14 Jun 2012 04:16:36 +0000"/>
                            <attachment id="12532043" name="HBASE-6162-v4.patch" size="213768" author="mcorgan" created="Thu, 14 Jun 2012 06:56:36 +0000"/>
                            <attachment id="12532046" name="HBASE-6162-v5.patch" size="213753" author="mcorgan" created="Thu, 14 Jun 2012 07:22:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 5 Jun 2012 16:28:06 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>256556</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hunb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102227</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>