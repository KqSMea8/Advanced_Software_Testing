<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:01:40 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2414/HBASE-2414.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2414] Enhance test suite to be able to specify distributed scenarios</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2414</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We keep finding good cases that are reasonably hard to test, yet the test suite does not encode these. &lt;br/&gt;
For example: &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2413&quot; title=&quot;Master does not respect generation stamps, may result in meta getting permanently offlined&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2413&quot;&gt;&lt;del&gt;HBASE-2413&lt;/del&gt;&lt;/a&gt; Master does not respect generation stamps, may result in meta getting permanently offlined&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2312&quot; title=&quot;Possible data loss when RS goes into GC pause while rolling HLog&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2312&quot;&gt;&lt;del&gt;HBASE-2312&lt;/del&gt;&lt;/a&gt; Possible data loss when RS goes into GC pause while rolling HLog&lt;/p&gt;

&lt;p&gt;I am sure there are many more such &quot;scenarios&quot; we should put into the unit tests. &lt;/p&gt;
</description>
                <environment></environment>
        <key id="12461334">HBASE-2414</key>
            <summary>Enhance test suite to be able to specify distributed scenarios</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="karthik.ranga">Karthik Ranganathan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Apr 2010 00:44:40 +0000</created>
                <updated>Fri, 20 Nov 2015 12:42:00 +0000</updated>
                            <resolved>Fri, 30 Apr 2010 06:55:08 +0000</resolved>
                                    <version>0.20.3</version>
                                    <fixVersion>0.90.0</fixVersion>
                                    <component>test</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12854283" author="karthik.ranga" created="Wed, 7 Apr 2010 00:45:01 +0000"  >&lt;p&gt;Something along the following lines would help accomplish this:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;In a version of the tests, the master and region server threads each have a method to receive a string representation of the task they have to carry out&lt;/li&gt;
	&lt;li&gt;They use reflection and execute the call only when called by the external caller. That way we can &quot;serialize&quot; the distributed execution.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12856316" author="stack" created="Tue, 13 Apr 2010 06:19:14 +0000"  >&lt;p&gt;Here is an ugly part-patch.  Its an attempt at doing a cluster that has no RPC.  Master and RegionServer would invoke each other&apos;s methods directly rather than go via RPC.  This is not the right approach &amp;#8211; subclassing HMaster and RS and trying to shutdown the networking.  It&apos;d take for ever to do and it&apos;d be ugly when done.&lt;/p&gt;

&lt;p&gt;Let me think more on making it so regionservers and masters take a &apos;script&apos; as K suggests above.&lt;/p&gt;</comment>
                            <comment id="12859923" author="stack" created="Thu, 22 Apr 2010 17:57:50 +0000"  >&lt;p&gt;Failed attempt 2: Starts a master with disabled scanners and then fakes it out by invoking master methods directly calling region start and region server heartbeat methods, passing back the region open, etc. messages.  All works pretty good coming up but then master wants to connect to the non-running meta to add edis tot the table itself.  We could blank this networking out but in at least a few of the tests we want to build updates to fail legitimately because .meta. is not available.   This tack may be worth further dev but we need something better.&lt;/p&gt;

&lt;p&gt;Looking now at bringing up the minihdfscluster and then doing direct injection as per the above patch on the individual daemons to get what I want.  Also looking at changing the proxy so its not over rpc but goes local instead.&lt;/p&gt;</comment>
                            <comment id="12860161" author="stack" created="Fri, 23 Apr 2010 08:05:59 +0000"  >&lt;p&gt;This approach seems more promising.  It makes all the interfaces used networking configurable and then provides direct connect between master and regionservers with no network involved.  The instances are readily available so can do stuff like remove meta and then send in a close message.  Not done yet.  Just posting what I have so far.  Will keep at it.&lt;/p&gt;</comment>
                            <comment id="12860163" author="stack" created="Fri, 23 Apr 2010 08:07:16 +0000"  >&lt;p&gt;Marking blocker and pulling into 0.20.5 and 0.21&lt;/p&gt;</comment>
                            <comment id="12860355" author="stack" created="Fri, 23 Apr 2010 19:17:52 +0000"  >&lt;p&gt;This version better integrates the use of nonetwork implementations of pertinent interfaces.  Not done yet.  Need to work it into HBaseTestingUtility better and still need to prove that testing cluster transistion with this stuff is viable (it still looks so, just need to do the proof still).   If want to take a look now, start with TestClusterTransistions.&lt;/p&gt;</comment>
                            <comment id="12860487" author="stack" created="Sat, 24 Apr 2010 05:47:59 +0000"  >&lt;p&gt;Cleaned up errors on shutdown.  Now clean start/stop of nonetwork cluster (and old stuff confirmed working as it used to).  Next is try to do actual unit test.&lt;/p&gt;</comment>
                            <comment id="12860791" author="stack" created="Mon, 26 Apr 2010 03:52:36 +0000"  >&lt;p&gt;This patch is not for review.  Its a mess that has two testing techniques wrapped up in it still and is in need of cleanup.&lt;/p&gt;

&lt;p&gt;My pursuit of a &apos;direct&apos;/nonetwork hbase ran into the weeds; i.e the &apos;first&apos; technique.  All of the client logic down in HConnnectionManager#TableServers would need to be redone so its &apos;direct&apos;.  Subclassing HConnectionManager#TableServers helped in that I could leverage what was already there but still, a lot to be done. So, i tried doing reproduction of cluster bad-cases using old-school minihbasecluster machinations (technique &apos;two&apos;).&lt;/p&gt;

&lt;p&gt;The pursuit of technique &apos;one&apos; opened up our minihbasecluster code making it so I was able to write a simple test to repro what is seen here in the stack trace at the head of this issue (patch includes the code in the TestClusterTransition junit test).  &lt;/p&gt;

&lt;p&gt;Here is what my test is showing...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2010-04-25 20:31:07,946 INFO  [RegionServer:1] regionserver.HRegionServer(649): aborting server at: 192.168.1.106:63335
2010-04-25 20:31:07,956 INFO  [main-EventThread] master.ServerManager$ServerExpirer(831): 192.168.1.106,63335,1272252645013 znode expired
2010-04-25 20:31:07,957 INFO  [main-EventThread] master.RegionManager(795): META region removed from onlineMetaRegions
2010-04-25 20:31:07,958 DEBUG [RegionServer:1] zookeeper.ZooKeeperWrapper(682): Closed connection with ZooKeeper
2010-04-25 20:31:07,958 INFO  [RegionServer:1] regionserver.HRegionServer(696): RegionServer:1 exiting
2010-04-25 20:31:07,960 INFO  [main] regionserver.HRegionServer(261): My address is 192.168.1.106:0
2010-04-25 20:31:07,961 INFO  [main] ipc.HBaseRpcMetrics(52): Initializing RPC Metrics with hostName=HRegionServer, port=63412
2010-04-25 20:31:07,962 INFO  [main] regionserver.MemStoreFlusher(102): globalMemStoreLimit=32.6m, globalMemStoreLimitLowMark=20.4m, maxHeap=81.4m
2010-04-25 20:31:07,963 INFO  [main] regionserver.HRegionServer$MajorCompactionChecker(984): Runs every 1000000ms
2010-04-25 20:31:07,968 DEBUG [HMaster] master.HMaster(506): Processing todo: ProcessServerShutdown of 192.168.1.106,63335,1272252645013
...
# While processing server shutdown in came the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RS instance w/ same port and load balance kicks in....
...
2010-04-25 20:31:08,187 INFO  [RegionServer:1] regionserver.HRegionServer(1202): HRegionServer started at: 192.168.1.106:63412
2010-04-25 20:31:08,188 DEBUG [RegionServer:1] zookeeper.ZooKeeperWrapper(398): Read ZNode /hbase/root-region-server got 192.168.1.106:63333
2010-04-25 20:31:08,218 DEBUG [pool-1-thread-1] regionserver.HLog$1(1278): &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; got 53 to process
2010-04-25 20:31:08,222 DEBUG [IPC Server handler 4 on 60000] master.RegionManager$LoadBalancer(1447): Server is overloaded: load=15, avg=7.5, slop=0.3
...
# Then fell into... &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; processing a close region

2010-04-25 20:31:08,360 DEBUG [HMaster] master.HMaster(506): Processing todo: ProcessRegionClose of 2428,fff,1272252656267, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, reassign: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2010-04-25 20:31:08,362 DEBUG [HMaster] master.RetryableMetaOperation(95): Exception in RetryableMetaOperation: 
java.lang.NullPointerException
	at org.apache.hadoop.hbase.master.RetryableMetaOperation.doWithRetries(RetryableMetaOperation.java:65)
	at org.apache.hadoop.hbase.master.ProcessRegionClose.process(ProcessRegionClose.java:89)
	at org.apache.hadoop.hbase.master.HMaster.processToDoQueue(HMaster.java:510)
	at org.apache.hadoop.hbase.master.HMaster.run(HMaster.java:445)
2010-04-25 20:31:08,367 WARN  [HMaster] master.HMaster(546): Processing pending operations: ProcessRegionClose of 2428,fff,1272252656267, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, reassign: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
java.lang.RuntimeException: java.lang.NullPointerException
	at org.apache.hadoop.hbase.master.RetryableMetaOperation.doWithRetries(RetryableMetaOperation.java:96)
	at org.apache.hadoop.hbase.master.ProcessRegionClose.process(ProcessRegionClose.java:89)
	at org.apache.hadoop.hbase.master.HMaster.processToDoQueue(HMaster.java:510)
	at org.apache.hadoop.hbase.master.HMaster.run(HMaster.java:445)
Caused by: java.lang.NullPointerException
	at org.apache.hadoop.hbase.master.RetryableMetaOperation.doWithRetries(RetryableMetaOperation.java:65)
	... 3 more
..

and so on...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It required some knowledge of minihbasecluster internals but its not too bad methinks.  I&apos;ve added a bunch of doc. so others can follow.  &lt;/p&gt;

&lt;p&gt;Let me clean up and repro more of the recent cluster failings in unit test scenario using minihbasecluster.&lt;/p&gt;</comment>
                            <comment id="12861274" author="stack" created="Tue, 27 Apr 2010 07:16:42 +0000"  >&lt;p&gt;Cleaned up patch.  Adds a &apos;kill&apos; method to HRS.  Included TestClusterTransition test will not shutdown because we are trying to do a close and can&apos;t because meta is not online nor will it ever come online (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2428&quot; title=&quot;NPE in ProcessRegionClose because meta is offline kills master and thus the cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2428&quot;&gt;&lt;del&gt;HBASE-2428&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="12861507" author="stack" created="Tue, 27 Apr 2010 19:26:07 +0000"  >&lt;p&gt;Trying to use powermock and mockito inside a minihbasecluster context I run into the following issues (after struggling past similar around commons logging):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

Testcase: testRegionCloseWhenNoMetaHBase2428 took 1.659 sec
        Caused an ERROR
loader constraint violation: loader (instance of org/powermock/core/classloader/MockClassLoader) previously initiated loading &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; a different type with name &lt;span class=&quot;code-quote&quot;&gt;&quot;javax/management/MBeanServer&quot;&lt;/span&gt;
java.lang.LinkageError: loader constraint violation: loader (instance of org/powermock/core/classloader/MockClassLoader) previously initiated loading &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; a different type with name &lt;span class=&quot;code-quote&quot;&gt;&quot;javax/management/MBeanServer&quot;&lt;/span&gt;
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass1(Native Method)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:700)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:545)
        at org.powermock.core.classloader.MockClassLoader.loadUnmockedClass(MockClassLoader.java:190)
        at org.powermock.core.classloader.MockClassLoader.loadModifiedClass(MockClassLoader.java:148)
        at org.powermock.core.classloader.DeferSupportingClassLoader.loadClass(DeferSupportingClassLoader.java:63)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:254)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClassInternal(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:399)
        at org.apache.hadoop.metrics.util.MBeanUtil.registerMBean(MBeanUtil.java:53)
        at org.apache.hadoop.ipc.metrics.RpcActivityMBean.&amp;lt;init&amp;gt;(RpcActivityMBean.java:70)
        at org.apache.hadoop.ipc.metrics.RpcMetrics.&amp;lt;init&amp;gt;(RpcMetrics.java:64)
        at org.apache.hadoop.ipc.Server.&amp;lt;init&amp;gt;(Server.java:1028)
        at org.apache.hadoop.ipc.RPC$Server.&amp;lt;init&amp;gt;(RPC.java:488)
        at org.apache.hadoop.ipc.RPC.getServer(RPC.java:450)
        at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:191)
        at org.apache.hadoop.hdfs.server.namenode.NameNode.&amp;lt;init&amp;gt;(NameNode.java:279)
        at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:956)
        at org.apache.hadoop.hdfs.MiniDFSCluster.&amp;lt;init&amp;gt;(MiniDFSCluster.java:275)
        at org.apache.hadoop.hbase.HBaseTestingUtility.startMiniCluster(HBaseTestingUtility.java:200)
        at org.apache.hadoop.hbase.TestClusterTransitions.beforeAllTests(TestClusterTransitions.java:44)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$PowerMockJUnit44MethodRunner.executeTest(PowerMockJUnit44RunnerDelegateImpl.java:309)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit47RunnerDelegateImpl$PowerMockJUnit47MethodRunner.executeTestInSuper(PowerMockJUnit47RunnerDelegateImpl.java:112)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit47RunnerDelegateImpl$PowerMockJUnit47MethodRunner.executeTest(PowerMockJUnit47RunnerDelegateImpl.java:73)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$PowerMockJUnit44MethodRunner.runBeforesThenTestThenAfters(PowerMockJUnit44RunnerDelegateImpl.java:297)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl.invokeTestMethod(PowerMockJUnit44RunnerDelegateImpl.java:222)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl.runMethods(PowerMockJUnit44RunnerDelegateImpl.java:161)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl$1.run(PowerMockJUnit44RunnerDelegateImpl.java:135)
        at org.powermock.modules.junit4.internal.impl.PowerMockJUnit44RunnerDelegateImpl.run(PowerMockJUnit44RunnerDelegateImpl.java:133)
        at org.powermock.modules.junit4.common.internal.impl.JUnit4TestSuiteChunkerImpl.run(JUnit4TestSuiteChunkerImpl.java:112)
        at org.powermock.modules.junit4.common.internal.impl.AbstractCommonPowerMockRunner.run(AbstractCommonPowerMockRunner.java:55)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above classloading uglyness looks like it would take a while to undo &amp;#8211; if its possible at all &amp;#8211; and when done, I&apos;d end up with a fragile test environment is my guess.  I&apos;m going to pass on this combo unless others have input.&lt;/p&gt;</comment>
                            <comment id="12861692" author="stack" created="Wed, 28 Apr 2010 06:35:47 +0000"  >&lt;p&gt;Attached patch should have sufficient vocabulary for writing tests that can repro recent rash of issues.  It adds means of adding listeners to master events &amp;#8211; both before and after event happens.  The before lets you put off the event.  it&apos;ll be requeued, added to the DelayQueue (this happens currently in Master if an issue processing a RegionServerOperation, it gets requeued to be tried again later).  The patch also adds to minihbasecluster simple means of sending regionserver &quot;events&apos;.&lt;/p&gt;

&lt;p&gt;Patch includes test that reproduces hbase-2428.  Let me add more unit tests for other issues.&lt;/p&gt;</comment>
                            <comment id="12862069" author="stack" created="Thu, 29 Apr 2010 02:38:52 +0000"  >&lt;p&gt;I want to commit this patch.  Can I get a review.  Its kinda polluted in that it contains:&lt;/p&gt;

&lt;p&gt;1. Means of testing state transitions across the master.  Tests can register listeners.  In the listener you should be able to delay, cancel, count, etc., RegionServerOperations.  It should be possible in the listener simulating uglyness seen out on live clusters.&lt;br/&gt;
2. A fix for the &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2428&quot; title=&quot;NPE in ProcessRegionClose because meta is offline kills master and thus the cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2428&quot;&gt;&lt;del&gt;HBASE-2428&lt;/del&gt;&lt;/a&gt; bug.&lt;br/&gt;
3. Facility added to TestHBaseUtility and MiniHBaseCluster&lt;br/&gt;
4. I started refactoring of the queue of RegionServerOperations in master moving it out to a separate file making it testable but then I ran into fact that RegionServerOperations each have a reference to master AND they can put themselves back on the queue &amp;#8211; the circularity baffles.  This has to be fixed but will do in a separate patch.&lt;/p&gt;

&lt;p&gt;Here is a commit message with some detail on the commit:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
M src/test/org/apache/hadoop/hbase/HBaseTestingUtility.java
  Broke up startMiniHBaseCluster into smaller methods so can mix and
  match pieces of minihbasecluster toward other ends.
  (setupClusterBuildDir, isRunningCluster, getMiniHBaseCluster): Added.
M src/test/org/apache/hadoop/hbase/TestInfoServers.java
M src/test/org/apache/hadoop/hbase/TestRegionRebalancing.java
M src/test/org/apache/hadoop/hbase/HBaseClusterTestCase.java
M src/test/org/apache/hadoop/hbase/regionserver/TestLogRolling.java
M src/test/org/apache/hadoop/hbase/regionserver/DisabledTestRegionServerExit.java
M src/test/org/apache/hadoop/hbase/mapreduce/TestTableIndex.java
M src/test/org/apache/hadoop/hbase/mapred/TestTableIndex.java
  Ripple from change of MiniHBaseCluster.getRegionThreads to
  getRegionServerThreads.
M src/test/org/apache/hadoop/hbase/MiniHBaseCluster.java
  Added &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MiniHBaseClusterMaster that is override of HMaster so
  I can piggyback messages &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; designated regionservers atop the
  heartbeat: close region, etc.
  (getServerWithMeta, addMessageToSendRegionServer): Added.
A src/test/org/apache/hadoop/hbase/master/TestRegionServerOperationQueue.java
  Stubbed out test of &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RegionServerOperationQueue class.
A src/test/org/apache/hadoop/hbase/master/TestMasterTransistions.java
  Test master cluster transistions.  Includes unit test of hbase-2428.
M src/test/org/apache/hadoop/hbase/util/TestMigration.java
  Disable migration test.  Nothing to migrate yet and besides it was
  trying to load a 0.19 hbase data tar.gz that has since been removed.
M src/contrib/stargate/build.xml
  Added a copyright.
M src/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
  Documentation and moved some methods from down at tail of the class
  where they were in among &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; methods used parsing cmd-line usage
  up above the usage and master startup &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; methods.
  Added fix &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; issue broken by an hbase-1215 commit where we were
  looking at wrong address (Grep &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; r796326 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more).
M src/java/org/apache/hadoop/hbase/LocalHBaseCluster.java
  Moved bulk out to &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JVMClusterUtils class and made accessible.
  Added passing of HMaster.class to instantiate to facilitate
  passing of TestHMaster.class.
M src/java/org/apache/hadoop/hbase/master/RegionServerOperationQueue.java
  The RegionServerOperations queues moved out to their own class from
  Master.  Allows listeners to register and get notice before and after
  a RegionServerOperation is processed.  Includes part of bug fix &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;
  hbase-2428. When an error processing a RegionServerOperation, we&apos;d fall
  into the IOException &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;.  We&apos;d then put the operation back on the delay
  queue &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; later processing only we&apos;d not reset its expiration.  It
  would therefore run again immmediately... fail again, and so on.
  Changed the &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; from process to be an &lt;span class=&quot;code-keyword&quot;&gt;enum&lt;/span&gt; rather than &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;/&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
  so I don&apos;t have to have &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; things like call checkfs down in here and
  I don&apos;t need to have a master instance around.
M src/java/org/apache/hadoop/hbase/master/ServerManager.java
  How we add RegionServerOperation instances has changed to go via
  RegionServerOperationQueue now.
M src/java/org/apache/hadoop/hbase/master/ProcessServerShutdown.java
  (getDeadServerAddress): Added.
M src/java/org/apache/hadoop/hbase/master/RegionServerOperationListener.java
  Listener &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; to implement &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; interested in watching RegionServerOperations.
M src/java/org/apache/hadoop/hbase/master/HMaster.java
  Moved the RegionServerOperation code out of here to
  RegionServerOperationQueue.
  (adornRegionServerAnswer, constructMaster): Added.
M src/java/org/apache/hadoop/hbase/master/ProcessRegionOpen.java
  Comment.
M src/java/org/apache/hadoop/hbase/master/ProcessRegionClose.java
  Added in *fix* &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 2428 NPE.  For now did what happens in
  ProcessRegionOpen &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; symmetry&apos;s sake but it needs to be replaced.
M src/java/org/apache/hadoop/hbase/master/RegionServerOperation.java
  (resetExpiration): Added.
M src/java/org/apache/hadoop/hbase/master/ProcessRegionStatusChange.java
  Javaadoc.
M src/java/org/apache/hadoop/hbase/util/Threads.java
  (threadDumpingIsAlive): Added from LocalHBaseCluster.
  (sleep): Added.
M src/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java
  New class that has facility moved from LocalHBaseCluster with added
  javadoc and made accessible.  Needed testing.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12862311" author="karthik.ranga" created="Thu, 29 Apr 2010 18:17:01 +0000"  >&lt;p&gt;Awesome stuff Stack! Patch looks great, just a couple of small comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Revert src/java/org/apache/hadoop/hbase/master/ProcessRegionStatusChange.java (no change in file)&lt;/li&gt;
	&lt;li&gt;src/java/org/apache/hadoop/hbase/master/ProcessServerShutdown.java:60 Don&apos;t need row parameter in &quot;ToDoEntry(final  byte [] row, final HRegionInfo  info)&quot; anymore.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12862503" author="stack" created="Fri, 30 Apr 2010 00:58:44 +0000"  >&lt;p&gt;Thanks Karthik.  Will fix above on commit.&lt;/p&gt;</comment>
                            <comment id="12862563" author="stack" created="Fri, 30 Apr 2010 06:55:08 +0000"  >&lt;p&gt;Committed to branch and trunk.  Thanks for review Karthik.  I committed with your suggested changes.  I&apos;m resolving this issue though I&apos;m sure there is probably a better way of testing cluster transitions.  This should do for now.  We can open a new JIRA for NG or improvements.&lt;/p&gt;</comment>
                            <comment id="12866854" author="stack" created="Wed, 12 May 2010 23:52:30 +0000"  >&lt;p&gt;Marking these as fixed against 0.21.0 rather than against 0.20.5.&lt;/p&gt;</comment>
                            <comment id="15017134" author="lars_francke" created="Fri, 20 Nov 2015 12:42:00 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12441586" name="ASF.LICENSE.NOT.GRANTED--directcluster.txt" size="23892" author="stack" created="Tue, 13 Apr 2010 06:19:14 +0000"/>
                            <attachment id="12442602" name="master2.txt" size="14830" author="stack" created="Thu, 22 Apr 2010 17:57:50 +0000"/>
                            <attachment id="12442930" name="testmaster-v11.patch" size="68862" author="stack" created="Tue, 27 Apr 2010 07:16:42 +0000"/>
                            <attachment id="12443044" name="testmaster-v14.txt" size="76100" author="stack" created="Wed, 28 Apr 2010 06:35:47 +0000"/>
                            <attachment id="12443158" name="testmaster-v16.txt" size="96159" author="stack" created="Thu, 29 Apr 2010 02:38:52 +0000"/>
                            <attachment id="12442655" name="testmaster-v4.patch" size="53948" author="stack" created="Fri, 23 Apr 2010 08:05:58 +0000"/>
                            <attachment id="12442700" name="testmaster-v5.patch" size="75229" author="stack" created="Fri, 23 Apr 2010 19:17:52 +0000"/>
                            <attachment id="12442735" name="testmaster-v7.patch" size="77798" author="stack" created="Sat, 24 Apr 2010 05:47:59 +0000"/>
                            <attachment id="12442811" name="testmaster-v8.patch" size="98203" author="stack" created="Mon, 26 Apr 2010 03:52:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Apr 2010 06:19:14 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26296</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hhnb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100121</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>