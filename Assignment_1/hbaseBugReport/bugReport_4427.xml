<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:18:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4427/HBASE-4427.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4427] It would help to run a standalone HBase&apos;s ZK on a different port</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4427</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;It would be extremely helpful to have standalone HBase default to a non-standard port for running its embedded ZK. This would help to run HBase on the same host where a legitimate fully distributed ZK server, etc.&lt;/p&gt;

&lt;p&gt;It seems that the following addition to hbase-default.xml would be enough to make it happen:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+  &amp;lt;property&amp;gt;
+    &amp;lt;name&amp;gt;hbase.zookeeper.property.clientPort&amp;lt;/name&amp;gt;
+    &amp;lt;value&amp;gt;4181&amp;lt;/value&amp;gt;
+  &amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will take care of the master/client for HBase and can be overridden in hbase-site if needed.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12523415">HBASE-4427</key>
            <summary>It would help to run a standalone HBase&apos;s ZK on a different port</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rvs">Roman Shaposhnik</reporter>
                        <labels>
                    </labels>
                <created>Sat, 17 Sep 2011 02:26:34 +0000</created>
                <updated>Sat, 11 Apr 2015 00:50:20 +0000</updated>
                            <resolved>Sat, 11 Apr 2015 00:50:20 +0000</resolved>
                                    <version>0.90.4</version>
                                                    <component>Zookeeper</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13107174" author="stack" created="Sat, 17 Sep 2011 17:39:18 +0000"  >&lt;p&gt;If we change this in hbase-default.xml, it will change it for all runs of hbase not just standalone.  That is probably not what you want.  I see over in src/test/resources/hbase-site.xml, the configuration we use for tests that we have a non-default port for zk.  Is it too much trouble setting this config. in your local standalone instance Roman?  Seems like a pretty disruptive change to make otherwise.&lt;/p&gt;</comment>
                            <comment id="13107204" author="rvs" created="Sat, 17 Sep 2011 18:40:28 +0000"  >&lt;p&gt;It is mostly out-of-the-box experience kind of question and you&apos;re absolutely right &amp;#8211; I can set it in my hbase-site.xml. However, I would like to understand a little bit better why do you think it&apos;ll be that disruptive. Suppose we change hbase-default.xml. The scenarious I see are these:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;standalone mode &amp;#8211; will work perfectly&lt;/li&gt;
	&lt;li&gt;pseudo-distributed mode (hbase.cluster.distributed == true) with embedded ZK &amp;#8211; will work perfectly&lt;/li&gt;
	&lt;li&gt;pseudo-distributed mode (hbase.cluster.distributed == true) with standalone ZK (hbase.zookeeper.quorum != nul) &amp;#8211; will work perfectly since, as far as I understand, hbase.zookeeper.quorum will override hbase.zookeeper.property.clientPort.&lt;/li&gt;
	&lt;li&gt;fully-distributed mode with standalone ZK &amp;#8211; see above. Little difference between where the processes run, they will still require the same configs as far as hbase-site.xml is concerned.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Am I missing anything?&lt;/p&gt;</comment>
                            <comment id="13107502" author="stack" created="Sun, 18 Sep 2011 18:48:05 +0000"  >&lt;p&gt;Thanks for the iteration of all cases.&lt;/p&gt;

&lt;p&gt;You still need to convince that its better that the default port is changed for everyone for all installs rather than you change it in your hbase-site.xml because you happen to do what I&apos;d think a rare setup where you run standalone hbase on a machine that is also hosting a zk ensemble that is running on default port.&lt;/p&gt;</comment>
                            <comment id="13109854" author="rvs" created="Wed, 21 Sep 2011 20:30:15 +0000"  >&lt;p&gt;@stack, I was hoping other members of the community would chime in (one way or the other &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;) but I guess it is just you and me.&lt;/p&gt;

&lt;p&gt;So here&apos;s my attempt at convincing you that this is the right thing to do: at the end of the day I believe that only an explicitly managed version of ZK can occupy a well-known client port of 2181. Every other application that uses an embedded ZK to manage some kind of an ensemble for its own purposes has to run its copy of ZK on a different port. Otherwise it is a bit like having an embedded version of Jetty that would alway bind to 8080 &amp;#8211; not clean and source of miscellaneous gotchas downstream when a real application server starts. &lt;/p&gt;

&lt;p&gt;Now, perhaps, to make things extra clear we should introduce an extra property called embeddedClientPort or miniZKclientPort and let the existing be.&lt;/p&gt;

&lt;p&gt;If you agree with this reasoning, I can attach a patch to make it happen according to the scenario I&apos;ve outlined. If not &amp;#8211; that&apos;s also fine, but please let me know either way.&lt;/p&gt;</comment>
                            <comment id="13112977" author="jdcryans" created="Thu, 22 Sep 2011 22:40:52 +0000"  >&lt;p&gt;For a moment I liked the embeddedClientPort idea, but then if you have an external client it means you have to change its default config in order to talk to a cluster that has a managed ZK, and that port wouldn&apos;t be easy to find. There&apos;s also the problem of those already running that kind of setup that all of a sudden would need to change their configs.&lt;/p&gt;

&lt;p&gt;I&apos;m -1.&lt;/p&gt;

&lt;p&gt;Something to consider would be refusing to start HBase if while starting it&apos;s own ZK it gets a port binding exception. I&apos;m not sure what the current behavior is.&lt;/p&gt;</comment>
                            <comment id="13112983" author="rvs" created="Thu, 22 Sep 2011 22:46:40 +0000"  >&lt;p&gt;@Jean-Daniel Cryans &lt;/p&gt;

&lt;p&gt;&amp;gt; but then if you have an external client it means you have to &lt;br/&gt;
&amp;gt; change its default config in order to talk to a cluster that has a managed ZK, &lt;/p&gt;

&lt;p&gt;how &quot;external&quot; of a client are we talking here? running on the same host or remote?&lt;/p&gt;

&lt;p&gt;&amp;gt; Something to consider would be refusing to start HBase if while starting it&apos;s &lt;br/&gt;
&amp;gt; own ZK it gets a port binding exception.&lt;/p&gt;

&lt;p&gt;I believe that&apos;s the current behavior, which is, in fact, part of the problem&lt;br/&gt;
with out-of-the-box experience on nodes where there&apos;s an already running ZK&lt;/p&gt;
</comment>
                            <comment id="13113021" author="jdcryans" created="Thu, 22 Sep 2011 23:29:53 +0000"  >&lt;blockquote&gt;&lt;p&gt;how &quot;external&quot; of a client are we talking here? running on the same host or remote?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Anything that doesn&apos;t use HBase&apos;s own configuration. Actually even a local client wouldn&apos;t know which port to look for since the config for whether HBase manages zk is in hbase-env.sh&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I believe that&apos;s the current behavior, which is, in fact, part of the problem with out-of-the-box experience on nodes where there&apos;s an already running ZK&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You should use it if it&apos;s already there &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13113035" author="rvs" created="Thu, 22 Sep 2011 23:51:09 +0000"  >&lt;p&gt;@Jean-Daniel Cryans &lt;/p&gt;

&lt;p&gt;If by local client you mean things like hbase shell &amp;#8211; that works quite nicely with the proposed change.&lt;/p&gt;</comment>
                            <comment id="13113050" author="jdcryans" created="Fri, 23 Sep 2011 00:10:42 +0000"  >&lt;p&gt;I was referring to the embeddedClientPort idea, the idea of setting hbase.zookeeper.property.clientPort to a new default breaks about every setup I know of.&lt;/p&gt;</comment>
                            <comment id="13113221" author="larsgeorge" created="Fri, 23 Sep 2011 07:35:59 +0000"  >&lt;p&gt;I agree with JD and Stack, the change will mess up those setups that only use the defaults. I think setting it explicitly by the user on both sides is the most sensible way. I thought about using something like an increment, or fallbackClientPort that a cluster can use when there is an existing ZK ensemble using the port. But then the clients would need to know where to talk to, and might end up connecting to the wrong quorum because is uses its default ports and there is someone now listening to it.&lt;/p&gt;</comment>
                            <comment id="13113591" author="rvs" created="Fri, 23 Sep 2011 17:33:29 +0000"  >&lt;p&gt;@Jean-Daniel Cryans &lt;/p&gt;

&lt;p&gt;&amp;gt; the idea of setting hbase.zookeeper.property.clientPort to a new default breaks about every setup I know of.&lt;/p&gt;

&lt;p&gt;this is not correct. everything that reads hbase-default.xml will continue to work as expected (hbase shell for example). I&apos;m still to new to HBase to know whether 3d party clients that are built on top of HBase APIs are forced to read hbase-default.xml or not. Would appreciate if somebody let me know.&lt;/p&gt;

&lt;p&gt;In general, however, I think the consensus here is pretty clear. Thanks for the feedback and if somebody can answer the question above (on hbase-default.xml) I think we can safely close this JIRA.&lt;/p&gt;</comment>
                            <comment id="13113596" author="jdcryans" created="Fri, 23 Sep 2011 17:37:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;this is not correct. everything that reads hbase-default.xml will continue to work as expected (hbase shell for example)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;One example: the ZK ensemble isn&apos;t managed by HBase and the client port runs on 2181. The new hbase-default.xml now says that the default client port is 4181 so that&apos;s where the cluster and every client is going to look for.&lt;/p&gt;</comment>
                            <comment id="13113625" author="rvs" created="Fri, 23 Sep 2011 18:10:09 +0000"  >&lt;p&gt;@ Jean-Daniel Cryans &lt;/p&gt;

&lt;p&gt;I&apos;m sorry to drag it longer than it should be &amp;#8211; but you didn&apos;t answer my question. Your concerned is answered in the comment #4 (look for embeddedClientPort or miniZKclientPort). Of course all of this is totally predicated on all the clients always paying attention to hbase-default.xml. Whether they always do or not, was, in fact, my question &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;P.S. Sorry for not mentioning embeddedClientPort or miniZKclientPort in the description of the proposed change, I thought it would be assumed, but I should have been more explicit.&lt;/p&gt;</comment>
                            <comment id="13113635" author="jdcryans" created="Fri, 23 Sep 2011 18:23:55 +0000"  >&lt;p&gt;Sorry I missed it:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;m still to new to HBase to know whether 3d party clients that are built on top of HBase APIs are forced to read hbase-default.xml or not. Would appreciate if somebody let me know.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes because it&apos;s included in the HBase jar.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Your concerned is answered in the comment #4 (look for embeddedClientPort or miniZKclientPort)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;To which I answered:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Actually even a local client wouldn&apos;t know which port to look for since the config for whether HBase manages zk is in hbase-env.sh&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Lars mentioned a solution which would be to have the client trying to connect to both ports (I guess the embedded one first), but it&apos;s getting awfully complicated for everyone while just trying to resolve a corner case.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Of course all of this is totally predicated on all the clients always paying attention to hbase-default.xml.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s quite rare that you have to change the port in there, but in any case the HBase client will load any file named &quot;hbase-site.xml&quot; and &quot;hbase-default.xml&quot; if it&apos;s present on the classpath.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 17 Sep 2011 17:39:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33547</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 13 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02g4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12215</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>