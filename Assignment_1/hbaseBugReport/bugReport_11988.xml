<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:28:33 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11988/HBASE-11988.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11988] AC/VC system table create on postStartMaster fails too often in test</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11988</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;See for example&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2014-09-16 04:02:08,833 ERROR [ActiveMasterManager] master.HMaster(633): Coprocessor postStartMaster() hook failed
java.io.IOException: Table Namespace Manager not ready yet, try again later
	at org.apache.hadoop.hbase.master.HMaster.checkNamespaceManagerReady(HMaster.java:1669)
	at org.apache.hadoop.hbase.master.HMaster.getNamespaceDescriptor(HMaster.java:1852)
	at org.apache.hadoop.hbase.master.HMaster.createTable(HMaster.java:1096)
	at org.apache.hadoop.hbase.security.access.AccessControlLists.init(AccessControlLists.java:143)
	at org.apache.hadoop.hbase.security.access.AccessController.postStartMaster(AccessController.java:1059)
	at org.apache.hadoop.hbase.master.MasterCoprocessorHost$58.call(MasterCoprocessorHost.java:692)
	at org.apache.hadoop.hbase.master.MasterCoprocessorHost.execOperation(MasterCoprocessorHost.java:861)
	at org.apache.hadoop.hbase.master.MasterCoprocessorHost.postStartMaster(MasterCoprocessorHost.java:688)
	at org.apache.hadoop.hbase.master.HMaster.finishActiveMasterInitialization(HMaster.java:631)
	at org.apache.hadoop.hbase.master.HMaster.access$500(HMaster.java:155)
	at org.apache.hadoop.hbase.master.HMaster$1.run(HMaster.java:1244)
	at java.lang.Thread.run(Thread.java:744)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12741695">HBASE-11988</key>
            <summary>AC/VC system table create on postStartMaster fails too often in test</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="anoop.hbase">Anoop Sam John</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Sep 2014 06:36:51 +0000</created>
                <updated>Sat, 21 Feb 2015 23:41:41 +0000</updated>
                            <resolved>Sat, 20 Sep 2014 04:01:26 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>0.98.7</fixVersion>
                    <fixVersion>0.99.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="14135057" author="anoop.hbase" created="Tue, 16 Sep 2014 06:40:38 +0000"  >&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2014-09-15 20:33:29,003 DEBUG [PostOpenDeployTasks:f364c75f82c175a3b5c2c7d7cf810ce3] master.AssignmentManager(2676): Got transition OPENED for {f364c75f82c175a3b5c2c7d7cf810ce3 state=PENDING_OPEN, ts=1410813208967, server=asf901.gq1.ygridcore.net,44530,1410813206686} from asf901.gq1.ygridcore.net,44530,1410813206686
2014-09-15 20:33:29,003 INFO  [PostOpenDeployTasks:f364c75f82c175a3b5c2c7d7cf810ce3] master.RegionStates(949): Transition {f364c75f82c175a3b5c2c7d7cf810ce3 state=PENDING_OPEN, ts=1410813208967, server=asf901.gq1.ygridcore.net,44530,1410813206686} to {f364c75f82c175a3b5c2c7d7cf810ce3 state=OPEN, ts=1410813209003, server=asf901.gq1.ygridcore.net,44530,1410813206686}
2014-09-15 20:33:29,003 INFO  [PostOpenDeployTasks:f364c75f82c175a3b5c2c7d7cf810ce3] master.RegionStateStore(207): Updating row hbase:namespace,,1410813208374.f364c75f82c175a3b5c2c7d7cf810ce3. with state=OPEN&amp;amp;openSeqNum=2&amp;amp;server=asf901.gq1.ygridcore.net,44530,1410813206686
2014-09-15 20:33:29,006 INFO  [PostOpenDeployTasks:f364c75f82c175a3b5c2c7d7cf810ce3] master.RegionStates(381): Onlined f364c75f82c175a3b5c2c7d7cf810ce3 on asf901.gq1.ygridcore.net,44530,1410813206686
2014-09-15 20:33:29,007 DEBUG [PostOpenDeployTasks:f364c75f82c175a3b5c2c7d7cf810ce3] regionserver.HRegionServer(1735): Finished post open deploy task for hbase:namespace,,1410813208374.f364c75f82c175a3b5c2c7d7cf810ce3.
2014-09-15 20:33:29,007 DEBUG [RS_OPEN_REGION-asf901:44530-0] handler.OpenRegionHandler(122): Opened hbase:namespace,,1410813208374.f364c75f82c175a3b5c2c7d7cf810ce3. on asf901.gq1.ygridcore.net,44530,1410813206686
2014-09-15 20:33:29,009 INFO  [ActiveMasterManager] master.HMaster(621): Master has completed initialization
2014-09-15 20:33:29,025 ERROR [ActiveMasterManager] master.HMaster(633): Coprocessor postStartMaster() hook failed
java.io.IOException: Table Namespace Manager not ready yet, try again later
	at org.apache.hadoop.hbase.master.HMaster.checkNamespaceManagerReady(HMaster.java:1669)
	at org.apache.hadoop.hbase.master.HMaster.getNamespaceDescriptor(HMaster.java:1852)
	at org.apache.hadoop.hbase.master.HMaster.createTable(HMaster.java:1096)
	at org.apache.hadoop.hbase.security.visibility.VisibilityController.postStartMaster(VisibilityController.java:186)
	at org.apache.hadoop.hbase.master.MasterCoprocessorHost$58.call(MasterCoprocessorHost.java:692)
	at org.apache.hadoop.hbase.master.MasterCoprocessorHost.execOperation(MasterCoprocessorHost.java:861)
	at org.apache.hadoop.hbase.master.MasterCoprocessorHost.postStartMaster(MasterCoprocessorHost.java:688)
	at org.apache.hadoop.hbase.master.HMaster.finishActiveMasterInitialization(HMaster.java:631)
	at org.apache.hadoop.hbase.master.HMaster.access$500(HMaster.java:155)
	at org.apache.hadoop.hbase.master.HMaster$1.run(HMaster.java:1244)
	at java.lang.Thread.run(Thread.java:744)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So the ns table create was over and available before the VC try creating labels table. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
void checkNamespaceManagerReady() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
  checkInitialized();
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tableNamespaceManager == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ||
    !tableNamespaceManager.isTableAvailableAndInitialized()) {
     &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Table Namespace Manager not ready yet, &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; again later&quot;&lt;/span&gt;);
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The check test whether ns table is available and &lt;b&gt;active&lt;/b&gt;.  The active state check will fail as we can see in the log that in master the state changed after this exception log&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2014-09-15 20:33:29,410 DEBUG [MASTER_TABLE_OPERATIONS-asf901:44530-0] util.FSTableDescriptors(658): Deleted table descriptor at hdfs://localhost:34588/user/jenkins/hbase/data/hbase/namespace/.tabledesc/.tableinfo.0000000001
2014-09-15 20:33:29,410 INFO  [MASTER_TABLE_OPERATIONS-asf901:44530-0] util.FSTableDescriptors(624): Updated tableinfo=hdfs://localhost:34588/user/jenkins/hbase/data/hbase/namespace/.tabledesc/.tableinfo.0000000002
2014-09-15 20:33:29,412 DEBUG [MASTER_TABLE_OPERATIONS-asf901:44530-0] master.TableStateManager(197): Table hbase:namespace written descriptor for state ENABLED
2014-09-15 20:33:29,412 DEBUG [MASTER_TABLE_OPERATIONS-asf901:44530-0] master.TableStateManager(199): Table hbase:namespace updated state to ENABLED
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now my Q is this.&lt;br/&gt;
During master init we create the ns table, if it is not there, and wait in a while loop until the ns table is available (region opened) ( See TableNamespaceManager#start())   Can this loop check for the ns table active state also? &lt;/p&gt;</comment>
                            <comment id="14135066" author="anoop.hbase" created="Tue, 16 Sep 2014 06:51:26 +0000"  >&lt;p&gt;Any recent change in the AM side which changes the order/way in changing the data structure (states) in the HMaster side memory?  We didn&apos;t see these failures till last week I think. Any ideas?&lt;/p&gt;</comment>
                            <comment id="14135140" author="anoop.hbase" created="Tue, 16 Sep 2014 08:35:34 +0000"  >&lt;p&gt;HMaster#createTable()&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; namespace = hTableDescriptor.getTableName().getNamespaceAsString();
getNamespaceDescriptor(namespace); &lt;span class=&quot;code-comment&quot;&gt;// ensure namespace exists&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We can even avoid this ns check when the table ns is System or default. Those are in built ns and no one can remove them also.&lt;/p&gt;</comment>
                            <comment id="14136240" author="stack" created="Tue, 16 Sep 2014 21:13:59 +0000"  >&lt;p&gt;Thanks Anoop for digging in.  Yeah, this is failing a bunch now... ns is not availble or acl is not available.  Timedout waiting on table to come up.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt; This because we moved meta off master?&lt;/p&gt;</comment>
                            <comment id="14136251" author="jxiang" created="Tue, 16 Sep 2014 21:20:39 +0000"  >&lt;p&gt;Which test is it? Do we see this in branch 1 or master?&lt;/p&gt;</comment>
                            <comment id="14136270" author="jxiang" created="Tue, 16 Sep 2014 21:30:03 +0000"  >&lt;p&gt;Looks like standalone master based on the log. It is unlikely related to moving meta off master. Could it relate to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7767&quot; title=&quot;Get rid of ZKTable, and table enable/disable state in ZK &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7767&quot;&gt;&lt;del&gt;HBASE-7767&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can this loop check for the ns table active state also?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This should help.&lt;/p&gt;</comment>
                            <comment id="14136285" author="stack" created="Tue, 16 Sep 2014 21:36:46 +0000"  >&lt;p&gt;Trunk has the worst case of it. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14136299" author="stack" created="Tue, 16 Sep 2014 21:44:17 +0000"  >&lt;p&gt;Let me look at this since I&apos;ve been committing of late!&lt;/p&gt;</comment>
                            <comment id="14136493" author="stack" created="Tue, 16 Sep 2014 23:30:49 +0000"  >&lt;p&gt;Chatting with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt;, there is something up w/ the isEnabled in HMaster#checkNamespaceManagerReady which calls through to isTableAvailableAndInitialized&lt;/p&gt;

&lt;p&gt;Here is some debug that has ns wait on being ENABLED.  If it ain&apos;t ENABLED, thats a prob.&lt;/p&gt;</comment>
                            <comment id="14136497" author="stack" created="Tue, 16 Sep 2014 23:32:46 +0000"  >&lt;p&gt;Pushed out the patch to master where we seem to be seeing most fails.  See if it tells us anything.&lt;/p&gt;</comment>
                            <comment id="14136621" author="hudson" created="Wed, 17 Sep 2014 01:18:31 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5516 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5516/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5516/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11988&quot; title=&quot;AC/VC system table create on postStartMaster fails too often in test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11988&quot;&gt;&lt;del&gt;HBASE-11988&lt;/del&gt;&lt;/a&gt; AC/VC system table create on postStartMaster fails too often in test; ADD DEBUG (stack: rev fc97a1b34c9cd9d5c18758b31712b6e0fe99ac9c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/TableNamespaceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14136670" author="anoop.hbase" created="Wed, 17 Sep 2014 02:20:46 +0000"  >&lt;p&gt;During master start the ns table create time we wait for the table region to be available in online regions. We wait till then. As I said, IMO we must wait for region ENABLED also. (There is a gap btw this getting marked enabled in master data structures)   But again these waits are timeout based.  So still there is some chance that the time out elapsed and master continue with its start with out waiting for NS. Then the AC/VC startup will fail create their tables.!   That is because of check in HMaster#createTable() where we just try to see the specified ns is valid or not. Well IMO we can skip this part also when the specified ns is system/default. Those are system based and will be there always.   &lt;/p&gt;</comment>
                            <comment id="14136673" author="anoop.hbase" created="Wed, 17 Sep 2014 02:22:41 +0000"  >&lt;p&gt;Patch with proposed 2 changes.  We could have get this issue on AC/VC table create any time. The wait for ns table up is timeout based. If by chance that takes longer, we could have failed AC/VC table creates.   So will be better to fix that part any way.&lt;/p&gt;</comment>
                            <comment id="14136703" author="stack" created="Wed, 17 Sep 2014 03:09:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;As I said, IMO we must wait for region ENABLED also. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The debug patch I committed this afternoon added this.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But again these waits are timeout based. So still there is some chance that the time out elapsed and master continue with its start with out waiting for NS.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The debug patch actually throws and exception now so we should fail startup.  We can&apos;t progress w/o ns table (I upped the timeout too to 5mins).&lt;/p&gt;

&lt;p&gt;I think your patch is similar to the debug patch  &amp;#8211; the waiting on enabled bit is at least &amp;#8211; but we probably need to step back and think through all these system tables and what it takes getting a cluster off the ground especially if we have interesting scenarios like a splitting meta.&lt;/p&gt;

&lt;p&gt;Good on you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoopsamjohn&quot; class=&quot;user-hover&quot; rel=&quot;anoopsamjohn&quot;&gt;Anoop Sam John&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="14136740" author="hadoopqa" created="Wed, 17 Sep 2014 04:04:23 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12669305/HBASE-11988.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12669305/HBASE-11988.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12669305&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 2 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 1 new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestSecureLoadIncrementalHFiles&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10936//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14136752" author="anoop.hbase" created="Wed, 17 Sep 2014 04:19:58 +0000"  >&lt;p&gt;Oh.. Thanks boss.. I haven&apos;t read your patch.  So let us see now how the tests behaves&lt;/p&gt;</comment>
                            <comment id="14136756" author="anoop.hbase" created="Wed, 17 Sep 2014 04:27:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;The debug patch actually throws and exception now so we should fail startup. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Looks good. 5 mns wait and then throw IOE so as to fail the startup is a good option.&lt;/p&gt;</comment>
                            <comment id="14136759" author="anoop.hbase" created="Wed, 17 Sep 2014 04:28:25 +0000"  >&lt;p&gt;We should get this to other versions also IMO. What do u think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="14136782" author="stack" created="Wed, 17 Sep 2014 05:08:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt; I suppose so, that would make sense.  i think our workings hereabouts was recently &apos;disturbed&apos; by the nice patch that moves table enabled/disable state from zk to instead keep it in the fs as part of the table descriptor under the table dir.  Some &apos;rates&apos; probably changed.  Oh, and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt; noticed that this change added an isTableEnabled when checking if ns available... which might have brought this on more frequently.&lt;/p&gt;

&lt;p&gt;Lets see how this patch does a while.  Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14137296" author="anoop.hbase" created="Wed, 17 Sep 2014 14:15:56 +0000"  >&lt;p&gt;Again seeing failures in Visibility related test cases&lt;br/&gt;
See here &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10940//testReport/org.apache.hadoop.hbase.security.visibility/TestEnforcingScanLabelGenerator/org_apache_hadoop_hbase_security_visibility_TestEnforcingScanLabelGenerator/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10940//testReport/org.apache.hadoop.hbase.security.visibility/TestEnforcingScanLabelGenerator/org_apache_hadoop_hbase_security_visibility_TestEnforcingScanLabelGenerator/&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.AssertionError: Timed out waiting for table to become available and enabled hbase:labels
	at org.junit.Assert.fail(Assert.java:88)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But going through the logs, there is no issue at labels table create time(like we saw).&lt;/p&gt;

&lt;p&gt;Checking the code in HBaseTestingUtility#waitTableEnabled(Admin admin, byte[] table, long timeoutMillis), I think now an old issue in code has came out!&lt;/p&gt;
</comment>
                            <comment id="14137297" author="anoop.hbase" created="Wed, 17 Sep 2014 14:16:41 +0000"  >&lt;p&gt;How abt this change?&lt;/p&gt;</comment>
                            <comment id="14137582" author="stack" created="Wed, 17 Sep 2014 17:20:17 +0000"  >&lt;p&gt;Oh. Thats kinda dumb.  We weren&apos;t waiting at all? Good one &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14138159" author="mantonov" created="Wed, 17 Sep 2014 22:54:28 +0000"  >&lt;p&gt;The yesterday-committed patch didn&apos;t seem to help, I &apos;ve seen a lot of failures on our internal jenkins. Going to apply locally last patch and see how it goes.&lt;/p&gt;</comment>
                            <comment id="14138407" author="anoop.hbase" created="Thu, 18 Sep 2014 02:18:56 +0000"  >&lt;p&gt;Both patch together should help &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mantonov&quot; class=&quot;user-hover&quot; rel=&quot;mantonov&quot;&gt;Mikhail Antonov&lt;/a&gt;.&lt;br/&gt;
Going to commit the patch for HBaseTestingUtility to master now.&lt;br/&gt;
We can commit both patches to other branches once we see stable master test results.  Thanks Stack&lt;/p&gt;</comment>
                            <comment id="14138412" author="anoop.hbase" created="Thu, 18 Sep 2014 02:26:49 +0000"  >&lt;p&gt;Pushed second patch to master.&lt;/p&gt;</comment>
                            <comment id="14138414" author="anoop.hbase" created="Thu, 18 Sep 2014 02:28:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;We weren&apos;t waiting at all&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes we were not waiting for the time gap btw a table region become available and table become active. I think with the recent changes (write to FS) this time gap become more and that is why we met with this. &lt;/p&gt;</comment>
                            <comment id="14138516" author="hudson" created="Thu, 18 Sep 2014 05:12:34 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5520 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5520/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5520/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11988&quot; title=&quot;AC/VC system table create on postStartMaster fails too often in test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11988&quot;&gt;&lt;del&gt;HBASE-11988&lt;/del&gt;&lt;/a&gt; AC/VC system table create on postStartMaster fails too often in test. (anoopsamjohn: rev 6a5763673ce8bf414bc0a84d6ac9dfb8d51daa19)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14138895" author="anoop.hbase" created="Thu, 18 Sep 2014 13:08:30 +0000"  >&lt;p&gt;I think the test issues with AC/VC tests are solved now. Got a QA run with out any failures over &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11874&quot; title=&quot;Support Cell to be passed to StoreFile.Writer rather than KeyValue&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11874&quot;&gt;&lt;del&gt;HBASE-11874&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
Suggest we commit both patches to 0.98 and branch-1.&lt;br/&gt;
Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14141520" author="enis" created="Fri, 19 Sep 2014 23:15:30 +0000"  >&lt;p&gt;This looks good for branch-1 as well. &lt;/p&gt;</comment>
                            <comment id="14141525" author="stack" created="Fri, 19 Sep 2014 23:18:05 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; It won&apos;t go in clean, not till &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7767&quot; title=&quot;Get rid of ZKTable, and table enable/disable state in ZK &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7767&quot;&gt;&lt;del&gt;HBASE-7767&lt;/del&gt;&lt;/a&gt; goes in which hopefully we can backport.  I&apos;m testing &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7767&quot; title=&quot;Get rid of ZKTable, and table enable/disable state in ZK &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7767&quot;&gt;&lt;del&gt;HBASE-7767&lt;/del&gt;&lt;/a&gt; to make sure it self-migrates cleanly first.&lt;/p&gt;</comment>
                            <comment id="14141730" author="stack" created="Sat, 20 Sep 2014 03:56:58 +0000"  >&lt;p&gt;Combined patch.  Half of my debug patch and all of the important &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt; fix.&lt;/p&gt;</comment>
                            <comment id="14141733" author="stack" created="Sat, 20 Sep 2014 04:01:06 +0000"  >&lt;p&gt;For 0.98, I committed the anoop fix only (had to jigger it in)  Here is the patch.&lt;/p&gt;</comment>
                            <comment id="14141734" author="stack" created="Sat, 20 Sep 2014 04:01:26 +0000"  >&lt;p&gt;Commiitted versions to 0.98+.&lt;/p&gt;</comment>
                            <comment id="14141735" author="hadoopqa" created="Sat, 20 Sep 2014 04:02:05 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12670179/11988.098.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12670179/11988.098.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12670179&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11001//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11001//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14141804" author="hudson" created="Sat, 20 Sep 2014 06:44:01 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #211 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/211/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/211/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11988&quot; title=&quot;AC/VC system table create on postStartMaster fails too often in test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11988&quot;&gt;&lt;del&gt;HBASE-11988&lt;/del&gt;&lt;/a&gt; AC/VC system table create on postStartMaster fails too often in test (stack: rev 22320eeba01b38c920871afd183b09baeb0e27d2)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/TableNamespaceManager.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14141811" author="hudson" created="Sat, 20 Sep 2014 06:57:43 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98 #530 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/530/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/530/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11988&quot; title=&quot;AC/VC system table create on postStartMaster fails too often in test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11988&quot;&gt;&lt;del&gt;HBASE-11988&lt;/del&gt;&lt;/a&gt; AC/VC system table create on postStartMaster fails too often in test (stack: rev 48c32bcb43a0371c943ebc79ae749911daed00e0)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14141878" author="hudson" created="Sat, 20 Sep 2014 08:47:16 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #506 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/506/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/506/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11988&quot; title=&quot;AC/VC system table create on postStartMaster fails too often in test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11988&quot;&gt;&lt;del&gt;HBASE-11988&lt;/del&gt;&lt;/a&gt; AC/VC system table create on postStartMaster fails too often in test (stack: rev 48c32bcb43a0371c943ebc79ae749911daed00e0)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14142025" author="anoop.hbase" created="Sat, 20 Sep 2014 15:03:12 +0000"  >&lt;p&gt;Thanks Stack&lt;/p&gt;</comment>
                            <comment id="14331532" author="enis" created="Sat, 21 Feb 2015 23:41:41 +0000"  >&lt;p&gt;Closing this issue after 0.99.1 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12670179" name="11988.098.txt" size="1349" author="stack" created="Sat, 20 Sep 2014 04:01:06 +0000"/>
                            <attachment id="12670178" name="11988.branch-1.txt" size="3236" author="stack" created="Sat, 20 Sep 2014 03:56:58 +0000"/>
                            <attachment id="12669260" name="11988.debug.txt" size="2521" author="stack" created="Tue, 16 Sep 2014 23:30:49 +0000"/>
                            <attachment id="12669405" name="HBaseTestingUtility.patch" size="1109" author="anoop.hbase" created="Wed, 17 Sep 2014 14:16:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Sep 2014 21:13:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20307:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>