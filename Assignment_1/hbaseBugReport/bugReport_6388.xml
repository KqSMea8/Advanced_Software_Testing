<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:36:19 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6388/HBASE-6388.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6388] Avoid potential data loss if the flush fails during regionserver shutdown</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6388</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;During a controlled shutdown, Regionserver deletes HLogs even if HRegion.close() fails. We should not be doing this.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12598651">HBASE-6388</key>
            <summary>Avoid potential data loss if the flush fails during regionserver shutdown</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="amitanand">Amitanand Aiyer</assignee>
                                    <reporter username="amitanand">Amitanand Aiyer</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Jul 2012 00:33:53 +0000</created>
                <updated>Sun, 24 Mar 2013 05:21:25 +0000</updated>
                            <resolved>Wed, 6 Mar 2013 23:11:44 +0000</resolved>
                                    <version>0.89-fb</version>
                                    <fixVersion>0.89-fb</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13465998" author="stack" created="Fri, 28 Sep 2012 23:16:26 +0000"  >&lt;p&gt;// closes... port forward from 0.89fb&lt;/p&gt;</comment>
                            <comment id="13466105" author="stack" created="Sat, 29 Sep 2012 04:15:04 +0000"  >&lt;p&gt;Making this critical for inclusion.&lt;/p&gt;</comment>
                            <comment id="13468329" author="ram_krish" created="Wed, 3 Oct 2012 04:30:36 +0000"  >&lt;p&gt;Can i work on forward porting this if no one has yet started the forward port ?&lt;/p&gt;</comment>
                            <comment id="13468334" author="stack" created="Wed, 3 Oct 2012 04:46:29 +0000"  >&lt;p&gt;Be my guest Ram.  It looks promising fixing possible bug and then making shutdown faster w/ parallelizing closes.&lt;/p&gt;</comment>
                            <comment id="13468532" author="ram_krish" created="Wed, 3 Oct 2012 12:42:52 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.killed &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fsOk) {
      waitOnAllRegionsToClose(abortRequested);
      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;stopping server &quot;&lt;/span&gt; + &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.serverNameFromMasterPOV +
        &lt;span class=&quot;code-quote&quot;&gt;&quot;; all regions closed.&quot;&lt;/span&gt;);
    }

    &lt;span class=&quot;code-comment&quot;&gt;//fsOk flag may be changed when closing regions &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; exception.
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.killed &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fsOk) {
      closeWAL(abortRequested ? &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think WAL closing is fine but the closing is not done parallel here.  Do we need to address parallelizing closes alone then? What you feel Stack?&lt;/p&gt;</comment>
                            <comment id="13468666" author="stack" created="Wed, 3 Oct 2012 16:56:50 +0000"  >&lt;p&gt;Then I must be thinking of another issue Ram.  Do you find merit in this patch?  If so, lets forward port and get it in.  Thanks.&lt;/p&gt;</comment>
                            <comment id="13553337" author="yuzhihong@gmail.com" created="Tue, 15 Jan 2013 00:32:21 +0000"  >&lt;p&gt;In HRegionServer#closeRegion(), we have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (region.isMetaRegion()) {
      crh = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CloseMetaHandler(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, region, abort, zk,
        versionOfClosingNode);
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      crh = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CloseRegionHandler(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, region, abort, zk, versionOfClosingNode, sn);
    }
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.service.submit(crh);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Looks like we parallelize region closing in trunk already.&lt;/p&gt;</comment>
                            <comment id="13554237" author="devaraj" created="Tue, 15 Jan 2013 19:40:27 +0000"  >&lt;p&gt;I am marking this for 0.89fb. I inspected the code, and indeed this problem doesn&apos;t seem to be in trunk. On a region close failure, the RS aborts. Also, as Ted noted, the region close is done in parallel. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amitanand&quot; class=&quot;user-hover&quot; rel=&quot;amitanand&quot;&gt;Amitanand Aiyer&lt;/a&gt;, please close the issue if the fix has been committed to 0.89..&lt;/p&gt;</comment>
                            <comment id="13611984" author="amitanand" created="Sun, 24 Mar 2013 05:21:25 +0000"  >&lt;p&gt;Diff at &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=r1361429&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=r1361429&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12547075" name="0001-HBASE-6388-89-fb-parallelize-close-and-avoid-deletin.patch" size="8115" author="stack" created="Fri, 28 Sep 2012 23:16:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 28 Sep 2012 23:16:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240857</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 38 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i016kv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4835</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>