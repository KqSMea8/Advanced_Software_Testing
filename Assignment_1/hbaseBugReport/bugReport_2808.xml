<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:04:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2808/HBASE-2808.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2808] Document the implementation of replication</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2808</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;From &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2223&quot; title=&quot;Handle 10min+ network partitions between clusters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2223&quot;&gt;&lt;del&gt;HBASE-2223&lt;/del&gt;&lt;/a&gt;, we need to provide an overview of how replication was implemented. For example:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;How ZK is used&lt;/li&gt;
	&lt;li&gt;What are the general flows&lt;/li&gt;
	&lt;li&gt;How failover works&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12468281">HBASE-2808</key>
            <summary>Document the implementation of replication</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdcryans">Jean-Daniel Cryans</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Jun 2010 19:22:21 +0000</created>
                <updated>Fri, 20 Nov 2015 12:43:15 +0000</updated>
                            <resolved>Wed, 14 Jul 2010 22:13:57 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                    <component>documentation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12886535" author="jdcryans" created="Thu, 8 Jul 2010 22:43:46 +0000"  >&lt;p&gt;First draft of the documentation, the page refers to the attached image.&lt;/p&gt;</comment>
                            <comment id="12886957" author="jdcryans" created="Sat, 10 Jul 2010 00:23:25 +0000"  >&lt;p&gt;Fixed grammatical errors and such.&lt;/p&gt;</comment>
                            <comment id="12887938" author="stack" created="Tue, 13 Jul 2010 19:11:21 +0000"  >&lt;p&gt;Great doc.  Here are some comments:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Awkward phrasing -&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;.. and can contribute to enable high availability&quot;&lt;/span&gt;
Not really sure what you are trying to say so no suggested alternative

Is &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; master cluster or hbase master -&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;replication is master-push;...&quot;&lt;/span&gt;

I don&apos;t get &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; bit -&amp;gt;

&quot;it is much easier to keep track of what&apos;s currently being replicated since
+        each region server has its own write-ahead-log (aka WAL or HLog), compared
+        to other well known solutions like MySQL master/slave replication where
+        there&apos;s only one bin log to keep track of.
&quot;

Whats easier?  I&apos;d think mysql is easier?


Leave out the &apos;that&apos; in the following: &lt;span class=&quot;code-quote&quot;&gt;&quot;and that rows inserted&quot;&lt;/span&gt;

Can you cite a link &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;  -&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;MySQL&apos;s statement-based replication&quot;&lt;/span&gt; that expliains mysql statement-based replication?

Something missing here.... &lt;span class=&quot;code-quote&quot;&gt;&quot;Put and Delete) are replicated in order maintain atomicity.&quot;&lt;/span&gt;

Say who does the transform... &lt;span class=&quot;code-quote&quot;&gt;&quot;The key values are transformed into a WALEdit which is..&quot;&lt;/span&gt;

Say more what &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; means -&amp;gt; &quot; (that is, that are part +          of a family scoped GLOBAL and non-catalog).
&quot;

Reassure reader that &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is being done &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; them by the server, they have to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; nothing but config.

Synchronously, the region server that receives the edits reads them
+          sequentially and applies them on its local cluster using a pool of
+          HTables. If consecutive rows belong to the same table, they are
+          inserted together in order to leverage parallel insertions.
Explain that RS is running a client and may be inserting across its cluster when you say &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; -&amp;gt;  &quot;


 Logs that are archived will update their paths in the
+          in-memory queue of the replicating thread.
&lt;span class=&quot;code-quote&quot;&gt;&quot;I tihnk you need to explain archiving.... &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;  confusion -&amp;gt; &quot;&lt;/span&gt;

What is a &lt;span class=&quot;code-quote&quot;&gt;&quot;cluster key&quot;&lt;/span&gt;?

What is &lt;span class=&quot;code-quote&quot;&gt;&quot;available sinks&quot;&lt;/span&gt;?


For example, &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; a slave
+          cluster has 150 machines, 15 will be chosen as potential sinks &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
+          master RS.
You mean &apos;hosts &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; clients running in the slave cluster&apos; when you say following?  &quot;

In above I think you have to say master cluster RS rather than just &apos;master RS&apos; because master usually refers to something &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; in our parlance.

Since &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is done by all master RSs, the probability that
+          all slave RSs are used is very high, and &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; method works &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; clusters
+          of any size.
I don&apos;t follow .... is &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; where many master clusters replicating into a single slave?  &quot;


SHould be &apos;these&apos; instead of &apos;those&apos; in following &lt;span class=&quot;code-quote&quot;&gt;&quot;and each of those contain &quot;&lt;/span&gt;

You could expand... saying that &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; multiple slave clusters, then we&apos;ll have a znode per when you say &lt;span class=&quot;code-quote&quot;&gt;&quot;znode per peer cluster&quot;&lt;/span&gt;

Each of those queues will track the HLogs created
+          by that RS, but they can differ in size. For example, &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; one slave
+          cluster becomes unavailable &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; some time then the HLogs cannot be,
+          thus they need to stay in the queue (&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; the others are processed).
&lt;span class=&quot;code-quote&quot;&gt;&quot;This needs fixup... hard to figure what is being said: &quot;&lt;/span&gt;

Whats &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; -&amp;gt;  &lt;span class=&quot;code-quote&quot;&gt;&quot;slave cluster&apos;s znode just before it&apos;s made available.&quot;&lt;/span&gt;

Does &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; mean we lose edits?  &quot;
The queue items are deleted when the replication thread cannot read
+          more entries from a file and that there are other files in the queue.
&quot;

Whats &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; mean?  &quot;
or because there&apos;s
+          too many of them)

When would we archive because too many?

&quot;it will notify the source threads that the path
+          &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; that log changed. 
Why does it have to notify that log dir has changed?  If not in one location, can&apos;t we check archive area w/o requiring notification?  

&quot;


GLOBAL means replicate?  Any provision to replicate only to cluster X and not to cluster Y?  or is that &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; later?

Explain catalog table

You need a bulk edit shipper?  Something that allows you transfer 64MB of edits in one go?

Is it a mistake that WALEdit doesn&apos;t carry Put and Delete objects, that we have to reinstantiate not only replicating but when replaying edits?  Should we make an issue to fix?

Say what these could be?  
Note that &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the master and slave cluster don&apos;t have the same
+          time, time-related issues may occur.
&quot;

Why?  ain&apos;t the ts in the edit?
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12888039" author="stack" created="Tue, 13 Jul 2010 22:04:27 +0000"  >&lt;p&gt;Oh, one other thing, lets not use xdoc going forward.  It was dumbass the day it was written and going forward, is second class in maven w/ the apt format taking precedence.  We&apos;ll figure this better soon but goal is a format for articles that can easily be dumped into the hbase &apos;book&apos; going forward.&lt;/p&gt;</comment>
                            <comment id="12888204" author="jdcryans" created="Wed, 14 Jul 2010 05:37:39 +0000"  >&lt;p&gt;Patch v3 addresses most comments and refreshes the package.html doc. Few other issues explained here:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;GLOBAL means replicate?  Any provision to replicate only to cluster X and not to cluster Y?  or is that for later?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Much much later, there&apos;s a jira for that IIRC.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;You need a bulk edit shipper?  Something that allows you transfer 64MB of edits in one go&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;CopyTable has that intention, else by default replication ships max 64MB of data.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is it a mistake that WALEdit doesn&apos;t carry Put and Delete objects, that we have to reinstantiate not only replicating but when replaying edits?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;AFAIK there&apos;s an issue or two for that.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Why?  ain&apos;t the ts in the edit?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Suppose an edit to cell X happens in a EST cluster, then 2 minutes later a new edits happens to the same cell in a PST cluster and that both clusters are in a master-master replication. The second edit is considered younger, so the first will always hide it while in fact the second is older.&lt;/p&gt;</comment>
                            <comment id="12888414" author="stack" created="Wed, 14 Jul 2010 16:18:25 +0000"  >&lt;p&gt;Ok.  Go ahead and commit then I&apos;d say.  (You added note on why clusters need to be in-sync timewise?)  Let me know if I can help w/ the image inclusion.&lt;/p&gt;</comment>
                            <comment id="12888572" author="jdcryans" created="Wed, 14 Jul 2010 22:13:56 +0000"  >&lt;p&gt;Committed to trunk, I added a small FAQ with Stack&apos;s questions.&lt;/p&gt;</comment>
                            <comment id="15017472" author="lars_francke" created="Fri, 20 Nov 2015 12:43:15 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12456177">HBASE-2223</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12449141" name="HBASE-2808-v2.patch" size="20641" author="jdcryans" created="Sat, 10 Jul 2010 00:23:25 +0000"/>
                            <attachment id="12449419" name="HBASE-2808-v3.patch" size="28995" author="jdcryans" created="Wed, 14 Jul 2010 05:37:39 +0000"/>
                            <attachment id="12449025" name="HBASE-2808.patch" size="20563" author="jdcryans" created="Thu, 8 Jul 2010 22:43:45 +0000"/>
                            <attachment id="12449026" name="replication_overview.png" size="207537" author="jdcryans" created="Thu, 8 Jul 2010 22:43:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Jul 2010 19:11:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32779</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hjc7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100395</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>