<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:52:48 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1352/HBASE-1352.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1352] incrementColumnValue/Memcache bug</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1352</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When I do a large amount of incrementColumnValue(), I got NullPointerException thrown from Memcache.java:&lt;/p&gt;

&lt;p&gt;2009-04-27 14:59:03,620 INFO org.apache.hadoop.ipc.HBaseServer: IPC Server handler 1 on 59710, call incrementColumnValue([B@1317bfb, [B@1c2a074, [B@b427c1, 1) from 127.0.0.1:52296: error: java.io.IOException: java.lang.NullPointerException&lt;br/&gt;
java.io.IOException: java.lang.NullPointerException&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Memcache.get(Memcache.java:609)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Memcache.get(Memcache.java:244)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Memcache.get(Memcache.java:226)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.incrementColumnValue(HRegion.java:2636)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.incrementColumnValue(HRegionServer.java:2299)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor13.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:632)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:912)&lt;br/&gt;
(called from thrift interface)&lt;/p&gt;

&lt;p&gt;I consistently hit this exception after restarting Hbase (exactly the same location in my code)&lt;/p&gt;

&lt;p&gt;Quick fix is (with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1319&quot; title=&quot;Bug in atomicIncrement 0.19.1 only&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1319&quot;&gt;&lt;del&gt;HBASE-1319&lt;/del&gt;&lt;/a&gt;.patch applied) at Memcache.java:609, say if (deletes != null) deletes.add(itKey);&lt;/p&gt;

&lt;p&gt;but probably better to change Memcache.java:226. Also the trunk already changed the StoreKey format and doesn&apos;t have this bug.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 8.10&lt;/p&gt;</environment>
        <key id="12423948">HBASE-1352</key>
            <summary>incrementColumnValue/Memcache bug</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="atppp">atppp</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Apr 2009 22:36:43 +0000</created>
                <updated>Sun, 13 Sep 2009 22:31:26 +0000</updated>
                            <resolved>Sun, 3 May 2009 21:27:42 +0000</resolved>
                                    <version>0.19.1</version>
                                    <fixVersion>0.19.2</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12703530" author="stack" created="Tue, 28 Apr 2009 08:02:44 +0000"  >&lt;p&gt;Attach a patch and I&apos;ll apply it.  Thanks.&lt;/p&gt;</comment>
                            <comment id="12703912" author="stack" created="Wed, 29 Apr 2009 00:32:48 +0000"  >&lt;p&gt;How about this instead of creating new Map:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: src/java/org/apache/hadoop/hbase/regionserver/Memcache.java
===================================================================
--- src/java/org/apache/hadoop/hbase/regionserver/Memcache.java (revision 768432)
+++ src/java/org/apache/hadoop/hbase/regionserver/Memcache.java (working copy)
@@ -606,7 +606,7 @@
           }
         } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
           &lt;span class=&quot;code-comment&quot;&gt;// Cell holds a delete value.
&lt;/span&gt;-          deletes.add(itKey);
+          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (deletes != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) deletes.add(itKey);
         }
       } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
         &lt;span class=&quot;code-comment&quot;&gt;// By L.N. HBASE-684, map is sorted, so we can&apos;t find match any more.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12703918" author="atppp" created="Wed, 29 Apr 2009 00:41:59 +0000"  >&lt;p&gt;That fixes the problem. In fact this was what I proposed initially too and tested.&lt;/p&gt;

&lt;p&gt;But I was worried that extra checking slows down other calls, also the trunk code creates new Map too when deletes is not passed. That&apos;s why I changed line 226 instead in the uploaded patch.&lt;/p&gt;

&lt;p&gt;Either way is fine.... I prefer stack&apos;s fix because it feels safer...&lt;/p&gt;</comment>
                            <comment id="12705448" author="stack" created="Sun, 3 May 2009 21:27:42 +0000"  >&lt;p&gt;Committed above test for null.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12406664" name="HBASE-1352.patch" size="638" author="atppp" created="Tue, 28 Apr 2009 17:07:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 28 Apr 2009 08:02:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25709</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 33 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hcqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99327</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>