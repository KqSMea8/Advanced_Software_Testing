<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:49:31 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7838/HBASE-7838.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7838] HBase regionserver never stops when running `hbase-daemon.sh stop regionserver`</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7838</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Currently running full stack (Hadoop + Hbase + zookeeper) on a VM I want to reboot, every services stopped but HBase regionserver. For 2 days now, it&apos;s aligning dots on the console ...&lt;br/&gt;
I propose a timeout (default 600 overidable by $HBASE_STOP_TIMEOUT) to force kill -9 on the process.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Using CDH4.1.2&lt;/p&gt;</environment>
        <key id="12632186">HBASE-7838</key>
            <summary>HBase regionserver never stops when running `hbase-daemon.sh stop regionserver`</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dam_ned">Damien Hardy</assignee>
                                    <reporter username="dam_ned">Damien Hardy</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Feb 2013 10:57:49 +0000</created>
                <updated>Tue, 5 Aug 2014 20:12:36 +0000</updated>
                            <resolved>Tue, 23 Apr 2013 20:13:54 +0000</resolved>
                                    <version>0.92.1</version>
                    <version>0.94.4</version>
                    <version>0.95.2</version>
                                    <fixVersion>0.95.1</fixVersion>
                                    <component>regionserver</component>
                    <component>scripts</component>
                    <component>shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13577506" author="hadoopqa" created="Wed, 13 Feb 2013 12:00:34 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12569175/HBASE-7838.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12569175/HBASE-7838.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4434//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13577518" author="jmspaggi" created="Wed, 13 Feb 2013 12:20:49 +0000"  >&lt;p&gt;+1 with the patch. I have applied the same modifications in 0.94.4 to test it. I will test it with 6s delay because I can&apos;t make my RS taking 600s on this machine.&lt;/p&gt;

&lt;p&gt;While testing 0.94.5, I got 0.94.4 stuck the same way for 24h. (Looping from 0.94.0 to 0.94.5 to do all the PerformanceTests...)&lt;/p&gt;

&lt;p&gt;I think we should push that on 0.94 too.&lt;/p&gt;</comment>
                            <comment id="13577590" author="nkeywal" created="Wed, 13 Feb 2013 14:34:54 +0000"  >&lt;p&gt;+1 as well. There are some typos that I can fix on commit. I will commit on trunk tomorrow if there is no objection, with 900s for the timeout.&lt;/p&gt;

&lt;p&gt;6s is not safe, especially for 0.94: you need to close your resources and tell to the master/zk that you&apos;re leaving. 900s is safer because it&apos;s over the 630s needed by HDFS when things go crazy. May be 1200s would be even safer, especially if we want it for 0.94.&lt;/p&gt;</comment>
                            <comment id="13577596" author="jmspaggi" created="Wed, 13 Feb 2013 14:42:14 +0000"  >&lt;p&gt;I tried with 6s to make sure the script tried to kill the RS. But I totally agree, we should no go under 600, and 1200s also is still fine since today it&apos;s sometime taking 24h...&lt;/p&gt;

&lt;p&gt;Damien, can you produce the patch for 0.94 too?&lt;/p&gt;</comment>
                            <comment id="13577611" author="nkeywal" created="Wed, 13 Feb 2013 14:56:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt; Ok, I misunderstood &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;br/&gt;
Note that the current behavior gives time for the admin to analyze the situation and decide accordingly. For this reason, I&apos;m not sure on the 0.94. It&apos;s a still a behavior change. By default, I&apos;m -0. But it could be committed with a huge default if you really want this to be fixed on 0.94, for example. Then it&apos;s up to the user to change the default. &lt;/p&gt;</comment>
                            <comment id="13577619" author="dam_ned" created="Wed, 13 Feb 2013 15:02:54 +0000"  >&lt;p&gt;this patch applies on 0.94 branch without conflicts reducing diffs between 0.94 and trunk&lt;/p&gt;</comment>
                            <comment id="13577625" author="hadoopqa" created="Wed, 13 Feb 2013 15:12:38 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12569197/HBASE-7838-0.94.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12569197/HBASE-7838-0.94.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4435//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4435//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13577649" author="jmspaggi" created="Wed, 13 Feb 2013 15:38:11 +0000"  >&lt;p&gt;So can we consider applying it on 0.94 with something like a 24h timeout?&lt;/p&gt;</comment>
                            <comment id="13577662" author="nkeywal" created="Wed, 13 Feb 2013 15:49:22 +0000"  >&lt;p&gt;Or 72h, he will have all the week end to think about it :-]&lt;br/&gt;
That would be ok imho, let&apos;s wait for Lars&apos; +1 as it&apos;s 0.94.&lt;/p&gt;</comment>
                            <comment id="13577699" author="dam_ned" created="Wed, 13 Feb 2013 16:45:16 +0000"  >&lt;p&gt;This is a new trunk branch patch change for 900 seconds default as suggested @nkeywal&lt;br/&gt;
+ typos&lt;/p&gt;</comment>
                            <comment id="13577770" author="hadoopqa" created="Wed, 13 Feb 2013 17:48:39 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12569215/HBASE-7838-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12569215/HBASE-7838-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4436//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13578299" author="nkeywal" created="Thu, 14 Feb 2013 11:11:14 +0000"  >&lt;p&gt;Committed to trunk with a timeout of 1200 seconds. I think we should have the same for the 0.94. Waiting for &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; for 0.94.&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Damien. Jean-Marc, thanks for the review and the test.&lt;/p&gt;</comment>
                            <comment id="13578312" author="hudson" created="Thu, 14 Feb 2013 11:57:36 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3879 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3879/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3879/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7838&quot; title=&quot;HBase regionserver never stops when running `hbase-daemon.sh stop regionserver`&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7838&quot;&gt;&lt;del&gt;HBASE-7838&lt;/del&gt;&lt;/a&gt; HBase regionserver never stoping when running  (Damien Hardy) (Revision 1446116)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
nkeywal : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/bin/hbase-daemon.sh&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13578328" author="hudson" created="Thu, 14 Feb 2013 12:43:33 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #407 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/407/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/407/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7838&quot; title=&quot;HBase regionserver never stops when running `hbase-daemon.sh stop regionserver`&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7838&quot;&gt;&lt;del&gt;HBASE-7838&lt;/del&gt;&lt;/a&gt; HBase regionserver never stoping when running  (Damien Hardy) (Revision 1446116)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
nkeywal : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/bin/hbase-daemon.sh&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13578372" author="rajesh23" created="Thu, 14 Feb 2013 13:58:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt;&lt;br/&gt;
Same problem is there in stop-hbase.sh also. Similar fix works there also. Recently we have fixed in our version.&lt;/p&gt;</comment>
                            <comment id="13578420" author="nkeywal" created="Thu, 14 Feb 2013 15:09:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh23&quot; class=&quot;user-hover&quot; rel=&quot;rajesh23&quot;&gt;rajeshbabu&lt;/a&gt;, yeah, I&apos;ve seen it and considered it was a different case, but you&apos;re right. I will push an addendum.&lt;/p&gt;</comment>
                            <comment id="13578433" author="jmspaggi" created="Thu, 14 Feb 2013 15:38:18 +0000"  >&lt;p&gt;If it&apos;s twice the same code, can&apos;t we call hbase-daemon from stop-hbase instead of duplicating the code?&lt;/p&gt;</comment>
                            <comment id="13578477" author="lhofhansl" created="Thu, 14 Feb 2013 16:42:37 +0000"  >&lt;p&gt;Shouldn&apos;t we rather track down why the RS does not stop? Do you have a jstack for the case where it did not shut down?&lt;br/&gt;
I suppose that can happen when you yank HDFS from under the RS before it had a chance to shut itself down.&lt;/p&gt;</comment>
                            <comment id="13578481" author="dam_ned" created="Thu, 14 Feb 2013 16:50:46 +0000"  >&lt;p&gt;Lars &amp;gt;That may be the case for me. The VM was for testing (only one node running full stack) and when I want it to reboot ... every processes stopped well (HDFS NN, DN, ZK, HBase master). Regionserver was the last process trying to stop  ...eternally.&lt;/p&gt;

&lt;p&gt;This VM is gone now, I can&apos;t get traces any more.&lt;/p&gt;</comment>
                            <comment id="13578515" author="jmspaggi" created="Thu, 14 Feb 2013 17:36:34 +0000"  >&lt;p&gt;We can do both &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I can reproduce that easily. I&apos;m facing this issue almost daily... I&apos;m running it in standalone mode, so I don&apos;t think it&apos;S related to HDFS.&lt;/p&gt;

&lt;p&gt;Should we open another JIRA for that and keep this one for the scripts update?&lt;/p&gt;

&lt;p&gt;What will we need to extract from the faulty server? I will start right now to get it fail to stop...&lt;/p&gt;</comment>
                            <comment id="13578802" author="lhofhansl" created="Thu, 14 Feb 2013 23:22:02 +0000"  >&lt;p&gt;A jstack of the hung process would be most useful.&lt;/p&gt;</comment>
                            <comment id="13579081" author="nkeywal" created="Fri, 15 Feb 2013 10:31:57 +0000"  >&lt;p&gt;Imho, there are 4 distinct points.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If seems reasonable to be able to kill 9 automatically the process if it can&apos;t stop by itself. That&apos;s also what we do if memory consumption goes crazy. That&apos;s this JIRA.&lt;/li&gt;
	&lt;li&gt;As JM pointed it out, there is some code duplication in the scripts, and it would be better to have something cleaner. Imho, except if 0.94 backport is not a concern, it&apos;s better to have this in another JIRA, if someone wants to fix it.&lt;/li&gt;
	&lt;li&gt;The root issue (why we can&apos;t stop) deserves a JIRA as well.&lt;/li&gt;
	&lt;li&gt;Lastly, we should have unit tests for the various stop scenarios (during a split, with .meta. regionserver holder shutdown first, ...). This could make it in another JIRA as well.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think it&apos;s reasonable &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, so if nobody disagrees, I will fix the point mentioned by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh23&quot; class=&quot;user-hover&quot; rel=&quot;rajesh23&quot;&gt;rajeshbabu&lt;/a&gt; to close this JIRA for trunk.&lt;br/&gt;
I will also look at the unit tests part to see where we stand on trunk, and I will create some JIRAs if I find something. It will be in my low priority stuff list, so if someone else wants to do it, it&apos;s fine for me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="13579389" author="jmspaggi" created="Fri, 15 Feb 2013 18:26:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; are you going to open all those JIRAs? (code duplication, adding unit tests)&lt;/p&gt;

&lt;p&gt;I will open one if I&apos;m able to reproduce the &quot;can&apos;t stop&quot; issue. I tried yesterday and of course, it was always able to stop. I&apos;m retrying today.&lt;/p&gt;</comment>
                            <comment id="13579428" author="nkeywal" created="Fri, 15 Feb 2013 19:12:28 +0000"  >&lt;p&gt;Adding unit tests: I will, but I will check what is our gap before. No for the others. But feel free to do it, especially if you have the logs or a scenario... Thanks, Jean-Marc.&lt;/p&gt;</comment>
                            <comment id="13579788" author="jmspaggi" created="Sat, 16 Feb 2013 13:49:40 +0000"  >&lt;p&gt;I have created &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7865&quot; title=&quot;HBase regionserver never stops when running `bin/stop-hbase.sh` on master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7865&quot;&gt;&lt;del&gt;HBASE-7865&lt;/del&gt;&lt;/a&gt; for the &quot;can&apos;t stop&quot; issue and will upload the logs there. Thanks.&lt;/p&gt;</comment>
                            <comment id="13582128" author="nkeywal" created="Wed, 20 Feb 2013 11:46:15 +0000"  >&lt;p&gt;I had to put it in a shared function. Just too horrible otherwise. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt;, could you have a look? Thanks a lot.&lt;/p&gt;</comment>
                            <comment id="13582150" author="jmspaggi" created="Wed, 20 Feb 2013 12:44:58 +0000"  >&lt;p&gt;I will apply it and test locally today.&lt;/p&gt;

&lt;p&gt;Should we have not reverted the previous one and applied this one to the previous version?&lt;/p&gt;</comment>
                            <comment id="13582173" author="nkeywal" created="Wed, 20 Feb 2013 13:32:59 +0000"  >&lt;p&gt;Thanks JM.&lt;br/&gt;
The current one does no harm, so there is no reason to revert it imho.&lt;/p&gt;</comment>
                            <comment id="13582177" author="jmspaggi" created="Wed, 20 Feb 2013 13:40:22 +0000"  >&lt;p&gt;I applied the modifications in my local 0.94.5 test environment. Had to apply manually because I did not had the previous patch applied already on 0.94.x. But I applied the patch on 0.94.5 with patch -p0 and applied without any issue&lt;/p&gt;

&lt;p&gt;I tried out of the box and stopped HBase well.&lt;/p&gt;

&lt;p&gt;I changed the default value to 4 seconds and stop-hbase.sh killed the server correctly in the right time. I think it tooks 5 sec instead of 4, but who cares &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I found that way cleaner now.&lt;/p&gt;

&lt;p&gt;So I&apos;m +1 with the patch.&lt;/p&gt;

&lt;p&gt;Can we make sure it goes to 0.94.x too?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="13582194" author="nkeywal" created="Wed, 20 Feb 2013 14:05:51 +0000"  >&lt;p&gt;Thanks for the reviews &amp;amp; test, I will commit to trunk tomorrow and ~Friday for 0.94 if there is no objection.&lt;/p&gt;</comment>
                            <comment id="13582904" author="lhofhansl" created="Thu, 21 Feb 2013 04:29:04 +0000"  >&lt;p&gt;+0 on patch. Just pastes over the actual issue, but good short term measure.&lt;/p&gt;</comment>
                            <comment id="13584210" author="nkeywal" created="Fri, 22 Feb 2013 11:42:48 +0000"  >&lt;p&gt;committed addendum to trunk. Will wait for 0.94.&lt;/p&gt;</comment>
                            <comment id="13584395" author="hudson" created="Fri, 22 Feb 2013 16:25:19 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3891 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3891/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3891/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7838&quot; title=&quot;HBase regionserver never stops when running `hbase-daemon.sh stop regionserver`&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7838&quot;&gt;&lt;del&gt;HBASE-7838&lt;/del&gt;&lt;/a&gt; HBase regionserver never stoping when running hbase-daemon.sh stop regionserver (Damien Hardy) - addendum (Revision 1448997)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
nkeywal : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/bin/hbase-common.sh&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/bin/hbase-daemon.sh&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/bin/stop-hbase.sh&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13584569" author="lhofhansl" created="Fri, 22 Feb 2013 19:19:59 +0000"  >&lt;p&gt;What about JM&apos;s suggestion to take a jstack of the process before we kill -9 it? Otherwise we&apos;ll diminish our chances to identify the root issue.&lt;/p&gt;</comment>
                            <comment id="13584576" author="jmspaggi" created="Fri, 22 Feb 2013 19:26:09 +0000"  >&lt;p&gt;Hi Lars,&lt;/p&gt;

&lt;p&gt;I&apos;m working on that.&lt;/p&gt;

&lt;p&gt;I will open another JIRA and submit the patch. I agree that keep the jstack trace each time we have to do a kill -9 will be usefull to track potential issues. &lt;/p&gt;</comment>
                            <comment id="13585009" author="hudson" created="Sat, 23 Feb 2013 05:26:52 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #416 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/416/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/416/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7838&quot; title=&quot;HBase regionserver never stops when running `hbase-daemon.sh stop regionserver`&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7838&quot;&gt;&lt;del&gt;HBASE-7838&lt;/del&gt;&lt;/a&gt; HBase regionserver never stoping when running hbase-daemon.sh stop regionserver (Damien Hardy) - addendum (Revision 1448997)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
nkeywal : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/bin/hbase-common.sh&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/bin/hbase-daemon.sh&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/bin/stop-hbase.sh&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13621413" author="stack" created="Wed, 3 Apr 2013 22:17:44 +0000"  >&lt;p&gt;This was integrated into trunk a while ago.&lt;/p&gt;</comment>
                            <comment id="13621454" author="stack" created="Wed, 3 Apr 2013 22:44:14 +0000"  >&lt;p&gt;Lars is +0 on backporting this to 0.94 so I won&apos;t file an issue for backporting it.&lt;/p&gt;</comment>
                            <comment id="13639561" author="stack" created="Tue, 23 Apr 2013 20:13:54 +0000"  >&lt;p&gt;Re-resovling.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; Reopen if I am closing this prematurely.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12570113" name="7838.addendum.v1.patch" size="4396" author="nkeywal" created="Wed, 20 Feb 2013 11:43:00 +0000"/>
                            <attachment id="12569197" name="HBASE-7838-0.94.patch" size="1324" author="dam_ned" created="Wed, 13 Feb 2013 15:02:54 +0000"/>
                            <attachment id="12569215" name="HBASE-7838-trunk.patch" size="983" author="dam_ned" created="Wed, 13 Feb 2013 16:45:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 13 Feb 2013 12:00:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>312682</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 34 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1hykf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>313028</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Add timeout (default 1200 seconds) on stopping services with hbase-daemon.sh. The timeout is configurable with the environment variable HBASE_STOP_TIMEOUT.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>