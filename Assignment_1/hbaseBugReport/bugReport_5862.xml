<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:31:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5862/HBASE-5862.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5862] After Region Close remove the Operation Metrics.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5862</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If a region is closed then Hadoop metrics shouldn&apos;t still be reporting about that region.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12552202">HBASE-5862</key>
            <summary>After Region Close remove the Operation Metrics.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eclark">Elliott Clark</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Apr 2012 21:23:56 +0000</created>
                <updated>Wed, 18 Sep 2013 22:15:27 +0000</updated>
                            <resolved>Thu, 26 Apr 2012 18:02:52 +0000</resolved>
                                                    <fixVersion>0.94.0</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13260011" author="zhihyu@ebaysf.com" created="Mon, 23 Apr 2012 22:11:47 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void closeMetrics() {
+    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; m:metricsPut) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please insert spaces around the colon above.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      RegionMetricsStorage.deleteTimeVaryingMetric(m);
+    }
+    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.metricsPut = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TreeSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Calling this.metricsPut.clear() should be enough.&lt;/p&gt;</comment>
                            <comment id="13260053" author="eclark" created="Mon, 23 Apr 2012 22:53:03 +0000"  >&lt;p&gt;So with the way hadoop metrics MetricsRegistry works it&apos;s not really possible to remove a metric.  So this won&apos;t do what&apos;s needed.&lt;/p&gt;</comment>
                            <comment id="13260060" author="zhihyu@ebaysf.com" created="Mon, 23 Apr 2012 22:58:15 +0000"  >&lt;p&gt;Log Hadoop JIRA to request this feature ?&lt;/p&gt;</comment>
                            <comment id="13260148" author="stack" created="Tue, 24 Apr 2012 01:59:51 +0000"  >&lt;p&gt;@Elliott What happens?  The region looks like its on a regionserver its no longer on?  The counters just don&apos;t change?  Whats that mean?  That our per-region metrics are going to be messy if regions move?  Good on you.&lt;/p&gt;</comment>
                            <comment id="13260720" author="eclark" created="Tue, 24 Apr 2012 17:19:50 +0000"  >&lt;p&gt;@Stack yes our per region metrics will be messy if regions move or split or if tables are dropped.  &lt;/p&gt;

&lt;p&gt;For operation metrics anything reading the jmx can just ignore metrics with _NumOps = 0.  That&apos;s messy but it works.  For something going forward that&apos;s a little more general would be nice.  I&apos;ll look into it.  &lt;/p&gt;</comment>
                            <comment id="13260874" author="eclark" created="Tue, 24 Apr 2012 19:33:20 +0000"  >&lt;p&gt;Filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8313&quot; title=&quot;Add the ability for MetricsRegistry to remove metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8313&quot;&gt;HADOOP-8313&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m still looking into other ways of doing it.&lt;/p&gt;</comment>
                            <comment id="13261154" author="eclark" created="Tue, 24 Apr 2012 23:54:29 +0000"  >&lt;p&gt;Here&apos;s how I was able to do it.  It&apos;s not pretty.  But it works.&lt;/p&gt;

&lt;p&gt;Basically remove all DynamicStatistics after a region is placed off-line.&lt;/p&gt;</comment>
                            <comment id="13261177" author="zhihyu@ebaysf.com" created="Wed, 25 Apr 2012 00:35:04 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  @SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&quot;unused&quot;&lt;/span&gt;)
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; RegionServerDynamicMetrics dynamicMetrics;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I tried to find out how HRegionServer.dynamicMetrics is used but wasn&apos;t able to.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-comment&quot;&gt;//Clear all of the dynamic metrics as they are now probably useless
&lt;/span&gt;+    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.dynamicMetrics.clear();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Only encodedName is removed. Why do we clear dynamicMetrics ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SecurityException e) {
+        LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to clear metricsRecord&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We don&apos;t need to stumble over the same exception(s) again and again. Why not set a boolean to indicate that reflection shouldn&apos;t be used in the future ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.recordMetricMapField != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.registryMetricMapField != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please separate the above two conditions into two if blocks.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.collect.Multiset.Entry;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is the above import used ?&lt;br/&gt;
It&apos;s nice to have a test.&lt;/p&gt;</comment>
                            <comment id="13261192" author="eclark" created="Wed, 25 Apr 2012 01:00:55 +0000"  >&lt;p&gt;HRegionServer.dynamicMetrics registers it&apos;s self with the Hadoop Metrics.  From then on the metrics are polled by a thread outside of hbase.&lt;/p&gt;

&lt;p&gt;We clear everything in order to clear schema metrics and metrics about cf&apos;s.  It would be time consuming to iterate through all metrics and see if they are for column families that are still being served.  Since the metrics are reset by jmx every time it comes through removing them is not great but saves a lot of string comparisons and ensures that all edge cases are covered.&lt;/p&gt;

&lt;p&gt;I added the bool to make sure that initializing is only tried once.&lt;/p&gt;

&lt;p&gt;Changed the or to a &amp;amp;&amp;amp; since only clearing half doesn&apos;t get the job done so better not not try if one field was not accessible.&lt;/p&gt;</comment>
                            <comment id="13261196" author="eclark" created="Wed, 25 Apr 2012 01:04:39 +0000"  >&lt;p&gt;I can write a more comprehensive test but that would require changing several fields to be more accessible.  Not sure what the general thought was on that.&lt;/p&gt;</comment>
                            <comment id="13261238" author="zhihyu@ebaysf.com" created="Wed, 25 Apr 2012 01:58:41 +0000"  >&lt;p&gt;MetricsRecord has become an interface in MRv2.&lt;/p&gt;

&lt;p&gt;Please introduce Shim to make the solution work for both hadoop 1.0 and 2.0&lt;/p&gt;</comment>
                            <comment id="13261928" author="eclark" created="Wed, 25 Apr 2012 18:44:51 +0000"  >&lt;p&gt;Testing on both 1.0 and 0.23 both work (after applying patch from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5870&quot; title=&quot;Hadoop 23 compilation broken because JobTrackerRunner#getJobTracker() method is not found&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5870&quot;&gt;&lt;del&gt;HBASE-5870&lt;/del&gt;&lt;/a&gt;).  MetricsRecord has always been an interface as far as I can tell.  What did you think needed a shim ?&lt;/p&gt;</comment>
                            <comment id="13261935" author="zhihyu@ebaysf.com" created="Wed, 25 Apr 2012 18:49:42 +0000"  >&lt;p&gt;I didn&apos;t check MetricsRecord in hadoop 1.0&lt;br/&gt;
Thanks for the confirmation.&lt;/p&gt;</comment>
                            <comment id="13261945" author="eclark" created="Wed, 25 Apr 2012 18:55:02 +0000"  >&lt;p&gt;Thanks for the check.&lt;/p&gt;</comment>
                            <comment id="13261948" author="zhihyu@ebaysf.com" created="Wed, 25 Apr 2012 18:59:59 +0000"  >&lt;p&gt;+1 on patch v3.&lt;/p&gt;</comment>
                            <comment id="13261964" author="eclark" created="Wed, 25 Apr 2012 19:16:23 +0000"  >&lt;p&gt;Attaching 94 backport of v3&lt;/p&gt;</comment>
                            <comment id="13262002" author="hadoopqa" created="Wed, 25 Apr 2012 19:50:19 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12524329/HBASE-5862-94-3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12524329/HBASE-5862-94-3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1651//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1651//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13262008" author="eclark" created="Wed, 25 Apr 2012 19:56:14 +0000"  >&lt;p&gt;The last QA failure was for the 94 branch patch.  It failed because QA only tries to patch trunk.&lt;/p&gt;</comment>
                            <comment id="13262011" author="hadoopqa" created="Wed, 25 Apr 2012 19:57:36 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12524095/HBASE-5862-3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12524095/HBASE-5862-3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 5 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1650//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1650//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1650//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1650//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1650//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1650//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13262748" author="zhihyu@ebaysf.com" created="Thu, 26 Apr 2012 17:03:55 +0000"  >&lt;p&gt;@Stack:&lt;br/&gt;
Do you have suggestions on further improvement for the latest patch ?&lt;/p&gt;</comment>
                            <comment id="13262754" author="stack" created="Thu, 26 Apr 2012 17:09:33 +0000"  >&lt;p&gt;+1 on patch.  Please add more comments around why you are hacking into hadoop metrics.  Please also paste some pretty pictures so Lars can see why this has to be in 0.94.&lt;/p&gt;</comment>
                            <comment id="13262767" author="eclark" created="Thu, 26 Apr 2012 17:26:30 +0000"  >&lt;p&gt;Stack wanted a screen shot of what all the recent region metrics work has enabled.&lt;/p&gt;

&lt;p&gt;Here&apos;s a shot of TSDB showing average time of a multi put over all the regions of a table.  It illustrates regions being split and new regions showing up.&lt;/p&gt;

&lt;p&gt;stack had some comments about places that needed some extra info I&apos;ll ge those trivial patches up in a sec.&lt;/p&gt;</comment>
                            <comment id="13262797" author="eclark" created="Thu, 26 Apr 2012 17:53:20 +0000"  >&lt;p&gt;Patch with more comments.&lt;br/&gt;
Also added a return if reflection was un-successful as there is no need to try more.&lt;/p&gt;</comment>
                            <comment id="13262802" author="hadoopqa" created="Thu, 26 Apr 2012 18:02:09 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12524470/HBASE-5862-4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12524470/HBASE-5862-4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1658//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1658//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13262803" author="stack" created="Thu, 26 Apr 2012 18:02:52 +0000"  >&lt;p&gt;Committed trunk and 0.94.  Thanks for the patch Elliott&lt;/p&gt;</comment>
                            <comment id="13262808" author="zhihyu@ebaysf.com" created="Thu, 26 Apr 2012 18:08:25 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-comment&quot;&gt;//per hfile.  Figuring out which cfs, hfiles, ...&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should cfs be in expanded form (column families) ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-comment&quot;&gt;//and on the next tick of the metrics everything that is still relevant will be
&lt;/span&gt;+    &lt;span class=&quot;code-comment&quot;&gt;//re-added.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;re-added&apos; -&amp;gt; &apos;added&apos; or &apos;added again&apos;&lt;/p&gt;

&lt;p&gt;The initialization work in clear() should be moved to RegionServerDynamicMetrics ctor because it is one time operation.&lt;/p&gt;</comment>
                            <comment id="13262810" author="lhofhansl" created="Thu, 26 Apr 2012 18:08:55 +0000"  >&lt;p&gt;I don&apos;t get the Hadoop private field accessor stuff. Why do we need to clear out private fields? Is there an API missing for this in Hadoop?&lt;/p&gt;</comment>
                            <comment id="13262813" author="eclark" created="Thu, 26 Apr 2012 18:15:44 +0000"  >&lt;p&gt;@lars Yes there&apos;s a missing api.  Hadoop metrics keeps a copy of all metrics created.  That copy is used to expose the data to jmx and other consumers.&lt;br/&gt;
There is no remove function. &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8313&quot; title=&quot;Add the ability for MetricsRegistry to remove metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8313&quot;&gt;HADOOP-8313&lt;/a&gt; was filed to correct this.  However until that changes reflection was the only way.&lt;/p&gt;</comment>
                            <comment id="13263094" author="lhofhansl" created="Thu, 26 Apr 2012 20:26:12 +0000"  >&lt;p&gt;Thanks Elliot.&lt;/p&gt;</comment>
                            <comment id="13263099" author="hudson" created="Thu, 26 Apr 2012 20:27:20 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #151 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/151/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/151/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5862&quot; title=&quot;After Region Close remove the Operation Metrics.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5862&quot;&gt;&lt;del&gt;HBASE-5862&lt;/del&gt;&lt;/a&gt; After Region Close remove the Operation Metrics; ADDENDUM &amp;#8211; missing import (Revision 1331040)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRegionServerMetrics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13263134" author="hudson" created="Thu, 26 Apr 2012 20:53:48 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #22 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/22/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/22/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5862&quot; title=&quot;After Region Close remove the Operation Metrics.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5862&quot;&gt;&lt;del&gt;HBASE-5862&lt;/del&gt;&lt;/a&gt; After Region Close remove the Operation Metrics; ADDENDUM &amp;#8211; missing import (Revision 1331040)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5862&quot; title=&quot;After Region Close remove the Operation Metrics.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5862&quot;&gt;&lt;del&gt;HBASE-5862&lt;/del&gt;&lt;/a&gt; After Region Close remove the Operation Metrics (Revision 1330998)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRegionServerMetrics.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/OperationMetrics.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/RegionMetricsStorage.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/RegionServerDynamicMetrics.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRegionServerMetrics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13263370" author="hudson" created="Fri, 27 Apr 2012 05:49:34 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #186 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/186/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/186/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5862&quot; title=&quot;After Region Close remove the Operation Metrics.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5862&quot;&gt;&lt;del&gt;HBASE-5862&lt;/del&gt;&lt;/a&gt; After Region Close remove the Operation Metrics (Revision 1330997)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/OperationMetrics.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/RegionMetricsStorage.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/RegionServerDynamicMetrics.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestRegionServerMetrics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13575941" author="tychang" created="Mon, 11 Feb 2013 18:06:27 +0000"  >&lt;p&gt;Elliott, &lt;/p&gt;

&lt;p&gt;I was working on adding some other region level metrics. I think your work around of clearing all dynamic metrics for all the regions when one region is closed works for most of the cases, but for metrics of &quot;numericPersistentMetrics&quot;, seems not appropriate. Because clearing the metrics will lose the accumulated values which can never be recovered, especially for the live regions that are not to be closed.&lt;/p&gt;

&lt;p&gt;I want to open a bug for addressing the numericPersistentMetrics metrics, and would like to hear comments from you.  Thanks &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12631765">HBASE-7816</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12523879" name="HBASE-5862-0.patch" size="5700" author="eclark" created="Mon, 23 Apr 2012 22:03:08 +0000"/>
                            <attachment id="12524084" name="HBASE-5862-1.patch" size="8758" author="eclark" created="Tue, 24 Apr 2012 23:54:29 +0000"/>
                            <attachment id="12524094" name="HBASE-5862-2.patch" size="9518" author="eclark" created="Wed, 25 Apr 2012 01:00:54 +0000"/>
                            <attachment id="12524095" name="HBASE-5862-3.patch" size="9208" author="eclark" created="Wed, 25 Apr 2012 01:02:26 +0000"/>
                            <attachment id="12524470" name="HBASE-5862-4.patch" size="10068" author="eclark" created="Thu, 26 Apr 2012 17:53:20 +0000"/>
                            <attachment id="12524329" name="HBASE-5862-94-3.patch" size="9030" author="eclark" created="Wed, 25 Apr 2012 19:16:22 +0000"/>
                            <attachment id="12524468" name="TSD.png" size="226705" author="eclark" created="Thu, 26 Apr 2012 17:26:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 23 Apr 2012 22:11:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236708</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 44 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08qzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48972</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fixes the case where when a region closed, its metrics did not; they stayed up associated w/ old hosting server even though region may have moved elsewhere.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>