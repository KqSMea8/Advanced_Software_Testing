<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:35:53 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6339/HBASE-6339.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6339] Bulkload call to RS should begin holding write lock only after the file has been transferred</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6339</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I noticed that right now, under a bulkLoadHFiles call to an RS, we grab the HRegion write lock as soon as we determine that it is a multi-family bulk load we&apos;ll be attempting. The file copy from the caller&apos;s source FS is done after holding the lock.&lt;/p&gt;

&lt;p&gt;This doesn&apos;t seem right. For instance, we had a recent use-case where the bulk load running cluster is a separate HDFS instance/cluster than the one that runs HBase and the transfers between these FSes can get slower than an intra-cluster transfer. Hence I think we should begin to hold the write lock only after we&apos;ve got a successful destinationFS copy of the requested file, and thereby allow more write throughput to pass.&lt;/p&gt;

&lt;p&gt;Does this sound reasonable to do?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12597798">HBASE-6339</key>
            <summary>Bulkload call to RS should begin holding write lock only after the file has been transferred</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="qwertymaniac">Harsh J</assignee>
                                    <reporter username="qwertymaniac">Harsh J</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Jul 2012 16:29:24 +0000</created>
                <updated>Sat, 7 Jul 2012 19:13:40 +0000</updated>
                            <resolved>Sat, 7 Jul 2012 15:50:47 +0000</resolved>
                                    <version>0.90.0</version>
                                                    <component>Client</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13408694" author="qwertymaniac" created="Sat, 7 Jul 2012 15:50:47 +0000"  >&lt;p&gt;I noticed this shouldn&apos;t be done, otherwise, given the current logic, a split may occur during the bulk load file pull &lt;em&gt;after&lt;/em&gt; having been verified. It is fine as-is for the moment.&lt;/p&gt;</comment>
                            <comment id="13408695" author="zhihyu@ebaysf.com" created="Sat, 7 Jul 2012 15:55:04 +0000"  >&lt;p&gt;In many production systems, region splitting is effectively disabled.&lt;br/&gt;
Looks like there is some in gem in your initial proposal if we can reliably detect that there is no region splitting.&lt;/p&gt;</comment>
                            <comment id="13408699" author="qwertymaniac" created="Sat, 7 Jul 2012 16:09:30 +0000"  >&lt;p&gt;Thanks for the comments Ted.&lt;/p&gt;

&lt;p&gt;Region splitting being disabled isn&apos;t a simple toggle value, so its kinda tricky to determine if it is indeed disabled. Besides that, there&apos;s still a chance of a manual split operation.&lt;/p&gt;

&lt;p&gt;Granted we can dupe the checks, once before the file pull (lock before this but then release), and once again right after (lock here and return only at end, as normal), I think that adds unnecessary complications. For the moment, if Ops had &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6350&quot; title=&quot;Some logging improvements for RegionServer bulk loading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6350&quot;&gt;&lt;del&gt;HBASE-6350&lt;/del&gt;&lt;/a&gt;, I think it should be satisfactory enough. It isn&apos;t often that I notice separated FS clusters loading between them.&lt;/p&gt;

&lt;p&gt;Thoughts? Is it worth the extra check and complexity addition?&lt;/p&gt;</comment>
                            <comment id="13408747" author="zhihyu@ebaysf.com" created="Sat, 7 Jul 2012 19:13:40 +0000"  >&lt;p&gt;@Harsh:&lt;br/&gt;
Your argument makes sense.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 7 Jul 2012 15:55:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>256588</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 23 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0huuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102259</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>