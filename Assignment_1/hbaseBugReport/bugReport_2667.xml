<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:03:46 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2667/HBASE-2667.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2667] TestHLog.testSplit failing in trunk</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2667</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Build is broke because this test won&apos;t pass.&lt;/p&gt;

&lt;p&gt;Seems to be two issues at least:&lt;/p&gt;

&lt;p&gt;1. we need to change the test so it keeps logs in one subdir, archives in another and split products in yet another as per regionserver.  New split code does cleanup of old logs dir if successful.  In this test it was removing the created splits so when verify went to run, the log no longer existed&lt;br/&gt;
2. The verify of splits tests that sequence numbers are in order.  They don&apos;t seem to be (the assertion failure was masked by a close reader exception).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12466163">HBASE-2667</key>
            <summary>TestHLog.testSplit failing in trunk</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Jun 2010 06:35:06 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:18 +0000</updated>
                            <resolved>Fri, 4 Jun 2010 16:08:56 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12875507" author="stack" created="Fri, 4 Jun 2010 06:38:52 +0000"  >&lt;p&gt;Some preliminary work.  Does clean up dir locations in test.  Adds logging.  No fix yet.&lt;/p&gt;</comment>
                            <comment id="12875645" author="stack" created="Fri, 4 Jun 2010 16:07:47 +0000"  >&lt;p&gt;The test checked sequenceid ordering in the produced split.  They were being written in the reverse order &amp;#8211; newest first.  The reconstruction log over in HStore expects to read the edits oldest through to newest so changed how we make the recovered edits files.&lt;/p&gt;

&lt;p&gt;Here is the change:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@@ -1552,10 +1552,11 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class HLog &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; HConstants, Syncable {
         &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
           &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; editsCount = 0;
           WriterAndPath wap = logWriters.get(region);
-          &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (ListIterator&amp;lt;Entry&amp;gt; iterator = entries.listIterator();
-               iterator.hasNext();) {
-            Entry logEntry =  iterator.next();
-
+          &lt;span class=&quot;code-comment&quot;&gt;// We put edits onto the Stack ordered oldest sequence id to newest.
&lt;/span&gt;+          &lt;span class=&quot;code-comment&quot;&gt;// Pop them off starting with the oldest.
&lt;/span&gt;+          &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (ListIterator&amp;lt;Entry&amp;gt; iterator = entries.listIterator(entries.size());
+               iterator.hasPrevious();) {
+            Entry logEntry =  iterator.previous();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12875646" author="stack" created="Fri, 4 Jun 2010 16:08:56 +0000"  >&lt;p&gt;Committed.  Change is small and build is broke.&lt;/p&gt;</comment>
                            <comment id="12875818" author="clehene" created="Sat, 5 Jun 2010 01:01:58 +0000"  >&lt;p&gt;Added a new unit test TestHLogSplit.testSplitPreservesEdits that checks edits integrity after split. &lt;/p&gt;

&lt;p&gt;Changed the looping through the edits to a simple for and fixed parseHLog to append (addLast) to the list of edits.  &lt;/p&gt;</comment>
                            <comment id="12875871" author="stack" created="Sat, 5 Jun 2010 05:54:39 +0000"  >&lt;p&gt;You stuff is cleaner than my crap Cosmin.  I committed it.  Thanks.&lt;/p&gt;</comment>
                            <comment id="12875881" author="clehene" created="Sat, 5 Jun 2010 07:18:50 +0000"  >&lt;p&gt;My previous, cleaner stuff broke it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. &lt;/p&gt;</comment>
                            <comment id="15016939" author="lars_francke" created="Fri, 20 Nov 2015 12:41:18 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12446333" name="2667-prelim.txt" size="3869" author="stack" created="Fri, 4 Jun 2010 06:38:52 +0000"/>
                            <attachment id="12446352" name="2667.txt" size="6088" author="stack" created="Fri, 4 Jun 2010 16:07:47 +0000"/>
                            <attachment id="12446392" name="HBASE-2667-v2.patch" size="6259" author="clehene" created="Sat, 5 Jun 2010 01:01:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 5 Jun 2010 01:01:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26413</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hion:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100289</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>