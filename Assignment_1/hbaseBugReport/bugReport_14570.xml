<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:54:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14570/HBASE-14570.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14570] Split TestHBaseFsck in order to help with hanging tests</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14570</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This one hangs regularly. Let me at least add timeouts. Looking in log, a bunch of tests are potentially hanging tests since they don&apos;t see to clean up after themselves. Will start watching and just disable likely candidates unless someone wants to have a go at fixing this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12902894">HBASE-14570</key>
            <summary>Split TestHBaseFsck in order to help with hanging tests</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12863637">HBASE-14420</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eclark">Elliott Clark</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Oct 2015 05:28:50 +0000</created>
                <updated>Thu, 15 Oct 2015 05:21:52 +0000</updated>
                            <resolved>Wed, 14 Oct 2015 20:59:12 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14951710" author="chenheng" created="Sat, 10 Oct 2015 08:17:50 +0000"  >&lt;p&gt;It seems no failures in latest builds....&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/lastCompletedBuild/testReport/org.apache.hadoop.hbase.util/TestHBaseFsck/history/#&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/lastCompletedBuild/testReport/org.apache.hadoop.hbase.util/TestHBaseFsck/history/#&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And timeouts seems be added already in &lt;tt&gt;TestHBaseFsck&lt;/tt&gt;....&lt;/p&gt;

&lt;p&gt;Is there anything i missed?&lt;/p&gt;</comment>
                            <comment id="14952091" author="stack" created="Sat, 10 Oct 2015 22:59:43 +0000"  >&lt;p&gt;I think the history shows whether a test passed or failed, not whether it hung (it could report success but might not die). The last time this test hung was here:&lt;/p&gt;

&lt;p&gt;Fetching &lt;a href=&quot;https://builds.apache.org/view/H-L/view/HBase/job/PreCommit-HBASE-Build/15925/consoleText&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/view/H-L/view/HBase/job/PreCommit-HBASE-Build/15925/consoleText&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="14955333" author="eclark" created="Tue, 13 Oct 2015 17:39:29 +0000"  >&lt;p&gt;How about something like this?&lt;/p&gt;

&lt;p&gt;It splits the test hbase hbck test up into different parts.&lt;br/&gt;
Some of the tests only need one regionserver, so that should greatly cut down on how long things run and number of threads.&lt;/p&gt;</comment>
                            <comment id="14955506" author="hadoopqa" created="Tue, 13 Oct 2015 19:25:51 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12766367/HBASE-14570.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12766367/HBASE-14570.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 6323cd95442bf6c2617b7e8267e0c0b76e4c47eb.&lt;br/&gt;
  ATTACHMENT ID: 12766367&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 23 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 1 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 1 release audit warnings (more than the master&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS }
&lt;p&gt;);&lt;br/&gt;
+      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.NO_TABLEINFO_FILE }
&lt;p&gt;);&lt;br/&gt;
+          new HBaseFsck.ErrorReporter.ERROR_CODE[] { HBaseFsck.ErrorReporter.ERROR_CODE.ORPHAN_HDFS_REGION, HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META_OR_DEPLOYED,&lt;br/&gt;
+      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] { HBaseFsck.ErrorReporter.ERROR_CODE.OVERLAP_IN_REGION_CHAIN,&lt;br/&gt;
+      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN }
&lt;p&gt;);&lt;br/&gt;
+      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.SHOULD_NOT_BE_DEPLOYED }
&lt;p&gt;);&lt;br/&gt;
+    assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS,
+        HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS, HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS,
+        HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS, HBaseFsck.ErrorReporter.ERROR_CODE.ORPHAN_TABLE_STATE, }
&lt;p&gt;);&lt;br/&gt;
+    assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.NO_VERSION_FILE }
&lt;p&gt;);&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestCheckTestClasses&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//artifact/patchprocess/patchReleaseAuditWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//artifact/patchprocess/patchReleaseAuditWarnings.txt&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15989//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14955556" author="stack" created="Tue, 13 Oct 2015 20:15:09 +0000"  >&lt;p&gt;Go for it &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; Fix the TestCheckTestClasses on commit.&lt;/p&gt;</comment>
                            <comment id="14956220" author="chenheng" created="Wed, 14 Oct 2015 04:14:32 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;,  After analysis the log stack posted above,  I don&apos;t think TestHbaseFsck was hanged.&lt;/p&gt;

&lt;p&gt;We can see the when the test failed,  jstack about TestHbaseFsck is&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;Time-limited test&quot;&lt;/span&gt; daemon prio=10 tid=0x00007f5830aec800 nid=0x6206 waiting on condition [0x00007f55fdada000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (parking)
	at sun.misc.Unsafe.park(Native Method)
	- parking to wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;  &amp;lt;0x00000007f294f240&amp;gt; (a java.util.concurrent.FutureTask)
	at java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)
	at java.util.concurrent.FutureTask.awaitDone(FutureTask.java:425)
	at java.util.concurrent.FutureTask.get(FutureTask.java:187)
	at java.util.concurrent.AbstractExecutorService.invokeAll(AbstractExecutorService.java:243)
	at org.apache.hadoop.hbase.util.HBaseFsck.checkRegionConsistencyConcurrently(HBaseFsck.java:1876)
	at org.apache.hadoop.hbase.util.HBaseFsck.checkAndFixConsistency(HBaseFsck.java:1834)
	at org.apache.hadoop.hbase.util.HBaseFsck.onlineConsistencyRepair(HBaseFsck.java:675)
	at org.apache.hadoop.hbase.util.HBaseFsck.onlineHbck(HBaseFsck.java:697)
	at org.apache.hadoop.hbase.util.hbck.HbckTestingUtil.doFsck(HbckTestingUtil.java:71)
	at org.apache.hadoop.hbase.util.hbck.HbckTestingUtil.doFsck(HbckTestingUtil.java:43)
	at org.apache.hadoop.hbase.util.hbck.HbckTestingUtil.doFsck(HbckTestingUtil.java:38)
	at org.apache.hadoop.hbase.util.TestHBaseFsck.testRegionShouldNotBeDeployed(TestHBaseFsck.java:1632)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:744)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The relates code is &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void checkRegionConsistencyConcurrently(
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;CheckRegionConsistencyWorkItem&amp;gt; workItems)
    &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, KeeperException, InterruptedException {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (workItems.isEmpty()) {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;  &lt;span class=&quot;code-comment&quot;&gt;// nothing to check
&lt;/span&gt;    }

    List&amp;lt;Future&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Void&lt;/span&gt;&amp;gt;&amp;gt; workFutures = executor.invokeAll(workItems);
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;(Future&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Void&lt;/span&gt;&amp;gt; f: workFutures) {
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        f.get(); &lt;span class=&quot;code-comment&quot;&gt;//blocking here
&lt;/span&gt;      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(ExecutionException e1) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And jstack about thread CheckRegionConsistencyWorkItem is &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;pool-104-thread-1&quot;&lt;/span&gt; prio=10 tid=0x00007f57e8026800 nid=0x65ea waiting on condition [0x00007f560aeae000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: TIMED_WAITING (sleeping)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(Native Method)
	at org.apache.hadoop.hbase.master.ServerManager.closeRegionSilentlyAndWait(ServerManager.java:863)
	at org.apache.hadoop.hbase.util.HBaseFsckRepair.closeRegionSilentlyAndWait(HBaseFsckRepair.java:156)
	at org.apache.hadoop.hbase.util.HBaseFsckRepair.fixMultiAssignment(HBaseFsckRepair.java:74)
	at org.apache.hadoop.hbase.util.HBaseFsck.checkRegionConsistency(HBaseFsck.java:2387)
	at org.apache.hadoop.hbase.util.HBaseFsck.access$900(HBaseFsck.java:192)
	at org.apache.hadoop.hbase.util.HBaseFsck$CheckRegionConsistencyWorkItem.call(HBaseFsck.java:1907)
	- locked &amp;lt;0x00000007f294ef10&amp;gt; (a org.apache.hadoop.hbase.util.HBaseFsck$CheckRegionConsistencyWorkItem)
	at org.apache.hadoop.hbase.util.HBaseFsck$CheckRegionConsistencyWorkItem.call(HBaseFsck.java:1895)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:744)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And relates code is in &lt;tt&gt;ServerManager&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  /**
   * Contacts a region server and waits up to timeout ms
   * to close the region.  This bypasses the active hmaster.
   */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void closeRegionSilentlyAndWait(ClusterConnection connection, 
    ServerName server, HRegionInfo region, &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; timeout) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException {
    AdminService.BlockingInterface rs = connection.getAdmin(server);
    ...
    &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; expiration = timeout + &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis() &amp;lt; expiration) {
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        HRegionInfo rsRegion = ProtobufUtil.getRegionInfo(rs, region.getRegionName());
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rsRegion == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ioe) {
         ...
      }
      &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(1000); &lt;span class=&quot;code-comment&quot;&gt;//block here
&lt;/span&gt;    }
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Region &quot;&lt;/span&gt; + region + &lt;span class=&quot;code-quote&quot;&gt;&quot; failed to close within&quot;&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot; timeout &quot;&lt;/span&gt; + timeout);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It means blocking thread is waiting for region to be closed,  it has timeout 180s.  &lt;/p&gt;

&lt;p&gt;But during this waiting time,  mvn test was broken by some failed testcases.  &lt;/p&gt;

&lt;p&gt;So we can&apos;t see clean up after TestHbaseFsck running.&lt;/p&gt;

&lt;p&gt;IMO this is not TestHbaseFack&apos;s fault.  But i argee we do spilt this testcase, because it is too big.&lt;/p&gt;


</comment>
                            <comment id="14957313" author="stack" created="Wed, 14 Oct 2015 17:22:20 +0000"  >&lt;p&gt;Thanks @heng for digging in and taking a look... thats great.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; go for it.&lt;/p&gt;</comment>
                            <comment id="14957652" author="hadoopqa" created="Wed, 14 Oct 2015 20:09:44 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12766578/HBASE-14570-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12766578/HBASE-14570-v1.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit ba3d474f8aee5d59638feb5c370cf0da04dfdc9d.&lt;br/&gt;
  ATTACHMENT ID: 12766578&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 23 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 1 release audit warnings (more than the master&apos;s current 0 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS }
&lt;p&gt;);&lt;br/&gt;
+      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.NO_TABLEINFO_FILE }
&lt;p&gt;);&lt;br/&gt;
+          new HBaseFsck.ErrorReporter.ERROR_CODE[] { HBaseFsck.ErrorReporter.ERROR_CODE.ORPHAN_HDFS_REGION, HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_META_OR_DEPLOYED,&lt;br/&gt;
+      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] { HBaseFsck.ErrorReporter.ERROR_CODE.OVERLAP_IN_REGION_CHAIN,&lt;br/&gt;
+      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.HOLE_IN_REGION_CHAIN }
&lt;p&gt;);&lt;br/&gt;
+      assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.SHOULD_NOT_BE_DEPLOYED }
&lt;p&gt;);&lt;br/&gt;
+    assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS,
+        HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS, HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS,
+        HBaseFsck.ErrorReporter.ERROR_CODE.NOT_IN_HDFS, HBaseFsck.ErrorReporter.ERROR_CODE.ORPHAN_TABLE_STATE, }
&lt;p&gt;);&lt;br/&gt;
+    assertErrors(hbck, new HBaseFsck.ErrorReporter.ERROR_CODE[] &lt;/p&gt;
{ HBaseFsck.ErrorReporter.ERROR_CODE.NO_VERSION_FILE }
&lt;p&gt;);&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 2 zombie test(s): 	at org.apache.camel.component.jetty.jettyproducer.HttpJettyProducerRecipientListCustomThreadPoolTest.testRecipientList(HttpJettyProducerRecipientListCustomThreadPoolTest.java:40)&lt;br/&gt;
	at org.apache.camel.test.junit4.CamelTestSupport.doStopCamelContext(CamelTestSupport.java:517)&lt;br/&gt;
	at org.apache.camel.test.junit4.CamelTestSupport.tearDown(CamelTestSupport.java:400)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//artifact/patchprocess/patchReleaseAuditWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//artifact/patchprocess/patchReleaseAuditWarnings.txt&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16010//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14957747" author="eclark" created="Wed, 14 Oct 2015 20:58:50 +0000"  >&lt;p&gt;Pushed to master lets see ho this goes.&lt;/p&gt;</comment>
                            <comment id="14957992" author="yuzhihong@gmail.com" created="Wed, 14 Oct 2015 23:17:58 +0000"  >&lt;p&gt;@Elliott:&lt;br/&gt;
hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsckReplicas.java misses license header.&lt;/p&gt;

&lt;p&gt;Mind adding one ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="14958033" author="hudson" created="Wed, 14 Oct 2015 23:56:27 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6911 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6911/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6911/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14570&quot; title=&quot;Split TestHBaseFsck in order to help with hanging tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14570&quot;&gt;&lt;del&gt;HBASE-14570&lt;/del&gt;&lt;/a&gt; Split TestHBaseFsck in order to help with hanging tests (eclark: rev fbd2ed2e02d3b6c7287331b345d328b9518ec6ba)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/BaseTestHBaseFsck.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsckOneRS.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsckTwoRS.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsckReplicas.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsckMOB.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsck.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14958046" author="stack" created="Thu, 15 Oct 2015 00:03:32 +0000"  >&lt;p&gt;Pushed addendum adding license FYI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14958190" author="eclark" created="Thu, 15 Oct 2015 02:19:51 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14958345" author="hudson" created="Thu, 15 Oct 2015 05:21:52 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #6913 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6913/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6913/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14570&quot; title=&quot;Split TestHBaseFsck in order to help with hanging tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14570&quot;&gt;&lt;del&gt;HBASE-14570&lt;/del&gt;&lt;/a&gt; Split TestHBaseFsck in order to help with hanging tests: (stack: rev 658d25af25ae911c4409875643079be2c57c9888)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsckReplicas.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12766578" name="HBASE-14570-v1.patch" size="244760" author="eclark" created="Wed, 14 Oct 2015 16:43:27 +0000"/>
                            <attachment id="12766367" name="HBASE-14570.patch" size="245034" author="eclark" created="Tue, 13 Oct 2015 17:39:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 10 Oct 2015 08:17:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mo7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>