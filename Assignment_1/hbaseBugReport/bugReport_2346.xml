<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:01:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2346/HBASE-2346.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2346] Usage of FilterList slows down scans</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2346</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When using a FilterList the scan is much slower compared to a scan with only a single filter (tested SingleColumnValueFilter and PrefixFilter).&lt;/p&gt;

&lt;p&gt;The difference is extrem for very small ranges: if the range is only 10 rows the scan is 10 times slower when using the FilterList.&lt;/p&gt;

&lt;p&gt;Is the cause just GC or object serialization/deserialization?&lt;/p&gt;

&lt;p&gt;For a simple test I used the PerformanceEvaluation tool and created the TestTable with only 10&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; rows:&lt;br/&gt;
$ bin/hbase org.apache.hadoop.hbase.PerformanceEvaluation --rows=10 sequentialWrite 1&lt;/p&gt;

&lt;p&gt;The attached test performs 100 scan using diffent filters. The filter is then wrapped into a FilterList (with only a single filter). This FilterList is then nested two more times into another FilterList. For each nested level the scan gets slower and slower.&lt;/p&gt;

&lt;p&gt;The test created the following output:&lt;/p&gt;

&lt;p&gt;Scan Null Filter (10): 391ms&lt;br/&gt;
Scan FilterList with Null Filter (0): 4788ms&lt;br/&gt;
Scan Nested FilterList with Null Filter (0): 8303ms&lt;br/&gt;
Scan Nested Nested FilterList with Null Filter (0): 11915ms&lt;/p&gt;

&lt;p&gt;Scan SingleColumValueFilter Equal (0): 257ms&lt;br/&gt;
Scan FilterList with SingleColumValueFilter Equal (0): 4121ms&lt;br/&gt;
Scan Nested FilterList with SingleColumValueFilter Equal (0): 7965ms&lt;br/&gt;
Scan Nested Nested FilterList with SingleColumValueFilter Equal (0): 11600ms&lt;/p&gt;

&lt;p&gt;Scan SingleColumValueFilter Not Equal (10): 912ms&lt;br/&gt;
Scan FilterList with SingleColumValueFilter Not Equal (10): 4542ms&lt;br/&gt;
Scan Nested FilterList with SingleColumValueFilter Not Equal (10): 8459ms&lt;br/&gt;
Scan Nested Nested FilterList with SingleColumValueFilter Not Equal (10): 11513ms&lt;/p&gt;

&lt;p&gt;Scan PrefixFilter (10): 306ms&lt;br/&gt;
Scan FilterList with PrefixFilter (10): 3695ms&lt;br/&gt;
Scan Nested FilterList with PrefixFilter (10): 7762ms&lt;br/&gt;
Scan Nested Nested FilterList with PrefixFilter (10): 11721ms&lt;/p&gt;

&lt;p&gt;Get: 245ms&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 9.10&lt;br/&gt;
Sund JDK 1.6.0_16&lt;br/&gt;
HBase 0.20.3 (standalone and pseudo-distributed)&lt;/p&gt;</environment>
        <key id="12459663">HBASE-2346</key>
            <summary>Usage of FilterList slows down scans</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdcryans">Jean-Daniel Cryans</assignee>
                                    <reporter username="seelmann">Stefan Seelmann</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Mar 2010 15:28:47 +0000</created>
                <updated>Fri, 12 Oct 2012 06:15:01 +0000</updated>
                            <resolved>Fri, 9 Apr 2010 00:11:38 +0000</resolved>
                                    <version>0.20.3</version>
                                    <fixVersion>0.20.4</fixVersion>
                    <fixVersion>0.90.0</fixVersion>
                                    <component>Filters</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12847426" author="stack" created="Fri, 19 Mar 2010 16:35:19 +0000"  >&lt;p&gt;Thanks for the test.  Should help debug whats going on.&lt;/p&gt;

&lt;p&gt;I&apos;m pulling this into 0.20.4.  FilterList is important piece of functionality.  Need to figure why its slow.&lt;/p&gt;</comment>
                            <comment id="12855212" author="jdcryans" created="Thu, 8 Apr 2010 23:45:03 +0000"  >&lt;p&gt;Creating a Configuration is super expensive, so this patch reuses the same static object. Discussing with Stack, we don&apos;t think there&apos;s any impact (apart from better speed). Here&apos;s the numbers I get from running the test with the patch:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

Scan Null Filter (0): 123ms
Scan FilterList with Null Filter (0): 359ms
Scan Nested FilterList with Null Filter (0): 296ms
Scan Nested Nested FilterList with Null Filter (0): 293ms

Scan SingleColumValueFilter Equal (0): 124ms
Scan FilterList with SingleColumValueFilter Equal (0): 169ms
Scan Nested FilterList with SingleColumValueFilter Equal (0): 129ms
Scan Nested Nested FilterList with SingleColumValueFilter Equal (0): 126ms

Scan SingleColumValueFilter Not Equal (0): 136ms
Scan FilterList with SingleColumValueFilter Not Equal (0): 117ms
Scan Nested FilterList with SingleColumValueFilter Not Equal (0): 128ms
Scan Nested Nested FilterList with SingleColumValueFilter Not Equal (0): 207ms

Scan PrefixFilter (0): 155ms
Scan FilterList with PrefixFilter (0): 117ms
Scan Nested FilterList with PrefixFilter (0): 136ms
Scan Nested Nested FilterList with PrefixFilter (0): 106ms

Get: 440ms
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12855218" author="stack" created="Fri, 9 Apr 2010 00:03:33 +0000"  >&lt;p&gt;I&apos;d say commit J-D.  The change is localized to FiltterList and I don&apos;t see how it can harm.&lt;/p&gt;</comment>
                            <comment id="12855221" author="jdcryans" created="Fri, 9 Apr 2010 00:11:38 +0000"  >&lt;p&gt;Committed to trunk, branch and pre-durab.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12441233" name="HBASE-2346.patch" size="1023" author="jdcryans" created="Thu, 8 Apr 2010 23:45:03 +0000"/>
                            <attachment id="12439281" name="ScanFilterTest.java" size="5316" author="seelmann" created="Fri, 19 Mar 2010 15:30:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 19 Mar 2010 16:35:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26267</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 37 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08sm7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49236</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>