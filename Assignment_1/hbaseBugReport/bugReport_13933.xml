<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:48:04 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13933/HBASE-13933.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13933] DBE&apos;s seekBefore with tags corrupts the tag&apos;s offset information thus leading to incorrect results</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13933</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The problem occurs with moveToPrevious() case and incase of tags we copy the previous pointer&apos;s tag info to the current because already decoded the tags.&lt;br/&gt;
Will check once again before I post other details.  I have a test case to reproduce the problem. Found this while working with MultibyteBuffers and verified if this is present in trunk - it is in all branches where we have tags compression (I suppose) will verify&lt;/p&gt;</description>
                <environment></environment>
        <key id="12838775">HBASE-13933</key>
            <summary>DBE&apos;s seekBefore with tags corrupts the tag&apos;s offset information thus leading to incorrect results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ram_krish">ramkrishna.s.vasudevan</assignee>
                                    <reporter username="ram_krish">ramkrishna.s.vasudevan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Jun 2015 12:26:36 +0000</created>
                <updated>Fri, 18 Dec 2015 00:32:28 +0000</updated>
                            <resolved>Mon, 22 Jun 2015 05:42:21 +0000</resolved>
                                    <version>1.0.0</version>
                    <version>2.0.0</version>
                    <version>1.0.1</version>
                    <version>1.1.0</version>
                    <version>0.98.13</version>
                    <version>1.0.1.1</version>
                    <version>1.1.0.1</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>0.98.14</fixVersion>
                    <fixVersion>1.0.2</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.1.1</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>io</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14591710" author="ram_krish" created="Thu, 18 Jun 2015 12:29:10 +0000"  >&lt;p&gt;Just apply this to the TestSeekTo test case and you could see that there is an exception when the test tries to retrieve the row part from the cell retrieved. The error is due to the fact that the tagsOffset is wrong and thus the copy throws IndexOutofBound during Array copy. So this could just happen in a case where we have tags and would want to read the tags part from a Cell like VC or ACL.&lt;/p&gt;</comment>
                            <comment id="14591888" author="anoop.hbase" created="Thu, 18 Jun 2015 14:32:55 +0000"  >&lt;p&gt;Debugging with the test case change u suggested, seems this is the issue..  With below change the test passes&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
--- a/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java
+++ b/hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java
@@ -197,6 +197,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; class BufferedDataBlockEncoder &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; DataBlockEncoder {
       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (nextState.tagCompressionContext != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
         tagCompressionContext = nextState.tagCompressionContext;
       }
+      tagsOffset = nextState.tagsOffset;
     }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Any thing else missing ?&lt;/p&gt;</comment>
                            <comment id="14591897" author="anoop.hbase" created="Thu, 18 Jun 2015 14:35:28 +0000"  >&lt;blockquote&gt;&lt;p&gt;it is in all branches where we have tags compression (I suppose) will verify&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This should be present in all branches. Issue is when tag compression is NOT there and cells have tags.&lt;/p&gt;</comment>
                            <comment id="14592048" author="ram_krish" created="Thu, 18 Jun 2015 16:21:32 +0000"  >&lt;p&gt;Yes this happens when there is no TagCompression. I have a patch will upload after writing some test case. &lt;/p&gt;</comment>
                            <comment id="14593045" author="ram_krish" created="Fri, 19 Jun 2015 05:49:53 +0000"  >&lt;p&gt;Patch with refactored TestSeekTo test cases.  Now TestSeekTo works with NONE and all DBE cases.&lt;br/&gt;
Found couple of other issues particularly with Prefix Tree and one improvement.&lt;br/&gt;
The PREFIX_TREE case the firstKeyFromBlock logic was wrong - it was trying to copy the firstkey to a BB but setting the position of the BB to its limit. So when the BB was used in the reader it was not able to form the nextIndexKey. Fixed that in this JIRA so that the test cases passes.&lt;br/&gt;
Also the compareKey in Preifx Tree can be done directly on the ptSearcher.current() instead of copying to a BB. Also done in this patch.(not a bug - just a minor change)&lt;br/&gt;
The other difference between all DBEs and Prefix Tree is that when we seek to a key after the last key all the DBEs will point to the last key when we do scanner.getKeyValue.  But Prefix_Tree is giving a null. Is it fine to have this behaviourial change? May be in normal scan this will not happen? This can be done in a seperate JIRA.&lt;/p&gt;

&lt;p&gt;Another improvement is that getFirstKeyInDataBlock can be changed to Cell.  So that in the seekBefore we need not convert the BB to KeyOnlyKeyValue twice once in comparison and if the comparison fails again in the loadBlock.&lt;/p&gt;</comment>
                            <comment id="14593203" author="anoop.hbase" created="Fri, 19 Jun 2015 08:45:44 +0000"  >&lt;p&gt;Can we pull out the prefix tree optimization/fix out of this Jira? It wont match with the title and description.&lt;/p&gt;</comment>
                            <comment id="14593217" author="ram_krish" created="Fri, 19 Jun 2015 08:53:55 +0000"  >&lt;p&gt;Okie. But for the TestSeekTo testcase to pass with Prefix Tree - we need those changes. Otherwise I have to make the test to work without Preifxtree for now. The optimization I agree we can remove it. &lt;/p&gt;</comment>
                            <comment id="14593250" author="anoop.hbase" created="Fri, 19 Jun 2015 09:12:29 +0000"  >&lt;p&gt;+1 for making test to work with all other DBEs. You have &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13939&quot; title=&quot;Make HFileReaderImpl.getFirstKeyInBlock() to return a Cell&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13939&quot;&gt;&lt;del&gt;HBASE-13939&lt;/del&gt;&lt;/a&gt; which would alone solve the issue with prefix tree seekBefore. So let us handle it there.&lt;/p&gt;</comment>
                            <comment id="14593264" author="ram_krish" created="Fri, 19 Jun 2015 09:37:21 +0000"  >&lt;p&gt;Updated patch - only handles seekBefore case with tags. &lt;/p&gt;</comment>
                            <comment id="14593282" author="anoop.hbase" created="Fri, 19 Jun 2015 10:09:18 +0000"  >&lt;p&gt;+1. Good find.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (encoding == DataBlockEncoding.PREFIX_TREE) {
321	      &lt;span class=&quot;code-comment&quot;&gt;// TODO : Fix &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
&lt;/span&gt;322	      assertEquals(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, scanner.getKeyValue());
323	    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
324	      assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;k&quot;&lt;/span&gt;, toRowStr(scanner.getKeyValue()));
325	    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now you don&apos;t need this in the test.  Is this another bug with PREFIX_TREE?  Have any Jira?&lt;/p&gt;</comment>
                            <comment id="14593314" author="ram_krish" created="Fri, 19 Jun 2015 10:47:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;The other difference between all DBEs and Prefix Tree is that when we seek to a key after the last key all the DBEs will point to the last key when we do scanner.getKeyValue. But Prefix_Tree is giving a null. Is it fine to have this behaviourial change? May be in normal scan this will not happen? This can be done in a seperate JIRA.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The if condition in the test case is for the above condition. Will raise a seperate JIRA for that.  Let it be there. Once we do &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13933&quot; title=&quot;DBE&amp;#39;s seekBefore with tags corrupts the tag&amp;#39;s offset information thus leading to incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13933&quot;&gt;&lt;del&gt;HBASE-13933&lt;/del&gt;&lt;/a&gt; that will be needed. &lt;/p&gt;</comment>
                            <comment id="14593563" author="ndimiduk" created="Fri, 19 Jun 2015 16:02:00 +0000"  >&lt;p&gt;Do you have a patch for branch-1.1 &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;? I&apos;d like to post 1.1.1RC0 today. Thanks.&lt;/p&gt;</comment>
                            <comment id="14593740" author="ram_krish" created="Fri, 19 Jun 2015 18:21:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt;&lt;br/&gt;
Attaching the patch for branch-1.1.  I just logged in seeing your message.  I will not be able to commit it now in all branches.  Do you mind if I commit them tomorrow morning? Or feel free to commit.&lt;/p&gt;</comment>
                            <comment id="14593742" author="ndimiduk" created="Fri, 19 Jun 2015 18:24:30 +0000"  >&lt;p&gt;I was planning to back port and commit your more conservative patch to all branches today, as part of cleanup for the RC. I can do the needful here, no problem.&lt;/p&gt;</comment>
                            <comment id="14593994" author="hadoopqa" created="Fri, 19 Jun 2015 21:36:09 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12740700/HBASE-13933_branch-1.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12740700/HBASE-13933_branch-1.1.patch&lt;/a&gt;&lt;br/&gt;
  against branch-1.1 branch at commit 8ae4b374e3fa4cd54b8b83bc857d41f0678ad9b6.&lt;br/&gt;
  ATTACHMENT ID: 12740700&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14472//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14472//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14472//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14472//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14472//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14472//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14472//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14472//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14594010" author="ndimiduk" created="Fri, 19 Jun 2015 21:44:39 +0000"  >&lt;p&gt;Pushed to master and the branch-1&apos;s. &lt;tt&gt;mvn clean test -Dtest=org.apache.hadoop.hbase.io.*&lt;/tt&gt; passed everywhere I pushed. Need more work to backport to 0.98. There&apos;s other fields we&apos;re not copying from &lt;tt&gt;nextState&lt;/tt&gt; so I want to spend some more time with it.&lt;/p&gt;</comment>
                            <comment id="14594251" author="hudson" created="Sat, 20 Jun 2015 01:23:12 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6584 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6584/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6584/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13933&quot; title=&quot;DBE&amp;#39;s seekBefore with tags corrupts the tag&amp;#39;s offset information thus leading to incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13933&quot;&gt;&lt;del&gt;HBASE-13933&lt;/del&gt;&lt;/a&gt; DBE&apos;s seekBefore with tags corrupts the tag&apos;s offset information thus leading to incorrect results (ramkrishna.s.vasudevan) (ndimiduk: rev db08013ebeeaa85802d9795cc72b4c29c5338a47)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14594297" author="hudson" created="Sat, 20 Jun 2015 02:16:29 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #968 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/968/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/968/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13933&quot; title=&quot;DBE&amp;#39;s seekBefore with tags corrupts the tag&amp;#39;s offset information thus leading to incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13933&quot;&gt;&lt;del&gt;HBASE-13933&lt;/del&gt;&lt;/a&gt; DBE&apos;s seekBefore with tags corrupts the tag&apos;s offset information thus leading to incorrect results (ramkrishna.s.vasudevan) (ndimiduk: rev 5685b6ed49539a463a23f1639448fd2f4e82bd9c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14594302" author="hudson" created="Sat, 20 Jun 2015 02:38:26 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.1 #551 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/551/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/551/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13933&quot; title=&quot;DBE&amp;#39;s seekBefore with tags corrupts the tag&amp;#39;s offset information thus leading to incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13933&quot;&gt;&lt;del&gt;HBASE-13933&lt;/del&gt;&lt;/a&gt; DBE&apos;s seekBefore with tags corrupts the tag&apos;s offset information thus leading to incorrect results (ramkrishna.s.vasudevan) (ndimiduk: rev f023b11d5ccf8b7da5c5285d4b6398130e9a61ed)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14594460" author="hudson" created="Sat, 20 Jun 2015 08:01:36 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2 #21 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/21/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/21/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13933&quot; title=&quot;DBE&amp;#39;s seekBefore with tags corrupts the tag&amp;#39;s offset information thus leading to incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13933&quot;&gt;&lt;del&gt;HBASE-13933&lt;/del&gt;&lt;/a&gt; DBE&apos;s seekBefore with tags corrupts the tag&apos;s offset information thus leading to incorrect results (ramkrishna.s.vasudevan) (ndimiduk: rev bf3bacec413a44f51e07416b6c7608db135d0bcc)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14594467" author="hudson" created="Sat, 20 Jun 2015 08:36:07 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3 #8 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/8/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/8/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13933&quot; title=&quot;DBE&amp;#39;s seekBefore with tags corrupts the tag&amp;#39;s offset information thus leading to incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13933&quot;&gt;&lt;del&gt;HBASE-13933&lt;/del&gt;&lt;/a&gt; DBE&apos;s seekBefore with tags corrupts the tag&apos;s offset information thus leading to incorrect results (ramkrishna.s.vasudevan) (ndimiduk: rev 34cd3377f89215f0df90b13267a13b7f948d6eab)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14595358" author="ram_krish" created="Mon, 22 Jun 2015 04:41:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt;&lt;br/&gt;
Thanks for the commits.   I will give you an 0.98 patch after verifying.&lt;/p&gt;</comment>
                            <comment id="14595392" author="ram_krish" created="Mon, 22 Jun 2015 05:34:30 +0000"  >&lt;p&gt;0.98 patch.  The SeekerState and ClonedSeekerState changes are not there in 0.98. Hence some differences.  This patch should work for 0.98 case.&lt;/p&gt;</comment>
                            <comment id="14595396" author="ram_krish" created="Mon, 22 Jun 2015 05:42:21 +0000"  >&lt;p&gt;Pushed to 0.98 branch also. thanks for the reviews Anoop and Nick.&lt;/p&gt;</comment>
                            <comment id="14595397" author="anoop.hbase" created="Mon, 22 Jun 2015 05:42:31 +0000"  >&lt;p&gt;+1 for 0.98 patch.&lt;/p&gt;</comment>
                            <comment id="14595413" author="hudson" created="Mon, 22 Jun 2015 06:21:09 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #987 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/987/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/987/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13933&quot; title=&quot;DBE&amp;#39;s seekBefore with tags corrupts the tag&amp;#39;s offset information thus leading to incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13933&quot;&gt;&lt;del&gt;HBASE-13933&lt;/del&gt;&lt;/a&gt; - DBE&apos;s seekBefore with tags corrupts the tag&apos;s offset (ramkrishna: rev 213458b771fb6b91357034c826cc6030ccc0e02d)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14595498" author="hadoopqa" created="Mon, 22 Jun 2015 08:28:49 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12740956/HBASE-13933_0.98.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12740956/HBASE-13933_0.98.patch&lt;/a&gt;&lt;br/&gt;
  against 0.98 branch at commit a4bd2b784e6da17e7b81b8666c876ebc716e167b.&lt;br/&gt;
  ATTACHMENT ID: 12740956&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 24 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14495//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14595709" author="hudson" created="Mon, 22 Jun 2015 10:06:52 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #1034 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/1034/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/1034/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13933&quot; title=&quot;DBE&amp;#39;s seekBefore with tags corrupts the tag&amp;#39;s offset information thus leading to incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13933&quot;&gt;&lt;del&gt;HBASE-13933&lt;/del&gt;&lt;/a&gt; - DBE&apos;s seekBefore with tags corrupts the tag&apos;s offset (ramkrishna: rev 213458b771fb6b91357034c826cc6030ccc0e02d)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/io/encoding/BufferedDataBlockEncoder.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14596155" author="ndimiduk" created="Mon, 22 Jun 2015 16:18:55 +0000"  >&lt;p&gt;Thanks Ram.&lt;/p&gt;</comment>
                            <comment id="14724218" author="enis" created="Mon, 31 Aug 2015 22:39:37 +0000"  >&lt;p&gt;Closing this issue after 1.0.2 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12740372" name="HBASE-13933.patch" size="1371" author="ram_krish" created="Thu, 18 Jun 2015 12:29:10 +0000"/>
                            <attachment id="12740956" name="HBASE-13933_0.98.patch" size="9823" author="ram_krish" created="Mon, 22 Jun 2015 05:34:30 +0000"/>
                            <attachment id="12740614" name="HBASE-13933_2.patch" size="15135" author="ram_krish" created="Fri, 19 Jun 2015 09:37:21 +0000"/>
                            <attachment id="12740700" name="HBASE-13933_branch-1.1.patch" size="13156" author="ram_krish" created="Fri, 19 Jun 2015 18:21:52 +0000"/>
                            <attachment id="12740579" name="HBASE-13993_1.patch" size="16704" author="ram_krish" created="Fri, 19 Jun 2015 05:49:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 18 Jun 2015 14:32:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 15 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2g7fb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>