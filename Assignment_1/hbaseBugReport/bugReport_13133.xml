<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:40:03 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13133/HBASE-13133.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13133] NPE when running TestSplitLogManager</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13133</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6187/testReport/junit/org.apache.hadoop.hbase.master/TestSplitLogManager/testOrphanTaskAcquisition/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6187/testReport/junit/org.apache.hadoop.hbase.master/TestSplitLogManager/testOrphanTaskAcquisition/&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-03-01 01:34:58,902 INFO  [Thread-23] master.TestSplitLogManager(298): TestOrphanTaskAcquisition
2015-03-01 01:34:58,904 DEBUG [Thread-23] coordination.ZKSplitLogManagerCoordination(870): Distributed log replay=true
2015-03-01 01:34:58,907 INFO  [Thread-23] coordination.ZKSplitLogManagerCoordination(594): found orphan task orphan%2Ftest%2Fslash
2015-03-01 01:34:58,913 INFO  [Thread-23] coordination.ZKSplitLogManagerCoordination(598): Found 1 orphan tasks and 0 rescan nodes
2015-03-01 01:34:58,913 ERROR [main-EventThread] zookeeper.ClientCnxn$EventThread(613): Caught unexpected throwable
java.lang.NullPointerException
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination.findOrCreateOrphanTask(ZKSplitLogManagerCoordination.java:546)
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination.heartbeat(ZKSplitLogManagerCoordination.java:556)
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination.getDataSetWatchSuccess(ZKSplitLogManagerCoordination.java:467)
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination.access$700(ZKSplitLogManagerCoordination.java:74)
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination$GetDataAsyncCallback.processResult(ZKSplitLogManagerCoordination.java:1020)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:561)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:498)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I got this NPE almost every time when running TestSplitLogManager locally. I am not sure whether it is the root cause of test failing, but seems related.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12778647">HBASE-13133</key>
            <summary>NPE when running TestSplitLogManager</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="octo47">Andrey Stepachev</assignee>
                                    <reporter username="Apache9">Duo Zhang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Mar 2015 00:31:58 +0000</created>
                <updated>Tue, 28 Apr 2015 19:18:37 +0000</updated>
                            <resolved>Mon, 2 Mar 2015 03:55:15 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.0.1</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14342576" author="octo47" created="Mon, 2 Mar 2015 01:10:03 +0000"  >&lt;p&gt;not sure about root of the problem, but it seems can happen that async read callback was set&lt;br/&gt;
in ZKSplitLogManagerCoordination#getDataSetWatch and called before &lt;br/&gt;
method SplitLogManagerCoordination#setDetails was called and details were set.&lt;br/&gt;
it seems that patch can be very straitforward, need to change order of initialization.&lt;/p&gt;

&lt;p&gt;but other possibility for that is not set coordination engine, in that case details would not&lt;br/&gt;
be initialized, but chore still can be called.&lt;/p&gt;</comment>
                            <comment id="14342577" author="octo47" created="Mon, 2 Mar 2015 01:10:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt;, can you check that this patch can help. thanks.&lt;/p&gt;</comment>
                            <comment id="14342591" author="yuzhihong@gmail.com" created="Mon, 2 Mar 2015 01:21:08 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14342644" author="apache9" created="Mon, 2 Mar 2015 02:49:04 +0000"  >&lt;p&gt;This patch fix the NullPointer, and testOrphanTaskAcquisition does not fail any more.&lt;br/&gt;
But testGetPreviousRecoveryMode is still failing with &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.AssertionError: Mode4=LOG_SPLITTING
	at org.junit.Assert.fail(Assert.java:88)
	at org.junit.Assert.assertTrue(Assert.java:41)
	at org.apache.hadoop.hbase.master.TestSplitLogManager.testGetPreviousRecoveryMode(TestSplitLogManager.java:662)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.FailOnTimeout$StatementThread.run(FailOnTimeout.java:74)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14342673" author="apache9" created="Mon, 2 Mar 2015 03:39:39 +0000"  >&lt;p&gt;+1 on commit this patch first.&lt;/p&gt;

&lt;p&gt;I will open another issue to address testGetPreviousRecoveryMode if I find something.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14342684" author="stack" created="Mon, 2 Mar 2015 03:55:15 +0000"  >&lt;p&gt;Pushed to branch-1+&lt;/p&gt;</comment>
                            <comment id="14342887" author="octo47" created="Mon, 2 Mar 2015 07:54:12 +0000"  >&lt;p&gt;thats good. thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; for confirming.&lt;br/&gt;
thanks Michael, Ted for reviewing.&lt;/p&gt;</comment>
                            <comment id="14351467" author="apache9" created="Sat, 7 Mar 2015 07:39:33 +0000"  >&lt;p&gt;1.0 also has this problem.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-03-07 15:37:00,907 ERROR [main-EventThread] zookeeper.ClientCnxn$EventThread(613): Caught unexpected throwable
java.lang.NullPointerException
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination.findOrCreateOrphanTask(ZKSplitLogManagerCoordination.java:547)
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination.handleUnassignedTask(ZKSplitLogManagerCoordination.java:177)
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination.getDataSetWatchSuccess(ZKSplitLogManagerCoordination.java:466)
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination.access$6(ZKSplitLogManagerCoordination.java:449)
	at org.apache.hadoop.hbase.coordination.ZKSplitLogManagerCoordination$GetDataAsyncCallback.processResult(ZKSplitLogManagerCoordination.java:1037)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:561)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:498)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14352218" author="octo47" created="Sun, 8 Mar 2015 19:41:51 +0000"  >&lt;p&gt;applied to branch-1.0 too, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14352543" author="stack" created="Mon, 9 Mar 2015 04:41:52 +0000"  >&lt;p&gt;Good. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=octo47&quot; class=&quot;user-hover&quot; rel=&quot;octo47&quot;&gt;Andrey Stepachev&lt;/a&gt; for pushing to branch-1.0&lt;/p&gt;</comment>
                            <comment id="14517762" author="enis" created="Tue, 28 Apr 2015 19:18:37 +0000"  >&lt;p&gt;Closing this issue after 1.0.1 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12701754" name="HBASE-13133.patch" size="804" author="octo47" created="Mon, 2 Mar 2015 01:10:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 2 Mar 2015 01:10:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 33 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2681r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>