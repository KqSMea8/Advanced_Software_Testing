<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:26:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5262/HBASE-5262.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5262] Structured event log for HBase for monitoring and auto-tuning performance</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5262</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Creating this JIRA to open a discussion about a structured (machine-readable) log that will record events such as compaction start/end times, compaction input/output files, their sizes, the same for flushes, etc. This can be stored e.g. in a new system table in HBase itself. The data from this log can then be analyzed and used to optimize compactions at run time, or otherwise auto-tune HBase configuration to reduce the number of knobs the user has to configure.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12539522">HBASE-5262</key>
            <summary>Structured event log for HBase for monitoring and auto-tuning performance</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mikhail">Mikhail Bautin</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Jan 2012 19:53:26 +0000</created>
                <updated>Sat, 11 Apr 2015 01:16:04 +0000</updated>
                            <resolved>Sat, 11 Apr 2015 01:16:04 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13191682" author="lhofhansl" created="Tue, 24 Jan 2012 00:26:15 +0000"  >&lt;p&gt;You thinking JSON or something?&lt;/p&gt;</comment>
                            <comment id="13191689" author="mikhail" created="Tue, 24 Jan 2012 00:31:55 +0000"  >&lt;p&gt;JSON could be the encoding for the &quot;value&quot; part of each log entry. However, if we decide to store this type of information in HBase itself, we will need to think through the schema from the point of view of at least couple of different use cases, e.g. analyzing compaction performance, auto-tuning the compaction algorithm, maybe auto-tuning some block cache settings, etc.&lt;/p&gt;</comment>
                            <comment id="13191692" author="tlipcon" created="Tue, 24 Jan 2012 00:35:49 +0000"  >&lt;p&gt;I have some preference against JSON &amp;#8211; IMO JSON isn&apos;t &quot;strict&quot; enough, so people tend to break the format over time without a centralized schema definition to remind them that this is a real interface. I would be happier to see either avro or protobuf used. But definitely +1 for something that&apos;s consumable by non-Java programs and won&apos;t need to be actively upgraded when we add or remove fields.&lt;/p&gt;</comment>
                            <comment id="13191933" author="stack" created="Tue, 24 Jan 2012 06:32:00 +0000"  >&lt;p&gt;@Mikhail Sounds good.  We&apos;d write to hbase because we can&apos;t have many writers write same file in hdfs?  This system table would be a new one, not .META.?  We&apos;d fill it to the end of time or the TTL on the table would get rid of old records (that&apos;d work).&lt;/p&gt;</comment>
                            <comment id="13192179" author="mikhail" created="Tue, 24 Jan 2012 14:34:32 +0000"  >&lt;p&gt;I was thinking of a lightly-loaded system table different from .META.. This way it is easier to control this feature, and we can even make it optional based on the configuration. Storing event log data in HBase makes sense to me because we don&apos;t expect a huge number of records compared to the user&apos;s data itself, and we probably don&apos;t want to implement another logging framework with HDFS file management, cleaning up old files, etc. The multiple writers to one file question is also there. If we store this data in HBase, then yes, we can use TTL to set event log retention to e.g. one month or so, or make it configurable.&lt;/p&gt;</comment>
                            <comment id="13192253" author="stack" created="Tue, 24 Jan 2012 16:24:16 +0000"  >&lt;p&gt;@Mikhail Sounds good to me&lt;/p&gt;</comment>
                            <comment id="13192280" author="zhihyu@ebaysf.com" created="Tue, 24 Jan 2012 17:04:48 +0000"  >&lt;p&gt;One aspect we should consider is the role for opentsdb.&lt;br/&gt;
Would there be redundancy between the event log table and what opentsdb stores in HBase?&lt;/p&gt;</comment>
                            <comment id="13192441" author="mikhail" created="Tue, 24 Jan 2012 19:46:39 +0000"  >&lt;p&gt;I think we could implement something small-scale in HBase itself, so that it can eventually be used for making optimization decisions for compactions and caching. OpenTSDB is probably better for large-scale time series collection. Also, we don&apos;t want to introduce a circular dependency between HBase and OpenTSDB.&lt;/p&gt;</comment>
                            <comment id="13192464" author="zhihyu@ebaysf.com" created="Tue, 24 Jan 2012 20:13:28 +0000"  >&lt;p&gt;Can we approach this from the perspective of what information is needed for compactions and caching decision making ?&lt;/p&gt;

&lt;p&gt;We should also provide abstraction in providing such information so that there can be multiple sources of information the decision making can be based.&lt;/p&gt;</comment>
                            <comment id="13192491" author="mikhail" created="Tue, 24 Jan 2012 20:47:00 +0000"  >&lt;p&gt;Some of the information needed for compaction decision making:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Compaction start time&lt;/li&gt;
	&lt;li&gt;For each compaction input file:&lt;/li&gt;
	&lt;li&gt;Size&lt;/li&gt;
	&lt;li&gt;Number of key/value pairs&lt;/li&gt;
	&lt;li&gt;Average key/value size&lt;/li&gt;
	&lt;li&gt;other metadata&lt;/li&gt;
	&lt;li&gt;Compaction end time&lt;/li&gt;
	&lt;li&gt;Compaction status (success, failure)&lt;/li&gt;
	&lt;li&gt;The same metadata as above for the compaction output file&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I am not yet sure what information we would like to collect for caching decision making&#8212;that needs more thinking.&lt;/p&gt;

&lt;p&gt;We could also collect &quot;region history&quot;, e.g. region open / close events:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Region name&lt;/li&gt;
	&lt;li&gt;Event type&lt;/li&gt;
	&lt;li&gt;Server where the region was opened or closed&lt;/li&gt;
	&lt;li&gt;Reason&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;That would allow to detect problematic regions that move from machine to machine automatically.&lt;/p&gt;

&lt;p&gt;I agree that it would make sense to isolate information collection logic from decision making logic, so that external adaptive cluster tuning tools and/or external sources of information could be plugged in.&lt;/p&gt;</comment>
                            <comment id="13192500" author="tlipcon" created="Tue, 24 Jan 2012 20:53:17 +0000"  >&lt;p&gt;Also we should isolate the writing of this table to a separate thread with a bounded queue (which drops off the end if it becomes full). Otherwise we may run into issues where the logging of information may actually cause operations to fail, or cause deadlocks, etc. (eg a write to a region causes a flush which causes a write to the eventlog table on the same server, but all of the IPC threads are blocked because of the ongoing flush, so the eventlog write never completes). So, we should always assume that the information in the event log is potentially lossy, and only use it for heuristics and diagnosis, not for anything critical to operation.&lt;/p&gt;</comment>
                            <comment id="13192504" author="mikhail" created="Tue, 24 Jan 2012 20:56:20 +0000"  >&lt;p&gt;@Todd: I totally agree. We should also disable event logging for the event log table itself.&lt;/p&gt;</comment>
                            <comment id="13192603" author="stack" created="Tue, 24 Jan 2012 22:11:34 +0000"  >&lt;p&gt;@Mikhail We used have an extra column family in .META. called history.  Into it we&apos;d write &apos;events&apos;.  It was stripped because though a nice idea, it caused more trouble than it was worth (x-cluster deadlocking, interfering w/ shutdowns, growing at a different rate to the info family in .META.)...so yeah, should fail fast if can&apos;t put events, etc.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 24 Jan 2012 00:26:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>225024</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 47 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ht2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101971</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>