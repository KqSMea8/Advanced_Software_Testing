<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:07:11 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3079/HBASE-3079.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3079] Shell displaying uninformative exceptions</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3079</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The shell seems to hang longer than the normal client and then display uninformative messages when doing wrong things.&lt;/p&gt;

&lt;p&gt;For example, inserting into a non-existing family or reading from a disabled table.  I believe in both these cases, HTable will throw informative exceptions like InvalidFamilyException and TableDisabledException (need to confirm exactly what it does).&lt;/p&gt;

&lt;p&gt;But in the shell, I get things like:&lt;/p&gt;

&lt;p&gt;Inserting to a family that does not exist:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR: org.apache.hadoop.hbase.client.RetriesExhaustedException: Still had 1 puts left after retrying 7 times.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Reading from a disabled table (this takes a long time before anything is displayed):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
ERROR: org.apache.hadoop.hbase.client.RetriesExhaustedException: Trying to contact region server 10.0.0.4:62505 for region sample,,1286217181143.1459f8fdde55752fd91022fb1153d39a., row &apos;&apos;, but failed after 7 attempts.
Exceptions:
org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: sample,,1286217181143.1459f8fdde55752fd91022fb1153d39a.
	at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:2221)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.openScanner(HRegionServer.java:1812)
	at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:557)
	at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1007)

org.apache.hadoop.hbase.client.RegionOfflineException: region offline: sample,,1286217181143.1459f8fdde55752fd91022fb1153d39a.
org.apache.hadoop.hbase.client.RegionOfflineException: region offline: sample,,1286217181143.1459f8fdde55752fd91022fb1153d39a.
org.apache.hadoop.hbase.client.RegionOfflineException: region offline: sample,,1286217181143.1459f8fdde55752fd91022fb1153d39a.
org.apache.hadoop.hbase.client.RegionOfflineException: region offline: sample,,1286217181143.1459f8fdde55752fd91022fb1153d39a.
org.apache.hadoop.hbase.client.RegionOfflineException: region offline: sample,,1286217181143.1459f8fdde55752fd91022fb1153d39a.
org.apache.hadoop.hbase.client.RegionOfflineException: region offline: sample,,1286217181143.1459f8fdde55752fd91022fb1153d39a.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12475789">HBASE-3079</key>
            <summary>Shell displaying uninformative exceptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ryanobjc">ryan rawson</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Oct 2010 18:40:18 +0000</created>
                <updated>Fri, 12 Oct 2012 06:17:51 +0000</updated>
                            <resolved>Thu, 11 Nov 2010 16:16:03 +0000</resolved>
                                    <version>0.89.20100924</version>
                                    <fixVersion>0.90.0</fixVersion>
                                    <component>shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12926685" author="stack" created="Sun, 31 Oct 2010 06:32:07 +0000"  >&lt;p&gt;This is way wrong (I&apos;m trying to add a row on a column family that doesn&apos;t exist):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hbase(main):002:0&amp;gt; describe &apos;a&apos;
DESCRIPTION                                                                                                                                                                ENABLED                                                                                       
 {NAME =&amp;gt; &apos;a&apos;, FAMILIES =&amp;gt; [{NAME =&amp;gt; &apos;b&apos;, BLOOMFILTER =&amp;gt; &apos;NONE&apos;, REPLICATION_SCOPE =&amp;gt; &apos;0&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, VERSIONS =&amp;gt; &apos;3&apos;, TTL =&amp;gt; &apos;2147483647&apos;, BLOCKSIZE =&amp;gt; &apos;6553 &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;                                                                                          
 6&apos;, IN_MEMORY =&amp;gt; &apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;, BLOCKCACHE =&amp;gt; &apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;}]}                                                                                                                                                                                                                       
1 row(s) in 0.3880 seconds

hbase(main):003:0&amp;gt; put &apos;a&apos;, &apos;a&apos;, &apos;c:c&apos;, &apos;d&apos;




ERROR: java.io.IOException: java.io.IOException: java.io.IOException: java.lang.AssertionError
        at org.apache.hadoop.hbase.regionserver.HRegion.doMiniBatchPut(HRegion.java:1425)
        at org.apache.hadoop.hbase.regionserver.HRegion.put(HRegion.java:1366)
        at org.apache.hadoop.hbase.regionserver.HRegionServer.multi(HRegionServer.java:2415)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:561)
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1025)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="12927311" author="stack" created="Tue, 2 Nov 2010 05:59:43 +0000"  >&lt;p&gt;When I go to count a disabled table I get:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hbase(main):012:0&amp;gt; count &apos;usertable&apos;

ERROR: java.lang.reflect.UndeclaredThrowableException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;

Here is some help &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; command:
          Count the number of rows in a table. This operation may take a LONG
          time (Run &apos;$HADOOP_HOME/bin/hadoop jar hbase.jar rowcount&apos; to run a
          counting mapreduce job). Current count is shown every 1000 rows by
          &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;. Count interval may be optionally specified. Scan caching
          is enabled on count scans by &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;. Default cache size is 10 rows.
          If your rows are small in size, you may want to increase &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
          parameter. Examples:

          hbase&amp;gt; count &apos;t1&apos;
          hbase&amp;gt; count &apos;t1&apos;, INTERVAL =&amp;gt; 100000
          hbase&amp;gt; count &apos;t1&apos;, CACHE =&amp;gt; 1000
          hbase&amp;gt; count &apos;t1&apos;, INTERVAL =&amp;gt; 10, CACHE =&amp;gt; 1000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12930434" author="ryanobjc" created="Wed, 10 Nov 2010 02:03:13 +0000"  >&lt;p&gt;the changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2898&quot; title=&quot;MultiPut makes proper error handling impossible and leads to corrupted data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2898&quot;&gt;&lt;del&gt;HBASE-2898&lt;/del&gt;&lt;/a&gt; will substantially improve these error messages.  Here is an example from a unit test:&lt;/p&gt;


&lt;p&gt;2010-11-09 17:59:56,093 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; client.TestMultiParallel(162): org.apache.hadoop.hbase.client.RetriesExhaustedWithDetailsException: Failed 1 action: NoSuchColumnFamilyException: 1 time, servers with issues: localhost:50070, &lt;/p&gt;

&lt;p&gt;We could beef up the exception text a bit, but I think this is a good step forward.&lt;/p&gt;

&lt;p&gt;The UndeclaredThrowableException is kind of annoying, we can probably unwrap it a bit in jruby.&lt;/p&gt;</comment>
                            <comment id="12930436" author="streamy" created="Wed, 10 Nov 2010 02:05:08 +0000"  >&lt;p&gt;I&apos;m not following the connection of this jira to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2898&quot; title=&quot;MultiPut makes proper error handling impossible and leads to corrupted data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2898&quot;&gt;&lt;del&gt;HBASE-2898&lt;/del&gt;&lt;/a&gt;.  This jira is just about the shell not properly displaying the exceptions we already have?&lt;/p&gt;</comment>
                            <comment id="12930444" author="ryanobjc" created="Wed, 10 Nov 2010 02:17:39 +0000"  >&lt;p&gt;this jira is also about lame exceptions like:&lt;/p&gt;


&lt;p&gt;ERROR: org.apache.hadoop.hbase.client.RetriesExhaustedException: Still had 1 puts left after retrying 7 times.&lt;/p&gt;


&lt;p&gt;When the REAL problem was a no such family exception.&lt;/p&gt;

&lt;p&gt;There is no amount of shell hackery to fix a broken exception. &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2898&quot; title=&quot;MultiPut makes proper error handling impossible and leads to corrupted data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2898&quot;&gt;&lt;del&gt;HBASE-2898&lt;/del&gt;&lt;/a&gt; fixes those exceptions, which fixes the output, which helps address this issue (in part).&lt;/p&gt;</comment>
                            <comment id="12930449" author="streamy" created="Wed, 10 Nov 2010 02:26:01 +0000"  >&lt;p&gt;makes sense, thanks.  there&apos;s still an issue in the shell though, right?&lt;/p&gt;</comment>
                            <comment id="12930458" author="ryanobjc" created="Wed, 10 Nov 2010 03:25:11 +0000"  >&lt;p&gt;things seem to be much better in the latest, although we don&apos;t say &apos;the table is offline&apos; when we run into problems:&lt;/p&gt;

&lt;p&gt;hbase(main):006:0&amp;gt; put &apos;test&apos;, &apos;row&apos;, &apos;bad:jojo&apos;, &apos;value&apos;&lt;/p&gt;

&lt;p&gt;ERROR: org.apache.hadoop.hbase.client.RetriesExhaustedWithDetailsException: Failed 1 action: NoSuchColumnFamilyException: 1 time, servers with issues: sv4borg234:60020, &lt;/p&gt;

&lt;p&gt;hbase(main):007:0&amp;gt; disable &apos;test&apos;&lt;br/&gt;
0 row(s) in 0.0330 seconds&lt;/p&gt;

&lt;p&gt;hbase(main):008:0&amp;gt; put &apos;test&apos;, &apos;row&apos;, &apos;bad:jojo&apos;, &apos;value&apos;&lt;/p&gt;

&lt;p&gt;ERROR: org.apache.hadoop.hbase.client.RetriesExhaustedWithDetailsException: Failed 1 action: NotServingRegionException: 1 time, servers with issues: sv4borg234:60020, &lt;/p&gt;

&lt;p&gt;hbase(main):010:0&amp;gt; count &apos;test&apos;&lt;/p&gt;

&lt;p&gt;ERROR: org.apache.hadoop.hbase.client.RetriesExhaustedException: Trying to contact region server sv4borg234:60020 for region test,,1289359289116.7798c2aa758a7f8b855819cacafd0180., row &apos;&apos;, but failed after 7 attempts.&lt;br/&gt;
Exceptions:&lt;br/&gt;
org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Region is not online: test,,1289359289116.7798c2aa758a7f8b855819cacafd0180.&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:2190)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.openScanner(HRegionServer.java:1670)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:570)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1036)&lt;/p&gt;

&lt;p&gt;org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Region is not online: test,,1289359289116.7798c2aa758a7f8b855819cacafd0180.&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:2190)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.openScanner(HRegionServer.java:1670)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:570)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1036)&lt;/p&gt;

&lt;p&gt;org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Region is not online: test,,1289359289116.7798c2aa758a7f8b855819cacafd0180.&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:2190)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.openScanner(HRegionServer.java:1670)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:570)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1036)&lt;/p&gt;

&lt;p&gt;org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Region is not online: test,,1289359289116.7798c2aa758a7f8b855819cacafd0180.&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:2190)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.openScanner(HRegionServer.java:1670)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:570)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1036)&lt;/p&gt;

&lt;p&gt;org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Region is not online: test,,1289359289116.7798c2aa758a7f8b855819cacafd0180.&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:2190)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.openScanner(HRegionServer.java:1670)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:570)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1036)&lt;/p&gt;

&lt;p&gt;org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Region is not online: test,,1289359289116.7798c2aa758a7f8b855819cacafd0180.&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:2190)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.openScanner(HRegionServer.java:1670)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:570)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1036)&lt;/p&gt;

&lt;p&gt;org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Region is not online: test,,1289359289116.7798c2aa758a7f8b855819cacafd0180.&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:2190)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.openScanner(HRegionServer.java:1670)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor23.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:570)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1036)&lt;/p&gt;



&lt;p&gt;We could probably wrap some exception reporting and check to see if the table is online or not.  Seems like a common use case people run into&lt;/p&gt;</comment>
                            <comment id="12930805" author="stack" created="Wed, 10 Nov 2010 21:56:15 +0000"  >&lt;p&gt;I tried this on cluster.  For disabled table it does right thing.  For put to non-existent family, I ran into NPE... after hacking around that I go this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
10/11/10 21:54:05 DEBUG client.MetaScanner: Scanning .META. starting at row=usertable,user992934061,00000000000000 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; max=10 rows
10/11/10 21:54:05 INFO client.HConnectionManager$HConnectionImplementation: Removed usertable,user992934061,1288992609496.686d4b2520f56c32877d51bcc08b355a. &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; tableName=usertable from cache because of x

ERROR: org.apache.hadoop.hbase.client.RetriesExhaustedWithDetailsException: Failed 1 action: servers with issues: sv2borg187:60020,
Backtrace: org/apache/hadoop/hbase/client/HConnectionManager.java:1218:in `processBatch&apos;
           org/apache/hadoop/hbase/client/HConnectionManager.java:1232:in `processBatchOfPuts&apos;
           org/apache/hadoop/hbase/client/HTable.java:819:in `flushCommits&apos;
           org/apache/hadoop/hbase/client/HTable.java:675:in `doPut&apos;
           org/apache/hadoop/hbase/client/HTable.java:660:in `put&apos;
           sun/reflect/NativeMethodAccessorImpl.java:-2:in `invoke0&apos;
           sun/reflect/NativeMethodAccessorImpl.java:39:in `invoke&apos;
           sun/reflect/DelegatingMethodAccessorImpl.java:25:in `invoke&apos;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Over on the regionserver I see this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2010-11-10 21:52:35,977 WARN org.apache.hadoop.hbase.regionserver.HRegion: No such column family in batch put
org.apache.hadoop.hbase.regionserver.NoSuchColumnFamilyException: Column family x does not exist in region usertable,user992934061,1288992609496.686d4b2520f56c32877d51bcc08b355a. in table {NAME =&amp;gt; &apos;usertable&apos;, FAMILIES =&amp;gt; [{NAME =&amp;gt; &apos;values&apos;, BLOOMFILTER =&amp;gt; &apos;NONE&apos;,        REPLICATION_SCOPE =&amp;gt; &apos;0&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, VERSIONS =&amp;gt; &apos;3&apos;, TTL =&amp;gt; &apos;2147483647&apos;, BLOCKSIZE =&amp;gt; &apos;65536&apos;, IN_MEMORY =&amp;gt; &apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;, BLOCKCACHE =&amp;gt; &apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;}]}
    at org.apache.hadoop.hbase.regionserver.HRegion.checkFamily(HRegion.java:3126)
    at org.apache.hadoop.hbase.regionserver.HRegion.checkFamilies(HRegion.java:1705)
    at org.apache.hadoop.hbase.regionserver.HRegion.doMiniBatchPut(HRegion.java:1400)
    at org.apache.hadoop.hbase.regionserver.HRegion.put(HRegion.java:1365)
...

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ryan is on it!&lt;/p&gt;</comment>
                            <comment id="12930938" author="stack" created="Thu, 11 Nov 2010 06:11:17 +0000"  >&lt;p&gt;@Ryan.... so doesn&apos;t look like it was a deploy issue on my part.  Let me explain.&lt;/p&gt;

&lt;p&gt;Here is the change I made just now (after we last talkd):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
index 1cd7f62..5a17df2 100644
--- a/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
+++ b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
@@ -2451,10 +2451,13 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class HRegionServer &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; HRegionInterface, HBaseRPCErrorHandler,
 
           &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.requestCount.addAndGet(puts.size());
 
+            LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;CODE BEFORE lENGTH &quot;&lt;/span&gt;);
           OperationStatusCode[] codes =
               region.put(putsWithLocks.toArray(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Pair[]{}));
 
+            LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;CODE lENGTH &quot;&lt;/span&gt; + codes.length);
           &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;( &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0 ; i &amp;lt; codes.length ; i++) {
+            LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;CODE &quot;&lt;/span&gt; + codes[i]);
             OperationStatusCode code = codes[i];
 
             Action theAction = puts.get(i);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The important addition is &quot;+            LOG.info(&quot;CODE BEFORE lENGTH &quot;);&quot;&lt;/p&gt;

&lt;p&gt;Now if I look in logs I see:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2010-11-11 06:00:59,160 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: CODE BEFORE lENGTH
2010-11-11 06:00:59,160 WARN org.apache.hadoop.hbase.regionserver.HRegion: No such column family in batch put
org.apache.hadoop.hbase.regionserver.NoSuchColumnFamilyException: Column family x does not exist in region usertable,user992934061,1288992609496.686d4b2520f56c32877d51bcc08b355a. in table {NAME =&amp;gt; &apos;usertable&apos;, FAMILIES =&amp;gt; [{NA}
        at org.apache.hadoop.hbase.regionserver.HRegion.checkFamily(HRegion.java:3126)
        at org.apache.hadoop.hbase.regionserver.HRegion.checkFamilies(HRegion.java:1705)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Error is coming up out of &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2454             LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;CODE BEFORE lENGTH &quot;&lt;/span&gt;);
2455           OperationStatusCode[] codes =
2456               region.put(putsWithLocks.toArray(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Pair[]{}));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looking down in minibatch...  why doesn&apos;t this assert go off? (We&apos;re only writing one row...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1423       &lt;span class=&quot;code-comment&quot;&gt;// We&apos;ve now grabbed as many puts off the list as we can
&lt;/span&gt;1424       &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; numReadyToWrite &amp;gt; 0;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;I&apos;m running w/ asserts enabled... export HBASE_OPTS=&quot;-ea -X...&lt;/p&gt;</comment>
                            <comment id="12931045" author="stack" created="Thu, 11 Nov 2010 15:39:20 +0000"  >&lt;p&gt;Here from Ryan:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Turning on RPC level debug we see in the logs now:

2010-11-10 23:47:32,507 DEBUG org.apache.hadoop.ipc.HBaseServer: IPC
Server handler 7 on 60020, call
multi(org.apache.hadoop.hbase.client.MultiAction@20ec6bb1) from
10.10.20.235:55930: error: java.io.IOException:
java.lang.AssertionError
java.io.IOException: java.lang.AssertionError
       at org.apache.hadoop.hbase.regionserver.HRegion.doMiniBatchPut(HRegion.java:1424)
       at org.apache.hadoop.hbase.regionserver.HRegion.put(HRegion.java:1365)
       at org.apache.hadoop.hbase.regionserver.HRegionServer.multi(HRegionServer.java:2454)
       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
       at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
       at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
       at java.lang.reflect.Method.invoke(Method.java:597)
       at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:570)
       at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1036)
2010-11-10 23:47:32,508 DEBUG org.apache.hadoop.ipc.HBaseServer: IPC
Server Responder: responding to #50 from 10.10.20.235:55930
2010-11-10 23:47:32,508 DEBUG org.apache.hadoop.ipc.HBaseServer: IPC
Server Responder: responding to #50 from 10.10.20.235:55930 Wrote 759
bytes.

we could &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; so we it works with -ea:

diff --git a/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java
b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java
index d76bf63..9d8d85d 100644
--- a/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java
+++ b/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java
@@ -1420,7 +1420,10 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class HRegion &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; HeapSize { &lt;span class=&quot;code-comment&quot;&gt;// , Writable{
&lt;/span&gt;        lastIndexExclusive++;
        numReadyToWrite++;
      }
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (numReadyToWrite == 0)
+          &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 0L; &lt;span class=&quot;code-comment&quot;&gt;// no size change.
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// We&apos;ve now grabbed as many puts off the list as we can
&lt;/span&gt;+
      &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; numReadyToWrite &amp;gt; 0;

      &lt;span class=&quot;code-comment&quot;&gt;// ------------------------------------
&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12931062" author="stack" created="Thu, 11 Nov 2010 16:09:25 +0000"  >&lt;p&gt;I just tried the above and it works for me now:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hbase(main):004:0&amp;gt; put &apos;usertable&apos;, &apos;x&apos;, &apos;x:x&apos;, &apos;x&apos;

ERROR: org.apache.hadoop.hbase.client.RetriesExhaustedWithDetailsException: Failed 1 action: NoSuchColumnFamilyException: 1 time, servers with issues: sv2borg183:60020, 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m going to commit the above change (I removed the assert checking for 0 since it won&apos;t ever be after this change goes in).&lt;/p&gt;</comment>
                            <comment id="12931066" author="stack" created="Thu, 11 Nov 2010 16:16:03 +0000"  >&lt;p&gt;Resolving.  Lets open new issues for other shell probs.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 31 Oct 2010 06:32:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26633</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 6 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08sfb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49205</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>