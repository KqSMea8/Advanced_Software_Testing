<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:51:57 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14327/HBASE-14327.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14327] TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14327</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I&apos;m looking into some more of the flaky tests on trunk and this one seems to be  particularly gross, failing about half the time in recent days. Some probably-relevant output from &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6761/testReport/org.apache.hadoop.hbase/TestIOFencing/testFencingAroundCompactionAfterWALSync/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;a recent run&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-08-27 18:50:14,318 INFO  [main] hbase.TestIOFencing(326): Allowing compaction to proceed
2015-08-27 18:50:14,318 DEBUG [main] hbase.TestIOFencing$CompactionBlockerRegion(110): allowing compactions
2015-08-27 18:50:14,318 DEBUG [RS:0;hemera:35619-shortCompactions-1440701403303] regionserver.HStore(1732): Removing store files after compaction...
2015-08-27 18:50:14,323 DEBUG [RS:0;hemera:35619-longCompactions-1440701391112] regionserver.HStore(1732): Removing store files after compaction...
2015-08-27 18:50:14,330 DEBUG [RS:0;hemera:35619-longCompactions-1440701391112] backup.HFileArchiver(224): Archiving compacted store files.
2015-08-27 18:50:14,331 DEBUG [RS:0;hemera:35619-shortCompactions-1440701403303] backup.HFileArchiver(224): Archiving compacted store files.
2015-08-27 18:50:14,337 DEBUG [RS:0;hemera:35619-longCompactions-1440701391112] backup.HFileArchiver(438): Finished archiving from class org.apache.hadoop.hbase.backup.HFileArchiver$FileableStoreFile, file:hdfs://localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/99e903ad7e0f4029862d0e35c5548464, to hdfs://localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/archive/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/99e903ad7e0f4029862d0e35c5548464
2015-08-27 18:50:14,337 DEBUG [RS:0;hemera:35619-shortCompactions-1440701403303] backup.HFileArchiver(438): Finished archiving from class org.apache.hadoop.hbase.backup.HFileArchiver$FileableStoreFile, file:hdfs://localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/74a80cc06d134361941085bc2bb905fe, to hdfs://localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/archive/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/74a80cc06d134361941085bc2bb905fe
2015-08-27 18:50:14,341 DEBUG [RS:0;hemera:35619-longCompactions-1440701391112] backup.HFileArchiver(438): Finished archiving from class org.apache.hadoop.hbase.backup.HFileArchiver$FileableStoreFile, file:hdfs://localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/7067addd325446089ba15ec2c77becbc, to hdfs://localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/archive/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/7067addd325446089ba15ec2c77becbc
2015-08-27 18:50:14,342 INFO  [RS:0;hemera:35619-longCompactions-1440701391112] regionserver.HStore(1353): Completed compaction of 2 (all) file(s) in family of tabletest,,1440701396419.94d6f21f7cf387d73d8622f535c67311. into e138bb0ec6c64ad19efab3b44dbbcb1a(size=68.7 K), total size for store is 146.9 K. This selection was in queue for 0sec, and took 10sec to execute.
2015-08-27 18:50:14,343 INFO  [RS:0;hemera:35619-longCompactions-1440701391112] regionserver.CompactSplitThread$CompactionRunner(527): Completed compaction: Request = regionName=tabletest,,1440701396419.94d6f21f7cf387d73d8622f535c67311., storeName=family, fileCount=2, fileSize=73.1 K, priority=998, time=525052314434020; duration=10sec
2015-08-27 18:50:14,343 DEBUG [RS:0;hemera:35619-shortCompactions-1440701403303] backup.HFileArchiver(438): Finished archiving from class org.apache.hadoop.hbase.backup.HFileArchiver$FileableStoreFile, file:hdfs://localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/2926c09f1941416eb557ee5d283d7e2b, to hdfs://localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/archive/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/2926c09f1941416eb557ee5d283d7e2b
2015-08-27 18:50:14,347 DEBUG [RS_CLOSE_REGION-hemera:35619-0] regionserver.HRegion(1405): Updates disabled for region tabletest,,1440701396419.94d6f21f7cf387d73d8622f535c67311.
2015-08-27 18:50:14,343 DEBUG [RS:0;hemera:35619-longCompactions-1440701391112] regionserver.CompactSplitThread$CompactionRunner(550): CompactSplitThread Status: compaction_queue=(0:3), split_queue=0, merge_queue=0
2015-08-27 18:50:14,348 ERROR [RS:0;hemera:35619-shortCompactions-1440701403303] regionserver.CompactSplitThread$CompactionRunner(547): Compaction failed Request = regionName=tabletest,,1440701396419.94d6f21f7cf387d73d8622f535c67311., storeName=family, fileCount=2, fileSize=51.6 K, priority=998, time=525051341420855
java.lang.NullPointerException
	at org.apache.hadoop.hbase.regionserver.HStore.logCompactionEndMessage(HStore.java:1343)
	at org.apache.hadoop.hbase.regionserver.HStore.compact(HStore.java:1259)
	at org.apache.hadoop.hbase.regionserver.HRegion.compact(HRegion.java:1812)
	at org.apache.hadoop.hbase.TestIOFencing$CompactionBlockerRegion.compact(TestIOFencing.java:127)
	at org.apache.hadoop.hbase.regionserver.CompactSplitThread$CompactionRunner.run(CompactSplitThread.java:524)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:744)
2015-08-27 18:50:14,349 DEBUG [RS:0;hemera:35619-shortCompactions-1440701403303] regionserver.CompactSplitThread$CompactionRunner(550): CompactSplitThread Status: compaction_queue=(0:3), split_queue=0, merge_queue=0
2015-08-27 18:50:14,351 INFO  [StoreCloserThread-tabletest,,1440701396419.94d6f21f7cf387d73d8622f535c67311.-1] regionserver.HStore(889): Closed family
2015-08-27 18:50:14,352 ERROR [RS_CLOSE_REGION-hemera:35619-0] regionserver.HRegion(1493): Memstore size is 62664
2015-08-27 18:50:14,353 INFO  [RS_CLOSE_REGION-hemera:35619-0] regionserver.HRegion(1506): Closed tabletest,,1440701396419.94d6f21f7cf387d73d8622f535c67311.
2015-08-27 18:50:14,353 DEBUG [RS_CLOSE_REGION-hemera:35619-0] handler.CloseRegionHandler(122): Closed tabletest,,1440701396419.94d6f21f7cf387d73d8622f535c67311.
2015-08-27 18:50:14,361 ERROR [RS:1;hemera:39431-shortCompactions-1440701414271] regionserver.CompactSplitThread$CompactionRunner(541): Compaction failed Request = regionName=tabletest,,1440701396419.94d6f21f7cf387d73d8622f535c67311., storeName=family, fileCount=9, fileSize=289.6 K (25.6 K, 47.0 K, 26.0 K, 68.7 K, 26.1 K, 26.1 K, 26.1 K, 26.1 K, 18.0 K), priority=991, time=525062316035397
java.io.FileNotFoundException: File does not exist: /user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/7067addd325446089ba15ec2c77becbc
	at org.apache.hadoop.hdfs.server.namenode.INodeFile.valueOf(INodeFile.java:64)
	at org.apache.hadoop.hdfs.server.namenode.INodeFile.valueOf(INodeFile.java:54)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocationsUpdateTimes(FSNamesystem.java:1795)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocationsInt(FSNamesystem.java:1738)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocations(FSNamesystem.java:1718)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocations(FSNamesystem.java:1690)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.getBlockLocations(NameNodeRpcServer.java:519)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.getBlockLocations(ClientNamenodeProtocolServerSideTranslatorPB.java:337)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:585)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:928)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2013)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2009)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1614)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2007)

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:526)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)
	at org.apache.hadoop.hdfs.DFSClient.callGetBlockLocations(DFSClient.java:1167)
	at org.apache.hadoop.hdfs.DFSClient.getLocatedBlocks(DFSClient.java:1155)
	at org.apache.hadoop.hdfs.DFSClient.getLocatedBlocks(DFSClient.java:1145)
	at org.apache.hadoop.hdfs.DFSInputStream.fetchLocatedBlocksAndGetLastBlockLength(DFSInputStream.java:268)
	at org.apache.hadoop.hdfs.DFSInputStream.openInfo(DFSInputStream.java:235)
	at org.apache.hadoop.hdfs.DFSInputStream.&amp;lt;init&amp;gt;(DFSInputStream.java:228)
	at org.apache.hadoop.hdfs.DFSClient.open(DFSClient.java:1318)
	at org.apache.hadoop.hdfs.DistributedFileSystem$3.doCall(DistributedFileSystem.java:293)
	at org.apache.hadoop.hdfs.DistributedFileSystem$3.doCall(DistributedFileSystem.java:289)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.open(DistributedFileSystem.java:289)
	at org.apache.hadoop.fs.FilterFileSystem.open(FilterFileSystem.java:160)
	at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:764)
	at org.apache.hadoop.hbase.io.FSDataInputStreamWrapper.&amp;lt;init&amp;gt;(FSDataInputStreamWrapper.java:106)
	at org.apache.hadoop.hbase.io.FSDataInputStreamWrapper.&amp;lt;init&amp;gt;(FSDataInputStreamWrapper.java:82)
	at org.apache.hadoop.hbase.regionserver.StoreFileInfo.open(StoreFileInfo.java:248)
	at org.apache.hadoop.hbase.regionserver.StoreFile.open(StoreFile.java:385)
	at org.apache.hadoop.hbase.regionserver.StoreFile.createReader(StoreFile.java:492)
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.getScannersForStoreFiles(StoreFileScanner.java:115)
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.getScannersForStoreFiles(StoreFileScanner.java:99)
	at org.apache.hadoop.hbase.regionserver.compactions.Compactor.createFileScanners(Compactor.java:203)
	at org.apache.hadoop.hbase.regionserver.compactions.DefaultCompactor.compact(DefaultCompactor.java:70)
	at org.apache.hadoop.hbase.regionserver.DefaultStoreEngine$DefaultCompactionContext.compact(DefaultStoreEngine.java:124)
	at org.apache.hadoop.hbase.regionserver.HStore.compact(HStore.java:1231)
	at org.apache.hadoop.hbase.regionserver.HRegion.compact(HRegion.java:1812)
	at org.apache.hadoop.hbase.TestIOFencing$CompactionBlockerRegion.compact(TestIOFencing.java:127)
	at org.apache.hadoop.hbase.regionserver.CompactSplitThread$CompactionRunner.run(CompactSplitThread.java:524)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:744)
Caused by: org.apache.hadoop.ipc.RemoteException(java.io.FileNotFoundException): File does not exist: /user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/data/default/tabletest/94d6f21f7cf387d73d8622f535c67311/family/7067addd325446089ba15ec2c77becbc
	at org.apache.hadoop.hdfs.server.namenode.INodeFile.valueOf(INodeFile.java:64)
	at org.apache.hadoop.hdfs.server.namenode.INodeFile.valueOf(INodeFile.java:54)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocationsUpdateTimes(FSNamesystem.java:1795)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocationsInt(FSNamesystem.java:1738)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocations(FSNamesystem.java:1718)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getBlockLocations(FSNamesystem.java:1690)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.getBlockLocations(NameNodeRpcServer.java:519)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.getBlockLocations(ClientNamenodeProtocolServerSideTranslatorPB.java:337)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:585)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:928)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2013)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2009)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1614)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2007)

	at org.apache.hadoop.ipc.Client.call(Client.java:1411)
	at org.apache.hadoop.ipc.Client.call(Client.java:1364)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:206)
	at com.sun.proxy.$Proxy21.getBlockLocations(Unknown Source)
	at sun.reflect.GeneratedMethodAccessor31.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)
	at com.sun.proxy.$Proxy21.getBlockLocations(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.getBlockLocations(ClientNamenodeProtocolTranslatorPB.java:225)
	at sun.reflect.GeneratedMethodAccessor32.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.hbase.fs.HFileSystem$1.invoke(HFileSystem.java:279)
	at com.sun.proxy.$Proxy22.getBlockLocations(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.callGetBlockLocations(DFSClient.java:1165)
	... 29 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12859720">HBASE-14327</key>
            <summary>TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chenheng">Heng Chen</assignee>
                                    <reporter username="dimaspivak">Dima Spivak</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Aug 2015 21:19:49 +0000</created>
                <updated>Wed, 27 Jan 2016 15:28:38 +0000</updated>
                            <resolved>Fri, 4 Sep 2015 17:33:38 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>0.98.15</fixVersion>
                    <fixVersion>1.0.3</fixVersion>
                    <fixVersion>1.1.3</fixVersion>
                                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="14718138" author="chenheng" created="Fri, 28 Aug 2015 07:14:29 +0000"  >&lt;p&gt;I met this problem too.&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15313//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15313//testReport/&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="14718366" author="chenheng" created="Fri, 28 Aug 2015 11:21:55 +0000"  >&lt;p&gt;After analysis the log,  we can see the storefile which not found was archived into other place. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2015-08-27 18:50:14,341 DEBUG [RS:0;hemera:35619-longCompactions-1440701391112] backup.HFileArchiver(438): Finished archiving from class org.apache.hadoop.hbase.backup.HFileArchiver$FileableStoreFile, file:hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tabletest/94d6f21f7cf387d73d8622f535c67311/family/7067addd325446089ba15ec2c77becbc, to hdfs://localhost:34675/user/jenkins/test-data/19edea13-027b-4c6a-9f3f-edaf1fc590ab/archive/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tabletest/94d6f21f7cf387d73d8622f535c67311/family/7067addd325446089ba15ec2c77becbc&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So the reader to this storefile closed,  and NPE throws when we use this reader to generate log message&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1340      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (StoreFile sf: sfs) {
1341        message.append(sf.getPath().getName());
1342        message.append(&lt;span class=&quot;code-quote&quot;&gt;&quot;(size=&quot;&lt;/span&gt;);
1343        message.append(TraditionalBinaryPrefix.long2String(sf.getReader().length(), &quot;&quot;, 1));
1344        message.append(&lt;span class=&quot;code-quote&quot;&gt;&quot;), &quot;&lt;/span&gt;);
1345      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, to fix this issue.  We can stop archive store files or delay it.&lt;/p&gt;
</comment>
                            <comment id="14718387" author="chenheng" created="Fri, 28 Aug 2015 11:40:29 +0000"  >&lt;p&gt;As testcase comments.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Test that puts up a regionserver, starts a compaction on a loaded region but holds the
   * compaction completion until after we have killed the server and the region has come up on
   * a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; regionserver altogether.  
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It seems we should check the store files on new region before compaction finished. But as code below&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Allowing compaction to proceed&quot;&lt;/span&gt;);
      compactingRegion.allowCompactions();
      &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (compactingRegion.compactCount == 0) {
        &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(1000);
      }
      &lt;span class=&quot;code-comment&quot;&gt;// The server we killed stays up until the compaction that was started before it was killed completes.  In logs
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// you should see the old regionserver now going down.
&lt;/span&gt;      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Compaction finished&quot;&lt;/span&gt;);
      &lt;span class=&quot;code-comment&quot;&gt;// After compaction of old region finishes on the server that was going down, make sure that
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// all the files we expect are still working when region is up in &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; location.
&lt;/span&gt;      FileSystem fs = newRegion.getFilesystem();
      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; f: newRegion.getStoreFileList(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [][] {FAMILY})) {
        assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;After compaction, does not exist: &quot;&lt;/span&gt; + f, fs.exists(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(f)));
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It seems we check store files after compaction.  Is it right?&lt;/p&gt;



</comment>
                            <comment id="14720087" author="stack" created="Fri, 28 Aug 2015 16:11:18 +0000"  >&lt;p&gt;The archiver is running in between close and open of the region in the new location? Is the file removed the result of the compaction or is it one of the inputs on the original region? The archive thinks it is safe to remove though the compaction has not &apos;completed&apos; yet? That sounds like another issue. In this case, if the archiver is moving the file aside, before the new region open has a chance to work on it, yeah, delay or stop the archiver in the test.&lt;/p&gt;

&lt;p&gt;Thank you for digging in on this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chenheng&quot; class=&quot;user-hover&quot; rel=&quot;chenheng&quot;&gt;Heng Chen&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14723189" author="chenheng" created="Mon, 31 Aug 2015 08:06:26 +0000"  >&lt;blockquote&gt;
&lt;p&gt;The archiver is running in between close and open of the region in the new location?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Is the file removed the result of the compaction or is it one of the inputs on the original region? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It is one of the inputs on the original region. &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The archive thinks it is safe to remove though the compaction has not &apos;completed&apos; yet? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The archive runs in &lt;tt&gt;Compaction.completeCompaction&lt;/tt&gt;,  the compaction has finished.&lt;/p&gt;


&lt;p&gt;If i enlarge the number of &lt;tt&gt;TestIOFencing.FIRST_BATCH_COUNT&lt;/tt&gt;.  The problem will be reproduced absolutely. &lt;/p&gt;

&lt;p&gt;IMO the point is that we check store files on new region after compaction finished.  I think it is wrong.  &lt;br/&gt;
Because when compaction finished, the archiver will run, and store files will be removed.&lt;/p&gt;

&lt;p&gt;So we can do check store files before archiver run.  &lt;/p&gt;

&lt;p&gt;I will upload my patch.  &lt;/p&gt;

</comment>
                            <comment id="14723191" author="chenheng" created="Mon, 31 Aug 2015 08:09:24 +0000"  >&lt;p&gt;Suggetions are welcomed! &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14727123" author="hadoopqa" created="Wed, 2 Sep 2015 10:10:23 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753244/HBASE-14327.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753244/HBASE-14327.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit f8dd99d7380e5eafae62a9f0c526ba24f98eb2e5.&lt;br/&gt;
  ATTACHMENT ID: 12753244&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15388//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15388//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15388//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15388//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15388//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15388//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15388//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15388//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14731113" author="stack" created="Fri, 4 Sep 2015 17:33:38 +0000"  >&lt;p&gt;Excellent. Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chenheng&quot; class=&quot;user-hover&quot; rel=&quot;chenheng&quot;&gt;Heng Chen&lt;/a&gt; Pushed to branch-1.0+&lt;/p&gt;</comment>
                            <comment id="14731343" author="hudson" created="Fri, 4 Sep 2015 20:07:12 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.2 #151 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/151/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/151/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14327&quot; title=&quot;TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14327&quot;&gt;&lt;del&gt;HBASE-14327&lt;/del&gt;&lt;/a&gt; TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky (Heng Chen) (stack: rev 2c4062ae0ef87fabb7af5d367f8cfdbef266657d)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14731385" author="hudson" created="Fri, 4 Sep 2015 20:43:56 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.1 #650 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/650/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/650/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14327&quot; title=&quot;TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14327&quot;&gt;&lt;del&gt;HBASE-14327&lt;/del&gt;&lt;/a&gt; TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky (Heng Chen) (stack: rev 43d5523b66c2ba82a95d6f214272716658a0d92f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14731399" author="hudson" created="Fri, 4 Sep 2015 20:54:28 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #149 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/149/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/149/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14327&quot; title=&quot;TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14327&quot;&gt;&lt;del&gt;HBASE-14327&lt;/del&gt;&lt;/a&gt; TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky (Heng Chen) (stack: rev 1ac42c9634873a626bfdb75298b4a10fbb64edfc)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14731413" author="hudson" created="Fri, 4 Sep 2015 21:01:42 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2-IT #127 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2-IT/127/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2-IT/127/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14327&quot; title=&quot;TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14327&quot;&gt;&lt;del&gt;HBASE-14327&lt;/del&gt;&lt;/a&gt; TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky (Heng Chen) (stack: rev 2c4062ae0ef87fabb7af5d367f8cfdbef266657d)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14731424" author="hudson" created="Fri, 4 Sep 2015 21:08:55 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #133 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/133/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/133/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14327&quot; title=&quot;TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14327&quot;&gt;&lt;del&gt;HBASE-14327&lt;/del&gt;&lt;/a&gt; TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky (Heng Chen) (stack: rev 1ac42c9634873a626bfdb75298b4a10fbb64edfc)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14731573" author="hudson" created="Fri, 4 Sep 2015 23:00:58 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6782 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6782/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6782/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14327&quot; title=&quot;TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14327&quot;&gt;&lt;del&gt;HBASE-14327&lt;/del&gt;&lt;/a&gt; TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky (Heng Chen) (stack: rev de0e72f464560cd59d836f651291e12fcbf78e73)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14732115" author="apurtell" created="Sat, 5 Sep 2015 22:02:32 +0000"  >&lt;p&gt;Picked test fix to 0.98. I&apos;m not aware of a frequent test failure there but without this change the possibility of timing changes elsewhere exposing are there.&lt;/p&gt;</comment>
                            <comment id="14732158" author="hudson" created="Sun, 6 Sep 2015 02:14:04 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #1112 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/1112/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/1112/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14327&quot; title=&quot;TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14327&quot;&gt;&lt;del&gt;HBASE-14327&lt;/del&gt;&lt;/a&gt; TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky (Heng Chen) (apurtell: rev 4367a94aa9d1a0d33a38b65f098f8a21ffc68fd5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14732170" author="hudson" created="Sun, 6 Sep 2015 03:19:33 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #1065 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1065/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1065/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14327&quot; title=&quot;TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14327&quot;&gt;&lt;del&gt;HBASE-14327&lt;/del&gt;&lt;/a&gt; TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky (Heng Chen) (apurtell: rev 4367a94aa9d1a0d33a38b65f098f8a21ffc68fd5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14739842" author="stack" created="Thu, 10 Sep 2015 23:24:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chenheng&quot; class=&quot;user-hover&quot; rel=&quot;chenheng&quot;&gt;Heng Chen&lt;/a&gt; I just saw a failure here post test.&lt;/p&gt;

&lt;p&gt;Says this:&lt;/p&gt;

&lt;p&gt;-------------------------------------------------------------------------------&lt;br/&gt;
Test set: org.apache.hadoop.hbase.TestIOFencing&lt;br/&gt;
-------------------------------------------------------------------------------&lt;br/&gt;
Tests run: 2, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 158.747 sec &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.hadoop.hbase.TestIOFencing&lt;br/&gt;
testFencingAroundCompactionAfterWALSync(org.apache.hadoop.hbase.TestIOFencing)  Time elapsed: 50.545 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!&lt;br/&gt;
java.lang.AssertionError: After compaction, does not exist: hdfs://localhost:44128/user/stack/test-data/78751de8-633e-4fb4-a9ec-ee255377b3f2/data/default/tabletest/52ba2b9dfece9e9e8e241586779794c9/family/659140de148948ec8d1c116de5726889&lt;br/&gt;
        at org.junit.Assert.fail(Assert.java:88)&lt;br/&gt;
        at org.junit.Assert.assertTrue(Assert.java:41)&lt;br/&gt;
        at org.apache.hadoop.hbase.TestIOFencing.doTest(TestIOFencing.java:338)&lt;br/&gt;
        at org.apache.hadoop.hbase.TestIOFencing.testFencingAroundCompactionAfterWALSync(TestIOFencing.java:240)&lt;/p&gt;


&lt;p&gt;Here is exception:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2015-09-09 11:14:22,109 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(494): master:34005-0x14fb3508a800000, quorum=localhost:57728, baseZNode=/hbase Received ZooKeeper Event, type=NodeDeleted, state=SyncConnected, path=/hbase/recovering-regions/460a087fe498f8817211fd64d7189b66
2015-09-09 11:14:22,111 INFO  [ProcedureExecutor-4] master.SplitLogManager(317): finished splitting (more than or equal to) 83 bytes in 1 log files in [hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:56695/user/stack/test-data/d7c3b32a-7989-4622-bb8c-11b08322b72a/WALs/c2023.halxg.cloudera.com,38754,1441822444821-splitting] in 4487ms
&lt;/span&gt;2015-09-09 11:14:22,111 DEBUG [ProcedureExecutor-4] master.RegionStates(499): Adding to log splitting servers c2023.halxg.cloudera.com,38754,1441822444821
2015-09-09 11:14:22,111 INFO  [RS_OPEN_REGION-c2023:60880-1] handler.FinishRegionRecoveringHandler(52): /hbase/recovering-regions/460a087fe498f8817211fd64d7189b66 deleted; 460a087fe498f8817211fd64d7189b66 recovered.
2015-09-09 11:14:22,202 WARN  [HBase-Metrics2-1] impl.MetricsConfig(125): Cannot locate configuration: tried hadoop-metrics2-datanode.properties,hadoop-metrics2.properties
2015-09-09 11:14:22,202 INFO  [main] hbase.TestIOFencing(326): Allowing compaction to proceed
2015-09-09 11:14:22,202 DEBUG [main] hbase.TestIOFencing$CompactionBlockerRegion(110): allowing compactions
2015-09-09 11:14:22,203 INFO  [RS:0;c2023:38754-shortCompactions-1441822454215] regionserver.HStore(1225): Starting compaction of 2 file(s) in family of tabletest,,1441822450143.460a087fe498f8817211fd64d7189b66. into tmpdir=hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:56695/user/stack/test-data/d7c3b32a-7989-4622-bb8c-11b08322b72a/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tabletest/460a087fe498f8817211fd64d7189b66/.tmp, totalSize=51.5 K
&lt;/span&gt;2015-09-09 11:14:22,203 INFO  [RS:0;c2023:38754-longCompactions-1441822445929] regionserver.HStore(1225): Starting compaction of 2 file(s) in family of tabletest,,1441822450143.460a087fe498f8817211fd64d7189b66. into tmpdir=hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:56695/user/stack/test-data/d7c3b32a-7989-4622-bb8c-11b08322b72a/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tabletest/460a087fe498f8817211fd64d7189b66/.tmp, totalSize=52.1 K
&lt;/span&gt;2015-09-09 11:14:22,203 DEBUG [RS:0;c2023:38754-longCompactions-1441822445929] compactions.Compactor(182): Compacting hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:56695/user/stack/test-data/d7c3b32a-7989-4622-bb8c-11b08322b72a/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tabletest/460a087fe498f8817211fd64d7189b66/family/3a3e31190a36474589c6e4fa1076ab9e, keycount=596, bloomtype=NONE, size=26.1 K, encoding=NONE, seqNum=3682
&lt;/span&gt;2015-09-09 11:14:22,203 DEBUG [RS:0;c2023:38754-longCompactions-1441822445929] compactions.Compactor(182): Compacting hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:56695/user/stack/test-data/d7c3b32a-7989-4622-bb8c-11b08322b72a/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tabletest/460a087fe498f8817211fd64d7189b66/family/5dbe68678245437da49aad5f2a8478da, keycount=596, bloomtype=NONE, size=26.1 K, encoding=NONE, seqNum=4877
&lt;/span&gt;2015-09-09 11:14:22,204 ERROR [RS:0;c2023:38754-shortCompactions-1441822454215] regionserver.CompactSplitThread$CompactionRunner(541): Compaction failed Request = regionName=tabletest,,1441822450143.460a087fe498f8817211fd64d7189b66., storeName=family, fileCount=2, fileSize=51.5 K (25.5 K, 26.0 K), priority=998, time=33700359474947254
java.io.FileNotFoundException: File does not exist: hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:56695/user/stack/test-data/d7c3b32a-7989-4622-bb8c-11b08322b72a/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/tabletest/460a087fe498f8817211fd64d7189b66/family/e0be378e04ee4413b9c2ad23c3cba0fe
&lt;/span&gt;        at org.apache.hadoop.hdfs.DistributedFileSystem$22.doCall(DistributedFileSystem.java:1309)
        at org.apache.hadoop.hdfs.DistributedFileSystem$22.doCall(DistributedFileSystem.java:1301)
        at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
        at org.apache.hadoop.hdfs.DistributedFileSystem.getFileStatus(DistributedFileSystem.java:1317)
        at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:421)
        at org.apache.hadoop.hbase.regionserver.StoreFileInfo.getReferencedFileStatus(StoreFileInfo.java:348)
        at org.apache.hadoop.hbase.regionserver.StoreFileInfo.getFileStatus(StoreFileInfo.java:361)
        at org.apache.hadoop.hbase.regionserver.StoreFileInfo.getModificationTime(StoreFileInfo.java:366)
        at org.apache.hadoop.hbase.regionserver.StoreFile.getModificationTimeStamp(StoreFile.java:292)
        at org.apache.hadoop.hbase.regionserver.compactions.Compactor.getFileDetails(Compactor.java:122)
        at org.apache.hadoop.hbase.regionserver.compactions.DefaultCompactor.compact(DefaultCompactor.java:55)
        at org.apache.hadoop.hbase.regionserver.DefaultStoreEngine$DefaultCompactionContext.compact(DefaultStoreEngine.java:124)
        at org.apache.hadoop.hbase.regionserver.HStore.compact(HStore.java:1231)
        at org.apache.hadoop.hbase.regionserver.HRegion.compact(HRegion.java:1816)
        at org.apache.hadoop.hbase.TestIOFencing$CompactionBlockerRegion.compact(TestIOFencing.java:127)
        at org.apache.hadoop.hbase.regionserver.CompactSplitThread$CompactionRunner.run(CompactSplitThread.java:525)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
..

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll reopen?&lt;/p&gt;</comment>
                            <comment id="14740035" author="chenheng" created="Fri, 11 Sep 2015 02:23:50 +0000"  >&lt;p&gt;Bad news...   Could your tell me which branch you are using?  I will dig in.  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14740130" author="stack" created="Fri, 11 Sep 2015 04:02:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chenheng&quot; class=&quot;user-hover&quot; rel=&quot;chenheng&quot;&gt;Heng Chen&lt;/a&gt; Argh! Pardon me. I see my test runs did NOT have this patch included. Ignore the above. Sorry about that.&lt;/p&gt;</comment>
                            <comment id="14740148" author="chenheng" created="Fri, 11 Sep 2015 04:21:57 +0000"  >&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  Never mind, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;   If you find any problem about this patch, please let me know, i will dig in it.&lt;/p&gt;</comment>
                            <comment id="14941863" author="hudson" created="Fri, 2 Oct 2015 22:13:27 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.0 #1067 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/1067/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/1067/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14327&quot; title=&quot;TestIOFencing#testFencingAroundCompactionAfterWALSync is flaky&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14327&quot;&gt;&lt;del&gt;HBASE-14327&lt;/del&gt;&lt;/a&gt; TestIOFencing#testFencingAroundCompactionAfterWALSync is (stack: rev 0cc5a5d8cffd901c7e0883f24da4e6e808aefb39)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15119506" author="ndimiduk" created="Wed, 27 Jan 2016 15:28:38 +0000"  >&lt;p&gt;Bulk closing 1.1.3 issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12753244" name="HBASE-14327.patch" size="2355" author="chenheng" created="Mon, 31 Aug 2015 08:09:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 28 Aug 2015 07:14:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            46 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jgvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>