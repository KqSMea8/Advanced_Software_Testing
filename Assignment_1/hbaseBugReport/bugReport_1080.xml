<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:50:35 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1080/HBASE-1080.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1080] Deadlocked master; wants to assign root but can&apos;t because root is not assigned</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1080</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This lock assigning regions looks broad.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;IPC Server handler 6 on 60000&quot;&lt;/span&gt; daemon prio=10 tid=0x00007ff2d00ab400 nid=0x645b in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x000000004330b000..0x000000004330cd70]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (on object monitor)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:502)
	at org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:695)
	- locked &amp;lt;0x00007ff2e8e2b3b0&amp;gt; (a org.apache.hadoop.hbase.ipc.HBaseClient$Call)
	at org.apache.hadoop.hbase.ipc.HBaseRPC$Invoker.invoke(HBaseRPC.java:321)
	at $Proxy2.batchUpdates(Unknown Source)
	at org.apache.hadoop.hbase.client.HConnectionManager$TableServers$2.call(HConnectionManager.java:916)
	at org.apache.hadoop.hbase.client.HConnectionManager$TableServers$2.call(HConnectionManager.java:914)
	at org.apache.hadoop.hbase.client.HConnectionManager$TableServers.getRegionServerForWithoutRetries(HConnectionManager.java:872)
	at org.apache.hadoop.hbase.client.HConnectionManager$TableServers.processBatchOfRows(HConnectionManager.java:913)
	at org.apache.hadoop.hbase.client.HTable.flushCommits(HTable.java:1270)
	at org.apache.hadoop.hbase.client.HTable.commit(HTable.java:1241)
	- locked &amp;lt;0x00007ff2e8c01b90&amp;gt; (a org.apache.hadoop.hbase.client.HTable)
	at org.apache.hadoop.hbase.client.HTable.commit(HTable.java:1221)
	- locked &amp;lt;0x00007ff2e8c01b90&amp;gt; (a org.apache.hadoop.hbase.client.HTable)
	at org.apache.hadoop.hbase.RegionHistorian.add(RegionHistorian.java:239)
	at org.apache.hadoop.hbase.RegionHistorian.add(RegionHistorian.java:218)
	at org.apache.hadoop.hbase.RegionHistorian.addRegionAssignment(RegionHistorian.java:142)
	at org.apache.hadoop.hbase.master.RegionManager.assignRegionsToMultipleServers(RegionManager.java:282)
	at org.apache.hadoop.hbase.master.RegionManager.assignRegions(RegionManager.java:220)
	- locked &amp;lt;0x00007ff2e895d3f8&amp;gt; (a java.util.Collections$SynchronizedSortedMap)
	at org.apache.hadoop.hbase.master.ServerManager.processMsgs(ServerManager.java:382)
	at org.apache.hadoop.hbase.master.ServerManager.processRegionServerAllsWell(ServerManager.java:324)
	at org.apache.hadoop.hbase.master.ServerManager.regionServerReport(ServerManager.java:240)
	at org.apache.hadoop.hbase.master.HMaster.regionServerReport(HMaster.java:570)
	at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:616)
	at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:632)
	at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:892)

....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Its messing up assigning root it seems.&lt;/p&gt;

&lt;p&gt;We are stuck in here.  Doesn&apos;t look like we&apos;ll break out though maybe we time out?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Writable call(Writable param, InetSocketAddress addr, 
                       UserGroupInformation ticket)  
                       &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; InterruptedException, IOException {
    Call call = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Call(param);
    Connection connection = getConnection(addr, ticket, call);
    connection.sendParam(call);                 &lt;span class=&quot;code-comment&quot;&gt;// send the parameter
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (call) {
      &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (!call.done) {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
          call.wait();                           &lt;span class=&quot;code-comment&quot;&gt;// wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the result
&lt;/span&gt;        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException ignored) {}
      }
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... down in HBaseClient. &lt;/p&gt;
</description>
                <environment>&lt;p&gt;17:05 &amp;lt; jgray&amp;gt; I0.19.0-dev, r726565&lt;br/&gt;
17:05 &amp;lt; jgray&amp;gt; 12/15/08 i grabbed it&lt;/p&gt;</environment>
        <key id="12411175">HBASE-1080</key>
            <summary>Deadlocked master; wants to assign root but can&apos;t because root is not assigned</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Dec 2008 17:20:28 +0000</created>
                <updated>Fri, 23 Jan 2009 19:43:20 +0000</updated>
                            <resolved>Fri, 23 Jan 2009 19:43:20 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12658591" author="stack" created="Mon, 22 Dec 2008 17:21:38 +0000"  >&lt;p&gt;Full thread dump&lt;/p&gt;</comment>
                            <comment id="12658592" author="stack" created="Mon, 22 Dec 2008 17:24:31 +0000"  >&lt;p&gt;Jim Kellerman: Do you have an opinion on this since it seems to be issue with root region assignment?&lt;/p&gt;</comment>
                            <comment id="12658614" author="stack" created="Mon, 22 Dec 2008 18:17:35 +0000"  >&lt;p&gt;I see in logs that things in master seemed to be running fine scanning root and meta and then it just stops scanning meta.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2008-12-20 17:12:59,065 DEBUG org.apache.hadoop.hbase.client.HConnectionManager$TableServers: Cache hit in table locations &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; row &amp;lt;&amp;gt; and tableName .META.: location server  XX.XX.XX.216:60020, location region name .META.,,1
2008-12-20 17:13:22,458 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.metaScanner scanning meta region {regionname: .META.,,1, startKey: &amp;lt;&amp;gt;, server:  XX.XX.XX.216:60020}
2008-12-20 17:13:22,573 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.metaScanner scan of 378 row(s) of meta region {regionname: .META.,,1, startKey: &amp;lt;&amp;gt;, server:  XX.XX.XX.216:60020} complete
2008-12-20 17:13:22,573 INFO org.apache.hadoop.hbase.master.BaseScanner: All 1 .META. region(s) scanned
2008-12-20 17:13:27,781 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.rootScanner scanning meta region {regionname: -ROOT-,,0, startKey: &amp;lt;&amp;gt;, server:  XX.XX.XX.213:60020}
2008-12-20 17:13:27,789 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.rootScanner scan of 1 row(s) of meta region {regionname: -ROOT-,,0, startKey: &amp;lt;&amp;gt;, server:  XX.XX.XX.213:60020} complete
2008-12-20 17:13:29,417 DEBUG org.apache.hadoop.hbase.client.HConnectionManager$TableServers: Cache hit in table locations &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; row &amp;lt;&amp;gt; and tableName .META.: location server  XX.XX.XX.216:60020, location region name .META.,,1
2008-12-20 17:13:51,564 DEBUG org.apache.hadoop.hbase.master.ServerManager: Total Load: 382, Num Servers: 10, Avg Load: 39.0
2008-12-20 17:13:59,763 DEBUG org.apache.hadoop.hbase.client.HConnectionManager$TableServers: Cache hit in table locations &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; row &amp;lt;&amp;gt; and tableName .META.: location server  XX.XX.XX.216:60020, location region name .META.,,1
2008-12-20 17:14:22,458 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.metaScanner scanning meta region {regionname: .META.,,1, startKey: &amp;lt;&amp;gt;, server:  XX.XX.XX.216:60020}
2008-12-20 17:14:27,781 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.rootScanner scanning meta region {regionname: -ROOT-,,0, startKey: &amp;lt;&amp;gt;, server:  XX.XX.XX.213:60020}
2008-12-20 17:14:27,787 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.rootScanner scan of 1 row(s) of meta region {regionname: -ROOT-,,0, startKey: &amp;lt;&amp;gt;, server: XX.XX.XX.213:60020} complete
2008-12-20 17:14:51,591 DEBUG org.apache.hadoop.hbase.master.ServerManager: Total Load: 382, Num Servers: 10, Avg Load: 39.0
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...&lt;/p&gt;


&lt;p&gt;This goes on then forever except the meta scanner runs twice more 30 minutes later on schedule and then stops again... for the rest of the log.&lt;/p&gt;

&lt;p&gt;Root and meta are on different servers, 213 and 216 respectively.&lt;/p&gt;

&lt;p&gt;Looking at logs on server hosting meta, I see nothing untoward (though seems like we&apos;re major compacting every 4 hours or so) and then lease&apos;s timing out without explanation.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2008-12-20 16:34:24,021 INFO org.apache.hadoop.hbase.regionserver.HRegion: starting compaction on region assigners,,1229364037757
2008-12-20 16:34:24,022 DEBUG org.apache.hadoop.hbase.regionserver.HStore: Skipping major compaction because only one (major) compacted file only and elapsedTime 169999846 is &amp;lt; ttl=-1
2008-12-20 16:34:24,022 INFO org.apache.hadoop.hbase.regionserver.HRegion: compaction completed on region assigners,,1229364037757 in 0sec
2008-12-20 17:15:01,773 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Scanner -5917415078002522486 lease expired
2008-12-20 17:15:22,463 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Scanner 7764136277533139761 lease expired
2008-12-20 17:23:21,423 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Scanner 2005207420919280312 lease expired
2008-12-20 17:45:31,699 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Scanner 6223121878865388268 lease expired
2008-12-20 17:46:15,298 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Scanner 7574816364936285182 lease expired
2008-12-20 17:46:32,666 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Scanner 908654114835311904 lease expired
2008-12-20 19:21:03,933 DEBUG org.apache.hadoop.hbase.regionserver.HStore: Major compaction triggered on store: 170018656/content. Time since last major compaction: 309999 seconds
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12666571" author="stack" created="Fri, 23 Jan 2009 15:53:30 +0000"  >&lt;p&gt;How is this related to hbase-1121?&lt;/p&gt;</comment>
                            <comment id="12666669" author="jimk" created="Fri, 23 Jan 2009 19:43:20 +0000"  >&lt;p&gt;With all the changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-543&quot; title=&quot;A region&amp;#39;s state is kept in several places in the master opening the possibility for race conditions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-543&quot;&gt;&lt;del&gt;HBASE-543&lt;/del&gt;&lt;/a&gt;, this bug is not reproducable.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12396611" name="master.dump.log" size="44034" author="stack" created="Mon, 22 Dec 2008 17:21:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 23 Jan 2009 19:43:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25561</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 47 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hb7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99077</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>