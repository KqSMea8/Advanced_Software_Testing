<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:30:58 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5788/HBASE-5788.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5788] Move Dynamic Metrics storage off of HRegion.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5788</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;HRegion right now has the responsibility of storing static counts and latency numbers for use by the metrics package.  Since these maps are incremented and set from lots of places it makes adding functionality hard.&lt;/p&gt;

&lt;p&gt;So move the metrics functionality into SchemaMetrics making it more than just a class for naming.  The next step will be to simplify the api exposed so that using it will be easier.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12550910">HBASE-5788</key>
            <summary>Move Dynamic Metrics storage off of HRegion.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eclark">Elliott Clark</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Sat, 14 Apr 2012 00:04:35 +0000</created>
                <updated>Mon, 23 Sep 2013 18:45:01 +0000</updated>
                            <resolved>Tue, 17 Apr 2012 23:02:31 +0000</resolved>
                                                    <fixVersion>0.95.0</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13255014" author="eclark" created="Mon, 16 Apr 2012 20:36:32 +0000"  >&lt;p&gt;On trying to add more to this class it became obvious to me that it needs more love than the first try.  I&apos;ll roll this into exposing per region metrics.&lt;/p&gt;</comment>
                            <comment id="13255084" author="eclark" created="Mon, 16 Apr 2012 21:33:35 +0000"  >&lt;p&gt;Better version.  SchemaMetrics wasn&apos;t the right place to put it.  While it does a lot of the interaction there are lots of other places so a static MetricsStorage seems better.&lt;/p&gt;</comment>
                            <comment id="13255092" author="eclark" created="Mon, 16 Apr 2012 21:39:42 +0000"  >&lt;p&gt;Added header to new file.&lt;/p&gt;</comment>
                            <comment id="13255323" author="stack" created="Tue, 17 Apr 2012 05:25:32 +0000"  >&lt;p&gt;Is MetricsStorage for Region metrics only?  If so, call it RegionMetrics?  Or maybe its generic metrics storage for this package?  If so, the name is right.  Should it be down in the metrics package?  Regardless, new class needs class comment explaining class scope.  Does it have to public?  Can it be private to the package at least?  Lines &amp;lt; 100 chars.  Why are data members in this new class public rather than private?  Even if they are static.   And static data members probably ain&apos;t a good idea because then there is one only per JVM and there can be many regionservers in the one JVM; e.g. in testing.  Yeah, do its method names need to be public?  Can these be package private?  Hmm... maybe they need to be public because called from the metrics subpackage?  I like all the code that comes out of HRegion.  Thats good.  And no harm in a basic unit test that your new class is basically working.  Any worries w/ concurrent access?   Good stuff Elliott.&lt;/p&gt;</comment>
                            <comment id="13255635" author="eclark" created="Tue, 17 Apr 2012 15:19:44 +0000"  >&lt;p&gt;RegionMetricsStorage could be a better name this class holds and mutates the numbers that will be exposed as dynamic region metrics.&lt;/p&gt;

&lt;p&gt;I&apos;ll add the comments, and check the line length.  Not sure how I messed up eclipse.&lt;/p&gt;

&lt;p&gt;The data members can be package private now that they are in the regionserver.metrics package.  I&apos;ll check to make sure.&lt;/p&gt;

&lt;p&gt;Everything else is accessed in the regionserver package so they need to be public :-/&lt;/p&gt;

&lt;p&gt;TestRegionServerMetrics covers most of the functionality of the new class but I can create a new set of more explicit tests if you think that is needed.&lt;/p&gt;</comment>
                            <comment id="13255645" author="stack" created="Tue, 17 Apr 2012 15:30:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;TestRegionServerMetrics covers most of the functionality of the new class but I can create a new set of more explicit tests if you think that is needed.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Probably no need if we have some coverage already.  Just want to make sure the class does its basic contract.  Easier figuring this stuff in a unit test than up on a cluster, yadda, yadda, you know what I&apos;m at.&lt;/p&gt;</comment>
                            <comment id="13255819" author="eclark" created="Tue, 17 Apr 2012 18:41:30 +0000"  >&lt;p&gt;Lines should all be &amp;lt; 100.&lt;/p&gt;

&lt;p&gt;Added comments on RegionMetricsStorage.&lt;/p&gt;

&lt;p&gt;Made data in RegionMetricsStorage private with public getters (tests require it to be public).&lt;/p&gt;</comment>
                            <comment id="13255870" author="eclark" created="Tue, 17 Apr 2012 19:42:36 +0000"  >&lt;p&gt;Add @InterfaceAudience.Private to the new class.&lt;/p&gt;</comment>
                            <comment id="13255972" author="stack" created="Tue, 17 Apr 2012 21:34:59 +0000"  >&lt;p&gt;lgtm&lt;/p&gt;

&lt;p&gt;Trying against hadoopqa&lt;/p&gt;</comment>
                            <comment id="13256005" author="hadoopqa" created="Tue, 17 Apr 2012 22:31:11 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12523008/HBASE-5788-4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12523008/HBASE-5788-4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 4 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.TestReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1557//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1557//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1557//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1557//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1557//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1557//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13256034" author="stack" created="Tue, 17 Apr 2012 23:02:31 +0000"  >&lt;p&gt;Applied to Trunk (Just TestReplication failed... which seems unrelated).  Thanks for the patch Elliott.&lt;/p&gt;</comment>
                            <comment id="13256096" author="hudson" created="Wed, 18 Apr 2012 00:18:58 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2776 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2776/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2776/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5788&quot; title=&quot;Move Dynamic Metrics storage off of HRegion.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5788&quot;&gt;&lt;del&gt;HBASE-5788&lt;/del&gt;&lt;/a&gt; Move Dynamic Metrics storage off of HRegion (Revision 1327316)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/RegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/RegionMetricsStorage.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/RegionServerDynamicMetrics.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/SchemaMetrics.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestRegionServerMetrics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13256110" author="enis" created="Wed, 18 Apr 2012 00:45:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;The next step will be to simplify the api exposed so that using it will be easier.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;@Elliot, do you have something in mind for this? While working on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5601&quot; title=&quot;Add per-column-family data block cache hit ratios&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5601&quot;&gt;&lt;del&gt;HBASE-5601&lt;/del&gt;&lt;/a&gt;, I also noticed that SchemaMetrics needs some simplification as well.&lt;/p&gt;</comment>
                            <comment id="13256114" author="eclark" created="Wed, 18 Apr 2012 00:54:55 +0000"  >&lt;p&gt;@Enis  I was thinking of getting things more like &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3614&quot; title=&quot;Expose per-region request rate metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3614&quot;&gt;&lt;del&gt;HBASE-3614&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I moved metrics about get/put/delete/icv into a helper class that mutates data in RegionMetricsStorage. I was hoping to go that way with pretty simple helper classes that expose update methods.  Then SchemaMetrics can be mutated in the same way and metric naming can be handled by static helpers only.   &lt;/p&gt;</comment>
                            <comment id="13256121" author="enis" created="Wed, 18 Apr 2012 01:13:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;I moved metrics about get/put/delete/icv into a helper class that mutates data in RegionMetricsStorage. I was hoping to go that way with pretty simple helper classes that expose update methods. Then SchemaMetrics can be mutated in the same way and metric naming can be handled by static helpers only.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ok, i see. Helper methods should help. But I think we should get rid of the static state there. &lt;/p&gt;

&lt;p&gt;I also left a comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3614&quot; title=&quot;Expose per-region request rate metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3614&quot;&gt;&lt;del&gt;HBASE-3614&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="13256228" author="hudson" created="Wed, 18 Apr 2012 06:06:58 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #174 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/174/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/174/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5788&quot; title=&quot;Move Dynamic Metrics storage off of HRegion.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5788&quot;&gt;&lt;del&gt;HBASE-5788&lt;/del&gt;&lt;/a&gt; Move Dynamic Metrics storage off of HRegion (Revision 1327316)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/RegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/RegionMetricsStorage.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/RegionServerDynamicMetrics.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/metrics/SchemaMetrics.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestRegionServerMetrics.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12500932">HBASE-3614</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12522640" name="HBASE-5788-0.patch" size="23154" author="eclark" created="Sat, 14 Apr 2012 00:08:03 +0000"/>
                            <attachment id="12522865" name="HBASE-5788-1.patch" size="25251" author="eclark" created="Mon, 16 Apr 2012 21:33:35 +0000"/>
                            <attachment id="12522866" name="HBASE-5788-2.patch" size="26115" author="eclark" created="Mon, 16 Apr 2012 21:39:42 +0000"/>
                            <attachment id="12523000" name="HBASE-5788-3.patch" size="27089" author="eclark" created="Tue, 17 Apr 2012 18:41:30 +0000"/>
                            <attachment id="12523008" name="HBASE-5788-4.patch" size="27177" author="eclark" created="Tue, 17 Apr 2012 19:42:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 17 Apr 2012 05:25:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>235774</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 35 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hu2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102135</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>