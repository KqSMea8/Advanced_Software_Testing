<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:06:28 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2993/HBASE-2993.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2993] Refactor servers to use a common lifecycle interface</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2993</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In current trunk, the region server is a Runnable and the Master is a thread. We have all kinds of weird wrappers like JVMClusterUtil to try to work around this. It would be nice if they both implemented the same interface - LocalHBaseCluster and the MiniCluster would be a lot easier to understand as well, and we could share some more code between them.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12474026">HBASE-2993</key>
            <summary>Refactor servers to use a common lifecycle interface</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Sep 2010 01:34:27 +0000</created>
                <updated>Sat, 11 Apr 2015 00:33:48 +0000</updated>
                            <resolved>Sat, 11 Apr 2015 00:33:48 +0000</resolved>
                                    <version>0.90.0</version>
                                                    <component>master</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12909089" author="hbasereviewboard" created="Tue, 14 Sep 2010 01:45:16 +0000"  >&lt;p&gt;Message from: &quot;Todd Lipcon&quot; &amp;lt;todd@cloudera.com&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/829/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase, stack and Jonathan Gray.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This isn&apos;t really cleaned up, but wanted to gather opinions before I put in more effort. Does this kind of refactor seem good? Is the Guava &quot;Service&quot; class what we want to use or should we just write our own similar interface?&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2993&quot; title=&quot;Refactor servers to use a common lifecycle interface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2993&quot;&gt;&lt;del&gt;HBASE-2993&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-2993&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-2993&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java bc0a62f &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java bc21a1e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java c675db9 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java bba7b67 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/service/ServiceUtils.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/service/ServiceWithMainThread.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 4a9f1c3 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseClusterTestCase.java b7abb51 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java 9cc1168 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 9407c1e &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestHBaseTestingUtility.java 1cd88d3 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestInfoServers.java daffe02 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestRegionRebalancing.java 6908111 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestKillingServersFromMaster.java f5fd243 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestZKBasedOpenCloseRegion.java a172e2c &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/DisabledTestRegionServerExit.java 5b8b464 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestLogRolling.java 287f1fb &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/829/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Tried to run unit tests, but plenty failed. I think they&apos;re failing on trunk, too, though. Will do more testing and another round of review before I actually claim this is ready to commit.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Todd&lt;/p&gt;

</comment>
                            <comment id="12909091" author="hbasereviewboard" created="Tue, 14 Sep 2010 02:00:11 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/829/#review1173&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#review1173&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;I like this.  Naming seems fine to me.  We&apos;re making great strides in cleaning these things up, great stuff Todd.&lt;/p&gt;

&lt;p&gt;I guess we&apos;re in need of standardizing the methods in HM and HRS like toString, get*Name, etc...&lt;/p&gt;


&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4026&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4026&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    The toString() is supposed to give a unique name for the instance, especially useful in unit tests with multiple masters and such.  Not sure where all we&apos;re using getServerName but might make sense for these to be the same.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jonathan&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12909122" author="hbasereviewboard" created="Tue, 14 Sep 2010 06:14:11 +0000"  >&lt;p&gt;Message from: stack@duboce.net&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/829/#review1176&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#review1176&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4028&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4028&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Didn&apos;t realize one of these lifecycle things in Guava but then there&apos;s a million different versions of Lifecycle I suppose (I&apos;m pretty sure I&apos;ve written a few myself in past life).  We could write our own but, its my guess it&apos;d not differ from what we have here much.  Then again its missing Abort.&lt;/p&gt;

&lt;p&gt;    This kinda refactoring is a big improvement; we should go this way, yeah, as it takes us further down road already started where we&apos;re trying to have Servers in hbase look alike.  But I want us to be even more radical.  I want us to move up to something like Spring where implementing their container means we get a bunch of other facility for near free and where the wiring up of a regionserver or a master can be done from config with others able to provide alternate implementations if they&apos;d like with just a config. change.  It&apos;d encourage writing to Interfaces, etc. ( Well, maybe not Spring.  Its too heavy weight and that xml stuff makes me queasy.  There are lesser IofC containers such as pico or nano).&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4029&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4029&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This is good&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4030&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4030&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Thats a real pretty name (descriptive though I suppose)&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4031&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4031&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    We had a sort of convention for naming threads in hbase where host &apos;server&apos; is prefix where host includes service type and port if needed... that kinda thing.  Previous we had a naming convention per implementator... was a mess.&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4032&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4032&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I like having state in there.  I was also adding zk sessionid....&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4033&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4033&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    good&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4034&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4034&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    good&lt;/p&gt;




&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4035&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4035&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Good.  I think I made this class originally.  It grew into a monster.&lt;/p&gt;



&lt;p&gt;src/test/java/org/apache/hadoop/hbase/HBaseClusterTestCase.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/829/#comment4036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/829/#comment4036&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Are we losing the threaddumping?  It was useful.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;stack&lt;/li&gt;
&lt;/ul&gt;



</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12480609">HBASE-3260</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 14 Sep 2010 01:45:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32865</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 14 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02f5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12057</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>