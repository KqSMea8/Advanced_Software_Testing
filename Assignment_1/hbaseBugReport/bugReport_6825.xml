<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:40:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6825/HBASE-6825.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6825] [WINDOWS] Java NIO socket channels does not work with Windows ipv6</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6825</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;While running the test TestAdmin.testCheckHBaseAvailableClosesConnection(), I noticed that it takes very long, since it sleeps for 2sec * 500, because of zookeeper retries. &lt;/p&gt;

&lt;p&gt;The root cause of the problem is that ZK uses Java NIO to create ServerSorcket&apos;s from ServerSocketChannels. Under windows, the ipv4 and ipv6 is implemented independently, and Java seems that it cannot reuse the same socket channel for both ipv4 and ipv6 sockets. We are getting &quot;java.net.SocketException: Address family not supported by protocol&lt;br/&gt;
family&quot; exceptions. When, ZK client resolves &quot;localhost&quot;, it gets both v4 127.0.0.1 and v6 ::1 address, but the socket channel cannot bind to both v4 and v6. &lt;/p&gt;

&lt;p&gt;The problem is reported as:&lt;br/&gt;
&lt;a href=&quot;http://bugs.sun.com/view_bug.do?bug_id=6230761&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bugs.sun.com/view_bug.do?bug_id=6230761&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/1357091/binding-an-ipv6-server-socket-on-windows&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://stackoverflow.com/questions/1357091/binding-an-ipv6-server-socket-on-windows&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Although the JDK bug is reported as resolved, I have tested with jdk1.6.0_33 without any success. Although JDK7 seems to have fixed this problem. In ZK, we can replace the ClientCnxnSocket implementation from ClientCnxnSocketNIO to a non-NIO one, but I am not sure that would be the way to go.&lt;/p&gt;

&lt;p&gt;Disabling ipv6 resolution of &quot;localhost&quot; is one other approach. I&apos;ll test it to see whether it will be any good. &lt;/p&gt;</description>
                <environment>&lt;p&gt;JDK6 on windows for ipv6. &lt;/p&gt;</environment>
        <key id="12608168">HBASE-6825</key>
            <summary>[WINDOWS] Java NIO socket channels does not work with Windows ipv6</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12608153">HBASE-6814</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="enis">Enis Soztutar</assignee>
                                    <reporter username="enis">Enis Soztutar</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Sep 2012 00:06:46 +0000</created>
                <updated>Mon, 23 Sep 2013 18:31:36 +0000</updated>
                            <resolved>Wed, 30 Jan 2013 21:32:15 +0000</resolved>
                                    <version>0.94.3</version>
                    <version>0.95.2</version>
                                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13458315" author="enis" created="Wed, 19 Sep 2012 00:13:18 +0000"  >&lt;p&gt;The ipv6 test attached at &lt;a href=&quot;http://bugs.sun.com/view_bug.do?bug_id=6230761&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bugs.sun.com/view_bug.do?bug_id=6230761&lt;/a&gt; works with jdk1.7.0_6, but not with jdk1.6.0_33 (Windows Server 2008 R2). &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PS C:\Program Files\Java\jdk1.6.0_33\bin&amp;gt; .\java.exe -cp &apos;.\target\classes&apos; ipv6
==&amp;gt; 1
==&amp;gt; 2
java.net.SocketException: Address family not supported by protocol family: bind
        at sun.nio.ch.Net.bind(Native Method)
        at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:126)
        at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:59)
        at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:52)
        at ipv6.main(ipv6.java:30)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PS C:\Program Files\Java\jdk1.7.0_06\bin&amp;gt; .\java.exe -cp &apos;.\target\classes&apos; ipv6
==&amp;gt; 1
==&amp;gt; 2
==&amp;gt; 3
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There are 3 possible workarounds:&lt;br/&gt;
1.) set socket address preference to IPV4 &#8211; &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-Djava.net.preferIPv4Stack=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2.) use &quot;classic&quot; sockets instead of NIO:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ServerSocket s = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ServerSocket(); 
s.bind(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InetSocketAddress(InetAddress.getByName(&lt;span class=&quot;code-quote&quot;&gt;&quot;::&quot;&lt;/span&gt;), 0));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3) set &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\TCPIP6\Parameters\ /v DisabledComponents /t REG_BINARY /d 20
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;setting it either 0x20 of 0xffffffff.  &lt;br/&gt;
&lt;a href=&quot;http://support.microsoft.com/kb/929852&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://support.microsoft.com/kb/929852&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://serverfault.com/questions/218745/disable-ipv6-on-loopback-address-localhost-computer-name&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://serverfault.com/questions/218745/disable-ipv6-on-loopback-address-localhost-computer-name&lt;/a&gt;&lt;br/&gt;
This will either disable ipv6, or cause preference of v4 over v6 on the node.&lt;/p&gt;

&lt;p&gt;However, It seems that 1) is the best approach right now. Note that we have to set -Djava.net.preferIPv4Stack=true at maven (for tests), hbase-env (for deployment), and eclipse (if used for development). I&apos;ll provide a patch.&lt;/p&gt;

&lt;p&gt;Following shows that preferIPv4 works as intended: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class TestPreferIpv4 {
  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPreferIpv4() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;java.net.preferIPv4Stack&quot;&lt;/span&gt; , &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;);
    InetAddress[] addrs = InetAddress.getAllByName(&lt;span class=&quot;code-quote&quot;&gt;&quot;localhost&quot;&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (InetAddress addr : addrs) {
      &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(addr);
    }
  }
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TestPreferIpv4().testPreferIpv4();
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="13487330" author="enis" created="Tue, 30 Oct 2012 22:47:13 +0000"  >&lt;p&gt;Attaching v3 patches&lt;/p&gt;</comment>
                            <comment id="13560385" author="hadoopqa" created="Wed, 23 Jan 2013 04:33:09 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12551445/hbase-6825_v3-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12551445/hbase-6825_v3-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces lines longer than 100&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestLocalHBaseCluster&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4141//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13560411" author="stack" created="Wed, 23 Jan 2013 05:46:55 +0000"  >&lt;p&gt;Patch looks fine Enis.&lt;/p&gt;

&lt;p&gt;This line is ok in the pom though it us under windows profile?  (We require cygwin building windows as platform says?  Then this is ok?)&lt;/p&gt;

&lt;p&gt;+              &amp;lt;argLine&amp;gt;-enableassertions -Xmx1900m -Djava.security.egd=&lt;a href=&quot;file:/dev/./urandom&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/dev/./urandom&lt;/a&gt; -Djava.net.preferIPv4Stack=true&amp;lt;/argLine&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13560442" author="enis" created="Wed, 23 Jan 2013 07:04:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;This line is ok in the pom though it us under windows profile? (We require cygwin building windows as platform says? Then this is ok?)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, we still require cygwin for building, and running the tests, but not for production. There is a plan to get rid of it completely. We just need to do some maven magic and write saveVersion.sh in windows shell, etc. &lt;/p&gt;</comment>
                            <comment id="13560536" author="nkeywal" created="Wed, 23 Jan 2013 10:15:09 +0000"  >&lt;p&gt;If I&apos;m not mistaken, the test uses a fixed port 8502, this should be changed, if not we can have random failures when running the test suites.&lt;/p&gt;

&lt;p&gt;For the issue itself, why should it not make it to the main code? I mean, we test that, on windows, a critical feature works. If not we will have issues. This should be in main, not in test, no?&lt;/p&gt;

&lt;p&gt;I like the way the test is done, btw: we don&apos;t explicitly test the jdk1.7, so it means that if it&apos;s fixed in a later jdk 1.6 patch the code will still be right.&lt;/p&gt;

&lt;p&gt;And actually, this seems to be fixed in 1.6 u34 says &lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/documentation/overview-156328.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.oracle.com/technetwork/java/javase/documentation/overview-156328.html&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If it&apos;s the case, we could put it as a requirement and we&apos;re done (that&apos;s acceptable for 0.96 imho. May be not for 0.94).&lt;/p&gt;</comment>
                            <comment id="13561015" author="enis" created="Wed, 23 Jan 2013 19:49:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;If I&apos;m not mistaken, the test uses a fixed port 8502, this should be changed, if not we can have random failures when running the test suites.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That part of the test mimics the test in the java bug report (&lt;a href=&quot;http://bugs.sun.com/view_bug.do?bug_id=6230761&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bugs.sun.com/view_bug.do?bug_id=6230761&lt;/a&gt;). I think it checks for BindException&apos;s and just passes, assuming an optimistic test. I agree that I should change the fixed port. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;For the issue itself, why should it not make it to the main code? I mean, we test that, on windows, a critical feature works. If not we will have issues. This should be in main, not in test, no?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sorry, I failed to give enough context here. In the original patches, we did have a change for passing -Djava.net.preferIPv4Stack=true in the bin/hbase.cmd script. But I removed that one so that this patch would not depend on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6815&quot; title=&quot;[WINDOWS] Provide hbase scripts in order to start HBASE on Windows in a single user mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6815&quot;&gt;&lt;del&gt;HBASE-6815&lt;/del&gt;&lt;/a&gt;. In the actual patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6815&quot; title=&quot;[WINDOWS] Provide hbase scripts in order to start HBASE on Windows in a single user mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6815&quot;&gt;&lt;del&gt;HBASE-6815&lt;/del&gt;&lt;/a&gt;, we are passing preferipv4 to the hbase daemons through hbase.cmd script. In hbase-env.cmd:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+@rem Extra Java runtime options.
+@rem Below are what we set by &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.  May only work with SUN JVM.
+@rem For more on why as well as other possible settings,
+@rem see http:&lt;span class=&quot;code-comment&quot;&gt;//wiki.apache.org/hadoop/PerformanceTuning
&lt;/span&gt;+@rem JDK6 on Windows has a known bug &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; IPv6, use preferIPv4Stack unless JDK7.
+@rem @rem See TestIPv6NIOServerSocketChannel.
+set HBASE_OPTS=&lt;span class=&quot;code-quote&quot;&gt;&quot;-XX:+UseConcMarkSweepGC&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;-Djava.net.preferIPv4Stack=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;&lt;p&gt;And actually, this seems to be fixed in 1.6 u34 says &lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/documentation/overview-156328.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.oracle.com/technetwork/java/javase/documentation/overview-156328.html&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Let me test this one. After &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7301&quot; title=&quot;Force ipv4 for unit tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7301&quot;&gt;&lt;del&gt;HBASE-7301&lt;/del&gt;&lt;/a&gt;, we are running the tests with ipv4 on linux anyway, so we might as well commit this one regardless. &lt;/p&gt;</comment>
                            <comment id="13562285" author="enis" created="Fri, 25 Jan 2013 02:18:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;And actually, this seems to be fixed in 1.6 u34 says &lt;a href=&quot;http://www.oracle.com/technetwork/java/javase/documentation/overview-156328.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.oracle.com/technetwork/java/javase/documentation/overview-156328.html&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I&apos;ve tested this with 1.6 u38 with no luck. Although it is reported fixed, unfortunately it is not. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PS C:\hbase-trunk&amp;gt; bin/hbase  org.apache.hadoop.hbase.TestIPv6NIOServerSocketChannel
java version &lt;span class=&quot;code-quote&quot;&gt;&quot;1.6.0_38&quot;&lt;/span&gt;
Java(TM) SE &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment (build 1.6.0_38-b05)
Java HotSpot(TM) 64-Bit Server VM (build 20.13-b02, mixed mode)
13/01/24 18:15:33 INFO hbase.TestIPv6NIOServerSocketChannel: Received expected exception:
13/01/24 18:15:33 INFO hbase.TestIPv6NIOServerSocketChannel: java.net.SocketException: Protocol family not supported
13/01/24 18:15:33 INFO hbase.TestIPv6NIOServerSocketChannel: resolved localhost as:localhost/127.0.0.1
13/01/24 18:15:33 INFO hbase.TestIPv6NIOServerSocketChannel: resolved localhost as:localhost/127.0.0.1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13563091" author="enis" created="Fri, 25 Jan 2013 22:01:23 +0000"  >&lt;p&gt;Updated the patch with Nicolas&apos; comments. &lt;/p&gt;</comment>
                            <comment id="13563136" author="hadoopqa" created="Fri, 25 Jan 2013 23:04:31 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12566566/hbase-6825_v4-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12566566/hbase-6825_v4-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4186//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13565708" author="enis" created="Tue, 29 Jan 2013 19:43:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; could you please look at the v4 patch when you have time. Thanks. &lt;/p&gt;</comment>
                            <comment id="13566323" author="nkeywal" created="Wed, 30 Jan 2013 09:21:15 +0000"  >&lt;p&gt;+              &amp;lt;argLine&amp;gt;-enableassertions -Xmx1900m -Djava.security.egd=&lt;a href=&quot;file:/dev/./urandom&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/dev/./urandom&lt;/a&gt; -DTestIPv6NIOServerSocketChannel=true&amp;lt;/argLine&amp;gt;&lt;/p&gt;

&lt;p&gt;Why the -DTestIPv6NIOServerSocketChannel ? I don&apos;t see where you use this in the patch, and it was not in the previous version?&lt;/p&gt;

&lt;p&gt;The -Djava.net.preferIPv4Stack=true that we have in the default profile does not make it on windows?&lt;br/&gt;
May be it is worth configuring the failsafe as well?&lt;/p&gt;

&lt;p&gt;+1 for the patch otherwise, fun to see that it&apos;s not fixed despite the release notes...&lt;/p&gt;</comment>
                            <comment id="13566806" author="enis" created="Wed, 30 Jan 2013 19:24:22 +0000"  >&lt;p&gt;ops, that should be -Djava.net.preferIPv4Stack=true instead of -DTestIPv6NIOServerSocketChannel=true&lt;/p&gt;</comment>
                            <comment id="13566918" author="enis" created="Wed, 30 Jan 2013 21:28:00 +0000"  >&lt;p&gt;Attaching v5 patch. Fixed -Djava.net.preferIPv4Stack=true issue. &lt;/p&gt;</comment>
                            <comment id="13566923" author="enis" created="Wed, 30 Jan 2013 21:32:16 +0000"  >&lt;p&gt;Committed this. Thanks nkeywal for review. &lt;/p&gt;</comment>
                            <comment id="13567197" author="hudson" created="Thu, 31 Jan 2013 01:03:58 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3829 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3829/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3829/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6825&quot; title=&quot;[WINDOWS] Java NIO socket channels does not work with Windows ipv6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6825&quot;&gt;&lt;del&gt;HBASE-6825&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;WINDOWS&amp;#93;&lt;/span&gt; Java NIO socket channels does not work with Windows ipv6 (Revision 1440679)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
enis : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/TestIPv6NIOServerSocketChannel.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13567266" author="hudson" created="Thu, 31 Jan 2013 02:30:35 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #385 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/385/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/385/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6825&quot; title=&quot;[WINDOWS] Java NIO socket channels does not work with Windows ipv6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6825&quot;&gt;&lt;del&gt;HBASE-6825&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;WINDOWS&amp;#93;&lt;/span&gt; Java NIO socket channels does not work with Windows ipv6 (Revision 1440679)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
enis : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/TestIPv6NIOServerSocketChannel.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13775482" author="stack" created="Mon, 23 Sep 2013 18:31:36 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12608157">HBASE-6817</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12607551">HIVE-3461</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12622965">HBASE-7301</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12551444" name="hbase-6825_v3-0.94.patch" size="6383" author="enis" created="Tue, 30 Oct 2012 22:47:13 +0000"/>
                            <attachment id="12551445" name="hbase-6825_v3-trunk.patch" size="6289" author="enis" created="Tue, 30 Oct 2012 22:47:13 +0000"/>
                            <attachment id="12566566" name="hbase-6825_v4-trunk.patch" size="6586" author="enis" created="Fri, 25 Jan 2013 22:01:23 +0000"/>
                            <attachment id="12567214" name="hbase-6825_v5-trunk.patch" size="6580" author="enis" created="Wed, 30 Jan 2013 21:28:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 23 Jan 2013 04:33:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>242467</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02v3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14639</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>