<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:36:49 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6443/HBASE-6443.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6443] HLogSplitter should ignore 0 length files</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6443</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Somehow, some WAL files have size 0. Distributed log splitting can&apos;t handle it.&lt;br/&gt;
HLogSplitter should ignore them.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12599905">HBASE-6443</key>
            <summary>HLogSplitter should ignore 0 length files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="jxiang">Jimmy Xiang</assignee>
                                    <reporter username="jxiang">Jimmy Xiang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Jul 2012 21:44:00 +0000</created>
                <updated>Wed, 10 Apr 2013 00:10:38 +0000</updated>
                            <resolved>Wed, 5 Sep 2012 00:06:04 +0000</resolved>
                                                    <fixVersion>0.94.1</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13420984" author="jxiang" created="Mon, 23 Jul 2012 21:52:44 +0000"  >&lt;p&gt;Checked the code.  It seems HBase leaves this issue to callers to decide what to do.&lt;/p&gt;

&lt;p&gt;Close it as Invalid.&lt;/p&gt;</comment>
                            <comment id="13436504" author="jmhsieh" created="Fri, 17 Aug 2012 01:42:59 +0000"  >&lt;p&gt;I&apos;ve been able to do this regularly by doing a bad upgarde procedure.  Get  cluster running on 0.90 loading data.  Kill -9 the rs&apos;s.  &lt;/p&gt;

&lt;p&gt;At this point I actually upgrade hdfs to 2.0 and hadoop to 0.92.  Dist log splitting gets through valid files but leaves some behind in error state.&lt;/p&gt;</comment>
                            <comment id="13436564" author="ram_krish" created="Fri, 17 Aug 2012 05:28:27 +0000"  >&lt;p&gt;@Jon/Jimmy&lt;br/&gt;
This has got something to do with &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-3222&quot; title=&quot;DFSInputStream#openInfo should not silently get the length as 0 when locations length is zero for last partial block.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-3222&quot;&gt;&lt;del&gt;HDFS-3222&lt;/del&gt;&lt;/a&gt;?  We had an internal patch for 0.90 version where we would try to get the blocklocations from NN based on retries.&lt;br/&gt;
If with in the retry i could find the block locations then the HLog will be non emtpy.  If not really it is an empty HLog File.  This scenario happens in older HDFS versions where the NN switches and internally if it was not able to get the length 0 was getting returned without retrying.&lt;br/&gt;
I may be wrong here, but just thought it may be same.  Thanks.&lt;/p&gt;</comment>
                            <comment id="13436858" author="jxiang" created="Fri, 17 Aug 2012 16:50:23 +0000"  >&lt;p&gt;@Ram, could you share the patch?&lt;/p&gt;</comment>
                            <comment id="13437115" author="jxiang" created="Fri, 17 Aug 2012 22:24:26 +0000"  >&lt;p&gt;Looked into it again.  A normal empty hlog file doesn&apos;t cause a problem with log splitting.  Only if the file is corrupted somehow, it causes problems:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.io.IOException: Could not obtain the last block locations.
at org.apache.hadoop.hdfs.DFSInputStream.openInfo(DFSInputStream.java:138)
at org.apache.hadoop.hdfs.DFSInputStream.&amp;lt;init&amp;gt;(DFSInputStream.java:112)
at org.apache.hadoop.hdfs.DFSClient.open(DFSClient.java:939)
at org.apache.hadoop.hdfs.DistributedFileSystem.open(DistributedFileSystem.java:212)
at org.apache.hadoop.hdfs.DistributedFileSystem.open(DistributedFileSystem.java:75)
at org.apache.hadoop.io.SequenceFile$Reader.openFile(SequenceFile.java:1768)
at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader$WALReader.openFile(SequenceFileLogReader.java:66)
at org.apache.hadoop.io.SequenceFile$Reader.&amp;lt;init&amp;gt;(SequenceFile.java:1688)
at org.apache.hadoop.io.SequenceFile$Reader.&amp;lt;init&amp;gt;(SequenceFile.java:1709)
at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader$WALReader.&amp;lt;init&amp;gt;(SequenceFileLogReader.java:58)
at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.init(SequenceFileLogReader.java:166)
at org.apache.hadoop.hbase.regionserver.wal.HLog.getReader(HLog.java:659)
at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter.getReader(HLogSplitter.java:846)
at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter.getReader(HLogSplitter.java:759)
at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter.splitLogFileToTemp(HLogSplitter.java:384) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I manually ceate an empty hlog file, log splitting can handle it properly with no problem.&lt;/p&gt;
</comment>
                            <comment id="13437118" author="jxiang" created="Fri, 17 Aug 2012 22:32:55 +0000"  >&lt;p&gt;Is this related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-3522&quot; title=&quot;If NN is in safemode, it should throw SafeModeException when getBlockLocations has zero locations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-3522&quot;&gt;&lt;del&gt;HDFS-3522&lt;/del&gt;&lt;/a&gt;/&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-3524&quot; title=&quot;TestFileLengthOnClusterRestart failed due to error message change&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-3524&quot;&gt;&lt;del&gt;HDFS-3524&lt;/del&gt;&lt;/a&gt;? It seems to me these files are either corrupted, or HDFS has some issue at that moment.&lt;/p&gt;</comment>
                            <comment id="13438937" author="ram_krish" created="Tue, 21 Aug 2012 18:45:39 +0000"  >&lt;p&gt;I can share you the patch tomorrow.  &lt;/p&gt;</comment>
                            <comment id="13448226" author="jxiang" created="Wed, 5 Sep 2012 00:06:04 +0000"  >&lt;p&gt;Won&apos;t fix this in HBase layer.  It is kind of a HDFS issue.  If the hlog has size 0, but not corrupted, HLogSplitter can handle it properly.  Only if the hlog file is corrupted, HLogSplitter can&apos;t handle it.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12549917">HDFS-3222</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12641748">HBASE-8314</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12560119">HDFS-3522</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Aug 2012 01:42:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245313</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i067r3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34187</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>