<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:19:38 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11042/HBASE-11042.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11042] TestForceCacheImportantBlocks OOMs occasionally in 0.94</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11042</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This trace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.OutOfMemoryError
	at java.util.zip.Deflater.init(Native Method)
	at java.util.zip.Deflater.&amp;lt;init&amp;gt;(Deflater.java:169)
	at java.util.zip.GZIPOutputStream.&amp;lt;init&amp;gt;(GZIPOutputStream.java:91)
	at java.util.zip.GZIPOutputStream.&amp;lt;init&amp;gt;(GZIPOutputStream.java:110)
	at org.apache.hadoop.hbase.io.hfile.ReusableStreamGzipCodec$ReusableGzipOutputStream$ResetableGZIPOutputStream.&amp;lt;init&amp;gt;(ReusableStreamGzipCodec.java:79)
	at org.apache.hadoop.hbase.io.hfile.ReusableStreamGzipCodec$ReusableGzipOutputStream.&amp;lt;init&amp;gt;(ReusableStreamGzipCodec.java:90)
	at org.apache.hadoop.hbase.io.hfile.ReusableStreamGzipCodec.createOutputStream(ReusableStreamGzipCodec.java:130)
	at org.apache.hadoop.io.compress.GzipCodec.createOutputStream(GzipCodec.java:101)
	at org.apache.hadoop.hbase.io.hfile.Compression$Algorithm.createPlainCompressionStream(Compression.java:299)
	at org.apache.hadoop.hbase.io.hfile.Compression$Algorithm.createCompressionStream(Compression.java:283)
	at org.apache.hadoop.hbase.io.hfile.HFileWriterV1.getCompressingStream(HFileWriterV1.java:207)
	at org.apache.hadoop.hbase.io.hfile.HFileWriterV1.close(HFileWriterV1.java:356)
	at org.apache.hadoop.hbase.regionserver.StoreFile$Writer.close(StoreFile.java:1330)
	at org.apache.hadoop.hbase.regionserver.Store.internalFlushCache(Store.java:913)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that is caused specifically by HFileWriteV1 when using compression. It looks like the compression resources are not released.&lt;/p&gt;

&lt;p&gt;Not sure it&apos;s worth fixing this at this point. The test can be fixed by either not using compression (why are we using compression anyway), or by not testing for HFileV1.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; it seems you know the the code in HFileWriterV1. Do you want to have a look? Maybe there is a quick fix in HFileWriterV1.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12709463">HBASE-11042</key>
            <summary>TestForceCacheImportantBlocks OOMs occasionally in 0.94</summary>
                <type id="6" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/requirement.png">Test</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lhofhansl">Lars Hofhansl</assignee>
                                    <reporter username="lhofhansl">Lars Hofhansl</reporter>
                        <labels>
                    </labels>
                <created>Sun, 20 Apr 2014 18:12:55 +0000</created>
                <updated>Mon, 28 Apr 2014 22:29:37 +0000</updated>
                            <resolved>Sun, 20 Apr 2014 23:55:45 +0000</resolved>
                                                    <fixVersion>0.94.19</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13975217" author="lhofhansl" created="Sun, 20 Apr 2014 18:39:53 +0000"  >&lt;p&gt;Here&apos;s a test-only fix for 0.94 (note that this test is broken in 0.96 and later - it&apos;s no-op there).&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;turns off compression for the HFileV1 test (that is what is using up all the heap)&lt;/li&gt;
	&lt;li&gt;adds tests so that HFileV2 is testing with and without compression&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13975218" author="lhofhansl" created="Sun, 20 Apr 2014 18:40:54 +0000"  >&lt;p&gt;This is in HFileWriterV1. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;, looks like a comment you would write &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; DataOutputStream getCompressingStream() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.compressor = compressAlgo.getCompressor();
    &lt;span class=&quot;code-comment&quot;&gt;// Get &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DOS compression stream. In tfile, the DOS, is not closed,
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// just finished, and that seems to be fine over there. TODO: Check
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// no memory retention of the DOS. Should I disable the &apos;flush&apos; on the
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// DOS as the BCFile over in tfile does? It wants to make it so flushes
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// don&apos;t go through to the underlying compressed stream. Flush on the
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// compressed downstream should be only when done. I was going to but
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// looks like when we call flush in here, its legitimate flush that
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// should go through to the compressor.
&lt;/span&gt;    OutputStream os = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.compressAlgo.createCompressionStream(
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.outputStream, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.compressor, 0);
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DataOutputStream(os);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13975320" author="stack" created="Sun, 20 Apr 2014 23:30:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;stack it seems you know the the code in HFileWriterV1. Do you want to have a look?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No.  v1 is dead.  Go ahead w/ your patch.&lt;/p&gt;</comment>
                            <comment id="13975322" author="lhofhansl" created="Sun, 20 Apr 2014 23:55:45 +0000"  >&lt;p&gt;Alright. Committed to 0.94. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13975340" author="hudson" created="Mon, 21 Apr 2014 01:16:25 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94-security #478 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/478/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/478/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11042&quot; title=&quot;TestForceCacheImportantBlocks OOMs occasionally in 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11042&quot;&gt;&lt;del&gt;HBASE-11042&lt;/del&gt;&lt;/a&gt; TestForceCacheImportantBlocks OOMs occasionally in 0.94. (larsh: rev 1588841)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestForceCacheImportantBlocks.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13975347" author="hudson" created="Mon, 21 Apr 2014 01:40:42 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-JDK7 #128 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-JDK7/128/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-JDK7/128/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11042&quot; title=&quot;TestForceCacheImportantBlocks OOMs occasionally in 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11042&quot;&gt;&lt;del&gt;HBASE-11042&lt;/del&gt;&lt;/a&gt; TestForceCacheImportantBlocks OOMs occasionally in 0.94. (larsh: rev 1588841)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestForceCacheImportantBlocks.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13975348" author="hudson" created="Mon, 21 Apr 2014 01:44:35 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94 #1362 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1362/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1362/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11042&quot; title=&quot;TestForceCacheImportantBlocks OOMs occasionally in 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11042&quot;&gt;&lt;del&gt;HBASE-11042&lt;/del&gt;&lt;/a&gt; TestForceCacheImportantBlocks OOMs occasionally in 0.94. (larsh: rev 1588841)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestForceCacheImportantBlocks.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13975352" author="hudson" created="Mon, 21 Apr 2014 02:20:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-on-Hadoop-2 #80 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-on-Hadoop-2/80/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-on-Hadoop-2/80/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11042&quot; title=&quot;TestForceCacheImportantBlocks OOMs occasionally in 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11042&quot;&gt;&lt;del&gt;HBASE-11042&lt;/del&gt;&lt;/a&gt; TestForceCacheImportantBlocks OOMs occasionally in 0.94. (larsh: rev 1588841)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestForceCacheImportantBlocks.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12640998" name="11042-0.94.txt" size="2061" author="lhofhansl" created="Sun, 20 Apr 2014 18:39:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 20 Apr 2014 23:30:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>387785</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 34 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1usvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>388046</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>