<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:54:40 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1577/HBASE-1577.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1577] Move memcache to ConcurrentSkipListMap from ConcurrentSkipListSet</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1577</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The CSLM will replace old entry with a new when you put.  The CSLS will NOT replace if existent key making for a test, and if present, remove semantic which to be safe needs synchronizing (Replacement is a Ryan Rawson suggestion).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12428717">HBASE-1577</key>
            <summary>Move memcache to ConcurrentSkipListMap from ConcurrentSkipListSet</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Jun 2009 23:06:05 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:46 +0000</updated>
                            <resolved>Thu, 25 Jun 2009 21:23:02 +0000</resolved>
                                                    <fixVersion>0.20.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12723358" author="stack" created="Tue, 23 Jun 2009 23:19:47 +0000"  >&lt;p&gt;First cut at patch that changes memcache from Set to Map.&lt;/p&gt;</comment>
                            <comment id="12723462" author="streamy" created="Wed, 24 Jun 2009 06:12:48 +0000"  >&lt;p&gt;Code in patch looks good, have not tested.  +1 given change discussed on IRC from value byte&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; -&amp;gt; Long(0)&lt;/p&gt;</comment>
                            <comment id="12723468" author="stack" created="Wed, 24 Jun 2009 06:25:01 +0000"  >&lt;p&gt;Thanks for review Jon.&lt;/p&gt;

&lt;p&gt;This version of patch is part convertion to use Boolean.TRUE (as concurrentskiplist uses internally).  Will finish in morning and commit.&lt;/p&gt;</comment>
                            <comment id="12723668" author="stack" created="Wed, 24 Jun 2009 18:19:58 +0000"  >&lt;p&gt;Committed with a special value Object named NULL that is private to Memcache.&lt;/p&gt;</comment>
                            <comment id="12723792" author="stack" created="Wed, 24 Jun 2009 23:14:45 +0000"  >&lt;p&gt;Reopening.  Should have tested before making change.  Doesn&apos;t work.  &apos;replace&apos; or &apos;put&apos; will not change key if &apos;equal&apos;.  Will revert to Set and see what can do about it &amp;#8211; anything but synchronizing all get/puts in memstore.&lt;/p&gt;</comment>
                            <comment id="12723853" author="stack" created="Thu, 25 Jun 2009 01:27:53 +0000"  >&lt;p&gt;Experimenting and chatting w/ Ryan, he suggested putting kv into value too.  Then when new kv that has an extant key but whose value is different, the key object in Map stays same but it looks like the &apos;new&apos; kv goes in as value.  This will do for us.  Just need to do bunch of work making sure we always get from value, not from key.  Also, need to explain it and be careful with how we update HeapSize &amp;#8211; if different value, then be sure to add differences.   Could become significant.&lt;/p&gt;</comment>
                            <comment id="12723857" author="ryanobjc" created="Thu, 25 Jun 2009 01:34:05 +0000"  >&lt;p&gt;ICV is the primary user of this tricky use case.&lt;/p&gt;

&lt;p&gt;We won&apos;t actually be increasing memory usage of the memstore (our new name for memcache, like it?), since the pointers already exist, we are just setting them to something meaningful (KeyValue) than an object like Boolean.TRUE (what the set does under the covers).&lt;/p&gt;

&lt;p&gt;During ICV we could end up doubling the amount of memory we are using due to the use of a different KeyValue in the &apos;value&apos; position vs the &apos;key&apos; position... This is unfortunate, but it might not be as bad as it seems, so far I find that values stored in ICV take up so little space, that doubling 2kb -&amp;gt; 4kb is really not much, considering the important race hole we are fixing.&lt;/p&gt;</comment>
                            <comment id="12723884" author="stack" created="Thu, 25 Jun 2009 03:37:06 +0000"  >&lt;p&gt;ICV is not only user.  Anything what would overwrite a version that is in memcache at same coordinates will run into this issue.&lt;/p&gt;

&lt;p&gt;Yeah, we could end up using more memory if a good portion of the memstore has overwrites.  We need to keep up our HeapSize math.&lt;/p&gt;</comment>
                            <comment id="12723901" author="stack" created="Thu, 25 Jun 2009 05:29:08 +0000"  >&lt;p&gt;Sketch of new MemStore innerclass.  Not finished.&lt;/p&gt;</comment>
                            <comment id="12724198" author="stack" created="Thu, 25 Jun 2009 19:02:23 +0000"  >&lt;p&gt;Adds new class, KeyValueSkipListSet, that works like a ConcurrentSkipListSet in all but one regard: overwrites extant keys.  Retrofit MemStore, etc., to use new class.&lt;/p&gt;</comment>
                            <comment id="12724221" author="stack" created="Thu, 25 Jun 2009 19:32:24 +0000"  >&lt;p&gt;Added note on the return from add and flipped what it considered &apos;true&apos;.&lt;/p&gt;</comment>
                            <comment id="12724305" author="stack" created="Thu, 25 Jun 2009 21:23:02 +0000"  >&lt;p&gt;Committed after fixing typos and redoing descending iterator on a jgray suggestion.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12411609" name="1577-v2.patch" size="27539" author="stack" created="Wed, 24 Jun 2009 06:25:01 +0000"/>
                            <attachment id="12411845" name="1577-v3.patch" size="47188" author="stack" created="Thu, 25 Jun 2009 19:02:23 +0000"/>
                            <attachment id="12411849" name="1577-v4.patch" size="47511" author="stack" created="Thu, 25 Jun 2009 19:32:24 +0000"/>
                            <attachment id="12411744" name="kvskiplistset.patch" size="5968" author="stack" created="Thu, 25 Jun 2009 05:29:08 +0000"/>
                            <attachment id="12411586" name="set2map.patch" size="26537" author="stack" created="Tue, 23 Jun 2009 23:19:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 24 Jun 2009 06:12:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32192</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0he2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99543</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>