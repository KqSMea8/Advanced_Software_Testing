<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:52:24 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1303/HBASE-1303.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1303] Secondary index configuration prevents HBase from starting</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1303</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;HBase does not start up when configured to use the IndexedRegionServer with the following properties in hbase-site.xml&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;property&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;hbase.regionserver.class&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;value&amp;gt;&lt;/span&gt;org.apache.hadoop.hbase.ipc.IndexedRegionInterface&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;Indexing is enabled for this hbase server.  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;property&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;hbase.regionserver.impl&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;value&amp;gt;&lt;/span&gt;org.apache.hadoop.hbase.regionserver.tableindexed.IndexedRegionServer&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/value&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;Indexing is enabled for this hbase server.&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This results in the following exception in the log:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2009-03-31 12:33:35,993 INFO org.apache.hadoop.ipc.HBaseServer: IPC Server handler 8 on 45026, call getProtocolVersion(org.apache.hadoop.hbase.ipc.IndexedRegionInterface, 16) from 127.0.0.1:60854: error: java.io.IOException: Unknown protocol to name node: org.apache.hadoop.hbase.ipc.IndexedRegionInterface
java.io.IOException: Unknown protocol to name node: org.apache.hadoop.hbase.ipc.IndexedRegionInterface
    at org.apache.hadoop.hbase.regionserver.HRegionServer.getProtocolVersion(HRegionServer.java:2146)
    at org.apache.hadoop.hbase.regionserver.transactional.TransactionalRegionServer.getProtocolVersion(TransactionalRegionServer.java:92)
    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:632)
    at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:912)
2009-03-31 12:33:35,994 WARN org.apache.hadoop.hbase.master.BaseScanner: Scan ROOT region
java.io.IOException: java.io.IOException: Unknown protocol to name node: org.apache.hadoop.hbase.ipc.IndexedRegionInterface
    at org.apache.hadoop.hbase.regionserver.HRegionServer.getProtocolVersion(HRegionServer.java:2146)
    at org.apache.hadoop.hbase.regionserver.transactional.TransactionalRegionServer.getProtocolVersion(TransactionalRegionServer.java:92)
    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:632)
    at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:912)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is also a mailing list post on this problem:&lt;br/&gt;
&lt;a href=&quot;http://markmail.org/message/6pugle5uegiijjbc?q=Secondary+Indexes+problem&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://markmail.org/message/6pugle5uegiijjbc?q=Secondary+Indexes+problem&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think the solution is to implement &lt;tt&gt;public long getProtocolVersion(final String protocol, final long clientVersion)&lt;/tt&gt; in &lt;tt&gt;org.apache.hadoop.hbase.regionserver.tableindexed.IndexedRegionServer&lt;/tt&gt; as follows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  @Override
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; getProtocolVersion(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; protocol, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; clientVersion)
      &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (protocol.equals(IndexedRegionInterface.class.getName())) {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; HBaseRPCProtocolVersion.versionID;
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.getProtocolVersion(protocol, clientVersion);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12421732">HBASE-1303</key>
            <summary>Secondary index configuration prevents HBase from starting</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kweiner">Ken Weiner</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Apr 2009 01:39:10 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:31 +0000</updated>
                            <resolved>Thu, 2 Apr 2009 07:33:22 +0000</resolved>
                                    <version>0.19.1</version>
                                    <fixVersion>0.19.2</fixVersion>
                    <fixVersion>0.20.0</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12694355" author="kweiner" created="Wed, 1 Apr 2009 01:40:14 +0000"  >&lt;p&gt;Index: src/java/org/apache/hadoop/hbase/regionserver/tableindexed/IndexedRegionServer.java&lt;br/&gt;
===================================================================&lt;br/&gt;
&amp;#8212; src/java/org/apache/hadoop/hbase/regionserver/tableindexed/IndexedRegionServer.java	(revision 760746)&lt;br/&gt;
+++ src/java/org/apache/hadoop/hbase/regionserver/tableindexed/IndexedRegionServer.java	(working copy)&lt;br/&gt;
@@ -25,6 +25,7 @@&lt;br/&gt;
 import org.apache.hadoop.hbase.HRegionInfo;&lt;br/&gt;
 import org.apache.hadoop.hbase.HServerAddress;&lt;br/&gt;
 import org.apache.hadoop.hbase.HTableDescriptor;&lt;br/&gt;
+import org.apache.hadoop.hbase.ipc.HBaseRPCProtocolVersion;&lt;br/&gt;
 import org.apache.hadoop.hbase.ipc.IndexedRegionInterface;&lt;br/&gt;
 import org.apache.hadoop.hbase.regionserver.HRegion;&lt;br/&gt;
 import org.apache.hadoop.hbase.regionserver.transactional.TransactionalRegionServer;&lt;br/&gt;
@@ -48,6 +49,15 @@&lt;br/&gt;
   }&lt;/p&gt;

&lt;p&gt;   @Override&lt;br/&gt;
+  public long getProtocolVersion(final String protocol, final long clientVersion)&lt;br/&gt;
+      throws IOException {&lt;br/&gt;
+    if (protocol.equals(IndexedRegionInterface.class.getName())) &lt;/p&gt;
{
+      return HBaseRPCProtocolVersion.versionID;
+    }
&lt;p&gt;+    return super.getProtocolVersion(protocol, clientVersion);&lt;br/&gt;
+  }&lt;br/&gt;
+&lt;br/&gt;
+  @Override&lt;br/&gt;
   protected HRegion instantiateRegion(final HRegionInfo regionInfo)&lt;br/&gt;
       throws IOException {&lt;br/&gt;
     HRegion r = new IndexedRegion(HTableDescriptor.getTableDir(super&lt;/p&gt;</comment>
                            <comment id="12694358" author="nitay" created="Wed, 1 Apr 2009 02:11:37 +0000"  >&lt;p&gt;+1 looks right to me Ken. &lt;/p&gt;

&lt;p&gt;Please upload a patch with your fix instead of adding a comment with it. See &lt;a href=&quot;http://wiki.apache.org/hadoop/Hbase/HowToContribute&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/Hbase/HowToContribute&lt;/a&gt; for more information.&lt;/p&gt;</comment>
                            <comment id="12694819" author="kweiner" created="Wed, 1 Apr 2009 22:57:15 +0000"  >&lt;p&gt;Please review my attached patch.&lt;/p&gt;</comment>
                            <comment id="12694901" author="stack" created="Thu, 2 Apr 2009 07:33:22 +0000"  >&lt;p&gt;Committed branch and trunk.  Thanks for the patch Ken.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12404400" name="HBASE-1303_0.19.1.patch" size="1684" author="kweiner" created="Wed, 1 Apr 2009 22:57:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 1 Apr 2009 02:11:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25676</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 38 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hchr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99286</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>