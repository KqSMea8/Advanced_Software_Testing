<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:58:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14987/HBASE-14987.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14987] Compaction marker whose region name doesn&apos;t match current region&apos;s needs to be handled</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14987</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;One customer encountered the following error when replaying recovered edits, leading to region open failure:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
region=table1,d6b-2282-9223370590058224807-U-9856557-        EJ452727-16313786400171,1449616291799.fa8a526f2578eb3630bb08a4b1648f5d., starting to roll back the global memstore   size.
org.apache.hadoop.hbase.regionserver.WrongRegionException: Compaction marker from WAL table_name: &lt;span class=&quot;code-quote&quot;&gt;&quot;table1&quot;&lt;/span&gt;
encoded_region_name: &lt;span class=&quot;code-quote&quot;&gt;&quot;d389c70fde9ec07971d0cfd20ef8f575&quot;&lt;/span&gt;
...
region_name: &lt;span class=&quot;code-quote&quot;&gt;&quot;table1,d6b-2282-9223370590058224807-U-9856557-EJ452727-16313786400171,1449089609367.d389c70fde9ec07971d0cfd20ef8f575.&quot;&lt;/span&gt;
 targetted &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region d389c70fde9ec07971d0cfd20ef8f575 does not match &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; region: {ENCODED =&amp;gt; fa8a526f2578eb3630bb08a4b1648f5d, NAME =&amp;gt; &apos;table1,d6b-2282-                        9223370590058224807-U-9856557-EJ452727-16313786400171,1449616291799.fa8a526f2578eb3630bb08a4b1648f5d.&apos;, STARTKEY =&amp;gt; &apos;d6b-2282-9223370590058224807-U-9856557-EJ452727-             16313786400171&apos;, ENDKEY =&amp;gt; &apos;d76-2553-9223370588576178807-U-7416904-EK875822-17662180600000&apos;}
  at org.apache.hadoop.hbase.regionserver.HRegion.checkTargetRegion(HRegion.java:4592)
  at org.apache.hadoop.hbase.regionserver.HRegion.replayWALCompactionMarker(HRegion.java:3831)
  at org.apache.hadoop.hbase.regionserver.HRegion.replayRecoveredEdits(HRegion.java:3747)
  at org.apache.hadoop.hbase.regionserver.HRegion.replayRecoveredEditsIfAny(HRegion.java:3601)
  at org.apache.hadoop.hbase.regionserver.HRegion.initializeRegionStores(HRegion.java:911)
  at org.apache.hadoop.hbase.regionserver.HRegion.initializeRegionInternals(HRegion.java:789)
  at org.apache.hadoop.hbase.regionserver.HRegion.initialize(HRegion.java:762)
  at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:5774)
  at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:5744)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This was likely caused by the following action of hbck:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
15/12/08 18:11:34 INFO util.HBaseFsck: [hbasefsck-pool1-t37] Moving files from hdfs:&lt;span class=&quot;code-comment&quot;&gt;//Zealand/hbase/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/table1/d389c70fde9ec07971d0cfd20ef8f575/recovered.edits into     containing region hdfs://Zealand/hbase/data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/table1/fa8a526f2578eb3630bb08a4b1648f5d/recovered.edits&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The recovered.edits for d389c70fde9ec07971d0cfd20ef8f575 contained compaction marker which couldn&apos;t be replayed against fa8a526f2578eb3630bb08a4b1648f5d&lt;/p&gt;</description>
                <environment></environment>
        <key id="12922202">HBASE-14987</key>
            <summary>Compaction marker whose region name doesn&apos;t match current region&apos;s needs to be handled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuzhihong@gmail.com">Ted Yu</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Dec 2015 00:25:05 +0000</created>
                <updated>Mon, 8 Feb 2016 04:57:33 +0000</updated>
                            <resolved>Mon, 4 Jan 2016 15:21:21 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>0.98.17</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="15059194" author="yuzhihong@gmail.com" created="Wed, 16 Dec 2015 00:27:31 +0000"  >&lt;p&gt;Approaches I can think of:&lt;br/&gt;
1. rewrite compaction marker so that it matches the new region&lt;br/&gt;
2. annotate the recovered edits so that log replay can understand the transition for the compaction marker and handle it properly&lt;/p&gt;</comment>
                            <comment id="15061852" author="chenheng" created="Thu, 17 Dec 2015 10:24:08 +0000"  >&lt;p&gt;Could we just skip it directly?  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="15062360" author="yuzhihong@gmail.com" created="Thu, 17 Dec 2015 17:16:12 +0000"  >&lt;p&gt;The compaction marker is used by region replica feature.&lt;br/&gt;
We should not skip replaying it.&lt;/p&gt;

&lt;p&gt;During interval discussion a 3rd approach was brought up: replay the recovered edits from hbck.&lt;br/&gt;
There may be several recovered edits which need to be replayed. In this approach, hbck needs to perform the replay in parallel.&lt;br/&gt;
There may be more marker(s) added in the future, this approach introduces tight coupling between hbck and WAL handling.&lt;/p&gt;

&lt;p&gt;A 4th approach might be not throwing WrongRegionException for the compaction marker in WAL. Assumption is that hbck (or admin) may move WAL from region A to region B.&lt;/p&gt;</comment>
                            <comment id="15062926" author="yuzhihong@gmail.com" created="Thu, 17 Dec 2015 22:00:16 +0000"  >&lt;p&gt;Looking at the code, checkTargetRegion() is called by the following methods of HRegion:&lt;/p&gt;

&lt;p&gt;replayWALCompactionMarker&lt;br/&gt;
replayWALFlushMarker&lt;br/&gt;
replayWALRegionEventMarker&lt;br/&gt;
replayWALBulkLoadEventMarker&lt;/p&gt;

&lt;p&gt;Meaning, the above 4 markers should be handled in the same way. Otherwise, region open may still fail if one of the other 3 markers is present in the WAL.&lt;/p&gt;

&lt;p&gt;In hindsight, these markers are relocatable. Meaning, marker for region X should be allowed to be replayed against region Y (in light of the hbck induced WAL movement).&lt;br/&gt;
One constraint is that all such markers in the same WAL file should be for the same region.&lt;/p&gt;</comment>
                            <comment id="15062972" author="yuzhihong@gmail.com" created="Thu, 17 Dec 2015 22:30:12 +0000"  >&lt;p&gt;This shows what I meant above.&lt;/p&gt;</comment>
                            <comment id="15063404" author="yuzhihong@gmail.com" created="Fri, 18 Dec 2015 04:10:11 +0000"  >&lt;p&gt;Corrected FIXED_OVERHEAD accounting&lt;/p&gt;</comment>
                            <comment id="15065046" author="yuzhihong@gmail.com" created="Sat, 19 Dec 2015 00:27:04 +0000"  >&lt;p&gt;After some internal discussion, came up with patch v1.&lt;/p&gt;

&lt;p&gt;When region names don&apos;t match, skip replaying compaction marker.&lt;/p&gt;</comment>
                            <comment id="15065626" author="yuzhihong@gmail.com" created="Sun, 20 Dec 2015 04:58:54 +0000"  >&lt;p&gt;Patch v2 adds a test.&lt;/p&gt;

&lt;p&gt;Thanks to Stephen for offline discussion&lt;/p&gt;</comment>
                            <comment id="15065841" author="hadoopqa" created="Sun, 20 Dec 2015 17:32:18 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12778727/14987-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12778727/14987-v2.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit e75e26e3c6cfe7fd378081839d60fc711c1e095f.&lt;br/&gt;
  ATTACHMENT ID: 12778727&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;. The applied patch does not generate new checkstyle errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 zombies&lt;/font&gt;. No zombie tests found running at the end of the build.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16944//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16944//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16944//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16944//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16944//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16944//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16944//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16944//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15065964" author="devaraj" created="Mon, 21 Dec 2015 01:15:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;When region names don&apos;t match, skip replaying compaction marker.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What about the other markers? It&apos;ll be good to document what we do with FLUSH etc&lt;/p&gt;</comment>
                            <comment id="15066636" author="yuzhihong@gmail.com" created="Mon, 21 Dec 2015 16:12:57 +0000"  >&lt;p&gt;As result of discussion with Enis on Friday, it is safe to skip compaction marker.&lt;/p&gt;</comment>
                            <comment id="15067032" author="yuzhihong@gmail.com" created="Mon, 21 Dec 2015 20:21:19 +0000"  >&lt;p&gt;Looking closer at the code base, the other 3 markers are in different code path versus compaction marker.&lt;/p&gt;</comment>
                            <comment id="15068488" author="yuzhihong@gmail.com" created="Tue, 22 Dec 2015 18:02:13 +0000"  >&lt;p&gt;Re-attach for QA run.&lt;/p&gt;</comment>
                            <comment id="15068751" author="hadoopqa" created="Tue, 22 Dec 2015 21:24:11 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12779094/14987-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12779094/14987-v2.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 1af98f255132ef6716a1f6ba1d8d71a36ea38840.&lt;br/&gt;
  ATTACHMENT ID: 12779094&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;. The applied patch does not generate new checkstyle errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 zombies&lt;/font&gt;. No zombie tests found running at the end of the build.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16975//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16975//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16975//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16975//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16975//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16975//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16975//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16975//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15068823" author="enis" created="Tue, 22 Dec 2015 22:24:48 +0000"  >&lt;p&gt;Thanks Ted, Stephen on working on this. &lt;/p&gt;

&lt;p&gt;To summarize the issue and some of the discussions so far if you have not been following closely. The root cause of the issue is that if HBCK decides to fix an overlap, it will create a new region and move all the files and folders including the &lt;tt&gt;recovered.edits&lt;/tt&gt; into the new region from the old overlapping regions within the range. Moving the data files is fine, however, when recovered.edits is moved to the new region, replaying of the compaction markers throw WrongRegionException. The other edits are already skipped (in 1.0+) if region names do not match in log split.&lt;/p&gt;

&lt;p&gt;The replay compaction marker is used by recored.edits through regular log split, though distributed log replay or region replica replication for secondary regions (where they replay the compaction from primary).  In the log split case, we want to skip the edits (due to HBCK case), but secondary region replication we still want to throw the exception if regions do not match. &lt;/p&gt;

&lt;p&gt;Now, coming to the patch, instead of this: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+                replayWALCompactionMarker(compaction, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.MAX_VALUE,
+                  !checkRowWithinBoundary);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;can we do this: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (checkRowWithinBoundary) {
+                  replayWALCompactionMarker(compaction, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.MAX_VALUE);
+                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Sending a boolean to replayWALCompactionMarker() which will fail everytime should be avoided. We should simply not call the method if that is the case. &lt;/p&gt;

&lt;p&gt;The new test case uses region replica replication via secondary regions, however, ideally we would like to test the compaction replay through recovered.edits which is not related to secondary replicas. &lt;/p&gt;</comment>
                            <comment id="15068856" author="yuzhihong@gmail.com" created="Tue, 22 Dec 2015 22:42:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;We should simply not call the method if that is the case.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That was what I did in patch v1.&lt;br/&gt;
However, writing unit test for that turned out to be non-trivial due to the fact that replayRecoveredEdits() is private and has other logic.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;ideally we would like to test the compaction replay through recovered.edits&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;TestHRegionReplayEvents has code to manipulate CompactionDescriptor which is amenable for unit test.&lt;br/&gt;
Idea on how compaction marker with mismatching region name can be generated / replayed is welcome.&lt;/p&gt;</comment>
                            <comment id="15068878" author="devaraj" created="Tue, 22 Dec 2015 23:00:32 +0000"  >&lt;p&gt;Good writeup, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;In the log split case, we want to skip the edits (due to HBCK case), but secondary region replication we still want to throw the exception if regions do not match.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;In the region replication case, we&apos;d replay this on a replica (and not the primary region) and so the validation there would be slightly different, right?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Idea on how compaction marker with mismatching region name can be generated / replayed is welcome.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I guess you could write the hand coded edits in the file using the WALEdit classes?&lt;/p&gt;</comment>
                            <comment id="15068882" author="enis" created="Tue, 22 Dec 2015 23:06:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;However, writing unit test for that turned out to be non-trivial due to the fact that replayRecoveredEdits() is private and has other logic.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I see. However, we should not complicate production logic (by changing the function to be boolean return + exception) because it is hard to write a unit test. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I guess you could write the hand coded edits in the file using the WALEdit classes?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Agreed. You can take a look at HRegion.testSkipRecoveredEditsReplay(). &lt;/p&gt;</comment>
                            <comment id="15068943" author="yuzhihong@gmail.com" created="Wed, 23 Dec 2015 00:13:26 +0000"  >&lt;p&gt;Patch v3 is based on patch v1.&lt;/p&gt;

&lt;p&gt;Modified testRecoveredEditsReplayCompaction() to cover the case where compaction marker carries mismatching encoded region name.&lt;/p&gt;</comment>
                            <comment id="15069090" author="hadoopqa" created="Wed, 23 Dec 2015 03:29:54 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12779156/14987-v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12779156/14987-v3.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 1af98f255132ef6716a1f6ba1d8d71a36ea38840.&lt;br/&gt;
  ATTACHMENT ID: 12779156&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;. The applied patch does not generate new checkstyle errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 zombies&lt;/font&gt;. No zombie tests found running at the end of the build.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16984//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16984//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16984//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16984//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16984//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16984//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16984//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16984//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15069209" author="enis" created="Wed, 23 Dec 2015 06:12:32 +0000"  >&lt;p&gt;Thanks Ted, this patch looks more understandable. However, I could not understand the logic from the test case (possibly because I&apos;m still jetlagged). &lt;/p&gt;

&lt;p&gt;if &lt;tt&gt;mismatchedRegionName=true&lt;/tt&gt;, we are writing a compaction marker with a non-matching region name. But we are still expecting a &lt;tt&gt;WrongRegionException&lt;/tt&gt; in region opening? Then the patch does not skip the compaction markers from other regions, and has no affect? &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+        region = HRegion.openHRegion(region, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (mismatchedRegionName) {
+          fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;Mismatched encoded region name should have produced WrongRegionException&quot;&lt;/span&gt;);
+        }
+      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (WrongRegionException wre) {
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!mismatchedRegionName) {
+          fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;Matching encoded region name should not have produced WrongRegionException&quot;&lt;/span&gt;);
+        }
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15070383" author="yuzhihong@gmail.com" created="Thu, 24 Dec 2015 01:43:03 +0000"  >&lt;p&gt;Good catch, Enis.&lt;/p&gt;

&lt;p&gt;Patch v4 addresses your comment.&lt;/p&gt;</comment>
                            <comment id="15070588" author="hadoopqa" created="Thu, 24 Dec 2015 05:00:18 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12779351/14987-v4.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12779351/14987-v4.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 04de427e57d144caf5a9cde3664dac780ed763ab.&lt;br/&gt;
  ATTACHMENT ID: 12779351&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;. The applied patch does not generate new checkstyle errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 zombies&lt;/font&gt;. No zombie tests found running at the end of the build.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17007//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17007//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17007//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17007//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17007//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17007//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17007//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17007//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15074243" author="yuzhihong@gmail.com" created="Tue, 29 Dec 2015 20:31:44 +0000"  >&lt;p&gt;Patch v5 selectively skips replaying compaction marker for primary region.&lt;/p&gt;</comment>
                            <comment id="15074498" author="hadoopqa" created="Wed, 30 Dec 2015 00:47:03 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12779853/14987-v5.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12779853/14987-v5.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 822fead744a308df7ae45da440047207841d7abc.&lt;br/&gt;
  ATTACHMENT ID: 12779853&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;. The applied patch does not generate new checkstyle errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 zombies&lt;/font&gt;. No zombie tests found running at the end of the build.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17063//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17063//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17063//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17063//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17063//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17063//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17063//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17063//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15081116" author="enis" created="Mon, 4 Jan 2016 12:49:42 +0000"  >&lt;p&gt;Thanks Ted for the updated patch. +1. One nit is that we can remove &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!mismatchedRegionName) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;since in both cases, the gets should succeed. Can be addressed at commit. &lt;/p&gt;</comment>
                            <comment id="15081262" author="yuzhihong@gmail.com" created="Mon, 4 Jan 2016 15:21:21 +0000"  >&lt;p&gt;Thanks for the reviews.&lt;/p&gt;</comment>
                            <comment id="15081283" author="hudson" created="Mon, 4 Jan 2016 15:40:22 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2-IT #377 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2-IT/377/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2-IT/377/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14987&quot; title=&quot;Compaction marker whose region name doesn&amp;#39;t match current region&amp;#39;s needs to be handled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14987&quot;&gt;&lt;del&gt;HBASE-14987&lt;/del&gt;&lt;/a&gt; Compaction marker whose region name doesn&apos;t match current (tedyu: rev 76ffd7dbc4b974c0274b7f08e4026ca4b81a1436)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15081434" author="hudson" created="Mon, 4 Jan 2016 17:40:14 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2 #488 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/488/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/488/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14987&quot; title=&quot;Compaction marker whose region name doesn&amp;#39;t match current region&amp;#39;s needs to be handled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14987&quot;&gt;&lt;del&gt;HBASE-14987&lt;/del&gt;&lt;/a&gt; Compaction marker whose region name doesn&apos;t match current (tedyu: rev 76ffd7dbc4b974c0274b7f08e4026ca4b81a1436)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15081544" author="hudson" created="Mon, 4 Jan 2016 18:35:08 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3 #479 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/479/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/479/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14987&quot; title=&quot;Compaction marker whose region name doesn&amp;#39;t match current region&amp;#39;s needs to be handled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14987&quot;&gt;&lt;del&gt;HBASE-14987&lt;/del&gt;&lt;/a&gt; Compaction marker whose region name doesn&apos;t match current (tedyu: rev 2797adf45f1e4de20fb017834f583ae390fdb5a2)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15081568" author="hudson" created="Mon, 4 Jan 2016 18:51:29 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #419 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/419/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/419/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14987&quot; title=&quot;Compaction marker whose region name doesn&amp;#39;t match current region&amp;#39;s needs to be handled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14987&quot;&gt;&lt;del&gt;HBASE-14987&lt;/del&gt;&lt;/a&gt; Compaction marker whose region name doesn&apos;t match current (tedyu: rev 2797adf45f1e4de20fb017834f583ae390fdb5a2)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15081658" author="hudson" created="Mon, 4 Jan 2016 19:42:39 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-Trunk_matrix #608 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/608/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/608/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14987&quot; title=&quot;Compaction marker whose region name doesn&amp;#39;t match current region&amp;#39;s needs to be handled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14987&quot;&gt;&lt;del&gt;HBASE-14987&lt;/del&gt;&lt;/a&gt; Compaction marker whose region name doesn&apos;t match current (tedyu: rev 00656688f73c85ea9e6f5241ac852f72e774eeea)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15085484" author="hudson" created="Wed, 6 Jan 2016 12:21:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #1156 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1156/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1156/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14987&quot; title=&quot;Compaction marker whose region name doesn&amp;#39;t match current region&amp;#39;s needs to be handled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14987&quot;&gt;&lt;del&gt;HBASE-14987&lt;/del&gt;&lt;/a&gt; Compaction marker whose region name doesn&apos;t match current (apurtell: rev 8eed167fc223b6641cfa82aa2e131b5a404c61d3)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15085834" author="hudson" created="Wed, 6 Jan 2016 17:00:29 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98-matrix #282 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-matrix/282/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-matrix/282/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14987&quot; title=&quot;Compaction marker whose region name doesn&amp;#39;t match current region&amp;#39;s needs to be handled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14987&quot;&gt;&lt;del&gt;HBASE-14987&lt;/del&gt;&lt;/a&gt; Compaction marker whose region name doesn&apos;t match current (apurtell: rev 8eed167fc223b6641cfa82aa2e131b5a404c61d3)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12778411" name="14987-suggest.txt" size="2806" author="yuzhihong@gmail.com" created="Fri, 18 Dec 2015 04:10:11 +0000"/>
                            <attachment id="12778637" name="14987-v1.txt" size="3409" author="yuzhihong@gmail.com" created="Sat, 19 Dec 2015 00:27:04 +0000"/>
                            <attachment id="12779094" name="14987-v2.txt" size="15954" author="yuzhihong@gmail.com" created="Tue, 22 Dec 2015 18:02:13 +0000"/>
                            <attachment id="12778727" name="14987-v2.txt" size="15954" author="yuzhihong@gmail.com" created="Sun, 20 Dec 2015 04:58:53 +0000"/>
                            <attachment id="12779156" name="14987-v3.txt" size="8871" author="yuzhihong@gmail.com" created="Wed, 23 Dec 2015 00:13:26 +0000"/>
                            <attachment id="12779351" name="14987-v4.txt" size="9438" author="yuzhihong@gmail.com" created="Thu, 24 Dec 2015 01:43:03 +0000"/>
                            <attachment id="12779853" name="14987-v5.txt" size="9540" author="yuzhihong@gmail.com" created="Tue, 29 Dec 2015 20:31:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 17 Dec 2015 10:24:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            49 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2py6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>