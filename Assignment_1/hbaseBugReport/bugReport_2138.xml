<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:59:16 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2138/HBASE-2138.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2138] unknown metrics type</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2138</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Since the recent metric commits I see this on the master and RS at boot:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2010-01-16 11:24:59,730 INFO org.apache.hadoop.metrics.jvm.JvmMetrics: Initializing JVM Metrics with processName=RegionServer, sessionId=regionserver/10.10.1.49:60020
2010-01-16 11:24:59,732 ERROR org.apache.hadoop.metrics.MetricsUtil: unknown metrics type: org.apache.hadoop.hbase.metrics.MetricsRate
2010-01-16 11:24:59,732 ERROR org.apache.hadoop.hbase.metrics: unknown metrics instance: org.apache.hadoop.metrics.util.MetricsTimeVaryingRate
2010-01-16 11:24:59,732 ERROR org.apache.hadoop.hbase.metrics: unknown metrics instance: org.apache.hadoop.metrics.util.MetricsTimeVaryingRate
2010-01-16 11:24:59,732 ERROR org.apache.hadoop.hbase.metrics: unknown metrics instance: org.apache.hadoop.metrics.util.MetricsTimeVaryingRate
2010-01-16 11:24:59,732 ERROR org.apache.hadoop.hbase.metrics: unknown metrics instance: org.apache.hadoop.metrics.util.MetricsTimeVaryingRate
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We need to clean that for 0.20.3&lt;/p&gt;</description>
                <environment></environment>
        <key id="12445744">HBASE-2138</key>
            <summary>unknown metrics type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Sat, 16 Jan 2010 21:08:07 +0000</created>
                <updated>Fri, 12 Oct 2012 06:14:16 +0000</updated>
                            <resolved>Sun, 17 Jan 2010 00:32:45 +0000</resolved>
                                                    <fixVersion>0.20.3</fixVersion>
                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12801281" author="stack" created="Sat, 16 Jan 2010 22:01:00 +0000"  >&lt;p&gt;I see these in .out files:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.ArithmeticException: / by zero
        at org.apache.hadoop.metrics.util.MetricsTimeVaryingRate.inc(MetricsTimeVaryingRate.java:112)
        at org.apache.hadoop.hbase.regionserver.metrics.RegionServerMetrics.doUpdates(RegionServerMetrics.java:175)
        at org.apache.hadoop.metrics.spi.AbstractMetricsContext.timerEvent(AbstractMetricsContext.java:286)
        at org.apache.hadoop.metrics.spi.AbstractMetricsContext.access$000(AbstractMetricsContext.java:52)
        at org.apache.hadoop.metrics.spi.AbstractMetricsContext$1.run(AbstractMetricsContext.java:251)
        at java.util.TimerThread.mainLoop(Timer.java:555)
        at java.util.TimerThread.run(Timer.java:505)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12801282" author="stack" created="Sat, 16 Jan 2010 22:01:27 +0000"  >&lt;p&gt;They keep repeating.&lt;/p&gt;</comment>
                            <comment id="12801283" author="larsgeorge" created="Sat, 16 Jan 2010 22:10:01 +0000"  >&lt;p&gt;This seems to be caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2068&quot; title=&quot;MetricsRate is missing &amp;quot;registry&amp;quot; parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2068&quot;&gt;&lt;del&gt;HBASE-2068&lt;/del&gt;&lt;/a&gt;. The new MetricsMBeanBase is not handling the Hadoop class and the MetricsDynamicMBeanBase in the Hadoop class is reporting the MetricsRate from the HBase package to be unknown (see createMBeanInfo):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        MetricsUtil.LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;unknown metrics type: &quot;&lt;/span&gt; + o.getClass().getName());
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="12801286" author="larsgeorge" created="Sat, 16 Jan 2010 22:15:43 +0000"  >&lt;p&gt;I also checked and even if these are logged as ERROR they indeed seem to work. I tested to query &quot;requests&quot; from a 0.20.3RC RegionServer and got  a valid &quot;0.0&quot;. &lt;/p&gt;</comment>
                            <comment id="12801287" author="larsgeorge" created="Sat, 16 Jan 2010 22:18:07 +0000"  >&lt;p&gt;The above error you see seems to go deeper. It seems that if inc() is called without any real numOps (on idle cluster?) there is no check for &quot;0&quot; and the division must fail.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; void inc(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; numOps, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; time) {
    currentData.numOperations += numOps;
    currentData.time += time;
    &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; timePerOps = time/numOps;
    minMax.update(timePerOps);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="12801297" author="stack" created="Sat, 16 Jan 2010 23:20:53 +0000"  >&lt;p&gt;Fixes the two issues above.&lt;/p&gt;

&lt;p&gt;1. It doesn&apos;t let hbase Metrics go up to hadoop.  It instead passes hadoop a copy absent the hbase Metrics.&lt;br/&gt;
2. If no writes on hfile or hlog, don&apos;t call increment to avoid the ArithmeticException&lt;/p&gt;
</comment>
                            <comment id="12801300" author="jdcryans" created="Sun, 17 Jan 2010 00:07:16 +0000"  >&lt;p&gt;Tested the patch, it removes all the errors and jmx works well.&lt;/p&gt;

&lt;p&gt;Setting up jmx on my laptop I found that the new documentation has some inconsistencies, will open a new issue.&lt;/p&gt;</comment>
                            <comment id="12801301" author="jdcryans" created="Sun, 17 Jan 2010 00:10:48 +0000"  >&lt;p&gt;Scratch that, it&apos;s just that my html doc is old&lt;/p&gt;</comment>
                            <comment id="12801303" author="jdcryans" created="Sun, 17 Jan 2010 00:32:45 +0000"  >&lt;p&gt;Committed to branch and trunk. I also committed the updated doc for JMX (this should have been done earlier). I can&apos;t do that for trunk because there&apos;s a missing file (cygwin.xml it seems).&lt;/p&gt;</comment>
                            <comment id="12801397" author="larsgeorge" created="Sun, 17 Jan 2010 13:29:54 +0000"  >&lt;p&gt;Just a +1 after the fact. Updated my 0.20.3RC cluster with patch and tested. Logs are clean now and JMX attributes still work. Thanks!&lt;/p&gt;</comment>
                            <comment id="12801486" author="stack" created="Sun, 17 Jan 2010 19:44:29 +0000"  >&lt;p&gt;@Lars Thanks for testing jmx still works.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12430525" name="2138.patch" size="4296" author="stack" created="Sat, 16 Jan 2010 23:20:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 16 Jan 2010 22:01:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26169</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08t5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49324</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>