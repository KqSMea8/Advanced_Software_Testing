<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:15:42 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4074/HBASE-4074.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4074] When a RS has hostname with uppercase letter, there are two RS entries in master</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4074</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When a RS has uppercase letter in its hostname, e.g. Harpertown08-15.sh.intel.com. Then, there will be two RS entries in master report, they are&lt;br/&gt;
 harpertown08-15.sh.intel.com&lt;br/&gt;
 Harpertown08-15.sh.intel.com&lt;/p&gt;

&lt;p&gt;This leads to wrong region allocation.&lt;/p&gt;

&lt;p&gt;This problem is caused by the implementation of java.net.InetSocketAddress.&lt;/p&gt;

&lt;p&gt;The logic is:&lt;br/&gt;
1. RS Harpertown08-15.sh.intel.com sends its DNS resolved hostname harpertown08-15.sh.intel.com to master for registration in HRegionServer.reportForDuty().&lt;br/&gt;
2. Master handles it and returns harpertown08-15.sh.intel.com via HServerAddress object to RS to notify it this new name (actually the same as the one reported by RS).&lt;br/&gt;
3. HServerAddress deserialize this object by first read out hostname as string (&quot;harpertown08-15.sh.intel.com&quot;) and construct a InetSocketAddress object.&lt;br/&gt;
4. RS get the new name by call this InetSocketAddress.getHostName() method which returns Harpertown08-15.sh.intel.com instead.&lt;br/&gt;
5. In latter hearbeat communication (HRegionServer.tryRegionServerReport()), RS uses this new name (Harpertown08-15.sh.intel.com) to report to master and master regard it as a new RS. Thus, two RS entries exist. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12513093">HBASE-4074</key>
            <summary>When a RS has hostname with uppercase letter, there are two RS entries in master</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="whjiang">Weihua Jiang</assignee>
                                    <reporter username="whjiang">Weihua Jiang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Jul 2011 07:46:32 +0000</created>
                <updated>Fri, 20 Nov 2015 11:55:12 +0000</updated>
                            <resolved>Thu, 7 Jul 2011 16:52:39 +0000</resolved>
                                    <version>0.90.1</version>
                    <version>0.90.2</version>
                    <version>0.90.3</version>
                                    <fixVersion>0.90.4</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13061111" author="whjiang" created="Thu, 7 Jul 2011 07:53:53 +0000"  >&lt;p&gt;A patch based on 0.90.3. &lt;/p&gt;

&lt;p&gt;The basic idea is to use DNS-resolved hostname. &lt;/p&gt;

&lt;p&gt;It fixed the problem in our environment.&lt;/p&gt;</comment>
                            <comment id="13061208" author="yuzhihong@gmail.com" created="Thu, 7 Jul 2011 11:15:05 +0000"  >&lt;p&gt;@Weihua:&lt;br/&gt;
The patch doesn&apos;t apply to TRUNK.&lt;br/&gt;
Can you provide patch for TRUNK ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13061394" author="apurtell" created="Thu, 7 Jul 2011 15:44:52 +0000"  >&lt;p&gt;We fixed this issue privately in our security branch during a period of firefighting. Apologies for not getting it upstream. Another option is to simply always lowercase the hostname in the master just prior to using it to determine RS identity.&lt;/p&gt;</comment>
                            <comment id="13061419" author="yuzhihong@gmail.com" created="Thu, 7 Jul 2011 16:31:56 +0000"  >&lt;p&gt;Patch for trunk.&lt;/p&gt;</comment>
                            <comment id="13061436" author="yuzhihong@gmail.com" created="Thu, 7 Jul 2011 16:47:54 +0000"  >&lt;p&gt;Integrated to branch and TRUNK.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Weihua.&lt;/p&gt;</comment>
                            <comment id="13061537" author="stack" created="Thu, 7 Jul 2011 19:48:49 +0000"  >&lt;p&gt;I committed this as part of this issue:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: src/main/java/org/apache/hadoop/hbase/ServerName.java
===================================================================
--- src/main/java/org/apache/hadoop/hbase/ServerName.java       (revision 1143654)
+++ src/main/java/org/apache/hadoop/hbase/ServerName.java       (working copy)
@@ -184,7 +184,8 @@
 
   @Override
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compareTo(ServerName other) {
-    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compare = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getHostname().compareTo(other.getHostname());
+    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; compare = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getHostname().toLowerCase().
+      compareTo(other.getHostname().toLowerCase());
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (compare != 0) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; compare;
     compare = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getPort() - other.getPort();
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (compare != 0) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; compare;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This should do for TRUNK what the branch patch does (It changes HSA but HSA is not really used in TRUNK.  ServerName is used instead).&lt;/p&gt;</comment>
                            <comment id="13061544" author="hudson" created="Thu, 7 Jul 2011 19:58:54 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2010 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2010/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2010/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4074&quot; title=&quot;When a RS has hostname with uppercase letter, there are two RS entries in master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4074&quot;&gt;&lt;del&gt;HBASE-4074&lt;/del&gt;&lt;/a&gt;  When a RS has hostname with uppercase letter, there are two&lt;br/&gt;
               RS entries in master&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/HServerAddress.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13061667" author="hudson" created="Thu, 7 Jul 2011 23:27:58 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2011 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2011/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2011/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4074&quot; title=&quot;When a RS has hostname with uppercase letter, there are two RS entries in master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4074&quot;&gt;&lt;del&gt;HBASE-4074&lt;/del&gt;&lt;/a&gt; When a RS has hostname with uppercase letter, there are two RS entries in master &amp;#8211; addendum&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/ServerName.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15016423" author="lars_francke" created="Fri, 20 Nov 2015 11:55:12 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12485542" name="4074.patch" size="2813" author="whjiang" created="Thu, 7 Jul 2011 07:53:53 +0000"/>
                            <attachment id="12485619" name="4074.trunk" size="2542" author="yuzhihong@gmail.com" created="Thu, 7 Jul 2011 16:31:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 7 Jul 2011 11:15:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27157</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hp8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101352</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>