<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:45:10 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7374/HBASE-7374.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7374] Expose master table operations for coprocessors by way of MasterServices</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7374</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I have something I&apos;m working on that, as a coprocessor, when it initializes would like to add a column to a table should that column be missing. Exposing master table operations for coprocessors by way of MasterServices was how I solved this problem, and is generally useful for all master coprocessors.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12624386">HBASE-7374</key>
            <summary>Expose master table operations for coprocessors by way of MasterServices</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Dec 2012 01:07:11 +0000</created>
                <updated>Tue, 26 Feb 2013 08:22:58 +0000</updated>
                            <resolved>Wed, 19 Dec 2012 18:45:01 +0000</resolved>
                                    <version>0.94.4</version>
                    <version>0.95.2</version>
                                    <fixVersion>0.94.4</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                    <component>Coprocessors</component>
                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13534502" author="yuzhihong@gmail.com" created="Tue, 18 Dec 2012 01:19:35 +0000"  >&lt;p&gt;Patch makes sense.&lt;br/&gt;
+1&lt;/p&gt;</comment>
                            <comment id="13534504" author="apurtell" created="Tue, 18 Dec 2012 01:20:50 +0000"  >&lt;p&gt;Thanks for the timely look &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ted_yu&quot; class=&quot;user-hover&quot; rel=&quot;ted_yu&quot;&gt;Ted Yu&lt;/a&gt;. I&apos;ll commit tomorrow if there is no additional comment.&lt;/p&gt;</comment>
                            <comment id="13534511" author="apurtell" created="Tue, 18 Dec 2012 01:31:28 +0000"  >&lt;p&gt;Patch for consideration for 0.94. Simpler here, because the refactoring in trunk I had to undo hasn&apos;t been done yet.&lt;/p&gt;</comment>
                            <comment id="13534544" author="hadoopqa" created="Tue, 18 Dec 2012 02:18:28 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561390/HBASE-7374-0.94.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561390/HBASE-7374-0.94.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3577//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3577//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13534591" author="enis" created="Tue, 18 Dec 2012 03:26:07 +0000"  >&lt;p&gt;Over at &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7305&quot; title=&quot;ZK based Read/Write locks for table operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7305&quot;&gt;&lt;del&gt;HBASE-7305&lt;/del&gt;&lt;/a&gt;, I am forward porting / adding table locking to operations from master, and the semantics defined there has to be exposed to the coprocessors as well. The patch I am working on has a sequence like:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;start rpc&lt;/li&gt;
	&lt;li&gt;obtain table lock (on timeout throw TimeoutException)&lt;/li&gt;
	&lt;li&gt;run preXXX coprocessors&lt;/li&gt;
	&lt;li&gt;create XXXhandler object, schedule for execution&lt;/li&gt;
	&lt;li&gt;run postXXX coprocessors&lt;/li&gt;
	&lt;li&gt;end rpc&lt;br/&gt;
and in XXXHandler.process():&lt;/li&gt;
	&lt;li&gt;run preXXXHandler coprocessors&lt;/li&gt;
	&lt;li&gt;do the modification&lt;/li&gt;
	&lt;li&gt;run postXXXHandler coprocessors&lt;/li&gt;
	&lt;li&gt;release table lock (we should ensure that this does not happen before postXXX coprocessors)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If we do the above sequence, we guarantee that the table lock is held during all executions of the coprocessor for that table, however, all the other operations for other tables has to obtain the lock. This might cause deadlocks, but as long as we document it, it should be fine. &lt;/p&gt;</comment>
                            <comment id="13534595" author="apurtell" created="Tue, 18 Dec 2012 03:32:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; Thanks for the heads up on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7305&quot; title=&quot;ZK based Read/Write locks for table operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7305&quot;&gt;&lt;del&gt;HBASE-7305&lt;/del&gt;&lt;/a&gt;. You&apos;re right, the ops executed via MasterServices would operate under a table lock taken before a preXXX or postXXX upcall into the master CP. Hmm.&lt;/p&gt;</comment>
                            <comment id="13534967" author="apurtell" created="Tue, 18 Dec 2012 15:27:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; I&apos;m going to commit this as is. I think we should handle the &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7305&quot; title=&quot;ZK based Read/Write locks for table operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7305&quot;&gt;&lt;del&gt;HBASE-7305&lt;/del&gt;&lt;/a&gt; issues on 7305 by adding javadoc to the master preXXX and postXXX interface definitions, then by exposing the table lock API via MasterServices with a fat warning about the locking discipline.&lt;/p&gt;</comment>
                            <comment id="13535162" author="apurtell" created="Tue, 18 Dec 2012 19:01:23 +0000"  >&lt;p&gt;Committed to trunk. Master and coprocessor tests pass for me locally.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;: Any concerns about the 0.94 patch? If not will commit there too.&lt;/p&gt;</comment>
                            <comment id="13535233" author="hudson" created="Tue, 18 Dec 2012 19:52:06 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3633 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3633/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3633/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7374&quot; title=&quot;Expose master table operations for coprocessors by way of MasterServices&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7374&quot;&gt;&lt;del&gt;HBASE-7374&lt;/del&gt;&lt;/a&gt;. Expose table operations for coprocessors by way of MasterServices (Revision 1423578)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterServices.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13535489" author="hudson" created="Wed, 19 Dec 2012 00:07:06 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #302 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/302/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/302/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7374&quot; title=&quot;Expose master table operations for coprocessors by way of MasterServices&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7374&quot;&gt;&lt;del&gt;HBASE-7374&lt;/del&gt;&lt;/a&gt;. Expose table operations for coprocessors by way of MasterServices (Revision 1423578)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterServices.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13535563" author="lhofhansl" created="Wed, 19 Dec 2012 02:18:22 +0000"  >&lt;p&gt;+1 on 0.94.&lt;/p&gt;</comment>
                            <comment id="13536283" author="apurtell" created="Wed, 19 Dec 2012 18:45:01 +0000"  >&lt;p&gt;Committed to 0.94. Thanks.&lt;/p&gt;</comment>
                            <comment id="13536295" author="enis" created="Wed, 19 Dec 2012 18:54:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;Enis Soztutar I&apos;m going to commit this as is. I think we should handle the &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7305&quot; title=&quot;ZK based Read/Write locks for table operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7305&quot;&gt;&lt;del&gt;HBASE-7305&lt;/del&gt;&lt;/a&gt; issues on 7305 by adding javadoc to the master preXXX and postXXX interface definitions, then by exposing the table lock API via MasterServices with a fat warning about the locking discipline.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Agreed. Thanks Andrew. &lt;/p&gt;</comment>
                            <comment id="13536587" author="hudson" created="Wed, 19 Dec 2012 23:36:21 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #646 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/646/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/646/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7374&quot; title=&quot;Expose master table operations for coprocessors by way of MasterServices&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7374&quot;&gt;&lt;del&gt;HBASE-7374&lt;/del&gt;&lt;/a&gt;. Expose table operations for coprocessors by way of MasterServices (Revision 1424017)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterServices.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13537931" author="hudson" created="Fri, 21 Dec 2012 14:17:13 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #87 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/87/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/87/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7374&quot; title=&quot;Expose master table operations for coprocessors by way of MasterServices&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7374&quot;&gt;&lt;del&gt;HBASE-7374&lt;/del&gt;&lt;/a&gt;. Expose table operations for coprocessors by way of MasterServices (Revision 1424017)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterServices.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13544474" author="hudson" created="Sat, 5 Jan 2013 00:42:42 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #10 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/10/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/10/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7374&quot; title=&quot;Expose master table operations for coprocessors by way of MasterServices&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7374&quot;&gt;&lt;del&gt;HBASE-7374&lt;/del&gt;&lt;/a&gt;. Expose table operations for coprocessors by way of MasterServices (Revision 1424017)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterServices.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestCatalogJanitor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12622994">HBASE-7305</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12561390" name="HBASE-7374-0.94.patch" size="4561" author="apurtell" created="Tue, 18 Dec 2012 01:31:28 +0000"/>
                            <attachment id="12561386" name="HBASE-7374.patch" size="13026" author="apurtell" created="Tue, 18 Dec 2012 01:09:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Dec 2012 01:19:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>299225</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i160db:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243192</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>