<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:21:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11294/HBASE-11294.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11294] IntegrationTestIngestWithACL should automatically set the superuser when running on local minicluster</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11294</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;To reproduce:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ mvn -DskipTests clean install
$ cd hbase-it
$ mvn verify -Dit.test=IntegrationTestIngestWithACL 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This should execute successfully according to &lt;a href=&quot;http://hbase.apache.org/book/hbase.tests.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/book/hbase.tests.html&lt;/a&gt; section 16.7.5.1.&lt;/p&gt;

&lt;p&gt;Instead no tables can deploy because the superuser is not automatically set to the running user, as what used to happen once upon a time:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2014-06-03 20:15:10,067 WARN  [htable-pool12-t1] client.AsyncProcess(675): #7, table=hbase:meta, attempt=1/350 failed 1 ops, last exception: org.apache.hadoop.hbase.security.AccessDeniedException: org.apache.hadoop.hbase.security.AccessDeniedException: Insufficient permissions (user=apurtell, scope=hbase:meta, family=info:regioninfo, action=WRITE)
	at org.apache.hadoop.hbase.security.access.AccessController.prePut(AccessController.java:1447)
	at org.apache.hadoop.hbase.regionserver.RegionCoprocessorHost.prePut(RegionCoprocessorHost.java:1122)
	at org.apache.hadoop.hbase.regionserver.HRegion.doPreMutationHook(HRegion.java:2269)
	at org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2244)
	at org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2200)
	at org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2204)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.doBatchOp(HRegionServer.java:4263)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.doNonAtomicRegionMutation(HRegionServer.java:3479)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.multi(HRegionServer.java:3369)
	at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:29503)
	at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2012)
	at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:98)
	at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler.consumerLoop(SimpleRpcScheduler.java:168)
	at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler.access$000(SimpleRpcScheduler.java:39)
	at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler$1.run(SimpleRpcScheduler.java:111)
	at java.lang.Thread.run(Thread.java:745)
 on localhost,59092,1401826507071, tracking started Tue Jun 03 20:15:10 UTC 2014 - FAILED, NOT RETRYING ANYMORE
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12718245">HBASE-11294</key>
            <summary>IntegrationTestIngestWithACL should automatically set the superuser when running on local minicluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ram_krish">ramkrishna.s.vasudevan</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 Jun 2014 20:15:48 +0000</created>
                <updated>Fri, 20 Nov 2015 11:52:51 +0000</updated>
                            <resolved>Thu, 3 Jul 2014 05:26:47 +0000</resolved>
                                    <version>0.98.3</version>
                                    <fixVersion>0.98.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14017343" author="ram_krish" created="Wed, 4 Jun 2014 03:44:56 +0000"  >&lt;p&gt;Will give a patch for this once 0.98.3 is released.&lt;/p&gt;</comment>
                            <comment id="14046724" author="ram_krish" created="Sat, 28 Jun 2014 04:50:56 +0000"  >&lt;p&gt;I will give a patch for this. &lt;/p&gt;</comment>
                            <comment id="14046833" author="ram_krish" created="Sat, 28 Jun 2014 12:09:35 +0000"  >&lt;p&gt;Patch that ensures the read and WRITE permissions are set even when run with non kerberos mode.&lt;br/&gt;
For running in trunk ensure early_out_termination = false.&lt;/p&gt;</comment>
                            <comment id="14048296" author="apurtell" created="Mon, 30 Jun 2014 23:24:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;For running in trunk ensure early_out_termination = false.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t see this in the patch? &lt;/p&gt;

&lt;p&gt;Test still fails to set up superuser automatically when running on local minicluster. To reproduce:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ git checkout 0.98
$ mvn -DskipTests clean install
$ cd hbase-it
$ mvn verify -Dit.test=IntegrationTestIngestWithACL 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I ran also with -Dtest.output.tofile=false to capture the reason for test failure. My user &apos;apurtell&apos; is not set up as a superuser so the hbase daemon itself cannot write to meta. &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2014-06-30 16:21:57,902 WARN  [htable-pool12-t1] client.AsyncProcess(680): #7, table=hbase:meta, attempt=1/350 failed 1 ops, last exception: org.apache.hadoop.hbase.security.AccessDeniedException: org.apache.hadoop.hbase.security.AccessDeniedException: Insufficient permissions (user=apurtell, scope=hbase:meta, family=info:regioninfo, action=WRITE)
	at org.apache.hadoop.hbase.security.access.AccessController.preBatchMutate(AccessController.java:1552)
	at org.apache.hadoop.hbase.regionserver.RegionCoprocessorHost.preBatchMutate(RegionCoprocessorHost.java:1282)
	at org.apache.hadoop.hbase.regionserver.HRegion.doMiniBatchMutation(HRegion.java:2472)
	at org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2259)
	at org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2211)
	at org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2215)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.doBatchOp(HRegionServer.java:4266)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.doNonAtomicRegionMutation(HRegionServer.java:3473)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.multi(HRegionServer.java:3363)
	at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:29503)
	at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2012)
	at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:98)
	at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler.consumerLoop(SimpleRpcScheduler.java:168)
	at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler.access$000(SimpleRpcScheduler.java:39)
	at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler$1.run(SimpleRpcScheduler.java:111)
	at java.lang.Thread.run(Thread.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14048519" author="ram_krish" created="Tue, 1 Jul 2014 05:08:01 +0000"  >&lt;p&gt;Trying out in trunk it works fine.  In 0.98 this issue happens. checking this.&lt;/p&gt;</comment>
                            <comment id="14048719" author="ram_krish" created="Tue, 1 Jul 2014 10:03:13 +0000"  >&lt;p&gt;This is good to go for 0.98.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;&lt;br/&gt;
Can you check this once.  If fine we can commit this to 0.98.4&lt;/p&gt;</comment>
                            <comment id="14048733" author="hadoopqa" created="Tue, 1 Jul 2014 10:31:06 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12653364/HBASE-11294_2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12653364/HBASE-11294_2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12653364&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9919//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9919//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14048744" author="ram_krish" created="Tue, 1 Jul 2014 10:45:12 +0000"  >&lt;p&gt;This is a 0.98 patch.&lt;/p&gt;</comment>
                            <comment id="14049650" author="ram_krish" created="Wed, 2 Jul 2014 05:51:49 +0000"  >&lt;p&gt;Andy if this works for you we can commit this to 0.98.4 itself.&lt;/p&gt;</comment>
                            <comment id="14050917" author="apurtell" created="Thu, 3 Jul 2014 00:34:29 +0000"  >&lt;p&gt;Patch looks good and works for me locally. &lt;/p&gt;

&lt;p&gt;Trace level is ok, but is this useful?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedReaderWithACL.java b/hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedReaderWithACL.java
index 068f120..044fee6 100644
--- a/hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedReaderWithACL.java
+++ b/hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedReaderWithACL.java
@@ -107,7 +107,9 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class MultiThreadedReaderWithACL &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; MultiThreadedReader {
               result = localTable.get(get);
             }
             &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isNullExpected = ((((&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) keyToRead % specialPermCellInsertionFactor)) == 0);
-            LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Read happening from ACL &quot;&lt;/span&gt; + isNullExpected);
+            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isNullExpected) {
+              LOG.trace(&lt;span class=&quot;code-quote&quot;&gt;&quot;Read happening from ACL &quot;&lt;/span&gt; + isNullExpected);
+            }
             getResultMetricUpdation(verify, rowKey, start, result, localTable, isNullExpected);
           } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
             recordFailure(keyToRead);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should also remove that INFO level logging in the same place in the master branch.&lt;/p&gt;</comment>
                            <comment id="14051075" author="ram_krish" created="Thu, 3 Jul 2014 05:18:06 +0000"  >&lt;p&gt;Will commit this to 0.98. The log is removed.&lt;/p&gt;</comment>
                            <comment id="14051078" author="ram_krish" created="Thu, 3 Jul 2014 05:26:47 +0000"  >&lt;p&gt;Committed to 0.98.  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11449&quot; title=&quot;IntegrationTestIngestWithACL fails to use different users after HBASE-10810&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11449&quot;&gt;&lt;del&gt;HBASE-11449&lt;/del&gt;&lt;/a&gt; will be the JIRA to commit to trunk and branch-1 as there are more changes to be done after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10810&quot; title=&quot;LoadTestTool should share the connection and connection pool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10810&quot;&gt;&lt;del&gt;HBASE-10810&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14051158" author="hudson" created="Thu, 3 Jul 2014 08:03:33 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #372 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/372/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/372/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11294&quot; title=&quot;IntegrationTestIngestWithACL should automatically set the superuser when running on local minicluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11294&quot;&gt;&lt;del&gt;HBASE-11294&lt;/del&gt;&lt;/a&gt; IntegrationTestIngestWithACL should automatically set the (ramkrishna: rev 5bd3ad3dd14d8d134ebddaf9907d70de0f5de1b5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedReaderWithACL.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/LoadTestTool.java&lt;/li&gt;
	&lt;li&gt;hbase-it/src/test/java/org/apache/hadoop/hbase/IntegrationTestIngestWithACL.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14051239" author="hudson" created="Thu, 3 Jul 2014 09:27:02 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98-on-Hadoop-1.1 #352 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/352/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/352/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11294&quot; title=&quot;IntegrationTestIngestWithACL should automatically set the superuser when running on local minicluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11294&quot;&gt;&lt;del&gt;HBASE-11294&lt;/del&gt;&lt;/a&gt; IntegrationTestIngestWithACL should automatically set the (ramkrishna: rev 5bd3ad3dd14d8d134ebddaf9907d70de0f5de1b5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/LoadTestTool.java&lt;/li&gt;
	&lt;li&gt;hbase-it/src/test/java/org/apache/hadoop/hbase/IntegrationTestIngestWithACL.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/MultiThreadedReaderWithACL.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15015844" author="lars_francke" created="Fri, 20 Nov 2015 11:52:51 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12724684">HBASE-11449</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12653005" name="HBASE-11294_1.patch" size="3695" author="ram_krish" created="Sat, 28 Jun 2014 12:09:35 +0000"/>
                            <attachment id="12653364" name="HBASE-11294_2.patch" size="4795" author="ram_krish" created="Tue, 1 Jul 2014 10:03:13 +0000"/>
                            <attachment id="12653763" name="HBASE-11294_3.patch" size="4390" author="ram_krish" created="Thu, 3 Jul 2014 05:18:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 4 Jun 2014 03:44:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396447</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1w967:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396569</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>