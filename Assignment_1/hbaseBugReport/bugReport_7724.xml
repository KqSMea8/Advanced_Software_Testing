<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:48:28 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7724/HBASE-7724.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7724] [0.94] Just OPENED regions are ignored by ServerShutdownHandler and go unassigned for ever</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7724</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Visiting a user today, I came across following interesting case (0.94.2 HBase).&lt;/p&gt;

&lt;p&gt;A server was added to cluster.  It was assigned regions by the balancer.  A bunch opened on the regionserver and just after the open, the regionserver was manually shutdown.  There was a lag processing the zk region open events in the master (because clean shutdown, there was no zk activity when the regions were closed on the shutdown regionserver).  Processing the server shutdown, we do this for a good few of the regions that had just been opened on the regionserver:&lt;/p&gt;

&lt;p&gt;2013-01-30 02:41:19,917 INFO org.apache.hadoop.hbase.master.handler.ServerShutdownHandler: Skip assigning region OBFUSCATED_TABLE,OBFUSCATED_STARTROW,1344723216908.55e9cb551edeea0b52bb91af7c2de199. state=OPEN, ts=1359513674715, server=XX.XX.18.40,10304,1359513445136&lt;/p&gt;

&lt;p&gt;Seems like outright bug that&apos;d we&apos;d skip a region that is in transition that is in the OPEN state.&lt;/p&gt;

&lt;p&gt;More detail to follow.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12630048">HBASE-7724</key>
            <summary>[0.94] Just OPENED regions are ignored by ServerShutdownHandler and go unassigned for ever</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Thu, 31 Jan 2013 00:38:26 +0000</created>
                <updated>Sat, 10 Jan 2015 01:38:32 +0000</updated>
                            <resolved>Sat, 10 Jan 2015 01:38:32 +0000</resolved>
                                                                    <component>Region Assignment</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13567173" author="stack" created="Thu, 31 Jan 2013 00:44:29 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-01-30 02:37:25,997 DEBUG org.apache.hadoop.hbase.master.ServerManager: STARTUP: Server XX.XX.18.40,10304,1359513445136 came back up, removed it from the dead servers list
2013-01-30 02:40:46,573 INFO org.apache.hadoop.hbase.master.HMaster: balance hri=OBFUSCATED_TABLE,OBFUSCATED_STARTKEY,1344723216908.55e9cb551edeea0b52bb91af7c2de199., src=sv4r20s16,10304,1357578057026, dest=XX.XX.18.40,10304,1359513445136
...
2013-01-30 02:41:04,995 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=RS_ZK_REGION_OPENED, server=XX.XX.18.40,10304,1359513445136, region=55e9cb551edeea0b52bb91af7c2de199
2013-01-30 02:41:04,995 DEBUG org.apache.hadoop.hbase.master.handler.OpenedRegionHandler: Handling OPENED event &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; OBFUSCATED_TABLE,OBFUSCATED_STARTKEY,1344723216908.55e9cb551edeea0b52bb91af7c2de199. from XX.XX.18.40,10304,1359513445136; deleting unassigned node
2013-01-30 02:41:05,046 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:10302-0xd3b032ca78e76dc Retrieved 112 &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;(s) of data from znode /prodjobs/unassigned/55e9cb551edeea0b52bb91af7c2de199; data=region=OBFUSCATED_TABLE,\x09\xC9\xA1\xB2 u\xF1\x82yfd\xCC&quot;\xBCG},1344723216908.55e9cb551edeea0b52bb91af7c2de199., origin=XX.XX.18.40,10304,1359513445136, state=RS_ZK_REGION_OPENED
..
2013-01-30 02:41:19,917 INFO org.apache.hadoop.hbase.master.handler.ServerShutdownHandler: Skip assigning region OBFUSCATED_TABLE,OBFUSCATED_STARTKEY,1344723216908.55e9cb551edeea0b52bb91af7c2de199. state=OPEN, ts=1359513674715, server=XX.XX.18.40,10304,1359513445136
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is what is on the regionserver&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-01-30 02:40:54,429 DEBUG org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler: Opened OBFUSCATED_TABLE,OBFUSCATED_STARTKEY,1344723216908.55e9cb551edeea0b52bb91af7c2de199. on server:XX.XX.18.40,10304,1359513445136
Wed Jan 30 02:41:00 UTC 2013 Terminating regionserver
2013-01-30 02:41:01,016 DEBUG org.apache.hadoop.hbase.regionserver.handler.CloseRegionHandler: Closed region OBFUSCATED_TABLE,OBFUSCATED_STARTKEY,1344723216908.55e9cb551edeea0b52bb91af7c2de199.


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13567187" author="lhofhansl" created="Thu, 31 Jan 2013 00:55:19 +0000"  >&lt;p&gt;Is that related to (or the same as) &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7521&quot; title=&quot;fix HBASE-6060 (regions stuck in opening state) in 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7521&quot;&gt;&lt;del&gt;HBASE-7521&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13567365" author="ram_krish" created="Thu, 31 Jan 2013 04:58:41 +0000"  >&lt;p&gt;Yes Lars.  You are right i think.&lt;br/&gt;
Any thing in transition on the RS that is going down was not handled.  Means in the RIT map if the target RS goes down SSH will not handle.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7521&quot; title=&quot;fix HBASE-6060 (regions stuck in opening state) in 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7521&quot;&gt;&lt;del&gt;HBASE-7521&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6060&quot; title=&quot;Regions&amp;#39;s in OPENING state from failed regionservers takes a long time to recover&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6060&quot;&gt;&lt;del&gt;HBASE-6060&lt;/del&gt;&lt;/a&gt;) should do that.  So it is important that we take it in.&lt;br/&gt;
@Stack&lt;br/&gt;
What do you think?&lt;/p&gt;</comment>
                            <comment id="13568337" author="stack" created="Fri, 1 Feb 2013 01:18:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt; let me review hbase-7521 (though going by Enis&apos;s testing, it looks like the patch has issues)...Thanks for taking a look.&lt;/p&gt;</comment>
                            <comment id="14269094" author="clehene" created="Thu, 8 Jan 2015 09:45:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; still valid? Would it be worth to set versions if so?&lt;/p&gt;</comment>
                            <comment id="14272219" author="lhofhansl" created="Sat, 10 Jan 2015 01:37:58 +0000"  >&lt;p&gt;Seems we can close as dup of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6060&quot; title=&quot;Regions&amp;#39;s in OPENING state from failed regionservers takes a long time to recover&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6060&quot;&gt;&lt;del&gt;HBASE-6060&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12556729">HBASE-6060</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 31 Jan 2013 00:55:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>310544</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 48 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1hldr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>310889</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>