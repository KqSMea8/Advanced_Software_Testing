<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:22:42 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4862/HBASE-4862.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4862] Splitting hlog and opening region concurrently may cause data loss</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4862</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Case Description:&lt;br/&gt;
1.Split hlog thread creat writer for the file region A/recoverd.edits/123456 and is appending log entry&lt;br/&gt;
2.Regionserver is opening region A now, and in the process replayRecoveredEditsIfAny() ,it will delete the file region A/recoverd.edits/123456 &lt;br/&gt;
3.Split hlog thread catches the io exception, and stop parse this log file &lt;br/&gt;
and if skipError = true , add it to the corrupt logs....However, data in other regions in this log file will loss &lt;br/&gt;
4.Or if skipError = false, it will check filesystem.Of course, the file system is ok , and it only prints a error log, continue assigning regions. Therefore, data in other log files will also loss!!&lt;/p&gt;

&lt;p&gt;The case may happen in the following:&lt;br/&gt;
1.Move region from server A to server B&lt;br/&gt;
2.kill server A and Server B&lt;br/&gt;
3.restart server A and Server B&lt;/p&gt;

&lt;p&gt;We could prevent this exception throuth forbiding deleting  recover.edits file &lt;br/&gt;
which is appending by split hlog thread&lt;/p&gt;</description>
                <environment></environment>
        <key id="12532582">HBASE-4862</key>
            <summary>Splitting hlog and opening region concurrently may cause data loss</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zjushch">chunhui shen</assignee>
                                    <reporter username="zjushch">chunhui shen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Nov 2011 06:46:09 +0000</created>
                <updated>Fri, 20 Nov 2015 11:53:43 +0000</updated>
                            <resolved>Mon, 28 Nov 2011 22:00:39 +0000</resolved>
                                    <version>0.90.2</version>
                                    <fixVersion>0.90.5</fixVersion>
                    <fixVersion>0.92.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13156571" author="zjushch" created="Thu, 24 Nov 2011 07:00:51 +0000"  >&lt;p&gt;Split hlog :Add suffix &quot;.tmp&quot; for file in the recoverd.edits directory when creating,&lt;br/&gt;
and rename it without the suffix after close;&lt;/p&gt;

&lt;p&gt;ReplayRecoveredEditsIfAny: skip the file whose name ends with .tmp&lt;/p&gt;</comment>
                            <comment id="13156765" author="yuzhihong@gmail.com" created="Thu, 24 Nov 2011 15:37:29 +0000"  >&lt;p&gt;Nice work.&lt;br/&gt;
The patch doesn&apos;t apply to 0.90 branch:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Hunk #4 succeeded at 783 (offset -332 lines).
1 out of 4 hunks FAILED -- saving rejects to file src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java.rej
...
patch unexpectedly ends in middle of line
2 out of 2 hunks ignored -- saving rejects to file src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java.rej
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please rebase your patch for 0.90&lt;/p&gt;

&lt;p&gt;A separate patch for TRUNK would be helpful for HadoopQA to run test suite.&lt;/p&gt;

&lt;p&gt;Comments about the changes:&lt;br/&gt;
getTmpRecoveredEditsFileName() is only used once and there is no javadoc for it. Maybe we don&apos;t need to create the method, just append &quot;.tmp&quot; directly to the filename.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-comment&quot;&gt;// Convert file name ends with .tmp, so ensure region&apos;s replayRecoveredEdits&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The beginning of the above should read &apos;Append filename with &apos;.tmp&apos; to ensure&apos;&lt;/p&gt;</comment>
                            <comment id="13156858" author="tlipcon" created="Thu, 24 Nov 2011 18:29:00 +0000"  >&lt;p&gt;wait, wait &amp;#8211; &lt;em&gt;why&lt;/em&gt; is this happening concurrently? A region should never be opened until the split process is done for that region. If this is happening we have a much larger issue, which we shouldn&apos;t be working around with tmp file names, etc.&lt;/p&gt;</comment>
                            <comment id="13156866" author="yuzhihong@gmail.com" created="Thu, 24 Nov 2011 18:47:24 +0000"  >&lt;p&gt;@Chunhui:&lt;br/&gt;
Can you attach master and region server log snippets which would show us what happened ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13156965" author="zjushch" created="Fri, 25 Nov 2011 02:38:37 +0000"  >&lt;p&gt;@Ted Yu @Todd Lipcon&lt;/p&gt;

&lt;p&gt;It will happen concurrently in the following case:&lt;br/&gt;
1.Move region from server A to server B (for example,do balance)&lt;br/&gt;
2.kill server A and Server B&lt;br/&gt;
3.restart server A and Server B immediately&lt;/p&gt;

&lt;p&gt;Before we restart server A and Server B, log data about this region appear in the both server&apos;s log file,&lt;br/&gt;
4.After we restart server B, serverShutdownHandler process this dead server , and assign this region,&lt;br/&gt;
5.At the same time, serverShutdownHandler would process dead server B, and split server B&apos;s hlog&lt;br/&gt;
because 4 and 5 is concurrent, replayRecoveredEditsIfAny in 4 and appending log entry for this region&apos;s&lt;br/&gt;
recoverd.edit file are concurrent. So, when the recoverd.edit file deleted by replayRecoveredEdits, exception is thrown.&lt;/p&gt;

&lt;p&gt;master and region server log in this case as the following:&lt;/p&gt;

&lt;p&gt;master log&#65306; &lt;br/&gt;
2011-11-16 11:50:13,037 FATAL org.apache.hadoop.hbase.regionserver.wal.HLogSplitter: WriterThread-1 Got while writing log entry to log &lt;br/&gt;
org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: No lease on /hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156791680 File does not exist. &lt;span class=&quot;error&quot;&gt;&amp;#91;Lease. Holder: DFSClient_hb_m_dw75.kgb.sqa.cm4:60000_1321413286871, pendingcreates: 54&amp;#93;&lt;/span&gt; &lt;br/&gt;
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkLease(FSNamesystem.java:1542) &lt;br/&gt;
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkLease(FSNamesystem.java:1533) &lt;br/&gt;
        at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getAdditionalBlock(FSNamesystem.java:1449) &lt;br/&gt;
        at org.apache.hadoop.hdfs.server.namenode.NameNode.addBlock(NameNode.java:649) &lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor20.invoke(Unknown Source) &lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) &lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597) &lt;br/&gt;
        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:557) &lt;br/&gt;
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1415) &lt;br/&gt;
        at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1411) &lt;br/&gt;
        at java.security.AccessController.doPrivileged(Native Method) &lt;br/&gt;
        at javax.security.auth.Subject.doAs(Subject.java:396) &lt;br/&gt;
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1115) &lt;br/&gt;
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:1409) &lt;/p&gt;

&lt;p&gt;        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) &lt;br/&gt;
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39) &lt;br/&gt;
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27) &lt;br/&gt;
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513) &lt;br/&gt;
        at org.apache.hadoop.hbase.RemoteExceptionHandler.decodeRemoteException(RemoteExceptionHandler.java:96) &lt;br/&gt;
        at org.apache.hadoop.hbase.RemoteExceptionHandler.checkThrowable(RemoteExceptionHandler.java:49) &lt;br/&gt;
        at org.apache.hadoop.hbase.RemoteExceptionHandler.checkIOException(RemoteExceptionHandler.java:66) &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter$WriterThread.writeBuffer(HLogSplitter.java:962) &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter$WriterThread.doRun(HLogSplitter.java:926) &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter$WriterThread.run(HLogSplitter.java:898) &lt;/p&gt;



&lt;p&gt;regionserver log&#65306; &lt;br/&gt;
2011-11-16 11:49:49,727 ERROR org.apache.hadoop.hbase.regionserver.HRegion: Failed delete of hdfs://dw74.kgb.sqa.cm4:9000/hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156791680&lt;br/&gt;
2011-11-16 11:49:49,732 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Deleted recovered.edits file=hdfs://dw74.kgb.sqa.cm4:9000/hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156800103&lt;/p&gt;</comment>
                            <comment id="13156967" author="zjushch" created="Fri, 25 Nov 2011 02:43:17 +0000"  >&lt;p&gt;After successfully move region from server A to server B,&lt;br/&gt;
the log about this region in server A&apos;s log file is successful because flushed already,&lt;br/&gt;
but it affects other regions&apos;log data in server A&apos;s log file if encounter this exception when split hlog&lt;/p&gt;</comment>
                            <comment id="13156991" author="zjushch" created="Fri, 25 Nov 2011 05:05:43 +0000"  >&lt;p&gt;@Ted @Todd&lt;/p&gt;

&lt;p&gt;I&apos;m sorry my explanation is not clear.&lt;br/&gt;
I think I should descibe the detailed case first.&lt;/p&gt;

&lt;p&gt;In the whole following process , client&apos;s putting data to region C.&lt;br/&gt;
1.Sucessfully move region C from server A to server B,&lt;br/&gt;
At the moment,there is log entry about region C in both server A&apos;s log file and server B&apos;s log file&lt;/p&gt;

&lt;p&gt;2.kill server A and server B,&lt;/p&gt;

&lt;p&gt;3.restart server B,&lt;br/&gt;
Now, mastet start serverShutdownHanlder for server B, and assign the region C to server D&lt;/p&gt;

&lt;p&gt;4,Before region C is opend on the server D,restart server A&lt;br/&gt;
Now,mastet start serverShutdownHanlder for server A, and split server A&apos;s log file.&lt;br/&gt;
Because there is log entry about region C in server A&apos;s log file (why? see 1), split hlog thread would create a file F in the region C&apos;s recovered.edits directory.&lt;/p&gt;

&lt;p&gt;5.In region C opening process, it will execute replayRecoveredEdits(),and then delete file F.&lt;/p&gt;

&lt;p&gt;6.Therefore,in the 4, it throws IO Exception that file F not exists, and cause stopping parse the current  server A&apos;s hlog file, however, other data in this server A&apos;s hlog file lossed&lt;/p&gt;

&lt;p&gt;The posted region server log is server B&apos;s log, and it is doing replayRecoveredEditsIfAny(). Although it prints failed delete of  file recovered.edits/0000000013156791680, but  in fact this file has been deleted, and master throws file not exist exception :&lt;br/&gt;
2011-11-16 11:50:13,037 FATAL org.apache.hadoop.hbase.regionserver.wal.HLogSplitter: WriterThread-1 Got while writing log entry to log org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: No lease on /hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156791680 File does not exist.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure whether you are clear now, waiting for your question.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;
</comment>
                            <comment id="13157250" author="yuzhihong@gmail.com" created="Fri, 25 Nov 2011 17:15:52 +0000"  >&lt;p&gt;Log snippets from Chunhui.&lt;br/&gt;
Region C was 3591e9867a4c125493dc82168854ea0c&lt;br/&gt;
File F was 0000000013156791680&lt;/p&gt;

&lt;p&gt;Master log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2011-11-16 11:47:23,134 INFO org.apache.hadoop.hbase.master.ServerManager:
  Triggering server recovery; existingServer serverB,60020,1321415172631 looks stale
  2011-11-16 11:47:23,134 DEBUG org.apache.hadoop.hbase.master.ServerManager:
  Added=serverB,60020,1321415172631 to dead servers, submitted shutdown handler to be executed, root=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, meta=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;

  2011-11-16 11:47:29,305 INFO org.apache.hadoop.hbase.master.ServerManager:
  Triggering server recovery; existingServer serverA,60020,1321415179549 looks stale
  2011-11-16 11:47:29,305 DEBUG org.apache.hadoop.hbase.master.ServerManager:
  Added=serverA,60020,1321415179549 to dead servers, submitted shutdown handler to be executed, root=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, meta=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;

  2011-11-16 11:48:28,700 INFO org.apache.hadoop.hbase.regionserver.wal.HLogSplitter:
  Splitting 28 hlog(s) in hdfs:&lt;span class=&quot;code-comment&quot;&gt;//serverX:9000/hbase-common/.logs/serverB,60020,1321414043798
&lt;/span&gt;
  2011-11-16 11:48:30,657 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLogSplitter:
  Creating writer path=hdfs:&lt;span class=&quot;code-comment&quot;&gt;//serverX:9000/hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156800103 region=3591e9867a4c125493dc82168854ea0c
&lt;/span&gt;
  2011-11-16 11:49:17,855 INFO org.apache.hadoop.hbase.regionserver.wal.HLogSplitter:
  Closed path hdfs:&lt;span class=&quot;code-comment&quot;&gt;//serverX:9000/hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156800103 (wrote 75875 edits in 3228ms)
&lt;/span&gt;
  2011-11-16 11:49:19,629 INFO org.apache.hadoop.hbase.regionserver.wal.HLogSplitter:
  Splitting 28 hlog(s) in hdfs:&lt;span class=&quot;code-comment&quot;&gt;//serverX:9000/hbase-common/.logs/serverA,60020,1321414056134
&lt;/span&gt;
  2011-11-16 11:49:20,650 DEBUG org.apache.hadoop.hbase.regionserver.wal.HLogSplitter:
  Creating writer path=hdfs:&lt;span class=&quot;code-comment&quot;&gt;//serverX:9000/hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156791680 region=3591e9867a4c125493dc82168854ea0c
&lt;/span&gt;
  2011-11-16 11:49:36,731 DEBUG org.apache.hadoop.hbase.master.AssignmentManager:
  Assigning region writetest1,19ILNKUHRKQ3BT0FLC9CMVWBP2ZPRV4W7XYA491BE6ZS2JE9132BO5GABIHNJHDU79TXBA4OOAP8OEIVTQ0PDHZB26QI5XHY17BK,1321267032810.3591e9867a4c125493dc82168854ea0c. to serverD,60020,1321415224381

  2011-11-16 11:49:49,755 DEBUG org.apache.hadoop.hbase.master.handler.OpenedRegionHandler: Opened region writetest1,19ILNKUHRKQ3BT0FLC9CMVWBP2ZPRV4W7XYA491BE6ZS2JE9132BO5GABIHNJHDU79TXBA4OOAP8OEIVTQ0PDHZB26QI5XHY17BK,1321267032810.3591e9867a4c125493dc82168854ea0c. on serverD,60020,1321415224381

  2011-11-16 11:50:13,030 WARN org.apache.hadoop.hdfs.DFSClient: DataStreamer Exception: org.apache.hadoop.ipc.RemoteException: org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: No lease on /hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156791680 File does not exist.

  2011-11-16 11:50:13,037 FATAL org.apache.hadoop.hbase.regionserver.wal.HLogSplitter: WriterThread-1 Got &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; writing log entry to log
  org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: No lease on /hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156791680 File does not exist.

  2011-11-16 11:50:13,051 ERROR org.apache.hadoop.hbase.master.MasterFileSystem: Failed splitting hdfs:&lt;span class=&quot;code-comment&quot;&gt;//serverX:9000/hbase-common/.logs/serverA,60020,1321414056134&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Log from region server D:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2011-11-16 11:49:36,730 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Received request to open region: writetest1,19ILNKUHRKQ3BT0FLC9CMVWBP2ZPRV4W7XYA491BE6ZS2JE9132BO5GABIHNJHDU79TXBA4OOAP8OEIVTQ0PDHZB26QI5XHY17BK,1321267032810.3591e9867a4c125493dc82168854ea0c.

2011-11-16 11:49:49,727 ERROR org.apache.hadoop.hbase.regionserver.HRegion:
Failed delete of hdfs:&lt;span class=&quot;code-comment&quot;&gt;//serverX:9000/hbase-common/writetest1/3591e9867a4c125493dc82168854ea0c/recovered.edits/0000000013156791680
&lt;/span&gt; 
2011-11-16 11:49:49,733 INFO org.apache.hadoop.hbase.regionserver.HRegion:
Onlined writetest1,19ILNKUHRKQ3BT0FLC9CMVWBP2ZPRV4W7XYA491BE6ZS2JE9132BO5GABIHNJHDU79TXBA4OOAP8OEIVTQ0PDHZB26QI5XHY17BK,1321267032810.3591e9867a4c125493dc82168854ea0c.; next sequenceid=13160672878
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13157270" author="ram_krish" created="Fri, 25 Nov 2011 17:57:40 +0000"  >&lt;p&gt;If the scenario is valid do we need to up the priority of this defect? But may not be common.&lt;/p&gt;</comment>
                            <comment id="13157289" author="hadoopqa" created="Fri, 25 Nov 2011 20:19:38 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505060/hbase-4862v1+for+trunk.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505060/hbase-4862v1+for+trunk.diff&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestRollingRestart&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestRestartCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.thrift2.TestThriftHBaseServiceHandler&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestHLogBench&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestMetaMigrationRemovingHTD&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestAtomicOperation&lt;br/&gt;
                  org.apache.hadoop.hbase.TestInfoServers&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestParallelPut&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestLogRolling&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestStoreFileBlockCacheSummary&lt;br/&gt;
                  org.apache.hadoop.hbase.TestRegionRebalancing&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestLogRollAbort&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestFSErrorsExposed&lt;br/&gt;
                  org.apache.hadoop.hbase.ipc.TestDelayedRpc&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestDistributedLogSplitting&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestWALReplay&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestHMasterRPCException&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestHRegion&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestMultipleTimestamps&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestHRegionServerBulkLoad&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestSplitTransactionOnCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestMetaScanner&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestMaster&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestMasterRestartAfterDisablingTable&lt;br/&gt;
                  org.apache.hadoop.hbase.TestDrainingServer&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestSplitLogWorker&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestEndToEndSplitTransaction&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestZKBasedOpenCloseRegion&lt;br/&gt;
                  org.apache.hadoop.hbase.avro.TestAvroServer&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestServerCustomProtocol&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestHLogSplit&lt;br/&gt;
                  org.apache.hadoop.hbase.thrift.TestThriftServer&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestRegionServerMetrics&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestMasterFailover&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestHLog&lt;br/&gt;
                  org.apache.hadoop.hbase.TestMultiVersions&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestMasterTransitions&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestSplitLogManager&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestOpenedRegionHandler&lt;br/&gt;
                  org.apache.hadoop.hbase.thrift.TestThriftServerCmdLine&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/369//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/369//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/369//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/369//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/369//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/369//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13157319" author="yuzhihong@gmail.com" created="Fri, 25 Nov 2011 22:53:14 +0000"  >&lt;p&gt;I ran a few tests based on patch for TRUNK and didn&apos;t see failure.&lt;br/&gt;
Reattaching patch for TRUNK.&lt;/p&gt;</comment>
                            <comment id="13157321" author="yuzhihong@gmail.com" created="Fri, 25 Nov 2011 22:54:19 +0000"  >&lt;p&gt;TestHLogSplit passed on MacBook.&lt;/p&gt;

&lt;p&gt;Rerun test suite on Jenkins.&lt;/p&gt;</comment>
                            <comment id="13157334" author="hadoopqa" created="Fri, 25 Nov 2011 23:26:23 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505167/4862.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505167/4862.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/373//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/373//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/373//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/373//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/373//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/373//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13157339" author="yuzhihong@gmail.com" created="Fri, 25 Nov 2011 23:43:05 +0000"  >&lt;p&gt;I could run test suite by executing &apos;mvn test&apos; on MacBook.&lt;br/&gt;
PreCommit builds 371 and 373 didn&apos;t run any tests.&lt;/p&gt;</comment>
                            <comment id="13157340" author="yuzhihong@gmail.com" created="Fri, 25 Nov 2011 23:43:59 +0000"  >&lt;p&gt;Lifting priority as Ramkrishna suggested.&lt;/p&gt;</comment>
                            <comment id="13157341" author="yuzhihong@gmail.com" created="Fri, 25 Nov 2011 23:48:56 +0000"  >&lt;p&gt;When attaching patch, please grant license to ASF.&lt;/p&gt;</comment>
                            <comment id="13157366" author="zjushch" created="Sat, 26 Nov 2011 04:55:03 +0000"  >&lt;p&gt;Grant license to ASF for  the attached patch &lt;/p&gt;</comment>
                            <comment id="13157367" author="hadoopqa" created="Sat, 26 Nov 2011 05:06:40 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505172/hbase-4862v1+for+trunk.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505172/hbase-4862v1+for+trunk.diff&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/374//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/374//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/374//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/374//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/374//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/374//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13157379" author="yuzhihong@gmail.com" created="Sat, 26 Nov 2011 05:53:55 +0000"  >&lt;p&gt;Chunhui ran the patch through test suite.&lt;/p&gt;

&lt;p&gt;The OS is:&lt;br/&gt;
Red Hat Enterprise Linux Server release 5.4 (Tikanga)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Results :
Failed tests:   testResetZooKeeperSession(org.apache.hadoop.hbase.replication.TestReplicationPeer): ReplicationPeer ZooKeeper session
was not properly expired.
  testClosing(org.apache.hadoop.hbase.client.TestHCM)
Tests run: 1173, Failures: 2, Errors: 0, Skipped: 8
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 2:02:44.930s
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;testClosing failure is captured in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4874&quot; title=&quot;Run tests with non-secure random, some tests hang otherwise&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4874&quot;&gt;&lt;del&gt;HBASE-4874&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
TestReplicationPeer passed when run manually.&lt;/p&gt;</comment>
                            <comment id="13157385" author="yuzhihong@gmail.com" created="Sat, 26 Nov 2011 06:25:43 +0000"  >&lt;p&gt;@Todd:&lt;br/&gt;
Do you need more details from Chunhui ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13157388" author="yuzhihong@gmail.com" created="Sat, 26 Nov 2011 06:38:43 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fileName.endsWith(HLog.RECOVERED_LOG_TMPFILE_SUFFIX))
+      fileName = fileName.split(HLog.RECOVERED_LOG_TMPFILE_SUFFIX)[0];
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please enclose the second line above in curly braces.&lt;/p&gt;

&lt;p&gt;w.r.t. fs.rename() call, here is javadoc from ClientProtocol.rename(which is called by fs.rename):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; successful, or &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the old name does not exist
   * or &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; name already belongs to the namespace.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We should check the return value along with catching exception.&lt;/p&gt;</comment>
                            <comment id="13157405" author="zjushch" created="Sat, 26 Nov 2011 07:32:19 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
I has amend the patch&lt;br/&gt;
Please check.&lt;/p&gt;</comment>
                            <comment id="13157406" author="yuzhihong@gmail.com" created="Sat, 26 Nov 2011 07:46:00 +0000"  >&lt;p&gt;Thanks for the quick turnaround.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed rename &quot;&lt;/span&gt; + wap.p + &lt;span class=&quot;code-quote&quot;&gt;&quot; to &quot;&lt;/span&gt; + dst);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above should read &apos;Failed renaming &apos;.&lt;/p&gt;

&lt;p&gt;For HLog.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (p.getName().endsWith(RECOVERED_LOG_TMPFILE_SUFFIX))
+            result = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please add curly braces for the above as well.&lt;/p&gt;</comment>
                            <comment id="13157407" author="hadoopqa" created="Sat, 26 Nov 2011 07:46:43 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505178/hbase-4862v2fortrunk.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505178/hbase-4862v2fortrunk.diff&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/376//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/376//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/376//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/376//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/376//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/376//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13157410" author="zjushch" created="Sat, 26 Nov 2011 07:57:29 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
I has amend the patch again &lt;br/&gt;
Please check&lt;/p&gt;</comment>
                            <comment id="13157411" author="yuzhihong@gmail.com" created="Sat, 26 Nov 2011 08:04:51 +0000"  >&lt;p&gt;+1 on patch v3. &lt;/p&gt;

&lt;p&gt;Please run patch for 0.90 through test suite and let us know the results. &lt;/p&gt;</comment>
                            <comment id="13157412" author="hadoopqa" created="Sat, 26 Nov 2011 08:06:45 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505180/hbase-4862v3fortrunk.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505180/hbase-4862v3fortrunk.diff&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/377//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/377//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/377//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/377//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/377//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/377//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13157525" author="tianwu" created="Sat, 26 Nov 2011 15:47:40 +0000"  >&lt;p&gt;Ted,&lt;br/&gt;
I find patch v3 make some failed test after changing fs.rename(wap.p, dst) to if (!fs.rename(wap.p, dst)) &lt;/p&gt;
{
              throw new IOException(&quot;Failed renaming &quot; + wap.p + &quot; to &quot; + dst);
            }
&lt;p&gt;I will amend it , and give you test results later&lt;/p&gt;




</comment>
                            <comment id="13157636" author="jmhsieh" created="Sun, 27 Nov 2011 01:27:24 +0000"  >&lt;p&gt;How feasible is it to add testing to this patch?  Maybe simulate the failure situation by aborting RS&apos;s and then starting them like in the TestSplitTransactionOnCluster tests?&lt;/p&gt;</comment>
                            <comment id="13157638" author="zjushch" created="Sun, 27 Nov 2011 01:52:32 +0000"  >&lt;p&gt;@Jonathan&lt;br/&gt;
I think we could add testing to this patch through doing region&apos;s replayrecoverdedit after creating writer when doing splitlog.&lt;/p&gt;</comment>
                            <comment id="13157648" author="zjushch" created="Sun, 27 Nov 2011 03:55:22 +0000"  >&lt;p&gt;Add a test case in patchv5&lt;/p&gt;</comment>
                            <comment id="13157652" author="zjushch" created="Sun, 27 Nov 2011 04:10:16 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
I add testing to this patch in patchV5.&lt;/p&gt;

&lt;p&gt;In the OS:Red Hat Enterprise Linux Server release 5.4 (Tikanga)&lt;br/&gt;
The test results is as the following:&lt;/p&gt;

&lt;p&gt;For trunk with  patchV5:&lt;br/&gt;
_&lt;br/&gt;
Results :&lt;/p&gt;

&lt;p&gt;Failed tests:   testResetZooKeeperSession(org.apache.hadoop.hbase.replication.TestReplicationPeer): ReplicationPeer ZooKeeper session &lt;/p&gt;

&lt;p&gt;was not properly expired.&lt;br/&gt;
  testClosing(org.apache.hadoop.hbase.client.TestHCM)&lt;/p&gt;

&lt;p&gt;Tests run: 1174, Failures: 2, Errors: 0, Skipped: 8&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; BUILD FAILURE&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Total time: 2:00:49.122s&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Finished at: Sun Nov 27 02:41:40 CST 2011&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Final Memory: 35M/361M&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
_&lt;/p&gt;



&lt;p&gt;For 0.90 with  patchV5:&lt;/p&gt;

&lt;p&gt;_&lt;br/&gt;
Results :&lt;/p&gt;

&lt;p&gt;Tests run: 702, Failures: 0, Errors: 0, Skipped: 9&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; BUILD SUCCESS&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Total time: 1:15:37.342s&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Finished at: Sun Nov 27 11:00:07 CST 2011&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Final Memory: 26M/525M&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
_&lt;/p&gt;

&lt;p&gt;The failed two tests In trunk are the same as the last run, one of which(TestReplicationPeer#testResetZooKeeperSession) could pass separately and the other is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4874&quot; title=&quot;Run tests with non-secure random, some tests hang otherwise&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4874&quot;&gt;&lt;del&gt;HBASE-4874&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13157662" author="hadoopqa" created="Sun, 27 Nov 2011 05:24:39 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505225/hbase-4862v5fortrunk.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505225/hbase-4862v5fortrunk.diff&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestRollingRestart&lt;br/&gt;
                  org.apache.hadoop.hbase.util.TestRegionSplitter&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestMultiParallel&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestRestartCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.thrift2.TestThriftHBaseServiceHandler&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestInstantSchemaChange&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestHLogBench&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestGzipFilter&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestMetaMigrationRemovingHTD&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestAtomicOperation&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestScannersWithFilters&lt;br/&gt;
                  org.apache.hadoop.hbase.TestInfoServers&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestParallelPut&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestClassLoading&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestAdmin&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestLogRolling&lt;br/&gt;
                  org.apache.hadoop.hbase.filter.TestColumnRangeFilter&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableInputFormat&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestHCM&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestStoreFileBlockCacheSummary&lt;br/&gt;
                  org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildHole&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestMasterObserver&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestStatusResource&lt;br/&gt;
                  org.apache.hadoop.hbase.TestRegionRebalancing&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestLogRollAbort&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestVersionResource&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestScannerTimeout&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestFromClientSide&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestFSErrorsExposed&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestAggregateProtocol&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestRowResource&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestScannerResource&lt;br/&gt;
                  org.apache.hadoop.hbase.ipc.TestDelayedRpc&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.client.TestRemoteAdmin&lt;br/&gt;
                  org.apache.hadoop.hbase.util.TestFSUtils&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestDistributedLogSplitting&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestTableResource&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestWALReplay&lt;br/&gt;
                  org.apache.hadoop.hbase.util.TestIdLock&lt;br/&gt;
                  org.apache.hadoop.hbase.catalog.TestCatalogTrackerOnCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestTransform&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestCoprocessorEndpoint&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestInstantSchemaChangeSplit&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestHRegion&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestMultipleTimestamps&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort&lt;br/&gt;
                  org.apache.hadoop.hbase.catalog.TestMetaReaderEditor&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestHRegionServerBulkLoad&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestSplitTransactionOnCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestMetaScanner&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestHFileBlock&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestTimestampsFilter&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestInstantSchemaChangeFailover&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestShell&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestMasterRestartAfterDisablingTable&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestRegionObserverBypass&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestEndToEndSplitTransaction&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestSchemaResource&lt;br/&gt;
                  org.apache.hadoop.hbase.TestAcidGuarantees&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestZKBasedOpenCloseRegion&lt;br/&gt;
                  org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildBase&lt;br/&gt;
                  org.apache.hadoop.hbase.avro.TestAvroServer&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.client.TestRemoteTable&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestServerCustomProtocol&lt;br/&gt;
                  org.apache.hadoop.hbase.util.TestHBaseFsck&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestMasterCoprocessorExceptionWithRemove&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestHTableUtil&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestHLogSplit&lt;br/&gt;
                  org.apache.hadoop.hbase.thrift.TestThriftServer&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestRegionObserverInterface&lt;br/&gt;
                  org.apache.hadoop.hbase.util.TestMergeTool&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestRegionServerMetrics&lt;br/&gt;
                  org.apache.hadoop.hbase.util.TestMergeTable&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestMasterFailover&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestHLog&lt;br/&gt;
                  org.apache.hadoop.hbase.rest.TestMultiRowResource&lt;br/&gt;
                  org.apache.hadoop.hbase.TestMultiVersions&lt;br/&gt;
                  org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildOverlap&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestMasterTransitions&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestSplitLogManager&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithRemove&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestWALObserver&lt;br/&gt;
                  org.apache.hadoop.hbase.TestZooKeeper&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestOpenedRegionHandler&lt;br/&gt;
                  org.apache.hadoop.hbase.thrift.TestThriftServerCmdLine&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestMasterCoprocessorExceptionWithAbort&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/378//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/378//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/378//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/378//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/378//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/378//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13157671" author="jmhsieh" created="Sun, 27 Nov 2011 06:26:46 +0000"  >&lt;p&gt;@chenhui&lt;/p&gt;

&lt;p&gt;I have a question and a few nits. &lt;/p&gt;

&lt;p&gt;What happens if the .temp gets left behind without being renamed?&lt;/p&gt;

&lt;p&gt;You might want to mention that hlogs files in progress (.temp file suffixed) are excluded here.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        &lt;span class=&quot;code-comment&quot;&gt;// After creating writer, simulate partial region&apos;s
&lt;/span&gt;+        &lt;span class=&quot;code-comment&quot;&gt;// replayRecoveredEditsIfAny() which gets SplitEditFiles of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
&lt;/span&gt;+        &lt;span class=&quot;code-comment&quot;&gt;// region,and delete them.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also, probably want to update javadoc of getSplitEditFilesSorted.&lt;/p&gt;

&lt;p&gt;Comment should probably be &quot;most likely&quot; instead of &quot;mostly&quot;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;{
+      logSplitter.splitLog();
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
+      LOG.info(e);
+      Assert.fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;Throws IOException when spliting &quot;&lt;/span&gt;
+          + &lt;span class=&quot;code-quote&quot;&gt;&quot;log, it is mostly because writing file does not &quot;&lt;/span&gt;
+          + &lt;span class=&quot;code-quote&quot;&gt;&quot;exist which is caused by concurrent replayRecoveredEditsIfAny()&quot;&lt;/span&gt;);
+    }
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fs.exists(corruptDir)) {
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fs.listStatus(corruptDir).length &amp;gt; 0) {
+        Assert.fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;There are some corrupt logs, &quot;&lt;/span&gt;
+            + &lt;span class=&quot;code-quote&quot;&gt;&quot;it is mostly caused by concurrent replayRecoveredEditsIfAny()&quot;&lt;/span&gt;);
+      }
+    }
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13157678" author="zjushch" created="Sun, 27 Nov 2011 06:41:23 +0000"  >&lt;p&gt;@Jonathan&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;What happens if the .temp gets left behind without being renamed?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If the .temp file gets left behind, it means the log splitting failed, and the .temp file would be deleted in the next log splitting.&lt;br/&gt;
You could find that, for the same split hlog file, it creates the same filename in the region&apos;s recoverd.edits directory&lt;/p&gt;

&lt;p&gt;Thanks for your suggestion.&lt;/p&gt;
</comment>
                            <comment id="13157680" author="yuzhihong@gmail.com" created="Sun, 27 Nov 2011 06:53:00 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-comment&quot;&gt;// Skip the test which creates a splitter that reads and writes the
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// data without touching disk. testThreading#TestHLogSplit .etc
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fs.exists(wap.p)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The javadoc should read:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-comment&quot;&gt;// Skip the unit tests which create a splitter that reads and writes the
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// data without touching disk. TestHLogSplit#testThreading is an example.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Specific test is represented by classname#testname&lt;/p&gt;</comment>
                            <comment id="13157916" author="yuzhihong@gmail.com" created="Sun, 27 Nov 2011 15:41:16 +0000"  >&lt;p&gt;Patch v6 with javadoc updated according to reviews&lt;/p&gt;</comment>
                            <comment id="13157918" author="hadoopqa" created="Sun, 27 Nov 2011 15:56:39 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505251/4862-v6-trunk.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505251/4862-v6-trunk.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/379//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/379//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/379//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/379//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/379//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/379//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13157919" author="hadoopqa" created="Sun, 27 Nov 2011 16:01:50 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505252/4862-v6-90.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505252/4862-v6-90.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/380//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/380//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13158143" author="zjushch" created="Mon, 28 Nov 2011 02:11:05 +0000"  >&lt;p&gt;Based on patchV6,update javadoc of HLog#getSplitEditFilesSorted&lt;/p&gt;</comment>
                            <comment id="13158146" author="hadoopqa" created="Mon, 28 Nov 2011 02:26:12 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505285/hbase-4862v7fortrunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505285/hbase-4862v7fortrunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/388//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/388//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/388//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/388//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/388//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/388//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13158149" author="yuzhihong@gmail.com" created="Mon, 28 Nov 2011 02:40:20 +0000"  >&lt;p&gt;Patch for 0.92 branch.&lt;/p&gt;</comment>
                            <comment id="13158151" author="hadoopqa" created="Mon, 28 Nov 2011 02:41:47 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505287/4862-0.92.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505287/4862-0.92.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/389//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/389//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13158177" author="yuzhihong@gmail.com" created="Mon, 28 Nov 2011 05:01:01 +0000"  >&lt;p&gt;Integrated to 0.90, 0.92 branches and TRUNK.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Chunhui.&lt;/p&gt;

&lt;p&gt;Thanks for the review Jonathan.&lt;/p&gt;</comment>
                            <comment id="13158178" author="hudson" created="Mon, 28 Nov 2011 05:06:05 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2490 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2490/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2490/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4862&quot; title=&quot;Splitting hlog and opening region concurrently may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4862&quot;&gt;&lt;del&gt;HBASE-4862&lt;/del&gt;&lt;/a&gt;  Splitting hlog and opening region concurrently may cause data loss&lt;br/&gt;
               (Chunhui Shen)&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogSplit.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13158266" author="hudson" created="Mon, 28 Nov 2011 07:35:44 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #20 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/20/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/20/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4862&quot; title=&quot;Splitting hlog and opening region concurrently may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4862&quot;&gt;&lt;del&gt;HBASE-4862&lt;/del&gt;&lt;/a&gt;  Splitting hlog and opening region concurrently may cause data loss&lt;br/&gt;
               (Chunhui Shen) move JIRA to 0.90 section in CHANGES.txt&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4862&quot; title=&quot;Splitting hlog and opening region concurrently may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4862&quot;&gt;&lt;del&gt;HBASE-4862&lt;/del&gt;&lt;/a&gt;  Splitting hlog and opening region concurrently may cause data loss&lt;br/&gt;
               (Chunhui Shen)&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogSplit.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13158321" author="hudson" created="Mon, 28 Nov 2011 09:38:32 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #12 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/12/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/12/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4862&quot; title=&quot;Splitting hlog and opening region concurrently may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4862&quot;&gt;&lt;del&gt;HBASE-4862&lt;/del&gt;&lt;/a&gt;  Splitting hlog and opening region concurrently may cause data loss&lt;br/&gt;
               (Chunhui Shen) Move JIRA to 0.90 section&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4862&quot; title=&quot;Splitting hlog and opening region concurrently may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4862&quot;&gt;&lt;del&gt;HBASE-4862&lt;/del&gt;&lt;/a&gt;  Splitting hlog and opening region concurrently may cause data loss&lt;br/&gt;
               (Chunhui Shen)&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogSplit.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13158347" author="hudson" created="Mon, 28 Nov 2011 11:25:11 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2491 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2491/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2491/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4862&quot; title=&quot;Splitting hlog and opening region concurrently may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4862&quot;&gt;&lt;del&gt;HBASE-4862&lt;/del&gt;&lt;/a&gt;  Splitting hlog and opening region concurrently may cause data loss&lt;br/&gt;
               (Chunhui Shen) Move JIRA to 0.90 section&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13158835" author="stack" created="Mon, 28 Nov 2011 21:58:38 +0000"  >&lt;p&gt;This is integrated.  Can we close it?&lt;/p&gt;</comment>
                            <comment id="13159790" author="hudson" created="Wed, 30 Nov 2011 03:48:27 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #163 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/163/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/163/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4862&quot; title=&quot;Splitting hlog and opening region concurrently may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4862&quot;&gt;&lt;del&gt;HBASE-4862&lt;/del&gt;&lt;/a&gt;  Splitting hlog and opening region concurrently may cause data loss&lt;br/&gt;
               (Chunhui Shen) move JIRA to 0.90 section in CHANGES.txt&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4862&quot; title=&quot;Splitting hlog and opening region concurrently may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4862&quot;&gt;&lt;del&gt;HBASE-4862&lt;/del&gt;&lt;/a&gt;  Splitting hlog and opening region concurrently may cause data loss&lt;br/&gt;
               (Chunhui Shen)&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogSplit.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15016050" author="lars_francke" created="Fri, 20 Nov 2015 11:53:43 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12505287" name="4862-0.92.txt" size="8941" author="yuzhihong@gmail.com" created="Mon, 28 Nov 2011 02:40:20 +0000"/>
                            <attachment id="12505252" name="4862-v6-90.txt" size="9081" author="yuzhihong@gmail.com" created="Sun, 27 Nov 2011 15:54:43 +0000"/>
                            <attachment id="12505283" name="4862-v6-trunk.patch" size="9731" author="yuzhihong@gmail.com" created="Mon, 28 Nov 2011 01:51:33 +0000"/>
                            <attachment id="12504991" name="4862.patch" size="4624" author="zjushch" created="Thu, 24 Nov 2011 07:00:51 +0000"/>
                            <attachment id="12505167" name="4862.txt" size="4144" author="yuzhihong@gmail.com" created="Fri, 25 Nov 2011 23:12:35 +0000"/>
                            <attachment id="12505171" name="hbase-4862v1 for 0.90.diff" size="4044" author="zjushch" created="Sat, 26 Nov 2011 04:55:03 +0000"/>
                            <attachment id="12505059" name="hbase-4862v1 for 0.90.diff" size="4044" author="zjushch" created="Fri, 25 Nov 2011 05:07:11 +0000"/>
                            <attachment id="12505172" name="hbase-4862v1 for trunk.diff" size="4144" author="zjushch" created="Sat, 26 Nov 2011 04:55:03 +0000"/>
                            <attachment id="12505060" name="hbase-4862v1 for trunk.diff" size="4144" author="zjushch" created="Fri, 25 Nov 2011 05:07:47 +0000"/>
                            <attachment id="12505177" name="hbase-4862v2for0.90.diff" size="4150" author="zjushch" created="Sat, 26 Nov 2011 07:32:19 +0000"/>
                            <attachment id="12505178" name="hbase-4862v2fortrunk.diff" size="4344" author="zjushch" created="Sat, 26 Nov 2011 07:32:19 +0000"/>
                            <attachment id="12505179" name="hbase-4862v3for0.90.diff" size="4169" author="zjushch" created="Sat, 26 Nov 2011 07:56:11 +0000"/>
                            <attachment id="12505180" name="hbase-4862v3fortrunk.diff" size="4363" author="zjushch" created="Sat, 26 Nov 2011 07:56:11 +0000"/>
                            <attachment id="12505224" name="hbase-4862v5for0.90.diff" size="9019" author="zjushch" created="Sun, 27 Nov 2011 03:55:22 +0000"/>
                            <attachment id="12505225" name="hbase-4862v5fortrunk.diff" size="9677" author="zjushch" created="Sun, 27 Nov 2011 03:55:22 +0000"/>
                            <attachment id="12505284" name="hbase-4862v7for0.90.patch" size="9409" author="zjushch" created="Mon, 28 Nov 2011 02:11:05 +0000"/>
                            <attachment id="12505285" name="hbase-4862v7fortrunk.patch" size="10094" author="zjushch" created="Mon, 28 Nov 2011 02:11:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 24 Nov 2011 15:37:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>218315</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i06aa7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34597</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>