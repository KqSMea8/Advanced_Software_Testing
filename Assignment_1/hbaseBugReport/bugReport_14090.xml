<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:49:39 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14090/HBASE-14090.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14090] Redo FS layout; let go of tables/regions/stores directory hierarchy in DFS</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14090</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Our layout as is won&apos;t work if 1M regions; e.g. HDFS will fall over if directories of hundreds of thousands of files. &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13991&quot; title=&quot;Hierarchical Layout for Humongous Tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13991&quot;&gt;HBASE-13991&lt;/a&gt; (Humongous Tables) would address this specific directory problem only by adding subdirs under table dir but there are other issues with our current layout:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Our table/regions/column family &apos;facade&apos; has to be maintained in two locations &amp;#8211; in master memory and in the hdfs directory layout &amp;#8211; and the farce needs to be kept synced or worse, the model management is split between master memory and DFS layout. &apos;Syncing&apos; in HDFS has us dropping constructs such as &apos;Reference&apos; and &apos;HalfHFiles&apos; on split, &apos;HFileLinks&apos; when archiving, and so on. This &apos;tie&apos; makes it hard to make changes.&lt;/li&gt;
	&lt;li&gt;While HDFS has atomic rename, useful for fencing and for having files added atomically, if the model were solely owned by hbase, there are hbase primitives we could make use of &amp;#8211; changes in a row are atomic and coprocessors &amp;#8211; to simplify table transactions and provide more consistent views of our model to clients; file &apos;moves&apos; could be a memory operation only rather than an HDFS call; sharing files between tables/snapshots and when it is safe to remove them would be simplified if one owner only; and so on.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This is an umbrella blue-sky issue to discuss what a new layout would look like and how we might get there. I&apos;ll follow up with some sketches of what new layout could look like that come of some chats a few of us have been having. We are also under the &apos;delusion&apos; that move to a new layout could be done as part of a rolling upgrade and that the amount of work involved is not gargantuan.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12845303">HBASE-14090</key>
            <summary>Redo FS layout; let go of tables/regions/stores directory hierarchy in DFS</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12714102">HBASE-11165</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="busbey">Sean Busbey</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Jul 2015 16:53:28 +0000</created>
                <updated>Thu, 27 Oct 2016 19:23:45 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>25</watches>
                                                                <comments>
                            <comment id="14628360" author="stack" created="Wed, 15 Jul 2015 17:03:04 +0000"  >&lt;p&gt;See pushback in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13991&quot; title=&quot;Hierarchical Layout for Humongous Tables&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13991&quot;&gt;HBASE-13991&lt;/a&gt; for arguments for doing more than just patching current layout. In particular see &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;&apos;s list here: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13991?focusedCommentId=14608540&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14608540&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-13991?focusedCommentId=14608540&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14608540&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="14628578" author="eclark" created="Wed, 15 Jul 2015 19:26:44 +0000"  >&lt;p&gt;My big concern around using a list of files in meta is that it places more data into meta.&lt;/p&gt;</comment>
                            <comment id="14628600" author="mbertozzi" created="Wed, 15 Jul 2015 19:41:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; it does not need to be &quot;meta&quot; as &quot;meta&quot; used by the client. logically we have 3 things to place somewhere&lt;br/&gt;
Assignment - RegionId: &lt;span class=&quot;error&quot;&gt;&amp;#91;server=host.xyz, skey=xyz, table=xyz, &#8230;&amp;#93;&lt;/span&gt;&lt;br/&gt;
Region Manifests - RegionId: [family:&lt;span class=&quot;error&quot;&gt;&amp;#91;storefile, &#8230;&amp;#93;&lt;/span&gt;, &#8230;]&lt;br/&gt;
HFile Refs - HFileId: Ref-Count&lt;/p&gt;

&lt;p&gt;all of them can be splitted without problems because aside the master startup that does a &quot;scan assignment&quot; you only do point put and get to update the states. if they end up in the same table (e.g. meta) or separated that&apos;s a different discussion. &lt;/p&gt;</comment>
                            <comment id="14628632" author="eclark" created="Wed, 15 Jul 2015 20:03:02 +0000"  >&lt;p&gt;Yeah a different system table for it would be better. Right now we have some struggles with recovery and assignment on system tables. If we work those things out then it would be good.&lt;/p&gt;</comment>
                            <comment id="14628695" author="stack" created="Wed, 15 Jul 2015 20:42:30 +0000"  >&lt;p&gt;Here is a sketch of what FS layout could be like. Please add comments, details, or corrections to the doc. as you see fit:&lt;/p&gt;


&lt;p&gt;&lt;a href=&quot;https://docs.google.com/document/d/10tSCSSWPwdFqOLLYtY2aVFe6iCIrsBk4Vqm8LSGUfhQ/edit?usp=sharing&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://docs.google.com/document/d/10tSCSSWPwdFqOLLYtY2aVFe6iCIrsBk4Vqm8LSGUfhQ/edit?usp=sharing&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14629516" author="lhofhansl" created="Thu, 16 Jul 2015 10:02:27 +0000"  >&lt;p&gt;To throw out a radical idea: We &lt;em&gt;could&lt;/em&gt; go as far as having HBase manage a block pool directly, without the NN being involved at all. We&apos;d lose things like distCP, etc, but we&apos;d be in control of all blocks directly (placement, etc), and no need to run a pesky NN (with QJMs, etc). Let me dream for a bit &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14629662" author="mbertozzi" created="Thu, 16 Jul 2015 12:45:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;We could go as far as having HBase manage a block pool directly&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; I&apos;m with you on this, as I was mentioning on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7806&quot; title=&quot;Isolate the FileSystem calls&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7806&quot;&gt;HBASE-7806&lt;/a&gt;. if we go with block we can gain even more stuff like smarter compactions (instead of rewriting everything, replace just the blocks that require modification). deduplication when we do stuff like CopyTable or we may just have two tables with some data in common, placements and so on.&lt;br/&gt;
but switching to block will probably be too much work, we were trying to think how to split this stuff in intermediate steps and just changing the layout and add files refs in meta seems to be an unsplittable giant step. but at least the proposed stuff was designed with blocks in mind, so we can go there at some point (unless there is a big push to do it now).&lt;/p&gt;</comment>
                            <comment id="14629806" author="davelatham" created="Thu, 16 Jul 2015 14:24:44 +0000"  >&lt;p&gt;Going the block pool route sounds like we&apos;d have to redo or find a way to share a lot of what HDFS does.  Would be easier to manage locality though!&lt;/p&gt;</comment>
                            <comment id="14696447" author="stack" created="Fri, 14 Aug 2015 04:17:21 +0000"  >&lt;p&gt;Moved a bunch of the commentary into main body of the text. Thanks for great input so far.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12841405">HBASE-13991</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12864383">HBASE-14439</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12631644">HBASE-7806</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12779883">HBASE-13159</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12863547">HBASE-14413</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12617618">HBASE-7218</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 15 Jul 2015 19:26:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hah3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>