<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:51:08 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14240/HBASE-14240.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14240] Unactionable WARN messages in wal.ProcedureWALFormatReader</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14240</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;While testing 1.1.2RC0, I notice the following messages in my master log.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-08-18 00:42:59,646 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] procedure2.ProcedureExecutor: Starting procedure executor threads=5
2015-08-18 00:42:59,647 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Starting WAL Procedure Store lease recovery
2015-08-18 00:42:59,652 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] util.FSHDFSUtils: Recovering lease on dfs file hdfs://ndimiduk-rc-dist-1.openstacklocal:8020/apps/hbase/data/MasterProcWALs/state-00000000000000000001.log
2015-08-18 00:42:59,664 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] util.FSHDFSUtils: recoverLease=true, attempt=0 on file=hdfs://ndimiduk-rc-dist-1.openstacklocal:8020/apps/hbase/data/MasterProcWALs/state-00000000000000000001.log after 10ms
2015-08-18 00:42:59,665 DEBUG [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Opening state-log: FileStatus{path=hdfs://ndimiduk-rc-dist-1.openstacklocal:8020/apps/hbase/data/MasterProcWALs/state-00000000000000000001.log; isDirectory=false; length=9; replication=3; blocksize=134217728; modification_time=1439858084806; access_time=1439857575101; owner=hbase; group=hdfs; permission=rw-r--r--; isSymlink=false}
2015-08-18 00:42:59,676 WARN  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Unable to read tracker for hdfs://ndimiduk-rc-dist-1.openstacklocal:8020/apps/hbase/data/MasterProcWALs/state-00000000000000000001.log - Missing trailer: size=9 startPos=9
2015-08-18 00:42:59,703 DEBUG [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Roll new state log: 2
2015-08-18 00:42:59,705 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Lease acquired for flushLogId: 2
2015-08-18 00:42:59,711 WARN  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.ProcedureWALFormatReader: nothing left to decode. exiting with missing EOF
2015-08-18 00:42:59,711 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.ProcedureWALFormatReader: No active entry found in state log hdfs://ndimiduk-rc-dist-1.openstacklocal:8020/apps/hbase/data/MasterProcWALs/state-00000000000000000001.log. removing it
2015-08-18 00:42:59,711 DEBUG [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Remove log: hdfs://ndimiduk-rc-dist-1.openstacklocal:8020/apps/hbase/data/MasterProcWALs/state-00000000000000000001.log
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;These log lines are raised immediately after performing an in-place master upgrade from 0.98.0. Master initialized successfully and with no further errors.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12856968">HBASE-14240</key>
            <summary>Unactionable WARN messages in wal.ProcedureWALFormatReader</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ndimiduk">Nick Dimiduk</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Aug 2015 17:16:28 +0000</created>
                <updated>Tue, 18 Aug 2015 18:24:17 +0000</updated>
                                            <version>1.1.2</version>
                                                    <component>master</component>
                    <component>proc-v2</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="14701629" author="ndimiduk" created="Tue, 18 Aug 2015 17:19:01 +0000"  >&lt;p&gt;Attaching complete master logs for reference.&lt;/p&gt;</comment>
                            <comment id="14701650" author="mbertozzi" created="Tue, 18 Aug 2015 17:31:43 +0000"  >&lt;p&gt;is the master shutdown clean? i&apos;m not able to understand it from the logs.&lt;br/&gt;
in theory on a clean master shutdown the trailer should be written to the wal and the file closed. which seems not to be happened here. so you get the warning that is basically saying that that wal is from a non clean shutdown.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;----- MASTER RESTARTED (first run with 1.1) ----
2015-08-18 00:26:15,093 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Starting WAL Procedure Store lease recovery
2015-08-18 00:26:15,095 WARN  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Log directory not found: File hdfs://ndimiduk-rc-dist-1.openstacklocal:8020/apps/hbase/data/MasterProcWALs does not exist.
2015-08-18 00:26:15,107 DEBUG [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Roll new state log: 1
----- MASTER RESTARTED ----
2015-08-18 00:42:59,647 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Starting WAL Procedure Store lease recovery
2015-08-18 00:42:59,676 WARN  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Unable to read tracker for hdfs://ndimiduk-rc-dist-1.openstacklocal:8020/apps/hbase/data/MasterProcWALs/state-00000000000000000001.log - Missing trailer: size=9 startPos=9
2015-08-18 00:42:59,703 DEBUG [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Roll new state log: 2
2015-08-18 00:42:59,705 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.WALProcedureStore: Lease acquired for flushLogId: 2
2015-08-18 00:42:59,711 WARN  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.ProcedureWALFormatReader: nothing left to decode. exiting with missing EOF
2015-08-18 00:42:59,711 INFO  [ndimiduk-rc-dist-1:60000.activeMasterManager] wal.ProcedureWALFormatReader: No active entry found in state log hdfs://ndimiduk-rc-dist-1.openstacklocal:8020/apps/hbase/data/MasterProcWALs/state-00000000000000000001.log. removing it
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14701689" author="mbertozzi" created="Tue, 18 Aug 2015 17:51:38 +0000"  >&lt;p&gt;yeah, it doesn&apos;t look a clean shutdown. I don&apos;t see the log info saying &quot;Stopping the WAL Procedure Store&quot; or any of the &quot;Stopping&quot; message we should print on shutdown,  and from the logs looks like the master is still doing work when we get back to the hbase-daemon.sh script that says &quot;Terminating master&quot;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-08-18 00:34:44,688 WARN  [MASTER_META_SERVER_OPERATIONS-ndimiduk-rc-dist-1:60000-1] master.AssignmentManager: Can&apos;t move 1588230740, there is no destination server available.
2015-08-18 00:34:44,688 WARN  [MASTER_META_SERVER_OPERATIONS-ndimiduk-rc-dist-1:60000-1] master.AssignmentManager: Unable to determine a plan to assign {ENCODED =&amp;gt; 1588230740, NAME =&amp;gt; &apos;hbase:meta,,1&apos;, STARTKEY =&amp;gt; &apos;&apos;, ENDKEY =&amp;gt; &apos;&apos;}
Tue Aug 18 00:34:44 UTC 2015 Terminating master
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so, i&apos;d say that the warn is ok. we can probably improve it by saying that the missing trailer may be caused by a non clean shutdown or something like that&lt;/p&gt;</comment>
                            <comment id="14701712" author="ndimiduk" created="Tue, 18 Aug 2015 18:13:49 +0000"  >&lt;p&gt;Shutdown should have been clean; from my run log I used hbase-daemon.sh. It was running 0.98.0, before, so there would have been no WAL Procedure Store to stop. The installation was upgraded to 1.1.2RC0 and process started again.&lt;/p&gt;</comment>
                            <comment id="14701721" author="mbertozzi" created="Tue, 18 Aug 2015 18:18:32 +0000"  >&lt;p&gt;the warn is not from a 98 to 1.1 restart. but from a 1.1 to a 1.1 restart.&lt;br/&gt;
if you look at the first piece of log i posted you see that at  00:26:15,093 you have the first 0.98 to 1.1 clean start.&lt;br/&gt;
then at  00:34:44 that master is not cleanly shutdown and at 00:42:59 you have the second 1.1 startup that has the warn about the wal not closed properly&lt;/p&gt;</comment>
                            <comment id="14701731" author="ndimiduk" created="Tue, 18 Aug 2015 18:24:17 +0000"  >&lt;p&gt;Ah yes, I see. There&apos;s nothing in the .out files to indicate abrupt shutdown.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12751066" name="ndimiduk-rc-dist-1.tgz" size="142111" author="ndimiduk" created="Tue, 18 Aug 2015 17:19:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Aug 2015 17:31:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2j29r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>