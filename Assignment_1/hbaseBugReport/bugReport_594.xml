<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:45:44 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-594/HBASE-594.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-594] tables are being reassigned instead of deleted</title>
                <link>https://issues.apache.org/jira/browse/HBASE-594</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We are running HBase TRUNK (updated yesterday) and Hadoop TRUNK (updated a few days ago) on a 15 node cluster. One node doubles as master and region server. The remainder are region servers. &lt;/p&gt;

&lt;p&gt;I have been trying to use the HBase shell to drop tables for quite a few minutes now. &lt;/p&gt;

&lt;p&gt;The master schedules the table for deletion and the region server processes the deletion:&lt;/p&gt;

&lt;p&gt;08/04/18 16:57:29 INFO master.HMaster: deleted table: content.20b16c29&lt;br/&gt;
08/04/18 16:57:34 INFO master.ServerManager: 10.30.94.35:60020 no longer serving regionname: content.20b16c29,,1208549961323, startKey: &amp;lt;&amp;gt;, endKey: &amp;lt;&amp;gt;, encodedName: 385178593, tableDesc: {name: content.20b16c29, families: {content:=&lt;/p&gt;
{name: content, max versions: 1, compression: RECORD, in memory: false, block cache enabled: true, max length: 2147483647, bloom filter: none}
&lt;p&gt;, info:=&lt;/p&gt;
{name: info, max versions: 1, compression: NONE, in memory: false, block cache enabled: true, maxlength: 2147483647, bloom filter: none}
&lt;p&gt;}}&lt;br/&gt;
08/04/18 16:57:34 INFO master.ProcessRegionClose$1: region closed: content.20b16c29,,1208549961323&lt;/p&gt;

&lt;p&gt;but then a META scan happens and the table is reassigned to another server to live on as a zombie:&lt;/p&gt;

&lt;p&gt;08/04/18 16:57:48 INFO master.BaseScanner: RegionManager.metaScanner scanning meta region &lt;/p&gt;
{regionname: .META.,,1, startKey: &amp;lt;&amp;gt;, server: 10.30.94.37:60020}
&lt;p&gt;08/04/18 16:57:48 INFO master.BaseScanner: RegionManager.metaScanner scan of meta region &lt;/p&gt;
{regionname: .META.,,1, startKey: &amp;lt;&amp;gt;, server: 10.30.94.37:60020}
&lt;p&gt; complete&lt;br/&gt;
08/04/18 16:57:48 INFO master.BaseScanner: all meta regions scanned&lt;br/&gt;
08/04/18 16:57:49 INFO master.RegionManager: assigning region content.20b16c29,,1208549961323 to server 10.30.94.39:60020&lt;br/&gt;
08/04/18 16:57:52 INFO master.BaseScanner: RegionManager.rootScanner scanning meta region &lt;/p&gt;
{regionname: -ROOT-,,0, startKey: &amp;lt;&amp;gt;, server: 10.30.94.31:60020}
&lt;p&gt;08/04/18 16:57:52 INFO master.BaseScanner: RegionManager.rootScanner scan of meta region &lt;/p&gt;
{regionname: -ROOT-,,0, startKey: &amp;lt;&amp;gt;, server: 10.30.94.31:60020}
&lt;p&gt; complete&lt;br/&gt;
08/04/18 16:57:52 INFO master.ServerManager: 10.30.94.39:60020 serving content.20b16c29,,1208549961323&lt;br/&gt;
08/04/18 16:57:52 INFO master.ProcessRegionOpen$1: regionname: content.20b16c29,,1208549961323, startKey: &amp;lt;&amp;gt;, endKey: &amp;lt;&amp;gt;, encodedName: 385178593, tableDesc: {name: content.20b16c29, families: {content:=&lt;/p&gt;
{name: content, max versions: 1, compression: RECORD, in memory: false, block cache enabled: true, max length: 2147483647, bloom filter: none}
&lt;p&gt;, info:=&lt;/p&gt;
{name: info, max versions: 1, compression: NONE, in memory: false, block cache enabled: true, max length: 2147483647, bloom filter: none}
&lt;p&gt;}} open on 10.30.94.39:60020&lt;br/&gt;
08/04/18 16:57:52 INFO master.ProcessRegionOpen$1: updating row content.20b16c29,,1208549961323 in table .META.,,1 with startcode 1208552149355 and server 10.30.94.39:60020&lt;/p&gt;

&lt;p&gt;Approximately 50 META region scans then happen, then the following occurs and reoccurs over many many subsequent META scans:&lt;/p&gt;

&lt;p&gt;08/04/18 17:26:48 INFO master.BaseScanner: RegionManager.metaScanner scanning meta region &lt;/p&gt;
{regionname: .META.,,1, startKey: &amp;lt;&amp;gt;, server: 10.30.94.37:60020}
&lt;p&gt;08/04/18 17:26:48 WARN master.HMaster: info:regioninfo is empty for row: content.20b16c29,,1208549961323; has keys: &lt;span class=&quot;error&quot;&gt;&amp;#91;info:server, info:serverstartcode&amp;#93;&lt;/span&gt;&lt;br/&gt;
08/04/18 17:26:48 WARN master.BaseScanner: Found 1 rows with empty HRegionInfo while scanning meta region .META.,,1&lt;br/&gt;
08/04/18 17:26:48 WARN master.HMaster: Removed region: content.20b16c29,,1208549&lt;br/&gt;
961323 from meta region: .META.,,1 because HRegionInfo was empty&lt;br/&gt;
08/04/18 17:26:48 INFO master.BaseScanner: RegionManager.metaScanner scan of meta region &lt;/p&gt;
{regionname: .META.,,1, startKey: &amp;lt;&amp;gt;, server: 10.30.94.37:60020}
&lt;p&gt; complete&lt;br/&gt;
08/04/18 17:26:48 INFO master.BaseScanner: all meta regions scanned&lt;/p&gt;

&lt;p&gt;yet finally the table disappears for a reason that does not appear in the logs... at least for this particular example. There is another table that is simply refusing to die...&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Linux CentOS 5.1 x86_64 / JDK 1.6.0_03&lt;/p&gt;</environment>
        <key id="12394349">HBASE-594</key>
            <summary>tables are being reassigned instead of deleted</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Apr 2008 23:06:38 +0000</created>
                <updated>Fri, 22 Aug 2008 21:35:05 +0000</updated>
                            <resolved>Tue, 22 Apr 2008 07:00:59 +0000</resolved>
                                    <version>0.2.0</version>
                                                    <component>master</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12591182" author="stack" created="Tue, 22 Apr 2008 03:01:24 +0000"  >&lt;p&gt;How loaded was your table?  How many regions?&lt;/p&gt;</comment>
                            <comment id="12591184" author="apurtell" created="Tue, 22 Apr 2008 03:14:33 +0000"  >&lt;p&gt;Not loaded at all. 1 region. No entries.&lt;/p&gt;

&lt;p&gt;Eventually the tables do disappear. I logged on to our cluster the following day and all zombie tables were gone. &lt;/p&gt;</comment>
                            <comment id="12591196" author="stack" created="Tue, 22 Apr 2008 04:39:05 +0000"  >&lt;p&gt;I just tried on 4 node cluster (not a 15 node cluster).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  --&amp;gt; create table &apos;x&apos; (&apos;x&apos;);
Table created successfully.
hql &amp;gt;
  --&amp;gt; show tables;
+--------------------------------------+--------------------------------------+
| Name                                 | Descriptor                           |
+--------------------------------------+--------------------------------------+
| x                                    | name: x, families: {x:={name: x, max |
|                                      | versions: 3, compression: NONE, in me|
|                                      | mory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, block cache enabled: fal|
|                                      | se, max length: 2147483647, bloom fil|
|                                      | ter: none}}                          |
+--------------------------------------+--------------------------------------+
1 table(s) in set. (0.02 sec)
hql &amp;gt; drop table &apos;x&apos;;
1 table(s) dropped successfully. (10.19 sec)
hql &amp;gt; show tables;
No tables found.
hql &amp;gt; select * from .META.;
0 row(s) in set. (0.05 sec) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What you think the difference is?&lt;/p&gt;</comment>
                            <comment id="12591226" author="apurtell" created="Tue, 22 Apr 2008 07:00:59 +0000"  >&lt;p&gt;Thanks for looking into this. I thought it was a reproductable bug but I was wrong. With your example, I was unable to reproduce the behavior I saw earlier. So, I went back and tried to reproduce the problem I saw earlier with the same schema as before and could not. &lt;/p&gt;

&lt;p&gt;Thinking about it further, I recall that between that time and now I restarted our cluster, and that during the shutdown the master would not quit normally.  I had to manually shut down the region servers using &quot;ssh hadoop@foo &apos;/path/to/hbase/bin/hbase-daemon.sh stop regionserver&apos;&quot; and then kill the master with kill -9. I&apos;m not sure how the master came to be in that bad state.&lt;/p&gt;

&lt;p&gt;If our cluster enters this state again, I will restart with DEBUG logging enabled and try to catch it again.&lt;/p&gt;</comment>
                            <comment id="12591361" author="stack" created="Tue, 22 Apr 2008 16:47:48 +0000"  >&lt;p&gt;Thread dumps when server is hung would be good to (You can do it from UI).  Thanks for reporiing (and cleaning up after you couldn&apos;t reproduce).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 22 Apr 2008 03:01:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25283</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 35 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h89j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98601</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>