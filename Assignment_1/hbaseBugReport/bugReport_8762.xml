<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:58:16 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8762/HBASE-8762.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8762] Performance/operational penalty when calling HTable.get with a list of one Get</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8762</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;There are two implications to calling HTable.get with a list of one Get.&lt;br/&gt;
1. The overhead of processBatch is paid unnecessarily, which is not insignificant.&lt;br/&gt;
2. The get requests show up as a &apos;multi&apos; when reviewing RPC handlers, when the request should just be a single Get.  It seems likely that there are other places in logs/ui it shows up as a multi as well.&lt;/p&gt;

&lt;p&gt;To give some context to the overhead, here are some timings performed by a member of our team:&lt;/p&gt;

&lt;p&gt;In a very simple test, of reading the same key 100 times, taking the time it took, and then repeating this 10 times (1000 total gets), the times are as follows (excluding the actual first iteration as there was considerable HBase warm-up times on the JVM for establishing connections):&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Iteration&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Batch (in ms)&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Single (in ms)&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2255&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;815&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;2&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1545&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;823&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;3&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1427&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;742&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;4&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1451&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;721&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;5&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1480&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;775&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;6&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1379&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;735&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;7&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1657&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;775&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;8&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1392&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;804&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;While I can see the argument that callers should use the single Get method signature, the cost implications are somewhat surprising and it&apos;s very easy to be smart in this case.  We simply need to have HTable.get(List&amp;lt;Get&amp;gt;) delegate to HTable.get(&amp;lt;Get&amp;gt;) if the list has one Get.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12653576">HBASE-8762</key>
            <summary>Performance/operational penalty when calling HTable.get with a list of one Get</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jasonbray">Jason Bray</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Jun 2013 21:28:52 +0000</created>
                <updated>Thu, 4 Jul 2013 22:10:03 +0000</updated>
                            <resolved>Wed, 19 Jun 2013 05:30:25 +0000</resolved>
                                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.95.2</fixVersion>
                    <fixVersion>0.94.9</fixVersion>
                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13687249" author="jasonbray" created="Tue, 18 Jun 2013 21:53:26 +0000"  >&lt;p&gt;Related and perhaps meaningful:  The HTableInterface get(List&amp;lt;Get&amp;gt;) signature claims this in its javadoc.&lt;/p&gt;

&lt;p&gt;&quot;If there are any failures even after retries, there will be a null in the results array for those Gets, AND an exception will be thrown.&quot;&lt;/p&gt;

&lt;p&gt;That&apos;s a confusing statement in this context, as the thread calling the get will either get an exception or a Result[] - not both.&lt;/p&gt;</comment>
                            <comment id="13687269" author="stack" created="Tue, 18 Jun 2013 22:08:33 +0000"  >&lt;p&gt;Patch looks good.  You think you should mod the javadoc then &lt;span class=&quot;error&quot;&gt;&amp;#91;~jabekb&amp;#93;&lt;/span&gt;?&lt;/p&gt;</comment>
                            <comment id="13687333" author="jasonbray" created="Tue, 18 Jun 2013 22:55:43 +0000"  >&lt;p&gt;Thanks for taking a look &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt;.  &lt;/p&gt;

&lt;p&gt;Regarding the javadoc of HTableInterface: I&apos;m happy to change it, but by bringing it up in this jira I may have confused the issue.  To be clear, the javadoc seems incorrect with or without the patch I&apos;ve provided.  The RetriesExhaustedWithDetailsException will be thrown and ascend the stack preventing the Result[] from being returned at all.  The javadoc change would simply be to have the statement read &quot;If there are any failures even after retries an exception will be thrown.&quot;.&lt;/p&gt;

&lt;p&gt;If we&apos;re in agreement, I can create a second jira with just that javadoc change or amend this patch to include both changes - whichever is most appropriate.&lt;/p&gt;</comment>
                            <comment id="13687351" author="stack" created="Tue, 18 Jun 2013 23:07:36 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;~jabekb&amp;#93;&lt;/span&gt; Thanks for clarification.  Yes, javadoc change is another issue.   Patch looks good to me.  Looks like it is 0.94 patch.  Mind making us a trunk one and I&apos;ll commit it?  Thanks.&lt;/p&gt;</comment>
                            <comment id="13687470" author="jasonbray" created="Wed, 19 Jun 2013 00:58:11 +0000"  >&lt;p&gt;Sounds good &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt;.  I have attached the trunk patch.  Thanks!&lt;/p&gt;</comment>
                            <comment id="13687626" author="stack" created="Wed, 19 Jun 2013 05:30:25 +0000"  >&lt;p&gt;Committed to 0.94, 0.95 and trunk.&lt;/p&gt;

&lt;p&gt;HadoopQA build is not working at mo even if I trigger it manually.  Asked mighty Giri.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Jason.  Nice one.&lt;/p&gt;</comment>
                            <comment id="13687725" author="hudson" created="Wed, 19 Jun 2013 07:29:18 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #172 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/172/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/172/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8762&quot; title=&quot;Performance/operational penalty when calling HTable.get with a list of one Get&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8762&quot;&gt;&lt;del&gt;HBASE-8762&lt;/del&gt;&lt;/a&gt; Performance/operational penalty when calling HTable.get with a list of one Get (Revision 1494462)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/HTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13687740" author="hudson" created="Wed, 19 Jun 2013 07:49:47 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #1017 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1017/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1017/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8762&quot; title=&quot;Performance/operational penalty when calling HTable.get with a list of one Get&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8762&quot;&gt;&lt;del&gt;HBASE-8762&lt;/del&gt;&lt;/a&gt; Performance/operational penalty when calling HTable.get with a list of one Get (Revision 1494462)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/HTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13687815" author="hudson" created="Wed, 19 Jun 2013 09:46:45 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #4188 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4188/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4188/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8762&quot; title=&quot;Performance/operational penalty when calling HTable.get with a list of one Get&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8762&quot;&gt;&lt;del&gt;HBASE-8762&lt;/del&gt;&lt;/a&gt; Performance/operational penalty when calling HTable.get with a list of one Get (Revision 1494460)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13687819" author="hudson" created="Wed, 19 Jun 2013 09:53:22 +0000"  >&lt;p&gt;Integrated in hbase-0.95 #250 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/250/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/250/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8762&quot; title=&quot;Performance/operational penalty when calling HTable.get with a list of one Get&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8762&quot;&gt;&lt;del&gt;HBASE-8762&lt;/del&gt;&lt;/a&gt; Performance/operational penalty when calling HTable.get with a list of one Get (Revision 1494461)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13687908" author="hudson" created="Wed, 19 Jun 2013 12:09:40 +0000"  >&lt;p&gt;Integrated in hbase-0.95-on-hadoop2 #137 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95-on-hadoop2/137/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95-on-hadoop2/137/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8762&quot; title=&quot;Performance/operational penalty when calling HTable.get with a list of one Get&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8762&quot;&gt;&lt;del&gt;HBASE-8762&lt;/del&gt;&lt;/a&gt; Performance/operational penalty when calling HTable.get with a list of one Get (Revision 1494461)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13687966" author="hudson" created="Wed, 19 Jun 2013 13:19:33 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #572 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/572/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/572/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8762&quot; title=&quot;Performance/operational penalty when calling HTable.get with a list of one Get&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8762&quot;&gt;&lt;del&gt;HBASE-8762&lt;/del&gt;&lt;/a&gt; Performance/operational penalty when calling HTable.get with a list of one Get (Revision 1494460)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/client/HTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12588506" name="HBASE-8672-trunk.patch" size="563" author="jasonbray" created="Wed, 19 Jun 2013 00:57:24 +0000"/>
                            <attachment id="12588461" name="HBASE-8762.patch" size="524" author="jasonbray" created="Tue, 18 Jun 2013 21:46:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Jun 2013 22:08:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>333853</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 26 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1llan:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>334180</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>