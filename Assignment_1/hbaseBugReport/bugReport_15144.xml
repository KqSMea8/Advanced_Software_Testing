<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:00:11 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-15144/HBASE-15144.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-15144] Procedure v2 - Web UI displaying Store state</title>
                <link>https://issues.apache.org/jira/browse/HBASE-15144</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The procedure webui page should show information about the WALProcedureStore.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;number/list/size of WALs active&lt;/li&gt;
	&lt;li&gt;we may extract the &quot;Sync wait %s, slotIndex=%s , totalSynced=%s (%s/sec)&quot; that today is only in LOG.trace()&lt;/li&gt;
	&lt;li&gt;we have a getMillisToNextPeriodicRoll() and getMillisFromLastRoll() if anyone want to see that&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12932930">HBASE-15144</key>
            <summary>Procedure v2 - Web UI displaying Store state</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12932920">HBASE-15141</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="asamir">Samir Ahmic</assignee>
                                    <reporter username="mbertozzi">Matteo Bertozzi</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Jan 2016 00:09:24 +0000</created>
                <updated>Fri, 26 Feb 2016 00:53:11 +0000</updated>
                            <resolved>Thu, 25 Feb 2016 18:55:09 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>proc-v2</component>
                    <component>UI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="15147275" author="asamir" created="Mon, 15 Feb 2016 12:17:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; maybe with some corrections and optimizations we can do something like this.&lt;/p&gt;</comment>
                            <comment id="15148697" author="mbertozzi" created="Tue, 16 Feb 2016 14:49:25 +0000"  >&lt;p&gt;yeah that look nice.&lt;br/&gt;
just get rid of the Map with string conversion since that code will be hot once we have the new AM. just use simple int/long vars and do the conversion in the webui code.&lt;br/&gt;
Slot Index has probably no meaning for the user rename it in something like &quot;last num of synced entries&quot;&lt;/p&gt;</comment>
                            <comment id="15149002" author="jmhsieh" created="Tue, 16 Feb 2016 18:10:41 +0000"  >&lt;p&gt;To make it a little clearer (by avoiding the overloaded word : &apos;Store&apos;) would it make sense to rename some of the headers:&lt;/p&gt;

&lt;p&gt;&quot;WAL Procedure store state&quot;&quot; -&amp;gt; &quot;Procedure WAL State&quot; &lt;/p&gt;

&lt;p&gt;and for the sub menus:&lt;br/&gt;
Store WAL files -&amp;gt; just &apos;WAL files&apos;?&lt;/p&gt;</comment>
                            <comment id="15150062" author="asamir" created="Wed, 17 Feb 2016 07:51:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmhsieh&quot; class=&quot;user-hover&quot; rel=&quot;jmhsieh&quot;&gt;Jonathan Hsieh&lt;/a&gt; thanks for review and suggestions. Let me do suggested changes and i will attach new patch&lt;/p&gt;</comment>
                            <comment id="15151945" author="asamir" created="Thu, 18 Feb 2016 08:35:03 +0000"  >&lt;p&gt;Here is new patch with suggested correction. &lt;/p&gt;</comment>
                            <comment id="15152520" author="mbertozzi" created="Thu, 18 Feb 2016 16:13:09 +0000"  >&lt;p&gt;one last change. &lt;br/&gt;
instead of totalSyncedUI = totalSynced.get(); you can assign totalSyncedUI when we do totalSynced.addAndGet(syncSlots());&lt;br/&gt;
we also have wal.getCorruptedLogs() you may display them as you do for wal.getActiveLogs()&lt;/p&gt;

&lt;p&gt;then you may move the 3 remaining syncWaitUI, slotIndexUI, syncedPerSecUI before the trace and use them in the LOG.trace() but this one is not really important since trace will be slow anyway.&lt;/p&gt;</comment>
                            <comment id="15152582" author="asamir" created="Thu, 18 Feb 2016 16:44:43 +0000"  >&lt;p&gt;Sure thing. All this changes make sense. Let me do the changes and i will add new patch.&lt;/p&gt;</comment>
                            <comment id="15154149" author="asamir" created="Fri, 19 Feb 2016 12:07:58 +0000"  >&lt;p&gt;Here is v2 displaying corrupted files and optimizing variables use. &lt;/p&gt;</comment>
                            <comment id="15154436" author="mbertozzi" created="Fri, 19 Feb 2016 16:12:29 +0000"  >&lt;p&gt;on the WAL roll time tab we should use StringUtils.humanTimeDiff() too.&lt;br/&gt;
at least we will have a more clear info than a cryptic 3579395 number&lt;/p&gt;</comment>
                            <comment id="15154439" author="mbertozzi" created="Fri, 19 Feb 2016 16:14:17 +0000"  >&lt;p&gt;also wandering if it is worth keep track of the last N sync stats (and maybe roll time)&lt;br/&gt;
just to have a bit more trace of what was going on&lt;/p&gt;</comment>
                            <comment id="15156778" author="asamir" created="Mon, 22 Feb 2016 11:06:01 +0000"  >&lt;p&gt;You are right 3579395 looks cryptic. I will change that to StringUtils.humanTimeDiff().&lt;/p&gt;</comment>
                            <comment id="15156799" author="asamir" created="Mon, 22 Feb 2016 11:34:44 +0000"  >&lt;p&gt;How do you propose that we implement this ? We can store limited number of values in procedure.jsp and display them in way that will more explanatory. &lt;/p&gt;</comment>
                            <comment id="15157128" author="mbertozzi" created="Mon, 22 Feb 2016 15:28:13 +0000"  >&lt;p&gt;I think the jsp pages are stateless. &lt;br/&gt;
to start with we should just make syncWaitUI, slotIndexUI, totalSyncedUI, syncedPerSecUI a circular buffer of 10 item or so (maybe add a conf hbase.procedure.store.wal.sync.stats.count) and then just display them with a for loop. the current page is good, but when I was looking at the page I realized that a single value does not have much meaning.&lt;br/&gt;
later we may add more stuff like an histogram, but for now a simple list of N items is ok.&lt;/p&gt;</comment>
                            <comment id="15158580" author="asamir" created="Tue, 23 Feb 2016 08:59:39 +0000"  >&lt;p&gt;Great thanks for suggestion. Let implement this with circular buffers and display multiple results on page. &lt;/p&gt;</comment>
                            <comment id="15163179" author="asamir" created="Wed, 24 Feb 2016 15:23:36 +0000"  >&lt;p&gt;Here is new patch with sync stats stored in circular buffer with size 10. Regarding WAL roll time i think is self explanatory we are displaying time when last roll time was happened and when next one will occur. Only alternative that i can think of is to show list of times when roll happened. Also we can add paragraph under &quot;Procedure WAL State&quot; table explaining in more details how procedure Store works and what some of parameters mean  like we do for regions in &quot;Regions&quot; table.  &lt;/p&gt;
</comment>
                            <comment id="15163773" author="mbertozzi" created="Wed, 24 Feb 2016 20:46:49 +0000"  >&lt;p&gt;attached v4, I changed a bunch of things to fix a problem where the wal size was always displaying 0, and I tried to remove some of the extra allocation of all the CircularBuffers (but this can be optimized further). &lt;br/&gt;
What do you think? if it is good for you I&apos;ll commit that. if you have other changes/improvements feel free to post another patch&lt;/p&gt;</comment>
                            <comment id="15166893" author="asamir" created="Thu, 25 Feb 2016 08:09:34 +0000"  >&lt;p&gt;I have tested patch against master branch. All looks good to me. +1 on commit.&lt;/p&gt;</comment>
                            <comment id="15167881" author="hudson" created="Thu, 25 Feb 2016 21:08:15 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #572 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/572/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/572/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15144&quot; title=&quot;Procedure v2 - Web UI displaying Store state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15144&quot;&gt;&lt;del&gt;HBASE-15144&lt;/del&gt;&lt;/a&gt; Procedure v2 - Web UI displaying Store state (matteo.bertozzi: rev 210ed97688a0aa18b5b337c14b5aa8eece77545f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/ProcedureWALFormatReader.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/ProcedureWALFormat.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/resources/hbase-webapps/master/procedures.jsp&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/ProcedureWALFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15168103" author="hudson" created="Thu, 25 Feb 2016 23:28:13 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #518 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/518/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/518/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15144&quot; title=&quot;Procedure v2 - Web UI displaying Store state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15144&quot;&gt;&lt;del&gt;HBASE-15144&lt;/del&gt;&lt;/a&gt; Procedure v2 - Web UI displaying Store state (matteo.bertozzi: rev 210ed97688a0aa18b5b337c14b5aa8eece77545f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/ProcedureWALFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/ProcedureWALFormatReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/resources/hbase-webapps/master/procedures.jsp&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/ProcedureWALFormat.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15168199" author="hudson" created="Fri, 26 Feb 2016 00:53:11 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-Trunk_matrix #738 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/738/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/738/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15144&quot; title=&quot;Procedure v2 - Web UI displaying Store state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15144&quot;&gt;&lt;del&gt;HBASE-15144&lt;/del&gt;&lt;/a&gt; Procedure v2 - Web UI displaying Store state (matteo.bertozzi: rev 40c55915e7a45a639adb7f7a370a04f38058ac26)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/ProcedureWALFormatReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/resources/hbase-webapps/master/procedures.jsp&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/WALProcedureStore.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/ProcedureWALFormat.java&lt;/li&gt;
	&lt;li&gt;hbase-procedure/src/main/java/org/apache/hadoop/hbase/procedure2/store/wal/ProcedureWALFile.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12789653" name="HBASE-15144-v4.patch" size="19479" author="mbertozzi" created="Wed, 24 Feb 2016 21:22:47 +0000"/>
                            <attachment id="12787925" name="HBASE-15144_v0.patch" size="9592" author="asamir" created="Mon, 15 Feb 2016 12:17:48 +0000"/>
                            <attachment id="12788413" name="HBASE-15144_v1.patch" size="9863" author="asamir" created="Thu, 18 Feb 2016 08:35:03 +0000"/>
                            <attachment id="12788669" name="HBASE-15144_v2.patch" size="11042" author="asamir" created="Fri, 19 Feb 2016 12:07:58 +0000"/>
                            <attachment id="12789576" name="HBASE-15144_v3.patch" size="14683" author="asamir" created="Wed, 24 Feb 2016 15:23:36 +0000"/>
                            <attachment id="12787926" name="WALStoreUI.png" size="194708" author="asamir" created="Mon, 15 Feb 2016 12:17:48 +0000"/>
                            <attachment id="12789647" name="store-ui-sync-stats.png" size="242298" author="mbertozzi" created="Wed, 24 Feb 2016 20:59:53 +0000"/>
                            <attachment id="12789654" name="store-ui-wals.png" size="138754" author="mbertozzi" created="Wed, 24 Feb 2016 21:23:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 15 Feb 2016 12:17:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2rrvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>