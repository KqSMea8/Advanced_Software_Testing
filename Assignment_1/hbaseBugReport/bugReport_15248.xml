<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:01:26 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-15248/HBASE-15248.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-15248] BLOCKSIZE 4k should result in 4096 bytes on disk; i.e. fit inside a BucketCache &apos;block&apos; of 4k</title>
                <link>https://issues.apache.org/jira/browse/HBASE-15248</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Chatting w/ a gentleman named Daniel Pol who is messing w/ bucketcache, he wants blocks to be the size specified in the configuration and no bigger. His hardware set ups fetches pages of 4k and so a block that has 4k of payload but has then a header and the header of the next block (which helps figure whats next when scanning) ends up being 4203 bytes or something, and this then then translates into two seeks per block fetch.&lt;/p&gt;

&lt;p&gt;This issue is about what it would take to stay inside our configured size boundary writing out blocks.&lt;/p&gt;

&lt;p&gt;If not possible, give back better signal on what to do so you could fit inside a particular constraint.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12938259">HBASE-15248</key>
            <summary>BLOCKSIZE 4k should result in 4096 bytes on disk; i.e. fit inside a BucketCache &apos;block&apos; of 4k</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12938047">HBASE-15240</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Feb 2016 18:01:56 +0000</created>
                <updated>Fri, 16 Dec 2016 20:34:29 +0000</updated>
                                                                            <component>BucketCache</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="15141671" author="stack" created="Wed, 10 Feb 2016 21:10:53 +0000"  >&lt;p&gt;Matteo noted that we should be clear that we are not trying to write perfectly aligned 4k pages on a device in this issue (hdfs and actual fs are in the way).&lt;/p&gt;</comment>
                            <comment id="15141789" author="stack" created="Wed, 10 Feb 2016 22:08:08 +0000"  >&lt;p&gt;Should note that Daniel is talking file-backed bucketcache, not blocks into hbase. Buckets are fixed size.&lt;/p&gt;</comment>
                            <comment id="15144130" author="ndimiduk" created="Fri, 12 Feb 2016 06:29:07 +0000"  >&lt;p&gt;To further confuse, I believe our alignment while serializing a block is calculated before compression is applied, not after. So if you have BLOCKSIZE=64k and COMPRESSION=GZ, you end up with something a lot smaller.&lt;/p&gt;</comment>
                            <comment id="15753974" author="anoop.hbase" created="Fri, 16 Dec 2016 09:54:14 +0000"  >&lt;p&gt;BC is having diff sized buckets and slots in it.  This sizes as per the possible HFile block sizes.  By def we consider 4K, 8K...  512K..  But we give an additional +1KB size for each of the bucket size and so to a slot..  So a 4K is actually becoming 5K.  And ya extra bytes are taken off by this cur header and next block header.&lt;br/&gt;
So right now u have removed the eager fetch of next block header right? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt;..&lt;br/&gt;
Still the cur block, header we will need?&lt;br/&gt;
Am trying to solve issues under the parent so that I can make &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-17204&quot; title=&quot;Make L2 off heap cache default ON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-17204&quot;&gt;HBASE-17204&lt;/a&gt; to happen.&lt;/p&gt;</comment>
                            <comment id="15755063" author="stack" created="Fri, 16 Dec 2016 17:51:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;So right now u have removed the eager fetch of next block header right? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No. I did not. On study, it would be too disruptive removing the fetch of the next block header: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-17185&quot; title=&quot;Purge the seek of the next block reading HFileBlocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-17185&quot;&gt;HBASE-17185&lt;/a&gt; &quot;Purge the seek of the next block reading HFileBlocks&quot; &lt;/p&gt;

&lt;p&gt;On this issue, the way we do sizing now &amp;#8211; i.e. we write bigger than what is configured &amp;#8211; is confusing. This issue should be about rationalizing this.&lt;/p&gt;</comment>
                            <comment id="15755447" author="ndimiduk" created="Fri, 16 Dec 2016 20:34:29 +0000"  >&lt;p&gt;Yeah we have a disconnect &amp;#8211; BLOCKSIZE doesn&apos;t take compression or encoding into account.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Feb 2016 06:29:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            26 minutes ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sogv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>