<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:40:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6871/HBASE-6871.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6871] HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6871</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;After writing some data, compaction and scan operation both failure, the exception message is below:&lt;br/&gt;
2012-09-18 06:32:26,227 ERROR org.apache.hadoop.hbase.regionserver.compactions.CompactionRequest: Compaction failed regionName=hfile_test,,1347778722498.d220df43fb9d8af4633bd7f547613f9e., storeName=page_info, fileCount=7, fileSize=1.3m (188.0k, 188.0k, 188.0k, 188.0k, 188.0k, 185.8k, 223.3k), priority=9, time=45826250816757428java.io.IOException: Could not reseek StoreFileScanner[HFileScanner for reader reader=hdfs://hadoopdev1.cm6:9000/hbase/hfile_test/d220df43fb9d8af4633bd7f547613f9e/page_info/b0f6118f58de47ad9d87cac438ee0895, compression=lzo, cacheConf=CacheConfig:enabled &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheDataOnRead=true&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheDataOnWrite=false&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheIndexesOnWrite=false&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheBloomsOnWrite=false&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheEvictOnClose=false&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheCompressed=false&amp;#93;&lt;/span&gt;, firstKey=&lt;a href=&quot;http://com.truereligionbrandjeans.www/Womens_Dresses/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Shirts/pl/c/Womens_Sweaters/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/4010.html/page_info:anchor_sig/1347764439449/DeleteColumn&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://com.truereligionbrandjeans.www/Womens_Dresses/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Shirts/pl/c/Womens_Sweaters/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Shirts/pl/c/Womens_Shirts/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/Womens_Sweaters/pl/c/4010.html/page_info:anchor_sig/1347764439449/DeleteColumn&lt;/a&gt;, lastKey=&lt;a href=&quot;http://com.trura.www//page_info:page_type/1347763395089/Put&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://com.trura.www//page_info:page_type/1347763395089/Put&lt;/a&gt;, avgKeyLen=776, avgValueLen=4, entries=12853, length=228611, cur=&lt;a href=&quot;http://com.truereligionbrandjeans.www/Womens_Exclusive_Details/pl/c/4970.html/page_info:is_deleted/1347764003865/Put/vlen=1/ts=0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://com.truereligionbrandjeans.www/Womens_Exclusive_Details/pl/c/4970.html/page_info:is_deleted/1347764003865/Put/vlen=1/ts=0&lt;/a&gt;] to key &lt;a href=&quot;http://com.truereligionbrandjeans.www/Womens_Exclusive_Details/pl/c/4970.html/page_info:is_deleted/OLDEST_TIMESTAMP/Minimum/vlen=0/ts=0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://com.truereligionbrandjeans.www/Womens_Exclusive_Details/pl/c/4970.html/page_info:is_deleted/OLDEST_TIMESTAMP/Minimum/vlen=0/ts=0&lt;/a&gt;&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.StoreFileScanner.reseek(StoreFileScanner.java:178)        &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.NonLazyKeyValueScanner.doRealSeek(NonLazyKeyValueScanner.java:54)        &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.KeyValueHeap.generalizedSeek(KeyValueHeap.java:299)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.KeyValueHeap.reseek(KeyValueHeap.java:244)        &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.StoreScanner.reseek(StoreScanner.java:521)        &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.StoreScanner.next(StoreScanner.java:402)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Store.compactStore(Store.java:1570)        &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Store.compact(Store.java:997)        &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.compact(HRegion.java:1216)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.compactions.CompactionRequest.run(CompactionRequest.java:250)        &lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)        &lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;br/&gt;
Caused by: java.io.IOException: Expected block type LEAF_INDEX, but got INTERMEDIATE_INDEX: blockType=INTERMEDIATE_INDEX, onDiskSizeWithoutHeader=8514, uncompressedSizeWithoutHeader=131837, prevBlockOffset=-1, dataBeginsWith=\x00\x00\x00\x9B\x00\x00\x00\x00\x00\x00\x03#\x00\x00\x050\x00\x00\x08\xB7\x00\x00\x0Cr\x00\x00\x0F\xFA\x00\x00\x120, fileOffset=218942        at org.apache.hadoop.hbase.io.hfile.HFileReaderV2.validateBlockType(HFileReaderV2.java:378)&lt;br/&gt;
        at org.apache.hadoop.hbase.io.hfile.HFileReaderV2.readBlock(HFileReaderV2.java:331)        at org.apache.hadoop.hbase.io.hfile.HFileBlockIndex$BlockIndexReader.seekToDataBlock(HFileBlockIndex.java:213)&lt;br/&gt;
        at org.apache.hadoop.hbase.io.hfile.HFileReaderV2$AbstractScannerV2.seekTo(HFileReaderV2.java:455)&lt;br/&gt;
        at org.apache.hadoop.hbase.io.hfile.HFileReaderV2$AbstractScannerV2.reseekTo(HFileReaderV2.java:493)        &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.StoreFileScanner.reseekAtOrAfter(StoreFileScanner.java:242)        &lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.StoreFileScanner.reseek(StoreFileScanner.java:167)&lt;/p&gt;

&lt;p&gt;After some debug works&#65292;I found that when hfile closing, if the rootChunk is empty, the only one curInlineChunk will upgrade to root chunk. But if the last block flushing make curInlineChunk exceed max index block size, the root chunk(upgrade from curInlineChunk) will be splited into intermediate index blocks, and the index level is set to 2. So when BlockIndexReader read the root index, it expects the next level index block is leaf index(index level=2), but the on disk index block is intermediate block, the error happened. &lt;/p&gt;

&lt;p&gt;After I add some code to check curInlineChunk&apos;s size when rootChunk is empty in shouldWriteBlock(boolean closing), this bug can be fixed.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;redhat 5u4&lt;/p&gt;</environment>
        <key id="12608848">HBASE-6871</key>
            <summary>HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikhail">Mikhail Bautin</assignee>
                                    <reporter username="feng wang">Feng Wang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Sep 2012 09:59:09 +0000</created>
                <updated>Sun, 7 Apr 2013 05:04:09 +0000</updated>
                            <resolved>Sat, 29 Sep 2012 04:12:26 +0000</resolved>
                                    <version>0.94.1</version>
                                    <fixVersion>0.94.2</fixVersion>
                                    <component>HFile</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>16</watches>
                                                                <comments>
                            <comment id="13461710" author="xieliang007" created="Mon, 24 Sep 2012 10:15:46 +0000"  >&lt;p&gt;Hi Feng, attached patch is not well-formed,  please refer to &lt;a href=&quot;http://hbase.apache.org/book.html#submitting.patches&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/book.html#submitting.patches&lt;/a&gt;  to generate a valid diff file, thanks&lt;/p&gt;</comment>
                            <comment id="13461802" author="ram_krish" created="Mon, 24 Sep 2012 13:58:42 +0000"  >&lt;p&gt;@Feng&lt;br/&gt;
Any testcase is possible to reproduce the problem ? Thanks for your patch and analysis BTW.&lt;/p&gt;</comment>
                            <comment id="13461841" author="feng wang" created="Mon, 24 Sep 2012 14:51:54 +0000"  >&lt;p&gt;generate this patch in 0.94.1 branch&lt;/p&gt;</comment>
                            <comment id="13461858" author="feng wang" created="Mon, 24 Sep 2012 15:28:40 +0000"  >&lt;p&gt;To reproduce this bug, first you need to create a table with a family named page_info, then bulkload these *.hfile in attachment, finally you can force a compact to see this bug happen&lt;/p&gt;</comment>
                            <comment id="13461866" author="feng wang" created="Mon, 24 Sep 2012 15:38:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;&lt;br/&gt;
if you want to reproduce the bug in writing/flusing hfile, you can use HFileScanner to scan these *.hfile to send the kv in them to the table again, then force a flush one by one, then you can get the same number hfiles in page_info directory, whose index block would be error. &lt;/p&gt;</comment>
                            <comment id="13461895" author="lhofhansl" created="Mon, 24 Sep 2012 16:31:25 +0000"  >&lt;p&gt;Want to have a look &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mikhail&quot; class=&quot;user-hover&quot; rel=&quot;mikhail&quot;&gt;Mikhail Bautin&lt;/a&gt;?&lt;/p&gt;

&lt;p&gt;@Feng: Any chance for an automated test case?&lt;/p&gt;</comment>
                            <comment id="13462374" author="feng wang" created="Tue, 25 Sep 2012 02:38:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=abecam&quot; class=&quot;user-hover&quot; rel=&quot;abecam&quot;&gt;Alain Becam&lt;/a&gt;&lt;br/&gt;
because this bug is caused by some special data and flushing in our crawler system, so I can&apos;t construct these data manually in ut. I write a ImportHFile java class and a test_hfile_block_index.sh script to read the error files and send the put/delete kv to test table. Please compile the ImportHFile class and download the hfiles in attachment to a local directory, then run the test_hfile_block_index.sh, you can see the bug in regionserver log    &lt;/p&gt;</comment>
                            <comment id="13464056" author="mikhail" created="Wed, 26 Sep 2012 18:54:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=feng+wang&quot; class=&quot;user-hover&quot; rel=&quot;feng wang&quot;&gt;Feng Wang&lt;/a&gt;: nice catch! My understanding of this bug is somewhat different from yours, though. There are no new data blocks being written after shouldWriteBlock(true) is called when closing an HFileWriterV2. What I think is happening is that a new block gets written and a new entry is added to the root index right before writeInlineBlocks(true) is called in HFileWriterV2.close. If the &quot;closing&quot; parameter was set to false, a new leaf-level block would have been written at this point. However, as you described, the current index chunk gets promoted to a root index and then split into intermediate index blocks, which is incorrect, because in this case there are no leaf index blocks.&lt;/p&gt;

&lt;p&gt;I think your patch fixes this particular issue, but another issue remains. We use different formats for non-root and root index blocks, and the non-root index format is slightly more space-efficient. Thus, it is still possible that the current index chunk is promoted to become the root index chunk because its &quot;non-root&quot; size is under the configured index chunk size, but its &quot;root&quot; size turns out to be above the configured index chunk size, so we create intermediate blocks in writeIndexBlocks and run into the same problem.&lt;/p&gt;

&lt;p&gt;I think the correct solution is that once we decide to promote the index chunk to the root chunk, we should never split it into intermediate blocks. That will fix both issues. I will try to come up with a test and a patch today.&lt;/p&gt;</comment>
                            <comment id="13464138" author="mikhail" created="Wed, 26 Sep 2012 20:26:02 +0000"  >&lt;p&gt;Actually, the non-root index format is more space-efficient than the root index format, but this bug appears to happen when keys are sufficiently large (such as in this case--long URLs) to simultaneously push both of these sizes beyond the chunk size. I have a unit test that reproduces this, will upload a patch soon.&lt;/p&gt;</comment>
                            <comment id="13464143" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 20:33:07 +0000"  >&lt;p&gt;mbautin requested code review of &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Test case to reproduce block index corruption&quot;.&lt;br/&gt;
Reviewers: lhofhansl, Kannan, Liyin, stack, JIRA&lt;/p&gt;

&lt;p&gt;  A small test case to reproduce an incorrect HFile generated when an inline index chunk is promoted to root chunk under some circumstances.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  Run test, ensure that it fails without the fix&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/13389/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/13389/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464150" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 20:39:07 +0000"  >&lt;p&gt;Kannan has accepted the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Test case to reproduce block index corruption&quot;.&lt;/p&gt;

&lt;p&gt;  nice test!&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  repro_interm_index_bug&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464208" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 21:47:07 +0000"  >&lt;p&gt;stack has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Test case to reproduce block index corruption&quot;.&lt;/p&gt;

&lt;p&gt;  Nice test Mikhail.   You might consider explaining in a comment why 7 kvs of the type in the test bring on the issue (unless you think it fine just pointing at the issue).&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  repro_interm_index_bug&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464250" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 22:29:07 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Test case to reproduce block index corruption&quot;.&lt;br/&gt;
Reviewers: lhofhansl, Kannan, Liyin, stack, JIRA&lt;/p&gt;

&lt;p&gt;  Addressing Michael&apos;s comments.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464251" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 22:31:07 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Test case to reproduce block index corruption&quot;.&lt;br/&gt;
Reviewers: lhofhansl, Kannan, Liyin, stack, JIRA&lt;/p&gt;

&lt;p&gt;  Fix the comment&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464253" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 22:33:07 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Test case to reproduce block index corruption&quot;.&lt;br/&gt;
Reviewers: lhofhansl, Kannan, Liyin, stack, JIRA&lt;/p&gt;

&lt;p&gt;  Fixing confusing loop&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464263" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 22:51:07 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Block index corruption test case and fix&quot;.&lt;br/&gt;
Reviewers: lhofhansl, Kannan, Liyin, stack, JIRA&lt;/p&gt;

&lt;p&gt;  Adding the bugfix.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464265" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 22:59:07 +0000"  >&lt;p&gt;lhofhansl has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Block index corruption test case and fix&quot;.&lt;/p&gt;

&lt;p&gt;  Can&apos;t pretend to fully understands what going on in the test, but if it reproduces the problem that&apos;s perfect. Thanks for doing this Mikhail.&lt;/p&gt;

&lt;p&gt;  The fix is different from the one proposed on the issue.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:988 Are these expected exceptional cases?&lt;br/&gt;
  If not, should we have asserts instead?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  repro_interm_index_bug_v7&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464350" author="phabricator@reviews.facebook.net" created="Thu, 27 Sep 2012 01:35:07 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Block index corruption test case and fix&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:988 I could have thrown AssertionErrors but I think these exceptions are more specific. If the index writer is configured as a single-level-only, then the operation of writing inline blocks is unsupported. If curInlineChunk is nul, that means this function has been called with closing=true and calling it again in this state is illegal.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  repro_interm_index_bug_v7&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464390" author="phabricator@reviews.facebook.net" created="Thu, 27 Sep 2012 03:17:07 +0000"  >&lt;p&gt;mbautin has closed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Block index corruption test case and fix&quot;.&lt;/p&gt;

&lt;p&gt;CHANGED PRIOR TO COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703?vs=18759&amp;amp;id=18765#differential-review-toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703?vs=18759&amp;amp;id=18765#differential-review-toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5703&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1390819&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1390819&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: lhofhansl, Kannan, Liyin, stack, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13464459" author="stack" created="Thu, 27 Sep 2012 05:30:06 +0000"  >&lt;p&gt;Forward port of Mikhails&apos; 0.89-fb patch.  Minor changes using getDataTestDir instead of getTestDir in test and I added categorization (Small &amp;#8211; it ran in 3seconds when I tested it).&lt;/p&gt;</comment>
                            <comment id="13464496" author="lhofhansl" created="Thu, 27 Sep 2012 06:34:45 +0000"  >&lt;p&gt;Patch looks good (as far as I can tell, I&apos;ll trust Mikhail on the initial version).&lt;br/&gt;
I&apos;ll make a 0.94 patch tomorrow.&lt;/p&gt;</comment>
                            <comment id="13464501" author="yuzhihong@gmail.com" created="Thu, 27 Sep 2012 06:50:17 +0000"  >&lt;p&gt;I assume this bug needs to be fixed in 0.92 branch as well.&lt;/p&gt;</comment>
                            <comment id="13464533" author="feng wang" created="Thu, 27 Sep 2012 07:47:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mikhail&quot; class=&quot;user-hover&quot; rel=&quot;mikhail&quot;&gt;Mikhail Bautin&lt;/a&gt;&#65306;Your explanation is helpful for me, my patch can only solve this particular issue, the difference between root size and nonroot size of BlockIndexChunk maybe trigger this bug again, I will use the new patch to resolve my issue completely, thank you!&lt;/p&gt;</comment>
                            <comment id="13464931" author="stack" created="Thu, 27 Sep 2012 18:03:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=feng+wang&quot; class=&quot;user-hover&quot; rel=&quot;feng wang&quot;&gt;Feng Wang&lt;/a&gt; Does this patch fix your issue?  If you run your script that manufactures this condition, with this patch in place, do we no longer throw the exception reported?   Thanks.&lt;/p&gt;</comment>
                            <comment id="13465033" author="lhofhansl" created="Thu, 27 Sep 2012 20:09:54 +0000"  >&lt;p&gt;The trunk patch applies to 0.94 as well (with some offsets), so that&apos;s fine. I assume the same will be true for 0.92.&lt;/p&gt;</comment>
                            <comment id="13465072" author="yuzhihong@gmail.com" created="Thu, 27 Sep 2012 20:47:26 +0000"  >&lt;p&gt;Patch for 0.92&lt;br/&gt;
When I ran the new test, I got the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2012-09-27 00:07:40,223 DEBUG [main] hfile.HFileWriterV2(192): Initialized with CacheConfig:enabled [cacheDataOnRead=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;] [cacheDataOnWrite=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;] [cacheIndexesOnWrite=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;] [cacheBloomsOnWrite=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;] [cacheEvictOnClose=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;] [cacheCompressed=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;]

Key: key00000_48495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147

Key: key00001_48495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147

Key: key00002_48495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147

Key: key00003_48495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147

2012-09-27 00:07:40,257 WARN  [main] fs.ChecksumFileSystem$ChecksumFSInputChecker(142): Problem opening checksum file: /Users/zhihyu/92hbase/target/test-data/647b36e2-aa0e-4a97-8443-989725a4c0df/TestHFileInlineToRootChunkConversion.hfile.  Ignoring exception: java.io.EOFException
  at java.io.DataInputStream.readFully(DataInputStream.java:180)
  at java.io.DataInputStream.readFully(DataInputStream.java:152)
  at org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSInputChecker.&amp;lt;init&amp;gt;(ChecksumFileSystem.java:134)
  at org.apache.hadoop.fs.ChecksumFileSystem.open(ChecksumFileSystem.java:283)
  at org.apache.hadoop.fs.FileSystem.open(FileSystem.java:427)
  at org.apache.hadoop.hbase.io.hfile.HFile.createReader(HFile.java:438)
  at org.apache.hadoop.hbase.io.hfile.TestHFileInlineToRootChunkConversion.testWriteHFile(TestHFileInlineToRootChunkConversion.java:77)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Investigation is under way.&lt;/p&gt;</comment>
                            <comment id="13465115" author="yuzhihong@gmail.com" created="Thu, 27 Sep 2012 21:26:17 +0000"  >&lt;p&gt;Patch v2 passes the new test.&lt;/p&gt;

&lt;p&gt;Running test suite for 0.92&lt;/p&gt;</comment>
                            <comment id="13465125" author="yuzhihong@gmail.com" created="Thu, 27 Sep 2012 21:33:14 +0000"  >&lt;p&gt;All HFile related tests passed for 0.92 patch v2:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Running org.apache.hadoop.hbase.io.hfile.TestHFile
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.824 sec
Running org.apache.hadoop.hbase.io.hfile.TestHFileBlock
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 24.716 sec
Running org.apache.hadoop.hbase.io.hfile.TestHFileBlockIndex
Tests run: 10, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 6.972 sec
Running org.apache.hadoop.hbase.io.hfile.TestHFileInlineToRootChunkConversion
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.489 sec
Running org.apache.hadoop.hbase.io.hfile.TestHFilePerformance
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.803 sec
Running org.apache.hadoop.hbase.io.hfile.TestHFileReaderV1
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.472 sec
Running org.apache.hadoop.hbase.io.hfile.TestHFileSeek
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.701 sec
Running org.apache.hadoop.hbase.io.hfile.TestHFileWriterV2
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.823 sec
Running org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat
Tests run: 8, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 178.295 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13465149" author="lhofhansl" created="Thu, 27 Sep 2012 22:03:18 +0000"  >&lt;p&gt;0.94 patch. Passes the new test.&lt;/p&gt;</comment>
                            <comment id="13465339" author="apurtell" created="Fri, 28 Sep 2012 04:25:59 +0000"  >&lt;p&gt;+1 Latest trunk and 0.94 patches lgtm provided they pass the new test (and they do it is claimed).&lt;/p&gt;</comment>
                            <comment id="13465506" author="feng wang" created="Fri, 28 Sep 2012 10:17:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;,the new patch can really fix my issue, my test script has successfully imported the hfiles in the attachment without any exception.  &lt;/p&gt;</comment>
                            <comment id="13466046" author="hadoopqa" created="Sat, 29 Sep 2012 00:23:17 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12546916/6871-0.94.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12546916/6871-0.94.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2963//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2963//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13466097" author="stack" created="Sat, 29 Sep 2012 03:52:51 +0000"  >&lt;p&gt;What I committed (v1 wouldnt&apos; apply &amp;#8211; missing SmallTests import).&lt;/p&gt;</comment>
                            <comment id="13466099" author="stack" created="Sat, 29 Sep 2012 04:02:57 +0000"  >&lt;p&gt;What I committed.... removed Category.&lt;/p&gt;</comment>
                            <comment id="13466100" author="hadoopqa" created="Sat, 29 Sep 2012 04:03:23 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12547092/6871v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12547092/6871v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2964//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2964//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13466101" author="hudson" created="Sat, 29 Sep 2012 04:07:28 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3393 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3393/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3393/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks (Revision 1391741)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13466103" author="yuzhihong@gmail.com" created="Sat, 29 Sep 2012 04:11:24 +0000"  >&lt;p&gt;0.92 test suite showed one test failure: TestReplication#queueFailover which is not related to this JIRA.&lt;/p&gt;

&lt;p&gt;Integrated to 0.92 branch.&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Mikhail&lt;/p&gt;</comment>
                            <comment id="13466104" author="stack" created="Sat, 29 Sep 2012 04:12:26 +0000"  >&lt;p&gt;Committed to 0.94 and trunk.  Ted seems to have committed to 0.92.  Thanks for patch Mikhail.  Thanks for testing and test case Fenng.&lt;/p&gt;</comment>
                            <comment id="13466110" author="hudson" created="Sat, 29 Sep 2012 04:54:26 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #496 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/496/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/496/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks (Revision 1391742)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13466114" author="lhofhansl" created="Sat, 29 Sep 2012 05:18:36 +0000"  >&lt;p&gt;@Stack: Did you forget to add the test in the 0.94v2 version?&lt;/p&gt;</comment>
                            <comment id="13466115" author="lhofhansl" created="Sat, 29 Sep 2012 05:20:14 +0000"  >&lt;p&gt;Also we have Test Categories in 0.94, right? I tested the patch I attached (i.e. compiled, ran the test, etc).&lt;/p&gt;</comment>
                            <comment id="13466126" author="hudson" created="Sat, 29 Sep 2012 06:18:58 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #586 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/586/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/586/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; Add TestHFileInlineToRootChunkConversion (Revision 1391751)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks (Mikhail) (Revision 1391750)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13466183" author="hudson" created="Sat, 29 Sep 2012 11:19:00 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #199 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/199/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/199/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks (Revision 1391741)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13466303" author="stack" created="Sat, 29 Sep 2012 20:41:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; Looks like its in there if I do svn diff -r1391284:1391742.  Hmm... yeah, my fault, 0.94 has categories.  Let me put it back.&lt;/p&gt;</comment>
                            <comment id="13466304" author="stack" created="Sat, 29 Sep 2012 20:41:45 +0000"  >&lt;p&gt;The addendum I committed adding back SmallTest category.&lt;/p&gt;</comment>
                            <comment id="13466311" author="stack" created="Sat, 29 Sep 2012 21:01:46 +0000"  >&lt;p&gt;A second addendum.  I forgot to import Category.  Hopefully thats it.&lt;/p&gt;</comment>
                            <comment id="13466337" author="hudson" created="Sat, 29 Sep 2012 22:02:33 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #498 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/498/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/498/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM2 REAPPLICATION (Revision 1391879)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM2 OVERCOMMIT (Revision 1391878)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM2 (Revision 1391877)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM (Revision 1391869)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/pom.xml&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/pom.xml&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13467516" author="hudson" created="Tue, 2 Oct 2012 06:06:22 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #58 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/58/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/58/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM2 REAPPLICATION (Revision 1391879)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM2 OVERCOMMIT (Revision 1391878)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM2 (Revision 1391877)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM (Revision 1391869)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks (Revision 1391742)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/pom.xml&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/pom.xml&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13469877" author="hudson" created="Fri, 5 Oct 2012 00:37:46 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #8 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/8/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/8/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM2 REAPPLICATION (Revision 1391879)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM2 OVERCOMMIT (Revision 1391878)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM2 (Revision 1391877)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks; ADDENDUM (Revision 1391869)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks (Revision 1391742)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/pom.xml&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/pom.xml&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13469995" author="hudson" created="Fri, 5 Oct 2012 02:59:34 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #143 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/143/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/143/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; Add TestHFileInlineToRootChunkConversion (Revision 1391751)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6871&quot; title=&quot;HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6871&quot;&gt;&lt;del&gt;HBASE-6871&lt;/del&gt;&lt;/a&gt; HFileBlockIndex Write Error in HFile V2 due to incorrect split into intermediate index blocks (Mikhail) (Revision 1391750)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileInlineToRootChunkConversion.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13624695" author="stack" created="Sun, 7 Apr 2013 05:04:09 +0000"  >&lt;p&gt;Fix up after bulk move overwrote some 0.94.2 fix versions w/ 0.95.0 (Noticed by Lars Hofhansl)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12546313" name="428a400628ae412ca45d39fce15241fd.hfile" size="228611" author="feng wang" created="Mon, 24 Sep 2012 15:28:40 +0000"/>
                            <attachment id="12546916" name="6871-0.94.txt" size="6339" author="lhofhansl" created="Thu, 27 Sep 2012 22:03:18 +0000"/>
                            <attachment id="12547093" name="6871-0.94v2.txt" size="2210" author="stack" created="Sat, 29 Sep 2012 04:02:57 +0000"/>
                            <attachment id="12546909" name="6871-hfile-index-0.92-v2.txt" size="8536" author="yuzhihong@gmail.com" created="Thu, 27 Sep 2012 21:26:17 +0000"/>
                            <attachment id="12546901" name="6871-hfile-index-0.92.txt" size="8646" author="yuzhihong@gmail.com" created="Thu, 27 Sep 2012 20:47:26 +0000"/>
                            <attachment id="12547127" name="6871.094.addendum.txt" size="789" author="stack" created="Sat, 29 Sep 2012 20:41:45 +0000"/>
                            <attachment id="12547129" name="6871.094.addendum2.txt" size="695" author="stack" created="Sat, 29 Sep 2012 21:01:46 +0000"/>
                            <attachment id="12546811" name="6871.txt" size="6375" author="stack" created="Thu, 27 Sep 2012 05:30:06 +0000"/>
                            <attachment id="12547092" name="6871v2.txt" size="6427" author="stack" created="Sat, 29 Sep 2012 03:52:51 +0000"/>
                            <attachment id="12546312" name="787179746cc347ce9bb36f1989d17419.hfile" size="191468" author="feng wang" created="Mon, 24 Sep 2012 15:28:40 +0000"/>
                            <attachment id="12546314" name="960a026ca370464f84903ea58114bc75.hfile" size="192528" author="feng wang" created="Mon, 24 Sep 2012 15:28:40 +0000"/>
                            <attachment id="12546737" name="D5703.1.patch" size="3175" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 20:33:07 +0000"/>
                            <attachment id="12546763" name="D5703.2.patch" size="3900" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 22:29:07 +0000"/>
                            <attachment id="12546764" name="D5703.3.patch" size="3905" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 22:31:07 +0000"/>
                            <attachment id="12546765" name="D5703.4.patch" size="3893" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 22:33:07 +0000"/>
                            <attachment id="12546769" name="D5703.5.patch" size="6070" author="phabricator@reviews.facebook.net" created="Wed, 26 Sep 2012 22:51:07 +0000"/>
                            <attachment id="12546428" name="ImportHFile.java" size="3444" author="feng wang" created="Tue, 25 Sep 2012 02:39:01 +0000"/>
                            <attachment id="12546315" name="d0026fa8d59b4df291718f59dd145aad.hfile" size="190299" author="feng wang" created="Mon, 24 Sep 2012 15:28:40 +0000"/>
                            <attachment id="12546308" name="hbase-6871-0.94.patch" size="722" author="feng wang" created="Mon, 24 Sep 2012 15:06:12 +0000"/>
                            <attachment id="12546429" name="test_hfile_block_index.sh" size="521" author="feng wang" created="Tue, 25 Sep 2012 02:39:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 24 Sep 2012 10:15:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240877</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i016p3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4854</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>HFile HFileBlockIndex BlockIndexWriter</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>