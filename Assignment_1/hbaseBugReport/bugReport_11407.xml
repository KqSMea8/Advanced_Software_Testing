<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:22:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11407/HBASE-11407.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11407] hbase-client should not require Jackson for pure HBase queries be executed </title>
                <link>https://issues.apache.org/jira/browse/HBASE-11407</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Including the hbase-client module dependency and excluding Jackson dependencies causes the pure HBase query (run with HTableInterface) fail with Jackson ObjectMapper ClassNotFoundException. &lt;/p&gt;

&lt;p&gt;This is due to org.apache.hadoop.hbase.client.Operation having ObjectMapper statically initialized.&lt;/p&gt;

&lt;p&gt;Moving ObjectMapper to a dedicated utility will help. The patch will be attached.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12723328">HBASE-11407</key>
            <summary>hbase-client should not require Jackson for pure HBase queries be executed </summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sergey_beryozkin">Sergey Beryozkin</assignee>
                                    <reporter username="sergey_beryozkin">Sergey Beryozkin</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Jun 2014 10:01:53 +0000</created>
                <updated>Sat, 21 Feb 2015 23:34:27 +0000</updated>
                            <resolved>Wed, 25 Jun 2014 23:37:29 +0000</resolved>
                                    <version>0.98.3</version>
                                    <fixVersion>0.99.0</fixVersion>
                    <fixVersion>0.98.4</fixVersion>
                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="14041936" author="sergey_beryozkin" created="Tue, 24 Jun 2014 10:04:04 +0000"  >&lt;p&gt;The patch introduces a simple JsonMapper utility and updates Operation to delegate to JsonMapper if needed&lt;/p&gt;</comment>
                            <comment id="14041958" author="nkeywal" created="Tue, 24 Jun 2014 10:35:38 +0000"  >&lt;p&gt;Who is calling this method? We can&apos;t just remove it from the client to simplify our dependencies?&lt;br/&gt;
If we don&apos;t remove it from the pom, or add a specific test, anyone can add the dependency back in any innocent patch (ok, transitive dependencies make this easy to break anyway, but still).&lt;/p&gt;

&lt;p&gt;process-wise, we will need the patch for master as well (I&apos;ve just checked, it contains this toJSON stuff as well...)&lt;/p&gt;

&lt;p&gt;The master says &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-comment&quot;&gt;// TODO make &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; configurable
&lt;/span&gt;  &lt;span class=&quot;code-comment&quot;&gt;// TODO Do we need &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; anymore now we have protobuffed it all?&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think we can just remove all this (from the client at least). &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt;, wdyt?&lt;/p&gt;</comment>
                            <comment id="14041965" author="sergey_beryozkin" created="Tue, 24 Jun 2014 10:55:19 +0000"  >&lt;p&gt;The patch is not about removing the dependency in hbase-client pom.xml, it simply moves Jackson ObjectMapper static initialization into a dedicated utility: this will let those consumers of HBase Client API who do not expect to do any sort of JSON formatting exclude Jackson dependency in their own poms. In my case it is the Apache CXF server where not all users may want to have Jackson dependencies.&lt;/p&gt;

&lt;p&gt;Removing it completely as per the comment may be a better solution but I guess it is more sensitive solution and may take longer to be done.&lt;/p&gt;</comment>
                            <comment id="14041977" author="nkeywal" created="Tue, 24 Jun 2014 11:23:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;, it simply moves Jackson ObjectMapper static initialization into a dedicated utility&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, I saw that. That&apos;s what I&apos;m saying it may break again at any time. In this case I think that just removing the dependency is better as it lowers the complexity instead of increasing it... It could be an issue for 0.98 (interface change) but should be done for master as a part of this patch imho.&lt;/p&gt;</comment>
                            <comment id="14042001" author="sergey_beryozkin" created="Tue, 24 Jun 2014 11:36:17 +0000"  >&lt;p&gt;IMHO you are over complicating it. This is not a bug fix, when you say it will &apos;break again&apos; it is just confusing. Your claim it is about increasing the complexity is also not accurate. The patch moves the ObjectMapper only on the path where it might be needed, i.e, on to toJson(...) code path. Right now it is needed no matter what, whether toJson will be called or not.&lt;/p&gt;</comment>
                            <comment id="14042002" author="sergey_beryozkin" created="Tue, 24 Jun 2014 11:38:50 +0000"  >&lt;p&gt;+1 though to dropping the dependency if you and other experts prefer it. AFAIK HBase client requiring a dependency is not a problem for me as long as it can be optionally excluded which is what this patch supports &lt;/p&gt;</comment>
                            <comment id="14042013" author="nkeywal" created="Tue, 24 Jun 2014 11:55:45 +0000"  >&lt;p&gt;Yeah that&apos;s what I prefer. Except if it&apos;s actually used somewhere then yes we have to pay the cost, but the extra dependency in the hbase client does not justify it.  We should not workaround our dependencies (I do understand that you don&apos;t care much as you have an immediate issue to solve, but on the long term it&apos;s better for all of us). I&apos;m +1 for your patch if we remove the dep in the master.&lt;/p&gt;</comment>
                            <comment id="14042016" author="sergey_beryozkin" created="Tue, 24 Jun 2014 11:59:09 +0000"  >&lt;p&gt;Hi, you are right. Sorry for being too defensive about my patch. I&apos;m happy the issue is visible now to people who understand HBase better than I do &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; so one way or another it will optimized. &lt;/p&gt;

&lt;p&gt;Thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="14042102" author="nkeywal" created="Tue, 24 Jun 2014 13:34:30 +0000"  >&lt;p&gt;No worries &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; . &lt;br/&gt;
Let&apos;s wait for the bay area to wake up, we will see what the others say. Would you be ok to remove the dependency in the master if we go this way? If so I can add you as a contributor and assign you this jira.&lt;/p&gt;</comment>
                            <comment id="14042178" author="sergey_beryozkin" created="Tue, 24 Jun 2014 14:36:02 +0000"  >&lt;p&gt;Sure, I&apos;d be up for it. But I can see Operation.toString() documentation says that a JSON representation is created by default so I&apos;m not sure how sensitive would it be to remove the dependency.&lt;/p&gt;</comment>
                            <comment id="14042222" author="nkeywal" created="Tue, 24 Jun 2014 15:13:07 +0000"  >&lt;p&gt;Then we will just remove the comment about &apos;Do we need this anymore&apos; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14042345" author="apurtell" created="Tue, 24 Jun 2014 16:47:58 +0000"  >&lt;p&gt;IIRC this is used for the slow operation logging in IPC tracing on the server. Since we retain the Jackson dep for the server package this change should be fine. Please include a note in Javadoc for Operation#toJSON that it won&apos;t work any more unless the application has Jackson on the classpath. Curious if others think this is an issue with backwards compat. &lt;/p&gt;</comment>
                            <comment id="14042346" author="apurtell" created="Tue, 24 Jun 2014 16:50:07 +0000"  >&lt;p&gt;Also the diff on this issue is missing any POM changes that remove Jackson deps. Assume those are warranted. Let&apos;s get another patch up with all of the necessary changes and run it through HadoopQA?&lt;/p&gt;</comment>
                            <comment id="14042367" author="nkeywal" created="Tue, 24 Jun 2014 17:01:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;IIRC this is used for the slow operation logging in IPC tracing on the server.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yeah, I&apos;ve checked, you&apos;re right, toString() is used in a few logs. Not anymore for slowOperation: the rpcServer uses its own json mapper. But we should not log anyway as it&apos;s a security issue  (iirc it&apos;s now correct in the slowOperation and does not expose any potentially private field). &lt;/p&gt;</comment>
                            <comment id="14042688" author="sergey_beryozkin" created="Tue, 24 Jun 2014 21:10:23 +0000"  >&lt;p&gt;The reason pom.xml is not updated is that the goal of the patch was to let consumers of hbase-client who do pure HBase queries and wishing to optimize their dependencies exclude Jackson in their own poms.&lt;br/&gt;
As far as I understand it may still be needed in certain cases. So I guess the dependency needs to stay for now, with a provided patch most users will be able to exclude it if they want to. I&apos;m not sure making the dependency optional is the right solution given that it is still used on some code paths (logging): one may say that a number of users who currently depend on Jackson is at least no less than a number of users like me who want to exclude it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;br/&gt;
Thanks, Sergey &lt;/p&gt;



</comment>
                            <comment id="14042761" author="nkeywal" created="Tue, 24 Jun 2014 22:03:27 +0000"  >&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
If we remove the dependency from the pom w/o removing ot from the code, the tools around maven dependency will complain. I&apos;m not a fan. Andrew, what do you think of just removing the &quot;feature&quot; in .99?&lt;/p&gt;</comment>
                            <comment id="14042777" author="stack" created="Tue, 24 Jun 2014 22:18:33 +0000"  >&lt;p&gt;@nkeywal toJSON on all Objects?  Its not used any more as you note.  Kinda nice to have but if needed, if we just make the Operations implement beans, we can provide JSON with an external util class.  I&apos;d be good stripping it from this base, important class that is shared client and server-side.&lt;/p&gt;</comment>
                            <comment id="14042862" author="apurtell" created="Tue, 24 Jun 2014 23:54:39 +0000"  >&lt;p&gt;I agree with Stack&lt;/p&gt;</comment>
                            <comment id="14042869" author="stack" created="Wed, 25 Jun 2014 00:04:34 +0000"  >&lt;p&gt;To finish, I&apos;d be good w/ committing &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;Sergey Beryozkin&lt;/a&gt; patch for now and doing the JSON stripping in another patch.&lt;/p&gt;</comment>
                            <comment id="14044154" author="apurtell" created="Wed, 25 Jun 2014 22:53:03 +0000"  >&lt;p&gt;Committing shortly to 0.98 and master, just testing locally first.&lt;/p&gt;</comment>
                            <comment id="14044307" author="hudson" created="Thu, 26 Jun 2014 03:21:28 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #338 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/338/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/338/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11407&quot; title=&quot;hbase-client should not require Jackson for pure HBase queries be executed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11407&quot;&gt;&lt;del&gt;HBASE-11407&lt;/del&gt;&lt;/a&gt; hbase-client should not require Jackson for pure HBase queries be executed (Sergey Beryozkin) (apurtell: rev 460880f890676a1282a147dc6e07c29c1fab3a13)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/util/JsonMapper.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/client/Operation.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14044313" author="hudson" created="Thu, 26 Jun 2014 03:35:01 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98 #358 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/358/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/358/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11407&quot; title=&quot;hbase-client should not require Jackson for pure HBase queries be executed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11407&quot;&gt;&lt;del&gt;HBASE-11407&lt;/del&gt;&lt;/a&gt; hbase-client should not require Jackson for pure HBase queries be executed (Sergey Beryozkin) (apurtell: rev 460880f890676a1282a147dc6e07c29c1fab3a13)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/client/Operation.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/util/JsonMapper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14044346" author="hudson" created="Thu, 26 Jun 2014 04:47:54 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #5237 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5237/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5237/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11407&quot; title=&quot;hbase-client should not require Jackson for pure HBase queries be executed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11407&quot;&gt;&lt;del&gt;HBASE-11407&lt;/del&gt;&lt;/a&gt; hbase-client should not require Jackson for pure HBase queries be executed (Sergey Beryozkin) (apurtell: rev cb9a6d1073327cbfd8dfaf8b38cb06128eb02f3e)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/util/JsonMapper.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/client/Operation.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14331212" author="enis" created="Sat, 21 Feb 2015 23:34:27 +0000"  >&lt;p&gt;Closing this issue after 0.99.0 release. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12652174" name="diff.txt" size="3580" author="sergey_beryozkin" created="Tue, 24 Jun 2014 10:04:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 24 Jun 2014 10:35:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>401515</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1x41j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>401588</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>