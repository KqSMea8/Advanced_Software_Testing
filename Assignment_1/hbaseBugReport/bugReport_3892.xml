<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:14:02 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3892/HBASE-3892.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3892] Table can&apos;t disable</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3892</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In TimeoutMonitor : &lt;br/&gt;
if node exists and node state is RS_ZK_REGION_CLOSED&lt;br/&gt;
We should send a zk message again when close region is timeout.&lt;br/&gt;
in this case, It may be loss some message.&lt;/p&gt;


&lt;p&gt;I See. It seems like a bug. This is my analysis.&lt;/p&gt;

&lt;p&gt;// disable table and master sent Close message to region server, Region state was set PENDING_CLOSE&lt;/p&gt;

&lt;p&gt;2011-05-08 17:44:25,745 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Sent CLOSE to serverName=C4C4.site,60020,1304820199467, load=(requests=0, regions=123, usedHeap=4097, maxHeap=8175) for region ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66.&lt;br/&gt;
2011-05-08 17:44:45,530 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:45:45,542 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;/p&gt;

&lt;p&gt;// received splitting message and cleared Region state (PENDING_CLOSE)&lt;/p&gt;

&lt;p&gt;2011-05-08 17:46:45,303 WARN org.apache.hadoop.hbase.master.AssignmentManager: Overwriting 4418fb197685a21f77e151e401cf8b66 on serverName=C4C4.site,60020,1304820199467, load=(requests=0, regions=123, usedHeap=4097, maxHeap=8175)&lt;br/&gt;
2011-05-08 17:46:45,538 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:47:45,548 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:48:45,545 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:49:46,108 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:50:46,105 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:51:46,117 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:52:46,112 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:52:47,309 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/4418fb197685a21f77e151e401cf8b66 and set watcher; region=ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66., server=C4C4.site,60020,1304820199467, state=RS_ZK_REGION_CLOSED&lt;br/&gt;
2011-05-08 17:52:47,388 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling new unassigned node: /hbase/unassigned/4418fb197685a21f77e151e401cf8b66 (region=ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66., server=C4C4.site,60020,1304820199467, state=RS_ZK_REGION_CLOSED)&lt;br/&gt;
2011-05-08 17:52:47,388 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=RS_ZK_REGION_CLOSED, server=C4C4.site,60020,1304820199467, region=4418fb197685a21f77e151e401cf8b66&lt;/p&gt;

&lt;p&gt;// region server had closed region, but the region state had cleared. So it printed warning log.&lt;/p&gt;

&lt;p&gt;2011-05-08 17:52:47,388 WARN org.apache.hadoop.hbase.master.AssignmentManager: Received CLOSED for region 4418fb197685a21f77e151e401cf8b66 from server C4C4.site,60020,1304820199467 but region was in  the state null and not in expected PENDING_CLOSE or CLOSING states&lt;br/&gt;
2011-05-08 17:52:47,397 WARN org.apache.hadoop.hbase.master.AssignmentManager: Overwriting 4418fb197685a21f77e151e401cf8b66 on serverName=C4C4.site,60020,1304820199467, load=(requests=0, regions=123, usedHeap=4097, maxHeap=8175)&lt;/p&gt;

&lt;p&gt;// The region state was set PENDING_CLOSE again.  the table couldn&apos;t disable and enable.&lt;br/&gt;
2011-05-08 17:52:47,398 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. (offlining)&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12507436">HBASE-3892</key>
            <summary>Table can&apos;t disable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sunnygao">gaojinchao</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 May 2011 01:27:53 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:28 +0000</updated>
                            <resolved>Fri, 10 Jun 2011 21:58:12 +0000</resolved>
                                    <version>0.90.3</version>
                                    <fixVersion>0.90.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13035620" author="stack" created="Wed, 18 May 2011 19:50:29 +0000"  >&lt;p&gt;FYI, we write else like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;rather than like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
}
&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;
{
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Not important though.&lt;/p&gt;

&lt;p&gt;Since the below&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; node = ZKAssign.getNodeName(watcher,
+                             regionInfo.getEncodedName());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;is used by the if and the else, maybe it would make sense to get this before we do the if or else?&lt;/p&gt;

&lt;p&gt;The message here is wrong?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+                          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (data.getEventType() != EventType.RS_ZK_REGION_CLOSED) {
+                             LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Region has transitioned to CLOEING, allowing &quot;&lt;/span&gt; +
+                                  &lt;span class=&quot;code-quote&quot;&gt;&quot;watched event handlers to process&quot;&lt;/span&gt;);
+                             &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can you say for sure the region is in CLOSING state?  Maybe its in some other state altogether?&lt;/p&gt;

&lt;p&gt;The below is not a good idea.  The master is setting a state that is only usually set by the regionserver:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+                         data = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RegionTransitionData(
+                                 EventType.RS_ZK_REGION_CLOSED, regionInfo.getRegionName(),
+                                    master.getServerName());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Do you have to make a new RTD here?  Can&apos;t you use the one you just decoded a few lines earlier?&lt;/p&gt;

&lt;p&gt;And why are you calling a setData on this with an upped version number?&lt;/p&gt;

&lt;p&gt;I think I understand now what you are trying to fix.  It looks like a genuine issue to  me and a patch like this one is needed.  Thanks for working on this Gao.&lt;/p&gt;</comment>
                            <comment id="13036724" author="sunnygao" created="Fri, 20 May 2011 08:41:28 +0000"  >&lt;p&gt;I am not familiar with zk api and have learned it now. I make a patch again. &lt;br/&gt;
I want to use api &quot;setData(ZooKeeperWatcher zkw, String znode,&lt;br/&gt;
      byte [] data)&quot;. It seems dangerous for parallel operation. &lt;br/&gt;
I want to verify more carefully in next week.&lt;/p&gt;</comment>
                            <comment id="13040048" author="sunnygao" created="Fri, 27 May 2011 04:16:47 +0000"  >&lt;p&gt;I finished test, please review it. Thanks&lt;/p&gt;</comment>
                            <comment id="13040269" author="stack" created="Fri, 27 May 2011 14:55:17 +0000"  >&lt;p&gt;Gao:&lt;/p&gt;

&lt;p&gt;Half of this patch is white space changes.  Can you make it so you do not disturb existing code?  (It looks like you left-shifted a bunch of code by one space).&lt;/p&gt;

&lt;p&gt;My original review would seem to apply to this version of the patch (Am I reviewing the same patch?).  You are having the master do a setData.  In particular, you are having the master do a setData of state RS_ZK_REGION_CLOSED.  Only the regionserver does this usually.  If the master does it, and somehow the regionserver does it too around the same time, then you have introduced a race condition.&lt;/p&gt;
</comment>
                            <comment id="13040564" author="sunnygao" created="Sat, 28 May 2011 09:21:46 +0000"  >&lt;p&gt;I see, Regionserver do a setData with adding version number. Hmaster refresh the data only. and stat.RS_ZK_REGION_CLOSED is last state that shouldn&apos;t be update.&lt;br/&gt;
It seems no a race condition. &lt;br/&gt;
Hmaster do a setdata of state RS_ZK_REGION_CLOSED is not good method.&lt;br/&gt;
I try to find other method to deal with this case. But It seems diffcult to do. &lt;/p&gt;</comment>
                            <comment id="13041536" author="sunnygao" created="Tue, 31 May 2011 11:56:21 +0000"  >&lt;p&gt;Hi, Stack. I made a mistake above analysis.&lt;br/&gt;
I read the code again, The root reason is spliting message repeated. &lt;/p&gt;

&lt;p&gt;2011-05-08 17:42:45,514 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;/p&gt;

&lt;p&gt;//Closed the region.&lt;br/&gt;
2011-05-08 17:43:37,599 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. (offlining)&lt;/p&gt;

&lt;p&gt;2011-05-08 17:43:45,525 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;/p&gt;

&lt;p&gt;// set RIT state and sent a message &lt;br/&gt;
2011-05-08 17:44:25,745 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Sent CLOSE to serverName=C4C4.site,60020,1304820199467, load=(requests=0, regions=123, usedHeap=4097, maxHeap=8175) for region ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66.&lt;/p&gt;

&lt;p&gt;//Received split message again and RIT was deleted . So it could not process closed event.&lt;/p&gt;

&lt;p&gt;2011-05-08 17:44:45,530 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:45:45,542 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;/p&gt;

&lt;p&gt;//&lt;br/&gt;
2011-05-08 17:46:45,303 WARN org.apache.hadoop.hbase.master.AssignmentManager: Overwriting 4418fb197685a21f77e151e401cf8b66 on serverName=C4C4.site,60020,1304820199467, load=(requests=0, regions=123, usedHeap=4097, maxHeap=8175)&lt;br/&gt;
2011-05-08 17:46:45,538 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:47:45,548 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:48:45,545 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:49:46,108 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:50:46,105 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:51:46,117 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:52:46,112 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:52:47,309 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/4418fb197685a21f77e151e401cf8b66 and set watcher; region=ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66., server=C4C4.site,60020,1304820199467, state=RS_ZK_REGION_CLOSED&lt;br/&gt;
2011-05-08 17:52:47,388 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling new unassigned node: /hbase/unassigned/4418fb197685a21f77e151e401cf8b66 (region=ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66., server=C4C4.site,60020,1304820199467, state=RS_ZK_REGION_CLOSED)&lt;br/&gt;
2011-05-08 17:52:47,388 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=RS_ZK_REGION_CLOSED, server=C4C4.site,60020,1304820199467, region=4418fb197685a21f77e151e401cf8b66&lt;br/&gt;
2011-05-08 17:52:47,388 WARN org.apache.hadoop.hbase.master.AssignmentManager: Received CLOSED for region 4418fb197685a21f77e151e401cf8b66 from server C4C4.site,60020,1304820199467 but region was in  the state null and not in expected PENDING_CLOSE or CLOSING states&lt;br/&gt;
2011-05-08 17:52:47,397 WARN org.apache.hadoop.hbase.master.AssignmentManager: Overwriting 4418fb197685a21f77e151e401cf8b66 on serverName=C4C4.site,60020,1304820199467, load=(requests=0, regions=123, usedHeap=4097, maxHeap=8175)&lt;/p&gt;</comment>
                            <comment id="13042050" author="sunnygao" created="Wed, 1 Jun 2011 08:59:45 +0000"  >&lt;p&gt;I keep digging, find the repeated message was sent by region server.&lt;/p&gt;

&lt;p&gt;If regionServerReport throwed exception, Region server will connect Hmaster again and send message again.&lt;/p&gt;

&lt;p&gt;//region server logs.&lt;br/&gt;
2011-05-08 17:43:45,507 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:44:45,521 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:45:45,524 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:46:45,528 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:47:45,531 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:48:45,535 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:49:46,091 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:50:46,096 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:51:46,099 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:52:46,104 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;/p&gt;

&lt;p&gt;//region server code.&lt;br/&gt;
List&amp;lt;HMsg&amp;gt; tryRegionServerReport(final List&amp;lt;HMsg&amp;gt; outboundMessages)&lt;br/&gt;
  throws IOException {&lt;br/&gt;
    this.serverInfo.setLoad(buildServerLoad());&lt;br/&gt;
    this.requestCount.set(0);&lt;br/&gt;
    addOutboundMsgs(outboundMessages);&lt;br/&gt;
    HMsg [] msgs = null;&lt;br/&gt;
    while (!this.stopped) {&lt;br/&gt;
      try &lt;/p&gt;
{
        msgs = this.hbaseMaster.regionServerReport(this.serverInfo,   
          outboundMessages.toArray(HMsg.EMPTY_HMSG_ARRAY),
          getMostLoadedRegions());
        break;
      }
&lt;p&gt; catch (IOException ioe) {&lt;br/&gt;
        if (ioe instanceof RemoteException) &lt;/p&gt;
{
          ioe = ((RemoteException)ioe).unwrapRemoteException();
        }
&lt;p&gt;        if (ioe instanceof YouAreDeadException) &lt;/p&gt;
{
          // This will be caught and handled as a fatal error in run()
          throw ioe;
        }
&lt;p&gt;        // Couldn&apos;t connect to the master, get location from zk and reconnect&lt;br/&gt;
        // Method blocks until new master is found or we are stopped&lt;br/&gt;
        getMaster();&lt;br/&gt;
      }&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;Why did regionServerReport throw exception ?&lt;/p&gt;

&lt;p&gt;It seems Hmaster was busy and IPC blocked. &lt;/p&gt;

&lt;p&gt;Hmaster logs:&lt;br/&gt;
2011-05-08 17:44:25,745 WARN org.apache.hadoop.ipc.HBaseServer: IPC Server Responder, call regionServerReport(serverName=C4C4.site,60020,1304820199467, load=(requests=0, regions=123, usedHeap=4097, maxHeap=8175), [Lorg.apache.hadoop.hbase.HMsg;@520ed128, [Lorg.apache.hadoop.hbase.HRegionInfo;@4ac5c32e) from 157.5.100.4:50187: output error&lt;br/&gt;
2011-05-08 17:44:25,745 WARN org.apache.hadoop.ipc.HBaseServer: IPC Server handler 11 on 60000 caught: java.nio.channels.ClosedChannelException&lt;br/&gt;
	at sun.nio.ch.SocketChannelImpl.ensureWriteOpen(SocketChannelImpl.java:126)&lt;br/&gt;
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:324)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer.channelWrite(HBaseServer.java:1341)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Responder.processResponse(HBaseServer.java:727)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Responder.doRespond(HBaseServer.java:792)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1083)&lt;/p&gt;
</comment>
                            <comment id="13042062" author="sunnygao" created="Wed, 1 Jun 2011 09:38:35 +0000"  >&lt;p&gt;patch(AssignmentManager_90v2) looks like benefit.  Thanks.&lt;/p&gt;</comment>
                            <comment id="13042441" author="jdcryans" created="Wed, 1 Jun 2011 21:16:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why did regionServerReport throw exception ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;My guess is that it was a 60 seconds timeout, unfortunately we don&apos;t print it. Could you add that to your patch?&lt;/p&gt;

&lt;p&gt;Also regarding the patch, could you create a unit test that sends a double report of a split and then verifies that the second one didn&apos;t screw up anything? &lt;/p&gt;

&lt;p&gt;Also fix this line:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;//if Daughters has online, do nothing&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;to&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;// if one daughter is already online, do nothing&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;And then maybe add more context to the error message, like &quot;Trying to process the split of region_foo, but it was already done and one daughter is on region server regionserver_bar&quot;.&lt;/p&gt;</comment>
                            <comment id="13042715" author="sunnygao" created="Thu, 2 Jun 2011 11:47:20 +0000"  >&lt;p&gt;I am not familiar with unit test(It seems diffult to send a double report of a split and test cluster function). So&lt;br/&gt;
I verified it by modified region server code.&lt;/p&gt;

&lt;p&gt;Logs:&lt;br/&gt;
2011-06-02 19:57:49,056 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr2,8613816508215#1308,1307014802589.c5a8a47d9c84f417b9fcc4c8019e7c7e.: Daughters; ufdr2,8613816508215#1308,1307015867020.37481173e31ea469bcaa310cf8d7d980., ufdr2,8613816595415#3432,1307015867020.afbf02ef235cabe66026f7c393d79bc0. from C4C4.site,60020,1307015130114&lt;br/&gt;
2011-06-02 19:57:49,057 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x30502c278f0000 Unable to get data of znode /hbase/unassigned/c5a8a47d9c84f417b9fcc4c8019e7c7e because node does not exist (not necessarily an error)&lt;br/&gt;
2011-06-02 19:57:49,081 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr2,8613816508215#1308,1307014802589.c5a8a47d9c84f417b9fcc4c8019e7c7e.: Daughters; ufdr2,8613816508215#1308,1307015867020.37481173e31ea469bcaa310cf8d7d980., ufdr2,8613816595415#3432,1307015867020.afbf02ef235cabe66026f7c393d79bc0. from C4C4.site,60020,1307015130114&lt;br/&gt;
2011-06-02 19:57:49,083 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x30502c278f0000 Unable to get data of znode /hbase/unassigned/c5a8a47d9c84f417b9fcc4c8019e7c7e because node does not exist (not necessarily an error)&lt;br/&gt;
2011-06-02 19:57:49,083 WARN org.apache.hadoop.hbase.master.AssignmentManager: Trying to process the split of 37481173e31ea469bcaa310cf8d7d980, but it was already done and one daughter is on region server serverName=C4C4.site,60020,1307015130114, load=(requests=0, regions=0, usedHeap=0, maxHeap=0)&lt;br/&gt;
2011-06-02 19:57:56,468 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr2,8613819021840#1446,1307014756068.f865d41d918297f30b576b9ea3ccea07.: Daughters; ufdr2,8613819021840#1446,1307015873554.baa21e4f0cfa5840f009d0fac8e83d15., ufdr2,8613819104397#3916,1307015873554.fb63f608e5e37f5e85d71c925bc78010. from C4C3.site,60020,1307015129703&lt;br/&gt;
2011-06-02 19:57:56,470 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x30502c278f0000 Unable to get data of znode /hbase/unassigned/f865d41d918297f30b576b9ea3ccea07 because node does not exist (not necessarily an error)&lt;br/&gt;
2011-06-02 19:57:56,472 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr2,8613819021840#1446,1307014756068.f865d41d918297f30b576b9ea3ccea07.: Daughters; ufdr2,8613819021840#1446,1307015873554.baa21e4f0cfa5840f009d0fac8e83d15., ufdr2,8613819104397#3916,1307015873554.fb63f608e5e37f5e85d71c925bc78010. from C4C3.site,60020,1307015129703&lt;br/&gt;
2011-06-02 19:57:56,474 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x30502c278f0000 Unable to get data of znode /hbase/unassigned/f865d41d918297f30b576b9ea3ccea07 because node does not exist (not necessarily an error)&lt;br/&gt;
2011-06-02 19:57:56,474 WARN org.apache.hadoop.hbase.master.AssignmentManager: Trying to process the split of baa21e4f0cfa5840f009d0fac8e83d15, but it was already done and one daughter is on region server serverName=C4C3.site,60020,1307015129703, load=(requests=0, regions=0, usedHeap=0, maxHeap=0)&lt;/p&gt;


&lt;p&gt;Thanks for your hint. It should be a 60 seconds timeout. Region server repeated message about 60s.&lt;/p&gt;

&lt;p&gt;2011-05-08 17:43:45,507 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:44:45,521 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;/p&gt;

&lt;p&gt;It seems a race with regionsInTransition. So IPC was blocked. I try to reproduce it.&lt;/p&gt;

&lt;p&gt;Hmaster logs:  It recieved so much message RS_ZK_REGION_CLOSED. &lt;br/&gt;
2011-05-08 17:43:45,157 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/83c05d9ead23d9a260edf30dc8739cf7 and set watcher; region=ufdr,2011050802#8613815394007#0610,1304847545412.83c05d9ead23d9a260edf30dc8739cf7., server=C4C4.site,60020,1304820199467, state=RS_ZK_REGION_CLOSING&lt;br/&gt;
2011-05-08 17:43:45,525 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: ufdr,2011050812#8613817306227#0516,1304845660567.8e9a3b05abe1c3a692999cf5e8dfd9dd.: Daughters; ufdr,2011050812#8613817306227#0516,1304847764729.5e4bca85c33fa6605ffc9a5c2eb94e62., ufdr,2011050812#8613817398167#4032,1304847764729.4418fb197685a21f77e151e401cf8b66. from C4C4.site,60020,1304820199467&lt;br/&gt;
2011-05-08 17:43:48,943 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/5e3bacf3f43b6bad874e80c2f971e632 and set watcher; region=ufdr,2011050803#8613819042855#3419,1304844562298.5e3bacf3f43b6bad874e80c2f971e632., server=C4C5.site,60020,1304820199469, state=RS_ZK_REGION_CLOSED&lt;br/&gt;
2011-05-08 17:43:50,777 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/aaddc1ecd4ab768357b3a44df6828e23 and set watcher; region=ufdr,2011050810#8613815306434#1853,1304823564447.aaddc1ecd4ab768357b3a44df6828e23., server=C4C5.site,60020,1304820199469, state=RS_ZK_REGION_CLOSED&lt;br/&gt;
2011-05-08 17:43:53,219 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/6bf4788ea7349a62967b6781b37cf157 and set watcher; region=ufdr,2011050802#8613816510664#5948,1304842169086.6bf4788ea7349a62967b6781b37cf157., server=C4C4.site,60020,1304820199467, state=RS_ZK_REGION_CLOSED&lt;br/&gt;
2011-05-08 17:43:55,812 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/3decca49c2dbc3f8a9d49f192b747b12 and set watcher; region=ufdr,2011050801#8613819767209#4733,1304837619424.3decca49c2dbc3f8a9d49f192b747b12., server=C4C3.site,60020,1304820199474, state=RS_ZK_REGION_CLOSED&lt;br/&gt;
2011-05-08 17:43:56,722 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/49cec92a2e7dd6d8ef38aab6128b29f8 and set watcher; region=ufdr,2011050802#8613815474662#2305,1304847545412.49cec92a2e7dd6d8ef38aab6128b29f8., server=C4C4.site,60020,1304820199467, state=RS_ZK_REGION_CLOSED&lt;br/&gt;
2011-05-08 17:44:01,382 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/fcaaff18b3afa53e2bae3c9eb7b3aca2 and set watcher; region=ufdr,2011050803#8613819212381#4006,1304845030265.fcaaff18b3afa53e2bae3c9eb7b3aca2., server=C4C5.site,60020,1304820199469, state=RS_ZK_REGION_CLOSED&lt;br/&gt;
2011-05-08 17:44:01,383 DEBUG org.apache.hadoop.hbase.zookeeper.ZKUtil: master:60000-0x22fcd582836003d Retrieved 125 byte(s) of data from znode /hbase/unassigned/6fa30b1a2352e36e0b5c9272b61e17cf and set watcher; region=ufdr,2011050801#8613818694123#3028,1304847154793.6fa30b1a2352e36e0b5c9272b61e17cf., server=C4C4.site,60020,1304820199467, state=RS_ZK_REGION_CLOSED&lt;/p&gt;


</comment>
                            <comment id="13045885" author="subbaswathi" created="Wed, 8 Jun 2011 10:26:54 +0000"  >&lt;p&gt;is this got fixed in hbase 0.90.4?&lt;/p&gt;</comment>
                            <comment id="13045889" author="sunnygao" created="Wed, 8 Jun 2011 10:31:30 +0000"  >&lt;p&gt;No, It need review and merge. &lt;/p&gt;</comment>
                            <comment id="13046337" author="sunnygao" created="Thu, 9 Jun 2011 04:24:21 +0000"  >&lt;p&gt;Hi J-D,&lt;br/&gt;
I have created a unit test and verified it. Please review it and give me some suggesion.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="13046381" author="stack" created="Thu, 9 Jun 2011 08:02:21 +0000"  >&lt;p&gt;Gao:&lt;/p&gt;

&lt;p&gt;So, help me out:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions) {         
+      &lt;span class=&quot;code-comment&quot;&gt;//one daughter is already online, &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; nothing
&lt;/span&gt;+      HServerInfo hsia = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions.get(a);
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (hsia != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;){
+        LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Trying to process the split of &quot;&lt;/span&gt; +a.getEncodedName()+ &lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt; +
+          &lt;span class=&quot;code-quote&quot;&gt;&quot;but it was already done and one daughter is on region server &quot;&lt;/span&gt; + hsia);
+        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
+      }
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;How would the daughter region be on line already?  We are sending the split message multiple times?  I see it above in a comment but am not clear why this would happen.&lt;/p&gt;

&lt;p&gt;Is it because master was not letting messages in?  The regionserver failed to deliver its report so it retried?  But in actuality the report HAD been delivered and it is just a case that the regionserver didn&apos;t wait long enough?&lt;/p&gt;

&lt;p&gt;Patch looks good.  Just want to be clear on what we think its fixing (As J-D said, do you have some log snippet from regionserver when it fails to deliver the report?  Is there a timeout in there?).&lt;/p&gt;
</comment>
                            <comment id="13047117" author="sunnygao" created="Fri, 10 Jun 2011 10:15:05 +0000"  >&lt;p&gt;It didn&apos;t reproduce. So, My guess J-D is right. Below logs shows that:&lt;/p&gt;

&lt;p&gt;Region server repeated message an interval of 60s. So It should be IPC timeout.&lt;br/&gt;
2011-05-08 17:43:45,507 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:44:45,521 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:45:45,524 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;br/&gt;
2011-05-08 17:46:45,528 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Connected to master at C4C1.site:60000&lt;/p&gt;

&lt;p&gt;Hmaster logs shows regionServerReport IPC had been closed.  It also proved IPC timeout&lt;/p&gt;

&lt;p&gt;2011-05-08 17:52:47,703 WARN org.apache.hadoop.ipc.HBaseServer: IPC Server Responder, call regionServerReport(serverName=C4C3.site,60020,1304820199474, load=(requests=0, regions=55, usedHeap=1058, maxHeap=8175), [Lorg.apache.hadoop.hbase.HMsg;@1453ecec, [Lorg.apache.hadoop.hbase.HRegionInfo;@11e78461) from 157.5.100.3:37518: output error&lt;br/&gt;
2011-05-08 17:52:47,704 WARN org.apache.hadoop.ipc.HBaseServer: IPC Server handler 7 on 60000 caught: java.nio.channels.ClosedChannelException&lt;br/&gt;
	at sun.nio.ch.SocketChannelImpl.ensureWriteOpen(SocketChannelImpl.java:126)&lt;br/&gt;
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:324)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer.channelWrite(HBaseServer.java:1341)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Responder.processResponse(HBaseServer.java:727)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Responder.doRespond(HBaseServer.java:792)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1083)&lt;/p&gt;

&lt;p&gt;But I can&apos;t dig the root reason. &lt;/p&gt;</comment>
                            <comment id="13047492" author="stack" created="Fri, 10 Jun 2011 21:58:12 +0000"  >&lt;p&gt;Applied to branch.  I talked to J-D and we need to be able to handle double-split  messages however they arise.&lt;/p&gt;

&lt;p&gt;This patch won&apos;t work for TRUNK.  Its changed too much.  Will need something like this in TRUNK.&lt;/p&gt;</comment>
                            <comment id="13048448" author="sunnygao" created="Mon, 13 Jun 2011 02:47:18 +0000"  >&lt;p&gt;TRUNK don&apos;t need. It has modified for zk watcher.&lt;/p&gt;

&lt;p&gt;Below code should protect this case.&lt;br/&gt;
// RegionState must be null, or SPLITTING or PENDING_CLOSE.&lt;br/&gt;
if (!isInStateForSplitting(regionState)) break;&lt;/p&gt;</comment>
                            <comment id="13048904" author="stack" created="Mon, 13 Jun 2011 23:56:58 +0000"  >&lt;p&gt;@Gao Thanks for the info.&lt;/p&gt;</comment>
                            <comment id="15016985" author="lars_francke" created="Fri, 20 Nov 2015 12:41:28 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12481220" name="AssignmentManager_90v3.patch" size="1555" author="sunnygao" created="Thu, 2 Jun 2011 11:48:16 +0000"/>
                            <attachment id="12481887" name="AssignmentManager_90v4.patch" size="2451" author="sunnygao" created="Thu, 9 Jun 2011 04:20:46 +0000"/>
                            <attachment id="12480928" name="logs.rar" size="8935" author="sunnygao" created="Tue, 31 May 2011 11:39:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 18 May 2011 19:50:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27077</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hodj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101211</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>