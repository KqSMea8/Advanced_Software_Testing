<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:29:43 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5652/HBASE-5652.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5652] [findbugs] Fix lock release on all paths </title>
                <link>https://issues.apache.org/jira/browse/HBASE-5652</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;See &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1313//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html#Warnings_MT_CORRECTNESS&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1313//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html#Warnings_MT_CORRECTNESS&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Category UL&lt;/p&gt;</description>
                <environment></environment>
        <key id="12548325">HBASE-5652</key>
            <summary>[findbugs] Fix lock release on all paths </summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12546936">HBASE-5598</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gchanan">Gregory Chanan</assignee>
                                    <reporter username="jmhsieh">Jonathan Hsieh</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Mar 2012 14:09:08 +0000</created>
                <updated>Mon, 23 Sep 2013 18:30:54 +0000</updated>
                            <resolved>Thu, 26 Apr 2012 01:59:33 +0000</resolved>
                                                    <fixVersion>0.95.0</fixVersion>
                                    <component>scripts</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13258671" author="gchanan" created="Fri, 20 Apr 2012 23:49:02 +0000"  >&lt;ul&gt;
	&lt;li&gt;Attacked &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5652&quot; title=&quot;[findbugs] Fix lock release on all paths &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5652&quot;&gt;&lt;del&gt;HBASE-5652&lt;/del&gt;&lt;/a&gt;-v0.patch *&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Attached patch that handles all the UL issues except two, which are on the exception list (I haven&apos;t tested the exception list yet, we&apos;ll see if it works in Hadoop QA).&lt;/p&gt;

&lt;p&gt;Those two are startRegionOperation  and startBulkRegionOperation, which are correct (they release the lock and throw an exception if the region is closed, otherwise, hold the lock and continue processing.&lt;/p&gt;</comment>
                            <comment id="13258698" author="hadoopqa" created="Sat, 21 Apr 2012 00:40:01 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12523581/HBASE-5652-v0.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12523581/HBASE-5652-v0.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestSplitTransactionOnCluster&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1596//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1596//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1596//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1596//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1596//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1596//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13258763" author="zhihyu@ebaysf.com" created="Sat, 21 Apr 2012 04:20:28 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(status != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) status.cleanup();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please insert space between if and (.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.logRollRunning = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+      } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
+        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.cacheFlushLock.unlock();
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The assignment wouldn&apos;t throw exception. Is the above try block needed ?&lt;/p&gt;</comment>
                            <comment id="13258786" author="ram_krish" created="Sat, 21 Apr 2012 06:31:58 +0000"  >&lt;p&gt;@Greg&lt;br/&gt;
I think the lock paths here are unlocked in finally block.  And the try catch block added may not be needed.  If Jon accepts we can add it into exclude file i think.&lt;br/&gt;
@Jon&lt;br/&gt;
Your thoughts please.&lt;/p&gt;</comment>
                            <comment id="13258791" author="umamaheswararao" created="Sat, 21 Apr 2012 06:53:56 +0000"  >&lt;p&gt;Agreed with Ram, variable assignment in finally block before unlocking would not cause any exception here. But the standard pattern for read/write locks I have seen is, after acquiring the lock, every line should be in try and in finally block we will release the lock. That might be the findbugs worry here. But in this case, there is no way of throwing exception from variable assignments. So, we can just skip I feel. Let&apos;s see Jon opinion on this.&lt;/p&gt;

&lt;p&gt;Here try/finally almost no use.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.logRollRunning = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+      } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
+        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.cacheFlushLock.unlock();
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Other problem I see in adding into exclude list is, we are not able to pin point exact lication of the code. We may give just package/class/method/feilds..and bug pattern,type ...etc. Unfortunately if same bug introduces but this is valid to fix in the same area of code, then it may get skipped due to other exclude entry presents in the file which is almost matching to the same. So, we have to reduce exclude filter entries also as less as possible.&lt;/p&gt;</comment>
                            <comment id="13258794" author="ram_krish" created="Sat, 21 Apr 2012 07:02:59 +0000"  >&lt;p&gt;Yes Uma you are right.  Jon also is strict in moving things to exclude file.&lt;/p&gt;</comment>
                            <comment id="13259177" author="umamaheswararao" created="Sun, 22 Apr 2012 16:56:07 +0000"  >&lt;p&gt;@Gregory, Also please update the test-patch.properties reflecting to the current findbugs OK count with your patch&lt;/p&gt;</comment>
                            <comment id="13259272" author="gchanan" created="Sun, 22 Apr 2012 21:25:37 +0000"  >&lt;p&gt;@Ted:&lt;br/&gt;
will update spacing&lt;/p&gt;

&lt;p&gt;@Uma:&lt;br/&gt;
will update test-patch.properties&lt;/p&gt;

&lt;p&gt;On the assignment not being able to throw an exception, I agree.  However it seems better to put it into a try/finally because:&lt;br/&gt;
1) it keeps the pattern the same with other usages&lt;br/&gt;
2) it works even if the line changes.  Imagine if we made it an exclude and then the line changed to something that could throw an exception.  We wouldn&apos;t see the warning because the exclude would hide it.&lt;br/&gt;
3) as noted by Uma, exceptions are fragile, e.g. if you rename the function you also have to change the exclude.&lt;/p&gt;</comment>
                            <comment id="13259277" author="zhihyu@ebaysf.com" created="Sun, 22 Apr 2012 21:57:52 +0000"  >&lt;p&gt;I think we can release this.cacheFlushLock before setting this.logRollRunning to false.&lt;br/&gt;
We don&apos;t need the extra try/finally construct.&lt;/p&gt;</comment>
                            <comment id="13259439" author="jmhsieh" created="Mon, 23 Apr 2012 07:45:08 +0000"  >&lt;p&gt;I side with Greg here.  I&apos;d rather we only add excludes for things that &lt;b&gt;must&lt;/b&gt; be put there.  In that particular case, we have readable and reasonable code that does not require the exclude.&lt;/p&gt;
</comment>
                            <comment id="13259907" author="gchanan" created="Mon, 23 Apr 2012 20:07:46 +0000"  >&lt;ul&gt;
	&lt;li&gt;Attached &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5652&quot; title=&quot;[findbugs] Fix lock release on all paths &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5652&quot;&gt;&lt;del&gt;HBASE-5652&lt;/del&gt;&lt;/a&gt;-v1.patch *&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Fixed spacing as requested by Ted.&lt;br/&gt;
Haven&apos;t updated test-patch.properties, as I won&apos;t know what value to use until Hadoop QA runs.&lt;/p&gt;</comment>
                            <comment id="13259946" author="hadoopqa" created="Mon, 23 Apr 2012 20:57:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12523859/HBASE-5652-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12523859/HBASE-5652-v1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestSplitLogManager&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1614//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1614//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1614//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1614//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1614//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1614//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13259957" author="stack" created="Mon, 23 Apr 2012 21:11:48 +0000"  >&lt;p&gt;I ran TestSplitLogManager ten times on trunk and it passed each time. FYI.&lt;/p&gt;</comment>
                            <comment id="13262314" author="jmhsieh" created="Thu, 26 Apr 2012 01:59:34 +0000"  >&lt;p&gt;Thanks Greg!  Committed to trunk with an updated bug count of 517.&lt;/p&gt;</comment>
                            <comment id="13262337" author="hudson" created="Thu, 26 Apr 2012 02:49:59 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2816 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2816/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2816/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5652&quot; title=&quot;[findbugs] Fix lock release on all paths &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5652&quot;&gt;&lt;del&gt;HBASE-5652&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;findbugs&amp;#93;&lt;/span&gt; Fix lock release on all paths (Gregory Channan) (Revision 1330628)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
jmhsieh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/dev-support/findbugs-exclude.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/dev-support/test-patch.properties&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/MemStoreFlusher.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13262394" author="hudson" created="Thu, 26 Apr 2012 05:55:50 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #185 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/185/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/185/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5652&quot; title=&quot;[findbugs] Fix lock release on all paths &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5652&quot;&gt;&lt;del&gt;HBASE-5652&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;findbugs&amp;#93;&lt;/span&gt; Fix lock release on all paths (Gregory Channan) (Revision 1330628)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
jmhsieh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/dev-support/findbugs-exclude.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/dev-support/test-patch.properties&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/MemStoreFlusher.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13775178" author="stack" created="Mon, 23 Sep 2013 18:30:54 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12523581" name="HBASE-5652-v0.patch" size="4800" author="gchanan" created="Fri, 20 Apr 2012 23:49:02 +0000"/>
                            <attachment id="12523859" name="HBASE-5652-v1.patch" size="4801" author="gchanan" created="Mon, 23 Apr 2012 20:07:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Apr 2012 23:49:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233422</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0htuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102097</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>