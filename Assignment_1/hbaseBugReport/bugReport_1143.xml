<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:51:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1143/HBASE-1143.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1143] region count erratic in master UI (kill server hosting root or meta and see how count goes awry).... make sure you have a bunch of reions in there</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1143</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description></description>
                <environment></environment>
        <key id="12412891">HBASE-1143</key>
            <summary>region count erratic in master UI (kill server hosting root or meta and see how count goes awry).... make sure you have a bunch of reions in there</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdcryans">Jean-Daniel Cryans</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Jan 2009 07:05:47 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:21 +0000</updated>
                            <resolved>Thu, 4 Jun 2009 21:27:14 +0000</resolved>
                                                    <fixVersion>0.20.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12711373" author="stack" created="Wed, 20 May 2009 21:48:30 +0000"  >&lt;p&gt;I still see this.  Easy to reproduce.  Once numbers go erratic, don&apos;t seem to come back.&lt;/p&gt;</comment>
                            <comment id="12715658" author="jdcryans" created="Tue, 2 Jun 2009 20:23:04 +0000"  >&lt;p&gt;I tried this. What I see after killing the .META. holding RS is that we lose a bunch of edits so we only see an old version of the .META. table coming back. That version, if you killed your RS not long after the cluster startup, is a snapshot of .META. on the last shutdown. What I saw is a bunch of &quot;Current assignment of ...&quot;, just like a fresh start!&lt;/p&gt;

&lt;p&gt;Now I restarted HBase and tested again but I first flushed .META. and, guess what, everything was fine. IMO we should flush/compact .META. like crazy until we are able to not lose edits. That region is always small so it seconds &amp;lt; 1 sec to do.&lt;/p&gt;</comment>
                            <comment id="12715659" author="streamy" created="Tue, 2 Jun 2009 20:24:39 +0000"  >&lt;p&gt;+1 on flushing/compating META all the time until we have appends and can flush every 1 edit.&lt;/p&gt;</comment>
                            <comment id="12715666" author="jdcryans" created="Tue, 2 Jun 2009 20:32:04 +0000"  >&lt;p&gt;I&apos;m taking the issue. I&apos;ll test very low memcache size on .META. and .ROOT. and see how it goes under massive uploads.&lt;/p&gt;</comment>
                            <comment id="12716036" author="jdcryans" created="Wed, 3 Jun 2009 19:26:51 +0000"  >&lt;p&gt;I tried different values for the memcache max size. Between each test of randomWrite 4 on a single node (cluster wasn&apos;t available), I did a shutdown of HBase + deleted the directory in HDFS. Here are the results:&lt;/p&gt;

&lt;p&gt;8k memcache first try&lt;br/&gt;
ELAPSED_TIME=423519&lt;/p&gt;

&lt;p&gt;second try&lt;br/&gt;
ELAPSED_TIME=405319&lt;/p&gt;

&lt;p&gt;16k memcache first try&lt;br/&gt;
ELAPSED_TIME=437552&lt;/p&gt;

&lt;p&gt;second try&lt;br/&gt;
ELAPSED_TIME=444659&lt;/p&gt;

&lt;p&gt;1M memcache first try&lt;br/&gt;
ELAPSED_TIME=423519&lt;/p&gt;

&lt;p&gt;second try&lt;br/&gt;
ELAPSED_TIME=432052&lt;/p&gt;

&lt;p&gt;12M memcache first try&lt;br/&gt;
ELAPSED_TIME=450118&lt;/p&gt;

&lt;p&gt;second try&lt;br/&gt;
ELAPSED_TIME=428693&lt;/p&gt;

&lt;p&gt;I did also try with 1k memcache but it was complete nonsense since it was flushing every 5 seconds. I think a sane value would be 12k so we get to flush more often but not too much. Could make this configurable.&lt;/p&gt;</comment>
                            <comment id="12716043" author="stack" created="Wed, 3 Jun 2009 19:54:41 +0000"  >&lt;p&gt;Lets try it.  16k rather than 12k just because seems less &apos;odd&apos;.  How many flushes were there at any one time?  Was compaction keeping up?&lt;/p&gt;</comment>
                            <comment id="12716044" author="jdcryans" created="Wed, 3 Jun 2009 19:58:07 +0000"  >&lt;p&gt;With 16k memcache I saw maybe 2-3 flushes per minute during the 7 minutes import. Each took anywhere between 50ms and 500ms. Compactions were keeping up since they are very fast.&lt;/p&gt;</comment>
                            <comment id="12716296" author="jdcryans" created="Thu, 4 Jun 2009 15:18:20 +0000"  >&lt;p&gt;Tested this morning on a 4 nodes cluster the current trunk (which includes my commit of yesterday). I first did a PE randomWrite 5 followed by a PE randomWrite 10. Flushes happened every 2 minutes or so and store files quickly got compacted when there were more than 6. So I think 16k is just great, it won&apos;t throttle huge imports and will save some lost edits.&lt;/p&gt;</comment>
                            <comment id="12716381" author="stack" created="Thu, 4 Jun 2009 20:03:33 +0000"  >&lt;p&gt;So, just had this happen on our cluster.  Need to backport something for 0.19.4.&lt;/p&gt;</comment>
                            <comment id="12716411" author="stack" created="Thu, 4 Jun 2009 21:24:23 +0000"  >&lt;p&gt;I added this as part of J-D&apos;s change:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: src/java/org/apache/hadoop/hbase/client/HConnectionManager.java
===================================================================
--- src/java/org/apache/hadoop/hbase/client/HConnectionManager.java     (revision 781854)
+++ src/java/org/apache/hadoop/hbase/client/HConnectionManager.java     (working copy)
@@ -461,7 +461,7 @@
         &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnmodifyableHTableDescriptor(HTableDescriptor.ROOT_TABLEDESC);
       }
       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Bytes.equals(tableName, HConstants.META_TABLE_NAME)) {
-        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnmodifyableHTableDescriptor(HTableDescriptor.META_TABLEDESC);
+        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; HTableDescriptor.META_TABLEDESC;
       }
       HTableDescriptorFinder finder = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HTableDescriptorFinder(tableName);
       MetaScanner.metaScan(conf, finder);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Makes it so you can edit the .META. schema so you can change memcache flushsize on the .META. table from shell.&lt;/p&gt;</comment>
                            <comment id="12716414" author="jdcryans" created="Thu, 4 Jun 2009 21:27:14 +0000"  >&lt;p&gt;Closing this issue. Will add a patch to help migration later.&lt;/p&gt;</comment>
                            <comment id="12716752" author="stack" created="Fri, 5 Jun 2009 20:59:02 +0000"  >&lt;p&gt;Backported the above fix which makes .META. schema editable and J-D&apos;s setting of memcache size to 16k on .META.:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: src/java/org/apache/hadoop/hbase/HTableDescriptor.java
===================================================================
--- src/java/org/apache/hadoop/hbase/HTableDescriptor.java      (revision 782130)
+++ src/java/org/apache/hadoop/hbase/HTableDescriptor.java      (working copy)
@@ -111,6 +111,8 @@
     &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;(HColumnDescriptor descriptor : families) {
       &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.families.put(Bytes.mapKey(descriptor.getName()), descriptor);
     }
+    &lt;span class=&quot;code-comment&quot;&gt;// TODO: Fix &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; hard-coding.
&lt;/span&gt;+    setMemcacheFlushSize(16 * 1024);
   }
 
   /**
@@ -687,4 +689,4 @@
           &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HColumnDescriptor(HConstants.COLUMN_FAMILY_HISTORIAN,
             HConstants.ALL_VERSIONS, HColumnDescriptor.CompressionType.NONE,
             &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.MAX_VALUE, HConstants.WEEK_IN_SECONDS, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)});
-}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 2 Jun 2009 20:23:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25600</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 28 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hbkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99138</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>