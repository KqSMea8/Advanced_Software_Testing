<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:46:41 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-697/HBASE-697.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-697] thrift idl needs update/edit to match new 0.2 API (and to fix bugs)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-697</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Talking w/ Bryan, moving this out of the way of the 0.2.0 release.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12398549">HBASE-697</key>
            <summary>thrift idl needs update/edit to match new 0.2 API (and to fix bugs)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tim_s">Tim Sell</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Jun 2008 23:58:13 +0000</created>
                <updated>Sat, 13 Sep 2008 23:22:43 +0000</updated>
                            <resolved>Sat, 16 Aug 2008 22:14:39 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.2.1</fixVersion>
                    <fixVersion>0.18.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12606254" author="stack" created="Thu, 19 Jun 2008 06:06:58 +0000"  >&lt;p&gt;Try fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-657&quot; title=&quot;InvalidColumnNameException not passed through to Thrift interface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-657&quot;&gt;&lt;del&gt;HBASE-657&lt;/del&gt;&lt;/a&gt; when we do this one too.&lt;/p&gt;</comment>
                            <comment id="12614260" author="stack" created="Thu, 17 Jul 2008 07:19:57 +0000"  >&lt;p&gt;Will we just punt this to 0.2.1.&lt;/p&gt;</comment>
                            <comment id="12621533" author="stack" created="Mon, 11 Aug 2008 18:13:15 +0000"  >&lt;p&gt;Here&apos;s description of API changes: &lt;a href=&quot;http://wiki.apache.org/hadoop/Hbase/Plan-0.2/APIChanges&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/Hbase/Plan-0.2/APIChanges&lt;/a&gt;.  MIght help figuring what needs fixing.&lt;/p&gt;</comment>
                            <comment id="12621558" author="apurtell" created="Mon, 11 Aug 2008 19:14:35 +0000"  >&lt;p&gt;Relates to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-800&quot; title=&quot;support HTD and HCD get/set attribute in shell, Thrift, and REST interfaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-800&quot;&gt;&lt;del&gt;HBASE-800&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="12621904" author="stack" created="Tue, 12 Aug 2008 17:58:32 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-822&quot; title=&quot;Update thrift README and HBase.thrift to use thrift 20080411&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-822&quot;&gt;&lt;del&gt;HBASE-822&lt;/del&gt;&lt;/a&gt; for updates to HBase.thrift and to README to go against newer thrift.&lt;/p&gt;</comment>
                            <comment id="12622269" author="tow21" created="Wed, 13 Aug 2008 16:40:57 +0000"  >&lt;p&gt;This extends the thrift API to allow retrieval of timestamp information.&lt;/p&gt;

&lt;p&gt;A new thrift object is created: HCell, matching HBase&apos;s Cell, which is just a (timestamp, value) pair.&lt;/p&gt;

&lt;p&gt;Two new methods are added to the thrift Client object: getCells and getCellsTs, which mirror the existing getVer &amp;amp; getVerTs.&lt;/p&gt;

&lt;p&gt;The patch is against 0.2.0.&lt;/p&gt;

&lt;p&gt;There are also some changes to ThriftServer.java required in order to bring it up to date with latest thrift - these mostly consist of changing ArrayList to List wherever appropriate, all of which is included in the patch. All of the generated files are also changed as a result of using latest thrift, also inside the patch.&lt;/p&gt;</comment>
                            <comment id="12622270" author="tow21" created="Wed, 13 Aug 2008 16:42:15 +0000"  >&lt;p&gt;This is the patch referred to in the previous comment.&lt;/p&gt;</comment>
                            <comment id="12622289" author="tim_s" created="Wed, 13 Aug 2008 17:37:00 +0000"  >&lt;p&gt;I&apos;ve been working on this.&lt;br/&gt;
There&apos;s a lot of things to update.&lt;/p&gt;

&lt;p&gt;Exposing timestamps for cells.&lt;br/&gt;
  Change all the get functions to return TCell instead of Bytes and list&amp;lt;Bytes&amp;gt;.&lt;br/&gt;
  A TCell would be the thrift version of a Cell. Just as ColumnDescriptor is to HColumnDescriptor.&lt;br/&gt;
  with a value and a timestamp field.&lt;/p&gt;

&lt;p&gt;Updating to new thrift versions&lt;br/&gt;
  Requires the ArrayList&apos;s and AbstractMap&apos;s to be List and Map. &lt;br/&gt;
  Also the newest libthrift.jar would need to be replaced.&lt;/p&gt;

&lt;p&gt;isEnabled, disable enable functions&lt;br/&gt;
  Add isTableEnabled function.&lt;br/&gt;
  Add enable and disableTable functions. So that a table can actually be deleted.&lt;/p&gt;

&lt;p&gt;Fix the examples/thrift/DemoClient.java to match all the changes.&lt;/p&gt;

&lt;p&gt;Expose more stuff with RegionDescriptor.&lt;br/&gt;
  Add endKey, id, name and version.&lt;br/&gt;
  I&apos;m inclined that this should be changed to be called TRegionInfo (to match the Hbase class RegionInfo)&lt;/p&gt;

&lt;p&gt;What about the put functions?&lt;br/&gt;
  The HTable as per 0.2 does not have put, they must be done through a BatchUpdate.&lt;br/&gt;
  The thrift equivalent is mutationRows(table, row, mutations) &lt;br/&gt;
  Do we still want the put functions? Or remove them to match the api?&lt;br/&gt;
  They are less cumbersome, they create a BatchUpdate anyway with just a single put.&lt;/p&gt;

&lt;p&gt;I wanted to have a patch to pick at today, but I ran out of time.&lt;br/&gt;
So comments on just the above?&lt;/p&gt;
</comment>
                            <comment id="12622290" author="tim_s" created="Wed, 13 Aug 2008 17:39:25 +0000"  >&lt;p&gt;oops I was writing while you were posting. It&apos;s pretty much identical to what I did too. Except I was going to replace the existing get functions.&lt;br/&gt;
I think H as a prefix should be reserved for stuff part of HBase, rather then thrift stuff.&lt;/p&gt;</comment>
                            <comment id="12622294" author="stack" created="Wed, 13 Aug 2008 17:46:02 +0000"  >&lt;p&gt;+1 on just replacing the methods that are there currently.&lt;br/&gt;
+1 on &apos;H&apos; as prefix in hbase that doesn&apos;t have to show in thrift data structures&lt;br/&gt;
+1 on updating thrift (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-822&quot; title=&quot;Update thrift README and HBase.thrift to use thrift 20080411&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-822&quot;&gt;&lt;del&gt;HBASE-822&lt;/del&gt;&lt;/a&gt; has gone at least some of the ways).&lt;br/&gt;
+1 on TRegionInfo instad of RegionDescriptor&lt;br/&gt;
+1 on removing the put methods and using mutateionRow with commit&lt;/p&gt;

&lt;p&gt;Thanks Toby and Tim for taking this on.&lt;/p&gt;</comment>
                            <comment id="12622307" author="tim_s" created="Wed, 13 Aug 2008 18:22:38 +0000"  >&lt;p&gt;Cool, I&apos;ll add a patch for the above tomorrow, as soon as I can.&lt;/p&gt;</comment>
                            <comment id="12622316" author="stack" created="Wed, 13 Aug 2008 18:40:33 +0000"  >&lt;p&gt;Excellent (Maybe Toby can verify it works?)&lt;/p&gt;</comment>
                            <comment id="12622545" author="tim_s" created="Thu, 14 Aug 2008 13:23:13 +0000"  >&lt;p&gt;Attached Patch.&lt;br/&gt;
Needs review.&lt;br/&gt;
If Toby and anyone could look this over and confirm it gives us what we need and conforms to the 0.2 api that would be grand &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The examples/thrift/DemoClient.java has been updated.&lt;/p&gt;

&lt;p&gt;Note, this includes the regenerated thrift files. Importantly I regenerated them using thrift release 20080411p1&lt;br/&gt;
which you can get &lt;a href=&quot;http://developers.facebook.com/thrift/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://developers.facebook.com/thrift/&lt;/a&gt;&lt;br/&gt;
Thrift is under apache incubation, but the latest stable release is still the last facebook one.&lt;/p&gt;

&lt;p&gt;We will need to replace the libthrift jar file with this version. I will attach it for convenience.&lt;/p&gt;

&lt;p&gt;There are still some things which could be improved. &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The new RowLock stuff should be available via thrift.&lt;/li&gt;
	&lt;li&gt;All the non java examples need updating.&lt;/li&gt;
	&lt;li&gt;We should really have a junit test covering all of ThriftServer.HBaseHandler.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12622634" author="tow21" created="Thu, 14 Aug 2008 18:40:41 +0000"  >&lt;p&gt;From a brief review, this looks fine to me - but I&apos;m not familiar with most of the HBase API, so don&apos;t take my word for it.&lt;/p&gt;

&lt;p&gt;Certainly it serves my purposes well enough - I can now retrieve timestamps &amp;amp; delete tables.&lt;/p&gt;

&lt;p&gt;A minor thing - the new thrift jar attached requires a newer version of java than I have on this computer (1.5.0_13), but I&apos;ve run into no problems using the old thrift jar.&lt;/p&gt;

&lt;p&gt;As a side issue, I&apos;ve attached another patch for ThriftServer.java (apply on top of Tim&apos;s patch) to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-657&quot; title=&quot;InvalidColumnNameException not passed through to Thrift interface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-657&quot;&gt;&lt;del&gt;HBASE-657&lt;/del&gt;&lt;/a&gt;, which should probably be rolled into this.&lt;/p&gt;</comment>
                            <comment id="12622922" author="stack" created="Fri, 15 Aug 2008 17:03:44 +0000"  >&lt;p&gt;Toby: Is it because the jar up on facebook was compiled w/ a 1.6JVM?  I tried downloading and recompiling w/ 1.5 JVM.  Generated jar is suspiciously small.  The content of this package, com/facebook/thrift/processor/, is missing from my built jar.  Agreed that the thing should run w/ a 1.5JVM if that is the issue since rest of hbase is based on 1.5 but I wouldn&apos;t put this in way of a commit.&lt;/p&gt;

&lt;p&gt;Should I go with Tim&apos;s patch and just leave the old thrift jar for now?  That works for you Toby and Tim?&lt;/p&gt;

&lt;p&gt;Should  Imake issue to add unit tests for HBaseHandler? IIRC, you don&apos;t have to put up thrift servers to exercise this class so should be easy to add.&lt;/p&gt;

&lt;p&gt;Tim: Looking at patch, ignoring the generated code (yuck), DemoClient contains a class named &apos;CopyOfDemoClient&apos;.  Thats a little odd (I can fix on commit if you like).  And you don&apos;t have RowResult or a RowResult-like thing in your IDL.  Not needed?  The thrift package.html hasn&apos;t been updated (I can do that on commit too).  Otherwise, patch looks great.&lt;/p&gt;

&lt;p&gt;Good stuff lads.&lt;/p&gt;
</comment>
                            <comment id="12622946" author="tim_s" created="Fri, 15 Aug 2008 17:58:46 +0000"  >&lt;p&gt;Hmm, oops the attached libthrift jar might have been compiled on my machine using java 1.6. sorry about that. I&apos;ll remove that file.&lt;br/&gt;
We should use the jar from facebook.&lt;/p&gt;

&lt;p&gt;Stack: Oops, sorry about the CopyOfDemoClient, I guess I lost track of things somewhere. So yes that needs fixing. &lt;br/&gt;
About RowResult, looking over the code again, I realise the RowResult is the analogue of ScanEntry, and this should also be returned for getRow functions (even though we know what row we are getting). ScanEntry should really be called TRowResult I guess. Want me to fix these and stick a new patch up tomorrow?&lt;/p&gt;</comment>
                            <comment id="12622968" author="stack" created="Fri, 15 Aug 2008 18:37:51 +0000"  >&lt;p&gt;Toby: Any chance of your compiling jar using the facebook 20080411p1 tarball?  It looks like things compile fine but I&apos;m suspicious because a whole package is missing (maybe I need to do more than just do &apos;an&apos; in lib/java&apos;).&lt;/p&gt;

&lt;p&gt;Tim: I think a TRowResult will make for less confusion so if you don&apos;t mind (scanentry was created before rowresult).  That&apos;d be a nice fixup.  I can do the others no problem.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="12623131" author="tim_s" created="Sat, 16 Aug 2008 15:06:36 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Added TRowResult.&lt;/li&gt;
	&lt;li&gt;Added to ThriftUtilities function for converting RowResult to TRowResult.&lt;/li&gt;
	&lt;li&gt;Fixed silly, CopyOfDemoClient from my other patch.&lt;/li&gt;
	&lt;li&gt;Updated thrift/package.html&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12623165" author="stack" created="Sat, 16 Aug 2008 22:14:39 +0000"  >&lt;p&gt;Thanks for the patch Tim.  I applied to branch and trunk.   Also added in the new jar built by me using JVM 1.5 against a check out of 20080411p1 (under the lib/java dir).  If it don&apos;t work, lets file new issues.&lt;/p&gt;</comment>
                            <comment id="12623167" author="stack" created="Sat, 16 Aug 2008 22:19:46 +0000"  >&lt;p&gt;Tim: I made issues to cover your suggestions above made at the end of your &apos;Tim Sell - 14/Aug/08 06:23 AM&apos; comment.&lt;/p&gt;</comment>
                            <comment id="12623194" author="tim_s" created="Sun, 17 Aug 2008 14:22:06 +0000"  >&lt;p&gt;Just want to confirm that with the new libthrift jar it works fine for me.&lt;/p&gt;</comment>
                            <comment id="12623226" author="stack" created="Sun, 17 Aug 2008 20:30:39 +0000"  >&lt;p&gt;Assigning Tim.  He fixed it.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12394149">HBASE-585</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12400116">HBASE-740</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12402229">HBASE-822</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12397126">HBASE-657</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12401847">HBASE-800</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12388235" name="HBASE-697.patch" size="253318" author="tim_s" created="Thu, 14 Aug 2008 13:23:12 +0000"/>
                            <attachment id="12388363" name="HBASE-697v2.patch" size="277077" author="tim_s" created="Sat, 16 Aug 2008 15:06:36 +0000"/>
                            <attachment id="12388164" name="hbase-timestamps.patch" size="222459" author="tow21" created="Wed, 13 Aug 2008 16:42:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 11 Aug 2008 19:14:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h8w7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98703</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>