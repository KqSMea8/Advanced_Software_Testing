<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:58:15 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8760/HBASE-8760.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8760] possible loss of data in snapshot taken after region split</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8760</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Right after a region split but before the daughter regions are compacted, we have two daughter regions containing Reference files to the parent hfiles.&lt;/p&gt;

&lt;p&gt;If we take snapshot right at the moment, the snapshot will succeed, but it will only contain the daughter Reference files. Since there is no hold on the parent hfiles, they will be deleted by the HFile Cleaner after they are no longer needed by the daughter regions soon after.&lt;/p&gt;

&lt;p&gt;A minimum we need to do is the keep these parent hfiles from being deleted. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12653553">HBASE-8760</key>
            <summary>possible loss of data in snapshot taken after region split</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mbertozzi">Matteo Bertozzi</assignee>
                                    <reporter username="jinghe">Jerry He</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Jun 2013 19:02:18 +0000</created>
                <updated>Tue, 24 Sep 2013 20:32:53 +0000</updated>
                            <resolved>Tue, 20 Aug 2013 20:49:56 +0000</resolved>
                                    <version>0.94.8</version>
                    <version>0.95.1</version>
                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.94.12</fixVersion>
                    <fixVersion>0.96.0</fixVersion>
                                    <component>snapshots</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13687085" author="hadoopqa" created="Tue, 18 Jun 2013 19:12:44 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12588432/HBase-8760-0.94.8.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12588432/HBase-8760-0.94.8.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6059//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6059//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13687108" author="mbertozzi" created="Tue, 18 Jun 2013 19:40:54 +0000"  >&lt;p&gt;if the snapshot doesn&apos;t contain referred file, the table is not supposed to work after the restore. I guess it works just because it uses directly the reference-link logic skipping the referredParent+link path.&lt;/p&gt;

&lt;p&gt;Could you add a unit test for this? mocking the fs state as done in TestRestoreSnapshotHelper.createSnapshot() should be good enough.&lt;/p&gt;</comment>
                            <comment id="13687142" author="yuzhihong@gmail.com" created="Tue, 18 Jun 2013 20:22:50 +0000"  >&lt;p&gt;Minor comment:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed match of store file name &quot;&lt;/span&gt; + refFileName);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;store file&apos; -&amp;gt; &apos;reference file&apos;&lt;/p&gt;</comment>
                            <comment id="13687225" author="hadoopqa" created="Tue, 18 Jun 2013 21:32:42 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12588432/HBase-8760-0.94.8.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12588432/HBase-8760-0.94.8.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6062//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6062//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13687286" author="jinghe" created="Tue, 18 Jun 2013 22:20:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;&lt;br/&gt;
Yes, restore/clone snapshot works wells if the parent hfile is not deleted. I am amazed to see the part of the code that figures out the Links and half References works well.  Below is some region server log dump.&lt;/p&gt;

&lt;p&gt;If the parent hfile has been deleted before restore/clone, this is the error.&lt;br/&gt;
table1 is the original snapshot table. table1_clone is the clone_snapshot table.&lt;br/&gt;
--------------------------------------------------------------------------------------------------------&lt;br/&gt;
$ hadoop fs -lsr /hbase/.hbase-snapshot&lt;br/&gt;
/hbase/.hbase-snapshot/.tmp&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/.snapshotinfo&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/.tableinfo.0000000001&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/.tmp&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/399a750df7646a7fb38d35780ca5254f&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/399a750df7646a7fb38d35780ca5254f/.regioninfo&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/399a750df7646a7fb38d35780ca5254f/.tmp&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/399a750df7646a7fb38d35780ca5254f/family1&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/399a750df7646a7fb38d35780ca5254f/family1/c272990ce92c409d8cdebd6afcb8cc14.3e96bb19fb20e4edd27949f894878714&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/f3b8401f06dc4cbe2043f26df42e1b0e&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/f3b8401f06dc4cbe2043f26df42e1b0e/.regioninfo&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/f3b8401f06dc4cbe2043f26df42e1b0e/.tmp&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/f3b8401f06dc4cbe2043f26df42e1b0e/family1&lt;br/&gt;
/hbase/.hbase-snapshot/my_table1_snapshot/f3b8401f06dc4cbe2043f26df42e1b0e/family1/c272990ce92c409d8cdebd6afcb8cc14.3e96bb19fb20e4edd27949f894878714&lt;/p&gt;


&lt;p&gt;2013-06-14 22:40:03,065 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Received request to open region: table1_clone,,1371270778458.3ab8becbaddb796fc8a036762dbd9493.&lt;br/&gt;
2013-06-14 22:40:03,065 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:60020-0x13f2c26b6106505 Attempting to transition node 3ab8becbaddb796fc8a036762dbd9493 from M_ZK_REGION_OFFLINE to RS_ZK_REGION_OPENING&lt;br/&gt;
2013-06-14 22:40:03,067 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:60020-0x13f2c26b6106505 Successfully transitioned node 3ab8becbaddb796fc8a036762dbd9493 from M_ZK_REGION_OFFLINE to RS_ZK_REGION_OPENING&lt;br/&gt;
2013-06-14 22:40:03,067 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Opening region: &lt;/p&gt;
{NAME =&amp;gt; &apos;table1_clone,,1371270778458.3ab8becbaddb796fc8a036762dbd9493.&apos;, STARTKEY =&amp;gt; &apos;&apos;, ENDKEY =&amp;gt; &apos;user1959958463&apos;, ENCODED =&amp;gt; 3ab8becbaddb796fc8a036762dbd9493,}
&lt;p&gt;2013-06-14 22:40:03,067 INFO org.apache.hadoop.hbase.regionserver.HRegion: Setting up tabledescriptor config now ...&lt;br/&gt;
2013-06-14 22:40:03,067 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Instantiated table1_clone,,1371270778458.3ab8becbaddb796fc8a036762dbd9493.&lt;br/&gt;
2013-06-14 22:40:03,069 INFO org.apache.hadoop.hbase.regionserver.Store: time to purge deletes set to 0ms in store family1&lt;br/&gt;
2013-06-14 22:40:03,069 INFO org.apache.hadoop.hbase.regionserver.Store: hbase.hstore.compaction.min = 3&lt;br/&gt;
2013-06-14 22:40:03,070 DEBUG org.apache.hadoop.hbase.regionserver.StoreFile: reference &apos;hdfs://hdtest009:9000/hbase/table1_clone/3ab8becbaddb796fc8a036762dbd9493/family1/table1=3e96bb19fb20e4edd27949f894878714-c272990ce92c409d8cdebd6afcb8cc14.3e96bb19fb20e4edd27949f894878714&apos; to region=3e96bb19fb20e4edd27949f894878714 hfile=table1=3e96bb19fb20e4edd27949f894878714-c272990ce92c409d8cdebd6afcb8cc14&lt;br/&gt;
2013-06-14 22:40:03,071 DEBUG org.apache.hadoop.hbase.regionserver.StoreFile: Store file hdfs://hdtest009:9000/hbase/table1_clone/3ab8becbaddb796fc8a036762dbd9493/family1/table1=3e96bb19fb20e4edd27949f894878714-c272990ce92c409d8cdebd6afcb8cc14.3e96bb19fb20e4edd27949f894878714 is a bottom reference to hdfs://hdtest009:9000/hbase/table1_clone/3e96bb19fb20e4edd27949f894878714/family1/table1=3e96bb19fb20e4edd27949f894878714-c272990ce92c409d8cdebd6afcb8cc14&lt;br/&gt;
2013-06-14 22:40:03,072 ERROR org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler: Failed open of region=table1_clone,,1371270778458.3ab8becbaddb796fc8a036762dbd9493., starting to roll back the global memstore size.&lt;br/&gt;
java.io.IOException: java.io.IOException: java.io.FileNotFoundException: Unable to open link: org.apache.hadoop.hbase.io.HFileLink locations=&lt;span class=&quot;error&quot;&gt;&amp;#91;hdfs://hdtest009:9000/hbase/table1/3e96bb19fb20e4edd27949f894878714/family1/c272990ce92c409d8cdebd6afcb8cc14, hdfs://hdtest009:9000/hbase/.tmp/table1/3e96bb19fb20e4edd27949f894878714/family1/c272990ce92c409d8cdebd6afcb8cc14, hdfs://hdtest009:9000/hbase/.archive/table1/3e96bb19fb20e4edd27949f894878714/family1/c272990ce92c409d8cdebd6afcb8cc14&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.initializeRegionInternals(HRegion.java:631)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.initialize(HRegion.java:544)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4372)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4320)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.openRegion(OpenRegionHandler.java:330)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.process(OpenRegionHandler.java:101)&lt;br/&gt;
        at org.apache.hadoop.hbase.executor.EventHandler.run(EventHandler.java:175)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:897)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:919)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:738)&lt;br/&gt;
Caused by: java.io.IOException: java.io.FileNotFoundException: Unable to open link: org.apache.hadoop.hbase.io.HFileLink locations=&lt;span class=&quot;error&quot;&gt;&amp;#91;hdfs://hdtest009:9000/hbase/table1/3e96bb19fb20e4edd27949f894878714/family1/c272990ce92c409d8cdebd6afcb8cc14, hdfs://hdtest009:9000/hbase/.tmp/table1/3e96bb19fb20e4edd27949f894878714/family1/c272990ce92c409d8cdebd6afcb8cc14, hdfs://hdtest009:9000/hbase/.archive/table1/3e96bb19fb20e4edd27949f894878714/family1/c272990ce92c409d8cdebd6afcb8cc14&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Store.loadStoreFiles(Store.java:481)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Store.&amp;lt;init&amp;gt;(Store.java:258)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.instantiateHStore(HRegion.java:3322)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion$1.call(HRegion.java:606)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion$1.call(HRegion.java:604)&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:314)&lt;br/&gt;
        at java.util.concurrent.FutureTask.run(FutureTask.java:149)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:452)&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:314)&lt;br/&gt;
        at java.util.concurrent.FutureTask.run(FutureTask.java:149)&lt;br/&gt;
        ... 3 more&lt;br/&gt;
Caused by: java.io.FileNotFoundException: Unable to open link: org.apache.hadoop.hbase.io.HFileLink locations=&lt;span class=&quot;error&quot;&gt;&amp;#91;hdfs://hdtest009:9000/hbase/table1/3e96bb19fb20e4edd27949f894878714/family1/c272990ce92c409d8cdebd6afcb8cc14, hdfs://hdtest009:9000/hbase/.tmp/table1/3e96bb19fb20e4edd27949f894878714/family1/c272990ce92c409d8cdebd6afcb8cc14, hdfs://hdtest009:9000/hbase/.archive/table1/3e96bb19fb20e4edd27949f894878714/family1/c272990ce92c409d8cdebd6afcb8cc14&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.hadoop.hbase.io.FileLink.getFileStatus(FileLink.java:375)&lt;br/&gt;
        at org.apache.hadoop.hbase.io.HalfStoreFileReader.&amp;lt;init&amp;gt;(HalfStoreFileReader.java:97)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.StoreFile.open(StoreFile.java:537)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.StoreFile.createReader(StoreFile.java:639)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Store$1.call(Store.java:457)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Store$1.call(Store.java:452)&lt;br/&gt;
        ... 8 more&lt;/p&gt;

&lt;p&gt;If the parent hfile is still present, everything works ok.&lt;br/&gt;
----------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;2013-06-18 14:58:50,026 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Received request to open 1 region(s)&lt;br/&gt;
2013-06-18 14:58:50,026 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Received request to open region: table1_clone,,1371578484233.6dab7a8a16b0e195785d52ad7b15bd09.&lt;br/&gt;
2013-06-18 14:58:50,031 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:60020-0x13f58635d150013 Attempting to transition node 6dab7a8a16b0e195785d52ad7b15bd09 from M_ZK_REGION_OFFLINE to RS_ZK_REGION_OPENING&lt;br/&gt;
2013-06-18 14:58:50,033 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:60020-0x13f58635d150013 Successfully transitioned node 6dab7a8a16b0e195785d52ad7b15bd09 from M_ZK_REGION_OFFLINE to RS_ZK_REGION_OPENING&lt;br/&gt;
2013-06-18 14:58:50,034 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Opening region: &lt;/p&gt;
{NAME =&amp;gt; &apos;table1_clone,,1371578484233.6dab7a8a16b0e195785d52ad7b15bd09.&apos;, STARTKEY =&amp;gt; &apos;&apos;, ENDKEY =&amp;gt; &apos;user1959958463&apos;, ENCODED =&amp;gt; 6dab7a8a16b0e195785d52ad7b15bd09,}
&lt;p&gt;2013-06-18 14:58:50,035 INFO org.apache.hadoop.hbase.regionserver.HRegion: Setting up tabledescriptor config now ...&lt;br/&gt;
2013-06-18 14:58:50,035 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Instantiated table1_clone,,1371578484233.6dab7a8a16b0e195785d52ad7b15bd09.&lt;br/&gt;
2013-06-18 14:58:50,039 INFO org.apache.hadoop.hbase.regionserver.Store: time to purge deletes set to 0ms in store family1&lt;br/&gt;
2013-06-18 14:58:50,039 INFO org.apache.hadoop.hbase.regionserver.Store: hbase.hstore.compaction.min = 3&lt;br/&gt;
2013-06-18 14:58:50,045 DEBUG org.apache.hadoop.hbase.regionserver.StoreFile: reference &apos;hdfs://hdtest009:9000/hbase/table1_clone/6dab7a8a16b0e195785d52ad7b15bd09/family1/table1=352470e8ef4d15b034ab1165b07e35e3-9014c0eed1c0418daf3d42882baecf24.352470e8ef4d15b034ab1165b07e35e3&apos; to region=352470e8ef4d15b034ab1165b07e35e3 hfile=table1=352470e8ef4d15b034ab1165b07e35e3-9014c0eed1c0418daf3d42882baecf24&lt;br/&gt;
2013-06-18 14:58:50,049 DEBUG org.apache.hadoop.hbase.regionserver.StoreFile: Store file hdfs://hdtest009:9000/hbase/table1_clone/6dab7a8a16b0e195785d52ad7b15bd09/family1/table1=352470e8ef4d15b034ab1165b07e35e3-9014c0eed1c0418daf3d42882baecf24.352470e8ef4d15b034ab1165b07e35e3 is a bottom reference to hdfs://hdtest009:9000/hbase/table1_clone/352470e8ef4d15b034ab1165b07e35e3/family1/table1=352470e8ef4d15b034ab1165b07e35e3-9014c0eed1c0418daf3d42882baecf24&lt;br/&gt;
2013-06-18 14:58:50,062 DEBUG org.apache.hadoop.hbase.regionserver.Store: loaded hdfs://hdtest009:9000/hbase/table1_clone/6dab7a8a16b0e195785d52ad7b15bd09/family1/table1=352470e8ef4d15b034ab1165b07e35e3-9014c0eed1c0418daf3d42882baecf24.352470e8ef4d15b034ab1165b07e35e3, isReference=true, isBulkLoadResult=false, seqid=32549, majorCompaction=false&lt;br/&gt;
2013-06-18 14:58:50,064 INFO org.apache.hadoop.hbase.regionserver.HRegion: Onlined table1_clone,,1371578484233.6dab7a8a16b0e195785d52ad7b15bd09.; next sequenceid=32550&lt;/p&gt;</comment>
                            <comment id="13687293" author="jinghe" created="Tue, 18 Jun 2013 22:27:07 +0000"  >&lt;p&gt;Attached HBase-8760-0.94.8-v1 for Ted&apos;s comment.&lt;br/&gt;
Will try to come up with a unit test too. &lt;/p&gt;</comment>
                            <comment id="13687300" author="mbertozzi" created="Tue, 18 Jun 2013 22:29:28 +0000"  >&lt;p&gt;You can check RestoreSnapshotHelper.restoreReferenceFile() and StoreFileInfo.open() to see how the link-reference file works.&lt;/p&gt;

&lt;p&gt;anyway, keeping the file is not the solution to the problem.&lt;br/&gt;
You&apos;ve a snapshot on disk that is not consistent since the parent reference is missing.&lt;br/&gt;
aside from the fact that you can still reference the parent because the restore of a reference is smarter, having a snapshot with a missing information is wrong.&lt;/p&gt;

&lt;p&gt;so the fix should be inside the snapshot... and not on the cleaner side keeping the file just because the reference can be smart.&lt;/p&gt;</comment>
                            <comment id="13687312" author="hadoopqa" created="Tue, 18 Jun 2013 22:35:56 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12588470/HBase-8760-0.94.8-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12588470/HBase-8760-0.94.8-v1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6064//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6064//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13687315" author="jinghe" created="Tue, 18 Jun 2013 22:41:03 +0000"  >&lt;p&gt;I agree.  A couple of options for thoughts.&lt;/p&gt;

&lt;p&gt;Option 1:&lt;/p&gt;

&lt;p&gt;1) Keep the parent hfle from the hfile cleaner. (the current patch).  &lt;br/&gt;
   The hfile will be there with the snapshot. But will be gone after delete-snapshot.&lt;br/&gt;
2) In RestoreSnapshotHelper.restoreReferenceFile(), change the code to either hold onto the parent hfile, or copy the half files?&lt;br/&gt;
3) Take care of ExportSnapshot too.&lt;/p&gt;

&lt;p&gt;Option 2:&lt;/p&gt;

&lt;p&gt;1) Include the parent hfiles in the snapshot. Disregard the daughters?&lt;/p&gt;

&lt;p&gt;Other approaches?&lt;/p&gt;</comment>
                            <comment id="13687330" author="mbertozzi" created="Tue, 18 Jun 2013 22:54:23 +0000"  >&lt;p&gt;I&apos;m only in favor of option 2.&lt;br/&gt;
Option one is just a workaround that you should always keep in mind when you change something.&lt;/p&gt;

&lt;p&gt;If to load the table you must have that file... it means that the file should be in the snapshot.&lt;br/&gt;
so, why is not there? can we add it as FixReferences() step during the snapshot?&lt;br/&gt;
should we mark the snapshot as corrupted in the master verifier if the parent is missing?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7987&quot; title=&quot;Snapshot Manifest file instead of multiple empty files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7987&quot;&gt;&lt;del&gt;HBASE-7987&lt;/del&gt;&lt;/a&gt; will probably clean up a bit the load snapshot situation, and Reference Files tracking...&lt;br/&gt;
but it doesn&apos;t solve this problem where the file is not included in the snapshot. NOTE that if you implement a strict snapshot verifier this snapshot should be considered corrupted.&lt;/p&gt;</comment>
                            <comment id="13687482" author="jinghe" created="Wed, 19 Jun 2013 01:14:57 +0000"  >&lt;p&gt;You raised a good simple alternative approach, which is to fail the snapshot in this particular case &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;On the master TakeSnapshotHandler(), we set excludeOfflinedSplitParents to true in here:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      List&amp;lt;Pair&amp;lt;HRegionInfo, ServerName&amp;gt;&amp;gt; regionsAndLocations =
          MetaReader.getTableRegionsAndLocations(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.server.getCatalogTracker(),
            Bytes.toBytes(snapshot.getTable()), &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the region server side, each RS only add online regions to snapshot:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;HRegion&amp;gt; getRegionsToSnapshot(SnapshotDescription snapshot) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] table = Bytes.toBytes(snapshot.getTable());
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; rss.getOnlineRegions(table);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So we are missing out the parent hfiles.&lt;/p&gt;

&lt;p&gt;Fail the snapshot thru verifier is an option.&lt;br/&gt;
It is just that snapshot can continue to succeed in this case.&lt;/p&gt;

&lt;p&gt;Add FixReferences() step is an option as well.  This probably should be done on the master in the last stage of snapshot?&lt;br/&gt;
But do you deal with the parent hfiles as part of the parent region to include?&lt;/p&gt;</comment>
                            <comment id="13704445" author="mbertozzi" created="Wed, 10 Jul 2013 11:23:04 +0000"  >&lt;p&gt;attached a thz-v0 patch, that adds a check if the referred file exists in the snapshot. This means that the snapshot will fail if the parent region is missing.&lt;/p&gt;</comment>
                            <comment id="13704517" author="hadoopqa" created="Wed, 10 Jul 2013 12:52:28 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12591636/HBASE-8760-thz-v0.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12591636/HBASE-8760-thz-v0.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6293//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13711872" author="lhofhansl" created="Thu, 18 Jul 2013 00:51:53 +0000"  >&lt;p&gt;Is there consensus about what to do here?&lt;/p&gt;</comment>
                            <comment id="13711964" author="lhofhansl" created="Thu, 18 Jul 2013 03:14:40 +0000"  >&lt;p&gt;Moving to 0.94.11 train.&lt;/p&gt;</comment>
                            <comment id="13727365" author="lhofhansl" created="Fri, 2 Aug 2013 05:43:53 +0000"  >&lt;p&gt;Anything happening on this?&lt;/p&gt;</comment>
                            <comment id="13727792" author="mbertozzi" created="Fri, 2 Aug 2013 16:49:16 +0000"  >&lt;p&gt;I&apos;m going to commit my patch, until some one else has a better alternative&lt;/p&gt;</comment>
                            <comment id="13727919" author="jinghe" created="Fri, 2 Aug 2013 18:18:48 +0000"  >&lt;p&gt;Hi, Matteo&lt;/p&gt;

&lt;p&gt;I agree your patch is probably the best we can do for now.&lt;/p&gt;

&lt;p&gt;We can probably do more in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7987&quot; title=&quot;Snapshot Manifest file instead of multiple empty files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7987&quot;&gt;&lt;del&gt;HBASE-7987&lt;/del&gt;&lt;/a&gt; to have a new solution for this problem. &lt;br/&gt;
For example, include the parent hfiles in the manifest file but add indicators/markers&lt;br/&gt;
to tell they are meant to be parent hfiles.&lt;/p&gt;</comment>
                            <comment id="13728632" author="stack" created="Sat, 3 Aug 2013 20:32:32 +0000"  >&lt;p&gt;+1 on patch (failing snapshot if parent is missing &amp;#8211; failed snapshot is not end of the world whereas a snapshot we thought wholesome but turns not to be is bad news).&lt;/p&gt;</comment>
                            <comment id="13728634" author="mbertozzi" created="Sat, 3 Aug 2013 20:37:21 +0000"  >&lt;p&gt;wait wait, I&apos;m working on a patch to do a &quot;late repair&quot;...&lt;br/&gt;
let me work on that a bit more&lt;/p&gt;</comment>
                            <comment id="13728687" author="mbertozzi" created="Sat, 3 Aug 2013 22:36:19 +0000"  >&lt;p&gt;Changed my mind again...&lt;/p&gt;

&lt;p&gt;the new thz-v1 patch now does this&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The offlined regions are taken as &quot;offline&quot; snapshot&lt;/li&gt;
	&lt;li&gt;The the check now verifies that the references have a parent&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;so, &lt;/p&gt;

&lt;p&gt;Quick and simple manual test can be done in this way, and manually verify /hbase/.hbase-snapshot &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
create &apos;testtb&apos;, &apos;cf&apos;
put &apos;testtb&apos;, &apos;row0&apos;, &apos;cf:q&apos;, &apos;row0&apos;
put &apos;testtb&apos;, &apos;row1&apos;, &apos;cf:q&apos;, &apos;row1&apos;
put &apos;testtb&apos;, &apos;row2&apos;, &apos;cf:q&apos;, &apos;row2&apos;
put &apos;testtb&apos;, &apos;row3&apos;, &apos;cf:q&apos;, &apos;row3&apos;
put &apos;testtb&apos;, &apos;row4&apos;, &apos;cf:q&apos;, &apos;row4&apos;
put &apos;testtb&apos;, &apos;row5&apos;, &apos;cf:q&apos;, &apos;row5&apos;
put &apos;testtb&apos;, &apos;row6&apos;, &apos;cf:q&apos;, &apos;row6&apos;
flush &apos;testtb&apos;
split &apos;testtb&apos;, &apos;row3&apos;

snapshot &apos;testtb&apos;, &apos;foo&apos;
clone_snapshot &apos;foo&apos;, &apos;footb&apos;
snapshot &apos;footb&apos;, &apos;bar&apos;
clone_snapshot &apos;bar&apos;, &apos;bartb&apos;
scan &apos;testtb&apos;
scan &apos;footb&apos;
scan &apos;bartb&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13728705" author="hadoopqa" created="Sun, 4 Aug 2013 00:24:08 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12595772/HBASE-8760-thz-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12595772/HBASE-8760-thz-v1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6597//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13728951" author="jinghe" created="Sun, 4 Aug 2013 18:48:52 +0000"  >&lt;p&gt;This is a meaningful change!&lt;br/&gt;
Parent region and daughter regions are all included in the snapshot. After restore/clone, all will be included and brought online?&lt;/p&gt;

&lt;p&gt;Code comments:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 snapshtoDisabledRegion(snapshotDir, regionInfo);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Typo in the method name.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void verifyRegions(Path snapshotDir) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;==&amp;gt; private void verifyRegions(final Path snapshotDir) throws IOException&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void verifyRegion(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; FileSystem fs, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path snapshotDir, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HRegionInfo region)
      &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
     &lt;span class=&quot;code-comment&quot;&gt;// make sure we have region in the snapshot&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;That comment line is not indeeded anymore.&lt;/p&gt;</comment>
                            <comment id="13728953" author="mbertozzi" created="Sun, 4 Aug 2013 18:54:45 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
This is a meaningful change!
Parent region and daughter regions are all included in the snapshot. After restore/clone, all will be included and brought online?
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the restore/clone will populate .META. in the same way as it is in the original table, so no. they will not be online. (with this patch, you end up with the same exact layout disk/meta of the original table, no offline missing)&lt;/p&gt;</comment>
                            <comment id="13728970" author="jinghe" created="Sun, 4 Aug 2013 19:58:12 +0000"  >&lt;p&gt;And the population of the .META is based on the .regioninfo files which were carried over from the original table?&lt;br/&gt;
That makes sense.&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="13729572" author="yuzhihong@gmail.com" created="Mon, 5 Aug 2013 15:29:15 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      LOG.warn(msg);
+      &lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CorruptedSnapshotException(msg, snapshot);&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Remove the commented out code ?&lt;/p&gt;</comment>
                            <comment id="13729934" author="mbertozzi" created="Mon, 5 Aug 2013 21:03:03 +0000"  >&lt;p&gt;v2 has the fix requested above, no real code changes.&lt;/p&gt;

&lt;p&gt;I want to test this patch more, with all the 3 cases above (normal table, clone table, clone of a clone)&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;~jerryjch&amp;#93;&lt;/span&gt; are you testing the patch on a cluster or just looking at the code?&lt;/p&gt;</comment>
                            <comment id="13730002" author="jinghe" created="Mon, 5 Aug 2013 21:44:54 +0000"  >&lt;p&gt;I had seen the problem on a 0.94 live cluster. It happened when there was heavy write load on the cluster &lt;br/&gt;
while the snapshot was taken.&lt;br/&gt;
Later to re-create the problem, I had to suspend the compaction thread manually so that right after region &lt;br/&gt;
split the new regions would not be compacted right away.&lt;br/&gt;
I have not got a chance to do testing on this patch yet.&lt;/p&gt;</comment>
                            <comment id="13730075" author="hadoopqa" created="Mon, 5 Aug 2013 22:42:32 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12596212/HBASE-8760-thz-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12596212/HBASE-8760-thz-v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6608//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13735311" author="mbertozzi" created="Fri, 9 Aug 2013 21:15:47 +0000"  >&lt;p&gt;rebased the patch on trunk, but looks like that hfileLink are broken after the namespace merge&lt;/p&gt;</comment>
                            <comment id="13735443" author="hadoopqa" created="Fri, 9 Aug 2013 22:56:27 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12597171/HBASE-8760-thz-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12597171/HBASE-8760-thz-v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 20 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6684//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13735917" author="mbertozzi" created="Sat, 10 Aug 2013 14:06:59 +0000"  >&lt;p&gt;v4 should be the final one.&lt;/p&gt;

&lt;p&gt;easy way to test this stuff put a return null inside the HStore.compaction() to avoid compactions. Then run the stuff above in the hbase shell to create a table, snapshot, clone and a clone of clone.. Then remove the original table and way the archiver to do the job. Play with enable/disable to test the load unload cloned table and verify that the files are still readable. Also check the /hbase dir to look if all the expected files are there.&lt;/p&gt;

&lt;p&gt;I&apos;m not able to constantly reproduce the HFileLink problem and I haven&apos;t seen the problem after this patch, but the symptom was an exception during the enable of a cloned table with a link resolving to /hbase/.data/tableName instead of /hbase/.data/default/tableName, basically the &quot;dafault&quot; namespace dir was not there. Anyway this will be another jira&lt;/p&gt;</comment>
                            <comment id="13735939" author="hadoopqa" created="Sat, 10 Aug 2013 15:22:23 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12597281/HBASE-8760-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12597281/HBASE-8760-v4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 3 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6691//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13736454" author="jinghe" created="Sun, 11 Aug 2013 22:49:34 +0000"  >&lt;p&gt;Hi, Matteo&lt;/p&gt;

&lt;p&gt;I&apos;ve just tested the v4 patch again 0.94 and 0.95.2. These are the basic steps:&lt;br/&gt;
1. Change the code to disable compaction (similar to what you mentioned).&lt;br/&gt;
2. start hbase&lt;br/&gt;
3. Create and populate a TestTable with &apos;hbase org.apache.hadoop.hbase.PerformanceEvaluation  randomWrite 5&apos;&lt;br/&gt;
4. split TestTable&lt;br/&gt;
5. snapshot &apos;TestTable&apos;, &apos;my_snapshot1&apos;  (This snapshot includes parent and daughter references.)&lt;br/&gt;
6. stop hbase&lt;br/&gt;
7. Change the code to enable normal compaction.&lt;br/&gt;
8. start hbase&lt;br/&gt;
9. Wait for normal compactions (and/or additional splits) to go thru their courses, and hfile cleaners to go thru their courses as well.&lt;br/&gt;
10. clone_snapshot &apos;my_snapshot1&apos;, &apos;TestTable_clone&apos;&lt;br/&gt;
11. count the rows of TestTable_clone to verify the number is the same as TestTable.&lt;br/&gt;
12. Verify there are no exceptions in region server logs like &apos;can not open link&apos; or &apos;can not open file&apos;.&lt;/p&gt;

&lt;p&gt;13. snapshot &apos;TestTable_clone&apos;, &apos;my_snapshot2&apos;&lt;br/&gt;
14. clone &apos;my_snapshot2&apos;, &apos;TestTable_clone_clone&apos;&lt;/p&gt;</comment>
                            <comment id="13736461" author="jinghe" created="Sun, 11 Aug 2013 23:08:02 +0000"  >&lt;p&gt;The patch is working well up to step 12. I&apos;ve not been able to re-create the problem.&lt;/p&gt;

&lt;p&gt;But I have seen problems and exceptions in both 0.94 and 0.95.2 during step 13 and 14 for a second level snapshot and clone.&lt;/p&gt;

&lt;p&gt;For example, in 0.94:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hbase(main):005:0&amp;gt; snapshot &apos;TestTable_clone&apos;, &apos;my_snapshot2&apos;

ERROR: org.apache.hadoop.hbase.snapshot.HBaseSnapshotException: org.apache.hadoop.hbase.snapshot.HBaseSnapshotException: Snapshot { ss=my_snapshot2 table=TestTable_clone type=FLUSH } had an error.  my_snapshot2 not found in proclist []
        at org.apache.hadoop.hbase.master.snapshot.SnapshotManager.isSnapshotDone(SnapshotManager.java:359)
        at org.apache.hadoop.hbase.master.HMaster.isSnapshotDone(HMaster.java:2185)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
        at java.lang.reflect.Method.invoke(Method.java:611)
        at org.apache.hadoop.hbase.ipc.WritableRpcEngine$Server.call(WritableRpcEngine.java:320)
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1426)
Caused by: org.apache.hadoop.hbase.snapshot.CorruptedSnapshotException via Failed taking snapshot { ss=my_snapshot2 table=TestTable_clone type=FLUSH } due to exception:Missing parent hfile &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: TestTable=83935cdbb327ac84f45a7248f4d58173-048d68de11a042e9aba294ab336ddbf3.630c188f55575e0cce497ba342b562bb:org.apache.hadoop.hbase.snapshot.CorruptedSnapshotException: Missing parent hfile &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: TestTable=83935cdbb327ac84f45a7248f4d58173-048d68de11a042e9aba294ab336ddbf3.630c188f55575e0cce497ba342b562bb
        at org.apache.hadoop.hbase.errorhandling.ForeignExceptionDispatcher.rethrowException(ForeignExceptionDispatcher.java:85)
        at org.apache.hadoop.hbase.master.snapshot.TakeSnapshotHandler.rethrowExceptionIfFailed(TakeSnapshotHandler.java:282)
        at org.apache.hadoop.hbase.master.snapshot.SnapshotManager.isSnapshotDone(SnapshotManager.java:349)
        ... 7 more
Caused by: org.apache.hadoop.hbase.snapshot.CorruptedSnapshotException: Missing parent hfile &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: TestTable=83935cdbb327ac84f45a7248f4d58173-048d68de11a042e9aba294ab336ddbf3.630c188f55575e0cce497ba342b562bb
        at org.apache.hadoop.hbase.master.snapshot.MasterSnapshotVerifier.verifyStoreFile(MasterSnapshotVerifier.java:223)
        at org.apache.hadoop.hbase.master.snapshot.MasterSnapshotVerifier.access$000(MasterSnapshotVerifier.java:85)
        at org.apache.hadoop.hbase.master.snapshot.MasterSnapshotVerifier$1.storeFile(MasterSnapshotVerifier.java:209)
        at org.apache.hadoop.hbase.util.FSVisitor.visitRegionStoreFiles(FSVisitor.java:115)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;From the logs, in this failure, 630c188f55575e0cce497ba342b562bb is a region in TestTable_clone that went thru its own split. It was gone (not even in .archive) after its split.&lt;br/&gt;
But somehow there are remaining links/references to it in TestTable_clone.&lt;br/&gt;
TestTable_clone have 3m plus rows. It could go thru compactions and splits on its own.  That seems to have confuses snapshot operations.  &lt;br/&gt;
If you need to relevant master/region server logs, I can send to you or attach them here.&lt;/p&gt;</comment>
                            <comment id="13736468" author="jinghe" created="Sun, 11 Aug 2013 23:22:42 +0000"  >&lt;p&gt;Some exceptions were seen against 0.95.2 during step 14. It is different from 0.94. But it could just be due to random timing.&lt;br/&gt;
Step 13 was ok. &lt;br/&gt;
Step 14 was ok as successful as well, but there were errors in the logs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-08-10 23:00:16,463 ERROR [RS_OPEN_REGION-hdtest009:60021-1] handler.OpenRegionHandler: Failed open of region=TestTable_clone_clone,,1376197826879.c3ea5fba0fe4a49a9e93102d133b99fd., starting to roll back the global memstore size.
...
Caused by: java.io.IOException: java.io.FileNotFoundException: Unable to open link: org.apache.hadoop.hbase.io.HFileLink locations=[hdfs:&lt;span class=&quot;code-comment&quot;&gt;//hdtest009.svl.ibm.com:9000/hbase95/.data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/TestTable_clone/9d76f97c231b0ffa4f9ecbe73bfc2acd/info/9af07c31650045d28aa13d8b37251690, hdfs://hdtest009.svl.ibm.com:9000/hbase95/.tmp/.data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/TestTable_clone/9d76f97c231b0ffa4f9ecbe73bfc2acd/info/9af07c31650045d28aa13d8b37251690, hdfs://hdtest009.svl.ibm.com:9000/hbase95/.archive/.data/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/TestTable_clone/9d76f97c231b0ffa4f9ecbe73bfc2acd/info/9af07c31650045d28aa13d8b37251690]
&lt;/span&gt;        at org.apache.hadoop.hbase.regionserver.HStore.loadStoreFiles(HStore.java:448)
        at org.apache.hadoop.hbase.regionserver.HStore.&amp;lt;init&amp;gt;(HStore.java:241)
        at org.apache.hadoop.hbase.regionserver.HRegion.instantiateHStore(HRegion.java:3122)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Based on the logs, the failed region was a parent region. The daughters regions were ok. Therefore the end row count was good.&lt;br/&gt;
Again if you need relevant logs, I can send to you or attach here.&lt;/p&gt;</comment>
                            <comment id="13736557" author="jinghe" created="Mon, 12 Aug 2013 04:07:28 +0000"  >&lt;p&gt;Attached zip files from the testing.&lt;br/&gt;
Each contains:&lt;br/&gt;
1. master/region sever logs&lt;br/&gt;
2. file listing for the snapshots, tables during the testing. &lt;/p&gt;</comment>
                            <comment id="13736560" author="hadoopqa" created="Mon, 12 Aug 2013 04:13:20 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12597405/v4-patch-testing-0.95.2.zip&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12597405/v4-patch-testing-0.95.2.zip&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6697//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6697//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13736766" author="mbertozzi" created="Mon, 12 Aug 2013 11:17:27 +0000"  >&lt;p&gt;looks like that the CatalogJanitor is removing the offline region because of the missing split qualifiers.&lt;/p&gt;</comment>
                            <comment id="13736838" author="hadoopqa" created="Mon, 12 Aug 2013 13:03:18 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12597466/HBASE-8760-0.94-v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12597466/HBASE-8760-0.94-v5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6700//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6700//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13739737" author="mbertozzi" created="Wed, 14 Aug 2013 14:50:46 +0000"  >&lt;p&gt;v6 explicity avoid to assign an offline region. workaround for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9204&quot; title=&quot;An Offline SplitParent Region can be assigned breaking split references&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9204&quot;&gt;&lt;del&gt;HBASE-9204&lt;/del&gt;&lt;/a&gt; that is still not fixed&lt;/p&gt;</comment>
                            <comment id="13739740" author="hadoopqa" created="Wed, 14 Aug 2013 14:53:21 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12597979/HBASE-8760-0.94-v6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12597979/HBASE-8760-0.94-v6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6742//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6742//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13739748" author="hadoopqa" created="Wed, 14 Aug 2013 15:03:14 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12597980/HBASE-8760-0.94-v6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12597980/HBASE-8760-0.94-v6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6743//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6743//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13739972" author="jinghe" created="Wed, 14 Aug 2013 18:05:05 +0000"  >&lt;p&gt;Hi, Matteo&lt;/p&gt;

&lt;p&gt;From the master and region server logs, the offline regions from snapshot were clearly tried being brought online.&lt;br/&gt;
I didn&apos;t make the connection between the failures/exceptions and that.&lt;br/&gt;
I am very hopeful this latest patch will solve it. I will do some quick testing.&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="13740496" author="hadoopqa" created="Thu, 15 Aug 2013 00:38:25 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12598102/HBASE-8760-0.94-v6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12598102/HBASE-8760-0.94-v6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6752//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6752//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13740952" author="mbertozzi" created="Thu, 15 Aug 2013 13:25:12 +0000"  >&lt;p&gt;v7 is going back to the v5 style restore since &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9207&quot; title=&quot;An Offline SplitParent Region can be assigned breaking split references&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9207&quot;&gt;&lt;del&gt;HBASE-9207&lt;/del&gt;&lt;/a&gt; seems to be on the way (testing with 9207-v3)&lt;/p&gt;</comment>
                            <comment id="13740959" author="hadoopqa" created="Thu, 15 Aug 2013 13:33:27 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12598196/HBASE-8760-0.94-v7.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12598196/HBASE-8760-0.94-v7.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6761//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6761//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13741247" author="lhofhansl" created="Thu, 15 Aug 2013 17:38:40 +0000"  >&lt;p&gt;QQ: Why wouldn&apos;t you continue to use to HBaseFileSystem.createNewFileOnFileSystem(...) rather than fs.createNewFile(...)?&lt;/p&gt;</comment>
                            <comment id="13741254" author="mbertozzi" created="Thu, 15 Aug 2013 17:44:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;QQ: Why wouldn&apos;t you continue to use to HBaseFileSystem.createNewFileOnFileSystem(...) rather than fs.createNewFile(...)?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;no reason, just a mistake. I&apos;ll fix it in the next version.&lt;/p&gt;</comment>
                            <comment id="13742260" author="hadoopqa" created="Fri, 16 Aug 2013 14:24:02 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12598445/HBASE-8760-trunk-v8.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12598445/HBASE-8760-trunk-v8.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6782//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13743522" author="jinghe" created="Mon, 19 Aug 2013 04:54:54 +0000"  >&lt;p&gt;Hi, Matteo&lt;/p&gt;

&lt;p&gt;Thank you for the time and effort you spent on this JIRA!  There had been more complexity and problems than anticipated.&lt;/p&gt;

&lt;p&gt;I applied &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9207&quot; title=&quot;An Offline SplitParent Region can be assigned breaking split references&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9207&quot;&gt;&lt;del&gt;HBASE-9207&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9233&quot; title=&quot;isTableAvailable() may be stuck if an offline parent was never assigned&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9233&quot;&gt;&lt;del&gt;HBASE-9233&lt;/del&gt;&lt;/a&gt;, and then the &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8760&quot; title=&quot;possible loss of data in snapshot taken after region split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8760&quot;&gt;&lt;del&gt;HBASE-8760&lt;/del&gt;&lt;/a&gt;-0.94-v8.patch on my 0.94 cluster.&lt;/p&gt;

&lt;p&gt;I went through a few times the test steps outlined in my previous comment. Sometimes with minor changes in the steps.&lt;/p&gt;

&lt;p&gt;There is one more issue. (Hopefully this is the last one!)&lt;br/&gt;
We should not include the offline regions&apos; ServerName in the online snapshot procedure. Otherwise the snapshot procedure will timeout&lt;br/&gt;
while waiting for the obsolete ServerName if the ServerName has been changed, e.g. a re-start.&lt;/p&gt;

&lt;p&gt;Attached a 0.94-v8-addendum. It is on top of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8760&quot; title=&quot;possible loss of data in snapshot taken after region split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8760&quot;&gt;&lt;del&gt;HBASE-8760&lt;/del&gt;&lt;/a&gt;-0.94-v8.patch.&lt;/p&gt;

&lt;p&gt;After this, I have not seen any failure or exceptions during the testing. &lt;br/&gt;
The row counts always match. The logs are clean without errors or exceptions too.&lt;/p&gt;</comment>
                            <comment id="13743528" author="hadoopqa" created="Mon, 19 Aug 2013 05:03:33 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12598708/HBASE-8760-0.94-v8-addendum.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12598708/HBASE-8760-0.94-v8-addendum.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/6806//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/6806//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13743598" author="mbertozzi" created="Mon, 19 Aug 2013 07:29:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;We should not include the offline regions&apos; ServerName in the online snapshot procedure. Otherwise the snapshot procedure will timeout&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yeah that&apos;s right. The addendum looks good to me. thanks&lt;br/&gt;
I&apos;ll do a final test with more machines, but looks like v8+addendum will be the good one.&lt;/p&gt;</comment>
                            <comment id="13744137" author="mbertozzi" created="Mon, 19 Aug 2013 19:22:40 +0000"  >&lt;p&gt;v8 + addendum (for both 94 and trunk) looks good to me, any other thoughts?&lt;/p&gt;</comment>
                            <comment id="13744167" author="stack" created="Mon, 19 Aug 2013 20:23:18 +0000"  >&lt;p&gt;I skimmed the patch.  Looks reasonable to me.  +1 (for trunk and 0.95)&lt;/p&gt;</comment>
                            <comment id="13744268" author="yuzhihong@gmail.com" created="Mon, 19 Aug 2013 21:35:05 +0000"  >&lt;p&gt;lgtm&lt;br/&gt;
Some comments:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        &lt;span class=&quot;code-comment&quot;&gt;// TODO-REMOVE-ME: HConnectionManager.isTableAvailable() is checking the SERVER_QUALIFIER
&lt;/span&gt;+        &lt;span class=&quot;code-comment&quot;&gt;// also on offline regions, so to keep the compatibility with older clients we must add
&lt;/span&gt;+        &lt;span class=&quot;code-comment&quot;&gt;// a location to &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; region even &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; it will never be assigned.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When would the above be removed ?&lt;/p&gt;

&lt;p&gt;In restoreReferenceFile():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (parentsMap) {
+      Pair&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; daughters = parentsMap.get(clonedRegionName);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I don&apos;t see synchronized (parentsMap) in other part of the patch.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * Add the specified set of regions to the META table.
+   */
   @Override
+  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void addRegionsToMeta(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; CatalogTracker ct, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;HRegionInfo&amp;gt; regionInfos)
+      &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
+    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.addRegionsToMeta(ct, regionInfos);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The javadoc above @Override seems to be redundant.&lt;/p&gt;</comment>
                            <comment id="13744294" author="mbertozzi" created="Mon, 19 Aug 2013 21:45:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;// TODO-REMOVE-ME: HConnectionManager.isTableAvailable() - When would the above be removed?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;from 94 can&apos;t be removed to keep the compatibility with pre-&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9233&quot; title=&quot;isTableAvailable() may be stuck if an offline parent was never assigned&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9233&quot;&gt;&lt;del&gt;HBASE-9233&lt;/del&gt;&lt;/a&gt; versions&lt;br/&gt;
in the trunk patch is not there&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I don&apos;t see synchronized (parentsMap) in other part of the patch.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;because other parts are single threaded. There&apos;s a restore regions steps that has a thread-pool underneath, coming from ModifyRegionUtils.createRegions()&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The javadoc above @Override seems to be redundant.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yeah, I&apos;ll remove that&lt;/p&gt;</comment>
                            <comment id="13744806" author="mbertozzi" created="Tue, 20 Aug 2013 09:17:51 +0000"  >&lt;p&gt;Attached the v9 patch that I&apos;m going to merge later today if no other comments.&lt;/p&gt;

&lt;p&gt;contains the v8-addendum written by Jerry and removes the Override comment pointed out by Ted&lt;/p&gt;</comment>
                            <comment id="13745208" author="jdcryans" created="Tue, 20 Aug 2013 18:04:59 +0000"  >&lt;p&gt;+1 &lt;/p&gt;

&lt;p&gt;Fix this on commit:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;+          // necessary infomration is captured by its fs location and filename.  This allows us to&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;And this too, sprinkle some javadoc:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;+    public void updateMetaParentRegions(final CatalogTracker catalogTracker,&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The fact that we have those exact lines in two different classes is concerning (you start playing whack-a-mole when doing later changes):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+          if (HFileLink.isHFileLink(hfile)) {
+            path = new Path(family, hfile);
+          } else {
+            path = new Path(family, HFileLink.createHFileLinkName(table, region, hfile));
+          }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="13745377" author="yuzhihong@gmail.com" created="Tue, 20 Aug 2013 20:34:52 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13745400" author="mbertozzi" created="Tue, 20 Aug 2013 20:49:56 +0000"  >&lt;p&gt;committed to 0.94, 0.95 and trunk. Thanks for the reviews, and thanks Jerry for the patches and tests!&lt;/p&gt;</comment>
                            <comment id="13745548" author="hudson" created="Tue, 20 Aug 2013 22:30:30 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94-security #266 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/266/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/266/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8760&quot; title=&quot;possible loss of data in snapshot taken after region split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8760&quot;&gt;&lt;del&gt;HBASE-8760&lt;/del&gt;&lt;/a&gt; possible loss of data in snapshot taken after region split (mbertozzi: rev 1515967)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/HFileLink.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/CloneSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/DisabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/EnabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/MasterSnapshotVerifier.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/RestoreSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/TakeSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/snapshot/ExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotInfo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13745565" author="jinghe" created="Tue, 20 Aug 2013 22:40:49 +0000"  >&lt;p&gt;Thanks Matteo and everyone!&lt;/p&gt;</comment>
                            <comment id="13745608" author="hudson" created="Tue, 20 Aug 2013 23:10:14 +0000"  >&lt;p&gt;SUCCESS: Integrated in hbase-0.95-on-hadoop2 #258 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95-on-hadoop2/258/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95-on-hadoop2/258/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8760&quot; title=&quot;possible loss of data in snapshot taken after region split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8760&quot;&gt;&lt;del&gt;HBASE-8760&lt;/del&gt;&lt;/a&gt; possible loss of data in snapshot taken after region split (mbertozzi: rev 1515966)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/catalog/MetaEditor.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/io/HFileLink.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/CloneSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/DisabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/EnabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/MasterSnapshotVerifier.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/RestoreSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/TakeSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileInfo.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/ExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotInfo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13745609" author="hudson" created="Tue, 20 Aug 2013 23:10:23 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94 #1120 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1120/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1120/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8760&quot; title=&quot;possible loss of data in snapshot taken after region split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8760&quot;&gt;&lt;del&gt;HBASE-8760&lt;/del&gt;&lt;/a&gt; possible loss of data in snapshot taken after region split (mbertozzi: rev 1515967)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/HFileLink.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/CloneSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/DisabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/EnabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/MasterSnapshotVerifier.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/RestoreSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/TakeSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/snapshot/ExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotInfo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13745695" author="hudson" created="Wed, 21 Aug 2013 01:28:02 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #688 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/688/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/688/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8760&quot; title=&quot;possible loss of data in snapshot taken after region split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8760&quot;&gt;&lt;del&gt;HBASE-8760&lt;/del&gt;&lt;/a&gt; possible loss of data in snapshot taken after region split (mbertozzi: rev 1515965)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/catalog/MetaEditor.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/HFileLink.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/CloneSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/DisabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/EnabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/MasterSnapshotVerifier.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/RestoreSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/TakeSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileInfo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/ExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotInfo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13745697" author="hudson" created="Wed, 21 Aug 2013 01:33:57 +0000"  >&lt;p&gt;SUCCESS: Integrated in hbase-0.95 #477 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/477/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/477/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8760&quot; title=&quot;possible loss of data in snapshot taken after region split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8760&quot;&gt;&lt;del&gt;HBASE-8760&lt;/del&gt;&lt;/a&gt; possible loss of data in snapshot taken after region split (mbertozzi: rev 1515966)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/catalog/MetaEditor.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/io/HFileLink.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/CloneSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/DisabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/EnabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/MasterSnapshotVerifier.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/RestoreSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/TakeSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileInfo.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/ExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotInfo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13745712" author="hudson" created="Wed, 21 Aug 2013 01:56:01 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #4418 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4418/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4418/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8760&quot; title=&quot;possible loss of data in snapshot taken after region split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8760&quot;&gt;&lt;del&gt;HBASE-8760&lt;/del&gt;&lt;/a&gt; possible loss of data in snapshot taken after region split (mbertozzi: rev 1515965)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/catalog/MetaEditor.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/HFileLink.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/CloneSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/DisabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/EnabledTableSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/MasterSnapshotVerifier.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/RestoreSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/TakeSnapshotHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileInfo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/ExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/RestoreSnapshotHelper.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotInfo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12663504">HBASE-9207</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12599005" name="HBASE-8760-0.94-v10.patch" size="38831" author="mbertozzi" created="Tue, 20 Aug 2013 18:49:16 +0000"/>
                            <attachment id="12597280" name="HBASE-8760-0.94-v4.patch" size="22467" author="mbertozzi" created="Sat, 10 Aug 2013 14:06:59 +0000"/>
                            <attachment id="12597466" name="HBASE-8760-0.94-v5.patch" size="30396" author="mbertozzi" created="Mon, 12 Aug 2013 12:55:16 +0000"/>
                            <attachment id="12598102" name="HBASE-8760-0.94-v6.patch" size="31980" author="mbertozzi" created="Wed, 14 Aug 2013 23:58:16 +0000"/>
                            <attachment id="12598196" name="HBASE-8760-0.94-v7.patch" size="34231" author="mbertozzi" created="Thu, 15 Aug 2013 13:25:12 +0000"/>
                            <attachment id="12598708" name="HBASE-8760-0.94-v8-addendum.patch" size="2551" author="jinghe" created="Mon, 19 Aug 2013 04:55:53 +0000"/>
                            <attachment id="12598444" name="HBASE-8760-0.94-v8.patch" size="34433" author="mbertozzi" created="Fri, 16 Aug 2013 13:07:07 +0000"/>
                            <attachment id="12598925" name="HBASE-8760-0.94-v9.patch" size="36906" author="mbertozzi" created="Tue, 20 Aug 2013 09:17:51 +0000"/>
                            <attachment id="12591636" name="HBASE-8760-thz-v0.patch" size="3434" author="mbertozzi" created="Wed, 10 Jul 2013 11:23:04 +0000"/>
                            <attachment id="12599007" name="HBASE-8760-trunk-v10.patch" size="39388" author="mbertozzi" created="Tue, 20 Aug 2013 19:05:11 +0000"/>
                            <attachment id="12598445" name="HBASE-8760-trunk-v8.patch" size="37923" author="mbertozzi" created="Fri, 16 Aug 2013 13:07:07 +0000"/>
                            <attachment id="12598924" name="HBASE-8760-trunk-v9.patch" size="38214" author="mbertozzi" created="Tue, 20 Aug 2013 09:17:51 +0000"/>
                            <attachment id="12597281" name="HBASE-8760-v4.patch" size="26159" author="mbertozzi" created="Sat, 10 Aug 2013 14:06:59 +0000"/>
                            <attachment id="12588470" name="HBase-8760-0.94.8-v1.patch" size="2363" author="jinghe" created="Tue, 18 Jun 2013 22:26:51 +0000"/>
                            <attachment id="12588432" name="HBase-8760-0.94.8.patch" size="2359" author="jinghe" created="Tue, 18 Jun 2013 19:08:17 +0000"/>
                            <attachment id="12597404" name="v4-patch-testing-0.94.zip" size="185172" author="jinghe" created="Mon, 12 Aug 2013 04:04:00 +0000"/>
                            <attachment id="12597405" name="v4-patch-testing-0.95.2.zip" size="173117" author="jinghe" created="Mon, 12 Aug 2013 04:04:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Jun 2013 19:12:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>333830</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 17 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ll5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>334157</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>