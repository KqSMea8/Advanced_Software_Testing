<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:38:40 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6652/HBASE-6652.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6652] [replication]replicationQueueSizeCapacity and replicationQueueNbCapacity default value is too big, Slave regionserver maybe outmemory after master start replication</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6652</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;now our replication replicationQueueSizeCapacity is set to 64M and replicationQueueNbCapacity is set to 25000. So when a master cluster with many regionserver replicate to a small cluster &#12290; Slave rpc queue will full and out of memory .&lt;/p&gt;


&lt;p&gt;java.util.concurrent.ExecutionException: java.io.IOException: Call queue is full, is ipc.server.max.callqueue.size too small?&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)&lt;br/&gt;
        at java.util.concurrent.FutureTask.get(FutureTask.java:83)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.processBatchCallback(HConnectionManager.java:&lt;br/&gt;
1524)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.processBatch(HConnectionManager.java:1376)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HTable.batch(HTable.java:700)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HTablePool$PooledHTable.batch(HTablePool.java:361)&lt;br/&gt;
        at org.apache.hadoop.hbase.replication.regionserver.ReplicationSink.batch(ReplicationSink.java:172)&lt;br/&gt;
        at org.apache.hadoop.hbase.replication.regionserver.ReplicationSink.replicateEntries(ReplicationSink.java:129)&lt;br/&gt;
        at org.apache.hadoop.hbase.replication.regionserver.Replication.replicateLogEntries(Replication.java:139)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.replicateLogEntries(HRegionServer.java:4018)&lt;br/&gt;
        at sun.reflect.GeneratedMethodAccessor41.invoke(Unknown Source)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.WritableRpcEngine$Server.call(WritableRpcEngine.java:361)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1414)&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12604708">HBASE-6652</key>
            <summary>[replication]replicationQueueSizeCapacity and replicationQueueNbCapacity default value is too big, Slave regionserver maybe outmemory after master start replication</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="terry_zhang">terry zhang</assignee>
                                    <reporter username="terry_zhang">terry zhang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Aug 2012 03:27:11 +0000</created>
                <updated>Fri, 24 Aug 2012 06:37:43 +0000</updated>
                                            <version>0.94.1</version>
                                                    <component>Replication</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13440938" author="stack" created="Fri, 24 Aug 2012 04:29:53 +0000"  >&lt;p&gt;Should we set default replicationQueueNbCapacity smaller? (Replicating from a too big cluster into a too small one seems to be a pretty common affair)&lt;/p&gt;</comment>
                            <comment id="13440981" author="terry_zhang" created="Fri, 24 Aug 2012 06:32:35 +0000"  >&lt;p&gt;if we use patch &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6165&quot; title=&quot;Replication can overrun .META. scans on cluster re-start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6165&quot;&gt;&lt;del&gt;HBASE-6165&lt;/del&gt;&lt;/a&gt; and don&apos;t set custom queue size , replication will us IPC call queue. So if hbase.region.server.handler.count set too much, the slave cluster region server maybe out of memory when replication running. So can we replicationQueueSizeCapacity default value to 4M?&lt;/p&gt;</comment>
                            <comment id="13440985" author="terry_zhang" created="Fri, 24 Aug 2012 06:37:43 +0000"  >&lt;p&gt;another case will case slave region server oom is master disable replication and restart many times. When we enable replication master region server will start many recovery thread (many zk node in replication/rs/xxx/). this will still let the slave rs work in very heavy load.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 24 Aug 2012 04:29:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241762</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02cfr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11616</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>