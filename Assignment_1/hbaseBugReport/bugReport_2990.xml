<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:06:26 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2990/HBASE-2990.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2990] It&apos;s possible for regions to not be major compacted for more than hbase.hregion.majorcompaction</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2990</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This is something I&apos;ve seen here since we upgraded to 0.89 since Gets are now Scans, although I don&apos;t currently have any strong evidence that it wasn&apos;t happening in 0.20.&lt;/p&gt;

&lt;p&gt;I saw this when we began getting alerts on the frontend that some requests were taking more than 8 seconds to complete. Even getting a value could take more than 3 minutes in the shell. The first thing I did was major compacting the table that was slow and the problem went away immediately. Looking in the logs, it seems the compaction transformed 2 files of (total) 550MB into 5.2MB. Looking back in the logs for September, it appears that that table was never major compacted and was slowly growing everyday. Some more grepping around showed that quite a few regions were never major compacted.&lt;/p&gt;

&lt;p&gt;I&apos;m still looking at the code, but the issue seems to be that the minor compactions are always happening on all store files more than once per day on certain regions, meaning that the oldest timestamp is always smaller than hbase.hregion.majorcompaction and major compactions are never triggered.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12474012">HBASE-2990</key>
            <summary>It&apos;s possible for regions to not be major compacted for more than hbase.hregion.majorcompaction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="streamy">Jonathan Gray</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Sep 2010 22:31:52 +0000</created>
                <updated>Mon, 15 Apr 2013 22:38:51 +0000</updated>
                            <resolved>Mon, 15 Apr 2013 22:38:51 +0000</resolved>
                                    <version>0.90.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="12909034" author="jdcryans" created="Mon, 13 Sep 2010 22:39:05 +0000"  >&lt;p&gt;I&apos;m pretty sure this is caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2457&quot; title=&quot;RS gets stuck compacting region ad infinitum&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2457&quot;&gt;&lt;del&gt;HBASE-2457&lt;/del&gt;&lt;/a&gt; since we compact at least 4 files now.&lt;/p&gt;</comment>
                            <comment id="12909065" author="streamy" created="Tue, 14 Sep 2010 00:24:40 +0000"  >&lt;p&gt;Not sure if this is related to this jira but in a cluster doing almost exclusively increment write operations, performance slowly degrades significantly over time.  Major compacting seems to restore everything back to normal performance.  There doesn&apos;t seem to be a large build-up of number of files but it just goes really slow.&lt;/p&gt;</comment>
                            <comment id="12914235" author="ted_yu" created="Thu, 23 Sep 2010 21:29:30 +0000"  >&lt;p&gt;Store.getLowestTimestamp() checks timestamp from files. This check is not sufficient for major compaction to work - due to minor compactions within the past day.&lt;br/&gt;
One solution is to store timestamp of most recent major compaction in a file in the same directory as filesToCompact.get(0).&lt;/p&gt;</comment>
                            <comment id="12918187" author="streamy" created="Tue, 5 Oct 2010 21:04:51 +0000"  >&lt;p&gt;Keep this in 0.90 or punt?&lt;/p&gt;</comment>
                            <comment id="12918253" author="jdcryans" created="Tue, 5 Oct 2010 22:14:16 +0000"  >&lt;p&gt;We keep it, and I made it a blocker.&lt;/p&gt;</comment>
                            <comment id="12926642" author="streamy" created="Sat, 30 Oct 2010 20:01:18 +0000"  >&lt;p&gt;I have a patch up on rb for this.  Also worked on a second style implementation that uses metadata in HFiles but I care for it even less than the HRegionData approach.&lt;/p&gt;

&lt;p&gt;I&apos;m going to give another go w/ HRegionData and utilize versioning in HRI so we&apos;re properly backwards compatible.  Will have a patch up in the next couple days.&lt;/p&gt;</comment>
                            <comment id="12930877" author="streamy" created="Thu, 11 Nov 2010 01:13:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://review.cloudera.org/r/1089/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://review.cloudera.org/r/1089/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12931252" author="nspiegelberg" created="Thu, 11 Nov 2010 22:56:35 +0000"  >&lt;p&gt;Latency would be massively alleviated after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3048&quot; title=&quot;unify code for major/minor compactions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3048&quot;&gt;&lt;del&gt;HBASE-3048&lt;/del&gt;&lt;/a&gt;, correct?&lt;/p&gt;</comment>
                            <comment id="12931257" author="streamy" created="Thu, 11 Nov 2010 23:09:52 +0000"  >&lt;p&gt;Punting to 0.92 after multiple discussions with stack, nicolas, and kannan.  New compaction algorithm and unification of major/minor should make it so that even though there is still a bug here it shouldn&apos;t matter much.&lt;/p&gt;

&lt;p&gt;Good solutions to this stuff means changing everything to work at store level instead of region level so we should focus our efforts there for next release.  And also &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2375&quot; title=&quot;Revisit compaction configuration parameters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2375&quot;&gt;&lt;del&gt;HBASE-2375&lt;/del&gt;&lt;/a&gt; still needs to be fixed.&lt;/p&gt;</comment>
                            <comment id="12931258" author="streamy" created="Thu, 11 Nov 2010 23:10:09 +0000"  >&lt;p&gt;And making major instead of blocker.&lt;/p&gt;</comment>
                            <comment id="13047526" author="stack" created="Fri, 10 Jun 2011 22:45:39 +0000"  >&lt;p&gt;Moving out of 0.92.0. Pull it back in if you think different.&lt;/p&gt;</comment>
                            <comment id="13286148" author="stack" created="Wed, 30 May 2012 22:44:33 +0000"  >&lt;p&gt;Stale&lt;/p&gt;</comment>
                            <comment id="13632315" author="jdcryans" created="Mon, 15 Apr 2013 22:38:51 +0000"  >&lt;p&gt;Resolving now that minor compactions that compact all the files are upgraded to major compactions.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 14 Sep 2010 00:24:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26576</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 35 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02d0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11711</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>