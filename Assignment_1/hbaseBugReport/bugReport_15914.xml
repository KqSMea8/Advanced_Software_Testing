<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:08:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-15914/HBASE-15914.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-15914] lease expired exception when do scan with multiple thread</title>
                <link>https://issues.apache.org/jira/browse/HBASE-15914</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;hello, i am a freshman with Hbase ,now i do the performace test with hbase in our project. i use scan api to scan a table with filters. because we need the good performance ,so we scan each region with a single thread , total 24 regions, so we start 24 scan task to scan . each scan task we get a scanner to scan .&lt;/p&gt;

&lt;p&gt;but now i have a exception below: &lt;/p&gt;

&lt;p&gt;2016-05-30 11:18:46,399 | DEBUG | B.defaultRpcServer.handler=46,queue=6,port=21302 | B.defaultRpcServer.handler=46,queue=6,port=21302: callId: 102 service: ClientService methodName: Scan size: 22 connection: XXXXXXXXXX:59645 | org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:106)&lt;br/&gt;
org.apache.hadoop.hbase.regionserver.LeaseException: lease &apos;11&apos; does not exist&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Leases.removeLease(Leases.java:221)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Leases.cancelLease(Leases.java:206)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.RSRpcServices.scan(RSRpcServices.java:2551)&lt;br/&gt;
        at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:32205)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2134)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:103)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:130)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:107)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
2016-05-30 11:18:46,417 | DEBUG | B.defaultRpcServer.handler=29,queue=9,port=21302 | B.defaultRpcServer.handler=29,queue=9,port=21302: callId: 104 service: ClientService methodName: Scan size: 22 connection: xxxxxxxx:59645 | org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:106)&lt;br/&gt;
org.apache.hadoop.hbase.regionserver.LeaseException: lease &apos;17&apos; does not exist&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Leases.removeLease(Leases.java:221)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Leases.cancelLease(Leases.java:206)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.RSRpcServices.scan(RSRpcServices.java:2551)&lt;br/&gt;
        at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:32205)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2134)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:103)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:130)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:107)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
2016-05-30 11:18:46,427 | DEBUG | B.defaultRpcServer.handler=72,queue=12,port=21302 | B.defaultRpcServer.handler=72,queue=12,port=21302: callId: 94 service: ClientService methodName: Scan size: 22 connection: XXXXXXXX:59645 | org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:106)&lt;br/&gt;
org.apache.hadoop.hbase.regionserver.LeaseException: lease &apos;10&apos; does not exist&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Leases.removeLease(Leases.java:221)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Leases.cancelLease(Leases.java:206)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.RSRpcServices.scan(RSRpcServices.java:2551)&lt;br/&gt;
        at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:32205)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2134)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:103)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:130)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:107)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
2016-05-30 11:18:46,454 | DEBUG | B.defaultRpcServer.handler=59,queue=19,port=21302 | B.defaultRpcServer.handler=59,queue=19,port=21302: callId: 88 service: ClientService methodName: Scan size: 22 connection: xxxxxxxxx:59645 | org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:106)&lt;br/&gt;
org.apache.hadoop.hbase.regionserver.LeaseException: lease &apos;15&apos; does not exist&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Leases.removeLease(Leases.java:221)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.Leases.cancelLease(Leases.java:206)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.RSRpcServices.scan(RSRpcServices.java:2551)&lt;br/&gt;
        at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:32205)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2134)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:103)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:130)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:107)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;/p&gt;


&lt;p&gt;can any one give me some help?&lt;/p&gt;

&lt;p&gt;some information about my hbase cluster:&lt;/p&gt;

&lt;p&gt;hbase version: 1.0.0&lt;/p&gt;

&lt;p&gt;Configure: &lt;br/&gt;
hbase.client.scanner.timeout.period    120s&lt;br/&gt;
hbase.rpc.timeout      120s&lt;/p&gt;

&lt;p&gt;setCaching(1000)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12973885">HBASE-15914</key>
            <summary>lease expired exception when do scan with multiple thread</summary>
                <type id="5" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Wish</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="whthust">wht</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 May 2016 03:26:26 +0000</created>
                <updated>Wed, 1 Jun 2016 09:25:30 +0000</updated>
                                                                            <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="15306203" author="chenheng" created="Mon, 30 May 2016 03:37:01 +0000"  >&lt;p&gt;Please upload your jstack information.&lt;/p&gt;</comment>
                            <comment id="15306210" author="whthust" created="Mon, 30 May 2016 04:11:50 +0000"  >&lt;p&gt;Thanks to reply!&lt;/p&gt;

&lt;p&gt;does really need jstack to dump the stack of RS ?&lt;/p&gt;

&lt;p&gt;now I have not get this. if possible i will upload it later. &lt;/p&gt;


&lt;p&gt;can you give me some information according the above information. thanks again!&lt;/p&gt;</comment>
                            <comment id="15308220" author="anoop.hbase" created="Tue, 31 May 2016 17:51:57 +0000"  >&lt;p&gt;This is the Exception u are getting at client end right?  cancelLease() call seems to be done with LeaseException catch block..   Can u find the RS log around this time and put it here?&lt;/p&gt;</comment>
                            <comment id="15309995" author="whthust" created="Wed, 1 Jun 2016 09:25:30 +0000"  >&lt;p&gt;no&#65292; this  is exactly the RS log print&#65292;i mean the RS log print out the LeaseException, after that ,the RS prints out:&lt;/p&gt;


&lt;p&gt;2016-06-01 16:24:53,778 | DEBUG | RpcServer.reader=4,bindAddress=linux-cdh3,port=21302 | RpcServer.listener,port=21302: DISCONNECTING client 10.146.228.155:60775 because read count=-1. Number of active connections: 2 | org.apache.hadoop.hbase.ipc.RpcServer$Listener.doRead(RpcServer.java:862)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 30 May 2016 03:37:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yoin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>