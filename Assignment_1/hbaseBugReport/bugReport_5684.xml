<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:30:01 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5684/HBASE-5684.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5684] Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5684</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Currently ProcessBasedLocalHBaseCluster runs on top of raw local filesystem. We need it to start a process-based HDFS cluster as well. We also need to make the whole thing more stable so we can use it in unit tests.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12548880">HBASE-5684</key>
            <summary>Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikhail">Mikhail Bautin</assignee>
                                    <reporter username="mikhail">Mikhail Bautin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Mar 2012 22:12:13 +0000</created>
                <updated>Sat, 14 Apr 2012 05:58:22 +0000</updated>
                            <resolved>Sat, 14 Apr 2012 01:25:59 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13250389" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 01:51:14 +0000"  >&lt;p&gt;mbautin requested code review of &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, khemani, Karthik, madhuvaidya, amirshim, JIRA&lt;/p&gt;

&lt;p&gt;  Currently ProcessBasedLocalHBaseCluster runs on top of raw local filesystem. We need it to start a process-based HDFS cluster as well. We also need to make the whole thing more stable so we can use it in unit tests.&lt;/p&gt;

&lt;p&gt;  Also all logs of local HBase cluster daemons are now tailed to the primary log of the unit test with the appropriate prefixes to make debugging easier.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  Run the new unit test multiple times (10x or 50x).&lt;br/&gt;
  Run all unit tests.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  bin/hbase-config.sh&lt;br/&gt;
  bin/test/kill_process_based_cluster.sh&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestZKBasedCloseRegion.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestZKBasedReopenRegion.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestHBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/6195/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/6195/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13250415" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 02:31:16 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;  Patch looks good.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java:44 Should read &apos;to look up&apos;&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java:114 Why is sorting needed ?&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java:250 I think removing &apos;to kill&apos; would make the sentence clearer.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java:395 Should we add mapping for &apos;fs.defaultFS&apos; as well ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13250888" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 18:04:16 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;  Addressing Ted&apos;s comments. I will post a new version shortly.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java:114 Even though ports for same-type servers in the process-based cluster are selected randomly, it would still make sense to call the lowest-port server #0, the next-lowest #1, etc.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java:250 Done.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java:395 Done.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java:44 Done.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13250936" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 18:32:16 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, khemani, Karthik, madhuvaidya, amirshim, JIRA&lt;/p&gt;

&lt;p&gt;  Addressing Ted&apos;s comments. Also improving the utility script to be able to both show and kill local cluster daemons, now using the pid files stored in target/local_cluster.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  bin/hbase-config.sh&lt;br/&gt;
  bin/test/process_based_cluster.sh&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestZKBasedCloseRegion.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestZKBasedReopenRegion.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestHBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/p&gt;</comment>
                            <comment id="13250952" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 18:50:16 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;  Patch looks good.&lt;br/&gt;
  I was warned that there was unit test problem when I tried to accept.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestHBaseHomePath.java:24 This test doesn&apos;t have assertion.&lt;br/&gt;
  Is it possible to merge it into other test classes ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13251154" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 23:01:15 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, khemani, Karthik, madhuvaidya, amirshim, JIRA&lt;/p&gt;

&lt;p&gt;  Ted: I have moved testHomePath to the other unit test.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  bin/hbase-config.sh&lt;br/&gt;
  bin/test/process_based_cluster.sh&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestZKBasedCloseRegion.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestZKBasedReopenRegion.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/p&gt;</comment>
                            <comment id="13251157" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 23:05:14 +0000"  >&lt;p&gt;tedyu has accepted the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;  I still see &apos;This diff has Unit Test Problems.&apos;&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  make_processbasedlocalhbasecluster_run_&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt;_v9&lt;/p&gt;</comment>
                            <comment id="13251160" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 23:07:13 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;  Ted: do you mean &quot;Unit Tests Skipped&quot; at the top of the diff? We currently don&apos;t have integration between HBase unit tests and Arcanist/Phabricator.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  make_processbasedlocalhbasecluster_run_&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt;_v9&lt;/p&gt;</comment>
                            <comment id="13251162" author="zhihyu@ebaysf.com" created="Tue, 10 Apr 2012 23:07:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;do you mean &quot;Unit Tests Skipped&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes.&lt;/p&gt;</comment>
                            <comment id="13251179" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 23:39:14 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, khemani, Karthik, madhuvaidya, amirshim, JIRA, tedyu&lt;/p&gt;

&lt;p&gt;  Setting test timeout.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  bin/hbase-config.sh&lt;br/&gt;
  bin/test/process_based_cluster.sh&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestZKBasedCloseRegion.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestZKBasedReopenRegion.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/p&gt;</comment>
                            <comment id="13251860" author="phabricator@reviews.facebook.net" created="Wed, 11 Apr 2012 19:25:15 +0000"  >&lt;p&gt;Liyin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;  Mikhail, nice work&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; LGTM !&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  make_processbasedlocalhbasecluster_run_&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt;_v10&lt;/p&gt;</comment>
                            <comment id="13251867" author="phabricator@reviews.facebook.net" created="Wed, 11 Apr 2012 19:37:15 +0000"  >&lt;p&gt;amirshim has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;  Looks good.&lt;/p&gt;

&lt;p&gt;  As we talked, maybe we should use [&lt;span class=&quot;error&quot;&gt;&amp;#91;http://docs.oracle.com/javase/7/docs/api/java/nio/file/WatchService.html | WatchService&amp;#93;&lt;/span&gt;] for log tailer once we decide to move to Java 7.&lt;/p&gt;

&lt;p&gt;  And we might want to split HBaseTestingUtility.java at some point since it&apos;s over 1500 lines.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  make_processbasedlocalhbasecluster_run_&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt;_v10&lt;/p&gt;</comment>
                            <comment id="13252106" author="phabricator@reviews.facebook.net" created="Thu, 12 Apr 2012 00:56:13 +0000"  >&lt;p&gt;mbautin requested code review of &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;br/&gt;
Reviewers: tedyu, stack, lhofhansl, nspiegelberg, amirshim, JIRA&lt;/p&gt;

&lt;p&gt;  Currently ProcessBasedLocalHBaseCluster runs on top of raw local filesystem. We need it to start a process-based HDFS cluster as well. We also need to make the whole thing more stable so we can use it in unit tests.&lt;/p&gt;

&lt;p&gt;  Also all logs of local HBase cluster daemons are now tailed to the primary log of the unit test with the appropriate prefixes to make debugging easier.&lt;/p&gt;

&lt;p&gt;  This is a trunk diff. The 89-fb version is D2709.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  Run the new unit test multiple times (10x or 50x).&lt;br/&gt;
  Run all unit tests.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2757&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  bin/test/process_based_cluster.sh&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsck.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/6285/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/6285/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13252109" author="hadoopqa" created="Thu, 12 Apr 2012 01:02:35 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12522355/D2757.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12522355/D2757.1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 30 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1489//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1489//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13252152" author="phabricator@reviews.facebook.net" created="Thu, 12 Apr 2012 03:00:19 +0000"  >&lt;p&gt;tedyu has accepted the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java:93 Is this restriction needed ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2757&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  make_processbasedlocalhbasecluster_run_&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt;_v11&lt;/p&gt;</comment>
                            <comment id="13253056" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 01:57:14 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java:93 This is actually a stability fix. We have seen the load balancer shedding regions from most loaded regionservers in some tests.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2757&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  make_processbasedlocalhbasecluster_run_&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt;_v11&lt;/p&gt;</comment>
                            <comment id="13253076" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 03:25:21 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;br/&gt;
Reviewers: tedyu, stack, lhofhansl, nspiegelberg, amirshim, JIRA&lt;/p&gt;

&lt;p&gt;  Setting ZooKeeper data directory and adding test category.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2757&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  bin/test/process_based_cluster.sh&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsck.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/p&gt;</comment>
                            <comment id="13253081" author="hadoopqa" created="Fri, 13 Apr 2012 03:32:36 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12522524/D2757.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12522524/D2757.2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 30 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1505//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1505//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13253105" author="hadoopqa" created="Fri, 13 Apr 2012 04:42:08 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12522525/jira-HBASE-5684-Make-ProcessBasedLocalHBaseCluster-r-2012-04-12_20_42_02.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12522525/jira-HBASE-5684-Make-ProcessBasedLocalHBaseCluster-r-2012-04-12_20_42_02.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 40 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.TestReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestHLogSplit&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestMultiSlaveReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestHLog&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestMasterReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1506//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1506//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1506//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1506//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1506//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1506//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13253854" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 23:17:13 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;br/&gt;
Reviewers: tedyu, stack, lhofhansl, nspiegelberg, amirshim, JIRA&lt;/p&gt;

&lt;p&gt;  Rebasing on recent changes in trunk.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2757&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  bin/test/process_based_cluster.sh&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsck.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/p&gt;</comment>
                            <comment id="13253902" author="hadoopqa" created="Sat, 14 Apr 2012 00:13:27 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12522636/D2757.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12522636/D2757.3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 29 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.TestReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1519//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1519//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1519//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1519//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1519//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1519//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13253924" author="phabricator@reviews.facebook.net" created="Sat, 14 Apr 2012 01:25:16 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;br/&gt;
Reviewers: tedyu, stack, lhofhansl, nspiegelberg, amirshim, JIRA&lt;/p&gt;

&lt;p&gt;  Fixing a couple more minor things.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2757&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  bin/test/process_based_cluster.sh&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsck.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/p&gt;</comment>
                            <comment id="13253925" author="mikhail" created="Sat, 14 Apr 2012 01:25:59 +0000"  >&lt;p&gt;Committed to trunk.&lt;/p&gt;</comment>
                            <comment id="13253926" author="phabricator@reviews.facebook.net" created="Sat, 14 Apr 2012 01:27:13 +0000"  >&lt;p&gt;mbautin has committed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2757&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASE1326036&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASE1326036&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13253944" author="hudson" created="Sat, 14 Apr 2012 02:41:18 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2759 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2759/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2759/&lt;/a&gt;)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more&lt;br/&gt;
robust&lt;/p&gt;

&lt;p&gt;Summary:&lt;br/&gt;
Currently ProcessBasedLocalHBaseCluster runs on top of raw local filesystem. We&lt;br/&gt;
need it to start a process-based HDFS cluster as well. We also need to make the&lt;br/&gt;
whole thing more stable so we can use it in unit tests.&lt;/p&gt;

&lt;p&gt;Also all logs of local HBase cluster daemons are now tailed to the primary log&lt;br/&gt;
of the unit test with the appropriate prefixes to make debugging easier.&lt;/p&gt;

&lt;p&gt;This is a trunk diff. The 89-fb version is D2709.&lt;/p&gt;

&lt;p&gt;Test Plan:&lt;br/&gt;
Run the new unit test multiple times (10x or 50x).&lt;br/&gt;
Run all unit tests.&lt;/p&gt;

&lt;p&gt;Reviewers: tedyu, stack, lhofhansl, nspiegelberg, amirshim, JIRA&lt;/p&gt;

&lt;p&gt;Reviewed By: tedyu&lt;/p&gt;

&lt;p&gt;Differential Revision: &lt;a href=&quot;https://reviews.facebook.net/D2757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2757&lt;/a&gt; (Revision 1326036)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
mbautin : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/bin/test&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/bin/test/process_based_cluster.sh&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsck.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13253957" author="phabricator@reviews.facebook.net" created="Sat, 14 Apr 2012 02:57:13 +0000"  >&lt;p&gt;mbautin has committed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2709&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2709&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1326045&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1326045&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13253999" author="hudson" created="Sat, 14 Apr 2012 05:58:22 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #171 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/171/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/171/&lt;/a&gt;)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5684&quot; title=&quot;Make ProcessBasedLocalHBaseCluster run HDFS and make it more robust&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5684&quot;&gt;&lt;del&gt;HBASE-5684&lt;/del&gt;&lt;/a&gt; Make ProcessBasedLocalHBaseCluster run HDFS and make it more&lt;br/&gt;
robust&lt;/p&gt;

&lt;p&gt;Summary:&lt;br/&gt;
Currently ProcessBasedLocalHBaseCluster runs on top of raw local filesystem. We&lt;br/&gt;
need it to start a process-based HDFS cluster as well. We also need to make the&lt;br/&gt;
whole thing more stable so we can use it in unit tests.&lt;/p&gt;

&lt;p&gt;Also all logs of local HBase cluster daemons are now tailed to the primary log&lt;br/&gt;
of the unit test with the appropriate prefixes to make debugging easier.&lt;/p&gt;

&lt;p&gt;This is a trunk diff. The 89-fb version is D2709.&lt;/p&gt;

&lt;p&gt;Test Plan:&lt;br/&gt;
Run the new unit test multiple times (10x or 50x).&lt;br/&gt;
Run all unit tests.&lt;/p&gt;

&lt;p&gt;Reviewers: tedyu, stack, lhofhansl, nspiegelberg, amirshim, JIRA&lt;/p&gt;

&lt;p&gt;Reviewed By: tedyu&lt;/p&gt;

&lt;p&gt;Differential Revision: &lt;a href=&quot;https://reviews.facebook.net/D2757&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2757&lt;/a&gt; (Revision 1326036)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
mbautin : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/bin/test&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/bin/test/process_based_cluster.sh&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HTestConst.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/TestInfoServers.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/HBaseHomePath.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/ProcessBasedLocalHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/RestartMetaTest.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsck.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/TestProcessBasedCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12522059" name="ASF.LICENSE.NOT.GRANTED--D2709.1.patch" size="40475" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 01:51:15 +0000"/>
                            <attachment id="12522149" name="ASF.LICENSE.NOT.GRANTED--D2709.2.patch" size="42227" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 18:32:23 +0000"/>
                            <attachment id="12522176" name="ASF.LICENSE.NOT.GRANTED--D2709.3.patch" size="41195" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 23:01:17 +0000"/>
                            <attachment id="12522179" name="ASF.LICENSE.NOT.GRANTED--D2709.4.patch" size="41215" author="phabricator@reviews.facebook.net" created="Tue, 10 Apr 2012 23:39:15 +0000"/>
                            <attachment id="12522355" name="ASF.LICENSE.NOT.GRANTED--D2757.1.patch" size="45943" author="phabricator@reviews.facebook.net" created="Thu, 12 Apr 2012 00:56:14 +0000"/>
                            <attachment id="12522524" name="ASF.LICENSE.NOT.GRANTED--D2757.2.patch" size="46384" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 03:25:23 +0000"/>
                            <attachment id="12522636" name="ASF.LICENSE.NOT.GRANTED--D2757.3.patch" size="45194" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 23:17:14 +0000"/>
                            <attachment id="12522648" name="ASF.LICENSE.NOT.GRANTED--D2757.4.patch" size="45203" author="phabricator@reviews.facebook.net" created="Sat, 14 Apr 2012 01:25:17 +0000"/>
                            <attachment id="12522525" name="jira-HBASE-5684-Make-ProcessBasedLocalHBaseCluster-r-2012-04-12_20_42_02.patch" size="50847" author="mikhail" created="Fri, 13 Apr 2012 03:43:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 10 Apr 2012 01:51:14 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233977</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 35 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i016c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4796</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>