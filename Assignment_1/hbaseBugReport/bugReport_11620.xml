<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:24:59 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11620/HBASE-11620.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11620] Record the class name of Writer in WAL header so that only proper Reader can open the WAL file</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11620</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Reported by Kiran in this thread: &quot;HBase file encryption, inconsistencies observed and data loss&quot;&lt;/p&gt;

&lt;p&gt;After step 4 ( i.e disabling of WAL encryption, removing SecureProtobufReader/Writer and restart), read of encrypted WAL fails mainly due to EOF exception at Basedecoder. This is not considered as error and these WAL are being moved to /oldWALs.&lt;/p&gt;

&lt;p&gt;Following is observed in log files:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-07-30 19:44:29,254 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-1] wal.HLogSplitter: Splitting hlog: hdfs:&lt;span class=&quot;code-comment&quot;&gt;//HOST-16:18020/hbase/WALs/HOST-16,15264,1406725441997-splitting/HOST-16%2C15264%2C1406725441997.1406725444017, length=172
&lt;/span&gt;2014-07-30 19:44:29,254 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-1] wal.HLogSplitter: DistributedLogReplay = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2014-07-30 19:44:29,313 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-1] util.FSHDFSUtils: Recovering lease on dfs file hdfs:&lt;span class=&quot;code-comment&quot;&gt;//HOST-16:18020/hbase/WALs/HOST-16,15264,1406725441997-splitting/HOST-16%2C15264%2C1406725441997.1406725444017
&lt;/span&gt;2014-07-30 19:44:29,315 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-1] util.FSHDFSUtils: recoverLease=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, attempt=0 on file=hdfs:&lt;span class=&quot;code-comment&quot;&gt;//HOST-16:18020/hbase/WALs/HOST-16,15264,1406725441997-splitting/HOST-16%2C15264%2C1406725441997.1406725444017 after 1ms
&lt;/span&gt;2014-07-30 19:44:29,429 DEBUG [RS_LOG_REPLAY_OPS-HOST-16:15264-1-Writer-0] wal.HLogSplitter: Writer thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[RS_LOG_REPLAY_OPS-HOST-16:15264-1-Writer-0,5,main]: starting
2014-07-30 19:44:29,429 DEBUG [RS_LOG_REPLAY_OPS-HOST-16:15264-1-Writer-1] wal.HLogSplitter: Writer thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[RS_LOG_REPLAY_OPS-HOST-16:15264-1-Writer-1,5,main]: starting
2014-07-30 19:44:29,430 DEBUG [RS_LOG_REPLAY_OPS-HOST-16:15264-1-Writer-2] wal.HLogSplitter: Writer thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[RS_LOG_REPLAY_OPS-HOST-16:15264-1-Writer-2,5,main]: starting
2014-07-30 19:44:29,591 ERROR [RS_LOG_REPLAY_OPS-HOST-16:15264-1] codec.BaseDecoder: Partial cell read caused by EOF: java.io.IOException: Premature EOF from inputStream
2014-07-30 19:44:29,592 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-1] wal.HLogSplitter: Finishing writing output logs and closing down.
2014-07-30 19:44:29,592 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-1] wal.HLogSplitter: Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; split writer threads to finish
2014-07-30 19:44:29,592 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-1] wal.HLogSplitter: Split writers finished
2014-07-30 19:44:29,592 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-1] wal.HLogSplitter: Processed 0 edits across 0 regions; log file=hdfs:&lt;span class=&quot;code-comment&quot;&gt;//HOST-16:18020/hbase/WALs/HOST-16,15264,1406725441997-splitting/HOST-16%2C15264%2C1406725441997.1406725444017 is corrupted = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; progress failed = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;To fix this, we need to propagate EOF exception to HLogSplitter. Any suggestions on the fix?&lt;/p&gt;

&lt;p&gt;-------- (end of quote from Kiran)&lt;/p&gt;

&lt;p&gt;In BaseDecoder#rethrowEofException() :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isEof) &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; ioEx;
    LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Partial cell read caused by EOF: &quot;&lt;/span&gt; + ioEx);
    EOFException eofEx = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; EOFException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Partial cell read&quot;&lt;/span&gt;);
    eofEx.initCause(ioEx);
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; eofEx;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;throwing EOFException would not propagate the &quot;Partial cell read&quot; condition to HLogSplitter which doesn&apos;t treat EOFException as an error.&lt;/p&gt;

&lt;p&gt;I think IOException should be thrown above - HLogSplitter#getNextLogLine() would translate the IOEx to CorruptedLogFileException.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12730899">HBASE-11620</key>
            <summary>Record the class name of Writer in WAL header so that only proper Reader can open the WAL file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuzhihong@gmail.com">Ted Yu</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Jul 2014 20:11:52 +0000</created>
                <updated>Sat, 21 Feb 2015 23:30:30 +0000</updated>
                            <resolved>Fri, 1 Aug 2014 17:23:16 +0000</resolved>
                                    <version>0.98.4</version>
                                    <fixVersion>0.99.0</fixVersion>
                    <fixVersion>0.98.5</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="14079991" author="yuzhihong@gmail.com" created="Wed, 30 Jul 2014 21:19:22 +0000"  >&lt;p&gt;Tentative patch.&lt;/p&gt;</comment>
                            <comment id="14080229" author="ram_krish" created="Wed, 30 Jul 2014 23:49:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think a new exception type (DecoderException e.g.) should be used above.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No it cannot be.  I think that EOF case was added for some specific cases where there is a real file with no entry. &lt;/p&gt;</comment>
                            <comment id="14080325" author="apurtell" created="Thu, 31 Jul 2014 00:54:58 +0000"  >&lt;p&gt;Let&apos;s not forget the original sin of changing the WAL reader+writer implementation classes after a crash and before a restart. That cannot and should not be acceptable practice. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;, this could work if you can come up with a way for a codec to reliably tell the difference between EOF and corruption for some other reason. Just propagating EOF to the splitter seems contrary to current expected behavior. &lt;/p&gt;

&lt;p&gt;Edit: Or, deal with the actual user action here and consider a new optional field in the pbuf WAL header that carries the name of the class that wrote it. A reader can check if it can handle the output of that writer when the header is being read. The error at that point would be unambiguous.&lt;/p&gt;</comment>
                            <comment id="14080637" author="anoop.hbase" created="Thu, 31 Jul 2014 08:18:19 +0000"  >&lt;p&gt;+1 for Andy&apos;s suggestion&lt;/p&gt;</comment>
                            <comment id="14080908" author="ram_krish" created="Thu, 31 Jul 2014 14:01:07 +0000"  >&lt;p&gt;+1 for the suggestion. That would be the ideal one. So in these cases the user could make  wal encryption  false but should have the same reader and writer.?&lt;/p&gt;</comment>
                            <comment id="14081043" author="kiranmr" created="Thu, 31 Jul 2014 16:08:52 +0000"  >&lt;p&gt;I tested patch submitted by Ted Yu, its not working. Even though ioException is through instead of EOF, it is still not considered as corrupt.&lt;/p&gt;

&lt;p&gt;Here are the logs. Refer line with &lt;b&gt;Throwing ioEx instead of eofEx&lt;/b&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-07-31 21:19:11,923 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] wal.HLogSplitter: Splitting hlog: hdfs:&lt;span class=&quot;code-comment&quot;&gt;//HOST-16:18020/hbase/WALs/HOST-16,15264,1406821527620-splitting/HOST-16%2C15264%2C1406821527620.1406821561362, length=174
&lt;/span&gt;2014-07-31 21:19:11,923 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] wal.HLogSplitter: DistributedLogReplay = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2014-07-31 21:19:11,994 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] util.FSHDFSUtils: Recovering lease on dfs file hdfs:&lt;span class=&quot;code-comment&quot;&gt;//HOST-16:18020/hbase/WALs/HOST-16,15264,1406821527620-splitting/HOST-16%2C15264%2C1406821527620.1406821561362
&lt;/span&gt;2014-07-31 21:19:11,996 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] util.FSHDFSUtils: recoverLease=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, attempt=0 on file=hdfs:&lt;span class=&quot;code-comment&quot;&gt;//HOST-16:18020/hbase/WALs/HOST-16,15264,1406821527620-splitting/HOST-16%2C15264%2C1406821527620.1406821561362 after 2ms
&lt;/span&gt;2014-07-31 21:19:12,009 DEBUG [RS_LOG_REPLAY_OPS-HOST-16:15264-0-Writer-0] wal.HLogSplitter: Writer thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[RS_LOG_REPLAY_OPS-HOST-16:15264-0-Writer-0,5,main]: starting
2014-07-31 21:19:12,009 DEBUG [RS_LOG_REPLAY_OPS-HOST-16:15264-0-Writer-2] wal.HLogSplitter: Writer thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[RS_LOG_REPLAY_OPS-HOST-16:15264-0-Writer-2,5,main]: starting
2014-07-31 21:19:12,009 DEBUG [RS_LOG_REPLAY_OPS-HOST-16:15264-0-Writer-1] wal.HLogSplitter: Writer thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[RS_LOG_REPLAY_OPS-HOST-16:15264-0-Writer-1,5,main]: starting
2014-07-31 21:19:12,170 ERROR [RS_LOG_REPLAY_OPS-HOST-16:15264-0] codec.BaseDecoder: Partial cell read caused by EOF - Throwing ioEx instead of eofEx : java.io.IOException: Premature EOF from inputStream
2014-07-31 21:19:12,170 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] wal.HLogSplitter: Finishing writing output logs and closing down.
2014-07-31 21:19:12,170 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] wal.HLogSplitter: Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; split writer threads to finish
2014-07-31 21:19:12,170 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] wal.HLogSplitter: Split writers finished
2014-07-31 21:19:12,171 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] wal.HLogSplitter: Processed 0 edits across 0 regions; log file=hdfs:&lt;span class=&quot;code-comment&quot;&gt;//HOST-16:18020/hbase/WALs/HOST-16,15264,1406821527620-splitting/HOST-16%2C15264%2C1406821527620.1406821561362 is corrupted = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; progress failed = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/span&gt;2014-07-31 21:19:12,202 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] handler.HLogSplitterHandler: successfully transitioned task /hbase/splitWAL/WALs%2FHOST-10-18-40-16%2C15264%2C1406821527620-splitting%2FHOST-10-18-40-16%252C15264%252C1406821527620.1406821561362 to &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; state DONE HOST-16,15264,1406821739918
2014-07-31 21:19:12,202 INFO  [RS_LOG_REPLAY_OPS-HOST-16:15264-0] handler.HLogSplitterHandler: worker HOST-16,15264,1406821739918 done with task /hbase/splitWAL/WALs%2FHOST-10-18-40-16%2C15264%2C1406821527620-splitting%2FHOST-10-18-40-16%252C15264%252C1406821527620.1406821561362 in 316ms
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14081072" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 16:29:34 +0000"  >&lt;p&gt;What&apos;s the value for config &quot;hbase.hlog.split.skip.errors&quot; ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="14081152" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 17:25:03 +0000"  >&lt;p&gt;I am composing new patch which adds new optional field in the pbuf WAL header.&lt;br/&gt;
I plan to change the signature of the following method where the return value is an enum (ProtobufLogReader is makred InterfaceAudience.Private) :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; readHeader(Builder builder, FSDataInputStream stream) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14081194" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 18:00:29 +0000"  >&lt;p&gt;Patch v2 adds optional field to WAL header.&lt;/p&gt;

&lt;p&gt;Running WAL related tests now.&lt;/p&gt;</comment>
                            <comment id="14081383" author="apurtell" created="Thu, 31 Jul 2014 20:11:19 +0000"  >&lt;p&gt;Fix version 0.98.5+&lt;/p&gt;</comment>
                            <comment id="14081385" author="apurtell" created="Thu, 31 Jul 2014 20:12:12 +0000"  >&lt;p&gt;Please add a unit test that verifies this fix.&lt;/p&gt;</comment>
                            <comment id="14081475" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 21:08:15 +0000"  >&lt;p&gt;Patch v3 adds a test.&lt;/p&gt;</comment>
                            <comment id="14081489" author="apurtell" created="Thu, 31 Jul 2014 21:22:42 +0000"  >&lt;p&gt;That&apos;s an ok test. What do you think about one that writes an encrypted WAL then submits it to a HLogSplitter instance configured with ProtobufLogReader?&lt;br/&gt;
Edit: Pardon, I should be a bit more specific. Confirm that the splitter fails to read the file in a way that it is moved to the corrupt logs dir instead of oldWALs.&lt;/p&gt;</comment>
                            <comment id="14081516" author="hadoopqa" created="Thu, 31 Jul 2014 21:35:15 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12658969/11620-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12658969/11620-v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12658969&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestIOFencing&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestEndToEndSplitTransaction&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestRegionReplicas&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestMasterOperationsForRegionReplicas&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestReplicasClient&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestRestartCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.TestRegionRebalancing&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10248//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14081578" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 22:11:17 +0000"  >&lt;p&gt;In patch v4, WAL is submitted to HLogSplitter.&lt;/p&gt;

&lt;p&gt;For corrupted hlog code path, I haven&apos;t found a proper way to verify.&lt;br/&gt;
I observed the following in test output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-07-31 14:51:25,765 WARN  [main] wal.HLogSplitter(290): Could not get reader, corrupted log file file:/Users/tyu/trunk/hbase-server/target/test-data/aae07de8-e64e-45fa-b6d6-6ede1bbccc9b/log/hlog.1406843484910
org.apache.hadoop.hbase.regionserver.wal.HLogSplitter$CorruptedLogFileException: skipErrors=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; Could not open hlog file:/Users/tyu/trunk/hbase-server/target/test-data/aae07de8-e64e-45fa-b6d6-6ede1bbccc9b/log/hlog.1406843484910 ignoring
        at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter.getReader(HLogSplitter.java:602)
        at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter.splitLogFile(HLogSplitter.java:288)
        at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter.splitLogFile(HLogSplitter.java:231)
        at org.apache.hadoop.hbase.regionserver.wal.TestHLogReaderOnSecureHLog.testHLogReaderOnSecureHLog(TestHLogReaderOnSecureHLog.java:123)
...
Caused by: java.io.IOException: Expected ProtobufLogWriter, got SecureProtobufLogWriter
        at org.apache.hadoop.hbase.regionserver.wal.ProtobufLogReader.initInternal(ProtobufLogReader.java:140)
        at org.apache.hadoop.hbase.regionserver.wal.ProtobufLogReader.initReader(ProtobufLogReader.java:101)
        at org.apache.hadoop.hbase.regionserver.wal.ReaderBase.init(ReaderBase.java:69)
        at org.apache.hadoop.hbase.regionserver.wal.HLogFactory.createReader(HLogFactory.java:127)
        at org.apache.hadoop.hbase.regionserver.wal.HLogFactory.createReader(HLogFactory.java:90)
        at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter.getReader(HLogSplitter.java:668)
        at org.apache.hadoop.hbase.regionserver.wal.HLogSplitter.getReader(HLogSplitter.java:577)
        ... 27 more
2014-07-31 14:51:25,781 WARN  [main] wal.HLogSplitter(295): Nothing to split in log file file:/Users/tyu/trunk/hbase-server/target/test-data/aae07de8-e64e-45fa-b6d6-6ede1bbccc9b/log/hlog.1406843484910
2014-07-31 14:51:25,781 DEBUG [main] wal.HLogSplitter(367): Finishing writing output logs and closing down.
2014-07-31 14:51:25,781 INFO  [main] wal.HLogSplitter(380): Processed 0 edits across 0 regions; log file=file:/Users/tyu/trunk/hbase-server/target/test-data/aae07de8-e64e-45fa-b6d6-6ede1bbccc9b/log/hlog.1406843484910 is corrupted = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; progress failed = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;However, there was no exception coming out of HLogSplitter.splitLogFile.&lt;/p&gt;</comment>
                            <comment id="14081651" author="apurtell" created="Thu, 31 Jul 2014 23:06:35 +0000"  >&lt;p&gt;You could check the HFile ends up in the corrupt log dir. That&apos;s the desired outcome, correct &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kiranmr&quot; class=&quot;user-hover&quot; rel=&quot;kiranmr&quot;&gt;Kiran Kumar M R&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14081672" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 23:26:25 +0000"  >&lt;p&gt;Patch v5 verifies that unrecognized WAL file is sidelined.&lt;/p&gt;</comment>
                            <comment id="14081690" author="apurtell" created="Thu, 31 Jul 2014 23:44:46 +0000"  >&lt;p&gt;Thanks Ted. The test looks good and it does what you&apos;d expect. The remaining issue here is the SecureProtobufWALReader should be able to read files written by the ProtobufWALWriter. The first thing we do in SecureProtobufWALReader#readHeader is call super.readHeader(), which will fail because we&apos;re only checking for a single class name, not a list of valid options. After that change this looks good to go in.&lt;/p&gt;

&lt;p&gt;Please consider extending the unit test a bit to check that the SecureProtobufWALReader can read files written by the ProtobufWALWriter.&lt;/p&gt;</comment>
                            <comment id="14081913" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 05:15:50 +0000"  >&lt;p&gt;Patch v6 incorporates Andrew&apos;s comments.&lt;/p&gt;

&lt;p&gt;There&apos;re 2 tests: testHLogReaderOnSecureHLog and testSecureHLogReaderOnHLog&lt;/p&gt;</comment>
                            <comment id="14082061" author="hadoopqa" created="Fri, 1 Aug 2014 08:17:47 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12659092/11620-v6.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12659092/11620-v6.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12659092&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10255//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14082321" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 15:11:28 +0000"  >&lt;p&gt;Patch v6 applies to branch-1&lt;br/&gt;
I have run test suite for branch-1 on Linux - result looks good.&lt;/p&gt;</comment>
                            <comment id="14082345" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 15:31:18 +0000"  >&lt;p&gt;Patch for 0.98&lt;/p&gt;

&lt;p&gt;Running test suite now.&lt;/p&gt;</comment>
                            <comment id="14082474" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 16:44:53 +0000"  >&lt;p&gt;Test suite for 0.98 ran through.&lt;/p&gt;

&lt;p&gt;Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; for branch-1&lt;/p&gt;</comment>
                            <comment id="14082486" author="apurtell" created="Fri, 1 Aug 2014 16:53:30 +0000"  >&lt;p&gt;+1, patch v6&lt;/p&gt;

&lt;p&gt;Please update or remove the comments in testSecureHLogReaderOnHLog on commit, and fix the assert messages. The meaning of all the checks are reversed, but the text hasn&apos;t been updated to reflect that.&lt;/p&gt;</comment>
                            <comment id="14082506" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 17:03:35 +0000"  >&lt;p&gt;Patch v7 corrects wording in comments and assertion.&lt;/p&gt;</comment>
                            <comment id="14082513" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 17:06:34 +0000"  >&lt;p&gt;Counterpart for 0.98&lt;/p&gt;</comment>
                            <comment id="14082547" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 17:20:23 +0000"  >&lt;p&gt;Integrated to 3 branches.&lt;/p&gt;

&lt;p&gt;Will resolve once Jenkins builds come back.&lt;/p&gt;

&lt;p&gt;Thanks for the review, Andrew.&lt;/p&gt;</comment>
                            <comment id="14082559" author="apurtell" created="Fri, 1 Aug 2014 17:23:16 +0000"  >&lt;p&gt;Hope you don&apos;t mind that I resolved this now Ted. It&apos;s not a bad idea waiting for Jenkins but sometimes we forget to go back and close the issue. We can reopen this if there is a problem with a build somewhere.&lt;/p&gt;</comment>
                            <comment id="14082768" author="hudson" created="Fri, 1 Aug 2014 19:07:55 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #406 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/406/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/406/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11620&quot; title=&quot;Record the class name of Writer in WAL header so that only proper Reader can open the WAL file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11620&quot;&gt;&lt;del&gt;HBASE-11620&lt;/del&gt;&lt;/a&gt; Record the class name of Writer in WAL header so that only proper Reader can open the WAL file (Ted Yu) (tedyu: rev acc5c13f37c7b16058797e81a6ec4769d8335540)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-protocol/src/main/protobuf/WAL.proto&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogReaderOnSecureHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/WALProtos.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SecureProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogFactory.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SecureProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14082793" author="hudson" created="Fri, 1 Aug 2014 19:22:23 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98 #429 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/429/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/429/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11620&quot; title=&quot;Record the class name of Writer in WAL header so that only proper Reader can open the WAL file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11620&quot;&gt;&lt;del&gt;HBASE-11620&lt;/del&gt;&lt;/a&gt; Record the class name of Writer in WAL header so that only proper Reader can open the WAL file (Ted Yu) (tedyu: rev acc5c13f37c7b16058797e81a6ec4769d8335540)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogFactory.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/WALProtos.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SecureProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogReaderOnSecureHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SecureProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-protocol/src/main/protobuf/WAL.proto&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14082805" author="hudson" created="Fri, 1 Aug 2014 19:32:13 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5361 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5361/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5361/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11620&quot; title=&quot;Record the class name of Writer in WAL header so that only proper Reader can open the WAL file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11620&quot;&gt;&lt;del&gt;HBASE-11620&lt;/del&gt;&lt;/a&gt; Record the class name of Writer in WAL header so that only proper Reader can open the WAL file (Ted Yu) (tedyu: rev b384c06d35c89642510c097a1afc0228bff774fb)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SecureProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-protocol/src/main/protobuf/WAL.proto&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogFactory.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SecureProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/WALProtos.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogReaderOnSecureHLog.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14082846" author="hudson" created="Fri, 1 Aug 2014 20:02:25 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #80 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/80/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/80/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11620&quot; title=&quot;Record the class name of Writer in WAL header so that only proper Reader can open the WAL file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11620&quot;&gt;&lt;del&gt;HBASE-11620&lt;/del&gt;&lt;/a&gt; Record the class name of Writer in WAL header so that only proper Reader can open the WAL file (Ted Yu) (tedyu: rev e142961099cda5b3f733cd2239cb22ce150f5c08)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogReaderOnSecureHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SecureProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-protocol/src/main/protobuf/WAL.proto&lt;/li&gt;
	&lt;li&gt;hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/WALProtos.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SecureProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogFactory.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14097909" author="enis" created="Thu, 14 Aug 2014 23:34:20 +0000"  >&lt;p&gt;Related to this, should not we also write the CellCodec that we use in the WAL header. Right now, the codec comes from the configuration which means that you cannot read back the WAL files if you change the codec. What do you guys think, shall I open an issue? &lt;/p&gt;</comment>
                            <comment id="14097910" author="apurtell" created="Thu, 14 Aug 2014 23:36:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;Related to this, should not we also write the CellCodec that we use in the WAL header. Right now, the codec comes from the configuration which means that you cannot read back the WAL files if you change the codec. What do you guys think, shall I open an issue?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sounds good to me&lt;/p&gt;</comment>
                            <comment id="14098152" author="ram_krish" created="Fri, 15 Aug 2014 05:01:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;Related to this, should not we also write the CellCodec that we use in the WAL header. Right now, the codec comes from the configuration which means that you cannot read back the WAL files if you change the codec&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;+1.  Would be really helpful.&lt;/p&gt;</comment>
                            <comment id="14099161" author="yuzhihong@gmail.com" created="Fri, 15 Aug 2014 21:22:37 +0000"  >&lt;p&gt;I logged &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11762&quot; title=&quot;Record the class name of Codec in WAL header&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11762&quot;&gt;&lt;del&gt;HBASE-11762&lt;/del&gt;&lt;/a&gt; for writing Codec class name in WAL header.&lt;/p&gt;

&lt;p&gt;Initial patch attached.&lt;/p&gt;</comment>
                            <comment id="14330699" author="enis" created="Sat, 21 Feb 2015 23:30:30 +0000"  >&lt;p&gt;Closing this issue after 0.99.0 release. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12659165" name="11620-0.98-v6.txt" size="29213" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 15:31:18 +0000"/>
                            <attachment id="12659198" name="11620-0.98-v7.txt" size="29206" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 17:06:34 +0000"/>
                            <attachment id="12658738" name="11620-v1.txt" size="847" author="yuzhihong@gmail.com" created="Wed, 30 Jul 2014 21:19:22 +0000"/>
                            <attachment id="12658969" name="11620-v2.txt" size="20789" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 18:00:29 +0000"/>
                            <attachment id="12659004" name="11620-v3.txt" size="26100" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 21:08:15 +0000"/>
                            <attachment id="12659020" name="11620-v4.txt" size="26900" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 22:11:17 +0000"/>
                            <attachment id="12659038" name="11620-v5.txt" size="27153" author="yuzhihong@gmail.com" created="Thu, 31 Jul 2014 23:26:25 +0000"/>
                            <attachment id="12659152" name="11620-v6.txt" size="30771" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 13:32:27 +0000"/>
                            <attachment id="12659092" name="11620-v6.txt" size="30771" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 05:15:50 +0000"/>
                            <attachment id="12659195" name="11620-v7.txt" size="30770" author="yuzhihong@gmail.com" created="Fri, 1 Aug 2014 17:03:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 30 Jul 2014 23:49:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>408971</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1yd9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>408969</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>