<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:56:35 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8580/HBASE-8580.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8580] Ensure that there are 3 replicas when Flushing or Compacting</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8580</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;It is possible that datanodes in a DFS pipeline can be dropped.  When this happens it possible for there to be fewer than the number of replicas expected.  After a close on the file the namenode tries to re-replicate the file. On flush and compaction we should block waiting for the number of datanodes reporting that they have the needed blocks to be 3.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12648498">HBASE-8580</key>
            <summary>Ensure that there are 3 replicas when Flushing or Compacting</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 May 2013 20:24:38 +0000</created>
                <updated>Tue, 21 May 2013 00:22:41 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13662376" author="sershe" created="Mon, 20 May 2013 21:35:13 +0000"  >&lt;p&gt;We are not guaranteed that replicas will not fail during, or immediately after, we finish writing, or later, so we are only privileging some small window of time to ensure 3 replicas, and trying to marginally improve reliability over HDFS by poking around in the (semi-)internals.&lt;br/&gt;
How is this different from having &amp;lt;3 replicas at other time? Is there some specific bug/scenario you saw?&lt;/p&gt;</comment>
                            <comment id="13662384" author="enis" created="Mon, 20 May 2013 21:48:06 +0000"  >&lt;p&gt;We do log rolling if we detect that the replica count has gone below &quot;hbase.regionserver.hlog.tolerable.lowreplication&quot; (which is 3 on hdfs) for every sync in WAL. For flushes, and compactions, we do not care about the replication count for the blocks that are being written, but we might care for the min replication for all the blocks in the file after finalizing the file and before committing the results. For compaction for example, we probably do not want to replace files with replication 3 with compacted file with replication 2. But as Sergey said, datanodes can still fail just after we checked etc. &lt;/p&gt;</comment>
                            <comment id="13662413" author="eclark" created="Mon, 20 May 2013 22:26:40 +0000"  >&lt;p&gt;Yes there is no guarantee that things won&apos;t degrade.  But before we move files in from tmp we should know that they were on 3 datanodes at least when we did the move.&lt;/p&gt;

&lt;p&gt;Mostly this came from a user in #hbase irc.  He was seeing hfile corruption when region servers were crashing on heavy compactions.&lt;/p&gt;</comment>
                            <comment id="13662483" author="sershe" created="Tue, 21 May 2013 00:02:48 +0000"  >&lt;p&gt;Interesting... RSes crashing, or you mean data nodes crashing?&lt;/p&gt;</comment>
                            <comment id="13662501" author="eclark" created="Tue, 21 May 2013 00:22:41 +0000"  >&lt;p&gt;Both I believe, but you are correct Datanodes are the most relevant here.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 20 May 2013 21:35:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328853</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 30 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kql3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>329195</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>