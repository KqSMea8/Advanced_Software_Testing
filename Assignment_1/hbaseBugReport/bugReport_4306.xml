<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:17:44 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4306/HBASE-4306.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4306] Race between CatalogJanitor and LoadBalancer</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4306</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;It is possible for the LoadBalancer to try to assign an offline/split region while it is waiting to be CatalogJanitor&apos;ed. It goes like this:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2011-08-25 00:32:07,137 INFO org.apache.hadoop.hbase.master.ServerManager: Received REGION_SPLIT: parent: Daughters; d1, d2 from sv4r22s16,60020,1314211225331&lt;br/&gt;
...&lt;br/&gt;
(cleaning never happens or whatever)&lt;br/&gt;
...&lt;br/&gt;
2011-08-29 13:45:14,561 INFO org.apache.hadoop.hbase.master.HMaster: balance hri=parent, src=sv4r22s16,60020,1314211225331, dest=sv4r19s17,60020,1314218170402&lt;br/&gt;
2011-08-29 13:45:14,561 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region parent (offlining)&lt;br/&gt;
2011-08-29 13:45:14,588 INFO org.apache.hadoop.hbase.master.AssignmentManager: Server serverName=sv4r22s16,60020,1314211225331, load=(requests=0, regions=0, usedHeap=0, maxHeap=0) returned org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Received close for parent but we are not serving it for parent&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Here it took 4 days of balancing to finally get to try to balance the parent (that was never deleted because of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4238&quot; title=&quot;CatalogJanitor can clear a daughter that split before processing its parent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4238&quot;&gt;&lt;del&gt;HBASE-4238&lt;/del&gt;&lt;/a&gt;), but it can also happen if the balancer decides to balance the parent just before it&apos;s cleaned. The end effect is that the balancer will be disabled &lt;em&gt;forever&lt;/em&gt; until that&apos;s fixed.&lt;/p&gt;

&lt;p&gt;The culprit here is that the master keeps the region &quot;online&quot; until AssignmentManager.regionOffline is called by the CJ, which means it&apos;s still treated like any other region although it&apos;s offline.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12520851">HBASE-4306</key>
            <summary>Race between CatalogJanitor and LoadBalancer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Aug 2011 23:00:36 +0000</created>
                <updated>Wed, 24 Dec 2014 19:50:10 +0000</updated>
                            <resolved>Wed, 24 Dec 2014 19:50:10 +0000</resolved>
                                    <version>0.90.4</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13103864" author="stack" created="Tue, 13 Sep 2011 18:26:57 +0000"  >&lt;p&gt;When a region splits, handleSplitReport is called on master.  It calls AM.regionOffline so the split parent region should be cleared from AM.regions.  It should not be in set to balance.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4238&quot; title=&quot;CatalogJanitor can clear a daughter that split before processing its parent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4238&quot;&gt;&lt;del&gt;HBASE-4238&lt;/del&gt;&lt;/a&gt; being fixed should at least change this from being a blocker to something less?&lt;/p&gt;</comment>
                            <comment id="13103873" author="stack" created="Tue, 13 Sep 2011 18:30:41 +0000"  >&lt;p&gt;Chatting with J-D.  Something else must be going on here if the parent region is in the set of regions to balance, the split message must have been missed.&lt;/p&gt;

&lt;p&gt;Changing this from blocker to major.  Removing as necessary fix on 0.92. and 0.90.5 till we learn more.&lt;/p&gt;</comment>
                            <comment id="14258490" author="apurtell" created="Wed, 24 Dec 2014 19:50:10 +0000"  >&lt;p&gt;Wasn&apos;t clearly diagnosed in the first place, marking as Invalid&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Sep 2011 18:26:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27254</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 51 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02ec7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11924</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>