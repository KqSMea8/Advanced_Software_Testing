<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:50:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1046/HBASE-1046.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1046] Region assigned to two regionservers after split</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1046</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;After reassignment of region split, scanners (mapred tasks) fail:&lt;/p&gt;

&lt;p&gt;org.apache.hadoop.hbase.client.RetriesExhaustedException: Trying to contact region server 10.30.94.49:60020 for region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257, row &apos;c4e518dc579ca98bf97ea13d1f7c80fc&apos;, but failed after 10 attempts.&lt;br/&gt;
Exceptions:&lt;br/&gt;
java.io.IOException: java.io.IOException: HStoreScanner failed construction&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.(StoreFileScanner.java:70)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HStoreScanner.(HStoreScanner.java:84)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HStore.getScanner(HStore.java:2113)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion$HScanner.(HRegion.java:1847)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion.getScanner(HRegion.java:1158)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegionServer.openScanner(HRegionServer.java:1521)&lt;br/&gt;
	at sun.reflect.GeneratedMethodAccessor18.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HbaseRPC$Server.call(HbaseRPC.java:634)&lt;br/&gt;
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:888)&lt;br/&gt;
Caused by: java.io.FileNotFoundException: File does not exist: hdfs://sjdc-atr-dc-1.atr.trendmicro.com:50000/data/hbase/content/1137747785/info/mapfiles/3405780294391796198/data&lt;br/&gt;
	at org.apache.hadoop.dfs.DistributedFileSystem.getFileStatus(DistributedFileSystem.java:394)&lt;br/&gt;
	at org.apache.hadoop.fs.FileSystem.getLength(FileSystem.java:695)&lt;br/&gt;
	at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:1420)&lt;br/&gt;
	at org.apache.hadoop.io.SequenceFile$Reader.(SequenceFile.java:1415)&lt;br/&gt;
	at org.apache.hadoop.io.MapFile$Reader.createDataFileReader(MapFile.java:301)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.HBaseMapFile$HBaseReader.createDataFileReader(HBaseMapFile.java:98)&lt;br/&gt;
	at org.apache.hadoop.io.MapFile$Reader.open(MapFile.java:283)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.HBaseMapFile$HBaseReader.(HBaseMapFile.java:81)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.BloomFilterMapFile$Reader.(BloomFilterMapFile.java:66)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.HalfMapFileReader.(HalfMapFileReader.java:86)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HStoreFile.getReader(HStoreFile.java:438)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.openReaders(StoreFileScanner.java:96)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.(StoreFileScanner.java:67)&lt;br/&gt;
	... 10 more&lt;/p&gt;

&lt;p&gt;According to the master the regions around this row are:&lt;/p&gt;

&lt;p&gt;content,c4580f7292ceb2f6c8d732d935302633,1228328680554  	10.30.94.50:60020  	693011073 	c4580f7292ceb2f6c8d732d935302633  	c4e518dc579ca98bf97ea13d1f7c80fc&lt;br/&gt;
content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 	10.30.94.49:60020 	2031068422 	c4e518dc579ca98bf97ea13d1f7c80fc 	c528c8864e67a3addcb50587586dfe38&lt;/p&gt;

&lt;p&gt;On 10.30.94.49, just before the HStoreScanner exceptions begin:&lt;/p&gt;

&lt;p&gt;2008-12-04 16:18:30,538 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: MSG_REGION_OPEN: content,c528c8864e67a3addcb50587586dfe38,1228407504257&lt;br/&gt;
2008-12-04 16:18:30,539 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: MSG_REGION_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
2008-12-04 16:18:30,539 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Worker: MSG_REGION_OPEN: content,c528c8864e67a3addcb50587586dfe38,1228407504257&lt;br/&gt;
2008-12-04 16:18:30,633 INFO org.apache.hadoop.hbase.regionserver.HRegion: region content,c528c8864e67a3addcb50587586dfe38,1228407504257/1813242175 available&lt;br/&gt;
2008-12-04 16:18:30,633 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Worker: MSG_REGION_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
2008-12-04 16:18:30,725 INFO org.apache.hadoop.hbase.regionserver.HRegion: region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257/2031068422 available&lt;br/&gt;
2008-12-04 16:18:36,659 INFO org.apache.hadoop.hbase.regionserver.HRegion: starting compaction on region content,c528c8864e67a3addcb50587586dfe38,1228407504257&lt;br/&gt;
2008-12-04 16:18:36,673 ERROR org.apache.hadoop.hbase.regionserver.CompactSplitThread: Compaction failed for region content,c528c8864e67a3addcb50587586dfe38,1228407504257&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HStore.compact(HStore.java:863)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.compactStores(HRegion.java:708)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.compactStores(HRegion.java:666)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.CompactSplitThread.run(CompactSplitThread.java:87)&lt;br/&gt;
2008-12-04 16:18:36,689 INFO org.apache.hadoop.hbase.regionserver.HRegion: starting compaction on region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
2008-12-04 16:18:36,691 ERROR org.apache.hadoop.hbase.regionserver.CompactSplitThread: Compaction failed for region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HStore.compact(HStore.java:863)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.compactStores(HRegion.java:708)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.compactStores(HRegion.java:666)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.CompactSplitThread.run(CompactSplitThread.java:87)&lt;/p&gt;

&lt;p&gt;This is the region history:&lt;/p&gt;

&lt;p&gt;content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
  Thu, 4 Dec 2008 11:18:33	open	Region opened on server : 10.30.94.49&lt;br/&gt;
  Thu, 4 Dec 2008 11:18:30	assignment	Region assigned to server   10.30.94.49:60020&lt;br/&gt;
  Thu, 4 Dec 2008 11:18:28	open	Region opened on server : 10.30.94.54:60020&lt;br/&gt;
  Thu, 4 Dec 2008 11:18:25	assignment	Region assigned to server 10.30.94.54:60020&lt;br/&gt;
  Thu, 4 Dec 2008 11:18:25	split	Region split from: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554&lt;/p&gt;

&lt;p&gt;On 10.30.94.49:&lt;/p&gt;

&lt;p&gt;2008-12-04 16:17:39,550 INFO org.apache.hadoop.hbase.regionserver.HRegionServer:&lt;br/&gt;
 MSG_REGION_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554&lt;br/&gt;
2008-12-04 16:17:39,550 INFO org.apache.hadoop.hbase.regionserver.HRegionServer:&lt;br/&gt;
 MSG_REGION_OPEN: content,61938ad11c92493c1aac82932651b873,1228317826934&lt;br/&gt;
2008-12-04 16:18:17,469 INFO org.apache.hadoop.hbase.regionserver.HRegion: starting compaction on region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554&lt;br/&gt;
2008-12-04 16:18:24,255 INFO org.apache.hadoop.hbase.regionserver.HRegion: compac&lt;br/&gt;
tion completed on region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 in 6sec&lt;br/&gt;
2008-12-04 16:18:24,255 INFO org.apache.hadoop.hbase.regionserver.HRegion: Starting split of region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554&lt;br/&gt;
2008-12-04 16:18:24,258 INFO org.apache.hadoop.hbase.regionserver.HRegion: Closed content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554&lt;br/&gt;
2008-12-04 16:18:24,745 INFO org.apache.hadoop.hbase.regionserver.HRegion: region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257/2031068422 available&lt;br/&gt;
2008-12-04 16:18:24,746 INFO org.apache.hadoop.hbase.regionserver.HRegion: Closed content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
2008-12-04 16:18:25,051 INFO org.apache.hadoop.hbase.regionserver.HRegion: region content,c528c8864e67a3addcb50587586dfe38,1228407504257/1813242175 available&lt;br/&gt;
2008-12-04 16:18:25,052 INFO org.apache.hadoop.hbase.regionserver.HRegion: Closed content,c528c8864e67a3addcb50587586dfe38,1228407504257&lt;br/&gt;
2008-12-04 16:18:25,066 INFO org.apache.hadoop.hbase.regionserver.CompactSplitThread: region split, META updated, and report to master all successful. Old region=&lt;br/&gt;
REGION =&amp;gt; {NAME =&amp;gt; content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554&apos;, STARTKEY =&amp;gt; &apos;c4e518dc579ca98bf97ea13d1f7c80fc&apos;, ENDKEY =&amp;gt; c56eb508be0009d04429b6977c&lt;br/&gt;
91a425&apos;, ENCODED =&amp;gt; 1137747785, OFFLINE =&amp;gt; true, SPLIT =&amp;gt; true, TABLE =&amp;gt; {{NAME =&amp;gt; &apos;content&apos;, IS_ROOT =&amp;gt; &apos;false&apos;, IS_META =&amp;gt; &apos;false&apos;, FAMILIES =&amp;gt; [&lt;/p&gt;
{NAME =&amp;gt; &apos;url&apos;, BLOOMFILTER =&amp;gt; &apos;false&apos;, VERSIONS =&amp;gt; &apos;1&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, LENGTH =&amp;gt; &apos;2147483647&apos;, TTL =&amp;gt; &apos;2592000&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;false&apos;}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;info&apos;, BLOOMFILTER =&amp;gt; &apos;false&apos;, VERSIONS =&amp;gt; &apos;1&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, LENGTH =&amp;gt; &apos;2147483647&apos;, TTL =&amp;gt; &apos;2592000&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;false&apos;}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;content&apos;, BLOOMFILTER =&amp;gt; &apos;false&apos;, VERSIONS =&amp;gt; &apos;1&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, LENGTH =&amp;gt; &apos;2147483647&apos;, TTL =&amp;gt; &apos;2592000&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;false&apos;}
&lt;p&gt;]}}, new regions: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257, content,c528c8864e67a3addcb50587586dfe38,1228407504257. Split took 0sec&lt;/p&gt;

&lt;p&gt;On 10.30.94.54:&lt;/p&gt;

&lt;p&gt;2008-12-04 16:18:25,681 INFO org.apache.hadoop.hbase.regionserver.HRegionServer:&lt;br/&gt;
 Worker: MSG_REGION_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
2008-12-04 16:18:25,681 INFO org.apache.hadoop.hbase.regionserver.HRegion: starting compaction on region content,c528c8864e67a3addcb50587586dfe38,1228407504257&lt;br/&gt;
2008-12-04 16:18:25,867 INFO org.apache.hadoop.hbase.regionserver.HRegion: region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257/2031068422 available&lt;br/&gt;
2008-12-04 16:18:32,951 INFO org.apache.hadoop.hbase.regionserver.HRegion: compaction completed on region content,c528c8864e67a3addcb50587586dfe38,1228407504257 in 7sec&lt;br/&gt;
2008-12-04 16:18:32,951 INFO org.apache.hadoop.hbase.regionserver.HRegion: starting compaction on region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
2008-12-04 16:18:35,882 INFO org.apache.hadoop.hbase.regionserver.HRegion: compaction completed on region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 in 2sec&lt;/p&gt;</description>
                <environment></environment>
        <key id="12409994">HBASE-1046</key>
            <summary>Region assigned to two regionservers after split</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12392212">HBASE-543</parent>
                                    <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jimk">Jim Kellerman</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Dec 2008 19:14:11 +0000</created>
                <updated>Sun, 13 Sep 2009 22:26:34 +0000</updated>
                            <resolved>Wed, 24 Dec 2008 00:37:24 +0000</resolved>
                                                    <fixVersion>0.19.0</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12653419" author="apurtell" created="Thu, 4 Dec 2008 19:14:41 +0000"  >&lt;p&gt;Marking as blocker. Seems quite serious.&lt;/p&gt;</comment>
                            <comment id="12653428" author="apurtell" created="Thu, 4 Dec 2008 19:37:52 +0000"  >&lt;p&gt;I think 10.30.94.49 and 10.30.94.54 tried to compact the same region at roughly the same time.&lt;/p&gt;

&lt;p&gt;On 10.30.94.49:&lt;/p&gt;

&lt;p&gt;2008-12-04 16:18:36,689 INFO org.apache.hadoop.hbase.regionserver.HRegion: starting compaction on region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
2008-12-04 16:18:36,691 ERROR org.apache.hadoop.hbase.regionserver.CompactSplitThread: Compaction failed for region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
java.lang.NullPointerException&lt;/p&gt;

&lt;p&gt;On 10.30.94.54:&lt;/p&gt;

&lt;p&gt;2008-12-04 16:18:32,951 INFO org.apache.hadoop.hbase.regionserver.HRegion: starting compaction on region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257&lt;br/&gt;
2008-12-04 16:18:35,882 INFO org.apache.hadoop.hbase.regionserver.HRegion: compaction completed on region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 in 2sec&lt;/p&gt;</comment>
                            <comment id="12653431" author="apurtell" created="Thu, 4 Dec 2008 19:42:04 +0000"  >&lt;p&gt;Edited the title of this issue to reflect analysis findings. &lt;/p&gt;</comment>
                            <comment id="12653446" author="apurtell" created="Thu, 4 Dec 2008 20:04:20 +0000"  >&lt;p&gt;Both daughter regions are damaged. Both seem to be multiply assigned. &lt;/p&gt;

&lt;p&gt;Everything relevant from the master log:&lt;/p&gt;

&lt;p&gt;For content,c4e518dc579ca98bf97ea13d1f7c80fc&lt;/p&gt;

&lt;p&gt;2008-12-04 06:17:39,549 INFO org.apache.hadoop.hbase.master.RegionManager: assigning region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 to server 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:17:42,578 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 from 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:17:45,595 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 from 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:17:45,595 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 open on 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:17:45,595 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 in region .META.,,1 with startcode 1228396338736 and server 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:25,482 INFO org.apache.hadoop.hbase.master.RegionManager: assigning region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 to server 10.30.94.54:60020&lt;br/&gt;
2008-12-04 06:18:28,501 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 from 10.30.94.54:60020&lt;br/&gt;
2008-12-04 06:18:28,502 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c528c8864e67a3addcb50587586dfe38,1228407504257 in region .META.,,1 with startcode 1228377257408 and server 10.30.94.54:60020&lt;br/&gt;
2008-12-04 06:18:28,503 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 open on 10.30.94.54:60020&lt;br/&gt;
2008-12-04 06:18:28,503 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 in region .META.,,1 with startcode 1228377257408 and server 10.30.94.54:60020&lt;br/&gt;
2008-12-04 06:18:30,538 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_SPLIT: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 split; daughters: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257, content,c528c8864e67a3addcb50587586dfe38,1228407504257 from 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:30,539 INFO org.apache.hadoop.hbase.master.RegionManager: assigning region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 to server 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:33,548 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 from 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:33,549 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 from 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:33,549 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c528c8864e67a3addcb50587586dfe38,1228407504257 open on 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:33,549 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c528c8864e67a3addcb50587586dfe38,1228407504257 in region .META.,,1 with startcode 1228396338736 and server 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:33,550 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 open on 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:33,550 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 in region .META.,,1 with startcode 1228396338736 and server 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:19:25,439 INFO org.apache.hadoop.hbase.master.BaseScanner: Deleting region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 because daughter splits no longer hold references&lt;/p&gt;

&lt;p&gt;For content,c528c8864e67a3addcb50587586dfe38:&lt;/p&gt;

&lt;p&gt;2008-12-04 06:18:25,480 INFO org.apache.hadoop.hbase.master.RegionManager: assigning region content,c528c8864e67a3addcb50587586dfe38,1228407504257 to server 10.30.94.54:60020&lt;br/&gt;
2008-12-04 06:18:28,501 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_OPEN: content,c528c8864e67a3addcb50587586dfe38,1228407504257 from 10.30.94.54:60020&lt;br/&gt;
2008-12-04 06:18:28,501 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c528c8864e67a3addcb50587586dfe38,1228407504257 open on 10.30.94.54:60020&lt;br/&gt;
2008-12-04 06:18:28,502 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c528c8864e67a3addcb50587586dfe38,1228407504257 in region .META.,,1 with startcode 1228377257408 and server 10.30.94.54:60020&lt;br/&gt;
2008-12-04 06:18:30,538 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_SPLIT: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 split; daughters: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257, content,c528c8864e67a3addcb50587586dfe38,1228407504257 from 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:30,538 INFO org.apache.hadoop.hbase.master.RegionManager: assigning region content,c528c8864e67a3addcb50587586dfe38,1228407504257 to server 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:33,549 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_OPEN: content,c528c8864e67a3addcb50587586dfe38,1228407504257 from 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:33,549 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c528c8864e67a3addcb50587586dfe38,1228407504257 open on 10.30.94.49:60020&lt;br/&gt;
2008-12-04 06:18:33,549 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c528c8864e67a3addcb50587586dfe38,1228407504257 in region .META.,,1 with startcode 1228396338736 and server 10.30.94.49:60020&lt;/p&gt;</comment>
                            <comment id="12653449" author="apurtell" created="Thu, 4 Dec 2008 20:08:35 +0000"  >&lt;p&gt;From the master log you would think that RegionManager assigned out a daughter region 5 seconds before ServerManager processed the MSG_REPORT_SPLIT that informed the master of the daughter in the first place. &lt;/p&gt;</comment>
                            <comment id="12653485" author="stack" created="Thu, 4 Dec 2008 21:15:49 +0000"  >&lt;p&gt;Looking at code, I cannot see how opens would be processed after splits though evidence presented above would indicate this is happening.  Here is full lifecycle of region listed above from log Andrews sent:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2008-12-04 02:54:23,504 INFO org.apache.hadoop.hbase.master.RegionManager: assigning region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 to server 10.30.94.32:60020
2008-12-04 02:54:26,831 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 from 10.30.94.32:60020
2008-12-04 02:54:29,875 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 from 10.30.94.32:60020
2008-12-04 02:54:32,882 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 from 10.30.94.32:60020
2008-12-04 02:54:35,905 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 from 10.30.94.32:60020
2008-12-04 02:54:38,924 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 from 10.30.94.32:60020
2008-12-04 02:54:38,925 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 open on 10.30.94.32:60020
2008-12-04 02:54:38,925 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 in region .META.,,1 with startcode 1228377259645 and server 10.30.94.32:60020
2008-12-04 11:17:39,549 INFO org.apache.hadoop.hbase.master.RegionManager: assigning region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 to server 10.30.94.49:60020
2008-12-04 11:17:42,578 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 from 10.30.94.49:60020
2008-12-04 11:17:45,595 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 from 10.30.94.49:60020
2008-12-04 11:17:45,595 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 open on 10.30.94.49:60020
2008-12-04 11:17:45,595 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 in region .META.,,1 with startcode 1228396338736 and server 10.30.94.49:60020
2008-12-04 11:18:25,482 INFO org.apache.hadoop.hbase.master.RegionManager: assigning region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 to server 10.30.94.54:60020
2008-12-04 11:18:28,501 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 from 10.30.94.54:60020
2008-12-04 11:18:28,501 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 from 10.30.94.54:60020
2008-12-04 11:18:28,503 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 open on 10.30.94.54:60020
2008-12-04 11:18:28,503 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 in region .META.,,1 with startcode 1228377257408 and server 10.30.94.54:60020
2008-12-04 11:18:30,538 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_SPLIT: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 split; daughters: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257, content,c528c8864e67a3addcb50587586dfe38,1228407504257 from 10.30.94.49:60020
2008-12-04 11:18:30,539 INFO org.apache.hadoop.hbase.master.RegionManager: assigning region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 to server 10.30.94.49:60020
2008-12-04 11:18:33,548 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_PROCESS_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 from 10.30.94.49:60020
2008-12-04 11:18:33,549 INFO org.apache.hadoop.hbase.master.ServerManager: Received MSG_REPORT_OPEN: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 from 10.30.94.49:60020
2008-12-04 11:18:33,550 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 open on 10.30.94.49:60020
2008-12-04 11:18:33,550 INFO org.apache.hadoop.hbase.master.ProcessRegionOpen$1: updating row content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 in region .META.,,1 with startcode 1228396338736 and server 10.30.94.49:60020
2008-12-04 11:19:25,439 INFO org.apache.hadoop.hbase.master.BaseScanner: Deleting region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228328680554 because daughter splits no longer hold references
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Trying to figure out what happed to host 32 around 11:17:39,549.  Log is at INFO but should see server lease expired or MSG_REGION_CLOSE if they came in.&lt;/p&gt;</comment>
                            <comment id="12653492" author="stack" created="Thu, 4 Dec 2008 21:29:34 +0000"  >&lt;p&gt;See this for server 32:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2008-12-04 11:17:21,541 INFO org.apache.hadoop.hbase.master.ServerManager: Received start message from: 10.30.94.32:60020
2008-12-04 11:17:22,258 INFO org.apache.hadoop.hbase.master.ServerManager: Cancelling lease &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 10.30.94.32:60020
2008-12-04 11:18:52,722 INFO org.apache.hadoop.hbase.master.ServerManager: Received start message from: 10.30.94.32:60020
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So that explains why region was assigned to 49.&lt;/p&gt;

&lt;p&gt;There is definetly a hiccup in here.  How does master get to know of new region content,c4e518dc579ca98bf97ea13d1f7c80fc,1228407504257 before it gets the split message?  Once assigned, why is it assigned anew after split processing?&lt;/p&gt;</comment>
                            <comment id="12654022" author="apurtell" created="Sat, 6 Dec 2008 02:00:06 +0000"  >&lt;p&gt;I think it happened again after regionserver went down with oome and the region was reassigned twice. I sent the master and region server logs at DEBUG level to stack at his gmail address. I&apos;m still on the road so did not have time to look them over in any detail. &lt;/p&gt;</comment>
                            <comment id="12655050" author="apurtell" created="Wed, 10 Dec 2008 01:01:11 +0000"  >&lt;p&gt;I think an important part of the recipe to reproduce is artificial loading of DFS and of the CPU of the master node.&lt;/p&gt;</comment>
                            <comment id="12657259" author="stack" created="Wed, 17 Dec 2008 01:38:41 +0000"  >&lt;p&gt;Thing to try: Add a pause to the HRS &amp;#8211; into CompactSplitThread around line #186 &amp;#8211; after it updates .META. with split info.  Make pause &amp;gt; master metascan period.  Are regions assigned twice?&lt;/p&gt;</comment>
                            <comment id="12658188" author="stack" created="Fri, 19 Dec 2008 21:35:48 +0000"  >&lt;p&gt;Any progress on this or 1051?&lt;/p&gt;</comment>
                            <comment id="12658189" author="jimk" created="Fri, 19 Dec 2008 21:38:50 +0000"  >&lt;p&gt;Working on them.&lt;/p&gt;</comment>
                            <comment id="12658192" author="stack" created="Fri, 19 Dec 2008 21:42:43 +0000"  >&lt;p&gt;Have you been able to reproduce?  Any ETA on when done?  Thanks.&lt;/p&gt;</comment>
                            <comment id="12658194" author="jimk" created="Fri, 19 Dec 2008 21:44:52 +0000"  >&lt;p&gt;Yes, I have been able to reproduce it.&lt;br/&gt;
Hopefully I&apos;ll have a patch later today.&lt;/p&gt;</comment>
                            <comment id="12658196" author="stack" created="Fri, 19 Dec 2008 21:48:11 +0000"  >&lt;p&gt;Good stuff&lt;/p&gt;</comment>
                            <comment id="12659010" author="jimk" created="Wed, 24 Dec 2008 00:37:24 +0000"  >&lt;p&gt;Fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-543&quot; title=&quot;A region&amp;#39;s state is kept in several places in the master opening the possibility for race conditions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-543&quot;&gt;&lt;del&gt;HBASE-543&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 4 Dec 2008 21:15:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hazz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99044</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>