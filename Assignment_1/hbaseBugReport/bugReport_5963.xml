<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:32:33 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5963/HBASE-5963.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5963] ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5963</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
12/05/08 19:49:26 INFO regionserver.HRegionServer: STOPPED: Failed initialization
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.ClassCastException: org.apache.hadoop.fs.FileSystem$Cache$ClientFinalizer cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;
	at org.apache.hadoop.hbase.regionserver.ShutdownHook.suppressHdfsShutdownHook(ShutdownHook.java:181)
	at org.apache.hadoop.hbase.regionserver.ShutdownHook.install(ShutdownHook.java:82)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.startRegionServer(HRegionServer.java:3601)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.startRegionServer(HRegionServer.java:3585)
	at org.apache.hadoop.hbase.regionserver.HRegionServerCommandLine.start(HRegionServerCommandLine.java:61)
	at org.apache.hadoop.hbase.regionserver.HRegionServerCommandLine.run(HRegionServerCommandLine.java:75)
	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)
	at org.apache.hadoop.hbase.util.ServerCommandLine.doMain(ServerCommandLine.java:76)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.main(HRegionServer.java:3645)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Bigtop 0.4.0-incubating-SNAPSHOT, Hadoop 2.0.0-alpha-SNAPSHOT, HBase 0.94.0-SNAPSHOT&lt;/p&gt;</environment>
        <key id="12554376">HBASE-5963</key>
            <summary>ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zhihyu@ebaysf.com">Ted Yu</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 May 2012 19:56:22 +0000</created>
                <updated>Tue, 26 Feb 2013 08:15:53 +0000</updated>
                            <resolved>Wed, 9 May 2012 18:43:54 +0000</resolved>
                                    <version>0.94.0</version>
                    <version>0.95.2</version>
                                    <fixVersion>0.94.1</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13270798" author="zhihyu@ebaysf.com" created="Tue, 8 May 2012 20:29:28 +0000"  >&lt;p&gt;hadoop 2.0 has its own ShutdownHookManager&lt;br/&gt;
We need to provide shim which hides Java Runtime w.r.t. shutdown hook management.&lt;/p&gt;</comment>
                            <comment id="13270823" author="apurtell" created="Tue, 8 May 2012 21:02:02 +0000"  >&lt;p&gt;How about catching exceptions on ShutdownHook.install and retrying with ShutdownHookManager, using reflection? This the ShutdownHook class becomes the shim.&lt;/p&gt;</comment>
                            <comment id="13270825" author="apurtell" created="Tue, 8 May 2012 21:03:16 +0000"  >&lt;p&gt;We could check for the existence of ShutdownHookManager and just use it, falling back to the old method otherwise.&lt;/p&gt;</comment>
                            <comment id="13270837" author="apurtell" created="Tue, 8 May 2012 21:16:38 +0000"  >&lt;p&gt;No, it&apos;s not that simple because our usage here is more like &quot;ShutdownHook extends FileSystem.Cache&quot;.&lt;/p&gt;</comment>
                            <comment id="13270846" author="apurtell" created="Tue, 8 May 2012 21:26:06 +0000"  >&lt;p&gt;Hadoop 2.0 changes the clientFinalizer from a Thread to a Runnable. We can catch the ClassCastException and create a Thread with that Runnable, and then call ShutdownHookManager by reflection to unregister the clientFinalizer.&lt;/p&gt;</comment>
                            <comment id="13270892" author="apurtell" created="Tue, 8 May 2012 22:20:21 +0000"  >&lt;p&gt;The attached patch gets past the problem but I&apos;m not able to test it yet due to another issue I&apos;m about to file another JIRA for.&lt;/p&gt;

&lt;p&gt;Edit: I mean, I can see that it gets past the ClassCastException, and the ShutdownHookManager removes the client finalizer successfully, but I have not yet been able to observe if normal RS shutdown is ok.&lt;/p&gt;</comment>
                            <comment id="13270963" author="hadoopqa" created="Wed, 9 May 2012 00:17:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12526060/HBASE-5963.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12526060/HBASE-5963.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1804//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1804//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1804//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1804//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1804//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1804//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13270975" author="apurtell" created="Wed, 9 May 2012 00:26:12 +0000"  >&lt;p&gt;Latest patch seems to do the right thing according to unit tests without breaking older functionality.&lt;/p&gt;

&lt;p&gt;However, what we are doing here is yanking the HDFS client finalizer Runnable away from the Hadoop 2.x ShutdownHookManager and adding it &amp;#8211; wrapped with our existing strategy here &amp;#8211; to the Runtime shutdown hook list, to perhaps run concurrently with the rest of the ShutdownHookManager registered Runnables. I don&apos;t think this more problematic than the rest of this horrible code. The solution is, someday, to leave Hadoop 1.x behind and transition to using the 2.x ShutdownHookManager.&lt;/p&gt;</comment>
                            <comment id="13270996" author="apurtell" created="Wed, 9 May 2012 01:13:26 +0000"  >&lt;p&gt;Ignore Hadoop QA. To verify the patch, you&apos;ll have to run tests locally with&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mvn -PlocalTests -Psecurity \
  -Dhadoop.profile=23 -Dhadoop.version=2.0.0-SNAPSHOT \
  clean test
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that all of the MR based tests are currently broken, I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5966&quot; title=&quot;MapReduce based tests broken on Hadoop 2.0.0-alpha&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5966&quot;&gt;&lt;del&gt;HBASE-5966&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13270997" author="hadoopqa" created="Wed, 9 May 2012 01:15:39 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12526076/HBASE-5963.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12526076/HBASE-5963.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1807//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1807//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1807//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1807//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1807//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1807//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13271031" author="zhihyu@ebaysf.com" created="Wed, 9 May 2012 02:51:01 +0000"  >&lt;p&gt;ShutdownHookManager from hadoop 2.0 is only 181 lines long.&lt;br/&gt;
It shouldn&apos;t be hard to produce our ShutdownHookManager shim.&lt;/p&gt;</comment>
                            <comment id="13271033" author="andrew.purtell@gmail.com" created="Wed, 9 May 2012 03:02:50 +0000"  >&lt;p&gt;The bulk of the work here isn&apos;t managing the shutdown hook, it is dealing with the different Hadoop versions through special casing and reflection. If you&apos;d like to make a more involved change here that introduces a shim and works more nicely with 2.0, that would be great. I opted for lower risk of breaking 1.0, CDH, etc. It&apos;s definitely a debatable choice. &lt;/p&gt;</comment>
                            <comment id="13271105" author="zhihyu@ebaysf.com" created="Wed, 9 May 2012 05:16:35 +0000"  >&lt;p&gt;Patch v2 introduces ShutdownHookManager shim.&lt;/p&gt;

&lt;p&gt;Please review.&lt;/p&gt;</comment>
                            <comment id="13271114" author="andrew.purtell@gmail.com" created="Wed, 9 May 2012 05:34:53 +0000"  >&lt;p&gt;Patch v2 is plausible.&lt;/p&gt;

&lt;p&gt;Did you run unit tests with -Dhadoop.profile=23 and -Dhadoop.version=2.0.0-snapshot ? They pass except for the MR ones? And tests pass for Hadoop 1?&lt;/p&gt;</comment>
                            <comment id="13271121" author="apurtell" created="Wed, 9 May 2012 05:44:49 +0000"  >&lt;p&gt;Additionally, shouldn&apos;t addShutdownHook in ShutdownHookManagerV2 delegate to the Hadoop 2.x shutdown hook manager?&lt;/p&gt;</comment>
                            <comment id="13271123" author="zhihyu@ebaysf.com" created="Wed, 9 May 2012 05:54:18 +0000"  >&lt;p&gt;@Andy:&lt;br/&gt;
I am running the following on Linux:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
nohup mvn test -Dhadoop.profile=23 -Dhadoop.version=2.0.0-SNAPSHOT -PrunAllTests &amp;gt; suite.txt &amp;amp;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Will check results tomorrow.&lt;br/&gt;
For hadoop 1.0, PreCommit build 1808 would tell us the results.&lt;/p&gt;

&lt;p&gt;For ShutdownHookManagerV2.addShutdownHook(), current code reflects what was in patch v1. Your suggestion is plausible.&lt;/p&gt;</comment>
                            <comment id="13271136" author="hadoopqa" created="Wed, 9 May 2012 06:09:36 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12526103/5963-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12526103/5963-v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1808//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1808//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1808//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1808//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1808//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1808//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13271151" author="zhihyu@ebaysf.com" created="Wed, 9 May 2012 06:34:20 +0000"  >&lt;p&gt;Patch v3 incorporates Andy&apos;s feedback about using ShutdownHookManager.addShutdownHook&lt;/p&gt;</comment>
                            <comment id="13271178" author="hadoopqa" created="Wed, 9 May 2012 07:25:53 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12526111/5963-v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12526111/5963-v3.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1810//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1810//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1810//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1810//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1810//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1810//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13271431" author="zhihyu@ebaysf.com" created="Wed, 9 May 2012 14:03:57 +0000"  >&lt;p&gt;With the help from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5964&quot; title=&quot;HFileSystem: &amp;quot;No FileSystem for scheme: hdfs&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5964&quot;&gt;&lt;del&gt;HBASE-5964&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5966&quot; title=&quot;MapReduce based tests broken on Hadoop 2.0.0-alpha&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5966&quot;&gt;&lt;del&gt;HBASE-5966&lt;/del&gt;&lt;/a&gt;, I saw TestRowProcessorEndpoint pass against hadoop 2.0&lt;/p&gt;</comment>
                            <comment id="13271536" author="apurtell" created="Wed, 9 May 2012 16:19:02 +0000"  >&lt;p&gt;I am also testing the v3 patch now with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5964&quot; title=&quot;HFileSystem: &amp;quot;No FileSystem for scheme: hdfs&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5964&quot;&gt;&lt;del&gt;HBASE-5964&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5966&quot; title=&quot;MapReduce based tests broken on Hadoop 2.0.0-alpha&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5966&quot;&gt;&lt;del&gt;HBASE-5966&lt;/del&gt;&lt;/a&gt; also applied. &lt;/p&gt;</comment>
                            <comment id="13271546" author="apurtell" created="Wed, 9 May 2012 16:27:52 +0000"  >&lt;p&gt;Patch v3 fails TestRegionRebalancing (and others):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[...]
Caused by: java.lang.RuntimeException: Failed suppression of fs shutdown hook: Thread[Thread-74,5,main]
	at org.apache.hadoop.hbase.regionserver.ShutdownHook.suppressHdfsShutdownHook(ShutdownHook.java:197)
	at org.apache.hadoop.hbase.regionserver.ShutdownHook.install(ShutdownHook.java:83)
	at org.apache.hadoop.hbase.util.JVMClusterUtil.startup(JVMClusterUtil.java:191)
	at org.apache.hadoop.hbase.LocalHBaseCluster.startup(LocalHBaseCluster.java:422)
	at org.apache.hadoop.hbase.MiniHBaseCluster.init(MiniHBaseCluster.java:196)
	... 28 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13271557" author="apurtell" created="Wed, 9 May 2012 16:32:54 +0000"  >&lt;p&gt;These test pass with the &quot;v1&quot; patch. I think the difference is in Hadoop 1.x there is a cacheFinalizer per filesystem impl, but in 2.x there is one for all filesystems (for the user). &lt;/p&gt;</comment>
                            <comment id="13271574" author="zhihyu@ebaysf.com" created="Wed, 9 May 2012 16:46:17 +0000"  >&lt;p&gt;I wasn&apos;t able to reproduce the test failure:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mvn test -Dhadoop.profile=23 -Dhadoop.version=2.0.0-SNAPSHOT -PlocalTests -Dtest=TestRegionRebalancing
...
Running org.apache.hadoop.hbase.TestRegionRebalancing
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 30.049 sec
...
[INFO] Total time: 54.616s
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Also, the &apos;Failed suppression of fs shutdown hook&apos; message should be at line 205 of ShutdownHook.java&lt;/p&gt;

&lt;p&gt;@Andy:&lt;br/&gt;
Please give me a little more clue.&lt;/p&gt;</comment>
                            <comment id="13271660" author="apurtell" created="Wed, 9 May 2012 18:23:38 +0000"  >&lt;p&gt;I&apos;ve been testing with 0.94 branch not TRUNK.&lt;/p&gt;

&lt;p&gt;Retesting with a fresh checkout plus only &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5964&quot; title=&quot;HFileSystem: &amp;quot;No FileSystem for scheme: hdfs&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5964&quot;&gt;&lt;del&gt;HBASE-5964&lt;/del&gt;&lt;/a&gt; applied looks good Ted.&lt;/p&gt;</comment>
                            <comment id="13271662" author="apurtell" created="Wed, 9 May 2012 18:25:51 +0000"  >&lt;p&gt;+1 for commit, nice work Ted.&lt;/p&gt;</comment>
                            <comment id="13271673" author="zhihyu@ebaysf.com" created="Wed, 9 May 2012 18:35:10 +0000"  >&lt;p&gt;Integrated to 0.94 and trunk.&lt;/p&gt;

&lt;p&gt;Thanks for providing the initial patch and review, Andy.&lt;/p&gt;</comment>
                            <comment id="13271754" author="hudson" created="Wed, 9 May 2012 20:13:22 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2859 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2859/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2859/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5963&quot; title=&quot;ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5963&quot;&gt;&lt;del&gt;HBASE-5963&lt;/del&gt;&lt;/a&gt; ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread (Revision 1336334)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/ShutdownHook.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/util/ShutdownHookManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13271762" author="hudson" created="Wed, 9 May 2012 20:19:28 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #185 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/185/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/185/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5963&quot; title=&quot;ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5963&quot;&gt;&lt;del&gt;HBASE-5963&lt;/del&gt;&lt;/a&gt; ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread (Revision 1336336)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/ShutdownHook.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/util/ShutdownHookManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13272115" author="hudson" created="Thu, 10 May 2012 06:07:04 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #197 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/197/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/197/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5963&quot; title=&quot;ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5963&quot;&gt;&lt;del&gt;HBASE-5963&lt;/del&gt;&lt;/a&gt; ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread (Revision 1336334)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/ShutdownHook.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/util/ShutdownHookManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13279408" author="hudson" created="Sat, 19 May 2012 02:42:08 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #27 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/27/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/27/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5963&quot; title=&quot;ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5963&quot;&gt;&lt;del&gt;HBASE-5963&lt;/del&gt;&lt;/a&gt; ClassCastException: FileSystem$Cache$ClientFinalizer cannot be cast to Thread (Revision 1336336)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/ShutdownHook.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/util/ShutdownHookManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526103" name="5963-v2.txt" size="5823" author="zhihyu@ebaysf.com" created="Wed, 9 May 2012 05:16:34 +0000"/>
                            <attachment id="12526111" name="5963-v3.txt" size="6185" author="zhihyu@ebaysf.com" created="Wed, 9 May 2012 06:34:20 +0000"/>
                            <attachment id="12526076" name="HBASE-5963.patch" size="4812" author="apurtell" created="Wed, 9 May 2012 00:26:12 +0000"/>
                            <attachment id="12526060" name="HBASE-5963.patch" size="3576" author="apurtell" created="Tue, 8 May 2012 22:20:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 May 2012 20:29:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>238614</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02hh3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12432</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>