<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:51:16 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1163/HBASE-1163.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1163] Master root scanner hung, clients blocked indefinitely waiting for getStartKeys()</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1163</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Mapreduce tasks based on TIF won&apos;t start. Clients trying to find regions by start key block indefinitely (Heritrix hbase writer eventually times out archiver). &lt;/p&gt;

&lt;p&gt;Master seems hung in root scan. I&apos;ve dumped thread stacks 10 times in 10 minutes and the same HBaseClient$Call  object appears in the trace. See below:&lt;/p&gt;

&lt;p&gt;Thread 21 (RegionManager.rootScanner):&lt;br/&gt;
  State: WAITING&lt;br/&gt;
  Blocked count: 500&lt;br/&gt;
  Waited count: 621&lt;br/&gt;
  Waiting on org.apache.hadoop.hbase.ipc.HBaseClient$Call@55a2896d&lt;br/&gt;
  Stack:&lt;br/&gt;
    java.lang.Object.wait(Native Method)&lt;br/&gt;
    java.lang.Object.wait(Object.java:485)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:695)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseRPC$Invoker.invoke(HBaseRPC.java:321)&lt;br/&gt;
    $Proxy2.next(Unknown Source)&lt;br/&gt;
    org.apache.hadoop.hbase.master.BaseScanner.scanRegion(BaseScanner.java:161)&lt;br/&gt;
    org.apache.hadoop.hbase.master.RootScanner.scanRoot(RootScanner.java:55)&lt;br/&gt;
    org.apache.hadoop.hbase.master.RootScanner.maintenanceScan(RootScanner.java:80)&lt;br/&gt;
    org.apache.hadoop.hbase.master.BaseScanner.chore(BaseScanner.java:137)&lt;br/&gt;
    org.apache.hadoop.hbase.Chore.run(Chore.java:65)&lt;/p&gt;

&lt;p&gt;I only see messages from the MetaScanner scanner in the master log, nothing from RootScanner.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413588">HBASE-1163</key>
            <summary>Master root scanner hung, clients blocked indefinitely waiting for getStartKeys()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Jan 2009 01:51:23 +0000</created>
                <updated>Tue, 7 Dec 2010 20:51:21 +0000</updated>
                            <resolved>Tue, 7 Dec 2010 20:51:21 +0000</resolved>
                                    <version>0.19.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12668709" author="apurtell" created="Fri, 30 Jan 2009 02:00:20 +0000"  >&lt;p&gt;Nothing amiss on the HRS hosting ROOT as far as I can see. &lt;/p&gt;

&lt;p&gt;Thread 14 (IPC Server listener on 60020):&lt;br/&gt;
  State: RUNNABLE&lt;br/&gt;
  Blocked count: 0&lt;br/&gt;
  Waited count: 1&lt;br/&gt;
  Stack:&lt;br/&gt;
    sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)&lt;br/&gt;
    sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:215)&lt;br/&gt;
    sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:65)&lt;br/&gt;
    sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:69)&lt;br/&gt;
    sun.nio.ch.SelectorImpl.select(SelectorImpl.java:80)&lt;br/&gt;
    sun.nio.ch.SelectorImpl.select(SelectorImpl.java:84)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseServer$Listener.run(HBaseServer.java:299)&lt;br/&gt;
Thread 16 (IPC Server Responder):&lt;br/&gt;
  State: RUNNABLE&lt;br/&gt;
  Blocked count: 222&lt;br/&gt;
  Waited count: 181&lt;br/&gt;
  Stack:&lt;br/&gt;
    sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)&lt;br/&gt;
    sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:215)&lt;br/&gt;
    sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:65)&lt;br/&gt;
    sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:69)&lt;br/&gt;
    sun.nio.ch.SelectorImpl.select(SelectorImpl.java:80)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseServer$Responder.run(HBaseServer.java:458)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseClient$Connection.waitForWork(HBaseClient.java:400)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseClient$Connection.run(HBaseClient.java:442)&lt;/p&gt;

&lt;p&gt;Here is the corresponding IPC thread on the master:&lt;/p&gt;

&lt;p&gt;Thread 309 (IPC Client (47) connection to /10.30.94.32:60020 from an unknown user):&lt;br/&gt;
  State: RUNNABLE&lt;br/&gt;
  Blocked count: 1&lt;br/&gt;
  Waited count: 1&lt;br/&gt;
  Stack:&lt;br/&gt;
    sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)&lt;br/&gt;
    sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:215)&lt;br/&gt;
    sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:65)&lt;br/&gt;
    sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:69)&lt;br/&gt;
    sun.nio.ch.SelectorImpl.select(SelectorImpl.java:80)&lt;br/&gt;
    org.apache.hadoop.net.SocketIOWithTimeout$SelectorPool.select(SocketIOWithTimeout.java:260)&lt;br/&gt;
    org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:155)&lt;br/&gt;
    org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:150)&lt;br/&gt;
    org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:123)&lt;br/&gt;
    java.io.FilterInputStream.read(FilterInputStream.java:116)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseClient$Connection$PingInputStream.read(HBaseClient.java:276)&lt;br/&gt;
    java.io.BufferedInputStream.fill(BufferedInputStream.java:218)&lt;br/&gt;
    java.io.BufferedInputStream.read(BufferedInputStream.java:237)&lt;br/&gt;
    java.io.DataInputStream.readInt(DataInputStream.java:370)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseClient$Connection.receiveResponse(HBaseClient.java:498)&lt;br/&gt;
    org.apache.hadoop.hbase.ipc.HBaseClient$Connection.run(HBaseClient.java:443)&lt;/p&gt;
</comment>
                            <comment id="12668713" author="apurtell" created="Fri, 30 Jan 2009 02:23:51 +0000"  >&lt;p&gt;Every node in the cluster has an IPC connection open to /10.30.94.32:60020 (the HRS hosting ROOT) and all have the exact same stack trace as thread #309 in the comment above. &lt;/p&gt;

&lt;p&gt;In the other HRS stack traces I see that many are hung on RPC to the master out of CompactSplitThread now. RegionHistorian.add -&amp;gt; HTable.commit -&amp;gt; HTable.flushCommits -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; TableServers.locateRegionInMeta -&amp;gt; $Proxy.getClosestRowBefore &lt;/p&gt;

&lt;p&gt;and the master is not returning from that RPC to getClosestRowBefore.&lt;/p&gt;</comment>
                            <comment id="12668715" author="apurtell" created="Fri, 30 Jan 2009 02:37:55 +0000"  >&lt;p&gt;Attached full stack dumps from master and all HRS. &lt;/p&gt;</comment>
                            <comment id="12668717" author="apurtell" created="Fri, 30 Jan 2009 02:48:53 +0000"  >&lt;p&gt;Shutting down a cluster in this state is not successful. Master splits all HRS logs and stays up. HRS all stay up and won&apos;t go down shy of kill -9. &lt;/p&gt;</comment>
                            <comment id="12968970" author="stack" created="Tue, 7 Dec 2010 20:51:21 +0000"  >&lt;p&gt;We don&apos;t have a root scanner any more.  Resolving invalid.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12396591">HBASE-635</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12399088" name="stacks-1163.1.zip" size="65651" author="apurtell" created="Fri, 30 Jan 2009 02:37:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 7 Dec 2010 20:51:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25608</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 2 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hbpb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99158</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>