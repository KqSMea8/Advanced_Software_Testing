<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:39:03 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6696/HBASE-6696.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6696] Add CP hooks pre and post split transaction point-of-no-return</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6696</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In the discussion &quot;Improving Coprocessor postSplit/postOpen synchronization&quot; on user@hbase, a user implementing a secondary indexing scheme writes in:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The goal with splits is to create two new daughter regions with the&lt;br/&gt;
corresponding splits of the secondary indexes and lock these regions such&lt;br/&gt;
that Puts/Deletes that occur while postSplit is in progress will be queued&lt;br/&gt;
up so we don&apos;t run into consistency issues. &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; As of right now, the HBase coprocessors do not easily support a way to achieve this level of consistency in that there is no way to distinguish a region being opened from a split or a regular open.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Setting aside the particulars of the use case, the issue is the &lt;tt&gt;preSplit&lt;/tt&gt; hook does not provide the identities of the daughter regions (they don&apos;t exist yet) and the &lt;tt&gt;postSplit&lt;/tt&gt; hook, while providing the identities of the daughter regions, runs after the master has processed the split and the daughters are already opened or opening. A CP implementer has no interception point available where the daughters exist but are not yet open.&lt;/p&gt;

&lt;p&gt;This JIRA proposes to add two new CP hooks to just before and after the point-of-no-return (PONR) in the split transaction: &lt;tt&gt;preSplitPONR&lt;/tt&gt; and &lt;tt&gt;postSplitPONR&lt;/tt&gt;. Perhaps the naming can be improved. This will address the above use case but additionally support overloading of the split transaction itself. We also need to address observer notification if the split transaction fails. This is like &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5827&quot; title=&quot;[Coprocessors] Observer notifications on exceptions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5827&quot;&gt;HBASE-5827&lt;/a&gt; but scoped to this specific consideration only.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12605478">HBASE-6696</key>
            <summary>Add CP hooks pre and post split transaction point-of-no-return</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Aug 2012 06:47:41 +0000</created>
                <updated>Sun, 11 May 2014 11:11:17 +0000</updated>
                                            <version>0.94.2</version>
                    <version>0.95.2</version>
                                                    <component>Coprocessors</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13444790" author="ram_krish" created="Thu, 30 Aug 2012 08:23:54 +0000"  >&lt;p&gt;@Andy&lt;br/&gt;
The new hooks added over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6633&quot; title=&quot;Adding new hooks to the split flow - For roll backs and one final hook after split is completed either successfully or failed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6633&quot;&gt;&lt;del&gt;HBASE-6633&lt;/del&gt;&lt;/a&gt; may be enough but one thing can be done is in the latest preSplit(byte[] splitRow) hook we can add a return type , a generic one so that the daughter&apos;s information of the splitted region in the hook can be got.&lt;br/&gt;
Also just move the current postSplit hook before the split is updated to the master?  What do you feel Andy?&lt;/p&gt;</comment>
                            <comment id="13458118" author="jamc" created="Tue, 18 Sep 2012 20:24:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.purtell%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;andrew.purtell@gmail.com&quot;&gt;Andrew Purtell&lt;/a&gt;&lt;br/&gt;
May I know how is the status of this issue? Are you gonna fix it in the next release? &lt;br/&gt;
You answer will be appreciated. &lt;/p&gt;</comment>
                            <comment id="13458977" author="stack" created="Wed, 19 Sep 2012 19:00:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jamc&quot; class=&quot;user-hover&quot; rel=&quot;jamc&quot;&gt;James Ji&lt;/a&gt; You want to have a go at a patch James?  It might help move this issue along.&lt;/p&gt;</comment>
                            <comment id="13459801" author="apurtell" created="Thu, 20 Sep 2012 17:59:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; Thoughts on when the cut point for 0.96 might be? &lt;/p&gt;</comment>
                            <comment id="13459837" author="stack" created="Thu, 20 Sep 2012 18:31:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.purtell%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;andrew.purtell@gmail.com&quot;&gt;Andrew Purtell&lt;/a&gt; I did a review of issues last night.  There are like 10 blockers and 20 criticals that need fixing.  We could pick up some majors.  I&apos;ll do a more thorough pass today.  Its looking like its going to be a month at least to branch (thinking mostly passing jenkins and most of the blockers and criticals done).  Going to focus on it from here on.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 30 Aug 2012 08:23:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241874</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 13 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02fjj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12119</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>