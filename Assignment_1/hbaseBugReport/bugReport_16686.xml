<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:16:46 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-16686/HBASE-16686.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-16686] Add latency metrics for REST</title>
                <link>https://issues.apache.org/jira/browse/HBASE-16686</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;It would be helpful to have the latency metrics for rest for various operations.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13006926">HBASE-16686</key>
            <summary>Add latency metrics for REST</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yguang11">Guang Yang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Sep 2016 19:04:22 +0000</created>
                <updated>Tue, 27 Sep 2016 20:02:49 +0000</updated>
                                                                            <component>monitoring</component>
                    <component>REST</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="15524367" author="apurtell" created="Mon, 26 Sep 2016 22:26:16 +0000"  >&lt;p&gt;Convention across the code base is to use EnvironmentEdgeManager#getTime() instead of System#currentTimeMillis so the time can be controlled in unit tests:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@@ -72,6 +73,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class MultiRowResource &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; ResourceBase &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Constants {
     MultivaluedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; params = uriInfo.getQueryParameters();
 
     servlet.getMetrics().incrementRequests(1);
+    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; startTime = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
     &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
       CellSetModel model = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CellSetModel();
       &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; rk : params.get(ROW_KEYS_PARAM_NAME)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;While a simple count of exceptions could be useful, does it make sense to break down the counts for common exceptions of interest? I would think so:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/hbase-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;/src/main/java/org/apache/hadoop/hbase/&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;/ResourceBase.java b/hbase-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;/src/main/java/org/apache/hadoop/hbase/&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;/ResourceBase.java
index f71d848..f2a6c46 100644
--- a/hbase-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;/src/main/java/org/apache/hadoop/hbase/&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;/ResourceBase.java
+++ b/hbase-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;/src/main/java/org/apache/hadoop/hbase/&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;/ResourceBase.java
@@ -45,6 +45,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class ResourceBase &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Constants {
   }
   
   &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; Response processException(Throwable exp) {
+    servlet.getMetrics().incrementProcessException(1);
     Throwable curr = exp;
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(accessDeniedClazz != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
       &lt;span class=&quot;code-comment&quot;&gt;//some access denied exceptions are buried&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also, note that the REST gateway embeds the HBase client so the client metrics (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12911&quot; title=&quot;Client-side metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12911&quot;&gt;&lt;del&gt;HBASE-12911&lt;/del&gt;&lt;/a&gt;) could be made available.&lt;/p&gt;</comment>
                            <comment id="15527253" author="yguang11" created="Tue, 27 Sep 2016 20:02:49 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt; for the review.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Convention across the code base is to use EnvironmentEdgeManager#getTime() instead of System#currentTimeMillis so the time can be controlled in unit tests&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Thanks for pointing that out, will update the patch accordingly.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;While a simple count of exceptions could be useful, does it make sense to break down the counts for common exceptions of interest?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yeah that would be helpful, let me take a look at the common exceptions that we may report individually.&lt;/p&gt;

&lt;p&gt;As for this patch, I will first focus on getting Jetty 9 work (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12894&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-12894&lt;/a&gt;), and then consolidate a patch for metrics, since it would be helpful to have some metrics from Jetty as well (e.g. queue length, busy/idle threads, etc.).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12829916" name="HBASE-16686_v0.patch" size="19918" author="yguang11" created="Thu, 22 Sep 2016 19:05:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 26 Sep 2016 22:26:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33yuv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>