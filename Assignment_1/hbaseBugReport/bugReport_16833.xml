<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:18:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-16833/HBASE-16833.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-16833] Implement asynchronous hbase client based on HBASE-15921</title>
                <link>https://issues.apache.org/jira/browse/HBASE-16833</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15921&quot; title=&quot;Add first AsyncTable impl and create TableImpl based on it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15921&quot;&gt;&lt;del&gt;HBASE-15921&lt;/del&gt;&lt;/a&gt; we have introduced a simple AsyncTable only supports get, put and delete. This issue aims to implement a complete async hbase client based on it. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13012229">HBASE-16833</key>
            <summary>Implement asynchronous hbase client based on HBASE-15921</summary>
                <type id="14" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/genericissue.png">Umbrella</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="Apache9">Duo Zhang</assignee>
                                    <reporter username="Apache9">Duo Zhang</reporter>
                        <labels>
                            <label>asynchronous</label>
                    </labels>
                <created>Fri, 14 Oct 2016 03:36:55 +0000</created>
                <updated>Thu, 8 Dec 2016 01:38:27 +0000</updated>
                                            <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                                                            <comments>
                            <comment id="15579568" author="carp84" created="Sun, 16 Oct 2016 08:12:31 +0000"  >&lt;p&gt;Nice umbrella, a good place to follow the asynchronous API roadmap, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13784&quot; title=&quot;Add Async Client Table API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13784&quot;&gt;HBASE-13784&lt;/a&gt; is a little bit stale and confusing to follow I&apos;d say. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;OTOH, I think we could uniform put/append/increment/checkAndXXX since they all issue the &lt;tt&gt;MutateRequest&lt;/tt&gt;, what&apos;s your opinion? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15579862" author="apache9" created="Sun, 16 Oct 2016 12:12:58 +0000"  >&lt;p&gt;Yes they can all be done with the SingleRequestRpcRetryingCaller.&lt;/p&gt;

&lt;p&gt;The difficult things are scan and BufferedMutator, and read replica.&lt;/p&gt;</comment>
                            <comment id="15580953" author="carp84" created="Mon, 17 Oct 2016 02:07:55 +0000"  >&lt;p&gt;Agreed.&lt;/p&gt;

&lt;p&gt;And another thing I&apos;d like to bring up is that we may need to limit the ongoing (issued but not returned) requests per client to a) avoid too many future objects (especially puts) causing client OOME; b) avoid too many retries when CallQueueTooBigException happens.&lt;/p&gt;</comment>
                            <comment id="15729260" author="yangzhe1991" created="Wed, 7 Dec 2016 16:59:51 +0000"  >&lt;p&gt;Skimmed the current code. Not fully follow your work on async client, pardon me if I miss something.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;AsyncTableRegionLocatorImpl.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Override
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; CompletableFuture&amp;lt;HRegionLocation&amp;gt; getRegionLocation(&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] row, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; reload) {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; locator.getRegionLocation(tableName, row, 0L);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We should consider the reload parameter? And for region caching, if we need to reload the region info from meta, we may have some concurrent requests for same table even same region. We could let the first one send the RPC request and the others wait the result?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; SLEEP_DELTA_NS = TimeUnit.MILLISECONDS.toNanos(1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think for sync client we also have this issue, may be we should add it also in sync client and make it configurable?&lt;/p&gt;
</comment>
                            <comment id="15730752" author="apache9" created="Thu, 8 Dec 2016 01:38:27 +0000"  >&lt;blockquote&gt;
&lt;p&gt;We should consider the reload parameter?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;For the async table implementation, there is no reload at all. We will clear meta cache when error which means we will reload the location at next try. The interface here is marked as unstable so I haven&apos;t spent much time to design it. And I think the word &apos;reload&apos; expose too many implementation details to the upper layer. Maybe we should name the parameter &apos;skipCache&apos;. Then it is free for us to update the cache or not.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;And for region caching, if we need to reload the region info from meta, we may have some concurrent requests for same table even same region. We could let the first one send the RPC request and the others wait the result?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes we should do this. The problem will become worse after we introduce multi get in async table as we will get lots of locations at the same time. I plan to file a issue after I have an initial patch for multi get(&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-17142&quot; title=&quot;Implement multi get&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-17142&quot;&gt;HBASE-17142&lt;/a&gt;).&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I think for sync client we also have this issue, may be we should add it also in sync client and make it configurable?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;For 2.0 I plan to implement the old blocking table on the new async table, so most code of the old blocking table will just be dropped in the future. And for this issue, you can see RpcRetryingCallerImpl.singleCallDuration, where we also add a small delta when sleeping. And for the blocking table implementation, we can not limit the total time of locating a region as we do not pass any timeout parameters to the prepare method of a RetryingCallable. I think you can open a new issue to address this problem as async table is not likely to be backported to branch-1.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12833010">HBASE-13784</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="13012230">HBASE-16834</subtask>
                            <subtask id="13012231">HBASE-16835</subtask>
                            <subtask id="13012235">HBASE-16836</subtask>
                            <subtask id="13012236">HBASE-16837</subtask>
                            <subtask id="13012237">HBASE-16838</subtask>
                            <subtask id="13013214">HBASE-16872</subtask>
                            <subtask id="13014626">HBASE-16932</subtask>
                            <subtask id="13015333">HBASE-16945</subtask>
                            <subtask id="13016893">HBASE-16984</subtask>
                            <subtask id="13017126">HBASE-16991</subtask>
                            <subtask id="13017515">HBASE-17008</subtask>
                            <subtask id="13019083">HBASE-17045</subtask>
                            <subtask id="13022171">HBASE-17141</subtask>
                            <subtask id="13022172">HBASE-17142</subtask>
                            <subtask id="13025406">HBASE-17251</subtask>
                            <subtask id="13027014">HBASE-17282</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 16 Oct 2016 08:12:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34vjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>