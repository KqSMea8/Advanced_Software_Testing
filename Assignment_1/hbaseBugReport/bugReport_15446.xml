<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:03:39 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-15446/HBASE-15446.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-15446] Do not abort RS when WAL append for bulk load event marker is failed</title>
                <link>https://issues.apache.org/jira/browse/HBASE-15446</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;During bulk load process when the RS fails to append the bulk load event marker in WAL we abort that RS which is actually not really required. Instead just throw back the exception to the client and let the client retry. This will be helpful in case of replication of bulk loaded data.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12949032">HBASE-15446</key>
            <summary>Do not abort RS when WAL append for bulk load event marker is failed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="ashish singhi">Ashish Singhi</assignee>
                                    <reporter username="ashish singhi">Ashish Singhi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Mar 2016 09:18:54 +0000</created>
                <updated>Fri, 11 Mar 2016 10:54:58 +0000</updated>
                                            <version>1.3.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="15190725" author="anoop.hbase" created="Fri, 11 Mar 2016 09:47:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;throw back the exception to the client and let the client retry&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;When u say this, u mean fail op to user app which tried to bulk load  the file?   But the file is actually loaded here in this cluster.&lt;/p&gt;</comment>
                            <comment id="15190736" author="ashish singhi" created="Fri, 11 Mar 2016 09:56:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;When u say this, u mean fail op to user app which tried to bulk load the file? But the file is actually loaded here in this cluster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, but I don&apos;t see any issue if its loaded again, data is same but then we will have another hfile with different seq id but I don&apos;t see any major impact with it.&lt;br/&gt;
Also this will happen only when the input data is not in same FS. As in the case of same FS (most common use case I believe) the hfiles will be actually moved so on next retry we will not find this file to load and will get FileNotFoundException which I think we can catch that exception and ignore it.&lt;/p&gt;</comment>
                            <comment id="15190751" author="anoop.hbase" created="Fri, 11 Mar 2016 10:06:16 +0000"  >&lt;p&gt;Sorry still confusing.   So u say here that when the 1st attempt failed to write to WAL (But actually loaded the file) we will fail the op to the user app.  &lt;br/&gt;
And then say&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;so on next retry we will not find this file to load and will get FileNotFoundException which I think we can catch that exception and ignore it.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Here we mean HBase code?  How we can know whether it is the second trial? Because the 1st op is failed to user. So the 2nd call also came from user.&lt;/p&gt;

&lt;p&gt;If we say back to the user, that the bulk load op is failed, we should be sure that the load is not actually happened in any of the cluster.  Else it will be very much confusing for the user later.&lt;/p&gt;</comment>
                            <comment id="15190758" author="anoop.hbase" created="Fri, 11 Mar 2016 10:10:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;Yes, but I don&apos;t see any issue if its loaded again, data is same but then we will have another hfile with different seq id but I don&apos;t see any major impact with it.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Its not about the duplicated file.. What I say is abt the op status we say to the user is very much incorrect.  The file is loaded actually right? Even a scan will be able to see the cells in that.. (Say user has not retried the failed attempt)&lt;/p&gt;</comment>
                            <comment id="15190774" author="ashish singhi" created="Fri, 11 Mar 2016 10:29:18 +0000"  >&lt;p&gt;Sorry for the confusion.&lt;br/&gt;
When we fail to append the event marker in the WAL we will return false and then internally LoadIncrementalHFiles will retry with the loading of these hfiles again for configurable number of times and here we have to assume that it is second trial and ignore the FNFE.&lt;br/&gt;
Suppose if it was first attempt and the file was not found then we may end up writing a entry for this file in the WAL. Currently I think this entries in the WAL are mainly used in replication of bulk loaded data where we will ignore the hfiles which is not found in source data directory and in archive directory.&lt;/p&gt;</comment>
                            <comment id="15190792" author="ashish singhi" created="Fri, 11 Mar 2016 10:54:58 +0000"  >&lt;p&gt;Need to think more on this on how to make this operation atomic. I Will comment back then.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12947984">HBASE-15425</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 11 Mar 2016 09:47:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            40 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2uibz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>