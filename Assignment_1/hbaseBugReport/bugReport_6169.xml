<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:34:23 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6169/HBASE-6169.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6169] When a RS aborts without finishing closing a region, this region will always remain &quot;in transition&quot;.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6169</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When RS got an ZK error when trying to create a &quot;CLOSING&quot; node in the process of closing a region, it hence aborts without completing closing of the region.&lt;br/&gt;
RS is then discovered dead by HMaster. ServerShutdownHandler does not try to reassign this region for it is in PENDING_CLOSE state; while all regions that originally belong to the dead RS get removed from the &quot;regions&quot; map.&lt;br/&gt;
TimeoutMonitor then endlessly tries to &quot;unassign&quot; this region with LOG message &quot;Region has been PENDING_CLOSE for too long&quot;. The &quot;unassign&quot; returns without doing anything, for this region does not exist in the &quot;regions&quot; map:&lt;br/&gt;
  public void unassign(HRegionInfo region, boolean force, ServerName dest) {&lt;br/&gt;
    // TODO: Method needs refactoring.  Ugly buried returns throughout.  Beware!&lt;br/&gt;
    LOG.debug(&quot;Starting unassignment of region &quot; +&lt;br/&gt;
      region.getRegionNameAsString() + &quot; (offlining)&quot;);&lt;/p&gt;

&lt;p&gt;    synchronized (this.regions) {&lt;br/&gt;
      // Check if this region is currently assigned&lt;br/&gt;
      if (!regions.containsKey(region)) &lt;/p&gt;
{
        LOG.debug(&quot;Attempted to unassign region &quot; +
          region.getRegionNameAsString() + &quot; but it is not &quot; +
          &quot;currently assigned anywhere&quot;);
        return;
      }
&lt;p&gt;    }&lt;br/&gt;
  ...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12559494">HBASE-6169</key>
            <summary>When a RS aborts without finishing closing a region, this region will always remain &quot;in transition&quot;.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="maryannxue">Maryann Xue</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Jun 2012 07:42:15 +0000</created>
                <updated>Mon, 31 Mar 2014 10:31:23 +0000</updated>
                            <resolved>Mon, 31 Mar 2014 10:31:23 +0000</resolved>
                                    <version>0.90.6</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13290000" author="maryannxue" created="Wed, 6 Jun 2012 07:46:22 +0000"  >&lt;p&gt;I&apos;m wondering if it is safe to call &quot;AM.assign(region)&quot; if we know this &quot;unassign&quot; request is coming from TimeoutMonitor, instead of just &quot;return&quot;.&lt;/p&gt;</comment>
                            <comment id="13290031" author="ram_krish" created="Wed, 6 Jun 2012 08:58:32 +0000"  >&lt;p&gt;@Maryann&lt;br/&gt;
The region close was happening while disabling any table or while balancing? Because while disabling if this problem happens what you say is possible.  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5927&quot; title=&quot;SSH and DisableTableHandler happening together does not clear the znode of the region and RIT map.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5927&quot;&gt;&lt;del&gt;HBASE-5927&lt;/del&gt;&lt;/a&gt; we have tried to address that.  If it is due to some other case then not pretty much sure because if the RIT is in PENDING_CLOSE I thought we are handling it?(Need to check)&lt;br/&gt;
Which version of HBASE you found this issue?&lt;/p&gt;</comment>
                            <comment id="13290857" author="maryannxue" created="Thu, 7 Jun 2012 07:16:27 +0000"  >&lt;p&gt;@ramkrishna, we found this problem with disabling table actually, against 0.90. but suppose with trunk, this region would be cleared from RIT in ServerShutdownHandler. but i assume in load balancing, while ServerShutdownHandler does nothing with PENDING_CLOSE or CLOSING regions, the above situation will be triggered by TimeoutMonitor.&lt;/p&gt;</comment>
                            <comment id="13290879" author="ram_krish" created="Thu, 7 Jun 2012 08:12:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;i assume in load balancing, while ServerShutdownHandler does nothing with PENDING_CLOSE or CLOSING regions&lt;/p&gt;&lt;/blockquote&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rit != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !rit.isClosing() &amp;amp;&amp;amp; !rit.isPendingClose() &amp;amp;&amp;amp; !rit.isSplitting()) {
              &lt;span class=&quot;code-comment&quot;&gt;// Skip regions that were in transition unless CLOSING or
&lt;/span&gt;              &lt;span class=&quot;code-comment&quot;&gt;// PENDING_CLOSE
&lt;/span&gt;              LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Skip assigning region &quot;&lt;/span&gt; + rit.toString());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Seeing the code above i feel we are handling PENDING_CLOSE or CLOSING.  Only other states we don&apos;t handle.  Can you try out some testcase for the scenario that you say? Thanks.&lt;/p&gt;</comment>
                            <comment id="13393648" author="maryannxue" created="Mon, 18 Jun 2012 02:21:49 +0000"  >&lt;p&gt;Yes, you are right. looks like this problem only exists with 0.90.&lt;/p&gt;</comment>
                            <comment id="13955078" author="qwertymaniac" created="Mon, 31 Mar 2014 10:31:23 +0000"  >&lt;p&gt;This should no longer be a problem. Current AM impl. does carry a clause that tackles an RIT region returning no associated server.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 6 Jun 2012 08:58:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241795</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02d2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11720</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>