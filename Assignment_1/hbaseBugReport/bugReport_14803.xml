<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:56:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14803/HBASE-14803.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14803] Add some debug logs to StoreFileScanner</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14803</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;To validate some behaviors I had to add some logs into StoreFileScanner.&lt;/p&gt;

&lt;p&gt;I think it can be interesting for other people looking for debuging. So sharing the modifications here.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12912633">HBASE-14803</key>
            <summary>Add some debug logs to StoreFileScanner</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="jmspaggi">Jean-Marc Spaggiari</assignee>
                                    <reporter username="jmspaggi">Jean-Marc Spaggiari</reporter>
                        <labels>
                            <label>beginner</label>
                    </labels>
                <created>Thu, 12 Nov 2015 22:13:44 +0000</created>
                <updated>Sat, 18 Jun 2016 02:28:29 +0000</updated>
                                                            <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="15003098" author="jinghe" created="Thu, 12 Nov 2015 22:40:29 +0000"  >&lt;p&gt;+1&lt;br/&gt;
The scanner implementations lack debug logging overall, which makes things harder for new folks to master.&lt;/p&gt;</comment>
                            <comment id="15003225" author="hadoopqa" created="Thu, 12 Nov 2015 23:44:46 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12772060/HBASE-14803.v0-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12772060/HBASE-14803.v0-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 789f8a5a70242c16ce10bc95401c51c7d04debfa.&lt;br/&gt;
  ATTACHMENT ID: 12772060&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1730 checkstyle errors (more than the master&apos;s current 1727 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestStoreFile&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16503//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16503//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16503//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16503//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16503//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16503//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16503//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16503//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15003269" author="chenheng" created="Fri, 13 Nov 2015 00:11:14 +0000"  >&lt;blockquote&gt;
&lt;p&gt;+  static final Log LOG = LogFactory.getLog(HStore.class);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why is HStore.class,  not StoreFileScanner.class?&lt;/p&gt;</comment>
                            <comment id="15003274" author="jmspaggi" created="Fri, 13 Nov 2015 00:15:45 +0000"  >&lt;p&gt;Good catch! Update patch attached.&lt;/p&gt;</comment>
                            <comment id="15003526" author="anoop.hbase" created="Fri, 13 Nov 2015 04:02:54 +0000"  >&lt;p&gt;Will it be still better if we can add the info why the file got skipped?   (Because of Time range or bloom)   It will involve more code lines as we have to do boolean check and return after every single check.&lt;/p&gt;</comment>
                            <comment id="15003929" author="jmspaggi" created="Fri, 13 Nov 2015 12:34:01 +0000"  >&lt;p&gt;So more something like that?&lt;/p&gt;</comment>
                            <comment id="15004015" author="hadoopqa" created="Fri, 13 Nov 2015 14:05:27 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12772185/HBASE-14803.v2-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12772185/HBASE-14803.v2-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 789f8a5a70242c16ce10bc95401c51c7d04debfa.&lt;br/&gt;
  ATTACHMENT ID: 12772185&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1733 checkstyle errors (more than the master&apos;s current 1727 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestStoreFile&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16512//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16512//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16512//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16512//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16512//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16512//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16512//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16512//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15005150" author="anoop.hbase" created="Sat, 14 Nov 2015 04:28:06 +0000"  >&lt;p&gt;Yes like this way.&lt;br/&gt;
Test failure related to patch?  &lt;/p&gt;</comment>
                            <comment id="15005647" author="busbey" created="Sat, 14 Nov 2015 22:20:37 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Log LOG = LogFactory.getLog(StoreFileScanner.class);
+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;please make private&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!reader.passesTimerangeFilter(timeRange, oldestUnexpiredTS)) {
+    	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
+    		LOG.debug (reader.getHFileReader().getName() + &lt;span class=&quot;code-quote&quot;&gt;&quot; skipped because of Timerange Filter.&quot;&lt;/span&gt;);
+    	}
+    	&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;please use 2 spaces for indent and no tabs. (here and a few other instances)&lt;/p&gt;</comment>
                            <comment id="15005680" author="chenheng" created="Sun, 15 Nov 2015 00:21:29 +0000"  >&lt;p&gt;IMO we should check whether reader.getHFileReader() is null.  Maybe failed test case has relates with it.&lt;/p&gt;</comment>
                            <comment id="15005901" author="jmspaggi" created="Sun, 15 Nov 2015 13:54:52 +0000"  >&lt;blockquote&gt;
&lt;p&gt;please make private&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Fixed. Cut&amp;amp;Past of HStore.java. You might want to opan a JIRA to get it fixed there too.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;IMO we should check whether reader.getHFileReader() is null. Maybe failed test case has relates with it.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Will not harm to test that. I have added the required if statement.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Test failure related to patch? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Not sure. Will re-submit this one. If it fails again I will investigate the test failure...&lt;/p&gt;
</comment>
                            <comment id="15005967" author="hadoopqa" created="Sun, 15 Nov 2015 16:50:58 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12772405/HBASE-14803.v3-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12772405/HBASE-14803.v3-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit bb6581345fd9ecac964e19cea2293477162801ca.&lt;br/&gt;
  ATTACHMENT ID: 12772405&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1731 checkstyle errors (more than the master&apos;s current 1727 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestRecoveredEdits&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16526//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16526//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16526//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16526//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16526//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16526//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16526//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16526//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15006093" author="busbey" created="Sun, 15 Nov 2015 23:29:01 +0000"  >&lt;p&gt;v3 still has tabs.&lt;/p&gt;

&lt;p&gt;the v2 test failure was the lack of a null check. Please investigate test failures.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Tests run: 13, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 7.608 sec &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.hadoop.hbase.regionserver.TestStoreFile
testEmptyStoreFileRestrictKeyRanges(org.apache.hadoop.hbase.regionserver.TestStoreFile)  Time elapsed: 0.175 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
java.lang.NullPointerException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
        at org.apache.hadoop.hbase.regionserver.StoreFileScanner.shouldUseScanner(StoreFileScanner.java:438)
        at org.apache.hadoop.hbase.regionserver.TestStoreFile.testEmptyStoreFileRestrictKeyRanges(TestStoreFile.java:218)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15006098" author="jmspaggi" created="Sun, 15 Nov 2015 23:42:09 +0000"  >&lt;p&gt;Hum. Bad for the tabs. Don&apos;t know why they are still there. Fixed locally now. Looking at the exception already. Will send a new one shortly...&lt;/p&gt;</comment>
                            <comment id="15006101" author="jmspaggi" created="Sun, 15 Nov 2015 23:49:17 +0000"  >&lt;p&gt;This error doesn&apos;t really make sense...&lt;/p&gt;

&lt;p&gt;I ran it locally:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;-------------------------------------------------------&lt;br/&gt;
 T E S T S&lt;br/&gt;
-------------------------------------------------------&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM warning: ignoring option MaxPermSize=256m; support was removed in 8.0&lt;br/&gt;
Running org.apache.hadoop.hbase.regionserver.TestStoreFile&lt;br/&gt;
Tests run: 13, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.737 sec - in org.apache.hadoop.hbase.regionserver.TestStoreFile&lt;/p&gt;

&lt;p&gt;Results :&lt;/p&gt;

&lt;p&gt;Tests run: 13, Failures: 0, Errors: 0, Skipped: 0&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Also, line 483 is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (reader.getHFileReader() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, reader can not be null there...&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!reader.passesTimerangeFilter(timeRange, oldestUnexpiredTS)) {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (reader.getHFileReader() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Else it will have crashed sooner, and this reader.passesTimerangeFilter was already there in the previous code. So nothing new, and impossible for reader to be null. Sound like it took the previous version... I will cancel and push the one with the fixed tab and see the result...&lt;/p&gt;</comment>
                            <comment id="15006161" author="hadoopqa" created="Mon, 16 Nov 2015 02:26:53 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12772424/HBASE-14803.v4-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12772424/HBASE-14803.v4-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit dd5f454b03b9ccd788398fa52220c7690381eb6f.&lt;br/&gt;
  ATTACHMENT ID: 12772424&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestRecoveredEdits&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16527//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16527//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16527//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16527//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16527//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16527//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16527//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16527//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15006317" author="chenheng" created="Mon, 16 Nov 2015 07:59:50 +0000"  >&lt;p&gt;It seems that this patch has no relates with failed test case. Let&apos;s retry. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15006496" author="hadoopqa" created="Mon, 16 Nov 2015 10:45:01 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12772457/HBASE-14803.v4-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12772457/HBASE-14803.v4-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit dd5f454b03b9ccd788398fa52220c7690381eb6f.&lt;br/&gt;
  ATTACHMENT ID: 12772457&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestRecoveredEdits&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16531//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16531//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16531//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16531//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16531//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16531//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16531//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16531//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15006513" author="chenheng" created="Mon, 16 Nov 2015 10:53:52 +0000"  >&lt;p&gt;Oh,  the patch will cause org.apache.hadoop.hbase.regionserver.TestRecoveredEdits timeout!&lt;br/&gt;
Maybe that is why there is NO logs in StoreFileScanner,  it dumps too many....&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
testReplayWorksThoughLotsOfFlushing(org.apache.hadoop.hbase.regionserver.TestRecoveredEdits)  Time elapsed: 60.083 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
org.junit.runners.model.TestTimedOutException: test timed out after 60000 milliseconds
	at java.lang.Throwable.getStackTraceElement(Native Method)
	at java.lang.Throwable.getOurStackTrace(Throwable.java:827)
	at java.lang.Throwable.getStackTrace(Throwable.java:816)
	at sun.reflect.GeneratedMethodAccessor2.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.log4j.spi.LocationInfo.&amp;lt;init&amp;gt;(LocationInfo.java:139)
	at org.apache.log4j.spi.LoggingEvent.getLocationInformation(LoggingEvent.java:253)
	at org.apache.log4j.helpers.PatternParser$ClassNamePatternConverter.getFullyQualifiedName(PatternParser.java:555)
	at org.apache.log4j.helpers.PatternParser$NamedPatternConverter.convert(PatternParser.java:528)
	at org.apache.log4j.helpers.PatternConverter.format(PatternConverter.java:65)
	at org.apache.log4j.PatternLayout.format(PatternLayout.java:506)
	at org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:310)
	at org.apache.log4j.WriterAppender.append(WriterAppender.java:162)
	at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:251)
	at org.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:66)
	at org.apache.log4j.Category.callAppenders(Category.java:206)
	at org.apache.log4j.Category.forcedLog(Category.java:391)
	at org.apache.log4j.Category.log(Category.java:856)
	at org.apache.commons.logging.impl.Log4JLogger.debug(Log4JLogger.java:155)
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.shouldUseScanner(StoreFileScanner.java:455)
	at org.apache.hadoop.hbase.regionserver.StoreScanner.selectScannersFrom(StoreScanner.java:397)
	at org.apache.hadoop.hbase.regionserver.StoreScanner.getScannersNoCompaction(StoreScanner.java:316)
	at org.apache.hadoop.hbase.regionserver.StoreScanner.&amp;lt;init&amp;gt;(StoreScanner.java:196)
	at org.apache.hadoop.hbase.regionserver.HStore.createScanner(HStore.java:1953)
	at org.apache.hadoop.hbase.regionserver.HStore.getScanner(HStore.java:1943)
	at org.apache.hadoop.hbase.regionserver.HRegion$RegionScannerImpl.&amp;lt;init&amp;gt;(HRegion.java:5494)
	at org.apache.hadoop.hbase.regionserver.HRegion.instantiateRegionScanner(HRegion.java:2522)
	at org.apache.hadoop.hbase.regionserver.HRegion.getScanner(HRegion.java:2508)
	at org.apache.hadoop.hbase.regionserver.HRegion.getScanner(HRegion.java:2489)
	at org.apache.hadoop.hbase.regionserver.HRegion.getScanner(HRegion.java:2485)
	at org.apache.hadoop.hbase.regionserver.HRegion.get(HRegion.java:6648)
	at org.apache.hadoop.hbase.regionserver.HRegion.get(HRegion.java:6613)
	at org.apache.hadoop.hbase.regionserver.TestRecoveredEdits.verifyAllEditsMadeItIn(TestRecoveredEdits.java:171)
	at org.apache.hadoop.hbase.regionserver.TestRecoveredEdits.testReplayWorksThoughLotsOfFlushing(TestRecoveredEdits.java:134)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15006627" author="jmspaggi" created="Mon, 16 Nov 2015 12:52:29 +0000"  >&lt;p&gt;Interesting... Let me test it locally to see the output.&lt;/p&gt;

&lt;p&gt;I might add a time and print a message only no more than x messages have been printed within the last y seconds...&lt;/p&gt;</comment>
                            <comment id="15006642" author="jmspaggi" created="Mon, 16 Nov 2015 13:09:35 +0000"  >&lt;blockquote&gt;
&lt;p&gt;2015-11-16 07:53:32,901 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): cccbd663bbfd40e3a96c033785ed488c skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,901 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): 6a56714c25084f9aa372ff89971fb806 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,901 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): 703b255ce2954746bf11cc05c98a012b skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,901 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): 803cd9c71d6e4ab8a26a320f947a391f skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,901 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): b6b44c076a0242c0a7001e5d2bf75cb0 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): d9e714689492490493dc267233e3c7c3 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): be6fd3fc7a1845eab9ae265fd3161eef skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): 4eeea5f841564f459e31237de5f71a89 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): ed33fdf866b249f183b5f51c45b8d212 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): d3cba7e6b36d4655a03af8b5af36dab3 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): c765561d0a5d409f83c765109caaec75 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): ef755777ef414bb9bc5ba2e1340e5231 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): 072e66358aea418aa5d5e6f1cc09ec11 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): 04697757965c4f61a619cc624da79a2b skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): b5041be510014fb6ac17895f8b880c3e skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): 5264cc2f637d4025bf1ba58e3fcd9b78 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 07:53:32,902 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Time-limited test&amp;#93;&lt;/span&gt; regionserver.StoreFileScanner(455): f35867215f084b37b42087381af39ade skipped because of Bloom Filter.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It logs all of this like crazy... I will add the counter. Let me know if you prefer me to solve that another way. There is 1 027 162 entries for the bloom filter skip in my logs. &lt;/p&gt;</comment>
                            <comment id="15006694" author="jmspaggi" created="Mon, 16 Nov 2015 14:09:18 +0000"  >&lt;p&gt;Ok. Looks better.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2015-11-16 09:06:14,349 DEBUG [] r.SFS(441): To many messages logged. Skipping new messages.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): d0a0169a565f442d9ed33f730f651503 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 78a1ffc4559c4691a849e284ce6f36d9 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): d5ea38b1fb9041598eac8db5c5dba954 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): c88d318f87494de5b758d5fc205b9156 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): d6903214874542baad7681888eee57eb skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 4fa83becd20f45859fcda7c4457b7f6a skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 4f9d6165a4944aa5ab4afc0b22d564d3 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 58d8fdf501ae4138ad8530d0d28e2b9b skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 5dedfb8908494ae5b60e6aa1c8b1b7ad skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 7486989f4b574f0ba26534ff2d01b2e8 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,348 DEBUG [] r.SFS(441): To many messages logged. Skipping new messages.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): e4756a9b478a410b8d8b408b7e15fa27 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): 233cf58fa8a54ee0abd789c55f47edaa skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): c0edaf07f0204aa89f5c0d933b481eb7 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): e3c504a9e5c046d792fa111a49d88131 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): c1c2ef50648741b890c7c0891dd3bce2 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): 3178762f118444e9b6b3387b6c6357ff skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): 4da70b9f262c44d0b50df61506c53502 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): 2fddff5578794138b5a0a148da23044e skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): b4763990b4f249ef8a10dcc45828c012 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(479): c9244ccd31cd4c2abb44a7cb0ddc65eb skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:16,347 DEBUG [] r.SFS(441): To many messages logged. Skipping new messages.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Moved from a million messages logged to like 50. And test pass. I&apos;m now running the entire test suite before submitting the patch again here...&lt;/p&gt;</comment>
                            <comment id="15007009" author="jmspaggi" created="Mon, 16 Nov 2015 18:01:29 +0000"  >&lt;p&gt;What about something like this?&lt;/p&gt;

&lt;p&gt;I tried to run the tests locally and it fails on unrelated timeout after hours. Let see how it goes here.&lt;/p&gt;</comment>
                            <comment id="15007318" author="hadoopqa" created="Mon, 16 Nov 2015 21:06:46 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12772538/HBASE-14803.v5-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12772538/HBASE-14803.v5-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit f218e499ae12805cc35ed938c1f6d07ace048a25.&lt;br/&gt;
  ATTACHMENT ID: 12772538&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16536//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16536//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16536//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16536//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16536//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16536//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16536//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16536//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15007946" author="chenheng" created="Tue, 17 Nov 2015 03:31:08 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; logLastLogin = 0;
+  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; logCounter = 0;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;IMO long should be AtomicLong  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15008860" author="jmspaggi" created="Tue, 17 Nov 2015 15:44:35 +0000"  >&lt;p&gt;I was hesitant about the AtomicLong. It creates 2 other objects to guarantee atomicity. But here, we don&apos;t really care about atomicity. If we display 11 lines of logs instead of 10 because they have been a conflict, it doesn&apos;t really matters. Also, this is only when doing scans for the same file at the same time and both skip it at the exact same time. Chances for this to occurs are very small. That&apos;s why I went with long instead of AtomicLong.&lt;/p&gt;

&lt;p&gt;Now, if we want AtomicLong instead, it&apos;s really not a big change &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I can do that. We just need to decide on what we prefer.... (And at the same time I will fix &quot;To&quot; into &quot;Too&quot;...)&lt;/p&gt;</comment>
                            <comment id="15008869" author="chenheng" created="Tue, 17 Nov 2015 15:49:26 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Also, this is only when doing scans for the same file at the same time and both skip it at the exact same time. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I see logCounter is static,  is it means all ScanFileScanner will use same logCounter ?  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15008889" author="jmspaggi" created="Tue, 17 Nov 2015 16:02:20 +0000"  >&lt;p&gt;Indeed. Goal is to limit the number of messages logged by this class overall when turning on debug mode on heavy scan tests. We do not want to keep one counter per region. That will just create to many non-required counters. Here we just print that we are skipping some messages and wait a bit before login again.&lt;/p&gt;

&lt;p&gt;Like in the example copied from above&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): d0a0169a565f442d9ed33f730f651503 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 78a1ffc4559c4691a849e284ce6f36d9 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): d5ea38b1fb9041598eac8db5c5dba954 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): c88d318f87494de5b758d5fc205b9156 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): d6903214874542baad7681888eee57eb skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 4fa83becd20f45859fcda7c4457b7f6a skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 4f9d6165a4944aa5ab4afc0b22d564d3 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 58d8fdf501ae4138ad8530d0d28e2b9b skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 5dedfb8908494ae5b60e6aa1c8b1b7ad skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,347 DEBUG [] r.SFS(479): 7486989f4b574f0ba26534ff2d01b2e8 skipped because of Bloom Filter.&lt;br/&gt;
2015-11-16 09:06:15,348 DEBUG [] r.SFS(441): To many messages logged. Skipping new messages.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;As you can see it&apos;s almost always a different store file, etc. We just want to reduce the display, what ever ScanFileScanner it is on this RS.&lt;/p&gt;

&lt;p&gt;Keep in mind that this is debug information only. We are not saying &quot;This specific ScanFileScanner here logged to many lines&quot;. Just that ScanFileScanner in general logged to many.&lt;/p&gt;

&lt;p&gt;So I don&apos;t think we should have one counter per instance. But here again, it&apos;s just 7 bytes to remove on 2 lines if we think we prefer it differently. But then on the tests side we might still create many of them and log to much. This will have to be tested.&lt;/p&gt;</comment>
                            <comment id="15008906" author="chenheng" created="Tue, 17 Nov 2015 16:09:41 +0000"  >&lt;blockquote&gt;
&lt;p&gt; We do not want to keep one counter per region. That will just create to many non-required counters.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agree.  My point is if all StoreFileScanner share logCounter,  and logCounter type is not Atomic,  is it will be heavy concurrency conflicts?&lt;/p&gt;</comment>
                            <comment id="15008919" author="chenheng" created="Tue, 17 Nov 2015 16:12:33 +0000"  >&lt;p&gt;Except that,  patch looks good to me. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  &lt;/p&gt;</comment>
                            <comment id="15009230" author="eclark" created="Tue, 17 Nov 2015 18:47:25 +0000"  >&lt;p&gt;These look much more like trace logs than debug.&lt;/p&gt;</comment>
                            <comment id="15010823" author="anoop.hbase" created="Wed, 18 Nov 2015 11:41:02 +0000"  >&lt;p&gt;Ah..  bad that we have to have these much logic for the log decision. Either handle the issue with the test in that test case (change the log level from Debug to Info for that test alone?- Some tests we handle this way I guess) or change to Trace level as suggested by Elliott.&lt;/p&gt;</comment>
                            <comment id="15010830" author="jmspaggi" created="Wed, 18 Nov 2015 11:44:03 +0000"  >&lt;p&gt;Hey, I&apos;m planning to change that to trace and remove the logic. Goal is to have the ability to print some logs when required. Trace or debug doesn&apos;t make a big difference since it&apos;s the only log in this class. So it can still easily be activated... Will submit the update later today.&lt;/p&gt;</comment>
                            <comment id="15011347" author="stack" created="Wed, 18 Nov 2015 16:39:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;I tried to run the tests locally and it fails on unrelated timeout after hours. Let see how it goes here.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What was not working, do you know JMS? I&apos;m interested.&lt;/p&gt;</comment>
                            <comment id="15060326" author="busbey" created="Wed, 16 Dec 2015 17:12:26 +0000"  >&lt;p&gt;moving out of patch available pending update.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12772060" name="HBASE-14803.v0-trunk.patch" size="1838" author="jmspaggi" created="Thu, 12 Nov 2015 22:14:33 +0000"/>
                            <attachment id="12772078" name="HBASE-14803.v1-trunk.patch" size="1848" author="jmspaggi" created="Fri, 13 Nov 2015 00:15:45 +0000"/>
                            <attachment id="12772185" name="HBASE-14803.v2-trunk.patch" size="2195" author="jmspaggi" created="Fri, 13 Nov 2015 12:34:01 +0000"/>
                            <attachment id="12772405" name="HBASE-14803.v3-trunk.patch" size="2392" author="jmspaggi" created="Sun, 15 Nov 2015 13:52:53 +0000"/>
                            <attachment id="12772457" name="HBASE-14803.v4-trunk.patch" size="2398" author="chenheng" created="Mon, 16 Nov 2015 07:59:50 +0000"/>
                            <attachment id="12772424" name="HBASE-14803.v4-trunk.patch" size="2398" author="jmspaggi" created="Sun, 15 Nov 2015 23:51:13 +0000"/>
                            <attachment id="12772538" name="HBASE-14803.v5-trunk.patch" size="3510" author="jmspaggi" created="Mon, 16 Nov 2015 18:01:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 12 Nov 2015 22:40:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2obsf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>