<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:00:51 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-9041/HBASE-9041.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-9041] TestFlushSnapshotFromClient.testConcurrentSnapshottingAttempts fails</title>
                <link>https://issues.apache.org/jira/browse/HBASE-9041</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Assigning Matteo to take a look (give back to me if you don&apos;t have time boss).&lt;/p&gt;

&lt;p&gt;Failed here: &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4293/testReport/org.apache.hadoop.hbase.snapshot/TestFlushSnapshotFromClient/testConcurrentSnapshottingAttempts/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4293/testReport/org.apache.hadoop.hbase.snapshot/TestFlushSnapshotFromClient/testConcurrentSnapshottingAttempts/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Yesterday, it failed in a different place and for different reason: &lt;a href=&quot;https://builds.apache.org/view/H-L/view/HBase/job/hbase-0.95/352/testReport/junit/org.apache.hadoop.hbase.snapshot/TestFlushSnapshotFromClient/testFlushTableSnapshot/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/view/H-L/view/HBase/job/hbase-0.95/352/testReport/junit/org.apache.hadoop.hbase.snapshot/TestFlushSnapshotFromClient/testFlushTableSnapshot/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The latter test fail was noted on tail of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8984&quot; title=&quot;Test online snapshots with online merge&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8984&quot;&gt;&lt;del&gt;HBASE-8984&lt;/del&gt;&lt;/a&gt;.  There I speculate that its the &apos;load&apos; of 400.  I don&apos;t think the load reporting is correct.  Will dig in on that.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12659823">HBASE-9041</key>
            <summary>TestFlushSnapshotFromClient.testConcurrentSnapshottingAttempts fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mbertozzi">Matteo Bertozzi</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Jul 2013 15:06:06 +0000</created>
                <updated>Mon, 23 Sep 2013 19:22:28 +0000</updated>
                            <resolved>Fri, 2 Aug 2013 16:55:53 +0000</resolved>
                                                    <fixVersion>0.95.2</fixVersion>
                                    <component>snapshots</component>
                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13719684" author="mbertozzi" created="Thu, 25 Jul 2013 15:14:01 +0000"  >&lt;p&gt;my guess is there&apos;s too much data insert/too many regions for a busy machine... and you get this timeout/regions not yet online/ready exceptions&lt;/p&gt;</comment>
                            <comment id="13719694" author="stack" created="Thu, 25 Jul 2013 15:26:25 +0000"  >&lt;p&gt;Any suggestions on making it carry less load?  Else we should just disable the test &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13719697" author="mbertozzi" created="Thu, 25 Jul 2013 15:31:55 +0000"  >&lt;p&gt;change the rowCount to something low is the first idea: loadData(table, 10000, TEST_FAM); &lt;br/&gt;
but I need some time to look at it, unless you want to try reducing it now&lt;/p&gt;</comment>
                            <comment id="13719703" author="stack" created="Thu, 25 Jul 2013 15:34:51 +0000"  >&lt;p&gt;Is it supposed to do this in the test &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-07-25 06:54:13,314 WARN  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-3129] snapshot.TestFlushSnapshotFromClient(504): Got an exception when checking &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; snapshot ss3
org.apache.hadoop.hbase.exceptions.UnknownSnapshotException: org.apache.hadoop.hbase.exceptions.UnknownSnapshotException: Snapshot { ss=ss3 table=test2 type=FLUSH } is not currently running or one of the known completed snapshots.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:95)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:79)
	at org.apache.hadoop.hbase.protobuf.ProtobufUtil.getRemoteException(ProtobufUtil.java:232)
	at org.apache.hadoop.hbase.client.HBaseAdmin.executeCallable(HBaseAdmin.java:2701)
	at org.apache.hadoop.hbase.client.HBaseAdmin.execute(HBaseAdmin.java:2670)
	at org.apache.hadoop.hbase.client.HBaseAdmin.isSnapshotFinished(HBaseAdmin.java:2364)
	at org.apache.hadoop.hbase.snapshot.TestFlushSnapshotFromClient.testConcurrentSnapshottingAttempts(TestFlushSnapshotFromClient.java:500)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And on yesterday&apos;s fail, you think it for same reason &amp;#8211; overloaded?&lt;/p&gt;

&lt;p&gt;This test came in w/ &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7321&quot; title=&quot;Simple Flush Snapshot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7321&quot;&gt;&lt;del&gt;HBASE-7321&lt;/del&gt;&lt;/a&gt;.  I could bother &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jon%40cloudera.com&quot; class=&quot;user-hover&quot; rel=&quot;jon@cloudera.com&quot;&gt;Jonathan Hsieh&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13719706" author="stack" created="Thu, 25 Jul 2013 15:35:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; Let me try reducing it.  Thanks.&lt;/p&gt;</comment>
                            <comment id="13719714" author="mbertozzi" created="Thu, 25 Jul 2013 15:43:33 +0000"  >&lt;p&gt;the snapshot related failures are related to the RS not ready...&lt;/p&gt;</comment>
                            <comment id="13719717" author="stack" created="Thu, 25 Jul 2013 15:46:48 +0000"  >&lt;p&gt;Write way less rows.  Passes locally.  Let me commit and see how it does.&lt;/p&gt;</comment>
                            <comment id="13719718" author="stack" created="Thu, 25 Jul 2013 15:48:12 +0000"  >&lt;p&gt;Applied to trunk and 0.95.  Lets see how it does &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;  Thanks boss.&lt;/p&gt;</comment>
                            <comment id="13721642" author="stack" created="Sat, 27 Jul 2013 14:55:44 +0000"  >&lt;p&gt;A bunch failed here: &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95-on-hadoop2/197/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95-on-hadoop2/197/&lt;/a&gt;  Different type of fail.&lt;/p&gt;</comment>
                            <comment id="13721643" author="mbertozzi" created="Sat, 27 Jul 2013 15:00:53 +0000"  >&lt;p&gt;There&apos;s only one test failing here which is testFlushCreateListDestroy() the other are consequence of snapshots not cleaned up, see &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9058&quot; title=&quot;deleteSnapshot() call may be skipped in TestFlushSnapshotFromClient tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9058&quot;&gt;&lt;del&gt;HBASE-9058&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The problem in this case, is the previous applied patch which reduces the data to the regions, leaving one region without data.&lt;/p&gt;</comment>
                            <comment id="13721646" author="stack" created="Sat, 27 Jul 2013 15:02:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; So I need to do more than 10 rows?  It was 10k rows.&lt;/p&gt;</comment>
                            <comment id="13721648" author="stack" created="Sat, 27 Jul 2013 15:03:56 +0000"  >&lt;p&gt;Writing 1000 rows instead of 100.&lt;/p&gt;</comment>
                            <comment id="13721649" author="stack" created="Sat, 27 Jul 2013 15:05:21 +0000"  >&lt;p&gt;Committed to 0.95 and trunk.  Lets see how this does.&lt;/p&gt;</comment>
                            <comment id="13721652" author="stack" created="Sat, 27 Jul 2013 15:07:19 +0000"  >&lt;p&gt;Here is another fail: &lt;a href=&quot;http://54.241.6.143/job/HBase-0.95-Hadoop-2/org.apache.hbase$hbase-server/703/testReport/junit/org.apache.hadoop.hbase.client/TestSnapshotFromClient/testSnapshotDeletionWithRegex/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://54.241.6.143/job/HBase-0.95-Hadoop-2/org.apache.hbase$hbase-server/703/testReport/junit/org.apache.hadoop.hbase.client/TestSnapshotFromClient/testSnapshotDeletionWithRegex/&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="13721653" author="mbertozzi" created="Sat, 27 Jul 2013 15:08:32 +0000"  >&lt;p&gt;it&apos;s not just a add random number game &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
there&apos;s a bug in the first rows added, let me fix it.&lt;/p&gt;</comment>
                            <comment id="13721658" author="stack" created="Sat, 27 Jul 2013 15:13:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; Thanks.  I am being lazy.  I want work on something else (smile).  Just commit your attempted fix.  We&apos;ll soon know if it works or not.&lt;/p&gt;</comment>
                            <comment id="13721667" author="mbertozzi" created="Sat, 27 Jul 2013 16:04:25 +0000"  >&lt;p&gt;going to commit v0, that fixes the &quot;ensure 1 row per region&quot; code&lt;/p&gt;</comment>
                            <comment id="13722057" author="stack" created="Sun, 28 Jul 2013 22:00:07 +0000"  >&lt;p&gt;Is this failure related &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4306/testReport/junit/org.apache.hadoop.hbase.snapshot/TestFlushSnapshotFromClient/testConcurrentSnapshottingAttempts/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4306/testReport/junit/org.apache.hadoop.hbase.snapshot/TestFlushSnapshotFromClient/testConcurrentSnapshottingAttempts/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13722260" author="mbertozzi" created="Mon, 29 Jul 2013 08:20:40 +0000"  >&lt;p&gt;no that looks like is just slow, the testConcurrentSnapshottingAttempts() has a fixed stop at 60sec.&lt;br/&gt;
A couple of snapshots are done, the others are not. but they are not failed, so the test is waiting for completion until the 60sec timeout mark the test as failed&lt;/p&gt;</comment>
                            <comment id="13722533" author="stack" created="Mon, 29 Jul 2013 15:23:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; Sounds like I should up 60s timeouts to 5minutes all over the code base?&lt;/p&gt;</comment>
                            <comment id="13723338" author="stack" created="Tue, 30 Jul 2013 03:20:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; Opinion on &lt;a href=&quot;http://54.241.6.143/job/HBase-0.95-Hadoop-2/org.apache.hbase$hbase-server/720/testReport/org.apache.hadoop.hbase.client/TestSnapshotFromClient/testSnapshotDeletionWithRegex/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://54.241.6.143/job/HBase-0.95-Hadoop-2/org.apache.hbase$hbase-server/720/testReport/org.apache.hadoop.hbase.client/TestSnapshotFromClient/testSnapshotDeletionWithRegex/&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="13723340" author="stack" created="Tue, 30 Jul 2013 03:23:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; nvm.  let me up the retry from 1 (Pardon my asking you about these tests; they are about snapshotting so thought you&apos;d be interested)&lt;/p&gt;</comment>
                            <comment id="13727801" author="stack" created="Fri, 2 Aug 2013 16:55:53 +0000"  >&lt;p&gt;Doesn&apos;t fail anymore after matteo jujitsu.  Will open new issue if this comes up again.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12594542" name="HBASE-9041-v0.patch" size="3463" author="mbertozzi" created="Sat, 27 Jul 2013 16:04:25 +0000"/>
                            <attachment id="12594195" name="lessrows.txt" size="3019" author="stack" created="Thu, 25 Jul 2013 15:46:48 +0000"/>
                            <attachment id="12594538" name="uppingrows.txt" size="758" author="stack" created="Sat, 27 Jul 2013 15:03:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 25 Jul 2013 15:14:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>340015</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 20 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1mn73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>340333</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>