<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:53:16 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1409/HBASE-1409.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1409] table TTL expires before its real expiration time which cause row key disappear from Scanner</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1409</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When we create a table with the following schema:&lt;/p&gt;

&lt;p&gt;{NAME =&amp;gt; &apos;jobs_global&apos;, IS_ROOT =&amp;gt; &apos;false&apos;, IS_META =&amp;gt; &apos;false&apos;, MAX_FILESIZE =&amp;gt; &apos;134217728&apos;, FAMILIES =&amp;gt; [&lt;/p&gt;
{NAM
E =&amp;gt; &apos;job&apos;, BLOOMFILTER =&amp;gt; &apos;false&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, VERSIONS =&amp;gt; &apos;1&apos;, LENGTH =&amp;gt; &apos;2147483647&apos;, TTL =&amp;gt; &apos;86
400&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;false&apos;}
&lt;p&gt;], INDEXES =&amp;gt; []}&lt;/p&gt;

&lt;p&gt;The TTL is set to 86400 which should expire after 1 day, but the truth is that it expired before 86400 seconds.&lt;br/&gt;
To reproduce, create a table with the above schema and run some stress testing to create some splits and compaction,&lt;br/&gt;
usually in 4 - 5 hours, the row key will start missing from the Scanners.&lt;/p&gt;

&lt;p&gt;By invoking HTable.get() and HTable.getRow(), the column appears to exist.&lt;br/&gt;
But if you launch a scanner or a MapReduce task to scan the table, the key will be missing.&lt;/p&gt;

&lt;p&gt;By running a simple MapReduce task that prints out all the key value, you can tell some keys are already missing prior to its expiration time.&lt;/p&gt;

&lt;p&gt;When we alter the table&apos;s TTL to a longer time, e.g. 604800, the row key appears in the scanner.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Linux jdc2-atr-dc-2 2.6.18-92.1.22.el5 #1 SMP Tue Dec 16 11:57:43 EST 2008 x86_64 x86_64 x86_64 GNU/Linux&lt;br/&gt;
Hadoop 0.19.1 (r745977) and HBase 0.19.1 (r745977) release candidate.&lt;/p&gt;</environment>
        <key id="12425225">HBASE-1409</key>
            <summary>table TTL expires before its real expiration time which cause row key disappear from Scanner</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="annndy_lee">Andy Lee</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 May 2009 15:19:01 +0000</created>
                <updated>Wed, 20 May 2009 21:56:41 +0000</updated>
                            <resolved>Wed, 20 May 2009 21:56:41 +0000</resolved>
                                    <version>0.19.1</version>
                                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <timeoriginalestimate seconds="432000">120h</timeoriginalestimate>
                            <timeestimate seconds="432000">120h</timeestimate>
                                        <comments>
                            <comment id="12711026" author="stack" created="Wed, 20 May 2009 06:18:37 +0000"  >&lt;p&gt;Should we try and fix this for 0.19.3?&lt;/p&gt;</comment>
                            <comment id="12711374" author="apurtell" created="Wed, 20 May 2009 21:52:23 +0000"  >&lt;p&gt;Because the problem happens &amp;lt; 24 hours, major compaction is not a factor. Checked code paths for expiring values prior to rewrite (and also checked compaction code). No apparent defects. Interesting that scanner is reported to be affected but get or getRow is reported to not. Gave StoreFileScanner an especially close look.&lt;/p&gt;

&lt;p&gt;One possibility is that initial timestamp is erroneous, leading to proper expiration against user expectation. I checked the cluster this problem was reported on and all clocks are synchronized, but cannot say if this also held at the time the problem was reported.&lt;/p&gt;

&lt;p&gt;Some simple test case does not reproduce.&lt;/p&gt;</comment>
                            <comment id="12711381" author="apurtell" created="Wed, 20 May 2009 21:56:41 +0000"  >&lt;p&gt;Resolving as cannot reproduce. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 20 May 2009 06:18:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25742</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hd2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99380</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>