<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:29:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5624/HBASE-5624.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5624] Aborting regionserver when splitting region, may cause daughter region not assigned by ServerShutdownHandler.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5624</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If one region is splitting when regionserver is stoping.&lt;br/&gt;
The following code may executed in SplitTransaction#openDaughters.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// TODO: Is &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; check needed here?
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (stopped || stopping) {
      &lt;span class=&quot;code-comment&quot;&gt;// add 2nd daughter first (see HBASE-4335)
&lt;/span&gt;      MetaEditor.addDaughter(server.getCatalogTracker(),
          b.getRegionInfo(), &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
      MetaEditor.addDaughter(server.getCatalogTracker(),
          a.getRegionInfo(), &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Not opening daughters &quot;&lt;/span&gt; +
          b.getRegionInfo().getRegionNameAsString() +
          &lt;span class=&quot;code-quote&quot;&gt;&quot; and &quot;&lt;/span&gt; +
          a.getRegionInfo().getRegionNameAsString() +
          &lt;span class=&quot;code-quote&quot;&gt;&quot; because stopping=&quot;&lt;/span&gt; + stopping + &lt;span class=&quot;code-quote&quot;&gt;&quot;, stopped=&quot;&lt;/span&gt; + stopped);
    } 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So, for the two daughter regions, their location are both null in .META.&lt;/p&gt;

&lt;p&gt;When ServerShutdownHandler process the dead server, it will not assign these two daughter regions since their location(info:server) are null in .META. by MetaReader.getServerUserRegions().&lt;/p&gt;</description>
                <environment></environment>
        <key id="12547739">HBASE-5624</key>
            <summary>Aborting regionserver when splitting region, may cause daughter region not assigned by ServerShutdownHandler.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zjushch">chunhui shen</assignee>
                                    <reporter username="zjushch">chunhui shen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Mar 2012 05:02:01 +0000</created>
                <updated>Fri, 12 Oct 2012 05:35:04 +0000</updated>
                            <resolved>Fri, 23 Mar 2012 21:20:50 +0000</resolved>
                                                    <fixVersion>0.92.2</fixVersion>
                    <fixVersion>0.94.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13236346" author="stack" created="Fri, 23 Mar 2012 05:26:59 +0000"  >&lt;p&gt;This is for the case where we stop a regionserver on a rolling restart or we just stop a single regionserver but we leave the rest of the cluster up, right?  Not for the case where the cluster is all going down?&lt;/p&gt;

&lt;p&gt;+1 on the patch.  Passing via hadoopqa.&lt;/p&gt;</comment>
                            <comment id="13236356" author="zjushch" created="Fri, 23 Mar 2012 05:40:24 +0000"  >&lt;p&gt;@stack&lt;br/&gt;
Yes, if cluster is all going down, master will assign region whose location is null when cluster is started up.&lt;/p&gt;

&lt;p&gt;However, if only one rs is stoped( or aborted by exception), master proceess it as dead server by ServerShutdownHandler, and the daughter regions whose location are null will not be assigned.&lt;/p&gt;</comment>
                            <comment id="13236359" author="stack" created="Fri, 23 Mar 2012 05:44:53 +0000"  >&lt;p&gt;@Chunhui Good catch.  Lets see what hadoopqa says.&lt;/p&gt;</comment>
                            <comment id="13236384" author="hadoopqa" created="Fri, 23 Mar 2012 06:16:33 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12519584/HBASE-5624.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12519584/HBASE-5624.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 1 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.util.TestFSUtils&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1273//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1273//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1273//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1273//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1273//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1273//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13236393" author="zjushch" created="Fri, 23 Mar 2012 06:30:32 +0000"  >&lt;p&gt;I run org.apache.hadoop.hbase.util.TestFSUtils on local PC with the patch and returns OK.&lt;/p&gt;</comment>
                            <comment id="13237144" author="stack" created="Fri, 23 Mar 2012 21:20:50 +0000"  >&lt;p&gt;Committed to trunk, 0.92 and 0.94 branches.  Thanks for the patch Chunhui.  Good one.&lt;/p&gt;</comment>
                            <comment id="13237201" author="hudson" created="Fri, 23 Mar 2012 22:10:24 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2693 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2693/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2693/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5624&quot; title=&quot;Aborting regionserver when splitting region, may cause daughter region not assigned by ServerShutdownHandler.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5624&quot;&gt;&lt;del&gt;HBASE-5624&lt;/del&gt;&lt;/a&gt; Aborting regionserver when splitting region, may cause daughter region not assigned by ServerShutdownHandler (Revision 1304603)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13237264" author="hudson" created="Fri, 23 Mar 2012 23:09:33 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #48 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/48/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/48/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5624&quot; title=&quot;Aborting regionserver when splitting region, may cause daughter region not assigned by ServerShutdownHandler.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5624&quot;&gt;&lt;del&gt;HBASE-5624&lt;/del&gt;&lt;/a&gt; Aborting regionserver when splitting region, may cause daughter region not assigned by ServerShutdownHandler (Revision 1304604)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13237329" author="hudson" created="Sat, 24 Mar 2012 00:11:58 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #336 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/336/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/336/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5624&quot; title=&quot;Aborting regionserver when splitting region, may cause daughter region not assigned by ServerShutdownHandler.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5624&quot;&gt;&lt;del&gt;HBASE-5624&lt;/del&gt;&lt;/a&gt; Aborting regionserver when splitting region, may cause daughter region not assigned by ServerShutdownHandler (Revision 1304606)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12519584" name="HBASE-5624.patch" size="861" author="zjushch" created="Fri, 23 Mar 2012 05:05:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 23 Mar 2012 05:26:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>232836</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 38 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02hjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12444</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>