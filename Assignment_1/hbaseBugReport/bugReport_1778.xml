<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:56:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1778/HBASE-1778.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1778] Improve PerformanceEvaluation</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1778</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Current PerformanceEvaluation class have two problems:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;It is not updated for hadoop-0.20.0.&lt;/li&gt;
	&lt;li&gt;The approach to split maps is not strict. Need to provide correct InputSplit and InputFormat classes. Current code uses TextInputFormat and FileSplit, it is not reasonable.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We will fix these problems.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12433371">HBASE-1778</key>
            <summary>Improve PerformanceEvaluation</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="schubertzhang">Schubert Zhang</assignee>
                                    <reporter username="schubertzhang">Schubert Zhang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Aug 2009 19:32:16 +0000</created>
                <updated>Fri, 20 Nov 2015 13:01:26 +0000</updated>
                            <resolved>Fri, 4 Sep 2009 21:39:14 +0000</resolved>
                                    <version>0.20.0</version>
                                    <fixVersion>0.90.0</fixVersion>
                                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12744997" author="schubertzhang" created="Wed, 19 Aug 2009 11:01:24 +0000"  >&lt;p&gt;The usage of this PerformanceEvaluation is not changed. You can use the commands it as usual.&lt;/p&gt;

&lt;p&gt;1. Add PeInputSplit and PeInputFormat classes for strict map splits and MapReduce job implementation.&lt;br/&gt;
    PeInputFormat.getSplits(...) method reads and parses each line from input file. The row range parameters are filled into  PeInputSplit.&lt;br/&gt;
    Each map task only read one record from its PeInputSplit.&lt;/p&gt;

&lt;p&gt;2. Change EvaluationMapTask and doMapReduce for hadoop-0.20.0 mapreduce.&lt;/p&gt;</comment>
                            <comment id="12746440" author="schubertzhang" created="Sat, 22 Aug 2009 11:16:24 +0000"  >&lt;p&gt;Here, I just attach our report of this performance evaluation, thanks for the good comments from JG (Jonathan Gray), stack, etc.&lt;br/&gt;
Please have a review and comment. &lt;/p&gt;</comment>
                            <comment id="12751304" author="stack" created="Fri, 4 Sep 2009 04:47:31 +0000"  >&lt;p&gt;@Schubert: Thanks for updating to use new APIs.  One question.  What do you mean by the &quot;approach to split maps is not strict&quot;.  Your additions look good, but please help me understand why the old was &apos;off&apos;.  Thanks.&lt;/p&gt;</comment>
                            <comment id="12751326" author="schubertzhang" created="Fri, 4 Sep 2009 06:11:18 +0000"  >&lt;p&gt;It is because the old code use TextInputFormat.  That&apos;s not correct in this case. &lt;br/&gt;
The TextInputFormat extends FileInputFormat. &lt;/p&gt;

&lt;p&gt;There are following mistakes on concept-level or implementation-level for mapreduce programming.&lt;/p&gt;

&lt;p&gt;1. The FileInputFormat treads the input file as its input data, and its recordReader reads lines from the input split of this input file. Its getSplits() method splits input file base on size in bytes, but in fact, the old code want to split the input file base on lines, it is wrong usage here. &lt;/p&gt;

&lt;p&gt;I think the old coder did not understand how the FileInputFormat/TextInputFormat  works. I just implement a new PeInputFormat and PeInputSplit to avoid above misusage and confusion.&lt;/p&gt;

&lt;p&gt;2.  I have not change the total architecture of PerformanceEvaluation to keep the current workflow. &lt;br/&gt;
But in fact, in my opinion, the current MapReduce implementation for PerformanceEvaluation is not a regular one.&lt;/p&gt;

&lt;p&gt;In fact, aside from the above described spliting mechanism,  the real input data in this case is not from the input file. It is not data, but only a range configuration info in file. So, each data/row to be inserted into HBase table should come from the recordReader of InputFormt, and in this case, the recordReader should generate sequential or random rows.&lt;/p&gt;

&lt;p&gt;In my test, we found the old code sometimes gives wrong number of maps. e.g, I set the map number as 40 (4clients*10), but I got 41 splits (maps). It is caused by the wrong split method which split the file base on bytes.  After I add debug log in getSplits(), I got following wrong splited maps:&lt;/p&gt;

&lt;p&gt;split0: startRow=0 perClientRunRows=104857 totalRows=4194304&lt;br/&gt;
startRow=1048576 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split1: startRow=2097152 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split2: startRow=3145728 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split3: startRow=4194304 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split4: startRow=5242880 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split5: startRow=6291456 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split6: startRow=7340032 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split7: startRow=8388608 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split8: startRow=9437184 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split9: startRow=10485760 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split10: startRow=11534336 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split11: startRow=12582912 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split12: startRow=13631488 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split13: startRow=14680064 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split14: startRow=15728640 perClientRunRows=104857 totalRows=4194304&lt;/p&gt;

&lt;p&gt;split15: null&lt;/p&gt;

&lt;p&gt;split16: startRow=16777216 perClientRunRows=104857 totalRows=4194304&lt;br/&gt;
......&lt;br/&gt;
(many other splits are omit here...)&lt;/p&gt;

&lt;p&gt;We can see, some splits include two row-ranges, and some splits have nothing.&lt;/p&gt;


</comment>
                            <comment id="12751620" author="stack" created="Fri, 4 Sep 2009 21:23:20 +0000"  >&lt;p&gt;@Schubert: Nice one.  Let me commit this patch as is.  Do you want to open a new issue to make it so data comes up out of the RecordReader?&lt;/p&gt;

&lt;p&gt;IIRC, way back when writing this code, I was trying to share the client code so it worked for the threaded client case and for the MR client case.  Thats my meagre excuse for the inelegance you point out.&lt;/p&gt;</comment>
                            <comment id="12751628" author="stack" created="Fri, 4 Sep 2009 21:39:14 +0000"  >&lt;p&gt;Applied to TRUNK.  Not apply to branch.  We&apos;ve gone w/ broke PE this long, can let 0.20.x out without this fix.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Schubert.&lt;/p&gt;</comment>
                            <comment id="12751658" author="stack" created="Fri, 4 Sep 2009 23:37:14 +0000"  >&lt;p&gt;I changed my mind and applied to branch too.&lt;/p&gt;</comment>
                            <comment id="12751738" author="schubertzhang" created="Sat, 5 Sep 2009 08:34:41 +0000"  >&lt;p&gt;Thank you, Stack. &lt;br/&gt;
This is our first time to contribute patch to HBase, it is just a little one, &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. We will continue...&lt;br/&gt;
The current PE can work correctly, even though the MR implementation is not yet pretty. I will try to refine it later when I can get free from my corrent project.&lt;/p&gt;</comment>
                            <comment id="15017800" author="lars_francke" created="Fri, 20 Nov 2015 13:01:26 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12417009" name="HBASE-1778.patch" size="13270" author="schubertzhang" created="Wed, 19 Aug 2009 11:18:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 4 Sep 2009 04:47:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32262</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hf73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99724</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>