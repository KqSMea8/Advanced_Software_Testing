<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:23:57 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11517/HBASE-11517.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11517] TestReplicaWithCluster turns zombie</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11517</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Happened a few times for me fixing unrelated findbugs.  Here is example: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10065//consoleFull&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10065//consoleFull&lt;/a&gt;  See how it is hanging creating a table:&lt;/p&gt;

&lt;p&gt;&quot;pool-1-thread-1&quot; prio=10 tid=0x00007f1714657000 nid=0x4b7f waiting on condition &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007f16e9f80000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: TIMED_WAITING (sleeping)&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.HBaseAdmin.createTable(HBaseAdmin.java:539)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.HBaseAdmin.createTable(HBaseAdmin.java:424)&lt;br/&gt;
	at org.apache.hadoop.hbase.HBaseTestingUtility.createTable(HBaseTestingUtility.java:1185)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.TestReplicaWithCluster.testCreateDeleteTable(TestReplicaWithCluster.java:138)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12727254">HBASE-11517</key>
            <summary>TestReplicaWithCluster turns zombie</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mantonov">Mikhail Antonov</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Jul 2014 05:32:23 +0000</created>
                <updated>Sat, 21 Feb 2015 23:29:27 +0000</updated>
                            <resolved>Wed, 16 Jul 2014 20:55:02 +0000</resolved>
                                                    <fixVersion>0.99.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14061689" author="stack" created="Tue, 15 Jul 2014 05:33:29 +0000"  >&lt;p&gt;Here is a patch that adds timeouts on the tests.  Might get us logs.  Currently none showing.&lt;/p&gt;</comment>
                            <comment id="14061694" author="stack" created="Tue, 15 Jul 2014 05:37:44 +0000"  >&lt;p&gt;Version of the patch that includes &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; to see if glean info on the zombie test in case it happens again.&lt;/p&gt;</comment>
                            <comment id="14062100" author="stack" created="Tue, 15 Jul 2014 14:14:32 +0000"  >&lt;p&gt;This &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5304/changes&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5304/changes&lt;/a&gt; build of trunk has the hang&lt;/p&gt;</comment>
                            <comment id="14062317" author="enis" created="Tue, 15 Jul 2014 16:58:54 +0000"  >&lt;p&gt;Thanks Stack. I&apos;ve noticed this too. I&apos;ll keep an eye out after this patch. +1. &lt;/p&gt;</comment>
                            <comment id="14062324" author="stack" created="Tue, 15 Jul 2014 17:03:40 +0000"  >&lt;p&gt;Ok.  I applied the attached timeouts.txt &apos;debugging&apos; patch to see if we can get more info on why its hanging up.&lt;/p&gt;</comment>
                            <comment id="14062523" author="hudson" created="Tue, 15 Jul 2014 19:27:26 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5306 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5306/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5306/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; TestReplicaWithCluster turns zombie &amp;#8211; ADDS TIMEOUTS SO CAN DEBUG ZOMBIE (stack: rev bb73791dade15f389dfc1bacd20ca8b177bd39e7)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestReplicaWithCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14062789" author="stack" created="Tue, 15 Jul 2014 22:43:45 +0000"  >&lt;p&gt;Test times out now and we are getting logs: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10070//testReport/org.apache.hadoop.hbase.client/TestReplicaWithCluster/testCreateDeleteTable/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10070//testReport/org.apache.hadoop.hbase.client/TestReplicaWithCluster/testCreateDeleteTable/&lt;/a&gt;.  I see this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-07-15 22:02:28,553 WARN  [PostOpenDeployTasks:235204d3d299a5047091fb4aed3d9b56] handler.OpenRegionHandler$PostOpenDeployTasksThread(326): Exception running postOpenDeployTasks; region=235204d3d299a5047091fb4aed3d9b56
java.lang.NullPointerException: No connection
	at org.apache.hadoop.hbase.MetaTableAccessor.getHTable(MetaTableAccessor.java:180)
	at org.apache.hadoop.hbase.MetaTableAccessor.getMetaHTable(MetaTableAccessor.java:193)
	at org.apache.hadoop.hbase.MetaTableAccessor.putToMetaTable(MetaTableAccessor.java:941)
	at org.apache.hadoop.hbase.MetaTableAccessor.updateLocation(MetaTableAccessor.java:1300)
	at org.apache.hadoop.hbase.MetaTableAccessor.updateRegionLocation(MetaTableAccessor.java:1278)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.postOpenDeployTasks(HRegionServer.java:1724)
	at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler$PostOpenDeployTasksThread.run(OpenRegionHandler.java:321)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;How is this supposed to work might &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mantonov&quot; class=&quot;user-hover&quot; rel=&quot;mantonov&quot;&gt;Mikhail Antonov&lt;/a&gt;? (Presuming the above came in w/ your recent change herein?)  Thanks.&lt;/p&gt;</comment>
                            <comment id="14062820" author="mantonov" created="Tue, 15 Jul 2014 23:04:05 +0000"  >&lt;p&gt;Let me take a look.&lt;/p&gt;</comment>
                            <comment id="14062839" author="stack" created="Tue, 15 Jul 2014 23:13:48 +0000"  >&lt;p&gt;It seems reproducible locally now.... taking a look too.&lt;/p&gt;</comment>
                            <comment id="14062897" author="mantonov" created="Wed, 16 Jul 2014 00:00:19 +0000"  >&lt;p&gt;backed out locally last commit (seems to be obscuring actual error, which is server#shortCircuitConnection being in closed state), running locally.  Individual tests pass on my locally, having started from idea, but whole class failed with this exception you cited, so i suspect something wrong with before vs. beforeClass / tearDown (re)-initialization. Looking further.&lt;/p&gt;</comment>
                            <comment id="14062980" author="mantonov" created="Wed, 16 Jul 2014 01:44:30 +0000"  >&lt;p&gt;So..if i comment out the last line in testReplicaAndReplication() test, which is HTU2.shutdownMiniCluster();, test works fine. Seems like something&apos;s wrong with the way we share hconnections in local hbase cluster - when we shutdown minicluster2, short circuit connection in master running in minicluster1 is also closed.&lt;/p&gt;

&lt;p&gt;Also everything works and test passes if I do start/stop minicluster1 before and after each test. Something wrong with connection sharing.&lt;/p&gt;</comment>
                            <comment id="14063030" author="stack" created="Wed, 16 Jul 2014 02:50:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mantonov&quot; class=&quot;user-hover&quot; rel=&quot;mantonov&quot;&gt;Mikhail Antonov&lt;/a&gt; Good on you.  Want to change the test then?&lt;/p&gt;</comment>
                            <comment id="14063032" author="mantonov" created="Wed, 16 Jul 2014 02:55:05 +0000"  >&lt;p&gt;Ah. MiniHBaseCluster#shutdown calls HConnectionManager.deleteAllConnections(false), which deletes all connections known to connection manager (which holds them in static collection, so it&apos;s shared across both miniclusters). &lt;/p&gt;

&lt;p&gt;I kind of recall having same sort of issue before in one of the tests, which created multiple miniclusters within one test and shut down one of them at the end of test, before the next test runs.&lt;/p&gt;

&lt;p&gt;@stack so we can either change the test or, probably better, change MiniHBaseCluster#shutdown to now kill all connections, but just those matching the configuration of this minicluster. Going to try latter one tonight and make patch.&lt;/p&gt;</comment>
                            <comment id="14063044" author="stack" created="Wed, 16 Jul 2014 03:07:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mantonov&quot; class=&quot;user-hover&quot; rel=&quot;mantonov&quot;&gt;Mikhail Antonov&lt;/a&gt; You the man.&lt;/p&gt;</comment>
                            <comment id="14063189" author="mantonov" created="Wed, 16 Jul 2014 05:51:16 +0000"  >&lt;p&gt;Attached patch.&lt;/p&gt;

&lt;p&gt;Since the change in MiniHBaseCluster would have been more involving, I just ended up delaying minicluster2 shutdown up until afterClass (seems harmless). Also reverted finally {} blocks as they, imo, might obscure issues and added time constraint to 2 left tests.&lt;/p&gt;

&lt;p&gt;Test now runs about  30second for me (from command line) and about 1m20s from idea.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; what do you think?&lt;/p&gt;</comment>
                            <comment id="14063291" author="hudson" created="Wed, 16 Jul 2014 08:44:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #47 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/47/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/47/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; TestReplicaWithCluster turns zombie &amp;#8211; ADDS TIMEOUTS SO CAN DEBUG ZOMBIE (stack: rev 7175f51f0817e93fe2c46aa39937fdff73e383d6)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestReplicaWithCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14063621" author="stack" created="Wed, 16 Jul 2014 15:36:18 +0000"  >&lt;p&gt;Lets see what hadoopqa looks like.  Changing test seems good to me.  Thanks Mikhail&lt;/p&gt;</comment>
                            <comment id="14063631" author="hadoopqa" created="Wed, 16 Jul 2014 15:42:29 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12655995/HBASE-11517_v1-mantonov.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12655995/HBASE-11517_v1-mantonov.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12655995&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10091//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10091//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14063770" author="stack" created="Wed, 16 Jul 2014 17:37:34 +0000"  >&lt;p&gt;Mikhail&apos;s patch at p1 instead so applies.&lt;/p&gt;</comment>
                            <comment id="14063822" author="hadoopqa" created="Wed, 16 Jul 2014 18:05:01 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12656081/11517v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12656081/11517v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12656081&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10093//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14063858" author="stack" created="Wed, 16 Jul 2014 18:27:17 +0000"  >&lt;p&gt;Retry.  And trying locally.  Some issue running hbase-server tests.&lt;/p&gt;</comment>
                            <comment id="14063954" author="mantonov" created="Wed, 16 Jul 2014 19:20:18 +0000"  >&lt;p&gt;linked to another similar failure.&lt;/p&gt;</comment>
                            <comment id="14063958" author="mantonov" created="Wed, 16 Jul 2014 19:22:19 +0000"  >&lt;p&gt;Retrying. Test passes locally when run isolated for me. Will try the whole suite (sorry for that p1 thing, exported patch from idea vs. &apos;git diff &amp;gt;&apos;)&lt;/p&gt;</comment>
                            <comment id="14064034" author="hadoopqa" created="Wed, 16 Jul 2014 20:24:00 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12656096/11517v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12656096/11517v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12656096&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.TestPerTableCFReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10094//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14064038" author="mantonov" created="Wed, 16 Jul 2014 20:29:15 +0000"  >&lt;p&gt;2014-07-16 20:04:35,667 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; hbase.HBaseTestingUtility(394): Created new mini-cluster data directory: /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/hbase-server/target/test-data/3c686420-2e0f-485a-af8a-8057368ca634/dfscluster_d5f2234c-9c56-4672-8cc8-0171cd63ac74, deleteOnExit=true&lt;br/&gt;
2014-07-16 20:04:35,857 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;pool-1-thread-1&amp;#93;&lt;/span&gt; zookeeper.MiniZooKeeperCluster(171): Failed binding ZK Server to client port: 50997&lt;br/&gt;
java.net.BindException: Address already in use&lt;br/&gt;
	at sun.nio.ch.Net.bind0(Native Method)&lt;br/&gt;
	at sun.nio.ch.Net.bind(Net.java:444)&lt;/p&gt;

&lt;p&gt;Doesn&apos;t look related to this patch (may be another flaky test to look at)&lt;/p&gt;</comment>
                            <comment id="14064074" author="enis" created="Wed, 16 Jul 2014 20:53:33 +0000"  >&lt;p&gt;I fear that with this patch we are eclipsing the problem by not closeing HBaseAdmins and HTables.  &lt;/p&gt;</comment>
                            <comment id="14064078" author="stack" created="Wed, 16 Jul 2014 20:55:02 +0000"  >&lt;p&gt;Pushed to master and branch-1.  Thanks for digging in on this Mikhail.&lt;/p&gt;</comment>
                            <comment id="14064081" author="stack" created="Wed, 16 Jul 2014 20:58:03 +0000"  >&lt;p&gt;Just saw &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; comment.  Reverted from master and branch-1.  Suggest that we commit these patches so builds pass again and open new issue to look into the connection issue.&lt;/p&gt;</comment>
                            <comment id="14064090" author="mantonov" created="Wed, 16 Jul 2014 21:05:56 +0000"  >&lt;p&gt;Hm. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; as I understand closing of table admins and tables (as well as adding timeouts) was added by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; in that intermediate patch in order to get more debug information and stabilize the test. In my patch I reverted those changes as I believed that was not the root cause. We&apos;re not eclipsing the problem by not closeing hbase admins, we&apos;re bypassing the problem by delaying shutdown of second minicluster up until afterClass call (the same technique as used in TestPerTableCFReplication, for example?). What do you think?&lt;/p&gt;

&lt;p&gt;The problem is that in MiniHBaseCluster#shutdown() we call HConnectionManager.deleteAllConnections(false); which deleted all hconnection in the JVM. Seems like all tests which run more than 1 minicluster now tend to shutdown all of them at the very end.&lt;/p&gt;

&lt;p&gt;So what&apos;s the consensus to proceed?&lt;/p&gt;</comment>
                            <comment id="14064097" author="hudson" created="Wed, 16 Jul 2014 21:07:25 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5314 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5314/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5314/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; TestReplicaWithCluster turns zombie (Mikhail Antonov) (stack: rev 688877606b10d80e4dede3c30deb4e922ad09a5a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestReplicaWithCluster.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; TestReplicaWithCluster turns zombie (Mikhail Antonov) &amp;#8211; REVERT (stack: rev 782b1456f240ad2fc95555b0f464e6a7e0c1e685)&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestReplicaWithCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14064111" author="enis" created="Wed, 16 Jul 2014 21:16:38 +0000"  >&lt;p&gt;I see, thanks for explaining. I did not have the full context. Does the test pass with keeping table and admin closes? While we have them we might as well keep them, no? If not, let&apos;s just apply the patch. &lt;/p&gt;</comment>
                            <comment id="14064153" author="mantonov" created="Wed, 16 Jul 2014 21:41:44 +0000"  >&lt;p&gt;Yes, it passes with close() statements returned back (see new patch attached). I just didn&apos;t put back try{} finally {} clauses, as I believe finally blocks in tests could sometimes obscure debugging, if code in try{} fails.&lt;/p&gt;</comment>
                            <comment id="14064179" author="stack" created="Wed, 16 Jul 2014 21:55:42 +0000"  >&lt;p&gt;I applied &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mantonov&quot; class=&quot;user-hover&quot; rel=&quot;mantonov&quot;&gt;Mikhail Antonov&lt;/a&gt;&apos;s last patch to master and branch-1.  Thanks Mikhail.&lt;/p&gt;</comment>
                            <comment id="14064245" author="enis" created="Wed, 16 Jul 2014 22:25:00 +0000"  >&lt;p&gt;Thanks Mikhail, Stack for bearing with this! &lt;/p&gt;</comment>
                            <comment id="14064349" author="hudson" created="Wed, 16 Jul 2014 23:45:01 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #49 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/49/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/49/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; TestReplicaWithCluster turns zombie (Mikhail Antonov) (stack: rev 9092314c01c0646c93076d987584dc3986ac71d5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestReplicaWithCluster.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; TestReplicaWithCluster turns zombie (Mikhail Antonov) &amp;#8211; REVERT (stack: rev 68f34f82737c9d44901687b62c3309466805db39)&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestReplicaWithCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14064379" author="hudson" created="Thu, 17 Jul 2014 00:19:46 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #5315 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5315/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5315/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; TestReplicaWithCluster turns zombie (Mikhail Antonov) &amp;#8211; REAPPLY (stack: rev 3455065a75784d38fec348bd413c61dd316208f9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestReplicaWithCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14064481" author="hudson" created="Thu, 17 Jul 2014 01:55:49 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #50 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/50/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/50/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; TestReplicaWithCluster turns zombie (Mikhail Antonov) &amp;#8211; REAPPLY (stack: rev 21f863528d8d27a2ef4a05dce6fe6948ddbff41b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestReplicaWithCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14330566" author="enis" created="Sat, 21 Feb 2015 23:29:27 +0000"  >&lt;p&gt;Closing this issue after 0.99.0 release. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12727617">HBASE-11524</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12655692" name="10930v4.txt" size="33217" author="stack" created="Tue, 15 Jul 2014 05:37:44 +0000"/>
                            <attachment id="12655690" name="11517.timeouts.txt" size="4723" author="stack" created="Tue, 15 Jul 2014 05:33:29 +0000"/>
                            <attachment id="12656096" name="11517v2.txt" size="5516" author="stack" created="Wed, 16 Jul 2014 18:27:17 +0000"/>
                            <attachment id="12656081" name="11517v2.txt" size="5516" author="stack" created="Wed, 16 Jul 2014 17:37:34 +0000"/>
                            <attachment id="12656143" name="HBASE-11517.v2-mantonov-with-closes.patch" size="5398" author="mantonov" created="Wed, 16 Jul 2014 21:41:44 +0000"/>
                            <attachment id="12655995" name="HBASE-11517_v1-mantonov.patch" size="5410" author="mantonov" created="Wed, 16 Jul 2014 05:51:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 Jul 2014 16:58:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>405360</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xrcf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>405387</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>