<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:14:20 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10494/HBASE-10494.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10494] hadoop2 class reference in Maven Central&apos;s hbase-client-0.96.1.1-hadoop1</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10494</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;RpcClient$Connection.class as shipped in the hbase-client-0.96.1.1-hadoop1 jar on Maven Central contains references to org.apache.hadoop.net.SocketInputWrapper. I think this class does not exist in hadoop1 because a classfile search of central yields hits only on 2.0 and 0.23.  There may be other references.  I only know about this one because it was killing my HRegionServer early with this exception:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2014-02-10 20:55:52,021 INFO  [M:0;dalarolap:48768] master.ServerManager: Waiting for region servers count to settle; currently checked in 0, slept for 0 ms, expecting minimum of 1, maximum of 2147483647, timeout of 4500 ms, interval of 1500 ms.
2014-02-10 20:55:52,066 WARN  [RS:0;dalarolap:33703] regionserver.HRegionServer: error telling master we are up
com.google.protobuf.ServiceException: java.lang.NoClassDefFoundError: org/apache/hadoop/net/SocketInputWrapper
        at org.apache.hadoop.hbase.ipc.RpcClient.callBlockingMethod(RpcClient.java:1670)
        at org.apache.hadoop.hbase.ipc.RpcClient$BlockingRpcChannelImplementation.callBlockingMethod(RpcClient.java:1711)
        at org.apache.hadoop.hbase.protobuf.generated.RegionServerStatusProtos$RegionServerStatusService$BlockingStub.regionServerStartup(RegionServerStatusProtos.java:5402)
        at org.apache.hadoop.hbase.regionserver.HRegionServer.reportForDuty(HRegionServer.java:1926)
        at org.apache.hadoop.hbase.regionserver.HRegionServer.run(HRegionServer.java:784)
        at java.lang.Thread.run(Thread.java:744)
Caused by: java.lang.NoClassDefFoundError: org/apache/hadoop/net/SocketInputWrapper
        at org.apache.hadoop.hbase.ipc.RpcClient.createConnection(RpcClient.java:348)
        at org.apache.hadoop.hbase.ipc.RpcClient.getConnection(RpcClient.java:1522)
        at org.apache.hadoop.hbase.ipc.RpcClient.call(RpcClient.java:1424)
        at org.apache.hadoop.hbase.ipc.RpcClient.callBlockingMethod(RpcClient.java:1653)
        ... 5 more
Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.net.SocketInputWrapper
        at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:425)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:358)
        ... 9 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I first stumbled over this while developing an app managed by Maven that depends on hbase-client, but then reproduced it by extracting the hadoop1 tarball and replacing the client jar with the same-named one from Maven Central.&lt;/p&gt;

&lt;p&gt;I think this is not the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7269&quot; title=&quot;Testing in place does not work if not building with default profile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7269&quot;&gt;&lt;del&gt;HBASE-7269&lt;/del&gt;&lt;/a&gt;, although the stacktrace is  similar.&lt;/p&gt;

&lt;p&gt;Here&apos;s a disassembler grep on the Maven Central copy showing some references:&lt;/p&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;# From the root of an extracted hbase-client-0.96.1.1-hadoop1 jar downloaded from Maven Central
client-maven$ javap -verbose &apos;org/apache/hadoop/hbase/ipc/RpcClient$Connection.class&apos; | grep SocketInputWrapper
   #198 = Methodref          #744.#818    //  org/apache/hadoop/net/NetUtils.getInputStream:(Ljava/net/Socket;)Lorg/apache/hadoop/net/SocketInputWrapper;
   #818 = NameAndType        #1115:#1159  //  getInputStream:(Ljava/net/Socket;)Lorg/apache/hadoop/net/SocketInputWrapper;
  #1159 = Utf8               (Ljava/net/Socket;)Lorg/apache/hadoop/net/SocketInputWrapper;
       180: invokestatic  #198                // Method org/apache/hadoop/net/NetUtils.getInputStream:(Ljava/net/Socket;)Lorg/apache/hadoop/net/SocketInputWrapper;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here&apos;s the same grep on the tarball&apos;s copy.  No references.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;# Same as above, but using jar from the download tarball for hadoop1
client-tarball$ javap -verbose &apos;org/apache/hadoop/hbase/ipc/RpcClient$Connection.class&apos; | grep SocketInputWrapper
client-tarball$ 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What do you think?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Only affects jar on Maven Central.  Jar in the hadoop1 tarball download is not affected.&lt;/p&gt;</environment>
        <key id="12694416">HBASE-10494</key>
            <summary>hadoop2 class reference in Maven Central&apos;s hbase-client-0.96.1.1-hadoop1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dalaro">Dan LaRocque</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Feb 2014 03:32:56 +0000</created>
                <updated>Sat, 1 Mar 2014 17:21:23 +0000</updated>
                                            <version>0.96.1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13898520" author="stack" created="Tue, 11 Feb 2014 23:55:04 +0000"  >&lt;p&gt;Let me put up the 0.96.2 RC and see if it has same issues.  If so, it is a problem in how we deploy to mvn repo and will dig in more.&lt;/p&gt;</comment>
                            <comment id="13899665" author="apurtell" created="Wed, 12 Feb 2014 22:14:45 +0000"  >&lt;p&gt;You could also check the 0.98.0 RC in the temporary repository &lt;a href=&quot;https://repository.apache.org/content/repositories/orgapachehbase-1005&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://repository.apache.org/content/repositories/orgapachehbase-1005&lt;/a&gt; . Likewise if you see it there our Maven deploy procedure needs fixing.&lt;/p&gt;</comment>
                            <comment id="13909214" author="java8964" created="Sat, 22 Feb 2014 03:49:55 +0000"  >&lt;p&gt;The maven for HBase 0.94.16 had the same problem. It broken in the same ClassNotFoundException. I changed the version to 0.94.15 and it worked fine.&lt;/p&gt;</comment>
                            <comment id="13917125" author="eyang" created="Sat, 1 Mar 2014 17:21:23 +0000"  >&lt;p&gt;hadoop-common-0.96.1.1-hadoop1.jar from maven central repository also has incorrect reference in hadoop-default.xml&lt;/p&gt;

&lt;p&gt;  &amp;lt;property skipInDoc=&quot;true&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;name&amp;gt;hbase.defaults.for.version&amp;lt;/name&amp;gt;&lt;br/&gt;
    &amp;lt;value&amp;gt;0.96.1.1-hadoop2&amp;lt;/value&amp;gt;&lt;br/&gt;
    &amp;lt;description&amp;gt;This defaults file was compiled for version $&lt;/p&gt;
{project.version}
&lt;p&gt;. This variable is used&lt;br/&gt;
    to make sure that a user doesn&apos;t have an old version of hbase-default.xml on the&lt;br/&gt;
    classpath.&amp;lt;/description&amp;gt;&lt;br/&gt;
  &amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;It prevents client application from starting:&lt;/p&gt;

&lt;p&gt;2014-03-01 09:09:26,853 ERROR 1798542626@qtp-1288854966-7 log - Nested in java.lang.ExceptionInInitializerError:&lt;br/&gt;
java.lang.RuntimeException: hbase-default.xml file seems to be for and old version of HBase (0.96.1.1-hadoop2), this version is 0.96.1.1-hadoop1&lt;br/&gt;
        at org.apache.hadoop.hbase.HBaseConfiguration.checkDefaultsVersion(HBaseConfiguration.java:70)&lt;br/&gt;
        at org.apache.hadoop.hbase.HBaseConfiguration.addHbaseResources(HBaseConfiguration.java:102)&lt;br/&gt;
        at org.apache.hadoop.hbase.HBaseConfiguration.create(HBaseConfiguration.java:113)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 11 Feb 2014 23:55:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>372924</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 41 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1s9mv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>373226</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>