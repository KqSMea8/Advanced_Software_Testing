<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:35:49 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6331/HBASE-6331.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6331] Problem with HBCK mergeOverlaps</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6331</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In HDFSIntegrityFixer#mergeOverlaps(), there is a logic to create the final range of the region after the overlap.&lt;br/&gt;
I can see one issue with this code&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (RegionSplitCalculator.BYTES_COMPARATOR
                    .compare(hi.getEndKey(), range.getSecond()) &amp;gt; 0) {
              range.setSecond(hi.getEndKey());
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here suppose the regions include the end region for which the endKey will be empty, we need to get finally the range with endkey as empty byte[]&lt;br/&gt;
But as per the above logic it will see that any other key greater than the empty byte[] and will set it.&lt;/p&gt;

&lt;p&gt;Finally the new region created will not get endkey as empty byte[]&lt;/p&gt;</description>
                <environment></environment>
        <key id="12597535">HBASE-6331</key>
            <summary>Problem with HBCK mergeOverlaps</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="anoopsamjohn">Anoop Sam John</assignee>
                                    <reporter username="anoopsamjohn">Anoop Sam John</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Jul 2012 08:20:08 +0000</created>
                <updated>Mon, 23 Sep 2013 19:16:09 +0000</updated>
                            <resolved>Mon, 12 Aug 2013 18:42:52 +0000</resolved>
                                                                    <component>hbck</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                <comments>
                            <comment id="13406933" author="anoopsamjohn" created="Thu, 5 Jul 2012 09:31:30 +0000"  >&lt;p&gt;Apart from the mentioned issue, the patch contains a trivial fix for a log issue in HbckInfo#getEndKey()&lt;/p&gt;</comment>
                            <comment id="13406934" author="ram_krish" created="Thu, 5 Jul 2012 09:32:57 +0000"  >&lt;p&gt;This issue we observed after doing -fixSplitParents..followed by hbck -fix and hbck -repair.  I think we may need documentation here on the usage of fixSplitParents.&lt;br/&gt;
Parent region A got split into A1 and A2.&lt;/p&gt;

&lt;p&gt;A -&amp;gt; startkey = &apos;x&apos; and endkey = &apos;&apos;.&lt;/p&gt;

&lt;p&gt;So A1 -&amp;gt; startkey = &apos;x&apos; and endkey = &apos;x1&apos;&lt;br/&gt;
A2 -&amp;gt; startkey = &apos;x1&apos; and endkey =&apos;&apos;.&lt;/p&gt;


&lt;p&gt;Here while reading the hdfs hbck finds there are 2 regions with same start key and 1 region that overlaps.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ERROR: (region ufdr,010193811093051,1341438516341.cd3d13f6574059498ceded9661e136cd.) Multiple regions have the same startkey: 010193811093051
ERROR: (region ufdr,010193811093051,1341438202996.e3af982dffd49d785f76ab6e5aa36fc0.) Multiple regions have the same startkey: 010193811093051
ERROR: (regions ufdr,010193811093051,1341438202996.e3af982dffd49d785f76ab6e5aa36fc0. and ufdr,010196915311117,1341438516341.865326e49dfa71996a92dfa5e45c6977.) There is an overlap in the region chain.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
12/07/05 11:14:09 DEBUG util.HBaseFsck: HRegionInfo read: {NAME =&amp;gt; &apos;ufdr,010193811093051,1341438516341.cd3d13f6574059498ceded9661e136cd.&apos;, STARTKEY =&amp;gt; &apos;010193811093051&apos;, ENDKEY =&amp;gt; &apos;010196915311117&apos;, ENCODED =&amp;gt; cd3d13f6574059498ceded9661e136cd,}
12/07/05 11:14:09 DEBUG util.HBaseFsck: HRegionInfo read: {NAME =&amp;gt; &apos;ufdr,010193811093051,1341438202996.e3af982dffd49d785f76ab6e5aa36fc0.&apos;, STARTKEY =&amp;gt; &apos;010193811093051&apos;, ENDKEY =&amp;gt; &apos;&apos;, ENCODED =&amp;gt; e3af982dffd49d785f76ab6e5aa36fc0,}
12/07/05 11:14:09 DEBUG util.HBaseFsck: HRegionInfo read: {NAME =&amp;gt; &apos;ufdr,010196915311117,1341438516341.865326e49dfa71996a92dfa5e45c6977.&apos;, STARTKEY =&amp;gt; &apos;010196915311117&apos;, ENDKEY =&amp;gt; &apos;&apos;, ENCODED =&amp;gt; 865326e49dfa71996a92dfa5e45c6977,}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now finally while fixing this HBCK creates a region which does not have empty start key.&lt;br/&gt;
We can try fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6223&quot; title=&quot;Document  hbck improvements: HBASE-6173, HBASE-5360&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6223&quot;&gt;&lt;del&gt;HBASE-6223&lt;/del&gt;&lt;/a&gt; so that we are clear on the usage of -fixSplitParents.&lt;/p&gt;</comment>
                            <comment id="13406953" author="hadoopqa" created="Thu, 5 Jul 2012 10:19:56 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12535174/HBASE-6331_Trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12535174/HBASE-6331_Trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The applied patch generated 5 javac compiler warnings (more than the trunk&apos;s current 4 warnings).&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 7 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestWALPlayer&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportExport&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestMultithreadedTableMapper&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2327//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2327//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2327//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2327//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13406973" author="anoopsamjohn" created="Thu, 5 Jul 2012 10:48:07 +0000"  >&lt;p&gt;Need to see whether similar issue is there in other parts of code in HBCK.&lt;br/&gt;
The place where detecting whether region overlap is there or not?&lt;/p&gt;</comment>
                            <comment id="13409045" author="lhofhansl" created="Sun, 8 Jul 2012 19:36:42 +0000"  >&lt;p&gt;Patch looks good to me. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmhsieh&quot; class=&quot;user-hover&quot; rel=&quot;jmhsieh&quot;&gt;Jonathan Hsieh&lt;/a&gt; Should have a look at it.&lt;/p&gt;</comment>
                            <comment id="13409215" author="jmhsieh" created="Mon, 9 Jul 2012 06:29:39 +0000"  >&lt;p&gt;Hey Anoop, I believe the problem, but I&apos;m always a stickler for adding tests that cover the previously missing cases.  Mind adding a test case? &lt;/p&gt;

&lt;p&gt;I&apos;m fairly certain the unit test errors were my fault (and reverted). &lt;/p&gt;</comment>
                            <comment id="13409216" author="ram_krish" created="Mon, 9 Jul 2012 06:34:19 +0000"  >&lt;p&gt;@Jon&lt;br/&gt;
Could you take a look at &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6331?focusedCommentId=13406934&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13406934&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-6331?focusedCommentId=13406934&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13406934&lt;/a&gt;.&lt;br/&gt;
We are having some doubts on the usage of -fixSplitParents.&lt;/p&gt;</comment>
                            <comment id="13409219" author="jmhsieh" created="Mon, 9 Jul 2012 06:36:33 +0000"  >&lt;p&gt;Ram, I&apos;ll comment about the motivation for -fixSplitParents over on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6223&quot; title=&quot;Document  hbck improvements: HBASE-6173, HBASE-5360&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6223&quot;&gt;&lt;del&gt;HBASE-6223&lt;/del&gt;&lt;/a&gt;.  &lt;/p&gt;</comment>
                            <comment id="13410030" author="anoopsamjohn" created="Tue, 10 Jul 2012 03:21:54 +0000"  >&lt;p&gt;@Jon&lt;br/&gt;
    Sure I will add test case. I have doubt whether some other problems in the related area. Any way tests will reveal that.&lt;/p&gt;</comment>
                            <comment id="13411882" author="lhofhansl" created="Wed, 11 Jul 2012 19:21:09 +0000"  >&lt;p&gt;I&apos;m OK with committing this without a test (change looks very safe to me).&lt;br/&gt;
Can we either move this to 0.94.2 or add a 0.94.2 task for adding a test?&lt;/p&gt;</comment>
                            <comment id="13412249" author="jmhsieh" created="Wed, 11 Jul 2012 22:37:23 +0000"  >&lt;p&gt;Lars, let&apos;s go ahead and bump it to 0.94.2 &amp;#8211; I don&apos;t want to hold up a release, and though it is a bug, we&apos;ve gotten by without it for a while now. &lt;/p&gt;
</comment>
                            <comment id="13412261" author="jxiang" created="Wed, 11 Jul 2012 22:45:15 +0000"  >&lt;p&gt;I don&apos;t think this is a bug.  In hbck, the last endkey is not the normal empty byte[].&lt;br/&gt;
Instead, it is changed to null. So we have a special comparator.&lt;/p&gt;</comment>
                            <comment id="13412386" author="lhofhansl" created="Thu, 12 Jul 2012 00:09:19 +0000"  >&lt;p&gt;Need to release 0.94.1RC soon, pushing for now.&lt;/p&gt;</comment>
                            <comment id="13412994" author="jxiang" created="Thu, 12 Jul 2012 17:43:28 +0000"  >&lt;p&gt;@Anoop, in hbck, the last endkey is changed to null, which is greater than all other keys.&lt;/p&gt;

&lt;p&gt;Could you add a testcase to verify this is not a bug?&lt;/p&gt;</comment>
                            <comment id="13413458" author="anoopsamjohn" created="Fri, 13 Jul 2012 03:21:38 +0000"  >&lt;p&gt;Actually we go one problem while running HBCK. Based on the code review seen this. As you said if NULL is end key and it is being handled then it code should be okey. I will verify all with test case.&lt;br/&gt;
Actually from the log I have seen that the new region created to solve overlap was not having empty end key. I will get and attach that log.&lt;br/&gt;
I will investigate further on this.&lt;/p&gt;</comment>
                            <comment id="13413463" author="jxiang" created="Fri, 13 Jul 2012 03:35:07 +0000"  >&lt;p&gt;For all the add methods of RegionSplitCalculator, the specialEndKey() method seems to be called. If there is a bug, the specialEndKey() probably is not called there. Please share a log.  Thanks.&lt;/p&gt;</comment>
                            <comment id="13445502" author="lhofhansl" created="Fri, 31 Aug 2012 00:24:33 +0000"  >&lt;p&gt;Pushing out again.&lt;/p&gt;</comment>
                            <comment id="13489943" author="lhofhansl" created="Sat, 3 Nov 2012 06:24:42 +0000"  >&lt;p&gt;Removing from 0.94. Pull back if you disagree.&lt;/p&gt;</comment>
                            <comment id="13490204" author="jxiang" created="Sun, 4 Nov 2012 15:44:35 +0000"  >&lt;p&gt;Should we close this now? We can re-open it or create a new one once it can be reproduced.&lt;/p&gt;</comment>
                            <comment id="13737202" author="stack" created="Mon, 12 Aug 2013 18:42:52 +0000"  >&lt;p&gt;Resolving as per Jimmy suggestion above.  We can open new issue and cite this one if we can reproduce.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12535173" name="HBASE-6331_94.patch" size="1372" author="anoopsamjohn" created="Thu, 5 Jul 2012 09:28:26 +0000"/>
                            <attachment id="12535174" name="HBASE-6331_Trunk.patch" size="1411" author="anoopsamjohn" created="Thu, 5 Jul 2012 09:28:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 5 Jul 2012 09:32:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239667</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00s7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2504</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>