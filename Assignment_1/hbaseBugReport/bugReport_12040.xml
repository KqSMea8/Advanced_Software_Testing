<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:29:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-12040/HBASE-12040.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-12040] Performances issues with FilteredScanTest </title>
                <link>https://issues.apache.org/jira/browse/HBASE-12040</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;While testing 0.99.0RC1 release performances, compared to 0.98.6, figured that:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;FilteredScanTest is 100 times slower;&lt;/li&gt;
	&lt;li&gt;RandomReadTest is 1.5 times slower;&lt;/li&gt;
	&lt;li&gt;RandomSeekScanTest is 3.2 times slower;&lt;/li&gt;
	&lt;li&gt;RandomScanWithRange10Test is 1,2 times slower;&lt;/li&gt;
	&lt;li&gt;RandomScanWithRange100Test is 1,3 times slower;&lt;/li&gt;
	&lt;li&gt;RandomScanWithRange1000Test is 4 times slower;&lt;/li&gt;
	&lt;li&gt;SequentialReadTest is 1,7 times slower;&lt;/li&gt;
	&lt;li&gt;SequentialWriteTest is just a bit faster;&lt;/li&gt;
	&lt;li&gt;RandomWriteTest	 is just a bit faster;&lt;/li&gt;
	&lt;li&gt;GaussianRandomReadBenchmark is just a beat slower;&lt;/li&gt;
	&lt;li&gt;SequentialReadBenchmark is 1,1 times slower;&lt;/li&gt;
	&lt;li&gt;SequentialWriteBenchmark is 1,1 times slower;&lt;/li&gt;
	&lt;li&gt;UniformRandomReadBenchmark crashed;&lt;/li&gt;
	&lt;li&gt;UniformRandomSmallScan is 1,3 times slower.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12743019">HBASE-12040</key>
            <summary>Performances issues with FilteredScanTest </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jmspaggi">Jean-Marc Spaggiari</reporter>
                        <labels>
                    </labels>
                <created>Sun, 21 Sep 2014 12:09:06 +0000</created>
                <updated>Wed, 1 Oct 2014 19:48:17 +0000</updated>
                            <resolved>Tue, 30 Sep 2014 23:14:22 +0000</resolved>
                                    <version>0.99.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="14142732" author="stack" created="Sun, 21 Sep 2014 21:58:14 +0000"  >&lt;p&gt;Excellent &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt;  Is this your little cluster?  What size runs did you do?  Can you point me at specs for your test bench/test runs so I can compare.  Thanks boss.&lt;/p&gt;</comment>
                            <comment id="14142771" author="enis" created="Sun, 21 Sep 2014 23:24:25 +0000"  >&lt;p&gt;Some more background here: &lt;a href=&quot;https://mail-archives.apache.org/mod_mbox/hbase-dev/201409.mbox/%3CCAMUu0w9Y_+Afw6wW0hA_P8KBEW35B3ncsHbUQAcfndzs8TcMyA@mail.gmail.com%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://mail-archives.apache.org/mod_mbox/hbase-dev/201409.mbox/%3CCAMUu0w9Y_+Afw6wW0hA_P8KBEW35B3ncsHbUQAcfndzs8TcMyA@mail.gmail.com%3E&lt;/a&gt; &lt;br/&gt;
Excellent analysis!&lt;/p&gt;</comment>
                            <comment id="14148043" author="devaraj" created="Thu, 25 Sep 2014 17:55:07 +0000"  >&lt;p&gt;I was looking at the FilterScan test performance regression.. Ran it the way &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt; cited in the email thread referenced in the previous comment.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hbase org.apache.hadoop.hbase.PerformanceEvaluation sequentialWrite 1;
echo balancer | bin/hbase shell; sleep 60;
hbase org.apache.hadoop.hbase.PerformanceEvaluation --rows=100 --nomapred filterScan 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After a couple of runs with various versions of hbase, I think &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt; has something to do with the regression (although my runs were not enabling that feature). &lt;br/&gt;
I can consistently reproduce the problem on the tip of the 0.98 branch. But if I run the test with the contents of 0.98 as of the commit sha 1cf6c7b2471da2578ee023fec1d89f73e460ee59 (prior to the commit for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;), I don&apos;t see the issue. I also tried running with the sha 822cbc867c1424da8cfa793c9a2e5f374e5da4bf (this is after a few, mostly unrelated, commits after the commit for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;),  and I could reproduce the problem.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt;, if you have time, can you please validate this at your end?&lt;/p&gt;</comment>
                            <comment id="14148044" author="devaraj" created="Thu, 25 Sep 2014 17:56:37 +0000"  >&lt;p&gt;I should also mention that I didn&apos;t rerun the data generation step for every run of the FilterScan test. I generated the data once and every run of the test used that same data.&lt;/p&gt;</comment>
                            <comment id="14148050" author="devaraj" created="Thu, 25 Sep 2014 18:00:07 +0000"  >&lt;p&gt;AFAICT this affect 0.98 as well. Marking it a blocker for 0.98.7&lt;/p&gt;</comment>
                            <comment id="14148097" author="jmspaggi" created="Thu, 25 Sep 2014 18:30:26 +0000"  >&lt;p&gt;Sure.&lt;/p&gt;

&lt;p&gt;I will run 1cf6c7b2471da2578ee023fec1d89f73e460ee59 and 822cbc867c1424da8cfa793c9a2e5f374e5da4bf and compare... &lt;/p&gt;</comment>
                            <comment id="14148182" author="apurtell" created="Thu, 25 Sep 2014 19:25:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;AFAICT this affect 0.98 as well. Marking it a blocker for 0.98.7&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This &quot;shouldn&apos;t&quot; be happening because the feature is disabled by default. So definitely a concern. Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="14148184" author="apurtell" created="Thu, 25 Sep 2014 19:25:50 +0000"  >&lt;p&gt;Updated the issue title if it&apos;s affecting all branches (except 0.94)&lt;/p&gt;</comment>
                            <comment id="14148204" author="apurtell" created="Thu, 25 Sep 2014 19:41:10 +0000"  >&lt;p&gt;The 0.98 commit for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt; is b885130. &lt;/p&gt;</comment>
                            <comment id="14148331" author="apurtell" created="Thu, 25 Sep 2014 21:20:06 +0000"  >&lt;p&gt;I did a quick profiling session of b885130 (with rows 50 to save some time) versus the commit immediately prior and they both look very similar. See attached &apos;at-&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;.html&apos; versus &apos;pre-&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;.html&apos;. Are you able to blame &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt; repeatably &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=devaraj&quot; class=&quot;user-hover&quot; rel=&quot;devaraj&quot;&gt;Devaraj Das&lt;/a&gt;? What differences are you seeing between it and prior?&lt;/p&gt;</comment>
                            <comment id="14148395" author="devaraj" created="Thu, 25 Sep 2014 22:17:00 +0000"  >&lt;p&gt;I am looking at the overall run time of the test. With &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;, I see&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2014-09-25 20:53:09,418 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished TestClient-0 in 517151ms over 100 rows
2014-09-25 20:53:09,418 INFO  [main] hbase.PerformanceEvaluation: [FilteredScanTest] Summary of timings (ms): [517151]
2014-09-25 20:53:09,418 INFO  [main] hbase.PerformanceEvaluation: [FilteredScanTest]    Min: 517151ms   Max: 517151ms   Avg: 517151ms
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Without &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;, the numbers (min, max, avg)  are almost half.&lt;/p&gt;

&lt;p&gt;There is no change in the configuration etc between the two runs. On the configuration itself, I do have bucket cache configured on. I don&apos;t know yet if that is causing any issue (but again the configs are unchanged in the runs)&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.bucketcache.ioengine&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;offheap&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.bucketcache.percentage.in.combinedcache&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;0.7&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.bucketcache.size&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;1400&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;P.S. Nick is on vacation this week. Maybe we should wait for him to come back &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14148455" author="apurtell" created="Thu, 25 Sep 2014 23:08:44 +0000"  >&lt;p&gt;Ok, I turned on bucket cache (2GB on heap, 2GB off heap) I see:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Before &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;: hbase.PerformanceEvaluation: &lt;span class=&quot;error&quot;&gt;&amp;#91;FilteredScanTest&amp;#93;&lt;/span&gt;	Min: 32021ms	Max: 32021ms	Avg: 32021ms&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; hbase.PerformanceEvaluation: &lt;span class=&quot;error&quot;&gt;&amp;#91;FilteredScanTest&amp;#93;&lt;/span&gt;	Min: 23881ms	Max: 23881ms	Avg: 23881ms&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This is an all-localhost cluster, separate master and regionserver processes. Each time I warmed up the &quot;cluster&quot; by running PE, then ran it again to collect results.&lt;/p&gt;</comment>
                            <comment id="14148471" author="devaraj" created="Thu, 25 Sep 2014 23:18:58 +0000"  >&lt;p&gt;Interesting .. you are seeing the opposite of what I am seeing. Performance decreases for me with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;. Let me dig further.&lt;/p&gt;</comment>
                            <comment id="14150214" author="stack" created="Fri, 26 Sep 2014 23:43:51 +0000"  >&lt;p&gt;Here are &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt; notes on how he ran his tests from mailing list:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
You were right, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is my &lt;span class=&quot;code-quote&quot;&gt;&quot;small&quot;&lt;/span&gt; cluster. It&apos;s 4 nodes. One master, 3 RS.
The &lt;span class=&quot;code-quote&quot;&gt;&quot;big&quot;&lt;/span&gt; cluster (8 nodes) is reserved &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Lars (0.94) &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; now ;)

I run the tests using &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; command:
&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; i in {1..10}; &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; echo; echo -n $i ; /home/hadoop/bin/hadoop fs -rmr
/hbase/*; rm -rf /tmp/*; echo rmr /hbase |
/home/zookeeper/zookeeper-3.4.3/bin/zkCli.sh; bin/start-hbase.sh; sleep 60;
bin/hbase org.apache.hadoop.hbase.PerformanceEvaluation sequentialWrite 1;
echo balancer | bin/hbase shell; sleep 60; bin/hbase
org.apache.hadoop.hbase.PerformanceEvaluation --rows=100 --nomapred
filterScan 1; bin/stop-hbase.sh; done &amp;amp;&amp;gt;&amp;gt; output.txt

Basically, it removed everything, start HBase, put some data it in, and
settle down. Then run the test. I &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; that 10 times &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; each test and remove
the smallest and fastests.

Nodes are 16GB.

Extract from hbase-env.sh:
export JAVA_HOME=/usr/local/jdk1.7.0_45/

# Extra Java CLASSPATH elements.  Optional.
# export HBASE_CLASSPATH=

# The maximum amount of heap to use, in MB. Default is 1000.
export HBASE_HEAPSIZE=10240



Configured propoerties:
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.rootdir&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;hdfs:&lt;span class=&quot;code-comment&quot;&gt;//hbasetest1:9000/hbase&amp;lt;/value&amp;gt;
&lt;/span&gt;  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.cluster.distributed&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.zookeeper.quorum&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;hbasetest1.distparser.com&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.zookeeper.property.dataDir&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;/home/zookeeper&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;fs.&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.name&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;hdfs:&lt;span class=&quot;code-comment&quot;&gt;//hbasetest1:9000/&amp;lt;/value&amp;gt;
&lt;/span&gt;  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.regionserver.codecs&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;gz&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;ipc.server.tcpnodelay&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;ipc.client.tcpnodelay&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.regionserver.region.split.policy&amp;lt;/name&amp;gt;

&amp;lt;value&amp;gt;org.apache.hadoop.hbase.regionserver.ConstantSizeRegionSplitPolicy&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.hregion.max.filesize&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;1073741824000&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;


3 disks only per node:
hbase@hbasetest2:~$ lsblk
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda      8:0    0   1,8T  0 disk
&#9500;&#9472;sda1   8:1    0  93,1G  0 part /
&#9492;&#9472;sda2   8:2    0   1,7T  0 part /data1
sdb      8:16   0   1,8T  0 disk
&#9500;&#9472;sdb1   8:17   0   9,3G  0 part [SWAP]
&#9492;&#9472;sdb2   8:18   0   1,8T  0 part /data2
sdc      8:32   0   1,8T  0 disk
&#9492;&#9472;sdc1   8:33   0   1,8T  0 part /data3


data1 to data3 are the datanode partitions.

Drives are pretty empty:
hbase@hbasetest2:~$ df -h
Sys. de fichiers Taille Utilis&#233; Dispo Uti% Mont&#233; sur
/dev/sda1           92G     19G   69G  22% /
udev                10M       0   10M   0% /dev
tmpfs              1,6G    272K  1,6G   1% /run
tmpfs              5,0M       0  5,0M   0% /run/lock
tmpfs              5,0G       0  5,0G   0% /run/shm
/dev/sda2          1,8T    399G  1,4T  24% /data1
/dev/sdb2          1,9T    398G  1,4T  22% /data2
/dev/sdc1          1,9T    397G  1,4T  22% /data3

RegionServers are SATA, Master is SSD. Only one ZK server hosted on the
master too.

0.94.x tests run with hadoop 1.2.1.
0.98.x+ tests run with hadoop 2.2.0

I&apos;m trying to build 0.99 from the source to run it and being able to run
some specific revisions. But so far no success (yet) ;)

Just ask me whatever &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; you might want to know about the cluster. Can
even give you a remote access.

JM
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In standalone mode, master and tip of 0.98 are about the same.  0.98.6 runs about 15% faster.  Let me try on cluster to see if difference more marked there.&lt;/p&gt;</comment>
                            <comment id="14150226" author="apurtell" created="Fri, 26 Sep 2014 23:58:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;0.98.6 runs about 15% faster.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Are you able to checkout out 0.98 head, revert the &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt; commit, and see the perf improvement after?&lt;/p&gt;</comment>
                            <comment id="14150243" author="stack" created="Sat, 27 Sep 2014 00:14:24 +0000"  >&lt;p&gt;I will &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;  Trying to find the 100x difference that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt; reports above.....&lt;/p&gt;</comment>
                            <comment id="14150342" author="apurtell" created="Sat, 27 Sep 2014 02:15:55 +0000"  >&lt;p&gt;Even 15% is enough if we can isolate it to a commit &lt;/p&gt;</comment>
                            <comment id="14150368" author="stack" created="Sat, 27 Sep 2014 03:34:12 +0000"  >&lt;p&gt;When I compare on a cluster doing 100 scans, 0.99.0 dev release is 30% faster than 0.98.  This is one run of 0.98.6 and two of 0.99.0.&lt;/p&gt;

&lt;p&gt;Let me use JMS&apos;s script and see what I get over ten runs.&lt;/p&gt;

</comment>
                            <comment id="14150763" author="jmspaggi" created="Sat, 27 Sep 2014 20:14:56 +0000"  >&lt;p&gt;Sorry, I was sick the last few days so not active, always sleeping &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m back.&lt;/p&gt;

&lt;p&gt;Let me retry few different versions and post the results here. Should have more numbers by tomorrow.&lt;/p&gt;</comment>
                            <comment id="14150900" author="stack" created="Sun, 28 Sep 2014 02:59:10 +0000"  >&lt;p&gt;I ran 5 funs of filteredScan and 5 of randomreads against 0.98 and then against the 0.99.0 release.  Seems like 0.99.0 is faster on filteredScan and about same randomReading.&lt;/p&gt;

&lt;p&gt;0.98&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
filterscan 265478ms over 100 rows
filterscan 246280ms over 100 rows
filterscan 245655ms over 100 rows
filterscan 245236ms over 100 rows
filterscan 246014ms over 100 rows
randomread 429293ms over 1048576 rows
randomread 397037ms over 1048576 rows
randomread 449759ms over 1048576 rows
randomread 442134ms over 1048576 rows
randomread 454600ms over 1048576 rows
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;0.99.0&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
filterscan 219691ms over 100 rows
filterscan 213598ms over 100 rows
filterscan 213214ms over 100 rows
filterscan 213116ms over 100 rows
filterscan 212634ms over 100 rows
randomread 453774ms over 1048576 rows
randomread 442692ms over 1048576 rows
randomread 390530ms over 1048576 rows
randomread 466790ms over 1048576 rows
randomread 449018ms over 1048576 rows
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let me compare w/o hbase-11331.&lt;/p&gt;</comment>
                            <comment id="14151101" author="jmspaggi" created="Sun, 28 Sep 2014 12:49:35 +0000"  >&lt;p&gt;Ok. Stop spending to much time on that.&lt;/p&gt;

&lt;p&gt;I retried few branches last night and figured that at some point, the SequentialWrite because mapred by default and was --nomapred before.&lt;/p&gt;

&lt;p&gt;However, in mapred mode it failed because it looks for the build jars to be in HDFS but is stacktrace is lost into the gigantic log file where I just search for the &quot;Finished&quot; lines...&lt;/p&gt;

&lt;p&gt;So sound like some FilteredScanTest are running against an empty table while some other are running against a full table.&lt;/p&gt;

&lt;p&gt;I will update the SequentialWrite part of the script and update my numbers for the 10 last releases (At least up to where this mapred default value changed) I have tested, update the numbers and report back here. I changed the priority as I have good suspucions that it&apos;s coming from here and should not be a blocker anymore...&lt;/p&gt;

&lt;p&gt;If that&apos;s the case, I&apos;m very sorry about that!&lt;/p&gt;</comment>
                            <comment id="14151121" author="stack" created="Sun, 28 Sep 2014 15:08:54 +0000"  >&lt;p&gt;No worries &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt; Thanks for doing these tests.  Lets see how your reruns do.  If close enough, we can close this and instead take on a more extensive perf compare JIRA.  We need to do it before 1.0 release.  These tests are a bit small.  1M and one client.  We should probably do larger scale tests.&lt;/p&gt;

&lt;p&gt;Here is from the commit just before 11331.  It looks like between this point and the 0.99.0, we lost some randomread perf (thanks against &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt; for getting us to dig in here) while filteredScan was slower back then.  Let me try and get more detail on why.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
099.before.filterscan.txt:2014-09-27 22:08:55,251 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 250721ms over 100 rows
099.before.filterscan.txt:2014-09-27 22:13:07,068 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 247603ms over 100 rows
099.before.filterscan.txt:2014-09-27 22:17:18,743 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 247378ms over 100 rows
099.before.filterscan.txt:2014-09-27 22:21:30,468 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 247487ms over 100 rows
099.before.filterscan.txt:2014-09-27 22:25:42,518 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 247838ms over 100 rows
099.before.randomread.txt:2014-09-27 22:34:07,019 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 412051ms over 1048576 rows
099.before.randomread.txt:2014-09-27 22:41:21,056 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 429792ms over 1048576 rows
099.before.randomread.txt:2014-09-27 22:47:37,499 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 372189ms over 1048576 rows
099.before.randomread.txt:2014-09-27 22:54:33,021 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 411320ms over 1048576 rows
099.before.randomread.txt:2014-09-27 23:01:36,469 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 419260ms over 1048576 rows
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14151141" author="apurtell" created="Sun, 28 Sep 2014 16:56:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;Here is from the commit just before 11331.  It looks like between this point and the 0.99.0, &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Are you referring to the 11331 commit to branch-1 and the head of branch-1? &lt;/p&gt;</comment>
                            <comment id="14151332" author="stack" created="Mon, 29 Sep 2014 03:46:58 +0000"  >&lt;p&gt;Comparing 0.99.0 and just before &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;.  I checked out at&lt;/p&gt;

&lt;p&gt;commit 17b2cea0bd3a98eba4f036d90f7920b1e71776a8&lt;br/&gt;
Author: Enis Soztutar &amp;lt;enis@apache.org&amp;gt;&lt;br/&gt;
Date:   Tue Sep 9 19:03:26 2014 -0700&lt;/p&gt;

&lt;p&gt;    Update CHANGES.txt for 0.99.0&lt;/p&gt;
</comment>
                            <comment id="14151338" author="devaraj" created="Mon, 29 Sep 2014 04:06:59 +0000"  >&lt;p&gt;I am still clueless as to why I see a degradation with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11331&quot; title=&quot;[blockcache] lazy block decompression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11331&quot;&gt;&lt;del&gt;HBASE-11331&lt;/del&gt;&lt;/a&gt;. Maybe, something in my config is not right. I&apos;ll work with Nick to see if he can repro my results and go from there.&lt;/p&gt;</comment>
                            <comment id="14151370" author="stack" created="Mon, 29 Sep 2014 05:11:29 +0000"  >&lt;p&gt;Here is test where I&apos;ve checked out branch-1 at Nick&apos;s commit so 11331 is included.    It perturbs our numbers.  FilteredScans are &apos;faster&apos; because of it&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; and RandomRead looks a bit slower after this single commit.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
099.at.filterscan.txt:2014-09-28 21:07:47,858 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 223008ms over 100 rows
099.at.filterscan.txt:2014-09-28 21:11:27,928 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 215842ms over 100 rows
099.at.filterscan.txt:2014-09-28 21:15:07,705 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 215566ms over 100 rows
099.at.filterscan.txt:2014-09-28 21:18:47,816 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 215858ms over 100 rows
099.at.filterscan.txt:2014-09-28 21:22:28,202 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 216107ms over 100 rows
099.at.randomread.txt:2014-09-28 21:30:39,885 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 425668ms over 1048576 rows
099.at.randomread.txt:2014-09-28 21:38:43,537 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 479408ms over 1048576 rows
099.at.randomread.txt:2014-09-28 21:46:00,051 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 432500ms over 1048576 rows
099.at.randomread.txt:2014-09-28 21:53:15,114 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 430753ms over 1048576 rows
099.at.randomread.txt:2014-09-28 22:01:23,224 INFO  [TestClient-0] hbase.PerformanceEvaluation: Finished in 483916ms over 1048576 rows
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14152023" author="jmspaggi" created="Mon, 29 Sep 2014 18:30:23 +0000"  >&lt;blockquote&gt;
&lt;p&gt; These tests are a bit small. 1M and one client. We should probably do larger scale tests.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I hear you there. I will add some more tests with increased load for the next releases.&lt;/p&gt;


&lt;p&gt;Ran tests again. Tests are average of 10 runs.&lt;/p&gt;

&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Version&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;results&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.98 branch&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5354156791&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;d6cc2fb&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5298372735&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;c682d57&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5359010151&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;b885130&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5111323656&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;Branch-1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.5437815828&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;I will re-run 0.98.5 and 0.98.6 to correct my numbers...&lt;/p&gt;</comment>
                            <comment id="14152485" author="apurtell" created="Mon, 29 Sep 2014 23:08:09 +0000"  >&lt;p&gt;Switching test tools, I did a comparison with YCSB between 0.98.6.1 and 0.98.7-SNAPSHOT (c220be9) on a single host cluster, and found an across the board improvement.&lt;/p&gt;</comment>
                            <comment id="14152489" author="apurtell" created="Mon, 29 Sep 2014 23:10:51 +0000"  >&lt;p&gt;Given the results in the OP have been declared invalid in comments above, and we have various divergent reports, I would like to close this issue as Invalid. What do you think? I think we should continue looking closely at perf differences over time and when we think we&apos;ve found a repeatable regression let&apos;s file a JIRA for that, it will be actionable.&lt;/p&gt;</comment>
                            <comment id="14152493" author="devaraj" created="Mon, 29 Sep 2014 23:13:33 +0000"  >&lt;p&gt;I am fine with that plan, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14152495" author="ndimiduk" created="Mon, 29 Sep 2014 23:16:33 +0000"  >&lt;p&gt;FYI, I&apos;m running the scanRange100 test over a much larger dataset (--size=100) vs various versions and configurations. Will report any meaningful findings. Will also look into the state of Devaraj&apos;s cluster.&lt;/p&gt;

&lt;p&gt;Meanwhile, I think it&apos;s alright to proceed with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;&apos;s suggestion.&lt;/p&gt;</comment>
                            <comment id="14152496" author="apurtell" created="Mon, 29 Sep 2014 23:18:46 +0000"  >&lt;p&gt;I&apos;m also going to scale up. Will resolve this in a few hours unless objection&lt;/p&gt;</comment>
                            <comment id="14152500" author="jmspaggi" created="Mon, 29 Sep 2014 23:23:00 +0000"  >&lt;p&gt;+1 with closing this too. We can continue on the ML.&lt;/p&gt;

&lt;p&gt;I have updated my scripts to use 10 clients instead of 1, and made side that --nomapred is specified everywhere. I will re-run it for all the 0.98 and 0.99 releases and updated my report.&lt;/p&gt;

&lt;p&gt;Sorry about that.&lt;/p&gt;</comment>
                            <comment id="14152648" author="ndimiduk" created="Tue, 30 Sep 2014 01:11:58 +0000"  >&lt;p&gt;Ran the following on single node with separate processes for NN, DN, ZK, HMaster, RS. HDFS 2.4.0, SCR enabled, 5 DFS drives. For branch-1 there&apos;s no RS process. Configured with 20g heap, LRU blockcache, hfile.block.cache.size=0.6, hbase.block.data.cachecompressed is not specified. I use scanRange100 to be consistent with the spirit of the original report, but using a much larger data size.&lt;/p&gt;

&lt;p&gt;Not an explanation of why, but here&apos;s what I came out with. Number in parens is pct change vs 0.98.6.1. This implies we&apos;ve leaked a bit of perf on 0.98 branch since 0.98.6.1 release and it&apos;s gotten worse on branch-1.&lt;/p&gt;

&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; build &lt;/th&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; overall (ms) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; avg (&#956;s) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 95% (&#956;s) &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 0.98.6.1 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 164174 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 15542 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 29649 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; b885130~1 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 195675 (&lt;font color=&quot;red&quot;&gt;19.19%&lt;/font&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 18547 (&lt;font color=&quot;red&quot;&gt;19.33%&lt;/font&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 33337 (&lt;font color=&quot;red&quot;&gt;12.44%&lt;/font&gt;) &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; b885130 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 192937 (&lt;font color=&quot;red&quot;&gt;17.52%&lt;/font&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 18290 (&lt;font color=&quot;red&quot;&gt;17.68%&lt;/font&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 32750 (&lt;font color=&quot;red&quot;&gt;10.46%&lt;/font&gt;) &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 0.99.0RC1 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 201521 (&lt;font color=&quot;red&quot;&gt;22.75%&lt;/font&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 19104 (&lt;font color=&quot;red&quot;&gt;22.92%&lt;/font&gt;) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 33768 (&lt;font color=&quot;red&quot;&gt;13.89%&lt;/font&gt;) &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;Data generated on with RS running 0.98.6.1, using a client built from master (latest PE features).&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ hbase org.apache.hadoop.hbase.PerformanceEvaluation --nomapred --compress=SNAPPY --presplit=10 --size=100 sequentialWrite 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here&apos;s the rough script I ran to get each value:&lt;br/&gt;
1. deploy target version&lt;br/&gt;
2. drop buffer caches&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ sync; echo 3 | sudo tee /proc/sys/vm/drop_caches
3
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;3. run test&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ hbase org.apache.hadoop.hbase.PerformanceEvaluation --nomapred --size=100 --sampleRate=0.0001 scanRange100 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;0.98.6.1 and 0.99.0RC1 are from official releases; other two are built locally using&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ git checkout XXX
$ bash -x ./dev-support/generate-hadoopX-poms.sh 0.98.7-SNAPSHOT 0.98.7-hadoop2-SNAPSHOT
$ mvn -f pom.xml.hadoop2 clean install assembly:single -DskipTests
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt; I think you&apos;ve found something.&lt;/p&gt;</comment>
                            <comment id="14152707" author="apurtell" created="Tue, 30 Sep 2014 01:48:14 +0000"  >&lt;p&gt;Ah, interesting. b885130~1 is 1cf6c7b. Changes between 0.98.6 and b885130 inclusive are:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;1cf6c7b [3 weeks ago] Update version to 0.98.7-SNAPSHOT [Andrew Purtell]
5e7f646 [3 weeks ago] HBASE-11923 Potential race condition in RecoverableZookeeper.checkZk() (Lars Hofhansl) [Enis Soztutar]
b29394c [3 weeks ago] HBASE-11839 TestRegionRebalance is flakey [stack]
33c9e64 [3 weeks ago] HBASE-11918 TestVisibilityLabelsWithDistributedLogReplay#testAddVisibilityLabelsOnRSRestart sometimes fails due to VisibilityController initialization not being recognized [Ted Yu]
2ed1f8f [3 weeks ago] HBASE-9473 Change UI to list &apos;system tables&apos; rather than &apos;catalog tables&apos; (Stack) [Enis Soztutar]
9859493 [3 weeks ago] HBASE-11445 TestZKProcedure#testMultiCohortWithMemberTimeoutDuringPrepare is flaky (Jeffrey Zhong) [Enis Soztutar]
605bc08 [3 weeks ago] HBASE-11772 Bulk load mvcc and seqId issues with native hfiles [Ted Yu]
3f6a44b [3 weeks ago] HBASE-11805 KeyValue to Cell Convert in WALEdit APIs. [anoopsjohn]
1f8bbe5 [3 weeks ago] HBASE-11896 LoadIncrementalHFiles fails in secure mode if the namespace is specified (Ashish Singhi and Ted Yu) [Ted Yu]
2d875c9 [3 weeks ago] HBASE-11885 Provide a Dockerfile to easily build and run HBase from source (Dima Spivak) [Andrew Purtell]
50f71d4 [4 weeks ago] HBASE-11891 Introduce an HBaseInterfaceAudience level to denote class names that appear in configs. [Andrew Purtell]
9d9201c [5 weeks ago] HBASE-11858 Add InterfaceAudience for classes missing it in regionserver packages. [Andrew Purtell]
8ed1ff0 [3 weeks ago] HBASE-11898 CoprocessorHost.Environment should cache class loader instance. (Vladimir Rodionov) [Lars Hofhansl]
817f301 [4 weeks ago] HBASE-11877 Make TableSplit more readable (Liu Shaohui) [stack]
3645223 [4 weeks ago] (tag: 0.98.6RC2, tag: 0.98.6) Update CHANGES.txt for 0.98.6RC2 [Andrew Purtell]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let me see if I can repro with the above and bisect.&lt;/p&gt;</comment>
                            <comment id="14153366" author="ndimiduk" created="Tue, 30 Sep 2014 16:38:05 +0000"  >&lt;p&gt;I cannot remember if I restarted the RS between loading the data and running the first test on 0.98.6.1, which means the first run may have a significantly warmer JIT than the subsequent runs. Please disregard my previous comment; I&apos;ll try to find time to run a more correct script today.&lt;/p&gt;</comment>
                            <comment id="14153402" author="apurtell" created="Tue, 30 Sep 2014 17:01:17 +0000"  >&lt;p&gt;Let me add that I did a comparison yesterday between 3645223 &lt;span class=&quot;error&quot;&gt;&amp;#91;4 weeks ago&amp;#93;&lt;/span&gt; (tag: 0.98.6RC2, tag: 0.98.6) Update CHANGES.txt for 0.98 and c220be9 &lt;span class=&quot;error&quot;&gt;&amp;#91;3 days ago&amp;#93;&lt;/span&gt; (HEAD, 0.98) &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12110&quot; title=&quot;Fix .arcconfig&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12110&quot;&gt;&lt;del&gt;HBASE-12110&lt;/del&gt;&lt;/a&gt; Fix .arcconfig &lt;span class=&quot;error&quot;&gt;&amp;#91;Elliott Clark&amp;#93;&lt;/span&gt; and I didn&apos;t see a significant difference. However I have been using the local filesystem not HDFS, and Hadoop 2.2 not Hadoop 2.4, so I will try again today with a setup closer to Nick&apos;s above. &lt;b&gt;If&lt;/b&gt; I can get repeatable results that show a significant difference I&apos;ll be able to bisect to an implicated commit. &lt;/p&gt;</comment>
                            <comment id="14153469" author="apurtell" created="Tue, 30 Sep 2014 18:02:25 +0000"  >&lt;p&gt;Separate processes for NN, DN, ZK, HMaster, RS, HDFS 2.4.0, SCR enabled, 1 SSD. RS running with 4 GB heap and LruBlockCache.&lt;/p&gt;

&lt;p&gt;Setup: &lt;tt&gt;./bin/hbase pe -nomapred -compress=SNAPPY -presplit=10 sequentialWrite 1&lt;/tt&gt; (-size not available in 0.98 PE)&lt;/p&gt;

&lt;p&gt;Run: Stop and start the RS. Then: &lt;tt&gt;sync; echo 3 | sudo tee /proc/sys/vm/drop_caches ; ./bin/hbase pe -nomapred scanRange100 1&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;c220be9 [3 days ago] (HEAD, 0.98) HBASE-12110 Fix .arcconfig [Elliott Clark]
	hbase.PerformanceEvaluation: Finished TestClient-0 in 1296699ms over 1048576 rows

3645223 [4 weeks ago] (tag: 0.98.6RC2, tag: 0.98.6) Update CHANGES.txt for 0.98.
	hbase.PerformanceEvaluation: Finished TestClient-0 in 1316509ms over 1048576 row
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Not enough data?&lt;/p&gt;

&lt;p&gt;Let me create a table with 10x the number of rows.&lt;/p&gt;

&lt;p&gt;Edit: Fix formatting&lt;/p&gt;</comment>
                            <comment id="14153958" author="ndimiduk" created="Tue, 30 Sep 2014 23:00:33 +0000"  >&lt;p&gt;I&apos;ve redone my test from yesterday with the following changes: (1) made sure the RS process was cycled between loading data and running the PE; (2) run PE test 10 times each. These results are the mean after throwing out the fastest and slowest result in each set (same as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt;&apos;s report). I&apos;m only looking at the overall run time, not the response latencies, though I have the logs if you want further analysis.&lt;/p&gt;

&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;build&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;overall (ms)&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; delta vs 0.98.6.1&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.98.6.1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;149516&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;n/a&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;b885130~1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;148041&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;font color=&quot;green&quot;&gt;-0.99%&lt;/font&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;b885130&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;149680&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;font color=&quot;red&quot;&gt;0.11%&lt;/font&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0.99.0RC1&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;130415&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;font color=&quot;green&quot;&gt;-12.78%&lt;/font&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;Looks like branch-1 has some nice improvements going on &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14153966" author="apurtell" created="Tue, 30 Sep 2014 23:03:20 +0000"  >&lt;p&gt;Ok that&apos;s more like what I am seeing. I aborted my 100M row test-in-progress because it&apos;s taking forever and tying up a dev box. &lt;/p&gt;</comment>
                            <comment id="14153973" author="vrodionov" created="Tue, 30 Sep 2014 23:06:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Looks like branch-1 has some nice improvements going on&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is probably&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12090&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-12090&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14153979" author="ndimiduk" created="Tue, 30 Sep 2014 23:09:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vrodionov&quot; class=&quot;user-hover&quot; rel=&quot;vrodionov&quot;&gt;Vladimir Rodionov&lt;/a&gt; By branch-1, I meant 0.99.0RC1, which looks like it does not contain &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12090&quot; title=&quot;Bytes: more Unsafe, more Faster &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12090&quot;&gt;&lt;del&gt;HBASE-12090&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14153984" author="enis" created="Tue, 30 Sep 2014 23:12:15 +0000"  >&lt;p&gt;Does this mean that b885130 has an issue? &lt;/p&gt;</comment>
                            <comment id="14153987" author="apurtell" created="Tue, 30 Sep 2014 23:14:22 +0000"  >&lt;p&gt;I&apos;m going to re-resolve but if there&apos;s more information to go on here we can open this again or file a follow up&lt;/p&gt;</comment>
                            <comment id="14154009" author="ndimiduk" created="Tue, 30 Sep 2014 23:27:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Does this mean that b885130 has an issue?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;d say the difference here is in the noise.&lt;/p&gt;

&lt;p&gt;One thing to keep in mind is that I&apos;m running &lt;tt&gt;scanRange100&lt;/tt&gt;, while JM reported the issue in FilteredScanTest. To run that test on this dataset, I&apos;ll need to add some new versions of the filtered test that limit scan range, or make the existing scanRange tests accept a filter as an arg.&lt;/p&gt;</comment>
                            <comment id="14155369" author="jmspaggi" created="Wed, 1 Oct 2014 19:48:17 +0000"  >&lt;p&gt;Not related but while testing FilteredScanTest I got some of this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.io.IOException: org.apache.hadoop.hbase.DoNotRetryIOException: Failed after retry of OutOfOrderScannerNextException: was there a rpc timeout?
        at org.apache.hadoop.hbase.PerformanceEvaluation.doLocalClients(PerformanceEvaluation.java:344)
        at org.apache.hadoop.hbase.PerformanceEvaluation.runTest(PerformanceEvaluation.java:1035)
        at org.apache.hadoop.hbase.PerformanceEvaluation.run(PerformanceEvaluation.java:1223)
        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)
        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:84)
        at org.apache.hadoop.hbase.PerformanceEvaluation.main(PerformanceEvaluation.java:1244)
Caused by: org.apache.hadoop.hbase.DoNotRetryIOException: Failed after retry of OutOfOrderScannerNextException: was there a rpc timeout?
        at org.apache.hadoop.hbase.client.ClientScanner.next(ClientScanner.java:384)
        at org.apache.hadoop.hbase.PerformanceEvaluation$FilteredScanTest.testRow(PerformanceEvaluation.java:913)
        at org.apache.hadoop.hbase.PerformanceEvaluation$Test.testTimed(PerformanceEvaluation.java:596)
        at org.apache.hadoop.hbase.PerformanceEvaluation$Test.test(PerformanceEvaluation.java:582)
        at org.apache.hadoop.hbase.PerformanceEvaluation.runOneClient(PerformanceEvaluation.java:1017)
        at org.apache.hadoop.hbase.PerformanceEvaluation$1.call(PerformanceEvaluation.java:328)
        at org.apache.hadoop.hbase.PerformanceEvaluation$1.call(PerformanceEvaluation.java:323)
        at java.util.concurrent.FutureTask.run(FutureTask.java:262)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:744)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12671315" name="at-HBASE-11331.html" size="57773" author="apurtell" created="Thu, 25 Sep 2014 21:20:06 +0000"/>
                            <attachment id="12671316" name="pre-HBASE-11331.html" size="56836" author="apurtell" created="Thu, 25 Sep 2014 21:20:06 +0000"/>
                            <attachment id="12671901" name="ycsb-0.98.6.1-vs-0.98.7.pdf" size="34919" author="apurtell" created="Mon, 29 Sep 2014 23:08:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 21 Sep 2014 21:58:14 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 11 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20b2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>