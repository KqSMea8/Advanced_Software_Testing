<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:40:27 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13170/HBASE-13170.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13170] Allow block cache to be external</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13170</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Allow an external service to provide the block cache. This has the nice property of allowing failover/upgrades to happen without causing a fully cold cache.&lt;/p&gt;

&lt;p&gt;Additionally this allows read replicas to share some of the same memory.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12780227">HBASE-13170</key>
            <summary>Allow block cache to be external</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eclark">Elliott Clark</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Sat, 7 Mar 2015 01:46:48 +0000</created>
                <updated>Wed, 3 Jun 2015 15:29:25 +0000</updated>
                            <resolved>Fri, 27 Mar 2015 20:21:49 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                    <component>io</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                <comments>
                            <comment id="14351323" author="ndimiduk" created="Sat, 7 Mar 2015 02:09:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;Allow block cache to be external&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Go on... &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14351334" author="eclark" created="Sat, 7 Mar 2015 02:28:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/D34635&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D34635&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It&apos;s no where near finished or even ready to really think about in it&apos;s current form. However it&apos;s an interesting thought&lt;/p&gt;</comment>
                            <comment id="14351339" author="eclark" created="Sat, 7 Mar 2015 02:44:46 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
18:32:02 elliott@elliott-mbp ~ echo stats | nc 0 11211 | grep get_
STAT get_hits 584320
STAT get_misses 72526
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For example here&apos;s a run of PE randomRead after restarting the local mode instance.&lt;/p&gt;</comment>
                            <comment id="14351426" author="vrodionov" created="Sat, 7 Mar 2015 05:35:13 +0000"  >&lt;p&gt;SSD-based block cache gives you all you are asking for, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="14351435" author="ndimiduk" created="Sat, 7 Mar 2015 06:11:27 +0000"  >&lt;p&gt;Actually, any BucketCache when used with the save to file feature. But only the data from the bucketcache, iirc.&lt;/p&gt;</comment>
                            <comment id="14351443" author="vrodionov" created="Sat, 7 Mar 2015 06:47:21 +0000"  >&lt;p&gt;Yes, bucket cache with ioengine = file. &lt;/p&gt;</comment>
                            <comment id="14351470" author="eclark" created="Sat, 7 Mar 2015 07:46:15 +0000"  >&lt;p&gt;Yes SSD&apos;s allow you to persist block cache between restarts. However that&apos;s not actually that helpful for some of my services.&lt;/p&gt;

&lt;p&gt;The current bucket cache does not allow two or more regionservers to share the same cache.Moving single regions for rolling restart can roll them to a full block cache.  I can re-deploy at any time and the rolling restart only adds the latency of close/open region. It doesn&apos;t add the latency of a cold block cache.&lt;/p&gt;

&lt;p&gt; Read replicas can warm and share each other&apos;s cache. No need for double the memory just because there is a read replica.&lt;/p&gt;

&lt;p&gt;Additionally memcached is faster than the cheap ssd&apos;s and memory will last for many many more write cycles. No need to worry about wear leveling, or SSD garbage collection, erasure pages, etc.&lt;/p&gt;

&lt;p&gt;Finally memcache allows scaling the read caching of a HBase cluster independent of expensive storage nodes.&lt;/p&gt;</comment>
                            <comment id="14351715" author="stack" created="Sat, 7 Mar 2015 17:46:21 +0000"  >&lt;p&gt;Sounds cool.  What about us peons who don&apos;t happen to have an idle memcached cluster hanging about or you think starting up a bunch of memcached&apos;s doable by proles too? (HBase starts zk, could start companion memcached too...)&lt;/p&gt;</comment>
                            <comment id="14351873" author="ndimiduk" created="Sun, 8 Mar 2015 03:11:01 +0000"  >&lt;p&gt;You&apos;re right, only file ioengine supports this. Which is strange, because persistence path must be specified separately, and the file path data is not reused &amp;#8211; rewriting data from the cache path to the persistence path, not a simple file copy... so why limit only to file ioengine?&lt;/p&gt;</comment>
                            <comment id="14351883" author="ndimiduk" created="Sun, 8 Mar 2015 03:59:37 +0000"  >&lt;p&gt;Looking good &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;. Repeating my comment from fabricator over here: I&apos;ve been thinking we should implement our multi-layer caching properly, supporting an arbitrary number of layers and with ability to specify how we want blocks to cascade from layer to layer.&lt;/p&gt;

&lt;p&gt;I&apos;d prefer to not add memcached companion process for the common case &amp;#8211; people complain enough as it is about having HDFS + ZK as mandatory runtime dependencies. This is a nice optional choice though.&lt;/p&gt;</comment>
                            <comment id="14353618" author="eclark" created="Mon, 9 Mar 2015 21:13:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; No I don&apos;t think that this will be the default deployment for everyone. Sitting next to some of the people with direct knowledge of Memcached does make this a little easier to tolerate the added complexity.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;ve been thinking we should implement our multi-layer caching properly, supporting an arbitrary number of layers and with ability to specify how we want blocks to cascade from layer to layer.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt; That would be really cool.&lt;/p&gt;</comment>
                            <comment id="14354136" author="hongyu.bi" created="Tue, 10 Mar 2015 02:16:19 +0000"  >&lt;p&gt;Cool ! Looking forward for your work&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14370325" author="eclark" created="Thu, 19 Mar 2015 23:23:24 +0000"  >&lt;p&gt;Here&apos;s the latest version.&lt;br/&gt;
Decent configs.&lt;br/&gt;
Better stats handling&lt;br/&gt;
better handling of double checked locking for block cache ( this was a huge per win)&lt;/p&gt;

&lt;p&gt;I&apos;d propose that we get something like this patch in, and then re-do config and multi-tiered caching in another jira. I think that re-do will have to be a breaking change, and it would be nice to decouple the feature from the breaking change.&lt;/p&gt;


&lt;p&gt;To test I have been running ltt and when I kill the local instance and let it come back, I have &amp;gt; 60% cache hit ratio in 10 seconds after opening the regions. Overall response times are the same.&lt;/p&gt;</comment>
                            <comment id="14375491" author="hadoopqa" created="Mon, 23 Mar 2015 07:30:43 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12706450/HBASE-13170-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12706450/HBASE-13170-v1.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 845f5de121e92a99b41b30dc86cb3f2898e0254f.&lt;br/&gt;
  ATTACHMENT ID: 12706450&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1922 checkstyle errors (more than the master&apos;s current 1918 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 1 new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13364//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14376137" author="eclark" created="Mon, 23 Mar 2015 16:29:56 +0000"  >&lt;p&gt;Code clean up.&lt;/p&gt;</comment>
                            <comment id="14376364" author="hadoopqa" created="Mon, 23 Mar 2015 18:42:21 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12706569/HBASE-13170-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12706569/HBASE-13170-v2.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 845f5de121e92a99b41b30dc86cb3f2898e0254f.&lt;br/&gt;
  ATTACHMENT ID: 12706569&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13367//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14382436" author="hadoopqa" created="Thu, 26 Mar 2015 18:49:59 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12707533/HBASE-13170-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12707533/HBASE-13170-v3.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 69f6a2e7b44d33e01866928672700cde1366f429.&lt;br/&gt;
  ATTACHMENT ID: 12707533&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13443//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13443//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13443//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13443//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13443//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13443//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13443//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13443//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14382672" author="busbey" created="Thu, 26 Mar 2015 21:06:55 +0000"  >&lt;p&gt;This looks great. Could you add a general description and configuration info to the ref guide? Right now the section on the block cache that talks about getting things off the java heap talks about the L2 cache and BucketCache.&lt;/p&gt;

&lt;p&gt;Some additional feedback below. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &amp;lt;dependency&amp;gt;
+          &amp;lt;groupId&amp;gt;net.spy&amp;lt;/groupId&amp;gt;
+          &amp;lt;artifactId&amp;gt;spymemcached&amp;lt;/artifactId&amp;gt;
+      &amp;lt;/dependency&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can we flag this as optional, with a comment that it&apos;s needed for the external memcached blockcache?&lt;/p&gt;

&lt;p&gt;The discussion above sounds like we don&apos;t expect the memcached cache to be the common case, and flagging it optional means it won&apos;t show up as a transitive dependency (i.e. when folks depend on hbase-server for the MapReduce bindings).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-          } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(InterruptedException e) {}
+          } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(InterruptedException e) {
+            LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Interrupted eviction thread &quot;&lt;/span&gt;, e);
+          }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also reset the thread&apos;s interrupted status.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; BlockCache getExternalBlockcache(Configuration c) {
+    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+      &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; klass = c.getClass(EXTERNAL_BLOCKCACHE_CLASS_KEY, MemcachedBlockCache.class);
+      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Creating external block cache of type: &quot;&lt;/span&gt; + klass);
+      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (BlockCache) ReflectionUtils.newInstance(klass, c);
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
+      LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error creating external block cache&quot;&lt;/span&gt;, e);
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Could we use an enum of external blockcache implementations that falls back to using class names? That way we can avoid labeling MemcachedBlockCache as IO.Limited(CONFIG) because folks would just use a short name (e.g. &quot;memcached&quot;).&lt;/p&gt;

&lt;p&gt;There&apos;s an &lt;a href=&quot;https://github.com/apache/hbase/blob/master/hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALFactory.java#L132&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;example over in the WALFactory code&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+@InterfaceAudience.Private
+&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class MemcachedBlockCache &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; BlockCache {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This should probably be IA.LimitedPrivate(CONFIG), unless we go with the enum.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Creating MemcachedBlockCache&quot;&lt;/span&gt;);
+    ConnectionFactoryBuilder builder = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConnectionFactoryBuilder()
+        .setOpTimeout(TimeUnit.SECONDS.toMillis(1))
+        .setOpQueueMaxBlockTime(1500)       &lt;span class=&quot;code-comment&quot;&gt;// Cap the max time before anything times out&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I hate configuration knobs, but should this be one?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-comment&quot;&gt;// Catch a pretty broad set of exceptions to limit any changes in the memecache client
&lt;/span&gt;+      &lt;span class=&quot;code-comment&quot;&gt;// and how it handles failures from leaking into the read path.
&lt;/span&gt;+      LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Exception pulling from memcached [ &quot;&lt;/span&gt; + cacheKey.toString() + &lt;span class=&quot;code-quote&quot;&gt;&quot; ]&quot;&lt;/span&gt;, e);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Please update the message to say e.g. that we&apos;re going to treat it as a cache miss and continue.&lt;/p&gt;

&lt;p&gt;Can we just include the exception message at WARN and move the stack trace to debug?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  @Override
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; evictBlock(BlockCacheKey cacheKey) {
+    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+      cacheStats.evict();
+      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; client.delete(cacheKey.toString()).get();
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException e) {
+      LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error deleting &quot;&lt;/span&gt; + cacheKey.toString(), e);
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (ExecutionException e) {
+      LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error deleting &quot;&lt;/span&gt; + cacheKey.toString(), e);
+    }
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the interrupted exception block, please set the thread&apos;s interrupted status.&lt;/p&gt;

&lt;p&gt;Can we move these stack traces to debug while keeping the general error and message at warn?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/PressureAwareCompactionThroughputController.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/PressureAwareCompactionThroughputController.java
index 11ab568..5b079b0 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/PressureAwareCompactionThroughputController.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/PressureAwareCompactionThroughputController.java
@@ -198,6 +198,10 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class PressureAwareCompactionThroughputController &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Configured impl
   @Override
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; control(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; compactionName, &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; size) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; InterruptedException {
     ActiveCompaction compaction = activeCompactions.get(compactionName);
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (compaction == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; 0;
+    }
+
     compaction.totalSize += size;
     &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; deltaSize = compaction.totalSize - compaction.lastControlSize;
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (deltaSize &amp;lt; controlPerSize) {
@@ -235,12 +239,14 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class PressureAwareCompactionThroughputController &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Configured impl
   @Override
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void finish(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; compactionName) {
     ActiveCompaction compaction = activeCompactions.remove(compactionName);
-    &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; elapsedTime = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.max(1, EnvironmentEdgeManager.currentTime() - compaction.startTime);
-    LOG.info(compactionName + &lt;span class=&quot;code-quote&quot;&gt;&quot; average throughput is &quot;&lt;/span&gt;
-        + throughputDesc(compaction.totalSize, elapsedTime) + &lt;span class=&quot;code-quote&quot;&gt;&quot;, slept &quot;&lt;/span&gt;
-        + compaction.numberOfSleeps + &lt;span class=&quot;code-quote&quot;&gt;&quot; time(s) and total slept time is &quot;&lt;/span&gt;
-        + compaction.totalSleepTime + &lt;span class=&quot;code-quote&quot;&gt;&quot; ms. &quot;&lt;/span&gt; + activeCompactions.size()
-        + &lt;span class=&quot;code-quote&quot;&gt;&quot; active compactions remaining, total limit is &quot;&lt;/span&gt; + throughputDesc(maxThroughput));
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (compaction != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+      &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; elapsedTime = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.max(1, EnvironmentEdgeManager.currentTime() - compaction.startTime);
+      LOG.info(compactionName + &lt;span class=&quot;code-quote&quot;&gt;&quot; average throughput is &quot;&lt;/span&gt;
+          + throughputDesc(compaction.totalSize, elapsedTime) + &lt;span class=&quot;code-quote&quot;&gt;&quot;, slept &quot;&lt;/span&gt;
+          + compaction.numberOfSleeps + &lt;span class=&quot;code-quote&quot;&gt;&quot; time(s) and total slept time is &quot;&lt;/span&gt;
+          + compaction.totalSleepTime + &lt;span class=&quot;code-quote&quot;&gt;&quot; ms. &quot;&lt;/span&gt; + activeCompactions.size()
+          + &lt;span class=&quot;code-quote&quot;&gt;&quot; active compactions remaining, total limit is &quot;&lt;/span&gt; + throughputDesc(maxThroughput));
+    }
   }
 
   &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;volatile&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; stopped = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think these changes aren&apos;t related, could we move them to a different ticket?&lt;/p&gt;</comment>
                            <comment id="14383450" author="eclark" created="Fri, 27 Mar 2015 07:15:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;This looks great. Could you add a general description and configuration info to the ref guide?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Let me file a follow on task for that. I am awful at documentation and it will probably take several attempts for me to get that part good.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can we flag this as optional, with a comment that it&apos;s needed for the external memcached blockcache?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Done&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Could we use an enum of external blockcache implementations that falls back to using class names? That way we can avoid labeling bq.MemcachedBlockCache as IO.Limited(CONFIG) because folks would just use a short name (e.g. &quot;memcached&quot;).&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Please update the message to say e.g. that we&apos;re going to treat it as a cache miss and continue.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can we move these stack traces to debug while keeping the general error and message at warn?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I&apos;d rather not. for people that don&apos;t pipe all levels to one file (or use something or than the default file loggers on log4j) it&apos;s nice to have cause and effect in one log message.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think these changes aren&apos;t related, could we move them to a different ticket?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Done.&lt;/p&gt;</comment>
                            <comment id="14383591" author="hadoopqa" created="Fri, 27 Mar 2015 09:36:28 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12707709/HBASE-13170-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12707709/HBASE-13170-v4.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit b6b1e3b86e7dadb6036e97c17bed6ec11da047fc.&lt;br/&gt;
  ATTACHMENT ID: 12707709&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13458//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13458//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13458//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13458//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13458//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13458//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13458//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13458//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14384155" author="ndimiduk" created="Fri, 27 Mar 2015 17:03:55 +0000"  >&lt;blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Can we move these stack traces to debug while keeping the general error and message at warn?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I&apos;d rather not. for people that don&apos;t pipe all levels to one file (or use something or than the default file loggers on log4j) it&apos;s nice to have cause and effect in one log message.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Cached keys expire, so it&apos;s a leak but not a WARN severity. Can they be demoted to DEBUG at least so folk&apos;s logs aren&apos;t bloated with scary exceptions?&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14384182" author="eclark" created="Fri, 27 Mar 2015 17:16:50 +0000"  >&lt;blockquote&gt;&lt;p&gt;Cached keys expire, so it&apos;s a leak but not a WARN severity. Can they be demoted to DEBUG at least so folk&apos;s logs aren&apos;t bloated with scary exceptions?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sure. Let me do that now.&lt;/p&gt;</comment>
                            <comment id="14384193" author="eclark" created="Fri, 27 Mar 2015 17:23:50 +0000"  >&lt;p&gt;To be clear the errors don&apos;t show up on cache misses. You only see errors when the connection errors out or something like that.&lt;br/&gt;
However I don&apos;t want to spam the logs too much if there&apos;s a restart of memcached servers.&lt;/p&gt;</comment>
                            <comment id="14384222" author="eclark" created="Fri, 27 Mar 2015 17:42:25 +0000"  >&lt;p&gt;Moved the log to debug so that the logs won&apos;t be spamming scary messages if there is a memcached server being restarted.&lt;/p&gt;</comment>
                            <comment id="14384286" author="busbey" created="Fri, 27 Mar 2015 18:18:06 +0000"  >&lt;p&gt;+1. Please link the doc ticket once it exists.&lt;/p&gt;</comment>
                            <comment id="14384518" author="hadoopqa" created="Fri, 27 Mar 2015 20:08:08 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12707815/HBASE-13170-v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12707815/HBASE-13170-v5.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 5d2c33158c47fc791d4973c5013d7ae50795d3bc.&lt;br/&gt;
  ATTACHMENT ID: 12707815&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 5 zombie test(s): 	at org.apache.hadoop.hbase.mapreduce.TestRowCounter.testRowCounterNoColumn(TestRowCounter.java:105)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestCellCounter.testCellCounterStartTimeRange(TestCellCounter.java:137)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestTableInputFormat.testInputFormat(TestTableInputFormat.java:375)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestTableInputFormat.testJobConfigurableExtensionOfTableInputFormatBase(TestTableInputFormat.java:353)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestImportTsv.testMROnTableWithCustomMapper(TestImportTsv.java:151)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13462//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13462//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13462//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13462//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13462//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13462//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13462//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13462//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14384549" author="eclark" created="Fri, 27 Mar 2015 20:21:49 +0000"  >&lt;p&gt;pushed to branch-1 and master. Thanks for the reviews everyone.&lt;/p&gt;</comment>
                            <comment id="14384800" author="hudson" created="Fri, 27 Mar 2015 22:22:46 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.1 #333 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/333/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/333/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13170&quot; title=&quot;Allow block cache to be external&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13170&quot;&gt;&lt;del&gt;HBASE-13170&lt;/del&gt;&lt;/a&gt; Allow block cache to be external (eclark: rev 2857b21eaff46089c40bd7babd9d3f3a4278bba0)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;pom.xml&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestCacheConfig.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/CombinedBlockCache.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/InclusiveCombinedBlockCache.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/jamon/org/apache/hadoop/hbase/tmpl/regionserver/BlockCacheTmpl.jamon&lt;/li&gt;
	&lt;li&gt;hbase-server/pom.xml&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/MemcachedBlockCache.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/CacheConfig.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14384847" author="hudson" created="Fri, 27 Mar 2015 22:57:09 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6312 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6312/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6312/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13170&quot; title=&quot;Allow block cache to be external&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13170&quot;&gt;&lt;del&gt;HBASE-13170&lt;/del&gt;&lt;/a&gt; Allow block cache to be external (eclark: rev a4a235b8d131a04b7ba6e411271ef8f519f4a6c6)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestCacheConfig.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/CombinedBlockCache.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/MemcachedBlockCache.java&lt;/li&gt;
	&lt;li&gt;hbase-server/pom.xml&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/CacheConfig.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/InclusiveCombinedBlockCache.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/jamon/org/apache/hadoop/hbase/tmpl/regionserver/BlockCacheTmpl.jamon&lt;/li&gt;
	&lt;li&gt;pom.xml&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14571167" author="ndimiduk" created="Wed, 3 Jun 2015 15:29:25 +0000"  >&lt;p&gt;Closing issues released in 1.1.0.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12786356">HBASE-13354</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12706450" name="HBASE-13170-v1.patch" size="37806" author="eclark" created="Mon, 23 Mar 2015 05:11:56 +0000"/>
                            <attachment id="12706569" name="HBASE-13170-v2.patch" size="40852" author="eclark" created="Mon, 23 Mar 2015 16:29:56 +0000"/>
                            <attachment id="12707533" name="HBASE-13170-v3.patch" size="40852" author="eclark" created="Thu, 26 Mar 2015 16:35:24 +0000"/>
                            <attachment id="12707709" name="HBASE-13170-v4.patch" size="39711" author="eclark" created="Fri, 27 Mar 2015 07:15:30 +0000"/>
                            <attachment id="12707815" name="HBASE-13170-v5.patch" size="39811" author="eclark" created="Fri, 27 Mar 2015 17:42:25 +0000"/>
                            <attachment id="12705745" name="HBASE-13170.patch" size="35915" author="eclark" created="Thu, 19 Mar 2015 23:23:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 7 Mar 2015 02:09:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i26h4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>HBase can use memcached as an external block cache. To use this change your config to set hbase.blockcache.use.external to true and hbase.cache.memcached.servers to contain the list of memcached servers to use.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>