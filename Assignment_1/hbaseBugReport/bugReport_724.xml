<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:46:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-724/HBASE-724.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-724] Deleted rows reappear after a HStore.flushCache() and/or HStore.compactStores()</title>
                <link>https://issues.apache.org/jira/browse/HBASE-724</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When deleting a row, that row seems to be deleted and everything to be normal but some time afterwards that row somehow reappears (HTable.get() and scanners find it again). Looking at the log files it seems like deleted rows reappear after a flush of the memcache or after the compaction...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12399714">HBASE-724</key>
            <summary>Deleted rows reappear after a HStore.flushCache() and/or HStore.compactStores()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="irubin">Izaak Rubin</assignee>
                                    <reporter username="srainville">Sebastien Rainville</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Jul 2008 11:51:18 +0000</created>
                <updated>Fri, 22 Aug 2008 21:35:05 +0000</updated>
                            <resolved>Tue, 19 Aug 2008 01:18:00 +0000</resolved>
                                    <version>0.1.3</version>
                                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12611129" author="srainville" created="Mon, 7 Jul 2008 11:59:59 +0000"  >&lt;p&gt;This patches the unit test for deleteAll() to add coverage of HRegionServer.get(). Note that coverage of the scanners should be added as well.&lt;/p&gt;</comment>
                            <comment id="12611133" author="srainville" created="Mon, 7 Jul 2008 12:19:32 +0000"  >&lt;p&gt;Forgot to mention: testdeleteall.patch is to be applied on branch-0.1. Also, it doesn&apos;t fix anything... it just makes the problem visible. I still don&apos;t know where the problem is exactly but I looked at the HStore.get() implementation and it seems really odd to me:&lt;/p&gt;

&lt;p&gt;1) the code doesn&apos;t look if the LAST version of the cell is deleted but instead just skip those that are deleted and still returns the other ones&lt;/p&gt;

&lt;p&gt;2) getFull() works but not get()... it suggests that get() is faulty&lt;/p&gt;

&lt;p&gt;3) (this one is not directly related to this issue) get() returns the cells in the order that it finds it... how can it be working? i.e. how does the cells are returned in chronological order? I must just not understand the algorithm but let&apos;s say there are multiple versions of the same cell spanned in several mapfiles... all the mapfiles are read sequentially so what garanties that the versions will be found in chronological order? are the mapfiles somehow read in chronological order? and within a mapfile, are the versions of a cell in chronological order as well?&lt;/p&gt;</comment>
                            <comment id="12611147" author="jdcryans" created="Mon, 7 Jul 2008 13:04:30 +0000"  >&lt;p&gt;This seems related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-702&quot; title=&quot;deleteall doesn&amp;#39;t&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-702&quot;&gt;&lt;del&gt;HBASE-702&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;get() returns the cells in the order that it finds it... how can it be working? i.e. how does the cells are returned in chronological order? I must just not understand the algorithm but let&apos;s say there are multiple versions of the same cell spanned in several mapfiles... all the mapfiles are read sequentially so what garanties that the versions will be found in chronological order? are the mapfiles somehow read in chronological order? and within a mapfile, are the versions of a cell in chronological order as well?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The rows are stored and sorted by their HStoreKey which is row+timestamp,&lt;/p&gt;

&lt;p&gt;FYI. this kind of question belongs to the mailing list or you can also drop by on IRC, it wil be nice to chat with someone else from Montreal &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="12611197" author="srainville" created="Mon, 7 Jul 2008 15:11:43 +0000"  >&lt;p&gt;It&apos;s not related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-702&quot; title=&quot;deleteall doesn&amp;#39;t&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-702&quot;&gt;&lt;del&gt;HBASE-702&lt;/del&gt;&lt;/a&gt; because in that bug there was a different behavior in between deleteAll(row) and deleteAll(row, column). In this case, the different behavior is in between get(), getFull() and the scanners. Also, chatting with Jim Kellerman he confirmed that the branch 0.1 was not affected by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-702&quot; title=&quot;deleteall doesn&amp;#39;t&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-702&quot;&gt;&lt;del&gt;HBASE-702&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;And it&apos;s good to know i&apos;m not the only one in Montreal working with hbase &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12611359" author="stack" created="Mon, 7 Jul 2008 21:27:49 +0000"  >&lt;p&gt;This is bad.  Moving to 0.2 so we at least give a look-see to figure whats up here.&lt;/p&gt;</comment>
                            <comment id="12611396" author="stack" created="Mon, 7 Jul 2008 23:16:03 +0000"  >&lt;p&gt;Giving to Izaak to check out&lt;/p&gt;</comment>
                            <comment id="12611401" author="srainville" created="Mon, 7 Jul 2008 23:37:02 +0000"  >&lt;p&gt;I tried to replicate the problem in trunk and couldn&apos;t. I attached the patch 724-trunk.patch that shows what I did. I see that several things changed in trunk and one of them fixed this issue. I&apos;ll try to run my dev environment on trunk and see how it behaves. Feel free to apply this patch on trunk if you think it really adds robustness to the unit tests.&lt;/p&gt;</comment>
                            <comment id="12611699" author="stack" created="Tue, 8 Jul 2008 17:19:14 +0000"  >&lt;p&gt;Not an issue in TRUNK (Thanks Sebastien).  We&apos;ll fix if we do a 0.1.4.&lt;/p&gt;</comment>
                            <comment id="12623523" author="jimk" created="Tue, 19 Aug 2008 01:18:00 +0000"  >&lt;p&gt;Closing this issue as WONTFIX, because there will be no more 0.1 releases now that 0.2 has been released.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12385452" name="724-trunk.patch" size="2813" author="srainville" created="Mon, 7 Jul 2008 23:37:02 +0000"/>
                            <attachment id="12385389" name="testdeleteall.patch" size="5338" author="srainville" created="Mon, 7 Jul 2008 11:59:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 7 Jul 2008 13:04:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25362</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 18 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h927:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98730</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>