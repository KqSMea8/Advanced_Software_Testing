<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:35:44 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6321/HBASE-6321.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6321] ReplicationSource dies reading the peer&apos;s id</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6321</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This is what I saw:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-07-01 05:04:01,638 ERROR org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Closing source 8 because an error occurred: Could not read peer&apos;s cluster id
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /va1-backup/hbaseid
        at org.apache.zookeeper.KeeperException.create(KeeperException.java:127)
        at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)
        at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1021)
        at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.exists(RecoverableZooKeeper.java:154)
        at org.apache.hadoop.hbase.zookeeper.ZKUtil.checkExists(ZKUtil.java:259)
        at org.apache.hadoop.hbase.zookeeper.ClusterId.readClusterIdZNode(ClusterId.java:61)
        at org.apache.hadoop.hbase.replication.regionserver.ReplicationSource.run(ReplicationSource.java:253)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The session should just be reopened.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12597342">HBASE-6321</key>
            <summary>ReplicationSource dies reading the peer&apos;s id</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdcryans">Jean-Daniel Cryans</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 Jul 2012 21:00:58 +0000</created>
                <updated>Sun, 7 Apr 2013 04:37:02 +0000</updated>
                            <resolved>Fri, 31 Aug 2012 05:02:45 +0000</resolved>
                                    <version>0.92.1</version>
                    <version>0.94.0</version>
                                    <fixVersion>0.94.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13412377" author="jmhsieh" created="Wed, 11 Jul 2012 23:55:56 +0000"  >&lt;p&gt;Bumping from 0.90.7 to 0.90.8&lt;/p&gt;</comment>
                            <comment id="13419631" author="jdcryans" created="Fri, 20 Jul 2012 22:30:13 +0000"  >&lt;p&gt;Had a stab at this. What I figured is that the getting of UUIDs was done outside of &lt;tt&gt;ReplicationZookeeper&lt;/tt&gt; so it was missing the functionalities from that class (you can also see the feature envy that was going on there).&lt;/p&gt;

&lt;p&gt;I refactored the ugly UUID stuff in &lt;tt&gt;ReplicationSource.run&lt;/tt&gt; into &lt;tt&gt;ReplicationZookeeper.getPeerUUID&lt;/tt&gt;. There I needed to handle the session expiration issues so I refactored that from another method into &lt;tt&gt;reconnectPeer&lt;/tt&gt;. Now that the issue is handled the possibility of a null UUID remained if the peer wasn&apos;t reachable so I added a loop in &lt;tt&gt;ReplicationSource&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Finally I saw that we were doing the UUID dance in &lt;tt&gt;ReplicationSource.init&lt;/tt&gt; for the current cluster so I pushed that to &lt;tt&gt;ReplicationZookeeper.getUUIDForCluster&lt;/tt&gt; and refactored &lt;tt&gt;getPeerUUID&lt;/tt&gt; to use it.&lt;/p&gt;

&lt;p&gt;The code should be clearer a more reliable.&lt;/p&gt;</comment>
                            <comment id="13419632" author="jdcryans" created="Fri, 20 Jul 2012 22:30:57 +0000"  >&lt;p&gt;Assigning this to me and removing the 0.90 target since I found out that that part of the code was added in 0.92&lt;/p&gt;</comment>
                            <comment id="13419633" author="jdcryans" created="Fri, 20 Jul 2012 22:32:15 +0000"  >&lt;p&gt;Oh I forgot to mention that I ran TestReplication/Source/Manager 2 times each and they all passed.&lt;/p&gt;</comment>
                            <comment id="13431587" author="lhofhansl" created="Thu, 9 Aug 2012 05:42:03 +0000"  >&lt;p&gt;Patch looks good. Want to commit to 0.94.2, J-D?&lt;/p&gt;</comment>
                            <comment id="13431913" author="stack" created="Thu, 9 Aug 2012 15:42:14 +0000"  >&lt;p&gt;+1 on patch.  Does running of TestReplication/Source/Manager test this patch?&lt;/p&gt;</comment>
                            <comment id="13432158" author="jdcryans" created="Thu, 9 Aug 2012 21:16:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;Does running of TestReplication/Source/Manager test this patch?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It exercises it but only in a way that it makes sure I didn&apos;t add bugs, it doesn&apos;t verify if it works or not.&lt;/p&gt;</comment>
                            <comment id="13445097" author="lhofhansl" created="Thu, 30 Aug 2012 17:00:44 +0000"  >&lt;p&gt;+1&lt;br/&gt;
This specific scenario is hard to verify in a test, I think.&lt;/p&gt;</comment>
                            <comment id="13445277" author="jdcryans" created="Thu, 30 Aug 2012 20:36:54 +0000"  >&lt;p&gt;Trunk port.&lt;/p&gt;</comment>
                            <comment id="13445294" author="stack" created="Thu, 30 Aug 2012 21:08:09 +0000"  >&lt;p&gt;You going to commit boss?&lt;/p&gt;</comment>
                            <comment id="13445522" author="lhofhansl" created="Fri, 31 Aug 2012 00:44:15 +0000"  >&lt;p&gt;0.92 patch&lt;/p&gt;</comment>
                            <comment id="13445593" author="hadoopqa" created="Fri, 31 Aug 2012 03:03:44 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12543210/HBASE-6321-0.92.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12543210/HBASE-6321-0.92.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2747//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2747//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13445663" author="jdcryans" created="Fri, 31 Aug 2012 05:02:45 +0000"  >&lt;p&gt;Committed to 0.92, 0.94 and trunk. Thanks for the reviews and thanks for the 0.92 rebase Lars.&lt;/p&gt;</comment>
                            <comment id="13445746" author="hudson" created="Fri, 31 Aug 2012 07:51:08 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #549 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/549/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/549/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6321&quot; title=&quot;ReplicationSource dies reading the peer&amp;#39;s id&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6321&quot;&gt;&lt;del&gt;HBASE-6321&lt;/del&gt;&lt;/a&gt;  ReplicationSource dies reading the peer&apos;s id (Revision 1379288)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13445754" author="hudson" created="Fri, 31 Aug 2012 08:02:58 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #129 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/129/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/129/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6321&quot; title=&quot;ReplicationSource dies reading the peer&amp;#39;s id&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6321&quot;&gt;&lt;del&gt;HBASE-6321&lt;/del&gt;&lt;/a&gt;  ReplicationSource dies reading the peer&apos;s id (Revision 1379288)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13445856" author="hudson" created="Fri, 31 Aug 2012 11:41:26 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #445 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/445/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/445/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6321&quot; title=&quot;ReplicationSource dies reading the peer&amp;#39;s id&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6321&quot;&gt;&lt;del&gt;HBASE-6321&lt;/del&gt;&lt;/a&gt;  ReplicationSource dies reading the peer&apos;s id&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6647&quot; title=&quot;[performance regression] appendNoSync/HBASE-4528 doesn&amp;#39;t take deferred log flush into account&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6647&quot;&gt;&lt;del&gt;HBASE-6647&lt;/del&gt;&lt;/a&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;performance regression&amp;#93;&lt;/span&gt; appendNoSync/&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4528&quot; title=&quot;The put operation can release the rowlock before sync-ing the Hlog&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4528&quot;&gt;&lt;del&gt;HBASE-4528&lt;/del&gt;&lt;/a&gt; doesn&apos;t&lt;br/&gt;
            take deferred log flush into account (Revision 1379290)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13448256" author="hudson" created="Wed, 5 Sep 2012 00:31:37 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #51 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/51/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/51/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6321&quot; title=&quot;ReplicationSource dies reading the peer&amp;#39;s id&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6321&quot;&gt;&lt;del&gt;HBASE-6321&lt;/del&gt;&lt;/a&gt;  ReplicationSource dies reading the peer&apos;s id&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6647&quot; title=&quot;[performance regression] appendNoSync/HBASE-4528 doesn&amp;#39;t take deferred log flush into account&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6647&quot;&gt;&lt;del&gt;HBASE-6647&lt;/del&gt;&lt;/a&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;performance regression&amp;#93;&lt;/span&gt; appendNoSync/&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4528&quot; title=&quot;The put operation can release the rowlock before sync-ing the Hlog&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4528&quot;&gt;&lt;del&gt;HBASE-4528&lt;/del&gt;&lt;/a&gt; doesn&apos;t&lt;br/&gt;
            take deferred log flush into account (Revision 1379290)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13448307" author="hudson" created="Wed, 5 Sep 2012 00:57:15 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #7 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/7/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/7/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6321&quot; title=&quot;ReplicationSource dies reading the peer&amp;#39;s id&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6321&quot;&gt;&lt;del&gt;HBASE-6321&lt;/del&gt;&lt;/a&gt;  ReplicationSource dies reading the peer&apos;s id&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6647&quot; title=&quot;[performance regression] appendNoSync/HBASE-4528 doesn&amp;#39;t take deferred log flush into account&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6647&quot;&gt;&lt;del&gt;HBASE-6647&lt;/del&gt;&lt;/a&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;performance regression&amp;#93;&lt;/span&gt; appendNoSync/&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4528&quot; title=&quot;The put operation can release the rowlock before sync-ing the Hlog&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4528&quot;&gt;&lt;del&gt;HBASE-4528&lt;/del&gt;&lt;/a&gt; doesn&apos;t&lt;br/&gt;
            take deferred log flush into account (Revision 1379290)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13624643" author="stack" created="Sun, 7 Apr 2013 04:37:02 +0000"  >&lt;p&gt;Fix up after bulk move overwrote some 0.94.2 fix versions w/ 0.95.0 (Noticed by Lars Hofhansl)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12543210" name="HBASE-6321-0.92.patch" size="5411" author="lhofhansl" created="Fri, 31 Aug 2012 00:44:15 +0000"/>
                            <attachment id="12537421" name="HBASE-6321-0.94.patch" size="5411" author="jdcryans" created="Fri, 20 Jul 2012 22:30:13 +0000"/>
                            <attachment id="12543156" name="HBASE-6321.patch" size="5471" author="jdcryans" created="Thu, 30 Aug 2012 20:36:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 11 Jul 2012 23:55:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i067xz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34218</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>