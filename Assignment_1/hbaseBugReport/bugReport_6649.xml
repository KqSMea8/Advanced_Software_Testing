<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:38:38 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6649/HBASE-6649.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6649] [0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6649</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Have seen it twice in the recent past: &lt;a href=&quot;http://bit.ly/MPCykB&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bit.ly/MPCykB&lt;/a&gt; &amp;amp; &lt;a href=&quot;http://bit.ly/O79Dq7&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bit.ly/O79Dq7&lt;/a&gt; .. &lt;/p&gt;

&lt;p&gt;Looking briefly at the logs hints at a pattern - in both the failed test instances, there was an RS crash while the test was running.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12604703">HBASE-6649</key>
            <summary>[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="devaraj">Devaraj Das</assignee>
                                    <reporter username="devaraj">Devaraj Das</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Aug 2012 01:34:00 +0000</created>
                <updated>Sun, 7 Apr 2013 04:52:21 +0000</updated>
                            <resolved>Thu, 20 Sep 2012 17:28:48 +0000</resolved>
                                                    <fixVersion>0.94.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13442027" author="zhihyu@ebaysf.com" created="Sun, 26 Aug 2012 04:20:47 +0000"  >&lt;p&gt;I found the following for a hanging TestReplication run in trunk:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2012-08-25 20:43:46,903 WARN  [Master:0;sea-lab-0,43158,1345952626654] master.AssignmentManager(1606): Failed assignment of -ROOT-,,0.70236052 to sea-lab-0,60237,1345952626692, trying to assign elsewhere instead; retry=0
org.apache.hadoop.hbase.ipc.ServerNotRunningYetException: org.apache.hadoop.hbase.ipc.ServerNotRunningYetException: Server is not running yet
  at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
  at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
  at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
  at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
  at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:95)
  at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:79)
  at org.apache.hadoop.hbase.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:187)
  at $Proxy17.openRegion(Unknown Source)
  at org.apache.hadoop.hbase.master.ServerManager.sendRegionOpen(ServerManager.java:500)
  at org.apache.hadoop.hbase.master.AssignmentManager.assign(AssignmentManager.java:1587)
  at org.apache.hadoop.hbase.master.AssignmentManager.assign(AssignmentManager.java:1256)
  at org.apache.hadoop.hbase.master.AssignmentManager.assign(AssignmentManager.java:1226)
  at org.apache.hadoop.hbase.master.AssignmentManager.assign(AssignmentManager.java:1221)
  at org.apache.hadoop.hbase.master.AssignmentManager.assignRoot(AssignmentManager.java:2103)
  at org.apache.hadoop.hbase.master.HMaster.assignRootAndMeta(HMaster.java:785)
  at org.apache.hadoop.hbase.master.HMaster.finishInitialization(HMaster.java:665)
  at org.apache.hadoop.hbase.master.HMaster.run(HMaster.java:439)
  at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:662)
Caused by: org.apache.hadoop.ipc.RemoteException: org.apache.hadoop.hbase.ipc.ServerNotRunningYetException: Server is not running yet
  at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1766)

  at org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:1288)
  at org.apache.hadoop.hbase.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:178)
  ... 11 more

2012-08-25 20:43:46,903 INFO  [Master:0;sea-lab-0,43158,1345952626654] master.RegionStates(250): Region {NAME =&amp;gt; &apos;-ROOT-,,0&apos;, STARTKEY =&amp;gt; &apos;&apos;, ENDKEY =&amp;gt; &apos;&apos;, ENCODED =&amp;gt; 70236052,} transitioned from {-ROOT-,,0.70236052 state=PENDING_OPEN, ts=1345952626860, server=sea-lab-0,60237,1345952626692} to {-ROOT-,,0.70236052 state=OFFLINE, ts=1345952626903, server=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;}

2012-08-25 20:43:46,903 WARN  [Master:0;sea-lab-0,43158,1345952626654] master.AssignmentManager(1772): Can&apos;t move the region 70236052, there is no destination server available.

2012-08-25 20:43:46,903 WARN  [Master:0;sea-lab-0,43158,1345952626654] master.AssignmentManager(1618): Unable to find a viable location to assign region -ROOT-,,0.70236052
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I suggest the following change:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java
===================================================================
--- hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java	(revision 1377368)
+++ hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java	(working copy)
@@ -520,7 +520,7 @@
 
     &lt;span class=&quot;code-comment&quot;&gt;// disable and start the peer
&lt;/span&gt;     admin.disablePeer(&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;);
-    utility2.startMiniHBaseCluster(1, 1);
+    utility2.startMiniHBaseCluster(1, 2);
     Get get = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Get(rowkey);
     &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; NB_RETRIES; i++) {
       Result res = htable2.get(get);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13443515" author="yuzhihong@gmail.com" created="Tue, 28 Aug 2012 20:46:45 +0000"  >&lt;p&gt;From &lt;a href=&quot;https://builds.apache.org/view/G-L/view/HBase/job/HBase-0.92-security/118/testReport/org.apache.hadoop.hbase.replication/TestReplication/queueFailover/:&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/view/G-L/view/HBase/job/HBase-0.92-security/118/testReport/org.apache.hadoop.hbase.replication/TestReplication/queueFailover/:&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2012-08-28 17:29:54,404 DEBUG [main-EventThread] master.AssignmentManager(2911): based on AM, current region=.META.,,1.1028785192 is on server=juno.apache.org,43891,1346174923071 server being checked: juno.apache.org,55977,1346174923023
2012-08-28 17:29:54,405 DEBUG [RegionServer:1;juno.apache.org,43891,1346174923071-EventThread] zookeeper.ZooKeeperWatcher(266): regionserver:43891-0x1396e4723930005 Received ZooKeeper Event, type=NodeChildrenChanged, state=SyncConnected, path=/1/rs
2012-08-28 17:29:54,406 DEBUG [main-EventThread] master.ServerManager(394): Added=juno.apache.org,55977,1346174923023 to dead servers, submitted shutdown handler to be executed, root=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, meta=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2012-08-28 17:29:54,406 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(266): master:55418-0x1396e4723930003 Received ZooKeeper Event, type=NodeChildrenChanged, state=SyncConnected, path=/1/rs
2012-08-28 17:29:54,406 DEBUG [RegionServer:1;juno.apache.org,43891,1346174923071-EventThread] zookeeper.ZKUtil(229): regionserver:43891-0x1396e4723930005 Set watcher on existing znode /1/rs/juno.apache.org,43891,1346174923071
2012-08-28 17:29:54,407 INFO  [MASTER_SERVER_OPERATIONS-juno.apache.org,55418,1346174922926-0] handler.ServerShutdownHandler(175): Splitting logs &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; juno.apache.org,55977,1346174923023
...
2012-08-28 17:29:54,407 DEBUG [main-EventThread] zookeeper.ZKUtil(229): master:55418-0x1396e4723930003 Set watcher on existing znode /1/rs/juno.apache.org,43891,1346174923071
2012-08-28 17:29:54,410 DEBUG [MASTER_SERVER_OPERATIONS-juno.apache.org,55418,1346174922926-0] master.MasterFileSystem(267): Renamed region directory: hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:59869/user/jenkins/hbase/.logs/juno.apache.org,55977,1346174923023-splitting
&lt;/span&gt;2012-08-28 17:29:54,410 INFO  [MASTER_SERVER_OPERATIONS-juno.apache.org,55418,1346174922926-0] master.SplitLogManager(894): dead splitlog worker juno.apache.org,55977,1346174923023
2012-08-28 17:29:54,413 DEBUG [MASTER_SERVER_OPERATIONS-juno.apache.org,55418,1346174922926-0] master.SplitLogManager(246): Scheduling batch of logs to split
2012-08-28 17:29:54,414 INFO  [MASTER_SERVER_OPERATIONS-juno.apache.org,55418,1346174922926-0] master.SplitLogManager(248): started splitting logs in [hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost:59869/user/jenkins/hbase/.logs/juno.apache.org,55977,1346174923023-splitting]
&lt;/span&gt;...
2012-08-28 17:29:55,000 ERROR [IPC Server handler 7 on 59869] security.UserGroupInformation(1124): PriviledgedActionException as:jenkins.hfs.0 cause:java.io.FileNotFoundException: Parent directory doesn&apos;t exist: /user/jenkins/hbase/.logs/juno.apache.org,55977,1346174923023
2012-08-28 17:29:55,004 FATAL [RegionServer:0;juno.apache.org,55977,1346174923023.logRoller] regionserver.HRegionServer(1537): ABORTING region server juno.apache.org,55977,1346174923023: IOE in log roller
java.io.IOException: cannot get log writer
	at org.apache.hadoop.hbase.regionserver.wal.HLog.createWriter(HLog.java:715)
	at org.apache.hadoop.hbase.regionserver.wal.HLog.createWriterInstance(HLog.java:662)
	at org.apache.hadoop.hbase.regionserver.wal.HLog.rollWriter(HLog.java:594)
	at org.apache.hadoop.hbase.regionserver.LogRoller.run(LogRoller.java:94)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:662)
Caused by: java.io.IOException: java.io.FileNotFoundException: java.io.FileNotFoundException: Parent directory doesn&apos;t exist: /user/jenkins/hbase/.logs/juno.apache.org,55977,1346174923023
	at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogWriter.init(SequenceFileLogWriter.java:106)
	at org.apache.hadoop.hbase.regionserver.wal.HLog.createWriter(HLog.java:712)
	... 4 more
Caused by: java.io.FileNotFoundException: java.io.FileNotFoundException: Parent directory doesn&apos;t exist: /user/jenkins/hbase/.logs/juno.apache.org,55977,1346174923023
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:95)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:57)
	at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.&amp;lt;init&amp;gt;(DFSClient.java:3251)
	at org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:713)
	at org.apache.hadoop.hdfs.DistributedFileSystem.createNonRecursive(DistributedFileSystem.java:198)
	at org.apache.hadoop.fs.FileSystem.createNonRecursive(FileSystem.java:601)
	at org.apache.hadoop.io.SequenceFile.createWriter(SequenceFile.java:442)
	at sun.reflect.GeneratedMethodAccessor45.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogWriter.init(SequenceFileLogWriter.java:87)
	... 5 more
Caused by: org.apache.hadoop.ipc.RemoteException: java.io.FileNotFoundException: Parent directory doesn&apos;t exist: /user/jenkins/hbase/.logs/juno.apache.org,55977,1346174923023
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.verifyParentDir(FSNamesystem.java:1167)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFileInternal(FSNamesystem.java:1241)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFile(FSNamesystem.java:1188)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.create(NameNode.java:628)
	at sun.reflect.GeneratedMethodAccessor13.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:563)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1388)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:1384)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:396)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:1382)

	at org.apache.hadoop.ipc.Client.call(Client.java:1070)
	at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:225)
	at $Proxy8.create(Unknown Source)
	at sun.reflect.GeneratedMethodAccessor13.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:82)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:59)
	at $Proxy8.create(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient$DFSOutputStream.&amp;lt;init&amp;gt;(DFSClient.java:3248)
	... 13 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It is clear that log splitting (splitLog() call on master) raced with log roller (on region server).&lt;br/&gt;
In run() of log roller:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ex) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;One option is to distinguish FileNotFoundException from other IOE&apos;s and exit.&lt;/p&gt;</comment>
                            <comment id="13443542" author="yuzhihong@gmail.com" created="Tue, 28 Aug 2012 21:11:22 +0000"  >&lt;p&gt;Reducing replication.sleep.before.failover&lt;/p&gt;</comment>
                            <comment id="13443618" author="yuzhihong@gmail.com" created="Tue, 28 Aug 2012 22:57:10 +0000"  >&lt;p&gt;Without patch, TestReplication#queueFailover failed on 4th iteration.&lt;/p&gt;

&lt;p&gt;With patch v2, 6 iterations passed.&lt;/p&gt;

&lt;p&gt;Running 100 more iterations.&lt;/p&gt;</comment>
                            <comment id="13443631" author="yuzhihong@gmail.com" created="Tue, 28 Aug 2012 23:06:57 +0000"  >&lt;p&gt;Test failed on the 4th of the 100 iterations.&lt;/p&gt;</comment>
                            <comment id="13443642" author="devaraj" created="Tue, 28 Aug 2012 23:19:12 +0000"  >&lt;p&gt;Uploading the two outputs that I had saved (the links in the jira description aren&apos;t valid any more). The worrisome part for me is that in both the cases, the replication seems to be incomplete (although the test waited for a fair bit of time). The fact that one RS from each cluster crashes is expected in this test and the test checks to see that replication succeeds even under this situation.&lt;/p&gt;</comment>
                            <comment id="13443643" author="devaraj" created="Tue, 28 Aug 2012 23:19:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;Test failed on the 4th of the 100 iterations.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What failure did you see?&lt;/p&gt;</comment>
                            <comment id="13443651" author="yuzhihong@gmail.com" created="Tue, 28 Aug 2012 23:27:00 +0000"  >&lt;p&gt;Failed tests:   queueFailover(org.apache.hadoop.hbase.replication.TestReplication): Waited too much time for queueFailover replication. Waited 40364ms.&lt;/p&gt;</comment>
                            <comment id="13446602" author="stack" created="Sat, 1 Sep 2012 04:55:17 +0000"  >&lt;p&gt;Should we disable this flapping test till its figured?&lt;/p&gt;</comment>
                            <comment id="13446607" author="yuzhihong@gmail.com" created="Sat, 1 Sep 2012 05:18:11 +0000"  >&lt;p&gt;I think we should disable this test. &lt;/p&gt;</comment>
                            <comment id="13446608" author="lhofhansl" created="Sat, 1 Sep 2012 05:26:39 +0000"  >&lt;p&gt;A flapping test is almost worse than a failing test. It adds to the runtime, but does not add confidence to the test run.&lt;/p&gt;

&lt;p&gt;There&apos;re some scary comment in there as well:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-comment&quot;&gt;// Takes about 20 secs to run the full loading, kill around the middle
&lt;/span&gt;    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; killer1 = killARegionServer(utility1, 7500, rsToKill1);
    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; killer2 = killARegionServer(utility2, 10000, rsToKill2);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On what machine does it take 20s?&lt;br/&gt;
I&apos;d say we disable it for now.&lt;/p&gt;</comment>
                            <comment id="13446610" author="stack" created="Sat, 1 Sep 2012 05:35:15 +0000"  >&lt;p&gt;I think we disable it in 0.92 and perhaps in 0.94 for 0.94.2 (unless someone fixes it meantime).  We leave this issue as critical on trunk.&lt;/p&gt;</comment>
                            <comment id="13446613" author="yuzhihong@gmail.com" created="Sat, 1 Sep 2012 05:41:39 +0000"  >&lt;p&gt;I saw that comment too. &lt;br/&gt;
On my laptop the loading took about 20 seconds. &lt;/p&gt;</comment>
                            <comment id="13446631" author="devaraj" created="Sat, 1 Sep 2012 07:44:29 +0000"  >&lt;p&gt;So far it seems like a hdfs issue (somehow there are a couple of missing rows in the replicated data). In one or two days I will post some concrete comments..&lt;/p&gt;</comment>
                            <comment id="13448110" author="devaraj" created="Tue, 4 Sep 2012 22:15:54 +0000"  >&lt;p&gt;After spending some time on debugging what was going on (where I took the failure as in &lt;a href=&quot;http://bit.ly/RDdmPg&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bit.ly/RDdmPg&lt;/a&gt; as the test failure to debug), seems to me that the problem is due to the way exceptions are handled in ReplicationSource.java. Basically, the replication would fail with exceptions for all entries involved in a particular call to ReplicationSource.readAllEntriesToReplicateOrNextFile, even if the exception were thrown for the tailing entry(s). This is because of multiple calls to reader.next within readAllEntriesToReplicateOrNextFile. If the second call (within the while loop) throws an exception (like EOFException), it basically destroys the work done up until then. Therefore, some rows would never be replicated.&lt;/p&gt;

&lt;p&gt;The patch attached here makes the exception handling so that if there were a exception in the second time, the method would just return (thereby allowing the present call to readAllEntriesToReplicateOrNextFile proceed normally). The following call to readAllEntriesToReplicateOrNextFile would actually throw the exception.&lt;/p&gt;

&lt;p&gt;With this patch, I stopped noticing the failures similar to &lt;a href=&quot;http://bit.ly/RDdmPg&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bit.ly/RDdmPg&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;However, I do see some other failures and that I am still debugging (and that&apos;s why I renamed this issue to Part-1!)&lt;/p&gt;</comment>
                            <comment id="13448117" author="hadoopqa" created="Tue, 4 Sep 2012 22:23:26 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12543752/6649-1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12543752/6649-1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2779//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2779//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13448512" author="stack" created="Wed, 5 Sep 2012 06:12:27 +0000"  >&lt;p&gt;This patch makes sense to me.  We replicate all up to the exception and then next time in, we should pick up the IOE again.  Want me to commit this DD?&lt;/p&gt;</comment>
                            <comment id="13448514" author="devaraj" created="Wed, 5 Sep 2012 06:17:40 +0000"  >&lt;p&gt;Yeah .. although I should submit a patch for trunk as well.. &lt;/p&gt;</comment>
                            <comment id="13448900" author="yuzhihong@gmail.com" created="Wed, 5 Sep 2012 17:17:17 +0000"  >&lt;p&gt;When I ran DD&apos;s patch in trunk, TestReplication still hung.&lt;/p&gt;</comment>
                            <comment id="13448907" author="devaraj" created="Wed, 5 Sep 2012 17:33:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhihyu%40ebaysf.com&quot; class=&quot;user-hover&quot; rel=&quot;zhihyu@ebaysf.com&quot;&gt;Ted Yu&lt;/a&gt;This patch fixes a specific problem to do with replication missing rows, and in my observations, that leads to somewhat frequent TestReplication.queueFailover failures. On trunk, do you know which test hangs? There probably are more issues to fix in the replication area, and we should have follow up jiras (and this jira is part-1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;).&lt;/p&gt;</comment>
                            <comment id="13448910" author="devaraj" created="Wed, 5 Sep 2012 17:37:11 +0000"  >&lt;p&gt;Patch for trunk&lt;/p&gt;</comment>
                            <comment id="13448914" author="yuzhihong@gmail.com" created="Wed, 5 Sep 2012 17:39:04 +0000"  >&lt;p&gt;target/surefire-reports/org.apache.hadoop.hbase.replication.TestReplication.txt was 0 length.&lt;br/&gt;
There was no JVM left from TestReplication by the time I got back to computer.&lt;/p&gt;</comment>
                            <comment id="13448924" author="lhofhansl" created="Wed, 5 Sep 2012 17:50:32 +0000"  >&lt;p&gt;Patch looks good to me.&lt;br/&gt;
(As Ted points out there might other issues as well)&lt;/p&gt;</comment>
                            <comment id="13448925" author="lhofhansl" created="Wed, 5 Sep 2012 17:51:09 +0000"  >&lt;p&gt;I&apos;d also like this in 0.94. The 0.92 will probably just apply cleanly. If not I&apos;ll make one.&lt;/p&gt;</comment>
                            <comment id="13448942" author="yuzhihong@gmail.com" created="Wed, 5 Sep 2012 18:06:04 +0000"  >&lt;p&gt;@J-D:&lt;br/&gt;
What do you think ?&lt;/p&gt;

&lt;p&gt;nit:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ie) {
+        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;A log statement is desirable before break.&lt;/p&gt;</comment>
                            <comment id="13448987" author="v.himanshu" created="Wed, 5 Sep 2012 18:38:02 +0000"  >&lt;p&gt;lgtm. &lt;br/&gt;
The exception will be re-thrown in the next try, so +0 on adding a log statement before break.&lt;/p&gt;</comment>
                            <comment id="13448988" author="stack" created="Wed, 5 Sep 2012 18:40:51 +0000"  >&lt;p&gt;J-D on vacation.  Let me commit this.  Will add the log message Ted suggests though my sense it overkill, lets see.  Would suggest new issue for other &apos;parts&apos; DD.&lt;/p&gt;</comment>
                            <comment id="13448990" author="devaraj" created="Wed, 5 Sep 2012 18:42:10 +0000"  >&lt;p&gt;Don&apos;t mind adding a few comments around the exception handling..&lt;/p&gt;</comment>
                            <comment id="13448994" author="stack" created="Wed, 5 Sep 2012 18:48:27 +0000"  >&lt;p&gt;Committed to trunk, 0.92, and 0.94.  Thanks for the reviews lads and DD for the patch.&lt;/p&gt;</comment>
                            <comment id="13448995" author="stack" created="Wed, 5 Sep 2012 18:50:31 +0000"  >&lt;p&gt;Here is what I applied.  Includes Ted&apos;s suggested logging.  I applied this same patch to 0.94 and 0.92 w/ -p1&lt;/p&gt;</comment>
                            <comment id="13449035" author="hudson" created="Wed, 5 Sep 2012 19:27:07 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #450 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/450/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/450/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0.92 UNIT TESTS&amp;#93;&lt;/span&gt; TestReplication.queueFailover occasionally fails &lt;span class=&quot;error&quot;&gt;&amp;#91;Part-1&amp;#93;&lt;/span&gt; (Revision 1381289)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13449069" author="hudson" created="Wed, 5 Sep 2012 19:58:49 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3307 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3307/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3307/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0.92 UNIT TESTS&amp;#93;&lt;/span&gt; TestReplication.queueFailover occasionally fails &lt;span class=&quot;error&quot;&gt;&amp;#91;Part-1&amp;#93;&lt;/span&gt; (Revision 1381287)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13449147" author="hudson" created="Wed, 5 Sep 2012 21:19:13 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #557 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/557/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/557/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0.92 UNIT TESTS&amp;#93;&lt;/span&gt; TestReplication.queueFailover occasionally fails &lt;span class=&quot;error&quot;&gt;&amp;#91;Part-1&amp;#93;&lt;/span&gt; (Revision 1381291)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13452581" author="jdcryans" created="Mon, 10 Sep 2012 23:43:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;This is because of multiple calls to reader.next within readAllEntriesToReplicateOrNextFile. If the second call (within the while loop) throws an exception (like EOFException), it basically destroys the work done up until then. Therefore, some rows would never be replicated.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The position in the log is updated in ZK only once the edits are replicated hence, even if you fail on the second or hundredth edit, the next region server that will be in charge of that log will pick up where the previous RS was (even if that means re-reading some edits).&lt;/p&gt;</comment>
                            <comment id="13452621" author="devaraj" created="Tue, 11 Sep 2012 00:48:33 +0000"  >&lt;p&gt;The problem happened with a recovered log file.. (another RS was trying to replicate files of a previously crashed RS).&lt;/p&gt;

&lt;p&gt;The problem here is that the method reads some rows but loses them due to an exception eventually. Look for the lines with the string &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;vesta.apache.org%2C57779%2C1345217521341.1345217601487&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; in the file &lt;a href=&quot;http://bit.ly/RDdmPg&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bit.ly/RDdmPg&lt;/a&gt;. You will see a bunch of lines like:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.io.EOFException: hdfs://localhost:60044/user/hudson/hbase/.oldlogs/vesta.apache.org%2C57779%2C1345217521341.1345217601487, entryStart=40929, pos=40960, end=40960, edit=3
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
	at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.addFileInfoToException(SequenceFileLogReader.java:252)
	at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.next(SequenceFileLogReader.java:208)
	at org.apache.hadoop.hbase.replication.regionserver.ReplicationSource.readAllEntriesToReplicateOrNextFile(ReplicationSource.java:427)
	at org.apache.hadoop.hbase.replication.regionserver.ReplicationSource.run(ReplicationSource.java:306)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Unless I have missed something, here the problem seems to have been caused by the fact that the second call to reader.next in the method readAllEntriesToReplicateOrNextFile fails (please let me know if you need more details).&lt;/p&gt;</comment>
                            <comment id="13454157" author="jdcryans" created="Wed, 12 Sep 2012 17:38:23 +0000"  >&lt;p&gt;Oh I see what you mean. Very good find! I wonder what&apos;s that gibberish at the end of the file.&lt;/p&gt;</comment>
                            <comment id="13454181" author="devaraj" created="Wed, 12 Sep 2012 18:01:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;Oh I see what you mean. Very good find! I wonder what&apos;s that gibberish at the end of the file.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks! Are you referring to the log file? I see the following at the end (no gibberish):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-08-17 15:35:01,161 DEBUG [RegionServer:1;vesta.apache.org,40480,1345217521368-EventThread.replicationSource,2] regionserver.ReplicationSource(474): Opening log for replication vesta.apache.org%2C40480%2C1345217521368.1345217648386 at 258
2012-08-17 15:35:01,164 DEBUG [RegionServer:1;vesta.apache.org,40480,1345217521368-EventThread.replicationSource,2] regionserver.ReplicationSource(429): currentNbOperations:13022 and seenEntries:0 and size: 0
2012-08-17 15:35:01,164 DEBUG [RegionServer:1;vesta.apache.org,40480,1345217521368-EventThread.replicationSource,2] regionserver.ReplicationSource(549): Nothing to replicate, sleeping 100 times 10
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13454189" author="jdcryans" created="Wed, 12 Sep 2012 18:10:27 +0000"  >&lt;p&gt;What I meant is that the reader gets this 10 times:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.io.EOFException: hdfs://localhost:60044/user/hudson/hbase/.oldlogs/vesta.apache.org%2C57779%2C1345217521341.1345217601487, entryStart=40929, pos=40960, end=40960, edit=3
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So if I&apos;m reading this correctly it&apos;s able to read the file and got 3 edits but gets an EOF. Is something half written? Then it gives up on the file:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-08-17 15:33:50,099 INFO  [ReplicationExecutor-0.replicationSource,2-vesta.apache.org,57779,1345217521341] regionserver.ReplicationSourceManager(352): Done with the recovered queue 2-vesta.apache.org,57779,1345217521341
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And there&apos;s data loss.&lt;/p&gt;</comment>
                            <comment id="13454347" author="devaraj" created="Wed, 12 Sep 2012 20:49:21 +0000"  >&lt;p&gt;This log file belongs to a crashed RS, and yes, it seems like the last record wasn&apos;t completely written to the file before the RS crashed. That should be fine, i.e., no dataloss should happen - in the queueFailover test, the client would have got exceptions to the flushCommit call and it would have retried the batch of &apos;put&apos; and the corresponding records would have ended up in another RS.&lt;/p&gt;</comment>
                            <comment id="13455031" author="hudson" created="Thu, 13 Sep 2012 17:28:09 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #52 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/52/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/52/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0.92 UNIT TESTS&amp;#93;&lt;/span&gt; TestReplication.queueFailover occasionally fails &lt;span class=&quot;error&quot;&gt;&amp;#91;Part-1&amp;#93;&lt;/span&gt; (Revision 1381289)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13455143" author="lhofhansl" created="Thu, 13 Sep 2012 18:58:29 +0000"  >&lt;p&gt;Just failed again: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2852//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2852//testReport/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13458121" author="jdcryans" created="Tue, 18 Sep 2012 20:29:06 +0000"  >&lt;p&gt;We applied this patch on a cluster that replicates and about all the nodes stopped replicated after some time. This is what I see in the logs:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-09-17 20:04:08,111 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Opening log for replication va1r3s24%2C10304%2C1347911704238.1347911706318 at 78617132
2012-09-17 20:04:08,120 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Break on IOE: hdfs://va1r5s41:10101/va1-backup/.logs/va1r3s24,10304,1347911704238/va1r3s24%2C10304%2C1347911704238.1347911706318, entryStart=78641557, pos=78771200, end=78771200, edit=84
2012-09-17 20:04:08,120 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: currentNbOperations:164529 and seenEntries:84 and size: 154068
2012-09-17 20:04:08,120 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Replicating 84
2012-09-17 20:04:08,146 INFO org.apache.hadoop.hbase.replication.regionserver.ReplicationSourceManager: Going to report log #va1r3s24%2C10304%2C1347911704238.1347911706318 for position 78771200 in hdfs://va1r5s41:10101/va1-backup/.logs/va1r3s24,10304,1347911704238/va1r3s24%2C10304%2C1347911704238.1347911706318
2012-09-17 20:04:08,158 INFO org.apache.hadoop.hbase.replication.regionserver.ReplicationSourceManager: Removing 0 logs in the list: []
2012-09-17 20:04:08,158 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Replicated in total: 93234
2012-09-17 20:04:08,158 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Opening log for replication va1r3s24%2C10304%2C1347911704238.1347911706318 at 78771200
2012-09-17 20:04:08,163 ERROR org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Unexpected exception in ReplicationSource, currentPath=hdfs://va1r5s41:10101/va1-backup/.logs/va1r3s24,10304,1347911704238/va1r3s24%2C10304%2C1347911704238.1347911706318
java.lang.IndexOutOfBoundsException
        at java.io.DataInputStream.readFully(DataInputStream.java:175)
        at org.apache.hadoop.io.DataOutputBuffer$Buffer.write(DataOutputBuffer.java:63)
        at org.apache.hadoop.io.DataOutputBuffer.write(DataOutputBuffer.java:101)
        at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:2001)
        at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1901)
        at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1947)
        at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.next(SequenceFileLogReader.java:235)
        at org.apache.hadoop.hbase.replication.regionserver.ReplicationSource.readAllEntriesToReplicateOrNextFile(ReplicationSource.java:394)
        at org.apache.hadoop.hbase.replication.regionserver.ReplicationSource.run(ReplicationSource.java:307)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The file is still in HDFS and it&apos;s about double the size we see up there, so it wasn&apos;t the end of the file. Looking at other nodes, we always get &quot;Break on IOE&quot; before getting the exception that kills replication. This is why I think that this patch is the issue. Somehow reading up to the end is reading too far.&lt;/p&gt;

&lt;p&gt;We need to fix or backport.&lt;/p&gt;</comment>
                            <comment id="13458131" author="lhofhansl" created="Tue, 18 Sep 2012 20:37:41 +0000"  >&lt;p&gt;You mean fix or rollback (the change)?&lt;/p&gt;</comment>
                            <comment id="13458134" author="devaraj" created="Tue, 18 Sep 2012 20:40:18 +0000"  >&lt;p&gt;Looking at the logs/patch more closely.. Will get back soon.&lt;/p&gt;</comment>
                            <comment id="13458135" author="jdcryans" created="Tue, 18 Sep 2012 20:41:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; Trying to figure out what the problem is first although if we&apos;re in a hurry we can just rollback. (not backport, doh!)&lt;/p&gt;</comment>
                            <comment id="13458185" author="jdcryans" created="Tue, 18 Sep 2012 21:21:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=devaraj&quot; class=&quot;user-hover&quot; rel=&quot;devaraj&quot;&gt;Devaraj Das&lt;/a&gt; I&apos;m still trying to figure out exactly how we get the IndexOutOfBoundsException (I&apos;d say the file didn&apos;t get new data and we started reading exactly at the end and the DFSClient doesn&apos;t like that? Or it&apos;s missing something at the end?), but if it&apos;s a case of reading the tail of a recovered log then we &lt;b&gt;could&lt;/b&gt; add a check like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        entry = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.reader.next(entriesArray[currentNbEntries]);
      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ie) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (queueRecovered) {
          LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Break on IOE: &quot;&lt;/span&gt; + ie.getMessage());
          &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; ie;
        }
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13458192" author="jdcryans" created="Tue, 18 Sep 2012 21:27:29 +0000"  >&lt;p&gt;But now that I think about it, it may crap out when coming back to read even on a recovered file. The data will all make it to the other cluster but that source will never be fully cleaned up.&lt;/p&gt;

&lt;p&gt;Which leads me to think that this is a bug in DFSClient. It&apos;s expecting something it&apos;s not getting.&lt;/p&gt;</comment>
                            <comment id="13458222" author="devaraj" created="Tue, 18 Sep 2012 21:53:59 +0000"  >&lt;p&gt;Yeah, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt; not sure how one could get a IndexOutOfBounds exception. I can&apos;t see how the patch would make it surface as well .. The patch only catches and ignores IOE (as opposed to &lt;b&gt;all&lt;/b&gt; exceptions).. But yeah give me another hour please. Let me dig some more.&lt;/p&gt;</comment>
                            <comment id="13458251" author="devaraj" created="Tue, 18 Sep 2012 22:29:37 +0000"  >&lt;p&gt;Has there been any change in your cluster environment (hadoop version, etc. using different version of dfs client causing the issue to surface)? &lt;span class=&quot;error&quot;&gt;&amp;#91;Not sure which hadoop version you are on, but there is no chance you are hitting HDFS-1108, right?&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="13458274" author="devaraj" created="Tue, 18 Sep 2012 23:20:35 +0000"  >&lt;p&gt;Okay a plausible explanation - &lt;br/&gt;
1. ReplicationSource.readAllEntriesToReplicateOrNextFile throws an IOException (which causes the log &quot;Break on IOE:&quot; to print), but ignores the exception.&lt;br/&gt;
2. When readAllEntriesToReplicateOrNextFile returns, the reader&apos;s file-pointer position is queried and &apos;this.position&apos; is set to that (the reader&apos;s file-pointer is possibly pointing to gibberish)&lt;br/&gt;
3. Eventually, readAllEntriesToReplicateOrNextFile gets called again, and this time this.reader.next inside throws IndexOutOfBounds exception because it read gibberish (looking at the code of DataInputStream.java, it seems like one of the cases where the IndexOutOfBounds is thrown is when the length passed to readFully is less than 0).&lt;/p&gt;

&lt;p&gt;The fix I can think of is to reset the reader&apos;s &apos;position&apos; to the last valid position (upon return from the method readAllEntriesToReplicateOrNextFile).&lt;/p&gt;

&lt;p&gt;Thoughts on the above? Does the analysis make sense?&lt;/p&gt;</comment>
                            <comment id="13458302" author="devaraj" created="Tue, 18 Sep 2012 23:54:05 +0000"  >&lt;p&gt;This patch demonstrates what I commented with earlier. Please have a look. I could make a method which has the getPosition() and next().. but I wanted to check on whether folks agree with the fix first.&lt;/p&gt;</comment>
                            <comment id="13458352" author="lhofhansl" created="Wed, 19 Sep 2012 02:02:20 +0000"  >&lt;p&gt;Should we pull &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6719&quot; title=&quot;[replication] Data will lose if open a Hlog failed more than maxRetriesMultiplier&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6719&quot;&gt;HBASE-6719&lt;/a&gt; into this?&lt;/p&gt;</comment>
                            <comment id="13458378" author="jdcryans" created="Wed, 19 Sep 2012 03:23:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;The patch only catches and ignores IOE (as opposed to all exceptions)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What it does do is permitting to read up to the end of the file.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Not sure which hadoop version you are on, but there is no chance you are hitting HDFS-1108, right?&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We are on CDH3u3, didn&apos;t change when we applied the patch.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Okay a plausible explanation -&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s plausible but unless we really understand what that &quot;gibberish&quot; is at the end of the file, we can&apos;t truly make a fix. I don&apos;t know why that IOE is throw out but normally we just silently finish reading from the file. There is some special case here.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Should we pull &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6719&quot; title=&quot;[replication] Data will lose if open a Hlog failed more than maxRetriesMultiplier&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6719&quot;&gt;HBASE-6719&lt;/a&gt; into this?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think it&apos;s separate issues.&lt;/p&gt;</comment>
                            <comment id="13458404" author="lhofhansl" created="Wed, 19 Sep 2012 04:49:45 +0000"  >&lt;p&gt;I say we revert from 0.94.2 and retry in 0.94.3.&lt;/p&gt;

&lt;p&gt;Although from DD&apos;s comment:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;If the second call (within the while loop) throws an exception (like EOFException), it basically destroys the work done up until then. Therefore, some rows would never be replicated.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This would be a dataloss issue without the fix.&lt;/p&gt;

&lt;p&gt;I find that a bit confusion. Since J-D saw the ignored exception in the test cluster eventually on all machines, it seems there was data lost in all versions before 0.94.2? That seems very unlikely.&lt;/p&gt;</comment>
                            <comment id="13458428" author="devaraj" created="Wed, 19 Sep 2012 05:44:13 +0000"  >&lt;p&gt;Attaching a more complete fix (for 0.94)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt;, could you please try this patch out in your cluster.&lt;/p&gt;

&lt;p&gt;The more I think about it, the more I am beginning to believe that setting the position so that it always points to a valid location is the fix here...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; I have seen dataloss issues (via the unit test) without this patch..&lt;/p&gt;</comment>
                            <comment id="13458839" author="jdcryans" created="Wed, 19 Sep 2012 16:48:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;This would be a dataloss issue without the fix.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I have seen dataloss issues (via the unit test) without this patch..&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;FWIW if there was indeed dataloss caused by this, it would have been when recovering logs. During normal operation that exception was retried until we&apos;re able to read the file.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;could you please try this patch out in your cluster.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s not exactly a test cluster, more like prod-ish, so I&apos;ll put it on only one machine. I assume it might take the whole day to hit the condition.&lt;/p&gt;</comment>
                            <comment id="13458850" author="devaraj" created="Wed, 19 Sep 2012 17:00:11 +0000"  >&lt;p&gt;Thanks, JD&lt;/p&gt;</comment>
                            <comment id="13459137" author="jdcryans" created="Wed, 19 Sep 2012 21:46:49 +0000"  >&lt;p&gt;The server that has the patch did a &quot;Break on IOE&quot; twice, and it seems to work:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-09-19 21:26:50,104 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Opening log for replication va1r6s44%2C10304%2C1348088378534.1348089931722 at 21992487
2012-09-19 21:26:50,110 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Break on IOE: hdfs://va1r5s41:10101/va1-backup/.logs/va1r6s44,10304,1348088378534/va1r6s44%2C10304%2C1348088378534.1348089931722, entryStart=21993911, pos=22058496, end=22058496, edit=5
2012-09-19 21:26:50,110 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: currentNbOperations:783007 and seenEntries:5 and size: 64585
2012-09-19 21:26:50,110 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Replicating 5
2012-09-19 21:26:50,119 INFO org.apache.hadoop.hbase.replication.regionserver.ReplicationSourceManager: Going to report log #va1r6s44%2C10304%2C1348088378534.1348089931722 for position 21993911 in hdfs://va1r5s41:10101/va1-backup/.logs/va1r6s44,10304,1348088378534/va1r6s44%2C10304%2C1348088378534.1348089931722
2012-09-19 21:26:50,129 INFO org.apache.hadoop.hbase.replication.regionserver.ReplicationSourceManager: Removing 0 logs in the list: []
2012-09-19 21:26:50,129 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Replicated in total: 145502
2012-09-19 21:26:50,129 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: Opening log for replication va1r6s44%2C10304%2C1348088378534.1348089931722 at 21993911
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One thing that I saw that this patch breaks is the size in &quot;currentNbOperations:783007 and seenEntries:5 and size: 64585&quot; because it relies on this.position being the position at the beginning. I often see that number at 0 while having edits to replicate. It&apos;s minor since in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6804&quot; title=&quot;[replication] lower the amount of logging to a more human-readable level&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6804&quot;&gt;&lt;del&gt;HBASE-6804&lt;/del&gt;&lt;/a&gt; I&apos;m removing that log message altogether but we may want to either remove the size or keep track of what it is at the beginning of the loop within the context of this jira.&lt;/p&gt;</comment>
                            <comment id="13459163" author="devaraj" created="Wed, 19 Sep 2012 22:20:02 +0000"  >&lt;p&gt;Good to know, JD. I&apos;ll submit a patch with the logging addressed in a bit.&lt;/p&gt;</comment>
                            <comment id="13459211" author="devaraj" created="Wed, 19 Sep 2012 23:25:22 +0000"  >&lt;p&gt;Attaching a patch with the &apos;position&apos; fix.&lt;/p&gt;</comment>
                            <comment id="13459216" author="devaraj" created="Wed, 19 Sep 2012 23:31:43 +0000"  >&lt;p&gt;Same patch, for trunk.&lt;/p&gt;</comment>
                            <comment id="13459733" author="lhofhansl" created="Thu, 20 Sep 2012 16:53:32 +0000"  >&lt;p&gt;+1 on last patch.&lt;/p&gt;</comment>
                            <comment id="13459754" author="lhofhansl" created="Thu, 20 Sep 2012 17:14:31 +0000"  >&lt;p&gt;J-D, any objections to committing this?&lt;/p&gt;</comment>
                            <comment id="13459758" author="jdcryans" created="Thu, 20 Sep 2012 17:18:58 +0000"  >&lt;p&gt;I&apos;m going to create a new jira first (should have done that when I found that problem) and post the patches there with a small nit fixed.&lt;/p&gt;</comment>
                            <comment id="13459766" author="jdcryans" created="Thu, 20 Sep 2012 17:28:48 +0000"  >&lt;p&gt;Re-closing, I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6847&quot; title=&quot;HBASE-6649 broke replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6847&quot;&gt;&lt;del&gt;HBASE-6847&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13459917" author="hudson" created="Thu, 20 Sep 2012 20:26:26 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3360 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3360/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3360/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6847&quot; title=&quot;HBASE-6649 broke replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6847&quot;&gt;&lt;del&gt;HBASE-6847&lt;/del&gt;&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; broke replication (Devaraj Das via JD) (Revision 1388161)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13459923" author="hudson" created="Thu, 20 Sep 2012 20:31:08 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #476 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/476/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/476/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6847&quot; title=&quot;HBASE-6649 broke replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6847&quot;&gt;&lt;del&gt;HBASE-6847&lt;/del&gt;&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; broke replication (Devaraj Das via JD) (Revision 1388160)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13459977" author="hudson" created="Thu, 20 Sep 2012 21:23:49 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #583 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/583/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6847&quot; title=&quot;HBASE-6649 broke replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6847&quot;&gt;&lt;del&gt;HBASE-6847&lt;/del&gt;&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; broke replication (Devaraj Das via JD) (Revision 1388159)&lt;br/&gt;
Fixing the CHANGES.txt after 0.92.2&apos;s release and adding &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; (Revision 1388157)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13460080" author="hudson" created="Fri, 21 Sep 2012 00:11:46 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #184 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/184/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/184/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6847&quot; title=&quot;HBASE-6649 broke replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6847&quot;&gt;&lt;del&gt;HBASE-6847&lt;/del&gt;&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; broke replication (Devaraj Das via JD) (Revision 1388161)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13460750" author="hudson" created="Fri, 21 Sep 2012 19:28:49 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #53 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/53/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/53/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6847&quot; title=&quot;HBASE-6649 broke replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6847&quot;&gt;&lt;del&gt;HBASE-6847&lt;/del&gt;&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; broke replication (Devaraj Das via JD) (Revision 1388160)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13469872" author="hudson" created="Fri, 5 Oct 2012 00:37:46 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #8 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/8/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/8/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6847&quot; title=&quot;HBASE-6649 broke replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6847&quot;&gt;&lt;del&gt;HBASE-6847&lt;/del&gt;&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; broke replication (Devaraj Das via JD) (Revision 1388160)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0.92 UNIT TESTS&amp;#93;&lt;/span&gt; TestReplication.queueFailover occasionally fails &lt;span class=&quot;error&quot;&gt;&amp;#91;Part-1&amp;#93;&lt;/span&gt; (Revision 1381289)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13469983" author="hudson" created="Fri, 5 Oct 2012 02:59:33 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #143 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/143/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/143/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6847&quot; title=&quot;HBASE-6649 broke replication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6847&quot;&gt;&lt;del&gt;HBASE-6847&lt;/del&gt;&lt;/a&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; broke replication (Devaraj Das via JD) (Revision 1388159)&lt;br/&gt;
Fixing the CHANGES.txt after 0.92.2&apos;s release and adding &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; (Revision 1388157)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6649&quot; title=&quot;[0.92 UNIT TESTS] TestReplication.queueFailover occasionally fails [Part-1]&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6649&quot;&gt;&lt;del&gt;HBASE-6649&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0.92 UNIT TESTS&amp;#93;&lt;/span&gt; TestReplication.queueFailover occasionally fails &lt;span class=&quot;error&quot;&gt;&amp;#91;Part-1&amp;#93;&lt;/span&gt; (Revision 1381291)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13624674" author="stack" created="Sun, 7 Apr 2013 04:52:21 +0000"  >&lt;p&gt;Fix up after bulk move overwrote some 0.94.2 fix versions w/ 0.95.0 (Noticed by Lars Hofhansl)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12606217">HBASE-6719</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12498015">HBASE-3515</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12543886" name="6649-0.92.patch" size="1118" author="devaraj" created="Wed, 5 Sep 2012 18:42:10 +0000"/>
                            <attachment id="12543752" name="6649-1.patch" size="818" author="devaraj" created="Tue, 4 Sep 2012 22:15:54 +0000"/>
                            <attachment id="12542850" name="6649-2.txt" size="753" author="yuzhihong@gmail.com" created="Tue, 28 Aug 2012 22:57:10 +0000"/>
                            <attachment id="12545826" name="6649-fix-io-exception-handling-1-trunk.patch" size="2742" author="devaraj" created="Wed, 19 Sep 2012 23:31:43 +0000"/>
                            <attachment id="12545823" name="6649-fix-io-exception-handling-1.patch" size="2737" author="devaraj" created="Wed, 19 Sep 2012 23:25:22 +0000"/>
                            <attachment id="12545677" name="6649-fix-io-exception-handling.patch" size="2043" author="devaraj" created="Wed, 19 Sep 2012 05:44:13 +0000"/>
                            <attachment id="12543885" name="6649-trunk.patch" size="1145" author="devaraj" created="Wed, 5 Sep 2012 18:42:10 +0000"/>
                            <attachment id="12543874" name="6649-trunk.patch" size="844" author="devaraj" created="Wed, 5 Sep 2012 17:37:11 +0000"/>
                            <attachment id="12543889" name="6649.txt" size="900" author="stack" created="Wed, 5 Sep 2012 18:50:31 +0000"/>
                            <attachment id="12542859" name="HBase-0.92 #495 test - queueFailover [Jenkins].html" size="2601702" author="devaraj" created="Tue, 28 Aug 2012 23:19:12 +0000"/>
                            <attachment id="12542860" name="HBase-0.92 #502 test - queueFailover [Jenkins].html" size="2487636" author="devaraj" created="Tue, 28 Aug 2012 23:19:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 26 Aug 2012 04:20:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241976</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02hlr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12453</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>