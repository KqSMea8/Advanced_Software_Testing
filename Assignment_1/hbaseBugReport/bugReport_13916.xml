<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:47:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13916/HBASE-13916.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13916] Create MultiByteBuffer an aggregation of ByteBuffers</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13916</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This is an aggregation of N ByteBuffers. The block when served directly by block cache buckets memory, we have the block data split across multiple byte buffers. This aggregate type (like ByteBuffer) will serve the HFileBlock data.&lt;br/&gt;
This jira wil just provide the new data structure&lt;/p&gt;</description>
                <environment></environment>
        <key id="12838078">HBASE-13916</key>
            <summary>Create MultiByteBuffer an aggregation of ByteBuffers</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12724166">HBASE-11425</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anoop.hbase">Anoop Sam John</assignee>
                                    <reporter username="anoop.hbase">Anoop Sam John</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Jun 2015 07:49:43 +0000</created>
                <updated>Thu, 18 Jun 2015 20:40:55 +0000</updated>
                            <resolved>Thu, 18 Jun 2015 17:10:24 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                                    <component>regionserver</component>
                    <component>Scanners</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14588003" author="hadoopqa" created="Tue, 16 Jun 2015 13:03:04 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12739806/HBASE-13916.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12739806/HBASE-13916.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a10a82a8ff2babefbfafe7c323d88eb85f2be52c.&lt;br/&gt;
  ATTACHMENT ID: 12739806&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 5 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The applied patch generated 15 javac compiler warnings (more than the master&apos;s current 9 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 4 warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1910 checkstyle errors (more than the master&apos;s current 1906 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): 	at org.apache.blur.manager.writer.BlurIndexSimpleWriterTest.testBlurIndexWriter(BlurIndexSimpleWriterTest.java:217)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14431//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14588290" author="yuzhihong@gmail.com" created="Tue, 16 Jun 2015 16:11:16 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the MBB is made up of single item and that single item is an
+   * on heap &lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt; Buffer
+   */
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; hasArray() {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Have you considered the scenario where all the items in the MBB are on heap ByteBuffers ?&lt;/p&gt;</comment>
                            <comment id="14588327" author="anoop.hbase" created="Tue, 16 Jun 2015 16:28:21 +0000"  >&lt;p&gt;When hasArray is true, the array() API has to return a single byte[] where whole data bytes available. So when the MBB contain more than one on heap buffer we have no single array backing whole data.&lt;/p&gt;</comment>
                            <comment id="14588346" author="anoop.hbase" created="Tue, 16 Jun 2015 16:41:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;-1 javac. The applied patch generated 15 javac compiler warnings (more than the master&apos;s current 9 warnings).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-1 javadoc. The javadoc tool appears to have generated 4 warning messages.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;These are because of the usage of Unsafe in ByteBufferUtils.  We will have to add these counts to the approved counts.&lt;/p&gt;</comment>
                            <comment id="14588407" author="stack" created="Tue, 16 Jun 2015 17:25:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;We will have to add these counts to the approved counts.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ok.&lt;/p&gt;

&lt;p&gt;Should we add an hbase.nio package and put these new classes there (and all to do w/ BB?)&lt;/p&gt;

&lt;p&gt;I think the class comment should describe when to use this rather than ByteBufferArray from util.&lt;/p&gt;

&lt;p&gt;Is the fact that the nature of MBB changes based on whether there is one BB or many BBs going to confuse?  Why not just throw unsupported whatever the BB count in methods like array, arrayOffset, etc.&lt;/p&gt;

&lt;p&gt;If the above behavior is &apos;fundamental&apos; to how this class works, it needs calling out in the class comment.&lt;/p&gt;

&lt;p&gt;Why a getVLong in here?  That belongs outside this class?&lt;/p&gt;

&lt;p&gt;Is the unsafe work going on in BBUtils dupe of Bytes unsafeing? Should the BBUtils go to Bytes for Unsafe ops?&lt;/p&gt;

&lt;p&gt;Otherwise, looks good.  Can come in as a utility as long as it is well described.&lt;/p&gt;

&lt;p&gt;Nice test.&lt;/p&gt;


</comment>
                            <comment id="14588446" author="anoop.hbase" created="Tue, 16 Jun 2015 17:45:21 +0000"  >&lt;p&gt;bq,Is the fact that the nature of MBB changes based on whether there is one BB or many BBs going to confuse? Why not just throw unsupported whatever the BB count in methods like array, arrayOffset, etc.&lt;br/&gt;
HFileBlock is going to be backed by MBB.  I wanted like when the block comes NOT from L2 cache, we will go like in existing way and make KeyValue. when we make Cell objects in read path, based on this hasArray() we will have to make either byte[] backed KVs or BB backed new objects. Just because of this I thought of keeping this hasArray() true when MBB is backed by a single on heap BB.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I think the class comment should describe when to use this rather than ByteBufferArray from util.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I will clean it. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Why a getVLong in here? That belongs outside this class?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Just did not want a new util class for it. Let me see. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Is the unsafe work going on in BBUtils dupe of Bytes unsafeing? Should the BBUtils go to Bytes for Unsafe ops?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Not really. When it is BB we will have to deal with isDirect case also. There is an UnsafeAccess class now.. May be all these byte[] and BB related unsafe access has to go in there and Bytes and BBUtils etc has to use that. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14588612" author="hadoopqa" created="Tue, 16 Jun 2015 19:31:06 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12739898/HBASE-13916_V2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12739898/HBASE-13916_V2.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a10a82a8ff2babefbfafe7c323d88eb85f2be52c.&lt;br/&gt;
  ATTACHMENT ID: 12739898&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The applied patch generated 15 javac compiler warnings (more than the master&apos;s current 9 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 4 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestDistributedLogSplitting&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14436//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14588951" author="stack" created="Tue, 16 Jun 2015 22:53:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;Just because of this I thought of keeping this hasArray() true when MBB is backed by a single on heap BB.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I thought about it more and I think it is fine as is.  Would prefer a beefed up class comment  on how it is to be used (and when this rather than BBArray).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;May be all these byte[] and BB related unsafe access has to go in there and Bytes and BBUtils etc has to use that.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sounds good. Another patch.&lt;/p&gt;

&lt;p&gt;What did you think of an nio package? Seems like we have enough ByteBuffering classes to give it substance now.&lt;/p&gt;</comment>
                            <comment id="14589279" author="anoop.hbase" created="Wed, 17 Jun 2015 04:31:10 +0000"  >&lt;blockquote&gt;&lt;p&gt;What did you think of an nio package? Seems like we have enough ByteBuffering classes to give it substance now.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Fine. I will add the package and move the MBB class to there.  Moving in other classes can be done as part of another cleanup jira. (Else the patch will be unnecessarily look bigger)&lt;/p&gt;</comment>
                            <comment id="14589282" author="stack" created="Wed, 17 Jun 2015 04:35:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;Fine.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Was just asking what you thought. Leave as is if you think that best.&lt;/p&gt;

&lt;p&gt;+1 on commit.&lt;/p&gt;</comment>
                            <comment id="14589644" author="anoop.hbase" created="Wed, 17 Jun 2015 11:19:16 +0000"  >&lt;blockquote&gt;
&lt;p&gt;-OK_JAVADOC_WARNINGS=4&lt;br/&gt;
+OK_JAVADOC_WARNINGS=5&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I have increased the ok count for javadoc by 1. Not sure whether this is enough or not for the new Unsafe code added in ByteBufferUtils. Other javadoc comments I have already fixed. If any more to add, I will change on commit.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Was just asking what you thought. Leave as is if you think that best.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I am agreeing with you Stack. Moved to suggested new package.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Why a getVLong in here? That belongs outside this class?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Moved to ByteBufferUtils now.&lt;br/&gt;
Thanks Stack. Will commit as per QA run result&lt;/p&gt;</comment>
                            <comment id="14589928" author="stack" created="Wed, 17 Jun 2015 15:31:46 +0000"  >&lt;p&gt;Patch looks good.&lt;/p&gt;

&lt;p&gt;Why BBUtils have ref to MBB?&lt;/p&gt;

&lt;p&gt;import org.apache.hadoop.hbase.nio.MultiByteBuffer;&lt;/p&gt;


&lt;p&gt;getVLong takes a MBB but it looks like it could take a BB?&lt;/p&gt;

&lt;p&gt;Can fix on commit.&lt;/p&gt;

&lt;p&gt;Also, remove this sentence on commit (This MBB looks generic, useable perhaps by more than HFileBlock): &quot;This has to be used when an&lt;br/&gt;
36	 * HFileBlock&apos;s data is split across multiple byte buffers and we don&apos;t want copy them to single&lt;br/&gt;
37	 * for serving cells out of it. &quot;&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14590075" author="anoop.hbase" created="Wed, 17 Jun 2015 16:45:32 +0000"  >&lt;p&gt;getVlong() has to take MBB only. It makes get() call on MBB. That is why BBUtils has ref to MBB. Treating MBB as a special BB, moved the getVlong there. Else we have to keep it i MBB class only. What do you suggest?&lt;/p&gt;</comment>
                            <comment id="14590132" author="hadoopqa" created="Wed, 17 Jun 2015 17:24:33 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12740091/HBASE-13916_V3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12740091/HBASE-13916_V3.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 1b5ad45b8584afce8f8dc0be558844b7401c0caf.&lt;br/&gt;
  ATTACHMENT ID: 12740091&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The applied patch generated 15 javac compiler warnings (more than the master&apos;s current 9 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 2 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 3 zombie test(s): 	at org.apache.hadoop.hbase.snapshot.TestExportSnapshot.testExportFileSystemState(TestExportSnapshot.java:287)&lt;br/&gt;
	at org.apache.hadoop.hbase.snapshot.TestExportSnapshot.testExportFileSystemState(TestExportSnapshot.java:261)&lt;br/&gt;
	at org.apache.hadoop.hbase.snapshot.TestExportSnapshot.testEmptyExportFileSystemState(TestExportSnapshot.java:205)&lt;br/&gt;
	at org.apache.hadoop.hbase.master.balancer.TestStochasticLoadBalancer.testWithCluster(TestStochasticLoadBalancer.java:656)&lt;br/&gt;
	at org.apache.hadoop.hbase.master.balancer.TestStochasticLoadBalancer.testRegionReplicationOnMidClusterWithRacks(TestStochasticLoadBalancer.java:620)&lt;br/&gt;
	at org.apache.hadoop.hbase.snapshot.TestExportSnapshot.testExportFailure(TestExportSnapshot.java:316)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14444//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14590148" author="stack" created="Wed, 17 Jun 2015 17:38:53 +0000"  >&lt;p&gt;What is difference between a MBB#get and a BB#get? They don&apos;t do same thing?&lt;/p&gt;</comment>
                            <comment id="14591106" author="anoop.hbase" created="Thu, 18 Jun 2015 01:55:44 +0000"  >&lt;p&gt;MBB#get() will result in a BB#get() but on which item BB is what matters. The user of the API is ignorant about this. getVlong() might have to read more than 1 byte and it can so happen that these bytes come from different item BBs. This API getVlong(MBB) hides all such complexities.  This API will be used in read path to read the mvcc/seqIds. HFileBlock data will be MBB backed.&lt;/p&gt;</comment>
                            <comment id="14591241" author="anoop.hbase" created="Thu, 18 Jun 2015 04:42:57 +0000"  >&lt;blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;May be all these byte[] and BB related unsafe access has to go in there and Bytes and BBUtils etc has to use that.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sounds good. Another patch.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13931&quot; title=&quot;Move Unsafe based operations to UnsafeAccess&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13931&quot;&gt;&lt;del&gt;HBASE-13931&lt;/del&gt;&lt;/a&gt; will do this.&lt;/p&gt;</comment>
                            <comment id="14591276" author="stack" created="Thu, 18 Jun 2015 05:26:45 +0000"  >&lt;p&gt;But when we call getVlong, are we not positioned at a place form where we can read a vlong?&lt;/p&gt;

&lt;p&gt;Or, maybe I am just not getting it. MBB is NOT a BB (because you can&apos;t subclass BB). If so, pardon me.  Move getVlong back to MBB and commit.&lt;/p&gt;</comment>
                            <comment id="14591281" author="anoop.hbase" created="Thu, 18 Jun 2015 05:33:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;MBB is NOT a BB (because you can&apos;t subclass BB). If so, pardon me. Move getVlong back to MBB and commit.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes BB can not be subclass is an issue for us.. Else it was not required to change the HFileBlock&apos;s backing data type.  Ok I will move it back to MBB only then. That seems better.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;But when we call getVlong, are we not positioned at a place form where we can read a vlong?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;You mean our current position on an item BB from where we can read? Yes we are. But outside users dont have access to individual item BBs. A vlong might be tsored with say 5 bytes. We are positioned at 2nd last byte of the current item BB. So this vlongs 2 bytes comes from current BB and next 3 from next BB.&lt;/p&gt;</comment>
                            <comment id="14591284" author="stack" created="Thu, 18 Jun 2015 05:35:19 +0000"  >&lt;p&gt;Pardon my being dense on this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt; Patch is good.&lt;/p&gt;</comment>
                            <comment id="14591507" author="ram_krish" created="Thu, 18 Jun 2015 08:55:10 +0000"  >&lt;p&gt;+1 on patch. &lt;/p&gt;</comment>
                            <comment id="14591519" author="anoop.hbase" created="Thu, 18 Jun 2015 09:09:55 +0000"  >&lt;p&gt;Attaching V4 for QA run.&lt;/p&gt;</comment>
                            <comment id="14591935" author="hadoopqa" created="Thu, 18 Jun 2015 15:03:47 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12740349/HBASE-13916_V4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12740349/HBASE-13916_V4.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 51b606cd185437802f0a7a4620f1434e8e2d9c74.&lt;br/&gt;
  ATTACHMENT ID: 12740349&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The applied patch generated 15 javac compiler warnings (more than the master&apos;s current 9 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 2 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestRegionRebalancing&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14456//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14592113" author="anoop.hbase" created="Thu, 18 Jun 2015 17:05:04 +0000"  >&lt;blockquote&gt;
&lt;p&gt;-1 core tests. The patch failed these unit tests:&lt;br/&gt;
org.apache.hadoop.hbase.TestRegionRebalancing&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No way related to this patch.&lt;br/&gt;
New javac warns are because of new usages of sun Unsafe package&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;-1 javadoc. The javadoc tool appears to have generated 2 warning messages.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;OK javadoc count is already made up by 2.&lt;/p&gt;</comment>
                            <comment id="14592120" author="anoop.hbase" created="Thu, 18 Jun 2015 17:10:24 +0000"  >&lt;p&gt;Thanks for the reviews Stack and Ram.&lt;/p&gt;</comment>
                            <comment id="14592473" author="hudson" created="Thu, 18 Jun 2015 20:40:55 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6583 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6583/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13916&quot; title=&quot;Create MultiByteBuffer an aggregation of ByteBuffers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13916&quot;&gt;&lt;del&gt;HBASE-13916&lt;/del&gt;&lt;/a&gt; Create MultiByteBuffer an aggregation of ByteBuffers. (anoopsamjohn: rev 8ae4b374e3fa4cd54b8b83bc857d41f0678ad9b6)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/util/ByteBufferUtils.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/test/java/org/apache/hadoop/hbase/nio/TestMultiByteBuffer.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/nio/MultiByteBuffer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestByteBufferUtils.java&lt;/li&gt;
	&lt;li&gt;dev-support/test-patch.properties&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12746935">HBASE-12213</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12739806" name="HBASE-13916.patch" size="52133" author="anoop.hbase" created="Tue, 16 Jun 2015 07:50:42 +0000"/>
                            <attachment id="12739898" name="HBASE-13916_V2.patch" size="52878" author="anoop.hbase" created="Tue, 16 Jun 2015 17:08:25 +0000"/>
                            <attachment id="12740091" name="HBASE-13916_V3.patch" size="54001" author="anoop.hbase" created="Wed, 17 Jun 2015 11:16:17 +0000"/>
                            <attachment id="12740349" name="HBASE-13916_V4.patch" size="53365" author="anoop.hbase" created="Thu, 18 Jun 2015 09:09:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Jun 2015 13:03:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 26 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2g37b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>