<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:46:31 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-679/HBASE-679.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-679] Regionserver addresses are still not right in the new tables page</title>
                <link>https://issues.apache.org/jira/browse/HBASE-679</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;They are mostly right.&lt;/p&gt;

&lt;p&gt;I&apos;m guessing its stale cache of regions in the client hosted by the UI.  If the webserver ran a scan, it&apos;d probably fix it all up but thats a bit messy.  I tried using the address that is in the .META. table directly but that doesn&apos;t work.... we don&apos;t seem to deploy table properly and UI complains &quot;No server address for row TestTable,,1213074650399&quot;.  I&apos;ll attach my patch.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12398013">HBASE-679</key>
            <summary>Regionserver addresses are still not right in the new tables page</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jimk">Jim Kellerman</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Jun 2008 00:42:58 +0000</created>
                <updated>Fri, 22 Aug 2008 21:13:17 +0000</updated>
                            <resolved>Sat, 19 Jul 2008 19:19:55 +0000</resolved>
                                                    <fixVersion>0.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12604097" author="stack" created="Wed, 11 Jun 2008 00:43:59 +0000"  >&lt;p&gt;Path for metascanner to use .META. server address rather than ask the client cache for what it thinks the address is&lt;/p&gt;</comment>
                            <comment id="12614187" author="jimk" created="Thu, 17 Jul 2008 01:25:19 +0000"  >&lt;p&gt;Please verify that this is still an issue.&lt;/p&gt;</comment>
                            <comment id="12614484" author="irubin" created="Thu, 17 Jul 2008 18:49:14 +0000"  >&lt;p&gt;These are my observations on the issue:&lt;/p&gt;

&lt;p&gt;I can&apos;t replicate what the issue is describing.  When I start up HBase and add a large table, everything on table.jsp appears correct.  It&apos;s hard to say if there really isn&apos;t any problem with the regionserver addresses though, since when I run HBase I&apos;m only using one regionserver.  &lt;/p&gt;

&lt;p&gt;There are other problems though.  If I restart HBase, table.jsp won&apos;t load at all (error code 500).  The rest of the UI and the regionserver info it shows is fine.&lt;/p&gt;

&lt;p&gt;Even worse, if I apply ms.patch, the UI stops working completely.  If I go to the master page (master.jsp), I get an error code 500.  &lt;/p&gt;

&lt;p&gt;I don&apos;t think we want to use ms.patch, but just in case I&apos;ve updated it (ms_revised.patch) to align with the current hbase-trunk (since the patch was made about 6 weeks ago).  &lt;/p&gt;

&lt;p&gt;So my conclusions would be: something is clearly wrong with table.jsp, although not the same problem that prompted this issue.  If people would like, I&apos;ll go in and try to fix this new problem.&lt;/p&gt;</comment>
                            <comment id="12614551" author="irubin" created="Thu, 17 Jul 2008 22:30:09 +0000"  >&lt;p&gt;I&apos;ve been going through this issue for a little while now, and I think I have an idea of what ultimately needs to be done.&lt;/p&gt;

&lt;p&gt;First, I was wrong in my last comment when I said that the problem had changed from the original issue description.  I&apos;ve observed the problem in the HBase instance that Jim is running from the aa0-00... machines.  And, after a bit more fiddling with the UI and some data on my own computer, I think I&apos;m seeing trace bits of the same problem as well.&lt;/p&gt;

&lt;p&gt;In my opinion, this issue boils down to the exact same problem we saw in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-727&quot; title=&quot;Client caught in an infinite loop when trying to connect to cached server locations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-727&quot;&gt;&lt;del&gt;HBASE-727&lt;/del&gt;&lt;/a&gt;.  The problem is this: we are caching information about regionserver location that most of the time will be wrong.  In &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-727&quot; title=&quot;Client caught in an infinite loop when trying to connect to cached server locations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-727&quot;&gt;&lt;del&gt;HBASE-727&lt;/del&gt;&lt;/a&gt; we were able to work around this by being a bit hacky - if the regionserver location was wrong and the page was unable to load after several tries, we threw an IOException into the system that caused some gears to churn, and usually this would stir things up enough to get the right location out.  But, being the one who made patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-727&quot; title=&quot;Client caught in an infinite loop when trying to connect to cached server locations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-727&quot;&gt;&lt;del&gt;HBASE-727&lt;/del&gt;&lt;/a&gt;, I have to admit that this is a bit hacky.&lt;/p&gt;

&lt;p&gt;Now, in this issue, the cached info coming back from HRegionInfo.getValue().getBindAddress() is also incorrect.  As with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-727&quot; title=&quot;Client caught in an infinite loop when trying to connect to cached server locations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-727&quot;&gt;&lt;del&gt;HBASE-727&lt;/del&gt;&lt;/a&gt;, the data isn&apos;t consistently incorrect either - sometimes the address that comes back is correct, and sometimes it isn&apos;t.  Sometimes after a few page refreshes it gets it right, and sometimes it continues to be wrong indefinitely.  &lt;/p&gt;

&lt;p&gt;There are a number of things that can be done, both for this particular issue and for the larger problem in general.  &lt;/p&gt;

&lt;p&gt;For &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-679&quot; title=&quot;Regionserver addresses are still not right in the new tables page&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-679&quot;&gt;&lt;del&gt;HBASE-679&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I can modify table.jsp to fail a bit more gracefully when the wrong address comes back.  We could even put up a picture of the twitter fail whale: &lt;a href=&quot;http://www.pestaola.gr/img1/twitter-whale.png&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.pestaola.gr/img1/twitter-whale.png&lt;/a&gt; (just kidding!)&lt;/li&gt;
	&lt;li&gt;We can leave everything as is and just let the user get an anonymous error code 500 in certain cases.  Maybe it&apos;s better to tell them nothing if it isn&apos;t working?&lt;/li&gt;
	&lt;li&gt;I can try to make some kind of a hacky fix.  I&apos;m not sure this will work though, since throwing an exception from inside a .jsp page won&apos;t really do anything.  The fix would have to be in the java code, but then there would be an issue of how to determine if the address is right or not.&lt;/li&gt;
	&lt;li&gt;We can punt on the issue until the overall problem is fixed (see below).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;For the greater problem of incorrect caching:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;I would ask why we are caching this information in the first place.  Information like regionserver host:port is likely to change if the user is shutting down HBase and restarting.  There needs to be some way for every node to be informed of fresh location data when HBase is started.  Admittedly, I am still incredibly naive when it comes to the inner-workings and practicalities of HBase, and I would imagine that this is probably a lot easier said than done.  I&apos;d imagine that this is something that would get pushed to 0.3.  Still, I maintain that this is something worth doing.  This problem continues to manifest itself in interesting ways all over the UI, and if we really want the UI to be a reliable reflection of the data in HBase, we need to make this fix.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12614938" author="jimk" created="Sat, 19 Jul 2008 02:13:45 +0000"  >&lt;p&gt;I am very close to having a patch for this issue. Expect it this weekend.&lt;/p&gt;</comment>
                            <comment id="12615041" author="jimk" created="Sat, 19 Jul 2008 19:19:55 +0000"  >&lt;p&gt;Passed all regression tests and PerformanceEvaluation randomWrite with 4 region servers. table.jsp now displays the correct region server for each region. Committed.&lt;/p&gt;</comment>
                            <comment id="12615053" author="stack" created="Sat, 19 Jul 2008 21:42:55 +0000"  >&lt;p&gt;Nice patch Jim.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12383798" name="ms.patch" size="2121" author="stack" created="Wed, 11 Jun 2008 00:43:59 +0000"/>
                            <attachment id="12386333" name="ms_revised.patch" size="1872" author="irubin" created="Thu, 17 Jul 2008 18:49:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 17 Jul 2008 01:25:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25330</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 22 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h8s7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98685</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>