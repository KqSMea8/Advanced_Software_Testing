<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:26:31 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11778/HBASE-11778.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11778] Scale timestamps by 1000</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11778</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The KV timestamps are used for various reasons:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;ordering of KVs&lt;/li&gt;
	&lt;li&gt;resolving conflicts&lt;/li&gt;
	&lt;li&gt;enforce TTL&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Currently we assume that the timestamps have a resolution of 1ms, and because of that we made the resolution at which we can determine time identical to the resolution at which we can store time.&lt;br/&gt;
I think it is time to disentangle the two... At least allow a higher resolution of time to be stored. That way we could have a centralized transaction oracle that produces ids that relate to wall clock time, and at the same time allow producing more than 1000/s.&lt;/p&gt;

&lt;p&gt;The simplest way is to just store time in us (microseconds). I.e. we&apos;d still collect time in ms by default and just multiply that with 1000 before we store it. With 8 bytes that still gives us a range of 292471 years.&lt;/p&gt;

&lt;p&gt;We&apos;d have grandfather in old data. Could write a metadata entry into each HFile declaring what the TS resolution is if it is different from ms.&lt;/p&gt;

&lt;p&gt;Not sure, yet, how this would relate to using the TS for things like seqIds.&lt;/p&gt;

&lt;p&gt;Let&apos;s do some brainstorming. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12735149">HBASE-11778</key>
            <summary>Scale timestamps by 1000</summary>
                <type id="13" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/genericissue.png">Brainstorming</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="lhofhansl">Lars Hofhansl</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Aug 2014 20:12:53 +0000</created>
                <updated>Wed, 20 Aug 2014 17:40:34 +0000</updated>
                            <resolved>Wed, 20 Aug 2014 17:40:34 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                <comments>
                            <comment id="14102756" author="lhofhansl" created="Tue, 19 Aug 2014 20:13:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=giacomotaylor%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;giacomotaylor@gmail.com&quot;&gt;James Taylor&lt;/a&gt;, FYI.&lt;/p&gt;</comment>
                            <comment id="14102771" author="stack" created="Tue, 19 Aug 2014 20:21:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; see &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8927&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-8927&lt;/a&gt;  Could we do it for 1.0?&lt;/p&gt;</comment>
                            <comment id="14103284" author="lhofhansl" created="Wed, 20 Aug 2014 02:38:28 +0000"  >&lt;p&gt;Ah yes, forgot about that one. Should we multiply by 1000 rather than left shift 16 bits?&lt;/p&gt;</comment>
                            <comment id="14103300" author="tobe" created="Wed, 20 Aug 2014 03:01:49 +0000"  >&lt;p&gt;Shifting bits seems more efficient. &lt;/p&gt;

&lt;p&gt;If we have nano time, it&apos;s no need to scale timestamps. But is there something problematic to use nano time in Java?&lt;/p&gt;</comment>
                            <comment id="14103536" author="lhofhansl" created="Wed, 20 Aug 2014 07:09:14 +0000"  >&lt;p&gt;I doubt multiplying by 1000 vs. shifting 16 bits will have any impact on the overall path. Would need to explain our resolution: 1/65536000s. Sounds bad. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;But shifting is fine, of course.&lt;/p&gt;

&lt;p&gt;What I am concerned about is:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;making easy sense out of the new numbers (that can be fixed by the right APIs of course)&lt;/li&gt;
	&lt;li&gt;allowing enough of a time range. ns would give is 292 years, us 292000 years. If we shift by 16 bits we&apos;d have 4462 years. If we shifted by 20 bits we could get ns and 278 years.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Anyway... Shall we continue on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8927&quot; title=&quot;Use nano time instead of mili time everywhere&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8927&quot;&gt;HBASE-8927&lt;/a&gt;?&lt;/p&gt;
</comment>
                            <comment id="14103594" author="nkeywal" created="Wed, 20 Aug 2014 08:11:48 +0000"  >&lt;p&gt;I&apos;m the only one who thinks that a few extra bits would help (typically to hold a timestamps and a counter more or less sophisticated)?&lt;/p&gt;</comment>
                            <comment id="14104159" author="apurtell" created="Wed, 20 Aug 2014 17:26:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;Anyway... Shall we continue on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8927&quot; title=&quot;Use nano time instead of mili time everywhere&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8927&quot;&gt;HBASE-8927&lt;/a&gt;?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1, could we close this as dup? &lt;/p&gt;</comment>
                            <comment id="14104178" author="ndimiduk" created="Wed, 20 Aug 2014 17:35:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m the only one who thinks that a few extra bits would help (typically to hold a timestamps and a counter more or less sophisticated)?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; meaning &amp;#8211; long ms timestamp as we have today + short/int offset counter? Or do you mean shift the current ms value n bits and use the lower-order bits as a counter?&lt;/p&gt;</comment>
                            <comment id="14104185" author="stack" created="Wed, 20 Aug 2014 17:40:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tobe&quot; class=&quot;user-hover&quot; rel=&quot;tobe&quot;&gt;chendihao&lt;/a&gt; See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8927&quot; title=&quot;Use nano time instead of mili time everywhere&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8927&quot;&gt;HBASE-8927&lt;/a&gt; for discussion of nano being problematic&lt;/p&gt;

&lt;p&gt;I think all of the discussion above has been had already over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8927&quot; title=&quot;Use nano time instead of mili time everywhere&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8927&quot;&gt;HBASE-8927&lt;/a&gt; already (including left-shifting and then doing counter in LSBs).  Let me close this as dup. Lets drive this home for 1.0.&lt;/p&gt;</comment>
                            <comment id="14104186" author="stack" created="Wed, 20 Aug 2014 17:40:34 +0000"  >&lt;p&gt;Dup of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8927&quot; title=&quot;Use nano time instead of mili time everywhere&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8927&quot;&gt;HBASE-8927&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 19 Aug 2014 20:21:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 17 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1z2lz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Phoenix</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>