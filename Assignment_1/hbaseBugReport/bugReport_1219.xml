<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:51:43 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1219/HBASE-1219.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1219] Scanners can miss values riding the flush transition</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1219</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;A scanner is made of a memcache scanner and a store files scanner.  When a flush happens, the memcache content gets turned into a store file and is added to the list of already existing scanners.  Currently the two scanners run autonomously.  Ben Maurer points out that if we were returning values out of the memcache because they were of lower value than store file content, the lower pegging that was going on in memcache doesn&apos;t make it across when we pick up the memcache values in the flushed store file; we just keep on with whatever the lowest among the store files that were in place before the flush.&lt;/p&gt;

&lt;p&gt;Its a hard one to spot but should be easy to make a test for it.&lt;/p&gt;

&lt;p&gt;Ben Maurer also points out that in StoreFileScanner, we should not register the observer until after the scanners have been setup:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; StoreFileScanner(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Store store, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; timestamp,
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [][] targetCols, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [] firstRow)
  &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(timestamp, targetCols);
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.store = store;
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.store.addChangedReaderObserver(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      openScanner(firstRow);
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12415532">HBASE-1219</key>
            <summary>Scanners can miss values riding the flush transition</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Feb 2009 06:25:39 +0000</created>
                <updated>Sun, 13 Sep 2009 22:32:19 +0000</updated>
                            <resolved>Tue, 10 Mar 2009 22:37:21 +0000</resolved>
                                                    <fixVersion>0.19.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12680608" author="stack" created="Tue, 10 Mar 2009 20:39:16 +0000"  >&lt;p&gt;Fix for hbase-1219 and hbase-1220.&lt;/p&gt;

&lt;p&gt;For 1220, we pass in the sequenceid so we know which of the readers is the new one so we only open it, not all as we used to.&lt;/p&gt;

&lt;p&gt;For 1219, we save the key we give out when nexing HStoreScanner.  This is the key we use recalibrating running readers in a scanner (rather than ask memcache &amp;#8211; which, as it turns out, can be empty during certain transitions).&lt;/p&gt;
</comment>
                            <comment id="12680632" author="stack" created="Tue, 10 Mar 2009 21:47:07 +0000"  >&lt;p&gt;All tests pass.  Would like a review before committing.&lt;/p&gt;</comment>
                            <comment id="12680659" author="jimk" created="Tue, 10 Mar 2009 22:29:12 +0000"  >&lt;p&gt;In TestScanner, the code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
      LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed test because of ...&quot;&lt;/span&gt;, e);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;doesn&apos;t seem to let the exception and does not call fail(). Should it?&lt;/p&gt;


&lt;p&gt;Spelling:&lt;/p&gt;

&lt;p&gt;HStoreScanner:235:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
              LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;RMOEVE CLOSING NEXT &quot;&lt;/span&gt; + i);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;HStoreScanner:250:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;RMOEVE CLOSING ADVANCING &quot;&lt;/span&gt; + i);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;HStoreScanner:280:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
          LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;RMOEVE CLOSING &quot;&lt;/span&gt; + i);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Otherwise, +1 (a little hard to grasp all of what&apos;s going on, but scanners take time to get your head around anyway. I wouldn&apos;t&lt;br/&gt;
hold that against this patch)&lt;/p&gt;</comment>
                            <comment id="12680663" author="stack" created="Tue, 10 Mar 2009 22:37:21 +0000"  >&lt;p&gt;Applied to branch (Doesn&apos;t make sense on trunk).  Applied fix for 1219 and 1220 at same time.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12401858" name="1219.patch" size="12571" author="stack" created="Tue, 10 Mar 2009 20:39:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 10 Mar 2009 22:29:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25631</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 41 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hc0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99210</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>