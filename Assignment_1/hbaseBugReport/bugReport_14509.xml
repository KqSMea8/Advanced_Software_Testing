<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:53:48 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14509/HBASE-14509.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14509] Configurable sparse indexes?</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14509</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This idea just popped up today and I wanted to record it for discussion:&lt;br/&gt;
What if we kept sparse column indexes per region or HFile or per configurable range?&lt;/p&gt;

&lt;p&gt;I.e. For any given CQ we record the lowest and highest value for a particular range (HFile, Region, or a custom range like the Phoenix guide post).&lt;/p&gt;

&lt;p&gt;By tweaking the size of these ranges we can control the size of the index, vs its selectivity.&lt;/p&gt;

&lt;p&gt;For example if we kept it by HFile we can almost instantly decide whether we need scan a particular HFile at all to find a particular value in a Cell.&lt;/p&gt;

&lt;p&gt;We can also collect min/max values for each n MB of data, for example when we can the region the first time. Assuming ranges are large enough we can always keep the index in memory together with the region.&lt;/p&gt;

&lt;p&gt;Kind of a sparse local index. Might much easier than the buddy region stuff we&apos;ve been discussing.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12901239">HBASE-14509</key>
            <summary>Configurable sparse indexes?</summary>
                <type id="13" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/genericissue.png">Brainstorming</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="lhofhansl">Lars Hofhansl</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Sep 2015 07:14:19 +0000</created>
                <updated>Tue, 6 Oct 2015 16:26:09 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                <comments>
                            <comment id="14935445" author="vrodionov" created="Tue, 29 Sep 2015 17:01:31 +0000"  >&lt;p&gt;Bloom filters on a columns with low-moderate cardinality.  &lt;/p&gt;

&lt;p&gt;Next step: introduction of schema support and columnar storage (a-la Kudo) &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14935539" author="lhofhansl" created="Tue, 29 Sep 2015 18:02:06 +0000"  >&lt;p&gt;Bloom filters are good for point lookups, not for range scans. But BFs on column values is a great idea!&lt;br/&gt;
For scans with filters we need to be able to rule out large chunks of the data.&lt;/p&gt;

&lt;p&gt;Schema in HBase... You&apos;re talking heresy &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14935818" author="vrodionov" created="Tue, 29 Sep 2015 20:40:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;, FYI&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14511&quot; title=&quot;StoreFile.Writer Meta Plugin&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14511&quot;&gt;HBASE-14511&lt;/a&gt; - StoreFile.Writer Meta plugin framework. I need only Meta section and only for Writer. For your sparse indexes, you will need full Reader/Writer plugin (both meta and data blocks). It is just a one way of doing indexes, of course. &lt;/p&gt;</comment>
                            <comment id="14935826" author="lhofhansl" created="Tue, 29 Sep 2015 20:42:57 +0000"  >&lt;p&gt;That&apos;s cool! Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vrodionov&quot; class=&quot;user-hover&quot; rel=&quot;vrodionov&quot;&gt;Vladimir Rodionov&lt;/a&gt;, I&apos;ll keep an eye on that one.&lt;/p&gt;</comment>
                            <comment id="14936182" author="lhofhansl" created="Wed, 30 Sep 2015 00:54:44 +0000"  >&lt;p&gt;Actually someone pointed out to me that one can use a BF range scans when it used with &lt;em&gt;prefixes&lt;/em&gt; of keys.&lt;/p&gt;</comment>
                            <comment id="14942101" author="lhofhansl" created="Sat, 3 Oct 2015 04:34:16 +0000"  >&lt;p&gt;The other part that&apos;s needed is to actually make use of the index, i.e. filter the HFiles that do not contain a range of values requested.&lt;br/&gt;
Coprocessors won&apos;t work here, they are a level too high for this (and the region level).&lt;/p&gt;

&lt;p&gt;We could add a method to filter, which is passed an HFile or a FileInfo or something, and based on that gets to decide whether to include the HFile or not. Thoughts &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;?&lt;/p&gt;

&lt;p&gt;The other question is whether HFile is too large of a unit. Assuming CQ values are all over the place, storing min/max per HFile is not be very selective (i.e. a large HFile will likely contain a very small and a very value for a specific CQ). So maybe we need to record min/max CQ value for a range of keys. I.e. we have a mapping from (key1, key2) -&amp;gt; (min CQ, max CQ), then as we scan we skip scan to the next key1 of we find the value range does not contain the value we&apos;re looking for.&lt;/p&gt;

&lt;p&gt;Lastly we need indicate at compaction time what CQs to keep track of. That would be a sly introduction of (some) schema.&lt;br/&gt;
We can try to automate that, but we can&apos;t keep track of all them, there might be many, or the CQ values might be very large.&lt;/p&gt;

&lt;p&gt;Or we punt and just add the building blocks: Add the API I mention to Filter, and allow coprocessors to add record and add stuff to the HFile trailer. Then higher level tools like Phoenix can add the appropriate logic.&lt;/p&gt;</comment>
                            <comment id="14944433" author="jleach" created="Tue, 6 Oct 2015 02:59:06 +0000"  >&lt;p&gt;buddy index?  I must have been sick that day in school.&lt;/p&gt;

&lt;p&gt;Hmm, how about Histograms, Frequent Items, and cardinality?  They sure help an optimizer know which end is up.  &lt;/p&gt;</comment>
                            <comment id="14945304" author="stack" created="Tue, 6 Oct 2015 16:26:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;We could add a method to filter, which is passed an HFile or a FileInfo or something, and based on that gets to decide whether to include the HFile or not. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Is filter Interface, like CP, operating at too high a level for the ruling in/out of hfile?&lt;/p&gt;

&lt;p&gt;bq, The other question is whether HFile is too large of a unit. &lt;/p&gt;

&lt;p&gt;On whether an hfile is too large a unit, block is the next natural construct; a BF of CQ per block so can skip blocks at a time?  The sparse index would go into the current block index as ancillary data rather than add at the head of a data block... We already load the hfile index.... BF per CQ or min/max could be part of this?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Or we punt and just add the building blocks: &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sounds like extra config/options to me... so no (smile). Could we start small? Add extra generic info on index &amp;#8211; a BF or min/max &amp;#8211; just so we can skip blocks as we scan?  min/max in hfile would be useful too... so could skip whole hfile (would be rare event but great when it happens)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 29 Sep 2015 17:01:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 10 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2me6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>