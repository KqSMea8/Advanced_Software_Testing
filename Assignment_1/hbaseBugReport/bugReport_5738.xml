<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:30:32 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5738/HBASE-5738.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5738] Using HBase with HA HDFS requires bogus hardcoded port value</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5738</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When configuring HBase with HDFS HA, we currently have to have the 8020 port (regardless of what port HDFS is using for the namenode rpc address) in the following property in hbase-site.xml:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.rootdir&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;hdfs://ha-nn-uri:8020/hbase&amp;lt;/value&amp;gt;
  &amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Otherwise the master and regionservers will not start.&lt;/p&gt;

&lt;p&gt;The value in the above property should really just be &quot;hdfs://ha-nn-uri/hbase&quot; (replace &quot;ha-nn-uri&quot; with your uri and &quot;hbase&quot; with the name of the hbase directory in HDFS that you are using, as appropriate).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12549841">HBASE-5738</key>
            <summary>Using HBase with HA HDFS requires bogus hardcoded port value</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="smanek">Shaneal Manek</assignee>
                                    <reporter username="smanek">Shaneal Manek</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Apr 2012 04:58:49 +0000</created>
                <updated>Tue, 19 Jun 2012 00:57:29 +0000</updated>
                            <resolved>Tue, 19 Jun 2012 00:57:29 +0000</resolved>
                                    <version>0.92.1</version>
                    <version>0.94.0</version>
                                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13248055" author="smanek" created="Fri, 6 Apr 2012 05:02:18 +0000"  >&lt;p&gt;The problem is that the HDFS client changed the fs.default.name property to fs.defaultFS in HA. &lt;/p&gt;

&lt;p&gt;Most of the references in HBase were appropriately updated - this one seems to have been forgotten.&lt;/p&gt;</comment>
                            <comment id="13248083" author="tlipcon" created="Fri, 6 Apr 2012 05:36:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;The problem is that the HDFS client changed the fs.default.name property to fs.defaultFS in HA.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That&apos;s not quite right &amp;#8211; the config key change was from 0.20 to 0.21, but the old config key should still work. So I&apos;m confused why this fixes the problem...&lt;/p&gt;

&lt;p&gt;Also, this might break 0.20 (if it doesnt, then I&apos;m suspicious of why this code is there at all!)&lt;/p&gt;</comment>
                            <comment id="13248091" author="jmhsieh" created="Fri, 6 Apr 2012 05:50:33 +0000"  >&lt;p&gt;Added link to hadoop 20/23 deprecated properties list.&lt;/p&gt;</comment>
                            <comment id="13248093" author="smanek" created="Fri, 6 Apr 2012 05:52:07 +0000"  >&lt;p&gt;Ah, thanks for the clarification Todd!&lt;/p&gt;

&lt;p&gt;I wouldn&apos;t have expected it to break anything in 0.20 (since this patch sets both fs.default.name and fs.defaultFS) - but I&apos;ll test it before we continue any further.&lt;/p&gt;

&lt;p&gt;I&apos;ll post an update after I&apos;ve had a chance to see how it works on 0.20 (I&apos;m using my dev cluster for security testing right now).&lt;/p&gt;</comment>
                            <comment id="13248096" author="smanek" created="Fri, 6 Apr 2012 05:53:24 +0000"  >&lt;p&gt;Thanks Jon - I didn&apos;t know about that ticket.&lt;/p&gt;</comment>
                            <comment id="13248101" author="hadoopqa" created="Fri, 6 Apr 2012 05:56:39 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12521649/HBASE-5738.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12521649/HBASE-5738.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1426//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1426//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1426//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1426//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1426//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1426//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13258056" author="eli2" created="Fri, 20 Apr 2012 06:58:45 +0000"  >&lt;p&gt;Shaneal,&lt;/p&gt;

&lt;p&gt;Does using defaultFS fix the issues?&lt;/p&gt;

&lt;p&gt;Looking at the exception..&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caused by: org.apache.hadoop.fs.InvalidPathException: Invalid path
name Wrong FS: hdfs://ha-nn-uri/hbase/-ROOT-/70236052/.logs/hlog.1327624121445,
expected: hdfs://ha-nn-uri:8020
       at org.apache.hadoop.fs.AbstractFileSystem.checkPath(AbstractFileSystem.java:361)
       at org.apache.hadoop.fs.AbstractFileSystem.create(AbstractFileSystem.java:462)
       at org.apache.hadoop.fs.FileContext$3.next(FileContext.java:657)
       at org.apache.hadoop.fs.FileContext$3.next(FileContext.java:654)
       at org.apache.hadoop.fs.FileContext$FSLinkResolver.resolve(FileContext.java:2319)
       at org.apache.hadoop.fs.FileContext.create(FileContext.java:654)
       at org.apache.hadoop.io.SequenceFile.createWriter(SequenceFile.java:501)
       at org.apache.hadoop.io.SequenceFile.createWriter(SequenceFile.java:468)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;AFS#checkPath is failing because the authority of the FC URI (ha-nn-uri:8020) doesn&apos;t match the authority of the given URI (ha-nn-uri).&lt;/p&gt;

&lt;p&gt;Looking at the FC URI, AFS#getUri...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; port = uri.getPort();
    port = (port == -1 ? defaultPort : port);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (port == -1) { &lt;span class=&quot;code-comment&quot;&gt;// no port supplied and &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; port is not specified
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; URI(supportedScheme, authority, &lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So if we don&apos;t specify a port when creating the FC (which we don&apos;t, we&apos;re using hdfs://ha-nn-uri/hbase) we&apos;ll fail to match the authority because we didn&apos;t set a port and we&apos;re not using the default port for HDFS (8020).&lt;/p&gt;

&lt;p&gt;Seems like a HADOOP bug to me, specifically the path given the AFS checkPath should be one of the configured NN addresses which will have a port (ie the address returned by the proxy provider) instead of the logical NN uri (or the AFS#checkPath should be more lenient if the given path doesn&apos;t specify a port).&lt;/p&gt;</comment>
                            <comment id="13260883" author="eli2" created="Tue, 24 Apr 2012 19:45:47 +0000"  >&lt;p&gt;I believe this is a dupe of &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8310&quot; title=&quot;FileContext#checkPath should handle URIs with no port&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8310&quot;&gt;&lt;del&gt;HADOOP-8310&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13264135" author="stack" created="Sat, 28 Apr 2012 00:03:11 +0000"  >&lt;p&gt;Shaneal, shall we close this (as per Eli&apos;s suggestion above)?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12549043">HBASE-5697</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12521649" name="HBASE-5738.patch" size="675" author="smanek" created="Fri, 6 Apr 2012 05:02:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 6 Apr 2012 05:36:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>234832</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 33 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i068wn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34374</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>