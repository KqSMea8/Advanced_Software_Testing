<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:47:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7607/HBASE-7607.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7607] Fix TestRegionServerCoprocessorExceptionWithAbort flakiness in 0.94</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7607</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;TestRegionServerCoprocessorExceptionWithAbort fails sometimes both on trunk and 0.94.X. The codebase is different in both. &lt;/p&gt;

&lt;p&gt;In 0.94.x, client retries to look at the root region, while the cluster is down and /hbase znode is no longer present.&lt;br/&gt;
&quot;Check the value configured in &apos;zookeeper.znode.parent&apos;. There could be a mismatch with the one configured in the master.&quot;&lt;/p&gt;

&lt;p&gt;I will file a separate jira for the trunk as the code is different there.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12628078">HBASE-7607</key>
            <summary>Fix TestRegionServerCoprocessorExceptionWithAbort flakiness in 0.94</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="v.himanshu">Himanshu Vashishtha</assignee>
                                    <reporter username="v.himanshu">Himanshu Vashishtha</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Jan 2013 18:17:06 +0000</created>
                <updated>Sat, 6 Apr 2013 03:25:01 +0000</updated>
                            <resolved>Sat, 6 Apr 2013 03:25:01 +0000</resolved>
                                    <version>0.94.4</version>
                                                    <component>Client</component>
                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13563753" author="lhofhansl" created="Sun, 27 Jan 2013 07:55:11 +0000"  >&lt;p&gt;I think we fixed that in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7681&quot; title=&quot;Address some recent random test failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7681&quot;&gt;&lt;del&gt;HBASE-7681&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13563858" author="v.himanshu" created="Sun, 27 Jan 2013 17:59:24 +0000"  >&lt;p&gt;I don&apos;t think we fixed that in 7681. The 4382 patch doesn&apos;t correctly solve the issue raised in 0.94, where the description says that the client went into retrying mode. In trunk, all the sleep/interrupt logic is gone, and which is in the right direction, but I wonder why the client didn&apos;t get IOException.&lt;/p&gt;</comment>
                            <comment id="13563865" author="lhofhansl" created="Sun, 27 Jan 2013 18:20:00 +0000"  >&lt;p&gt;Feel free to reopen &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13564300" author="v.himanshu" created="Mon, 28 Jan 2013 14:20:00 +0000"  >&lt;p&gt;re-opening as par last comment.&lt;/p&gt;</comment>
                            <comment id="13566262" author="lhofhansl" created="Wed, 30 Jan 2013 07:37:54 +0000"  >&lt;p&gt;Just saw this test failing again in 0.94.&lt;br/&gt;
Do you have a patch Himanshu?&lt;/p&gt;</comment>
                            <comment id="13566935" author="v.himanshu" created="Wed, 30 Jan 2013 21:44:30 +0000"  >&lt;p&gt;I will upload a patch for 0.94 as the current test is just broken. For the trunk, I don&apos;t have a patch yet (haven&apos;t trace out the root problem). The trunk test fails quite rarely though.&lt;/p&gt;</comment>
                            <comment id="13566972" author="lhofhansl" created="Wed, 30 Jan 2013 22:12:00 +0000"  >&lt;p&gt;Thanks Himanshu. Should we make separate issues for 0.94 and trunk?&lt;/p&gt;</comment>
                            <comment id="13566987" author="hvashish@cs.ualberta.ca" created="Wed, 30 Jan 2013 22:21:11 +0000"  >&lt;p&gt;Filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7722&quot; title=&quot;Fix TestRegionServerCoprocessorExceptionWithAbort flakiness in trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7722&quot;&gt;HBASE-7722&lt;/a&gt; for trunk.&lt;/p&gt;
</comment>
                            <comment id="13567384" author="v.himanshu" created="Thu, 31 Jan 2013 05:55:50 +0000"  >&lt;p&gt;Patch for 0.94; This makes it at par with trunk. Ran in a loop of 100.&lt;/p&gt;

&lt;p&gt;I had to add a sleep of 1 sec before completing the test method; I find it necessary as the Server manager still holds the reference of dead regionserver whereas the cluster is down. Adding sleeps solves it.&lt;/p&gt;</comment>
                            <comment id="13567386" author="v.himanshu" created="Thu, 31 Jan 2013 05:57:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;necessary as the Server manager still holds the reference of dead regionserver whereas the cluster is down&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This was hanging the test.&lt;/p&gt;</comment>
                            <comment id="13567447" author="lhofhansl" created="Thu, 31 Jan 2013 08:04:18 +0000"  >&lt;p&gt;We could keep the RSTracker and just remove the interrupt nonsense. That way you test in a loop whether the RS&apos;s znode was removed and then end the test.&lt;/p&gt;</comment>
                            <comment id="13569798" author="v.himanshu" created="Sun, 3 Feb 2013 15:18:47 +0000"  >&lt;p&gt;Interestingly, with this patch, the regionserver which is aborted is processed normally. And, the test passes its normal phase. Its in the cluster shutdown process, sometimes master is not able to process the other regionserver dying process, but the cluster is considered as shutdown by JVMClusterUtil.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-01-30 19:40:14,048 INFO  [RegionServer:0;localhost,49074,1359600001555] regionserver.HRegionServer(851): stopping server localhost,49074,1359600001555; zookeeper connection closed.

2013-01-30 19:40:14,048 INFO  [RegionServer:0;localhost,49074,1359600001555] regionserver.HRegionServer(854): RegionServer:0;localhost,49074,1359600001555 exiting

2013-01-30 19:40:14,048 INFO  [localhost,35387,1359600001393.timerUpdater] hbase.Chore(80): localhost,35387,1359600001393.timerUpdater exiting

2013-01-30 19:40:14,048 INFO  [Shutdown of org.apache.hadoop.hbase.fs.HFileSystem@32d35f5f] hbase.MiniHBaseCluster$SingleFileSystemShutdownThread(182): Hook closing fs=org.apache.hadoop.hbase.fs.HFileSystem@32d35f5f

2013-01-30 19:40:14,049 INFO  [main] util.JVMClusterUtil(262): Shutdown of 1 master(s) and 2 regionserver(s) complete

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-01-30 19:40:14,168 INFO  [RegionServer:0;localhost,49074,1359600001555.leaseChecker] regionserver.Leases(132): RegionServer:0;localhost,49074,1359600001555.leaseChecker closed leases

2013-01-30 19:40:14,227 INFO  [Master:0;localhost,35387,1359600001393] master.ServerManager(357): Waiting on regionserver(s) to go down localhost,49074,1359600001555
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But, master thread still looping in its ServerManager#letRegionServersShutdown method to process the dead regionserver, which it doesn&apos;t get. I am looking into the reason why this happens only with this patch (frequently is around 1/5).&lt;/p&gt;</comment>
                            <comment id="13570422" author="v.himanshu" created="Mon, 4 Feb 2013 17:34:18 +0000"  >&lt;p&gt;Looks like this is similar behavior as reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7729&quot; title=&quot;TestCatalogTrackerOnCluster.testbadOriginalRootLocation fails occasionally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7729&quot;&gt;&lt;del&gt;HBASE-7729&lt;/del&gt;&lt;/a&gt;. And, using the sleep(1000) (already in the patch) fixed that behavior. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;: What do you think? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Should &quot;sleep (1000)&quot; be given an option here. As mentioned, it passes a loop of 100 iterations with it.&lt;/p&gt;</comment>
                            <comment id="13571041" author="lhofhansl" created="Tue, 5 Feb 2013 04:49:47 +0000"  >&lt;p&gt;Do you think this is the same? In this case we could wait to the znode to disappear, since we do have tracker anyway.&lt;/p&gt;

&lt;p&gt;Anyway, I&apos;m fine with sleep(1000) as well. Per your previous comment this patch causes some other issues?&lt;/p&gt;</comment>
                            <comment id="13586720" author="lhofhansl" created="Tue, 26 Feb 2013 04:13:16 +0000"  >&lt;p&gt;Since you&apos;re not sure whether this patch is correct (judging from your comment about the test failing every 5th time), moving to 0.94.7.&lt;/p&gt;</comment>
                            <comment id="13624308" author="lhofhansl" created="Sat, 6 Apr 2013 03:25:01 +0000"  >&lt;p&gt;Marking as &quot;Won&apos;t fix&quot; for now.&lt;br/&gt;
Feel free to reopen Himanshu if you think you get to this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12567306" name="HBASE-7607-v2.patch" size="7452" author="v.himanshu" created="Thu, 31 Jan 2013 05:55:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 27 Jan 2013 07:55:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>304929</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i17wy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>254307</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>