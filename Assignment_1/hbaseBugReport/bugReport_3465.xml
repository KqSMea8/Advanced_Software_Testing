<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:10:27 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3465/HBASE-3465.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3465] Hbase should use a HADOOP_HOME environment variable if available.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3465</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I have been burned a few times lately while developing code by having the make sure that the hadoop jar in hbase/lib is exactly correct.  In my own deployment, there are actually 3 jars and a native library to keep in sync that hbase shouldn&apos;t have to know about explicitly.  A similar problem arises when using stock hbase with CDH3 because of the security patches changing the wire protocol.&lt;/p&gt;

&lt;p&gt;All of these problems could be avoided by not assuming that the hadoop library is in the local directory.  Moreover, I think it might be possible to assemble the distribution such that the compile time hadoop dependency is in a cognate directory to lib and is referenced using a default value for HADOOP_HOME.&lt;/p&gt;

&lt;p&gt;Does anybody have any violent antipathies to such a change?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12496401">HBASE-3465</key>
            <summary>Hbase should use a HADOOP_HOME environment variable if available.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tucu00">Alejandro Abdelnur</assignee>
                                    <reporter username="tdunning">Ted Dunning</reporter>
                        <labels>
                    </labels>
                <created>Sun, 23 Jan 2011 00:30:04 +0000</created>
                <updated>Fri, 20 Nov 2015 12:43:25 +0000</updated>
                            <resolved>Sun, 24 Jul 2011 05:21:44 +0000</resolved>
                                    <version>0.90.0</version>
                                    <fixVersion>0.92.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="12987327" author="stack" created="Thu, 27 Jan 2011 01:17:18 +0000"  >&lt;p&gt;I&apos;m not mad about having new hadoop only lib dir.  What if hadoop were in a subdir of lib?  Then you could do your HADOOP_HOME into lib/hadoop as default and if overridden, we use the alternative.&lt;/p&gt;

&lt;p&gt;But I&apos;m kinda easy on this.  Currently its a bit of a pain, especially so with 0.90.0, given as we&apos;ll more than likely be deployed atop an Hadoop we are not compatible with.&lt;/p&gt;</comment>
                            <comment id="12987342" author="tdunning" created="Thu, 27 Jan 2011 01:42:56 +0000"  >
&lt;p&gt;I am not suggesting a new hadoop lib dir.  I am suggesting that hbase assume that it will use an existing hadoop lib dir from an existing hadoop install.&lt;/p&gt;

&lt;p&gt;Your suggestion of supplying a default lib directory is interesting since it would make hbase self contained by default (though still delicate because of version issues).&lt;/p&gt;

&lt;p&gt;My major difficulty with the lib/hadoop/*.jar and HADOOP_HOME=lib/hadoop default is that it makes the build significantly fancier.  If somebody has a cool and simple way to stick dependencies in the provided scope into a different directory while still sticking the run dependencies into lib, then I would have no objection.  Sounds to me like it would require a custom assembly at the least, but that isn&apos;t so hard.&lt;/p&gt;

&lt;p&gt;In any case, it still seems that making an hbase-with-dependencies jar would be good to do.  In my estimation, this should not contain the hadoop jars, but should assume the same trick.  It would presumably be relatively easy to pour all of the hadoop dependencies into a single hadoop-with-dependencies if it is easy to select all provided scope dependencies.  That would give us two jars and one hadoop lib directory in the end that provide a lot of flexibility.&lt;/p&gt;</comment>
                            <comment id="12992073" author="stack" created="Tue, 8 Feb 2011 17:51:15 +0000"  >&lt;blockquote&gt;&lt;p&gt;I am not suggesting a new hadoop lib dir. I am suggesting that hbase assume that it will use an existing hadoop lib dir from an existing hadoop install.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;There is not always an existing Hadoop install.  In particular if you run HBase standalone, it comes up fine without reference to an Hadoop cluster.&lt;/p&gt;

&lt;p&gt;Tell me more about your hbase-with-dependencies notion Ted.  I don&apos;t grok it too well.&lt;/p&gt;

&lt;p&gt;I appreciate your bringing this up.  We&apos;ve been operating this way for ages but it has never been satisfactory.  Appreciate fresh POV.&lt;/p&gt;</comment>
                            <comment id="12992080" author="tdunning" created="Tue, 8 Feb 2011 18:01:03 +0000"  >&lt;p&gt;My suggestion is that there be an hbase jar that contains all dependencies except for Hadoop.  In addition, there would be a lib dir with a default hadoop.jar that would satisfy all of transitive dependencies that are implied by Hadoop.&lt;/p&gt;

&lt;p&gt;This would allow the startup script (bin/hbase) to detect whether the user has provided a hadoop home directory or not.  The script could then build a class path that either has the user specified hadoop or the default hadoop jar.&lt;/p&gt;

&lt;p&gt;From the user&apos;s point of view, hbase would generally just work.  For somebody working with a different and API compatible but wire-level incompatible Hadoop such as Hadoop with security, one environment variable setting will cure the problem.&lt;/p&gt;</comment>
                            <comment id="12992248" author="ryanobjc" created="Wed, 9 Feb 2011 00:20:57 +0000"  >&lt;p&gt;we should consider using jarjar:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://code.google.com/p/jarjar/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://code.google.com/p/jarjar/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;That way we would not have conflicting jar issues with our classpath.&lt;/p&gt;</comment>
                            <comment id="12992269" author="tdunning" created="Wed, 9 Feb 2011 01:20:34 +0000"  >&lt;p&gt;The problem I had was not a matter of conflicting jars so much as that I wanted to have an hbase build that would accept my hadoop and related jars and not include its own unless I didn&apos;t provide something.&lt;/p&gt;

&lt;p&gt;Maven makes this easy by having a &quot;provided&quot; scope for dependencies.  The only missing bit is some shell-fu to either include a default set of hadoop jars or env specified hadoop jars as desired.&lt;/p&gt;

&lt;p&gt;I will produce a prototype when I have time to scratch.&lt;/p&gt;</comment>
                            <comment id="13047522" author="stack" created="Fri, 10 Jun 2011 22:45:38 +0000"  >&lt;p&gt;Moving out of 0.92.0. Pull it back in if you think different.&lt;/p&gt;</comment>
                            <comment id="13064032" author="tucu00" created="Tue, 12 Jul 2011 17:41:20 +0000"  >&lt;p&gt;Last year I&apos;ve open a JIRA for Hadoop (&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6894&quot; title=&quot;Common foundation for Hadoop client tools&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6894&quot;&gt;&lt;del&gt;HADOOP-6894&lt;/del&gt;&lt;/a&gt;) proposing a general solution for this.&lt;/p&gt;

&lt;p&gt;Until there is a general mechanism Hbase should do something. &lt;/p&gt;

&lt;p&gt;IMO Hbase should not duplicate/copy Hadoop JARs in its setup. It should just use HADOOP_HOME if defined, to bring in JAR and SO files. And if HADOOP_HOME is not set it assumes all Hadoop JAR and SO files have been copied into Hbase lib and lib/native/.&lt;/p&gt;

&lt;p&gt;This seems simple enough and it should work.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="13064725" author="stack" created="Wed, 13 Jul 2011 17:49:02 +0000"  >&lt;p&gt;Alejandro:&lt;/p&gt;

&lt;p&gt;So, whats in the hbase tar ball?  Do we include an hadoop jar?  We need to, don&apos;t we, so that we can run standalone mode.&lt;/p&gt;

&lt;p&gt;If HADOOP_HOME is defined and if hbase/lib dir has hadoop*jars, we&apos;ll need to do some pruning of the CLASSPATH.  Currently we include hbase/lib/&lt;b&gt;... We&apos;d have to do a little messing to exclude hadoop-&lt;/b&gt;.jars. That&apos;d be easy enough.&lt;/p&gt;

&lt;p&gt;What you reckon @Ted?&lt;/p&gt;

&lt;p&gt;I can help out Alejandro.  I volunteer to do the doc portion of this issue.&lt;/p&gt;</comment>
                            <comment id="13068727" author="tucu00" created="Wed, 20 Jul 2011 23:52:39 +0000"  >&lt;p&gt;The attached patch adds Hadoop JARs/conf/SOs to the &apos;hbase&apos; environment if HADOOP_HOME is defined.&lt;/p&gt;</comment>
                            <comment id="13068827" author="stack" created="Thu, 21 Jul 2011 06:33:51 +0000"  >&lt;p&gt;Looks great AA.&lt;/p&gt;

&lt;p&gt;Should we include the test jar?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  HADOOPCPPATH=$(append_path &lt;span class=&quot;code-quote&quot;&gt;&quot;${HADOOPCPPATH}&quot;&lt;/span&gt; `ls ${HADOOP_HOME}/hadoop-core*.jar`)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is this right?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [ -d &lt;span class=&quot;code-quote&quot;&gt;&quot;${HBASE_HOME}/build/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;&quot;&lt;/span&gt; -o -d &lt;span class=&quot;code-quote&quot;&gt;&quot;${HBASE_HOME}/lib/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;&quot;&lt;/span&gt; ]; then
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is it same thing on left and right side of the -o?&lt;/p&gt;

&lt;p&gt;Does it work?  If you set HADOOP_HOME, do we use its hadoop and jars over our own?&lt;/p&gt;

&lt;p&gt;Good stuff.&lt;/p&gt;</comment>
                            <comment id="13068978" author="tucu00" created="Thu, 21 Jul 2011 13:25:17 +0000"  >&lt;p&gt;Thanks Stack.&lt;/p&gt;

&lt;p&gt;On 1st comment: Does Hbase require Hadoop tests JARs? If so we should not only include it. But the problem we&apos;ll have there is its transitive dependencies (which are not in the Hadoop&apos;s lib).&lt;/p&gt;

&lt;p&gt;On 2nd comment: left are right are not the same, &lt;b&gt;build&lt;/b&gt; and &lt;b&gt;lib&lt;/b&gt;. BTW, this is in the original script, it shows modified (the - is before all the +).&lt;/p&gt;</comment>
                            <comment id="13069025" author="stack" created="Thu, 21 Jul 2011 15:25:33 +0000"  >&lt;p&gt;On 1., we use the mini test tools, minidfs, etc., but if the HADOOP_HOME is for runtime only, we should be able to get away with not needing hadoop-test*.jar.&lt;/p&gt;

&lt;p&gt;On 2., my bad.&lt;/p&gt;

&lt;p&gt;This patch should be good to go then AA?&lt;/p&gt;</comment>
                            <comment id="13069035" author="tucu00" created="Thu, 21 Jul 2011 15:51:47 +0000"  >&lt;p&gt;I think so, thxs!&lt;/p&gt;</comment>
                            <comment id="13069055" author="stack" created="Thu, 21 Jul 2011 16:22:11 +0000"  >&lt;p&gt;I&apos;m +1 then.  Let me commit in a day or so.  Maybe Ted Dunning will grace us w/ an opinion if we give him a chance.  Good on you AA.&lt;/p&gt;</comment>
                            <comment id="13070109" author="stack" created="Sun, 24 Jul 2011 05:21:44 +0000"  >&lt;p&gt;Committed to TRUNK.  Thank you for the patch Alejandro.&lt;/p&gt;</comment>
                            <comment id="13070121" author="hudson" created="Sun, 24 Jul 2011 08:34:29 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2050 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2050/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2050/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3465&quot; title=&quot;Hbase should use a HADOOP_HOME environment variable if available.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3465&quot;&gt;&lt;del&gt;HBASE-3465&lt;/del&gt;&lt;/a&gt; Hbase should use a HADOOP_HOME environment variable if available&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/bin/hbase&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13167728" author="joern" created="Mon, 12 Dec 2011 19:55:30 +0000"  >&lt;p&gt;Looks like the Hadoop conf dir is now before the Hbase conf dir on the classpath in case the HADOOP_HOME variable is set.&lt;/p&gt;

&lt;p&gt;Isn&apos;t that problematic for configuration files which exist in the Hadoop and Hbase conf directory?&lt;/p&gt;

&lt;p&gt;Such as:&lt;br/&gt;
hadoop-metrics.properties&lt;br/&gt;
log4j.properties&lt;/p&gt;

&lt;p&gt;In the case HADOOP_HOME is set the files from Hadoop are used instead, which might be confusing.&lt;/p&gt;</comment>
                            <comment id="13167754" author="stack" created="Mon, 12 Dec 2011 20:16:25 +0000"  >&lt;p&gt;That sounds like a bug yes Joern.&lt;/p&gt;</comment>
                            <comment id="13167782" author="stack" created="Mon, 12 Dec 2011 20:39:52 +0000"  >&lt;p&gt;We should swap the order in which we append the CLASSPATH so hbase additions come first?&lt;/p&gt;</comment>
                            <comment id="13168755" author="joern" created="Tue, 13 Dec 2011 21:42:38 +0000"  >&lt;p&gt;Sounds like that will fix the issues, but I don&apos;t know if it will have any other consequences.&lt;/p&gt;

&lt;p&gt;I more or less did set the HADOOP_HOME and other environment variables accidentally and just really wonder why that disables the ganglia monitoring. As far as I understand that is only needed for features I do not use anyway. &lt;/p&gt;

&lt;p&gt;Maybe Ted or Alejandro can comment here if the suggested fix would cause any issues. &lt;/p&gt;</comment>
                            <comment id="13168762" author="qwertymaniac" created="Tue, 13 Dec 2011 21:51:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4854&quot; title=&quot;it seems that CLASSPATH elements coming from Hadoop change HBase behaviour&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4854&quot;&gt;&lt;del&gt;HBASE-4854&lt;/del&gt;&lt;/a&gt; fixed this I think?&lt;/p&gt;</comment>
                            <comment id="15017515" author="lars_francke" created="Fri, 20 Nov 2015 12:43:25 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                                                <inwardlinks description="is superceded by">
                                        <issuelink>
            <issuekey id="12532414">HBASE-4854</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12487236" name="a1-HBASE-3465.patch" size="1749" author="tucu00" created="Wed, 20 Jul 2011 23:52:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Jan 2011 01:17:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26872</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05ia7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30059</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>If HADOOP_HOME is defined, we&amp;#39;ll use this hadoop over whats in HBASE_HOME/lib</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>