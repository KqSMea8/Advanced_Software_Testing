<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:11:43 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3617/HBASE-3617.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3617] NoRouteToHostException during balancing will cause Master abort</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3617</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Via Tatsuya up on the list:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2011-03-10 07:48:39,192 FATAL org.apache.hadoop.hbase.master.HMaster:
Remote unexpected exception
java.net.NoRouteToHostException: No route to host
      at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
      at
sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:567)
      at
org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:
206)
      at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:408)
      at org.apache.hadoop.hbase.ipc.HBaseClient
$Connection.setupIOstreams(HBaseClient.java:328)
      at
org.apache.hadoop.hbase.ipc.HBaseClient.getConnection(HBaseClient.java:
883)
      at
org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:750)
      at org.apache.hadoop.hbase.ipc.HBaseRPC
$Invoker.invoke(HBaseRPC.java:257)
      at $Proxy6.closeRegion(Unknown Source)
      at
org.apache.hadoop.hbase.master.ServerManager.sendRegionClose(ServerManager.java:
589)
      at
org.apache.hadoop.hbase.master.AssignmentManager.unassign(AssignmentManager.java:
1093)
      at
org.apache.hadoop.hbase.master.AssignmentManager.unassign(AssignmentManager.java:
1040)
      at
org.apache.hadoop.hbase.master.AssignmentManager.balance(AssignmentManager.java:
1831)
      at org.apache.hadoop.hbase.master.HMaster.balance(HMaster.java:
692)
      at org.apache.hadoop.hbase.master.HMaster$1.chore(HMaster.java:
583)
      at org.apache.hadoop.hbase.Chore.run(Chore.java:66)
2011-03-10 07:48:39,192 INFO org.apache.hadoop.hbase.master.HMaster:
Aborting
2011-03-10 07:48:39,192 INFO org.apache.hadoop.hbase.master.HMaster:
balance hri=SpecialObject_Speed_Test,,
1299710751983.f0e5544339870a510c338b3029979d3e.,
src=ap13.secur2,60020,1299710609447,
dest=ap12.secur2,60020,1299710609148
2011-03-10 07:48:39,192 DEBUG
org.apache.hadoop.hbase.master.AssignmentManager: Starting
unassignment of region SpecialObject_Speed_Test,,
1299710751983.f0e5544339870a510c338b3029979d3e. (offlining)
2011-03-10 07:48:39,852 DEBUG org.apache.hadoop.hbase.master.HMaster:
Stopping service threads
2011-03-10 07:48:39,852 INFO org.apache.hadoop.ipc.HBaseServer:
Stopping server on 60000
2011-03-10 07:48:39,852 FATAL org.apache.hadoop.hbase.master.HMaster:
Remote unexpected exception
java.io.InterruptedIOException: Interruped &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; IO on
channel java.nio.channels.SocketChannel[connection-pending remote=/
10.X.X.18:60020]. 19340 millis timeout left.
      at org.apache.hadoop.net.SocketIOWithTimeout
$SelectorPool.select(SocketIOWithTimeout.java:349)
      at
org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:
203)
      at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:408)
      at org.apache.hadoop.hbase.ipc.HBaseClient
$Connection.setupIOstreams(HBaseClient.java:328)
      at
org.apache.hadoop.hbase.ipc.HBaseClient.getConnection(HBaseClient.java:
883)
      at
org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:750)
      at org.apache.hadoop.hbase.ipc.HBaseRPC
$Invoker.invoke(HBaseRPC.java:257)
      at $Proxy6.closeRegion(Unknown Source)
      at
org.apache.hadoop.hbase.master.ServerManager.sendRegionClose(ServerManager.java:
589)
      at
org.apache.hadoop.hbase.master.AssignmentManager.unassign(AssignmentManager.java:
1093)
      at
org.apache.hadoop.hbase.master.AssignmentManager.unassign(AssignmentManager.java:
1040)
      at
org.apache.hadoop.hbase.master.AssignmentManager.balance(AssignmentManager.java:
1831)
      at org.apache.hadoop.hbase.master.HMaster.balance(HMaster.java:
692)
      at org.apache.hadoop.hbase.master.HMaster$1.chore(HMaster.java:
583)
      at org.apache.hadoop.hbase.Chore.run(Chore.java:66)
2011-03-10 07:48:39,852 INFO org.apache.hadoop.hbase.master.HMaster:
Aborting
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12501056">HBASE-3617</key>
            <summary>NoRouteToHostException during balancing will cause Master abort</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuzhihong@gmail.com">Ted Yu</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Mar 2011 19:28:13 +0000</created>
                <updated>Fri, 20 Nov 2015 12:43:12 +0000</updated>
                            <resolved>Tue, 22 Mar 2011 22:22:30 +0000</resolved>
                                                    <fixVersion>0.90.4</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13005273" author="stack" created="Thu, 10 Mar 2011 19:29:01 +0000"  >&lt;p&gt;We do all this stuff in the balance:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-comment&quot;&gt;// TODO: We should consider making &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; look more like it does &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// region open where we &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; all throwables and never abort
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (serverManager.sendRegionClose(server, state.getRegion())) {
        LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Sent CLOSE to &quot;&lt;/span&gt; + server + &lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region &quot;&lt;/span&gt; +
          region.getRegionNameAsString());
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
      }
      &lt;span class=&quot;code-comment&quot;&gt;// This never happens. Currently regionserver close always &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;.
&lt;/span&gt;      LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Server &quot;&lt;/span&gt; + server + &lt;span class=&quot;code-quote&quot;&gt;&quot; region CLOSE RPC returned &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt; +
        region.getEncodedName());
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (NotServingRegionException nsre) {
      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Server &quot;&lt;/span&gt; + server + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + nsre + &lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt; +
        region.getEncodedName());
      &lt;span class=&quot;code-comment&quot;&gt;// Presume that master has stale data.  Presume remote side just split.
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// Presume that the split message when it comes in will fix up the master&apos;s
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// in memory cluster state.
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (ConnectException e) {
      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed connect to &quot;&lt;/span&gt; + server + &lt;span class=&quot;code-quote&quot;&gt;&quot;, message=&quot;&lt;/span&gt; + e.getMessage() +
        &lt;span class=&quot;code-quote&quot;&gt;&quot;, region=&quot;&lt;/span&gt; + region.getEncodedName());
      &lt;span class=&quot;code-comment&quot;&gt;// Presume that regionserver just failed and we haven&apos;t got expired
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// server from zk yet.  Let expired server deal with clean up.
&lt;/span&gt;    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (java.net.SocketTimeoutException e) {
      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Server &quot;&lt;/span&gt; + server + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + e.getMessage() + &lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt; +
        region.getEncodedName());
      &lt;span class=&quot;code-comment&quot;&gt;// Presume retry or server will expire.
&lt;/span&gt;    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (EOFException e) {
      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Server &quot;&lt;/span&gt; + server + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + e.getMessage() + &lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt; +
        region.getEncodedName());
      &lt;span class=&quot;code-comment&quot;&gt;// Presume retry or server will expire.
&lt;/span&gt;    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (RemoteException re) {
      IOException ioe = re.unwrapRemoteException();
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ioe &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; NotServingRegionException) {
        &lt;span class=&quot;code-comment&quot;&gt;// Failed to close, so pass through and reassign
&lt;/span&gt;        LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Server &quot;&lt;/span&gt; + server + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + ioe + &lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt; +
          region.getEncodedName());
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ioe &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; EOFException) {
        &lt;span class=&quot;code-comment&quot;&gt;// Failed to close, so pass through and reassign
&lt;/span&gt;        LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Server &quot;&lt;/span&gt; + server + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + ioe + &lt;span class=&quot;code-quote&quot;&gt;&quot; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt; +
          region.getEncodedName());
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.master.abort(&lt;span class=&quot;code-quote&quot;&gt;&quot;Remote unexpected exception&quot;&lt;/span&gt;, ioe);
      }
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable t) {
      &lt;span class=&quot;code-comment&quot;&gt;// For now call abort &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; unexpected exception -- radical, but will get
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// fellas attention. St.Ack 20101012
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.master.abort(&lt;span class=&quot;code-quote&quot;&gt;&quot;Remote unexpected exception&quot;&lt;/span&gt;, t);
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13005284" author="yuzhihong@gmail.com" created="Thu, 10 Mar 2011 19:47:01 +0000"  >&lt;p&gt;We should catch IOException.&lt;/p&gt;</comment>
                            <comment id="13005427" author="stack" created="Fri, 11 Mar 2011 00:26:16 +0000"  >&lt;p&gt;J-D just saw a IOException where message is &apos;Connection Reset&apos;... an exception we should be catching.&lt;/p&gt;

&lt;p&gt;Lets do what Ted suggests, catch all IOEs.&lt;/p&gt;</comment>
                            <comment id="13005992" author="yuzhihong@gmail.com" created="Sat, 12 Mar 2011 06:20:12 +0000"  >&lt;p&gt;Catch all IOExceptions in unassign()&lt;/p&gt;</comment>
                            <comment id="13006004" author="yuzhihong@gmail.com" created="Sat, 12 Mar 2011 08:06:35 +0000"  >&lt;p&gt;Catch IOException in unassign()&lt;/p&gt;</comment>
                            <comment id="13006085" author="stack" created="Sat, 12 Mar 2011 19:56:51 +0000"  >&lt;p&gt;Your patch has other change pollution Ted but thats OK... just watch out for it next time.&lt;/p&gt;

&lt;p&gt;Let me try out this change.  I think its the right thing to do.  We might have to be even more extreme.  See how the assign method catches Throwable, not just IOEs.  We need to be a little careful here.  This is pretty big change, especially on a point release.&lt;/p&gt;</comment>
                            <comment id="13006092" author="yuzhihong@gmail.com" created="Sat, 12 Mar 2011 21:31:12 +0000"  >&lt;p&gt;Remove unrelated changes in other files. Pardon me.&lt;/p&gt;</comment>
                            <comment id="13009510" author="yuzhihong@gmail.com" created="Tue, 22 Mar 2011 01:49:02 +0000"  >&lt;p&gt;Second attempt after discussing with J-D&lt;/p&gt;</comment>
                            <comment id="13009513" author="yuzhihong@gmail.com" created="Tue, 22 Mar 2011 01:58:47 +0000"  >&lt;p&gt;Unwrap RemoteException if necessary&lt;/p&gt;</comment>
                            <comment id="13009870" author="stack" created="Tue, 22 Mar 2011 22:22:08 +0000"  >&lt;p&gt;Here is what I applied; its same as the wrapper around assign (this adds same wrapper around unassign).&lt;/p&gt;</comment>
                            <comment id="13009872" author="stack" created="Tue, 22 Mar 2011 22:22:30 +0000"  >&lt;p&gt;Applied trunk and branch.  Thanks for the patch Ted.&lt;/p&gt;</comment>
                            <comment id="13009957" author="hudson" created="Wed, 23 Mar 2011 01:44:12 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #1803 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/HBase-TRUNK/1803/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/HBase-TRUNK/1803/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3617&quot; title=&quot;NoRouteToHostException during balancing will cause Master abort&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3617&quot;&gt;&lt;del&gt;HBASE-3617&lt;/del&gt;&lt;/a&gt; NoRouteToHostException during balancing will cause Master abort&lt;/p&gt;</comment>
                            <comment id="13032548" author="stack" created="Thu, 12 May 2011 18:01:25 +0000"  >&lt;p&gt;Bringing into 0.90.4.  This patch was not applied to the branch as it says above (TRUNK CHANGES.txt has it in the 0.90.2 section).&lt;/p&gt;</comment>
                            <comment id="15017461" author="lars_francke" created="Fri, 20 Nov 2015 12:43:12 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12474348" name="3617-v2.txt" size="2779" author="stack" created="Tue, 22 Mar 2011 22:22:08 +0000"/>
                            <attachment id="12474260" name="hbase-3617-v2.txt" size="2176" author="yuzhihong@gmail.com" created="Tue, 22 Mar 2011 01:58:47 +0000"/>
                            <attachment id="12473480" name="hbase-3617.txt" size="1454" author="yuzhihong@gmail.com" created="Sat, 12 Mar 2011 21:31:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 10 Mar 2011 19:47:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26945</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hn1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100996</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>