<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:11:21 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3577/HBASE-3577.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3577] enables Thrift client to get the Region location</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3577</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The current thrift interface has the getTableRegions() interface like below.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  list&amp;lt;TRegionInfo&amp;gt; getTableRegions(
    /** table name */
    1:Text tableName)
    &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; (1:IOError io)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
struct TRegionInfo {
  1:Text startKey,
  2:Text endKey,
  3:i64 id,
  4:Text name,
  5:&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; version
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But the method don&apos;t have the region location information (where the region is located).&lt;/p&gt;

&lt;p&gt;I want to add the Thrift interfaces like below in HTable.java.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Map&amp;lt;HRegionInfo, HServerAddress&amp;gt; getRegionsInfo() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; HRegionLocation getRegionLocation(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; row)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12499831">HBASE-3577</key>
            <summary>enables Thrift client to get the Region location</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kzk">Kazuki Ohta</reporter>
                        <labels>
                    </labels>
                <created>Sat, 26 Feb 2011 20:06:15 +0000</created>
                <updated>Tue, 21 Apr 2015 00:46:05 +0000</updated>
                            <resolved>Tue, 21 Apr 2015 00:46:05 +0000</resolved>
                                                                    <component>Thrift</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12999849" author="kzk" created="Sat, 26 Feb 2011 22:07:07 +0000"  >&lt;p&gt;added getRegionsInfo() and getRegionLocation() to thrift API.&lt;/p&gt;</comment>
                            <comment id="12999850" author="kzk" created="Sat, 26 Feb 2011 22:11:18 +0000"  >&lt;p&gt;The attached patch added two interfaces to Thrift api.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

  /**
   * Get all the regions and their address &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; a specified table.
   *
   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; A map of TRegionInfo with its server address
   */
  map&amp;lt;TRegionInfo, TServerAddress&amp;gt; getRegionsInfo(
    /** table name */
    1:Text tableName)
    &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; (1:IOError io)

  /**
   * Find the region on which given row is being served.
   *
   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Location of the row.
   */
  TRegionLocation getRegionLocation(
    /** table name */
    1:Text tableName,
    /** row key */
    2:Text row)
    &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; (1:IOError io)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I confirmed the behavior via Ruby program below.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
require &apos;rubygems&apos;
require &apos;thrift&apos;
require &apos;thrift/transport/socket&apos;
require &apos;thrift/transport/buffered_transport&apos;
require &apos;thrift/protocol/binary_protocol&apos;
require &apos;hbase&apos;
require &apos;hbase_types&apos;

socket = Thrift::Socket.&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;(&apos;localhost&apos;, 8181)
transport = Thrift::BufferedTransport.&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;(socket)
protocol = Thrift::BinaryProtocol.&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;(transport)
client = Apache::Hadoop::Hbase::Thrift::Hbase::Client.&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;(protocol)
transport.open();
begin
  p client.getTableNames()
  p client.compact(&lt;span class=&quot;code-quote&quot;&gt;&quot;sample&quot;&lt;/span&gt;)
  p client.getTableRegions(&lt;span class=&quot;code-quote&quot;&gt;&quot;sample&quot;&lt;/span&gt;)
  p client.getRegionsInfo(&lt;span class=&quot;code-quote&quot;&gt;&quot;sample&quot;&lt;/span&gt;)
  location = client.getRegionLocation(&lt;span class=&quot;code-quote&quot;&gt;&quot;sample&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;row0&quot;&lt;/span&gt;)
  p location.serverAddress.host
  p location.serverAddress.port  
ensure
  transport.close()
end
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ ruby client.rb
[&lt;span class=&quot;code-quote&quot;&gt;&quot;sample&quot;&lt;/span&gt;]
nil
[&amp;lt;Apache::Hadoop::Hbase::Thrift::TRegionInfo startKey:, endKey:, id:1294007944410, name:73616d706c652c2c313239343030373934343431302e35313633306364343333666431626532646339663831373537613332303234342e, version:0&amp;gt;]
{&amp;lt;Apache::Hadoop::Hbase::Thrift::TRegionInfo startKey:, endKey:, id:1294007944410, name:73616d706c652c2c313239343030373934343431302e35313633306364343333666431626532646339663831373537613332303234342e, version:0&amp;gt;=&amp;gt;&amp;lt;Apache::Hadoop::Hbase::Thrift::TServerAddress host:3139322e3136382e312e313030, port:53679&amp;gt;}
&lt;span class=&quot;code-quote&quot;&gt;&quot;192.168.1.100&quot;&lt;/span&gt;
53679
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One question here. The patch must include the files which are auto-generated by thrift. Currently, thrift uses version 0.2.0? Get the thrift below, and then generating the java-files are just fine?&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;http://www.apache.org/dist/incubator/thrift/0.2.0-incubating/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.apache.org/dist/incubator/thrift/0.2.0-incubating/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks Kazuki&lt;/p&gt;</comment>
                            <comment id="12999854" author="ryanobjc" created="Sat, 26 Feb 2011 22:59:45 +0000"  >&lt;p&gt;in a different jira stack is deprecating HServerAddress since it does little more than wrap InetSocketAddress (in an unhelpful way to boot!).  Given that move, do you think we could replace TSocketAddress with perhaps just String/Text?  &quot;foo:100&quot; is pretty standard and seems acceptable to me?&lt;/p&gt;</comment>
                            <comment id="12999908" author="kzk" created="Sun, 27 Feb 2011 09:11:41 +0000"  >&lt;p&gt;your plan is acceptable to me. Then, I&apos;ll change the interface like below.&lt;/p&gt;

&lt;p&gt;Just replace the TServerAddress with just Text in &quot;host:port&quot; format.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
struct TRegionLocation {
  1:TRegionInfo regionInfo,
  2:Text serverAddress
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
map&amp;lt;TRegionInfo, Text&amp;gt; getRegionsInfo(...)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13000030" author="stack" created="Sun, 27 Feb 2011 19:35:16 +0000"  >&lt;p&gt;Thanks Kazuki.  That looks good.&lt;/p&gt;</comment>
                            <comment id="13003483" author="kzk" created="Mon, 7 Mar 2011 18:12:37 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;changed for thrift-0.5.0&lt;/li&gt;
	&lt;li&gt;replace TServerAddress with Text&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13003486" author="kzk" created="Mon, 7 Mar 2011 18:13:58 +0000"  >&lt;p&gt;Patch updated. changed to thrift-0.5.0 for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3513&quot; title=&quot;upgrade thrift to 0.5.0 and use mvn version&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3513&quot;&gt;&lt;del&gt;HBASE-3513&lt;/del&gt;&lt;/a&gt; , and replace TServerAddress with Text.&lt;/p&gt;

&lt;p&gt;Could you check again?&lt;/p&gt;</comment>
                            <comment id="13005523" author="stack" created="Fri, 11 Mar 2011 06:53:52 +0000"  >&lt;p&gt;Kazuki.  Mind including the generated code too if its easy for you to do (Generated code has licenses on it too &amp;#8211; perhaps thats hard for you to figure?)?  Else, I&apos;ll try and figure it.&lt;/p&gt;</comment>
                            <comment id="13005524" author="stack" created="Fri, 11 Mar 2011 06:54:27 +0000"  >&lt;p&gt;Marking patch available against 0.92.&lt;/p&gt;</comment>
                            <comment id="13047543" author="stack" created="Fri, 10 Jun 2011 22:45:45 +0000"  >&lt;p&gt;Moving out of 0.92.0. Pull it back in if you think different.&lt;/p&gt;</comment>
                            <comment id="13047774" author="stack" created="Fri, 10 Jun 2011 23:44:09 +0000"  >&lt;p&gt;Pulling in again; has a patch available.&lt;/p&gt;</comment>
                            <comment id="13102119" author="stack" created="Sat, 10 Sep 2011 19:31:45 +0000"  >&lt;p&gt;+1 on the patch.&lt;/p&gt;

&lt;p&gt;Kazuki. Mind including the generated code too if its easy for you to do (Generated code has licenses on it too &#8211; perhaps thats hard for you to figure?)?&lt;/p&gt;</comment>
                            <comment id="13234838" author="lhofhansl" created="Wed, 21 Mar 2012 18:42:41 +0000"  >&lt;p&gt;What&apos;s holding this up?&lt;/p&gt;</comment>
                            <comment id="13235714" author="lhofhansl" created="Thu, 22 Mar 2012 16:52:15 +0000"  >&lt;p&gt;Moving to 0.96.&lt;/p&gt;</comment>
                            <comment id="13463683" author="xieliang007" created="Wed, 26 Sep 2012 10:14:42 +0000"  >&lt;p&gt;&quot;getRegionInfo&quot; function can be found on 0.94&amp;amp;0.96 codebase; This issue seems only exists on 0.92 and before.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12472077" name="HBASE3577-1.patch" size="5869" author="kzk" created="Sat, 26 Feb 2011 22:07:07 +0000"/>
                            <attachment id="12472837" name="HBASE3577-2.patch" size="5773" author="kzk" created="Mon, 7 Mar 2011 18:12:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 26 Feb 2011 22:59:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33097</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 12 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i00rmn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2408</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>