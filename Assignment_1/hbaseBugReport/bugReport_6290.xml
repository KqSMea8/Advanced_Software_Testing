<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:35:27 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6290/HBASE-6290.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6290] Add a function a mark a server as dead and start the recovery the process</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6290</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;ZooKeeper is used a a monitoring tool: we use znode and we start the recovery process when a znode is deleted by ZK because it got a timeout. This timeout is defaulted to 90 seconds, and often set to 30s&lt;/p&gt;

&lt;p&gt;However, some HW issues could be detected by specialized hw monitoring tools before the ZK timeout. For this reason, it makes sense to offer a very simple function to mark a RS as dead. This should not take in&lt;/p&gt;


&lt;p&gt;It could be a hbase shell function such as&lt;br/&gt;
considerAsDead ipAddress|serverName&lt;/p&gt;

&lt;p&gt;This would delete all the znodes of the server running on this box, starting the recovery process.&lt;/p&gt;


&lt;p&gt;Such a function would be easily callable (at callers risk) by any fault detection tool... We could have issues to identify the right master &amp;amp; region servers around ipv4 vs ipv6 vs and multi networked boxes however.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12596276">HBASE-6290</key>
            <summary>Add a function a mark a server as dead and start the recovery the process</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="talat">Talat UYARER</assignee>
                                    <reporter username="nkeywal">Nicolas Liochon</reporter>
                        <labels>
                            <label>beginner</label>
                    </labels>
                <created>Thu, 28 Jun 2012 16:39:33 +0000</created>
                <updated>Mon, 29 Sep 2014 19:22:10 +0000</updated>
                            <resolved>Mon, 29 Sep 2014 17:23:56 +0000</resolved>
                                    <version>0.95.2</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>monitoring</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13403207" author="stack" created="Thu, 28 Jun 2012 16:45:58 +0000"  >&lt;p&gt;What would the shell invocation do?  Connect to a RS and call its shutdown or shutdown + kill znode?  What are you thinking would use this new facility (It sounds like a good thing to have.  Would be good to list possible users).&lt;/p&gt;</comment>
                            <comment id="13409675" author="nkeywal" created="Mon, 9 Jul 2012 17:46:58 +0000"  >&lt;p&gt;@stack We should try to connect the RS, someone we trust told us it was dead. Or if we try it should be with a minimum timeout (if not, out socket timeout will be longer than the zookeeper timeout). So the shell command should just clean the znode associated to an IP.&lt;/p&gt;

&lt;p&gt;It could also be in ZK, or very strongly linked to ZK if we can: if the API allows it, get the session associated to this IP and expire them. We know it&apos;s easy to expire a session &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="13411545" author="stack" created="Wed, 11 Jul 2012 14:13:55 +0000"  >&lt;p&gt;Sounds good.&lt;/p&gt;</comment>
                            <comment id="13411560" author="nkeywal" created="Wed, 11 Jul 2012 14:26:56 +0000"  >&lt;p&gt;For ZK, there is nothing to get the sessions/expire in the 3.4 API. But iterating on the znodes and deleting them is ok. &lt;/p&gt;</comment>
                            <comment id="13641529" author="nkeywal" created="Thu, 25 Apr 2013 07:37:35 +0000"  >&lt;p&gt;From what I understand here: &lt;a href=&quot;http://tsunanet.net/~tsuna/fsf-hbase-meetup-april13.pdf&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://tsunanet.net/~tsuna/fsf-hbase-meetup-april13.pdf&lt;/a&gt;, it&apos;s possible with Arista HW, and their hw can execute a shell script when the failure is detected; so it seems it would work. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tsuna&quot; class=&quot;user-hover&quot; rel=&quot;tsuna&quot;&gt;Benoit Sigoure&lt;/a&gt;, do you confirm? I&apos;m going to propose an API to mark a node as stale HDFS, that could be used as well?&lt;/p&gt;</comment>
                            <comment id="13641541" author="tsuna" created="Thu, 25 Apr 2013 07:52:19 +0000"  >&lt;p&gt;Yes, that&apos;s right.  It would be great to have this sort of kill switch, both at the HBase level, as well as HDFS.  The feature I presented works especially well to tell all interested parties (clients) that the node they&apos;re trying to reach is dead, but often it doesn&apos;t help time out the node out of the cluster, e.g. in HDFS or MapReduce, the NameNode and JobTracker will ignore TCP resets and will not flag the node as really dead until some long pre-configured timeout elapses.&lt;/p&gt;</comment>
                            <comment id="14076904" author="stack" created="Mon, 28 Jul 2014 21:22:56 +0000"  >&lt;p&gt;Now we are actively trying to hide our dependency on zk, we should put the delete of znodes on other side of an Interface with default implementation being zk-based doing the znode delete &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; describes above.&lt;/p&gt;

&lt;p&gt;Keep in mind, we might want to also do a kill compaction on same method... so a kill switch that can kill server and kill compactions?&lt;/p&gt;</comment>
                            <comment id="14137003" author="talat" created="Wed, 17 Sep 2014 09:40:41 +0000"  >&lt;p&gt;Finally I finished my works about this issue. Now it can take only server name. I did not find how to get server name from ip address. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; can you review it ? &lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="14140028" author="stack" created="Fri, 19 Sep 2014 05:43:15 +0000"  >&lt;p&gt;Minor fix up.  Add that we can pass --config, fixed copyright, added more to the usage, made it clear that we are outputting found hosts when no args passed.&lt;/p&gt;

&lt;p&gt;Nice script.&lt;/p&gt;</comment>
                            <comment id="14140032" author="stack" created="Fri, 19 Sep 2014 05:45:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; What you think of &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=talat&quot; class=&quot;user-hover&quot; rel=&quot;talat&quot;&gt;Talat UYARER&lt;/a&gt;&apos;s script?  I tried it and seems to do as you suggest.  Could be useful ops tool.&lt;/p&gt;</comment>
                            <comment id="14151921" author="stack" created="Mon, 29 Sep 2014 17:23:56 +0000"  >&lt;p&gt;Committed to master.  Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=talat&quot; class=&quot;user-hover&quot; rel=&quot;talat&quot;&gt;Talat UYARER&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14151951" author="stack" created="Mon, 29 Sep 2014 17:48:32 +0000"  >&lt;p&gt;Committed this documentation addendum to master branch.&lt;/p&gt;</comment>
                            <comment id="14152118" author="hudson" created="Mon, 29 Sep 2014 19:22:10 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5572 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5572/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5572/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6290&quot; title=&quot;Add a function a mark a server as dead and start the recovery the process&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6290&quot;&gt;&lt;del&gt;HBASE-6290&lt;/del&gt;&lt;/a&gt; Add a function a mark a server as dead and start the recovery the process (Talat Uyarer) (stack: rev 4be3cf8fec8390c4129fa037b63718e84db01656)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;bin/considerAsDead.sh&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6290&quot; title=&quot;Add a function a mark a server as dead and start the recovery the process&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6290&quot;&gt;&lt;del&gt;HBASE-6290&lt;/del&gt;&lt;/a&gt; Add a function a mark a server as dead and start the recovery the process (Talat Uyarer) (stack: rev 8e5aad43a2fbde2aac6aff6dd01582933bd8db9b)&lt;/li&gt;
	&lt;li&gt;bin/considerAsDead.sh&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6290&quot; title=&quot;Add a function a mark a server as dead and start the recovery the process&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6290&quot;&gt;&lt;del&gt;HBASE-6290&lt;/del&gt;&lt;/a&gt; Add a function a mark a server as dead and start the recovery the process (Talat Uyarer) DOC ADDENDUM (stack: rev 82bb37070379bb8e135ee566589e8e348e0bdd78)&lt;/li&gt;
	&lt;li&gt;src/main/docbkx/ops_mgt.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12551766">HBASE-5843</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12671829" name="6290.doc.addendum.txt" size="1503" author="stack" created="Mon, 29 Sep 2014 17:48:32 +0000"/>
                            <attachment id="12669923" name="6290v2.txt" size="2352" author="stack" created="Fri, 19 Sep 2014 05:43:15 +0000"/>
                            <attachment id="12669375" name="HBASE-6290.patch" size="2228" author="talat" created="Wed, 17 Sep 2014 09:40:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 28 Jun 2012 16:45:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241869</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 11 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02fcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12088</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Adds a script to mark a server as dead.&lt;br/&gt;
&lt;br/&gt;
Usage: considerAsDead.sh --hostname serverName</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>beginner</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>