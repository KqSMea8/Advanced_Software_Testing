<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:18:30 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4391/HBASE-4391.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4391] Add ability to start RS as root and call mlockall</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4391</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;A common issue we&apos;ve seen in practice is that users oversubscribe their region servers with too many MR tasks, etc. As soon as the machine starts swapping, the RS grinds to a halt, loses ZK session, aborts, etc.&lt;/p&gt;

&lt;p&gt;This can be combatted by starting the RS as root, calling mlockall(), and then setuid down to the hbase user. We should not require this, but we should provide it as an option.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12522957">HBASE-4391</key>
            <summary>Add ability to start RS as root and call mlockall</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mbertozzi">Matteo Bertozzi</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Sep 2011 21:16:06 +0000</created>
                <updated>Thu, 24 Apr 2014 15:56:25 +0000</updated>
                            <resolved>Sun, 19 Aug 2012 21:00:21 +0000</resolved>
                                    <version>0.94.0</version>
                                    <fixVersion>0.95.0</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                <comments>
                            <comment id="13104074" author="tlipcon" created="Tue, 13 Sep 2011 23:15:12 +0000"  >&lt;p&gt;I&apos;ve put an initial implementation of a JVMTI agent that accomplishes this here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/toddlipcon/mlockall_agent&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/toddlipcon/mlockall_agent&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It can be compiled using the &quot;compile.sh&quot; script in the repo, and then configured like so in hbase-env.sh:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
export HBASE_REGIONSERVER_OPTS=&lt;span class=&quot;code-quote&quot;&gt;&quot;$HBASE_REGIONSERVER_OPTS -agentpath:/home/todd/git/libmlockall_agent/libmlockall_agent.so=user=todd&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After which point you must run the regionserver as root:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

todd@todd-w510:~/git/hbase$ ./bin/hbase regionserver 
mlockall_agent: Unable to boost memlock resource limit: Operation not permitted
mlockall_agent: (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; may be because java was not run as root!)
Error occurred during initialization of VM
agent library failed to init: /home/todd/git/libmlockall_agent/libmlockall_agent.so
todd@todd-w510:~/git/hbase$ sudo ./bin/hbase regionserver 
mlockall_agent: Successfully locked memory and setuid to todd
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Perhaps some other people can check this out, and if it looks generally useful we could either build it along with HBase or at least point to it from docs?&lt;/p&gt;</comment>
                            <comment id="13234610" author="lhofhansl" created="Wed, 21 Mar 2012 18:01:48 +0000"  >&lt;p&gt;Moving out of 0.94, pull back if feel otherwise.&lt;/p&gt;</comment>
                            <comment id="13290307" author="mbertozzi" created="Wed, 6 Jun 2012 18:08:58 +0000"  >&lt;p&gt;todd&apos;s code looks good to me.&lt;/p&gt;

&lt;p&gt;One way to avoid using root to start the RS is adding hbase user to /etc/security/limits.d/&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;echo &lt;span class=&quot;code-quote&quot;&gt;&quot;$USER - memlock $MAX_MEMLOCK_SIZE&quot;&lt;/span&gt; &amp;gt;/etc/security/limits.d/$USER.conf&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If this will be integrated in hbase, do you want to force everyone to use root or add hbase user in limits.d to start RS? or we can add some --no-swap flag to region server start script?&lt;/p&gt;</comment>
                            <comment id="13292360" author="mbertozzi" created="Sat, 9 Jun 2012 15:22:24 +0000"  >&lt;p&gt;Something like this? where you can start hbase scripts with --mlock user=hbase to enable the mlock agent? &lt;/p&gt;</comment>
                            <comment id="13292381" author="apurtell" created="Sat, 9 Jun 2012 16:43:35 +0000"  >&lt;p&gt;If we want to approximate the way Hadoop core includes and builds native bits, the source layout could be more like:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hbase-server/src/main/native/
  configure scripts
  m4/
  src/
    mlockall_agent/
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13292975" author="enis" created="Mon, 11 Jun 2012 18:49:15 +0000"  >&lt;p&gt;I&apos;ve seen smt similar in accumulo code base: &lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/accumulo/trunk/server/src/main/c%2B%2B/mlock/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/accumulo/trunk/server/src/main/c%2B%2B/mlock/&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/accumulo/trunk/server/src/main/java/org/apache/accumulo/server/tabletserver/MLock.java?view=log&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/accumulo/trunk/server/src/main/java/org/apache/accumulo/server/tabletserver/MLock.java?view=log&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13294622" author="mbertozzi" created="Wed, 13 Jun 2012 19:01:30 +0000"  >&lt;p&gt;Accumulo has a &quot;tserver.memory.lock&quot; property used to enable mlock in TabletServer. At startup the property is read and if true mlockall() is called.&lt;/p&gt;

&lt;p&gt;Different approach but the result is the same... the Todd proposed solution is external from the RegionServer code (and maybe can be integrated in hadoop-common to be used by datanode &amp;amp; co without changing the hdfs code), the accumulo one is integrated in the tablet code...&lt;/p&gt;</comment>
                            <comment id="13295276" author="stack" created="Thu, 14 Jun 2012 20:04:08 +0000"  >&lt;p&gt;@Matteo What about Andrew&apos;s suggested location for the src and native bits?  Whats it like when we add compile of mlockall to our compile goal in mvn?  Is it fast?  On this question:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If this will be integrated in hbase, do you want to force everyone to use root or add hbase user in limits.d to start RS? or we can add some --no-swap flag to region server start script?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We cannot require you be root to start hbase.  It looks like this not necessary anyways?  If you want the mlockall facility, then you can require folks be root (or do you security.conf trick).&lt;/p&gt;

&lt;p&gt;The Todd trick is nice as is your tidy up.  Thanks.&lt;/p&gt;</comment>
                            <comment id="13295951" author="mbertozzi" created="Fri, 15 Jun 2012 22:10:35 +0000"  >&lt;p&gt;Moved to src/main/native as Andrew suggested&lt;/p&gt;</comment>
                            <comment id="13400142" author="mbertozzi" created="Sun, 24 Jun 2012 12:33:14 +0000"  >&lt;p&gt;Added profile &quot;native&quot; (-Pnative) to turn on and off the compilation of the mlock agent.&lt;/p&gt;

&lt;p&gt;hbase --mlock user=hbase regionserver start&lt;/p&gt;</comment>
                            <comment id="13400149" author="hadoopqa" created="Sun, 24 Jun 2012 13:28:46 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12533217/HBASE-4391-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12533217/HBASE-4391-v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 11 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestSplitLogManager&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2239//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2239//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2239//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2239//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2239//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2239//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2239//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2239//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13400156" author="zhihyu@ebaysf.com" created="Sun, 24 Jun 2012 14:19:10 +0000"  >&lt;p&gt;Can you add some comment near the beginning of mlockall_agent.c for what it does ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    LOG(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to setuid: specify a target username as the agent option user=&amp;lt;username&amp;gt;\n&quot;&lt;/span&gt;);
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;(1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should different exit code be used to distinguish the error scenarios ?&lt;/p&gt;

&lt;p&gt;compile.sh isn&apos;t in repo. Please update release notes on how this feature is compiled and used.&lt;/p&gt;</comment>
                            <comment id="13400158" author="mbertozzi" created="Sun, 24 Jun 2012 14:35:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;compile.sh isn&apos;t in repo. Please update release notes on how this feature is compiled and used.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Do you mean in the patch? or todd&apos;s repo?&lt;br/&gt;
The attached patch has a new &quot;native&quot; profile added, that allows to compile the mlock_agent, and if you in your HBASE_HOME/ you&apos;ve a native/ folder that contains the .so and if you specify the --mlock &amp;lt;ARG&amp;gt; options it checks if native/libmlock_agent.so is available or not.&lt;/p&gt;</comment>
                            <comment id="13400159" author="zhihyu@ebaysf.com" created="Sun, 24 Jun 2012 14:47:33 +0000"  >&lt;p&gt;I was able to get the following with &apos;mvn -Pnative package -DskipTests&apos;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
./target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/CMakeFiles/mlockall_agent.dir
./target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/CMakeFiles/mlockall_agent.dir/src/mlockall_agent
./target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/CMakeFiles/mlockall_agent.dir/src/mlockall_agent/mlockall_agent.c.o
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;How do I build the .so ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13400161" author="mbertozzi" created="Sun, 24 Jun 2012 14:54:07 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ mvn &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; -DskipTests -Pnative
$ ls ./hbase-server/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/libmlockall_agent.so
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or if you use assembly:assembly&lt;br/&gt;
in ./target/hbase-0.95-SNAPSHOT.tar.gz &lt;br/&gt;
under hbase-0.95-SNAPSHOT/native folder there&apos;s the libmlockall_agent.so&lt;/p&gt;</comment>
                            <comment id="13400166" author="zhihyu@ebaysf.com" created="Sun, 24 Jun 2012 15:30:03 +0000"  >&lt;p&gt;I built on MacBook. I guess the following is the equivalent:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-rwxr-xr-x   1 zhihyu  110088321  13320 Jun 24 07:41 libmlockall_agent.dylib
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13400167" author="mbertozzi" created="Sun, 24 Jun 2012 15:34:23 +0000"  >&lt;p&gt;Yeah .dylib is the equivalent to .so&lt;br/&gt;
but I&apos;ve hardcoded .so in the bin/ and assembly script &lt;br/&gt;
any idea to pick the right one?&lt;/p&gt;

&lt;p&gt;(Do we need to support this on mac? you can always load by it hand as explained by todd)&lt;/p&gt;</comment>
                            <comment id="13400168" author="zhihyu@ebaysf.com" created="Sun, 24 Jun 2012 15:42:31 +0000"  >&lt;p&gt;I don&apos;t think we need to support Mac.&lt;/p&gt;</comment>
                            <comment id="13400173" author="hadoopqa" created="Sun, 24 Jun 2012 15:58:06 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12533220/HBASE-4391-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12533220/HBASE-4391-v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 11 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestServerCustomProtocol&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2241//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2241//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2241//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2241//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2241//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2241//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2241//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2241//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13400177" author="zhihyu@ebaysf.com" created="Sun, 24 Jun 2012 16:16:53 +0000"  >&lt;p&gt;Patch v4 corrects some grammatical errors.&lt;/p&gt;</comment>
                            <comment id="13400178" author="zhihyu@ebaysf.com" created="Sun, 24 Jun 2012 16:20:58 +0000"  >&lt;p&gt;Patch v4 integrated to trunk.&lt;/p&gt;

&lt;p&gt;Thanks for the initiative, Todd.&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Matteo.&lt;/p&gt;</comment>
                            <comment id="13400192" author="hudson" created="Sun, 24 Jun 2012 18:23:43 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3064 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3064/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3064/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4391&quot; title=&quot;Add ability to start RS as root and call mlockall&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4391&quot;&gt;&lt;del&gt;HBASE-4391&lt;/del&gt;&lt;/a&gt; Add ability to start RS as root and call mlockall (Matteo Bertozzi) (Revision 1353289)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/bin/hbase-config.sh&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/pom.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native/CMakeLists.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native/src&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native/src/mlockall_agent&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native/src/mlockall_agent/mlockall_agent.c&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/assembly/all.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13400231" author="hudson" created="Sun, 24 Jun 2012 23:54:27 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #67 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/67/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/67/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4391&quot; title=&quot;Add ability to start RS as root and call mlockall&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4391&quot;&gt;&lt;del&gt;HBASE-4391&lt;/del&gt;&lt;/a&gt; Add ability to start RS as root and call mlockall (Matteo Bertozzi) (Revision 1353289)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/bin/hbase-config.sh&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/pom.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native/CMakeLists.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native/src&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native/src/mlockall_agent&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/native/src/mlockall_agent/mlockall_agent.c&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/assembly/all.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13616626" author="stack" created="Thu, 28 Mar 2013 20:42:03 +0000"  >&lt;p&gt;I added a note under the hbase tools section on this facility.&lt;/p&gt;</comment>
                            <comment id="13775354" author="stack" created="Mon, 23 Sep 2013 18:31:19 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                                                <inwardlinks description="is superceded by">
                                        <issuelink>
            <issuekey id="12603274">HBASE-6567</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12533224" name="4391-v4.patch" size="9653" author="zhihyu@ebaysf.com" created="Sun, 24 Jun 2012 16:16:53 +0000"/>
                            <attachment id="12531566" name="HBASE-4391-v0.patch" size="25056" author="mbertozzi" created="Sat, 9 Jun 2012 15:22:24 +0000"/>
                            <attachment id="12532246" name="HBASE-4391-v1.patch" size="24355" author="mbertozzi" created="Fri, 15 Jun 2012 22:10:35 +0000"/>
                            <attachment id="12533217" name="HBASE-4391-v2.patch" size="9125" author="mbertozzi" created="Sun, 24 Jun 2012 12:33:14 +0000"/>
                            <attachment id="12533220" name="HBASE-4391-v3.patch" size="9647" author="mbertozzi" created="Sun, 24 Jun 2012 15:02:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 21 Mar 2012 18:01:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33528</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02gqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12312</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>A new profile, native, has been added to pom.xml  Adding &amp;#39;-Pnative&amp;#39; will build libmlockall_agent.so   HBase will look for the .so under  ./lib/native/PLATFORM (See JAVA_LIBRARY_PATH in the bin/hbase starup script).&lt;br/&gt;
&lt;br/&gt;
mlockall_agent is a simple VM Agent that allows to lock the address space of &lt;br/&gt;
the region server process. This avoids the process&amp;#39; memory eviction under pressure.&lt;br/&gt;
&lt;br/&gt;
You can load the agent by adding it as a jvm option:&lt;br/&gt;
&amp;nbsp;export HBASE_REGIONSERVER_OPTS=&amp;quot;-agentpath:./libmlockall_agent.so=user=hbase&amp;quot;&lt;br/&gt;
&lt;br/&gt;
To use this feature, execute the following command as root:&lt;br/&gt;
hbase --mlock user=hbase regionserver start</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.96notable</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>