<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:06:58 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3053/HBASE-3053.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3053] Add ability to have multiple Masters LocalHBaseCluster for test writing</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3053</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Should expose some methods like getActiveMaster() and isActiveMaster() as well as a simple way to kill an individual master / kill the active master.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12475459">HBASE-3053</key>
            <summary>Add ability to have multiple Masters LocalHBaseCluster for test writing</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="streamy">Jonathan Gray</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Sep 2010 23:42:32 +0000</created>
                <updated>Fri, 20 Nov 2015 12:40:52 +0000</updated>
                            <resolved>Wed, 6 Oct 2010 21:41:44 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                    <component>master</component>
                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12916328" author="hbasereviewboard" created="Thu, 30 Sep 2010 00:51:41 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-09-29 17:39:07.962079)&lt;/p&gt;


&lt;p&gt;Review request for hbase, stack, Karthik Ranganathan, and Kannan Muthukkaruppan.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Whitespace cleanup&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Also exposes methods to get the currently active master and can access each individually in the same way that it&apos;s done for multiple RS.&lt;/p&gt;

&lt;p&gt;This is mostly duplicating what we do for RS but for masters.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3053&quot; title=&quot;Add ability to have multiple Masters LocalHBaseCluster for test writing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3053&quot;&gt;&lt;del&gt;HBASE-3053&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3053&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3053&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 1002883 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 1002883 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/925/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Untested but compiles.  This is first go at a patch.  I&apos;m going to work on writing a new unit test that uses this next.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;

</comment>
                            <comment id="12916330" author="hbasereviewboard" created="Thu, 30 Sep 2010 00:54:37 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase, stack, Karthik Ranganathan, and Kannan Muthukkaruppan.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Also exposes methods to get the currently active master and can access each individually in the same way that it&apos;s done for multiple RS.&lt;/p&gt;

&lt;p&gt;This is mostly duplicating what we do for RS but for masters.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3053&quot; title=&quot;Add ability to have multiple Masters LocalHBaseCluster for test writing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3053&quot;&gt;&lt;del&gt;HBASE-3053&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3053&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3053&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 1002883 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 1002883 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/925/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Untested but compiles.  This is first go at a patch.  I&apos;m going to work on writing a new unit test that uses this next.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;

</comment>
                            <comment id="12916353" author="hbasereviewboard" created="Thu, 30 Sep 2010 03:00:05 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-09-29 19:40:41.579973)&lt;/p&gt;


&lt;p&gt;Review request for hbase, stack, Karthik Ranganathan, and Kannan Muthukkaruppan.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Adds some more methods into MiniHBaseCluster.&lt;/p&gt;

&lt;p&gt;Adds a new unit test, TestMultipleMasters.&lt;/p&gt;

&lt;p&gt;All the existing unit tests I ran seem to work fine, but TestMultipleMasters does not work right.  Once the second master gets to where he sees there is another master and then blocks waiting, nothing proceeds.  Not really sure what&apos;s up yet.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Also exposes methods to get the currently active master and can access each individually in the same way that it&apos;s done for multiple RS.&lt;/p&gt;

&lt;p&gt;This is mostly duplicating what we do for RS but for masters.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3053&quot; title=&quot;Add ability to have multiple Masters LocalHBaseCluster for test writing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3053&quot;&gt;&lt;del&gt;HBASE-3053&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3053&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3053&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 1002883 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java 1002883 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 1002883 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/master/TestMultipleMasters.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/925/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Untested but compiles.  This is first go at a patch.  I&apos;m going to work on writing a new unit test that uses this next.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;

</comment>
                            <comment id="12916354" author="hbasereviewboard" created="Thu, 30 Sep 2010 03:03:58 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/#review1361&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#review1361&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Ah, well the blocking happens in the constructor, so the test launcher just sticks on the first master which blocks in the constructor.&lt;/p&gt;

&lt;p&gt;Could we move everything from the constructor into run()?  At least the stuff that blocks / after the blocking (which is almost everything)?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jonathan&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12916357" author="hbasereviewboard" created="Thu, 30 Sep 2010 03:26:21 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-09-29 19:56:56.581133)&lt;/p&gt;


&lt;p&gt;Review request for hbase, stack, Karthik Ranganathan, and Kannan Muthukkaruppan.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Moved stuff out of the constructor and into run().  Now all three masters start but then it freezes on something else.&lt;/p&gt;

&lt;p&gt;Pardon the &quot;\n\n\n DEBUG! \n\n\n&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Also exposes methods to get the currently active master and can access each individually in the same way that it&apos;s done for multiple RS.&lt;/p&gt;

&lt;p&gt;This is mostly duplicating what we do for RS but for masters.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3053&quot; title=&quot;Add ability to have multiple Masters LocalHBaseCluster for test writing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3053&quot;&gt;&lt;del&gt;HBASE-3053&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3053&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3053&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java 1002883 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 1002883 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java 1002883 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 1002883 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/master/TestMultipleMasters.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/925/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Untested but compiles.  This is first go at a patch.  I&apos;m going to work on writing a new unit test that uses this next.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;

</comment>
                            <comment id="12916373" author="hbasereviewboard" created="Thu, 30 Sep 2010 04:29:25 +0000"  >&lt;p&gt;Message from: stack@duboce.net&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/#review1362&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#review1362&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Seems fine so far.  isOnline seems OTT.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;stack&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12916380" author="tlipcon" created="Thu, 30 Sep 2010 05:35:38 +0000"  >&lt;p&gt;This is probably going to conflict a lot with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2993&quot; title=&quot;Refactor servers to use a common lifecycle interface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2993&quot;&gt;&lt;del&gt;HBASE-2993&lt;/del&gt;&lt;/a&gt; - any chance you&apos;re interested in merging the work together, Jon? If not, I can redo the 2993 stuff after this goes in (unfortunately don&apos;t have a lot of time til mid-October)&lt;/p&gt;</comment>
                            <comment id="12916388" author="streamy" created="Thu, 30 Sep 2010 06:21:15 +0000"  >&lt;p&gt;I&apos;m mostly in a race to finish testing the new master.  I like the work over there but just want to get to multiple master unit testing asap.&lt;/p&gt;

&lt;p&gt;Happy to help however I can in that same timeframe, after HW.  It will definitely clean things up.&lt;/p&gt;</comment>
                            <comment id="12916564" author="tlipcon" created="Thu, 30 Sep 2010 17:14:41 +0000"  >&lt;p&gt;Sounds good. We&apos;ll postpone &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2993&quot; title=&quot;Refactor servers to use a common lifecycle interface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2993&quot;&gt;&lt;del&gt;HBASE-2993&lt;/del&gt;&lt;/a&gt; til then. Thanks!&lt;/p&gt;</comment>
                            <comment id="12916962" author="hbasereviewboard" created="Fri, 1 Oct 2010 17:32:20 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-10-01 10:00:03.133377)&lt;/p&gt;


&lt;p&gt;Review request for hbase, stack, Karthik Ranganathan, and Kannan Muthukkaruppan.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Adds TestMasterFailover which passes!  Starts cluster w/ 3 masters.  Stops a backup master, then stops the active master, and verifies the other backup becomes the active master.  Doesn&apos;t test w/ tables/data or regions-in-transition but the test framework improvements work.&lt;/p&gt;

&lt;p&gt;A few things that were changed:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;can now close backup masters&lt;/li&gt;
	&lt;li&gt;can now close active master w/o shutting down cluster&lt;/li&gt;
	&lt;li&gt;regionserver reconnects to new master when fail over&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Also exposes methods to get the currently active master and can access each individually in the same way that it&apos;s done for multiple RS.&lt;/p&gt;

&lt;p&gt;This is mostly duplicating what we do for RS but for masters.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3053&quot; title=&quot;Add ability to have multiple Masters LocalHBaseCluster for test writing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3053&quot;&gt;&lt;del&gt;HBASE-3053&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3053&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3053&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java 1003327 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java 1003327 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java 1003327 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java 1003327 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1003327 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 1003327 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperWatcher.java 1003327 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java 1003327 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 1003327 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/925/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Untested but compiles.  This is first go at a patch.  I&apos;m going to work on writing a new unit test that uses this next.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;

</comment>
                            <comment id="12917059" author="hbasereviewboard" created="Fri, 1 Oct 2010 22:08:44 +0000"  >&lt;p&gt;Message from: stack@duboce.net&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/#review1378&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#review1378&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;This is great. Follows the ugly pattern that was in place for RSs.  Just some comments below... see what you think.&lt;/p&gt;


&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4564&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4564&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This needs to be data member?  Its not just used once locally?&lt;/p&gt;



&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4565&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4565&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why do this in constructor?  Why not declare and allocate at same time?&lt;/p&gt;



&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4566&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4566&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    No biggie but I like the previous syntax&lt;/p&gt;



&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4567&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4567&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Can you read this from zk instead?&lt;/p&gt;



&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4568&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4568&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Go ahead and remove it.  It used to be used figuring if fresh startup but now its just logged to help debugging what state was like on master startup.&lt;/p&gt;



&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4569&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4569&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    No need for this comment.  CHeck the javadoc on this method.  It used to be detailed steps IIRC.  The detail no longer is correct.&lt;/p&gt;



&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4570&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4570&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Yeah, this 3. is a bit odd in here w/o its 1. and 2.&lt;/p&gt;



&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4571&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4571&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Does this if span too much?  Could you test stopped before calling initialization?  loop already does stopped?&lt;/p&gt;



&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4572&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4572&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    What services are started in teh constructor now?&lt;/p&gt;



&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4575&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4575&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Do we lose messages here?  Important we not drop split, etc.  FYI, we need to do some more thought around split message and master failover. See over in master where we register servers on region server report for note.&lt;/p&gt;



&lt;p&gt;trunk/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4576&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4576&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Yeah, whats this about?&lt;/p&gt;



&lt;p&gt;trunk/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment4577&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment4577&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    How about a test where there are RIT and master joins and assertion it does the fixup?&lt;/p&gt;

&lt;p&gt;    There is white space above the &apos;yay&apos;.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;stack&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12918371" author="hbasereviewboard" created="Wed, 6 Oct 2010 01:25:58 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-10-05 18:15:55.818277)&lt;/p&gt;


&lt;p&gt;Review request for hbase, stack, Karthik Ranganathan, and Kannan Muthukkaruppan.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Incorporates changes from stack review.&lt;/p&gt;

&lt;p&gt;Test itself is the same.  I&apos;d like to get this committed and then will work on more tests as a separate JIRA.  The changes to HMaster and HRS are hard to keep up to date with trunk and I&apos;ll be doing more tests w/ this stuff over the next two weeks.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Also exposes methods to get the currently active master and can access each individually in the same way that it&apos;s done for multiple RS.&lt;/p&gt;

&lt;p&gt;This is mostly duplicating what we do for RS but for masters.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3053&quot; title=&quot;Add ability to have multiple Masters LocalHBaseCluster for test writing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3053&quot;&gt;&lt;del&gt;HBASE-3053&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3053&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3053&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperWatcher.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/925/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Untested but compiles.  This is first go at a patch.  I&apos;m going to work on writing a new unit test that uses this next.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;

</comment>
                            <comment id="12918381" author="hbasereviewboard" created="Wed, 6 Oct 2010 01:42:26 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java, line 65&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13275#file13275line65&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13275#file13275line65&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     This needs to be data member?  Its not just used once locally?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I copied from same way it&apos;s done for RS.  It is used in constructor and then also in addMaster() method which is public and can be called by a client after initialization.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java, line 141&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13275#file13275line141&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13275#file13275line141&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Why do this in constructor?  Why not declare and allocate at same time?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Again, copied from how it&apos;s done for RSs.  Can move it into the declaration for both.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java, line 224&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13275#file13275line224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13275#file13275line224&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     No biggie but I like the previous syntax&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Me too.  I was smacked two years ago doing one-line ifs and such, told that HBase form was to always have braces.  I had my IDE setup to not allow the former but have changed it now to permit one liners like this (when I hit code cleanup, it did this automatically).  Will revert.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java, line 267&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13275#file13275line267&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13275#file13275line267&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Can you read this from zk instead?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, but I don&apos;t think that would be very useful for unit tests since you&apos;d be relying on correct behavior/interaction of masters w/ ZK.  The way this is done is super simple... when a master becomes active, it flips a boolean.  My thought was to try and make this as fool proof as possible.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java, line 217&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13276#file13276line217&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13276#file13276line217&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     No need for this comment.  CHeck the javadoc on this method.  It used to be detailed steps IIRC.  The detail no longer is correct.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Revamped all comments.  Check next diff.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java, line 322&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13276#file13276line322&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13276#file13276line322&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Does this if span too much?  Could you test stopped before calling initialization?  loop already does stopped?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The if is immediately after we break out of blocking to become the active master.  This check is for the case where we are backup master but then we are being shutdown.  We get interrupted from blocking on becoming master, then we do this check.  What is inside the if{} is the stuff we don&apos;t want to run (only run if you are actually active master).  The stuff below the if is the stuff that is run in both cases of a master shutdown (backup master being shutdown, or active master being shutdown in master or cluster shutdown).&lt;/p&gt;

&lt;p&gt;Not the prettiest, tried a couple ways, but this ended up being simplest.  Will add some comments.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java, line 345&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13276#file13276line345&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13276#file13276line345&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     What services are started in teh constructor now?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Changed comment.  It&apos;s services that are started whether backup or active master.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java, line 674&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13278#file13278line674&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13278#file13278line674&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Do we lose messages here?  Important we not drop split, etc.  FYI, we need to do some more thought around split message and master failover. See over in master where we register servers on region server report for note.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Shouldn&apos;t be any different than before.  If we get IOE, we wouldn&apos;t have any messages returned from the method.&lt;/p&gt;

&lt;p&gt;Agree we need to more thought on this.  Why piggyback this on heartbeat?  Maybe direct RPC and master can return something that says success?  If fail, then it&apos;ll retry from RS?&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java, line 133&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13283#file13283line133&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13283#file13283line133&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     How about a test where there are RIT and master joins and assertion it does the fixup?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     There is white space above the &apos;yay&apos;.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s the plan.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-01 14:44:53, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; trunk/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java, line 86&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/diff/5/?file=13283#file13283line86&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff/5/?file=13283#file13283line86&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Yeah, whats this about?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Will try and get rid of it all.  The test is just a first go.  I&apos;d like to get this committed because HMaster and HRS keep changing and I have to rebase the changes.&lt;/p&gt;

&lt;p&gt;So I&apos;m looking for a +1 to commit to get the changes in and then I&apos;ll continue working on fancier tests with this stuff.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jonathan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/#review1378&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#review1378&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="12918647" author="hbasereviewboard" created="Wed, 6 Oct 2010 20:03:17 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-10-06 12:45:19.045732)&lt;/p&gt;


&lt;p&gt;Review request for hbase, stack, Karthik Ranganathan, and Kannan Muthukkaruppan.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Removes all the sleeps from the test.  Adds a new &apos;isReady&apos; flag into HMaster so we know when it has finished doing initialization.  There is now an &apos;isActive()&apos; and &apos;isReady()&apos; which can be used to determine when the cluster/failover has been completed.  Exposes a method in MiniHBaseCluster called waitForActiveAndReadyMaster() which blocks until one of the masters becomes active and finish initializing.  That method can be interrupted and will also return false if there are no masters running at all.&lt;/p&gt;

&lt;p&gt;Cleans up a little logging and comments as well.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Also exposes methods to get the currently active master and can access each individually in the same way that it&apos;s done for multiple RS.&lt;/p&gt;

&lt;p&gt;This is mostly duplicating what we do for RS but for masters.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3053&quot; title=&quot;Add ability to have multiple Masters LocalHBaseCluster for test writing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3053&quot;&gt;&lt;del&gt;HBASE-3053&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3053&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3053&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperWatcher.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/925/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Untested but compiles.  This is first go at a patch.  I&apos;m going to work on writing a new unit test that uses this next.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;

</comment>
                            <comment id="12918698" author="streamy" created="Wed, 6 Oct 2010 21:39:52 +0000"  >&lt;p&gt;Final version of patch that was committed.&lt;/p&gt;</comment>
                            <comment id="12918699" author="streamy" created="Wed, 6 Oct 2010 21:41:44 +0000"  >&lt;p&gt;Thanks for the good reviews stack.  Committed to trunk.&lt;/p&gt;

&lt;p&gt;Unit tests now support multiple masters.  You can set the number of masters similarly to how you would set the number of RSs previously.  There are also methods like getActiveMaster(), waitForActiveMaster(), etc.. exposed in MiniHBaseCluster (and levels below it).&lt;/p&gt;

&lt;p&gt;Let the test writing begin!&lt;/p&gt;</comment>
                            <comment id="12918700" author="hbasereviewboard" created="Wed, 6 Oct 2010 21:52:39 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-10-06 14:14:23.202596)&lt;/p&gt;


&lt;p&gt;Review request for hbase, stack, Karthik Ranganathan, and Kannan Muthukkaruppan.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;More cleanup of comments.  Removed last remnants of numbering.  Undid some of the code cleanup my IDE did around single line ifs.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Also exposes methods to get the currently active master and can access each individually in the same way that it&apos;s done for multiple RS.&lt;/p&gt;

&lt;p&gt;This is mostly duplicating what we do for RS but for masters.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3053&quot; title=&quot;Add ability to have multiple Masters LocalHBaseCluster for test writing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3053&quot;&gt;&lt;del&gt;HBASE-3053&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3053&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3053&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperWatcher.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/925/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Untested but compiles.  This is first go at a patch.  I&apos;m going to work on writing a new unit test that uses this next.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;

</comment>
                            <comment id="12918701" author="hbasereviewboard" created="Wed, 6 Oct 2010 21:57:48 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-10-06 14:35:17.785727)&lt;/p&gt;


&lt;p&gt;Review request for hbase, stack, Karthik Ranganathan, and Kannan Muthukkaruppan.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Changes names of state variables/methods in HMaster to be more explicit.  isActiveMaster and isInitialized now.&lt;/p&gt;

&lt;p&gt;Also removes the last warning in HMaster related to using deprecated RemoteException unwrapping methods.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;To really be able to unit test the new master properly, we need to be able to have multiple masters running at once within a single logical cluster.&lt;/p&gt;

&lt;p&gt;Also exposes methods to get the currently active master and can access each individually in the same way that it&apos;s done for multiple RS.&lt;/p&gt;

&lt;p&gt;This is mostly duplicating what we do for RS but for masters.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3053&quot; title=&quot;Add ability to have multiple Masters LocalHBaseCluster for test writing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3053&quot;&gt;&lt;del&gt;HBASE-3053&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3053&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3053&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/src/main/java/org/apache/hadoop/hbase/HConstants.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/JVMClusterUtil.java 1004853 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperWatcher.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java 1004853 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/925/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Untested but compiles.  This is first go at a patch.  I&apos;m going to work on writing a new unit test that uses this next.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jonathan&lt;/p&gt;

</comment>
                            <comment id="12918702" author="hbasereviewboard" created="Wed, 6 Oct 2010 21:58:20 +0000"  >&lt;p&gt;Message from: stack@duboce.net&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/925/#review1458&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#review1458&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Ship it!&lt;/p&gt;


&lt;p&gt;Quick review.  Looks good.  Fix the below on commit.&lt;/p&gt;


&lt;p&gt;trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/925/#comment5095&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/925/#comment5095&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    isReady and isActive are not how to name booleans.  This is what the methods should be named.  I&apos;d suggest activeMaster and started as names for these flags.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;stack&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="15016821" author="lars_francke" created="Fri, 20 Nov 2015 12:40:52 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12456544" name="HBASE-3053-v11.patch" size="59620" author="streamy" created="Wed, 6 Oct 2010 21:39:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 30 Sep 2010 00:51:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32888</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hkiv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100587</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>