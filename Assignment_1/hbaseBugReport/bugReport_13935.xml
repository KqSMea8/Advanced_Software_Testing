<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:48:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13935/HBASE-13935.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13935] Orphaned namespace table ZK node should not prevent master to start</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13935</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Before we have the state-of-art Procedure V2 feature (HBASE 1.0 release or older), we frequently see the following issue (orphaned ZK node) that prevent master to start (at least in testing):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-06-16 17:54:36,472 FATAL [master:10.0.0.99:60000] master.HMaster: Unhandled exception. Starting shutdown.
org.apache.hadoop.hbase.TableExistsException: hbase:namespace
	at org.apache.hadoop.hbase.master.handler.CreateTableHandler.prepare(CreateTableHandler.java:137)
	at org.apache.hadoop.hbase.master.TableNamespaceManager.createNamespaceTable(TableNamespaceManager.java:232)
	at org.apache.hadoop.hbase.master.TableNamespaceManager.start(TableNamespaceManager.java:86)
	at org.apache.hadoop.hbase.master.HMaster.initNamespace(HMaster.java:1123)
	at org.apache.hadoop.hbase.master.HMaster.finishInitialization(HMaster.java:947)
	at org.apache.hadoop.hbase.master.HMaster.run(HMaster.java:618)
	at java.lang.Thread.run(Thread.java:745)
2015-06-16 17:54:36,472 INFO  [master:10.0.0.99:60000] master.HMaster: Aborting
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above call trace is from a 0.98.x test run.  We saw similar issue in 1.0.x run, too.  &lt;/p&gt;

&lt;p&gt;The proposed fix is to ignore the zk node and force namespace table creation to be complete so that master can start successfully.  &lt;/p&gt;

</description>
                <environment></environment>
        <key id="12838867">HBASE-13935</key>
            <summary>Orphaned namespace table ZK node should not prevent master to start</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="syuanjiang">Stephen Yuan Jiang</assignee>
                                    <reporter username="syuanjiang">Stephen Yuan Jiang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Jun 2015 17:43:03 +0000</created>
                <updated>Mon, 31 Aug 2015 22:39:36 +0000</updated>
                            <resolved>Sun, 21 Jun 2015 06:13:21 +0000</resolved>
                                    <version>1.0.0</version>
                    <version>0.98.13</version>
                                    <fixVersion>0.98.14</fixVersion>
                    <fixVersion>1.0.2</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.1.1</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="14592251" author="mbertozzi" created="Thu, 18 Jun 2015 18:17:27 +0000"  >&lt;p&gt;sounds ok to me, but are we always able to complete the next steps?&lt;br/&gt;
did you find an easy way to always reproduce the problem?&lt;/p&gt;</comment>
                            <comment id="14592271" author="syuanjiang" created="Thu, 18 Jun 2015 18:29:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; I have a unit test that can repro always.&lt;/p&gt;</comment>
                            <comment id="14592276" author="mbertozzi" created="Thu, 18 Jun 2015 18:34:58 +0000"  >&lt;p&gt;that unit test is ok, but does seems to be the real case. &lt;br/&gt;
if the znode is marked ENABLED we should already have dirs on the fs,&lt;br/&gt;
what happens at that point with create? it fails, it will just have regions on the fs that are not present in meta and hbck will complain about it?&lt;/p&gt;

&lt;p&gt;did you check what was the state of the znode on failure? was it ENABLED or something else? was there stuff on the fs? &lt;/p&gt;</comment>
                            <comment id="14592308" author="syuanjiang" created="Thu, 18 Jun 2015 18:52:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;, The failed server was gone.  Before the patch, it would fail if table is either in ENABLING or ENABLED state:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!assignmentManager.getTableStateManager().setTableStateIfNotInStates(tableName,
        ZooKeeperProtos.Table.State.ENABLING,
        ZooKeeperProtos.Table.State.ENABLING,
        ZooKeeperProtos.Table.State.ENABLED)) {
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TableExistsException(tableName);
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If we have an orphaned ENABLING znode, before HMaster#initNamespace() was called, &quot;this.assignmentManager.joinCluster();&quot; was executed, which would call &quot;AssignmentManager#recoverTableInEnablingState()&quot; to remove the ENABLING znode.  That is why my unit test only set to ENABLED and my guess is the orphaned znode in the test probably has ENABLED znode.  &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; I thought this would not be a problem with PV2; however, we hit this twice with PV2 enabled in branch-1.1 testing a couple of weeks ago (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13815&quot; title=&quot;Procedure V2: Rollback of CreateTableProcedure should clear the table state&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13815&quot;&gt;HBASE-13815&lt;/a&gt; - originally I thought the rollback had some flaw, but carefully examined code and I think rollback is correct).  I applied the same skip logic locally and we never see this problem again in branch-1.1 testing.&lt;/p&gt;</comment>
                            <comment id="14592351" author="mbertozzi" created="Thu, 18 Jun 2015 19:10:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;If we have an orphaned ENABLING znode, before HMaster#initNamespace() was called, &quot;this.assignmentManager.joinCluster();&quot; was executed, which would call &quot;AssignmentManager#recoverTableInEnablingState()&quot; to remove the ENABLING znode. That is why my unit test only set to ENABLED and my guess is the orphaned znode in the test probably has ENABLED znode.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;the znode state is fine, what I don&apos;t know (sorry I haven&apos;t look at the code yet) is what happens if we keep going and we have already some state on disk. i know that if are in the same situation of the unit test everything is fine, but is that a real situation? can we end up with some data in the dir abort, restart the master skip the znode check and now adding another region in the systable which will case hbck to complain? &lt;br/&gt;
if the above is not possible, patch is good. &lt;/p&gt;

&lt;p&gt;in proc-v2 the AM recoverTableInState() is still there, and it does the wrong thing for us. I think there is a jira to remove that.&lt;/p&gt;</comment>
                            <comment id="14592497" author="hadoopqa" created="Thu, 18 Jun 2015 20:59:50 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12740465/HBASE-13935.v1-branch-1.0.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12740465/HBASE-13935.v1-branch-1.0.patch&lt;/a&gt;&lt;br/&gt;
  against branch-1.0 branch at commit 8ae4b374e3fa4cd54b8b83bc857d41f0678ad9b6.&lt;br/&gt;
  ATTACHMENT ID: 12740465&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14464//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14464//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14464//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14464//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14464//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14464//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14464//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14464//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14593663" author="syuanjiang" created="Fri, 19 Jun 2015 17:22:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; I found the log after applying a similar fix in Branch-1.1 and resolve the issue (not sure how we reached to this state with PV2, but the patch fixed the issue and no inconsistency (note: the table is indeed in ENABLED state when this issue happened):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-05-30 16:56:40,213 TRACE [ProcedureExecutorThread-0] procedure.CreateTableProcedure: CreateTableProcedure (table=hbase:namespace) user=hbase/ip-666-77-88-999.internal@TESTING.COM (auth:KERBEROS) id=9 state=RUNNABLE execute state=CREATE_TABLE_PRE_OPERATION
2015-05-30 16:56:40,373 TRACE [ProcedureExecutorThread-0] procedure.CreateTableProcedure: CreateTableProcedure (table=hbase:namespace) user=hbase/ip-666-77-88-999.internal@TESTING.COM (auth:KERBEROS) id=9 state=RUNNABLE execute state=CREATE_TABLE_WRITE_FS_LAYOUT
2015-05-30 16:56:40,571 INFO  [RegionOpenAndInitThread-hbase:namespace-1] regionserver.HRegion: creating HRegion hbase:namespace HTD == &apos;hbase:namespace&apos;, {NAME =&amp;gt; &apos;info&apos;, DATA_BLOCK_ENCODING =&amp;gt; &apos;NONE&apos;, BLOOMFILTER =&amp;gt; &apos;ROW&apos;, REPLICATION_SCOPE =&amp;gt; &apos;0&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, VERSIONS =&amp;gt; &apos;10&apos;, TTL =&amp;gt; &apos;FOREVER&apos;, MIN_VERSIONS =&amp;gt; &apos;0&apos;, CACHE_DATA_IN_L1 =&amp;gt; &apos;true&apos;, KEEP_DELETED_CELLS =&amp;gt; &apos;FALSE&apos;, BLOCKSIZE =&amp;gt; &apos;8192&apos;, IN_MEMORY =&amp;gt; &apos;true&apos;, BLOCKCACHE =&amp;gt; &apos;true&apos;} RootDir = hdfs://ip-172-31-46-122.ec2.internal:8020/apps/hbase/data/.tmp Table name == hbase:namespace
2015-05-30 16:56:40,803 INFO  [RegionOpenAndInitThread-hbase:namespace-1] regionserver.HRegion: Closed hbase:namespace,,1433004999998.9df720124fbb66974e95de65bddaee82.
2015-05-30 16:56:40,925 TRACE [ProcedureExecutorThread-0] procedure.CreateTableProcedure: CreateTableProcedure (table=hbase:namespace) user=hbase/ip-666-77-88-999.internal@TESTING.COM (auth:KERBEROS) id=9 state=RUNNABLE execute state=CREATE_TABLE_ADD_TO_META
2015-05-30 16:56:41,370 INFO  [ProcedureExecutorThread-0] hbase.MetaTableAccessor: Added 2
2015-05-30 16:56:41,480 TRACE [ProcedureExecutorThread-0] procedure.CreateTableProcedure: CreateTableProcedure (table=hbase:namespace) user=hbase/ip-666-77-88-999.internal@TESTING.COM (auth:KERBEROS) id=9 state=RUNNABLE execute state=CREATE_TABLE_ASSIGN_REGIONS
2015-05-30 16:56:41,481 INFO  [ProcedureExecutorThread-0] zookeeper.ZKTableStateManager: Moving table hbase:namespace state from ENABLED to ENABLING
2015-05-30 16:56:41,486 INFO  [ProcedureExecutorThread-0] master.AssignmentManager: Assigning 1 region(s) to ip-666-77-88-999.ec2.internal,16020,1433004979527
2015-05-30 16:56:41,509 INFO  [ProcedureExecutorThread-0] master.RegionStates: Transition {9df720124fbb66974e95de65bddaee82 state=OFFLINE, ts=1433005001494, server=null} to {9df720124fbb66974e95de65bddaee82 state=PENDING_OPEN, ts=1433005001509, server=ip-666-77-88-999.ec2.internal,16020,1433004979527}
2015-05-30 16:56:41,872 INFO  [ProcedureExecutorThread-0] zookeeper.ZKTableStateManager: Moving table hbase:namespace state from ENABLING to ENABLED
2015-05-30 16:56:41,887 INFO  [AM.ZK.Worker-pool2-t5] master.RegionStates: Transition {9df720124fbb66974e95de65bddaee82 state=PENDING_OPEN, ts=1433005001509, server=ip-666-77-88-999.ec2.internal,16020,1433004979527} to {9df720124fbb66974e95de65bddaee82 state=OPENING, ts=1433005001887, server=ip-666-77-88-999.ec2.internal,16020,1433004979527}
2015-05-30 16:56:41,997 TRACE [ProcedureExecutorThread-0] procedure.CreateTableProcedure: CreateTableProcedure (table=hbase:namespace) user=hbase/ip-666-77-88-999.internal@TESTING.COM (auth:KERBEROS) id=9 state=RUNNABLE execute state=CREATE_TABLE_UPDATE_DESC_CACHE
2015-05-30 16:56:42,300 TRACE [ProcedureExecutorThread-0] procedure.CreateTableProcedure: CreateTableProcedure (table=hbase:namespace) user=hbase/ip-666-77-88-999.internal@TESTING.COM (auth:KERBEROS) id=9 state=RUNNABLE execute state=CREATE_TABLE_POST_OPERATION
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14593666" author="syuanjiang" created="Fri, 19 Jun 2015 17:23:45 +0000"  >&lt;p&gt;Not seeming any test failure in the report. &lt;/p&gt;</comment>
                            <comment id="14593813" author="jinghe" created="Fri, 19 Jun 2015 19:11:10 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2015-05-30 16:56:41,481 INFO  [ProcedureExecutorThread-0] zookeeper.ZKTableStateManager: Moving table hbase:namespace state from ENABLED to ENABLING
2015-05-30 16:56:41,486 INFO  [ProcedureExecutorThread-0] master.AssignmentManager: Assigning 1 region(s) to ip-666-77-88-999.ec2.internal,16020,1433004979527
2015-05-30 16:56:41,509 INFO  [ProcedureExecutorThread-0] master.RegionStates: Transition {9df720124fbb66974e95de65bddaee82 state=OFFLINE, ts=1433005001494, server=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;} to {9df720124fbb66974e95de65bddaee82 state=PENDING_OPEN, ts=1433005001509, server=ip-666-77-88-999.ec2.internal,16020,1433004979527}
2015-05-30 16:56:41,872 INFO  [ProcedureExecutorThread-0] zookeeper.ZKTableStateManager: Moving table hbase:namespace state from ENABLING to ENABLED
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is from your unit test run, so we started with ENABLED?&lt;br/&gt;
I think the patch looks ok.&lt;br/&gt;
We already did a prior check that the table hbase:namespace does not exist in meta accessor. So we won&apos;t mess up there. There may be table files on the filesystem? Then we will fail later.&lt;/p&gt;</comment>
                            <comment id="14593993" author="syuanjiang" created="Fri, 19 Jun 2015 21:35:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryhe&quot; class=&quot;user-hover&quot; rel=&quot;jerryhe&quot;&gt;Jerry He&lt;/a&gt;  This is from system test run.  After forcing to create the table, the create table actually succeeded.  And the most important thing is that we need to start master.&lt;/p&gt;</comment>
                            <comment id="14593996" author="syuanjiang" created="Fri, 19 Jun 2015 21:38:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13935&quot; title=&quot;Orphaned namespace table ZK node should not prevent master to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13935&quot;&gt;&lt;del&gt;HBASE-13935&lt;/del&gt;&lt;/a&gt;.v1-branch-1.patch is for both branch-1 and branch-1.1&lt;/p&gt;</comment>
                            <comment id="14594110" author="enis" created="Fri, 19 Jun 2015 23:33:55 +0000"  >&lt;p&gt;The patches look good. branch-1 patch is also for master, right? We should commit to master as well I think. &lt;br/&gt;
For 1.0 and before, this can happen if create table handler.prepare created the znode, but .process() was not able to create the HDFS dir. We see this often, for example if HDFS perms are broken, and HBase is started. Subsequent starts will fail because we&apos;ve already created the znode. &lt;/p&gt;

&lt;p&gt;With 1.1+, it should not happen in theory, but did not check whether the bootstrap code (which creates hbase:namespace) waits for previously executing procedures to finish. In any case, it is ok to err on the safe side I think. &lt;/p&gt;</comment>
                            <comment id="14594163" author="enis" created="Sat, 20 Jun 2015 00:12:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt;, do you want this in 1.1.1? &lt;/p&gt;</comment>
                            <comment id="14594203" author="syuanjiang" created="Sat, 20 Jun 2015 00:40:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; This JIRA is only for HBASE 1.x and lower releases.  We had logic of first check META and then check znode.  The issue happens when table not in META , but in znode as ENABLED/ENABLING.  &lt;/p&gt;

&lt;p&gt;This is NOT a issue in master, as we don&apos;t use zookeeper to track table state.  The table state is tracked in META table  - so we only check META.&lt;/p&gt;</comment>
                            <comment id="14594248" author="ndimiduk" created="Sat, 20 Jun 2015 01:22:15 +0000"  >&lt;p&gt;go ahead.&lt;/p&gt;</comment>
                            <comment id="14594445" author="hadoopqa" created="Sat, 20 Jun 2015 06:38:29 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12740738/HBASE-13935.v1-branch-1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12740738/HBASE-13935.v1-branch-1.patch&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit db08013ebeeaa85802d9795cc72b4c29c5338a47.&lt;br/&gt;
  ATTACHMENT ID: 12740738&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14479//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14479//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14479//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14479//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14479//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14479//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14479//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14479//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14594915" author="hudson" created="Sun, 21 Jun 2015 02:00:43 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.1 #552 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/552/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/552/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13935&quot; title=&quot;Orphaned namespace table ZK node should not prevent master to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13935&quot;&gt;&lt;del&gt;HBASE-13935&lt;/del&gt;&lt;/a&gt; Orphaned namespace table ZK node should not prevent master to start (Stephen Yuan Jiang) (enis: rev bfe5c3b9a197cc4f83f8b2b30fb8c32d8915ac43)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/TruncateTableHandler.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/CreateTableProcedure.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestCreateTableProcedure2.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14594916" author="hudson" created="Sun, 21 Jun 2015 02:00:50 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.2 #22 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/22/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/22/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13935&quot; title=&quot;Orphaned namespace table ZK node should not prevent master to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13935&quot;&gt;&lt;del&gt;HBASE-13935&lt;/del&gt;&lt;/a&gt; Orphaned namespace table ZK node should not prevent master to start (Stephen Yuan Jiang) (enis: rev 714dde55c04b05557fa756a62019c817207c9233)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestCreateTableProcedure2.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/CreateTableProcedure.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14594917" author="hudson" created="Sun, 21 Jun 2015 02:10:35 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #969 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/969/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/969/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13935&quot; title=&quot;Orphaned namespace table ZK node should not prevent master to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13935&quot;&gt;&lt;del&gt;HBASE-13935&lt;/del&gt;&lt;/a&gt; Orphaned namespace table ZK node should not prevent master to start (Stephen Yuan Jiang) (enis: rev d550e42f480763bec888acc2c33f6f3d7ce04766)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/handler/TestCreateTableHandler2.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/TruncateTableHandler.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14594918" author="hudson" created="Sun, 21 Jun 2015 02:10:40 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #9 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/9/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/9/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13935&quot; title=&quot;Orphaned namespace table ZK node should not prevent master to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13935&quot;&gt;&lt;del&gt;HBASE-13935&lt;/del&gt;&lt;/a&gt; Orphaned namespace table ZK node should not prevent master to start (Stephen Yuan Jiang) (enis: rev eb9b234ce2582010c4bc011a58b3e49626963040)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/procedure/TestCreateTableProcedure2.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/procedure/CreateTableProcedure.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14594963" author="enis" created="Sun, 21 Jun 2015 06:13:21 +0000"  >&lt;p&gt;Committed to 0.98 to 1.3. Thanks Stephen for the patch. &lt;/p&gt;</comment>
                            <comment id="14594969" author="hudson" created="Sun, 21 Jun 2015 06:20:53 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #986 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/986/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/986/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13935&quot; title=&quot;Orphaned namespace table ZK node should not prevent master to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13935&quot;&gt;&lt;del&gt;HBASE-13935&lt;/del&gt;&lt;/a&gt; Orphaned namespace table ZK node should not prevent master to start (Stephen Yuan Jiang) (enis: rev bdaf1e3269bfc434177a4d526c0b9bf4d9f6588a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/handler/TestCreateTableHandler2.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14595011" author="hudson" created="Sun, 21 Jun 2015 10:21:20 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98 #1033 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/1033/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/1033/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13935&quot; title=&quot;Orphaned namespace table ZK node should not prevent master to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13935&quot;&gt;&lt;del&gt;HBASE-13935&lt;/del&gt;&lt;/a&gt; Orphaned namespace table ZK node should not prevent master to start (Stephen Yuan Jiang) (enis: rev bdaf1e3269bfc434177a4d526c0b9bf4d9f6588a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/handler/TestCreateTableHandler2.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14596243" author="apurtell" created="Mon, 22 Jun 2015 17:08:13 +0000"  >&lt;p&gt;Thanks for the patch!&lt;/p&gt;</comment>
                            <comment id="14724206" author="enis" created="Mon, 31 Aug 2015 22:39:36 +0000"  >&lt;p&gt;Closing this issue after 1.0.2 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12740463" name="HBASE-13935.v1-0.98.patch" size="4780" author="syuanjiang" created="Thu, 18 Jun 2015 18:28:31 +0000"/>
                            <attachment id="12740465" name="HBASE-13935.v1-branch-1.0.patch" size="6741" author="syuanjiang" created="Thu, 18 Jun 2015 18:38:04 +0000"/>
                            <attachment id="12740738" name="HBASE-13935.v1-branch-1.patch" size="7748" author="syuanjiang" created="Fri, 19 Jun 2015 21:38:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 18 Jun 2015 18:17:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 15 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2g7zj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>