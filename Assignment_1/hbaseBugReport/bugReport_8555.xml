<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:56:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8555/HBASE-8555.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8555] FilterList correctness may be affected by random ordering of sub-filter(list)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8555</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;say, ther&apos;re 10 rows, column value is i%2:&lt;br/&gt;
row0 0&lt;br/&gt;
row1 1&lt;br/&gt;
row2 0&lt;br/&gt;
row3 1&lt;br/&gt;
row4 0&lt;br/&gt;
row5 1&lt;br/&gt;
row6 0&lt;br/&gt;
row7 1&lt;br/&gt;
row8 0&lt;br/&gt;
row9 1&lt;/p&gt;

&lt;p&gt;1: filter : row filter &amp;gt; row4   ===&amp;gt; row5 row6 row7 row8 row9&lt;br/&gt;
2: subFilterList:  row filter &amp;lt;= row4 &amp;amp;&amp;amp; column==0    ===&amp;gt; row0 row2 row4&lt;br/&gt;
3.1 filterlist&lt;span class=&quot;error&quot;&gt;&amp;#91;expected&amp;#93;&lt;/span&gt;   filter || subFilterList  ===&amp;gt; row0 row2 row4 row5 row6 row7 row8 row9&lt;br/&gt;
3.2 filterlist&lt;span class=&quot;error&quot;&gt;&amp;#91;BUGON!&amp;#93;&lt;/span&gt;  subFilterList || filter ===&amp;gt; row0 row1 row2 row3 row4 row5 row6 row7 row8 row9&lt;br/&gt;
(Please refer to the new testNestedFilterListWithSCVF case)&lt;/p&gt;

&lt;p&gt;It was found when i managed to transform the following SQL into HBase scan statement: &lt;br/&gt;
select xxx from xxx where (pk &amp;lt;= xxx and column1 = xxx) or pk &amp;gt; xxx&lt;/p&gt;

&lt;p&gt;My finding is that we had an assumption for filter methods call sequence:&lt;br/&gt;
e.g. filterRowKey() should be called before filterKeyValue().&lt;br/&gt;
and the orignial filterList.filterRowKey impl broke it due to fast short-circuit returning.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12647887">HBASE-8555</key>
            <summary>FilterList correctness may be affected by random ordering of sub-filter(list)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xieliang007">Liang Xie</assignee>
                                    <reporter username="xieliang007">Liang Xie</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 May 2013 05:34:23 +0000</created>
                <updated>Thu, 4 Jul 2013 22:10:05 +0000</updated>
                            <resolved>Wed, 22 May 2013 23:30:38 +0000</resolved>
                                    <version>0.94.3</version>
                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.95.1</fixVersion>
                    <fixVersion>0.94.9</fixVersion>
                                    <component>Filters</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13659250" author="xieliang007" created="Thu, 16 May 2013 05:37:11 +0000"  >&lt;p&gt;Attached a patch against 0.94 branch which is similar with our version.&lt;/p&gt;</comment>
                            <comment id="13659252" author="hadoopqa" created="Thu, 16 May 2013 05:42:29 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12583434/HBASE-8555-0.94.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12583434/HBASE-8555-0.94.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5714//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5714//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13659524" author="yuzhihong@gmail.com" created="Thu, 16 May 2013 13:41:00 +0000"  >&lt;p&gt;There is some long line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    Filter subFilter2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SingleColumnValueFilter(FAMILIES[0], columnStatus, CompareOp.EQUAL, Bytes.toBytes(0));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Line length should be 100 characters or shorter.&lt;/p&gt;

&lt;p&gt;Do you have trunk patch ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13659800" author="ram_krish" created="Thu, 16 May 2013 18:27:31 +0000"  >&lt;p&gt;Patch makes sense.  Good example and a very good testcase.  So you will iterate the sublist tree so that all the filters that has filterRowKey() passes through and finally decide if to include it or not.  &lt;/p&gt;</comment>
                            <comment id="13660014" author="yuzhihong@gmail.com" created="Thu, 16 May 2013 21:15:52 +0000"  >&lt;p&gt;Patch for trunk.&lt;/p&gt;</comment>
                            <comment id="13660016" author="yuzhihong@gmail.com" created="Thu, 16 May 2013 21:17:34 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; flag = (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; == Operator.MUST_PASS_ONE) ? &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; : &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;There is no need to use Boolean type - boolean should suffice.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-    assertTrue(Filter.ReturnCode.INCLUDE == filterMPONE.filterKeyValue(kv));
+    assertFalse(Filter.ReturnCode.INCLUDE == filterMPONE.filterKeyValue(kv));
+    assertTrue(filterMPONE.filterRow());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I couldn&apos;t get the last assertion pass - neither 0.94 nor trunk.&lt;/p&gt;</comment>
                            <comment id="13660122" author="hadoopqa" created="Thu, 16 May 2013 23:06:53 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12583545/8555-trunk-v1.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12583545/8555-trunk-v1.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5727//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13660890" author="ram_krish" created="Fri, 17 May 2013 17:31:12 +0000"  >&lt;p&gt;Trunk patch same as 0.94 patch?  Let me check that assertion failure.&lt;/p&gt;</comment>
                            <comment id="13660895" author="yuzhihong@gmail.com" created="Fri, 17 May 2013 17:39:05 +0000"  >&lt;p&gt;Trunk patch is different from Liang&apos;s 0.94 patch w.r.t. this assertion:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    assertTrue(filterMPONE.filterRow());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13660900" author="ram_krish" created="Fri, 17 May 2013 17:43:33 +0000"  >&lt;p&gt;Yes Ted.  Need some time to check over why it is failing and why in the original patch it was modified.  I can try over this weekend.&lt;/p&gt;</comment>
                            <comment id="13661328" author="zjushch" created="Sat, 18 May 2013 10:19:50 +0000"  >&lt;p&gt;Good case, Liang Xie.&lt;/p&gt;

&lt;p&gt;With the current patch, I think the performance would be affected a little.&lt;/p&gt;

&lt;p&gt;How about call the Rowfilter#filterRowKey() in the Rowfilter#filterKeyValue() if it haven&apos;t been called.&lt;/p&gt;</comment>
                            <comment id="13661842" author="xieliang007" created="Mon, 20 May 2013 08:13:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;Patch makes sense. Good example and a very good testcase. So you will iterate the sublist tree so that all the filters that has filterRowKey() passes through and finally decide if to include it or no&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;yes, absolutely correct&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13661843" author="xieliang007" created="Mon, 20 May 2013 08:14:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;How about call the Rowfilter#filterRowKey() in the Rowfilter#filterKeyValue() if it haven&apos;t been called.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;em, good suggestion, sound great for me&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13662778" author="xieliang007" created="Tue, 21 May 2013 07:42:47 +0000"  >&lt;p&gt;Attached v2 resolved comments about style&lt;/p&gt;</comment>
                            <comment id="13662783" author="xieliang007" created="Tue, 21 May 2013 07:48:35 +0000"  >&lt;blockquote&gt;&lt;p&gt;How about call the Rowfilter#filterRowKey() in the Rowfilter#filterKeyValue() if it haven&apos;t been called&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;seems it&apos;s not a perfect solution for me, since the filter list maybe include other filters, not just row filter&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  probably we could improve it in Filter&amp;amp;FilterBase.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;, would you mind having an eye on this jira, thanks.&lt;/p&gt;</comment>
                            <comment id="13662786" author="hadoopqa" created="Tue, 21 May 2013 07:52:33 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12583980/HBASE-8555-0.94-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12583980/HBASE-8555-0.94-v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5769//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5769//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13663735" author="xieliang007" created="Wed, 22 May 2013 03:49:07 +0000"  >&lt;p&gt;attached 0.94-v3.txt.&lt;br/&gt;
In deed, v2 patch came from our 0.94.3 version(and passed all cases definitely), and i checked svn history, known that &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6132&quot; title=&quot;ColumnCountGetFilter &amp;amp; PageFilter not working with FilterList&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6132&quot;&gt;&lt;del&gt;HBASE-6132&lt;/del&gt;&lt;/a&gt; had changed TestFilterList case after that minor version,  so i did little trivial change to fit it.&lt;/p&gt;</comment>
                            <comment id="13663738" author="hadoopqa" created="Wed, 22 May 2013 03:52:22 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12584233/HBASE-8555-0.94-v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12584233/HBASE-8555-0.94-v3.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5779//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5779//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13663740" author="xieliang007" created="Wed, 22 May 2013 03:53:42 +0000"  >&lt;p&gt;And the 8555-trunk-v1.txt should be OK without any change.&lt;/p&gt;</comment>
                            <comment id="13663760" author="zjushch" created="Wed, 22 May 2013 04:41:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;since the filter list maybe include other filters, not just row filter&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, other filters may has the same problem if result of filterKeyValue depends on filterRowKey. &lt;/p&gt;

&lt;p&gt;We could fix such problems if found and keep &quot;filterRowKey may not be called when calling filterKeyValue &quot; in mind.&lt;/p&gt;

&lt;p&gt;I prefer to use a solution without decreasing performance significantly, &lt;br/&gt;
as the current patch, more filters in filterList, more cost&lt;/p&gt;


&lt;p&gt;Anyway, I&apos;m OK if others no objection&lt;/p&gt;</comment>
                            <comment id="13663797" author="lhofhansl" created="Wed, 22 May 2013 05:37:21 +0000"  >&lt;p&gt;Sorry for chiming in late here. This is a problem with RowFilter, right?&lt;/p&gt;

&lt;p&gt;There are only three filters that implement both filterRowKey and filterKeyValue:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;RowFilter: Does not reimplement the check in filterKeyValue&lt;/li&gt;
	&lt;li&gt;RandomRowFilter: Has the same problem&lt;/li&gt;
	&lt;li&gt;WhileMatchFitler: Implements proper checks in both filterRowKey and filterKeyValue&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;So only RowFilter and RandomRowFilter have this problem. Might be better to just fix these two.&lt;br/&gt;
Fix would just be to turn filterOutRow into a Boolean (with capital B) and redo the test on the row key of the KV passed into filterKeyValue only if filterOutRow is null and then set it accordingly.&lt;/p&gt;

&lt;p&gt;That said, I&apos;m fine with the current fix too if you guys think this is a better fix. A gain in performance does not trump correctness.&lt;/p&gt;</comment>
                            <comment id="13663935" author="xieliang007" created="Wed, 22 May 2013 08:40:00 +0000"  >&lt;p&gt;yeh, my original first try was also agaist RowFilter class. My $0.02 was that if any guys want to write another filter which has both filterRowKey and filterKeyValue impl in future, then it will potentially have a bumb maybe, right? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
To me, i prefer the current fix in FilterList than the specific filter classes.&lt;/p&gt;</comment>
                            <comment id="13664091" author="yuzhihong@gmail.com" created="Wed, 22 May 2013 13:19:37 +0000"  >&lt;p&gt;I think RowFilter and RandomRowFilter should be fixed, as suggested above.&lt;/p&gt;

&lt;p&gt;For FilterList, can we introduce a config parameter, hbase.filterlist.shortcircuit.enable, that signifies it is safe to use the current short circuit algorithm ?&lt;br/&gt;
This way, users who don&apos;t create custom filter can still keep original performance.&lt;/p&gt;</comment>
                            <comment id="13664178" author="xieliang007" created="Wed, 22 May 2013 15:15:19 +0000"  >&lt;p&gt;emmm, that&apos;ll too complex probably.&lt;/p&gt;

&lt;p&gt;see filters which has own filterRowKey impletement: RowFilter/PrefixFilter/RandomRowFilter/...&lt;br/&gt;
All those fiterRowKey methods are just compare statements or some &quot;if/else&quot; switch, i really really could not image they could degrade performance obviously&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13664264" author="lhofhansl" created="Wed, 22 May 2013 17:15:04 +0000"  >&lt;p&gt;Yeah the config option is probably overkill.&lt;/p&gt;

&lt;p&gt;Let&apos;s follow the &quot;principle of the least surprise&quot; and commit this patch. +1 from me.&lt;/p&gt;</comment>
                            <comment id="13664325" author="yuzhihong@gmail.com" created="Wed, 22 May 2013 17:46:06 +0000"  >&lt;p&gt;Integrated to 0.95 and trunk.&lt;/p&gt;

&lt;p&gt;Waiting for test suite result (local run) on 0.94&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Liang.&lt;/p&gt;</comment>
                            <comment id="13664340" author="lhofhansl" created="Wed, 22 May 2013 17:58:56 +0000"  >&lt;p&gt;Let&apos;s pull this as the last patch into 0.94.8.&lt;/p&gt;</comment>
                            <comment id="13664351" author="lhofhansl" created="Wed, 22 May 2013 18:03:20 +0000"  >&lt;p&gt;Since it passed HadoopQA, I think it is sufficient to only run TestFilter in 0.94 before committing, Ted.&lt;/p&gt;</comment>
                            <comment id="13664452" author="yuzhihong@gmail.com" created="Wed, 22 May 2013 19:40:04 +0000"  >&lt;p&gt;Over in &lt;a href=&quot;http://54.241.6.143/job/HBase-0.94/188/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://54.241.6.143/job/HBase-0.94/188/console&lt;/a&gt; , certain test hung.&lt;/p&gt;

&lt;p&gt;Locally, there was one surefirebooter hanging. Looking at the stack trace, there wasn&apos;t any HBase class.&lt;/p&gt;</comment>
                            <comment id="13664478" author="lhofhansl" created="Wed, 22 May 2013 20:10:57 +0000"  >&lt;p&gt;A&apos;right. 0.94.9 then.&lt;/p&gt;</comment>
                            <comment id="13664547" author="yuzhihong@gmail.com" created="Wed, 22 May 2013 21:30:18 +0000"  >&lt;p&gt;Second run passed:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1:28:40.249s
[INFO] Finished at: Wed May 22 21:18:39 UTC 2013
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13664660" author="yuzhihong@gmail.com" created="Wed, 22 May 2013 23:15:02 +0000"  >&lt;p&gt;Integrated to 0.94 as well.&lt;/p&gt;</comment>
                            <comment id="13664670" author="hudson" created="Wed, 22 May 2013 23:21:06 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #4137 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4137/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4137/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8555&quot; title=&quot;FilterList correctness may be affected by random ordering of sub-filter(list)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8555&quot;&gt;&lt;del&gt;HBASE-8555&lt;/del&gt;&lt;/a&gt; FilterList correctness may be affected by random ordering of sub-filter(list) (Liang Xie) (Revision 1485308)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/filter/FilterList.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilterList.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13664684" author="stack" created="Wed, 22 May 2013 23:30:38 +0000"  >&lt;p&gt;Resolving&lt;/p&gt;</comment>
                            <comment id="13664703" author="hudson" created="Wed, 22 May 2013 23:43:33 +0000"  >&lt;p&gt;Integrated in hbase-0.95 #209 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/209/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/209/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8555&quot; title=&quot;FilterList correctness may be affected by random ordering of sub-filter(list)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8555&quot;&gt;&lt;del&gt;HBASE-8555&lt;/del&gt;&lt;/a&gt; FilterList correctness may be affected by random ordering of sub-filter(list) (Liang Xie) (Revision 1485310)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/filter/FilterList.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilterList.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13664856" author="hudson" created="Thu, 23 May 2013 04:45:13 +0000"  >&lt;p&gt;Integrated in hbase-0.95-on-hadoop2 #108 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95-on-hadoop2/108/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95-on-hadoop2/108/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8555&quot; title=&quot;FilterList correctness may be affected by random ordering of sub-filter(list)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8555&quot;&gt;&lt;del&gt;HBASE-8555&lt;/del&gt;&lt;/a&gt; FilterList correctness may be affected by random ordering of sub-filter(list) (Liang Xie) (Revision 1485310)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/main/java/org/apache/hadoop/hbase/filter/FilterList.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilterList.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13664899" author="hudson" created="Thu, 23 May 2013 05:51:19 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #539 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/539/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/539/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8555&quot; title=&quot;FilterList correctness may be affected by random ordering of sub-filter(list)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8555&quot;&gt;&lt;del&gt;HBASE-8555&lt;/del&gt;&lt;/a&gt; FilterList correctness may be affected by random ordering of sub-filter(list) (Liang Xie) (Revision 1485308)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/filter/FilterList.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilterList.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13664917" author="hudson" created="Thu, 23 May 2013 06:19:19 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #151 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/151/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/151/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8555&quot; title=&quot;FilterList correctness may be affected by random ordering of sub-filter(list)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8555&quot;&gt;&lt;del&gt;HBASE-8555&lt;/del&gt;&lt;/a&gt; FilterList correctness may be affected by random ordering of sub-filter(list) (Liang Xie) (Revision 1485492)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/filter/FilterList.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/filter/TestFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/filter/TestFilterList.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13665034" author="hudson" created="Thu, 23 May 2013 09:40:45 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #995 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/995/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/995/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8555&quot; title=&quot;FilterList correctness may be affected by random ordering of sub-filter(list)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8555&quot;&gt;&lt;del&gt;HBASE-8555&lt;/del&gt;&lt;/a&gt; FilterList correctness may be affected by random ordering of sub-filter(list) (Liang Xie) (Revision 1485492)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/filter/FilterList.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/filter/TestFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/filter/TestFilterList.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12583545" name="8555-trunk-v1.txt" size="7619" author="yuzhihong@gmail.com" created="Thu, 16 May 2013 21:15:52 +0000"/>
                            <attachment id="12583980" name="HBASE-8555-0.94-v2.txt" size="7618" author="xieliang007" created="Tue, 21 May 2013 07:42:47 +0000"/>
                            <attachment id="12584233" name="HBASE-8555-0.94-v3.txt" size="7576" author="xieliang007" created="Wed, 22 May 2013 03:49:07 +0000"/>
                            <attachment id="12583434" name="HBASE-8555-0.94.txt" size="7588" author="xieliang007" created="Thu, 16 May 2013 05:37:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 16 May 2013 05:42:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328243</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 30 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kmtz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328587</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>