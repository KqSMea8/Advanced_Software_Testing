<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:05:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2888/HBASE-2888.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2888] Review all our metrics</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2888</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;HBase publishes a bunch of metrics, some useful some wasteful, that should be improved to deliver a better ops experience. Examples:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Block cache hit ratio converges at some point and stops moving&lt;/li&gt;
	&lt;li&gt;fsReadLatency goes down when compactions are running&lt;/li&gt;
	&lt;li&gt;storefileIndexSizeMB is the exact same number once a system is serving production load&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We could use new metrics too.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12470396">HBASE-2888</key>
            <summary>Review all our metrics</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jul 2010 00:15:44 +0000</created>
                <updated>Thu, 19 Feb 2015 19:03:59 +0000</updated>
                            <resolved>Thu, 19 Feb 2015 19:03:59 +0000</resolved>
                                                                    <component>master</component>
                    <component>metrics</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>11</watches>
                                                                <comments>
                            <comment id="12893639" author="kannanm" created="Thu, 29 Jul 2010 14:47:33 +0000"  >&lt;p&gt;Thanks for creating this JIRA.&lt;/p&gt;

&lt;p&gt;Some additional comments:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;If the stats, at least the RPC (API-level) stats, could be on a per Table.ColumnFamily basis, that would be really helpful.&lt;/li&gt;
	&lt;li&gt;For non-counter stats, can we always put the &quot;unit&quot; in its name. For example, storefileIndexSizeMB has MB in its name (which is really useful). But fsReadLatency doesn&apos;t have the units (ms? secs?).&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12893641" author="kannanm" created="Thu, 29 Jul 2010 14:52:01 +0000"  >&lt;p&gt;Actually, the per CF stats for put/get is easier said than done. A single put can have data for multiple CFs, and shares a common sync operation. So it&apos;ll be hard to correctly separate this. Thoughts?&lt;/p&gt;</comment>
                            <comment id="12893851" author="ryanobjc" created="Thu, 29 Jul 2010 22:59:09 +0000"  >&lt;p&gt;here are some of the things i&apos;ve identified as issues:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;HFile states, eg: fsReadLatency, is in milliseconds, and it should really be in microseconds.&lt;/li&gt;
	&lt;li&gt;we should generate 99th and 95th percentile for many of the stats (eg: fsReadLatency) and publish it.  Perhaps a 1 and/or 5 minute 99th rolling percentile.&lt;/li&gt;
	&lt;li&gt;The HFile metrics integration is a little weak, we use some volatiles and scrape them, for the enhanced 99th/95th pc stats we&apos;ll need access to the richer stats classes.  HFile depends on Hadoop and hbase.util so with a little moving of things around, hopefully it&apos;ll be possible to actually make better stats w/o having HFile depends on HRS (for example)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12907096" author="stack" created="Wed, 8 Sep 2010 05:30:58 +0000"  >&lt;p&gt;Setting hbase.period in hadoop-metrics.properties doesn&apos;t seem to have an effect; counts are off.  Here&apos;s what I noticed digging in code:&lt;/p&gt;

&lt;p&gt;&apos;hadoop-metrics.properties&apos; gets read up into a metrics attributes map but nothing seems to be done w/ them subsequently. Reading up in hadoop, in branch-0.20/src/core/org/apache/hadoop/metrics/package.html, it seems to imply that we need to getAttribute and set them after we make a metrics Context; i.e. in this case, call setPeriod in RegionServerMetrics, etc.?&lt;/p&gt;

&lt;p&gt;More broadly, need to make sure settings in hadoop-metrics.properties take effect when changed.&lt;/p&gt;</comment>
                            <comment id="12918278" author="jdcryans" created="Tue, 5 Oct 2010 22:31:47 +0000"  >&lt;p&gt;Punt to 0.92.0&lt;/p&gt;</comment>
                            <comment id="12934763" author="alexb" created="Tue, 23 Nov 2010 07:43:17 +0000"  >&lt;p&gt;As per small discussion here: &lt;a href=&quot;http://search-hadoop.com/m/DZcdNHsTOe2&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://search-hadoop.com/m/DZcdNHsTOe2&lt;/a&gt;, here are some extra things we might want to expose:&lt;/p&gt;

&lt;p&gt;1. Splits stats. &lt;br/&gt;
We have in JMX flush and compaction data (time spent and data amount). Should we add also stats for split procedures as they affect hbase behaviour too?&lt;/p&gt;

&lt;p&gt;2. Flush/Compaction/Split rate.&lt;br/&gt;
For flush and compaction we expose only time spent and data amount stats, but we might also want to show smth like operations &quot;rate&quot; (number of actions). &lt;br/&gt;
Based on flush/compaction/split rate one can make judgements on whether some configuration is properly set (e.g. hbase.hregion.memstore.flush.size).&lt;/p&gt;

&lt;p&gt;3. Events log.&lt;br/&gt;
Also I think would be very useful for ops to have ability to watch at events (like splits, flushes, compactions) on a web interface/in JMX, know when they appear, aka events&apos; log. Thus one can go to to web page and see what can affect performance degradation for a particular period of time. Currently we have to (and do) go to log files for that kind of info.&lt;/p&gt;
</comment>
                            <comment id="12934765" author="alexb" created="Tue, 23 Nov 2010 07:56:28 +0000"  >&lt;p&gt;In general, does it makes sense to create separate issue to review the way we expose particular metrics/stats? E.g. should we show particular metric on a web interface or just put into JMX, in what form (in case of web), etc.?&lt;/p&gt;</comment>
                            <comment id="12935193" author="stack" created="Wed, 24 Nov 2010 03:56:12 +0000"  >&lt;p&gt;@Alex 1. and 2. sound great.  How would 3. differ from current log?  All it has in it is &apos;events&apos;, no?  Regards your question about process, I&apos;d say no need of an issue per metric., at least not for now.  The way it usually runs is we have a fat umbrella issue like this one, a bunch of work gets done under this umbrella &amp;#8211; in this case, a bunch of the above will be addressed by the patch &amp;#8211; but then subsequent amendments or additions get done in separate issues.  Hope this helps.&lt;/p&gt;</comment>
                            <comment id="12935217" author="alexb" created="Wed, 24 Nov 2010 06:30:52 +0000"  >&lt;p&gt;qt. How would 3. differ from current log?&lt;/p&gt;

&lt;p&gt;The difference is to have this shown somewhere in more user friendly-place e.g. &lt;b&gt;on web interface&lt;/b&gt;. The point I wanted to stress out is that currently users/ops have to go for this information to the log files which isn&apos;t straightforward for them (and leads to questions on ML as I linked to), I think, but might be wrong.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12935281" author="larsgeorge" created="Wed, 24 Nov 2010 10:33:47 +0000"  >&lt;p&gt;I think what 3. is for is what we once had as the Historian. Is there a plan to bring that back and even extend on it?&lt;/p&gt;

&lt;p&gt;I agree with Alex though and agreed to help to add this as necessary and reasonable. We need for users to be able to easily see the status of a server/table/region etc. since digging in logs is black art and with changing versions and therefore changing log statements even simple grep scripts may fail on newer versions. If we had a simple history per table or region of what happened when (like last compaction, what type was it, how was it triggered? Same for last flush and splits) I am sure it would help a lot of users. Maybe a simple event based WAL that is written per RS and that can be displayed nicely in the UI and maybe even being to clear it should help a lot. Maybe keep the last N records/events as per a config key? &lt;/p&gt;</comment>
                            <comment id="12935433" author="stack" created="Wed, 24 Nov 2010 18:39:55 +0000"  >&lt;p&gt;Yeah.  Sounds like the &apos;historian&apos;.  The historian was a nice feature but being a column family on .META. it got in the way of normal operation; clients in regionservers wanting to log events would get hung up blocking if meta moved or was unavailable or just get in the way of recovery.  A UI could look at the historian table.  We could put in events in reverse order so latest showed first.  It also couldn&apos;t record all events IIRC.  We could do historian event logging into a table apart from .META.  That might work.  Would need to make it so client could ride unavailability of the historian table or just drop events if couldn&apos;t add an event.  That&apos;d be hardest part I&apos;d imagine.  We might look at rowlog to do this?  Or we could just emit the events and let another system render them (tsdb?).&lt;/p&gt;</comment>
                            <comment id="12969847" author="otis" created="Thu, 9 Dec 2010 18:27:49 +0000"  >&lt;p&gt;+1 for emitting events and letting other systems store/render them.&lt;/p&gt;</comment>
                            <comment id="13035509" author="stack" created="Wed, 18 May 2011 17:40:49 +0000"  >&lt;p&gt;Lars has done some good digging on rpc metrics here: &lt;a href=&quot;http://search-hadoop.com/m/kq0CEtkbZl1/rpc+metrics&amp;amp;subj=RPC+Metrics&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://search-hadoop.com/m/kq0CEtkbZl1/rpc+metrics&amp;amp;subj=RPC+Metrics&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13035513" author="stack" created="Wed, 18 May 2011 17:47:01 +0000"  >&lt;p&gt;And this &lt;a href=&quot;http://search-hadoop.com/m/EYsXe2lkkbx/Extended+Period+Metrics&amp;amp;subj=Extended+Period+Metrics&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://search-hadoop.com/m/EYsXe2lkkbx/Extended+Period+Metrics&amp;amp;subj=Extended+Period+Metrics&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13047617" author="stack" created="Fri, 10 Jun 2011 22:46:06 +0000"  >&lt;p&gt;Moving out of 0.92.0. Pull it back in if you think different.&lt;/p&gt;</comment>
                            <comment id="13071072" author="larsgeorge" created="Tue, 26 Jul 2011 12:53:51 +0000"  >&lt;p&gt;Another issue I found using the metrics is that all new client API calls are lumping everything under &quot;multi&quot; (for the RPC calls), for all batchable operations (which are most). This makes it difficult to track actual get/put/delete calls and their counts. Obviously this is OK in terms of RPC call counts, but these metrics were useful to see what the request pattern looks like. Trunk adds read/write counts to the RS metrics, which is good. But maybe we should have a more detailed count as well? Only if needed.&lt;/p&gt;</comment>
                            <comment id="14326976" author="otis" created="Thu, 19 Feb 2015 04:34:42 +0000"  >&lt;p&gt;This issue is &amp;gt;4 years old and there are so many metrics.... I doubt anyone will ever review all of them systematically... Won&apos;t Fix?&lt;/p&gt;</comment>
                            <comment id="14327960" author="stack" created="Thu, 19 Feb 2015 19:03:59 +0000"  >&lt;p&gt;As per &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=otis%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;otis@apache.org&quot;&gt;Otis Gospodnetic&lt;/a&gt; suggestion.  Metrics have been revamped and edited radically since this was filed (metrics2) and at least some of this issue was addressed by the refactor. Lets open specific issues to deal &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 29 Jul 2010 14:47:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32820</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 43 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02f5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12056</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>