<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:15:01 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-16521/HBASE-16521.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-16521] Restore operation would fail if the hbase.tmp.dir directory is absent or doesn&apos;t have proper permission</title>
                <link>https://issues.apache.org/jira/browse/HBASE-16521</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I ran backup IT test and bumped into the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2016-08-29 20:38:31,390 INFO  [main] mapreduce.Job: Job job_1472498400634_0004 failed with state FAILED due to: Job setup failed : org.apache.hadoop.security.AccessControlException: Permission denied:   user=hbase, access=WRITE, inode=&lt;span class=&quot;code-quote&quot;&gt;&quot;/tmp/hbase-hbase/bulk_output-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-IntegrationTestBackupRestore.table1-1472503079471/_temporary/1&quot;&lt;/span&gt;:hdfs:hdfs:drwxr-xr-x
  at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:319)
  at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:292)
  at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:213)
  at org.apache.ranger.authorization.hadoop.RangerHdfsAuthorizer$RangerAccessControlEnforcer.checkPermission(RangerHdfsAuthorizer.java:307)
  at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.checkPermission(FSPermissionChecker.java:190)
  at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1827)
  at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkPermission(FSDirectory.java:1811)
  at org.apache.hadoop.hdfs.server.namenode.FSDirectory.checkAncestorAccess(FSDirectory.java:1794)
  at org.apache.hadoop.hdfs.server.namenode.FSDirMkdirOp.mkdirs(FSDirMkdirOp.java:71)
  at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.mkdirs(FSNamesystem.java:4011)
  at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.mkdirs(NameNodeRpcServer.java:1102)
  at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.mkdirs(ClientNamenodeProtocolServerSideTranslatorPB.java:630)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here is related code in MapReduceRestoreService :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Path getBulkOutputDir(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tableName) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
  {
    Configuration conf = getConf();
    FileSystem fs = FileSystem.get(conf);
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tmp = conf.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.tmp.dir&quot;&lt;/span&gt;);
    Path path =  &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(tmp + Path.SEPARATOR + &lt;span class=&quot;code-quote&quot;&gt;&quot;bulk_output-&quot;&lt;/span&gt;+tableName + &lt;span class=&quot;code-quote&quot;&gt;&quot;-&quot;&lt;/span&gt;
        + EnvironmentEdgeManager.currentTime());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;conf.get(&quot;hbase.tmp.dir&quot;) returned /tmp/hbase-hbase which was not created on hdfs.&lt;br/&gt;
We should use hbase.fs.tmp.dir as the base dir to avoid the above permission error.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13001113">HBASE-16521</key>
            <summary>Restore operation would fail if the hbase.tmp.dir directory is absent or doesn&apos;t have proper permission</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuzhihong@gmail.com">Ted Yu</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                            <label>backup</label>
                    </labels>
                <created>Mon, 29 Aug 2016 21:03:53 +0000</created>
                <updated>Mon, 29 Aug 2016 23:30:19 +0000</updated>
                            <resolved>Mon, 29 Aug 2016 23:30:18 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="15447209" author="yuzhihong@gmail.com" created="Mon, 29 Aug 2016 22:11:32 +0000"  >&lt;p&gt;Tried backup IT test on cluster with the patch while /tmp/hbase-hbase was not existent.&lt;/p&gt;

&lt;p&gt;The test passed.&lt;/p&gt;</comment>
                            <comment id="15447333" author="vrodionov" created="Mon, 29 Aug 2016 23:01:14 +0000"  >&lt;p&gt;Please use the following code to init tmp dir:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; hbaseTmpFsDir =
        conf.get(HConstants.TEMPORARY_FS_DIRECTORY_KEY,
          HConstants.DEFAULT_TEMPORARY_HDFS_DIRECTORY);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This looks more safe.&lt;/p&gt;</comment>
                            <comment id="15447377" author="vrodionov" created="Mon, 29 Aug 2016 23:18:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt; can you fix RestoreServerUtil ctor as well? Should be the following code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; RestoreServerUtil(Configuration conf, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path backupRootPath, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; backupId)
      &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.conf = conf;
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.backupRootPath = backupRootPath;
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.backupId = backupId;
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fs = backupRootPath.getFileSystem(conf);
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.restoreTmpPath = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(conf.get(HConstants.TEMPORARY_FS_DIRECTORY_KEY, 
        HConstants.DEFAULT_TEMPORARY_HDFS_DIRECTORY),
      &lt;span class=&quot;code-quote&quot;&gt;&quot;restore&quot;&lt;/span&gt;);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="15447400" author="vrodionov" created="Mon, 29 Aug 2016 23:27:19 +0000"  >&lt;p&gt;lgtm.&lt;/p&gt;</comment>
                            <comment id="15447410" author="yuzhihong@gmail.com" created="Mon, 29 Aug 2016 23:30:18 +0000"  >&lt;p&gt;Thanks for the review, Vlad.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12863549">HBASE-14414</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12826082" name="16521.v1.txt" size="878" author="yuzhihong@gmail.com" created="Mon, 29 Aug 2016 21:45:19 +0000"/>
                            <attachment id="12826097" name="16521.v2.txt" size="2093" author="yuzhihong@gmail.com" created="Mon, 29 Aug 2016 23:24:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 29 Aug 2016 23:01:14 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32z1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>