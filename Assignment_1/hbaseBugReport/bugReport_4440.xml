<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:18:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4440/HBASE-4440.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4440] add an option to presplit table to PerformanceEvaluation</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4440</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;PerformanceEvaluation a quick way to &apos;benchmark&apos; a HBase cluster.  The current &apos;write*&apos; operations do not pre-split the table.  Pre splitting the table will really boost the insert performance.&lt;/p&gt;

&lt;p&gt;It would be nice to have an option to enable pre-splitting table before the inserts begin.&lt;/p&gt;

&lt;p&gt;it would look something like:&lt;/p&gt;

&lt;p&gt;(a) hbase ...PerformanceEvaluation   --presplit=10 &amp;lt;other options&amp;gt;&lt;br/&gt;
(b) hbase ...PerformanceEvaluation   --presplit &amp;lt;other options&amp;gt;&lt;/p&gt;

&lt;p&gt;(b) will try to presplit the table on some default value (say number of region servers)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12523599">HBASE-4440</key>
            <summary>add an option to presplit table to PerformanceEvaluation</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sujee">Sujee Maniyam</assignee>
                                    <reporter username="sujee">Sujee Maniyam</reporter>
                        <labels>
                            <label>benchmark</label>
                    </labels>
                <created>Mon, 19 Sep 2011 18:33:02 +0000</created>
                <updated>Fri, 12 Oct 2012 05:35:07 +0000</updated>
                            <resolved>Tue, 6 Dec 2011 02:35:00 +0000</resolved>
                                                    <fixVersion>0.94.0</fixVersion>
                                    <component>util</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13109037" author="sujee" created="Tue, 20 Sep 2011 22:32:44 +0000"  >&lt;p&gt;linking to similar improvement request for YCSB benchmark&lt;/p&gt;</comment>
                            <comment id="13160460" author="sujee" created="Wed, 30 Nov 2011 23:38:47 +0000"  >&lt;p&gt;added --presplit option to pre-split table&lt;/p&gt;</comment>
                            <comment id="13160468" author="sujee" created="Wed, 30 Nov 2011 23:43:14 +0000"  >&lt;p&gt;patch&lt;/p&gt;</comment>
                            <comment id="13160482" author="sujee" created="Wed, 30 Nov 2011 23:56:56 +0000"  >&lt;p&gt;patch attached&lt;/p&gt;</comment>
                            <comment id="13160552" author="nspiegelberg" created="Thu, 1 Dec 2011 01:27:21 +0000"  >&lt;p&gt;looks pretty good.  I wish you could use RegionSplitter.HexStringSplit to generate your keys (since that would be the recommended usage pattern), but I guess PerformanceEvaluation does DecimalStrings instead.  Maybe a refactoring effort?&lt;/p&gt;

&lt;p&gt;The line&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(3000); &lt;span class=&quot;code-comment&quot;&gt;// wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; things to settle down&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;deleteTable() should stall until all all the regions associated with that table are removed.  Did you encounter some problems without that sleep?  We shouldn&apos;t have any arbitrary stalls in the code and instead understand what else we need to wait on before creating the table again.&lt;/p&gt;</comment>
                            <comment id="13160575" author="ram_krish" created="Thu, 1 Dec 2011 02:06:00 +0000"  >&lt;p&gt;@Sujee&lt;/p&gt;

&lt;p&gt;Wait till there not regions in RIT instead of sleep like how we have done in TestMasterFailover&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
log(&lt;span class=&quot;code-quote&quot;&gt;&quot;Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; no more RIT&quot;&lt;/span&gt;);
    ZKAssign.blockUntilNoRIT(zkw);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13160579" author="nspiegelberg" created="Thu, 1 Dec 2011 02:10:56 +0000"  >&lt;p&gt;@ramkrishna: should this not be done in the deleteTable() code to make it synchronous instead of expecting all callers to know that it is necessary?&lt;/p&gt;</comment>
                            <comment id="13161120" author="sujee" created="Thu, 1 Dec 2011 20:30:37 +0000"  >&lt;p&gt;thanks for the comments.&lt;/p&gt;

&lt;p&gt;I have attached a revised patch.&lt;/p&gt;

&lt;p&gt;removed sleep-wait after deleting table.  I had some issues with 0.90.1, works fine with 0.90.4&lt;/p&gt;</comment>
                            <comment id="13163286" author="nspiegelberg" created="Tue, 6 Dec 2011 02:35:00 +0000"  >&lt;p&gt;thanks Sujee!&lt;/p&gt;</comment>
                            <comment id="13163372" author="hudson" created="Tue, 6 Dec 2011 05:53:45 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #23 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/23/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/23/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4440&quot; title=&quot;add an option to presplit table to PerformanceEvaluation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4440&quot;&gt;&lt;del&gt;HBASE-4440&lt;/del&gt;&lt;/a&gt; add an option to presplit table to PerformanceEvaluation&lt;/p&gt;

&lt;p&gt;nspiegelberg : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/PerformanceEvaluation.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13163416" author="hudson" created="Tue, 6 Dec 2011 07:31:59 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2520 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2520/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2520/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4440&quot; title=&quot;add an option to presplit table to PerformanceEvaluation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4440&quot;&gt;&lt;del&gt;HBASE-4440&lt;/del&gt;&lt;/a&gt; add an option to presplit table to PerformanceEvaluation&lt;/p&gt;

&lt;p&gt;nspiegelberg : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/PerformanceEvaluation.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13183510" author="jdcryans" created="Tue, 10 Jan 2012 19:41:48 +0000"  >&lt;p&gt;ugh pressed the wrong button and assigned it to myself, I added Sujee as a contributor reassigned this jira.&lt;/p&gt;</comment>
                            <comment id="13183784" author="jdcryans" created="Wed, 11 Jan 2012 01:39:54 +0000"  >&lt;p&gt;I tried the patch on 0.92, why is it that using presplit you get a different behavior than while not using it regarding the re-creation of the table? Seems like a bug to me.&lt;/p&gt;</comment>
                            <comment id="13183805" author="sujee" created="Wed, 11 Jan 2012 02:22:55 +0000"  >&lt;p&gt;@JD&lt;br/&gt;
--presplit  drops and re-creates the table with splits.&lt;br/&gt;
is this what you mean?&lt;/p&gt;</comment>
                            <comment id="13183819" author="jdcryans" created="Wed, 11 Jan 2012 02:49:05 +0000"  >&lt;p&gt;Yes, and if you don&apos;t use it it&apos;s the old behavior of not recreating the table. Presplitting shouldn&apos;t be different.&lt;/p&gt;</comment>
                            <comment id="13184284" author="sujee" created="Wed, 11 Jan 2012 18:59:42 +0000"  >&lt;p&gt;so you are proposing that  &lt;/p&gt;

&lt;p&gt;1) whether we use presplit option or not, table has to be recreated for all write-mode tests.  &lt;/p&gt;

&lt;p&gt;This changes the behavior for all write-tests.   Currently table is only created if it doesn&apos;t exist.&lt;/p&gt;

&lt;p&gt;2) or pre-split should try to split the table without re-creating it.&lt;/p&gt;

</comment>
                            <comment id="13184294" author="jdcryans" created="Wed, 11 Jan 2012 19:15:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;whether we use presplit option or not, table has to be recreated for all write-mode tests.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No, it shouldn&apos;t be different from the default behavior of not recreating the table.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;or pre-split should try to split the table without re-creating it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It should not.&lt;/p&gt;

&lt;p&gt;Code speaks more than words, here&apos;s what I&apos;m using for testing 0.92:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; checkTable(HBaseAdmin admin) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    HTableDescriptor tableDescriptor = getTableDescriptor();
    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; tableExists = admin.tableExists(tableDescriptor.getName());
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!tableExists) {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.presplitRegions &amp;gt; 0) {
        &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[][] splits = getSplits();
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i=0; i &amp;lt; splits.length; i++) {
          LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot; split &quot;&lt;/span&gt; + i + &lt;span class=&quot;code-quote&quot;&gt;&quot;: &quot;&lt;/span&gt; + Bytes.toStringBinary(splits[i]));
        }
        admin.createTable(tableDescriptor, splits);
        LOG.info (&lt;span class=&quot;code-quote&quot;&gt;&quot;Table created with &quot;&lt;/span&gt; + &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.presplitRegions + &lt;span class=&quot;code-quote&quot;&gt;&quot; splits&quot;&lt;/span&gt;);
      }
      &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        admin.createTable(tableDescriptor);
        LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Table &quot;&lt;/span&gt; + tableDescriptor + &lt;span class=&quot;code-quote&quot;&gt;&quot; created&quot;&lt;/span&gt;);
      }
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; !tableExists;
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13184309" author="sujee" created="Wed, 11 Jan 2012 19:33:26 +0000"  >&lt;p&gt;I see.  looks good.&lt;br/&gt;
If the table exists, and presplit option is supplied, it will have no effect.  It might mislead the user in believing the pre-split option took effect, while in fact it didn&apos;t.&lt;br/&gt;
may be a WARN would suffice to notify the user?&lt;/p&gt;</comment>
                            <comment id="13184311" author="jdcryans" created="Wed, 11 Jan 2012 19:38:42 +0000"  >&lt;p&gt;We could show a WARN, but I don&apos;t think we would need more than that. In fact, we could always show a message when the table exists saying something like: &quot;Using the existing $&lt;/p&gt;
{tablename}
&lt;p&gt; which has $&lt;/p&gt;
{X}
&lt;p&gt; regions&quot;. &lt;/p&gt;

&lt;p&gt;About the pre-splitting itself, it seems that it creates N+1 regions and the first one has the end key 0000000000 so it never gets data. Not a biggie, but could be fixed in another jira.&lt;/p&gt;</comment>
                            <comment id="13184329" author="sujee" created="Wed, 11 Jan 2012 19:54:09 +0000"  >&lt;p&gt;sounds good.  I will submit a patch.&lt;/p&gt;

&lt;p&gt;couple of newbie logistical questions:&lt;/p&gt;

&lt;p&gt;1) should I create a new patch against the trunk?  the original patch is already committed in trunk / 0.94.&lt;/p&gt;

&lt;p&gt;2) do I leave old patch attachments in the JIRA or should I delete them (to reduce clutter)&lt;/p&gt;

&lt;p&gt;thanks JD&lt;/p&gt;</comment>
                            <comment id="13184342" author="jdcryans" created="Wed, 11 Jan 2012 20:08:07 +0000"  >&lt;p&gt;Please create a new jira, carry over some of our conversations we had here to justify it, and leave this jira like it is please.&lt;/p&gt;

&lt;p&gt;Good stuff.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12517872">HBASE-4163</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12538370">HBASE-5198</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12505690" name="PerformanceEvaluation.java" size="43909" author="sujee" created="Wed, 30 Nov 2011 23:58:14 +0000"/>
                            <attachment id="12505689" name="PerformanceEvaluation_HBASE_4440.patch" size="3872" author="sujee" created="Wed, 30 Nov 2011 23:56:56 +0000"/>
                            <attachment id="12505804" name="PerformanceEvaluation_HBASE_4440_2.patch" size="3711" author="sujee" created="Thu, 1 Dec 2011 20:30:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 1 Dec 2011 01:27:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33557</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 49 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02hl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12450</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>