<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:46:49 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13806/HBASE-13806.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13806] Check the mob files when there are mob-enabled columns in HFileCorruptionChecker</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13806</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Now in HFileCorruptionChecker, it only checks the files in regions. We need check the mob files too if there are mob-enabled columns in that table.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12833722">HBASE-13806</key>
            <summary>Check the mob files when there are mob-enabled columns in HFileCorruptionChecker</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12721032">HBASE-11339</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jingcheng.du@intel.com">Jingcheng Du</assignee>
                                    <reporter username="jingcheng.du@intel.com">Jingcheng Du</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 May 2015 09:13:42 +0000</created>
                <updated>Wed, 22 Jul 2015 22:48:55 +0000</updated>
                            <resolved>Mon, 8 Jun 2015 05:50:32 +0000</resolved>
                                    <version>hbase-11339</version>
                                    <fixVersion>hbase-11339</fixVersion>
                                    <component>mob</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14564570" author="ram_krish" created="Fri, 29 May 2015 11:00:56 +0000"  >&lt;p&gt;But this would need a full table scan also?  Are you just plan to check the integrity of the MOB files?&lt;/p&gt;</comment>
                            <comment id="14564671" author="anoop.hbase" created="Fri, 29 May 2015 12:02:34 +0000"  >&lt;p&gt;The checker checks for file level corruption. So at MOB files level also we can do the same check. As the MOB files also similar was a HFiles simple changes. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
To check ref entries to MOB entry mapping integrity we will need different tool.&lt;/p&gt;</comment>
                            <comment id="14564713" author="jmhsieh" created="Fri, 29 May 2015 12:33:40 +0000"  >&lt;p&gt;The idea here is that we read a hfile, and if we have the mob refs present on a cell, we verify that the corresponding mob file is present.  Furthermore, we could verify if the mob value cell is present.&lt;/p&gt;</comment>
                            <comment id="14564729" author="anoop.hbase" created="Fri, 29 May 2015 12:49:25 +0000"  >&lt;p&gt;But this tool just try create a reader on the HFiles and not really reading Cells out of it.   So may be we will have the ref cell -&amp;gt; mob cell check as an other tool or so? Or am I missing some thing?&lt;/p&gt;</comment>
                            <comment id="14566883" author="jingcheng.du@intel.com" created="Mon, 1 Jun 2015 02:18:39 +0000"  >&lt;p&gt;Thanks guys for comments.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The idea here is that we read a hfile, and if we have the mob refs present on a cell, we verify that the corresponding mob file is present. Furthermore, we could verify if the mob value cell is present&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think in this patch, we should do same things as what is done in HFileCorruptionChecker where only opening a reader to a HFile. We can file another JIRA to detect the missed mob files which needs a full table scan I am afraid (In the current implementation of HFile.main() it does the full table scan, we need resolve the reference to mob file in that scan).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But this tool just try create a reader on the HFiles and not really reading Cells out of it. So may be we will have the ref cell -&amp;gt; mob cell check as an other tool or so? Or am I missing some thing?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;You are right Anoop. This one is just to find all the mob files and check whether they are corrupt. We need another JIRA to check the missed mob cells.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But this would need a full table scan also? Are you just plan to check the integrity of the MOB files?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is used to check the corruption of mob files, we need another JIRA to check the integrity, I am afraid we have to do a full table scan like what has been implemented for normal tables (We need to resolve the reference cell to the mob cell if any).&lt;/p&gt;</comment>
                            <comment id="14567324" author="jingcheng.du@intel.com" created="Mon, 1 Jun 2015 13:58:26 +0000"  >&lt;p&gt;Upload the patch. Please take a look. Thanks.&lt;/p&gt;</comment>
                            <comment id="14570400" author="jingcheng.du@intel.com" created="Wed, 3 Jun 2015 07:12:48 +0000"  >&lt;p&gt;Update the patch according to Anoop&apos;s comments to execute the mob checker in parallel.&lt;/p&gt;</comment>
                            <comment id="14570540" author="jingcheng.du@intel.com" created="Wed, 3 Jun 2015 09:38:07 +0000"  >&lt;p&gt;Update the patch to handle the corrupt file in reading.&lt;/p&gt;</comment>
                            <comment id="14570580" author="jingcheng.du@intel.com" created="Wed, 3 Jun 2015 10:07:06 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmhsieh&quot; class=&quot;user-hover&quot; rel=&quot;jmhsieh&quot;&gt;Jonathan Hsieh&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoopsamjohn&quot; class=&quot;user-hover&quot; rel=&quot;anoopsamjohn&quot;&gt;Anoop Sam John&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;.&lt;br/&gt;
This patch is used to check the corrupt mob files.&lt;br/&gt;
And next we need a tool to check the integrity of mob cells. I think Jon&apos;s idea is very good. Read the hfile and check whether its mob file is present.&lt;br/&gt;
If the mob file is not there, how should we do? Add a delete marker for this ref cell from table client? Or alternatively, could we do some improvement in scanner?&lt;br/&gt;
Now if the mob file is not present or the mob file is corrupt, a cell with a null value is returned. Could we just filter these cells and read more in scanner? In this way, the dangling ref cells are not visible, and these dangling ref cells can be deleted when they are expired.&lt;br/&gt;
Please advise. Thanks!&lt;/p&gt;</comment>
                            <comment id="14570608" author="jingcheng.du@intel.com" created="Wed, 3 Jun 2015 10:25:00 +0000"  >&lt;p&gt;In the first approach, how about to have a coprocoessor(endpoint) to scan per region?&lt;/p&gt;</comment>
                            <comment id="14570609" author="jingcheng.du@intel.com" created="Wed, 3 Jun 2015 10:25:39 +0000"  >&lt;p&gt;In the first approach, how about to have a coprocoessor(endpoint) to scan per region?&lt;/p&gt;</comment>
                            <comment id="14572512" author="jingcheng.du@intel.com" created="Thu, 4 Jun 2015 10:27:10 +0000"  >&lt;p&gt;Update the patch according Anoop&apos;s commnets.&lt;br/&gt;
1. Separate the statistics for mob files and hfiles.&lt;br/&gt;
2. Print the report for mobs.&lt;/p&gt;</comment>
                            <comment id="14572583" author="ram_krish" created="Thu, 4 Jun 2015 11:33:47 +0000"  >&lt;p&gt;LGTM.  +1 for commit.&lt;/p&gt;</comment>
                            <comment id="14573084" author="anoop.hbase" created="Thu, 4 Jun 2015 16:23:45 +0000"  >&lt;p&gt;Looks good now..&lt;br/&gt;
In some log statements in mob related method, still refer to HFile..  Pls check all and change them to MOB file.&lt;/p&gt;</comment>
                            <comment id="14573974" author="jingcheng.du@intel.com" created="Fri, 5 Jun 2015 02:54:32 +0000"  >&lt;p&gt;Update the patch according to Anoop&apos;s comment, thanks.&lt;/p&gt;</comment>
                            <comment id="14576602" author="jingcheng.du@intel.com" created="Mon, 8 Jun 2015 05:04:41 +0000"  >&lt;p&gt;Update the patch to remove some unnecessary changes.&lt;/p&gt;</comment>
                            <comment id="14576631" author="anoop.hbase" created="Mon, 8 Jun 2015 05:45:19 +0000"  >&lt;p&gt;+1.  Will commit now.&lt;/p&gt;</comment>
                            <comment id="14637864" author="hudson" created="Wed, 22 Jul 2015 22:48:55 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6672 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6672/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6672/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13806&quot; title=&quot;Check the mob files when there are mob-enabled columns in HFileCorruptionChecker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13806&quot;&gt;&lt;del&gt;HBASE-13806&lt;/del&gt;&lt;/a&gt; Check the mob files when there are mob-enabled columns in HFileCorruptionChecker. (Jingcheng) (anoopsamjohn: rev 13fe542bccea2ac70f052017ac71b99b10dbcda1)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/util/hbck/HFileCorruptionChecker.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestHBaseFsck.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12737102" name="HBASE-13806-V2.diff" size="9102" author="jingcheng.du@intel.com" created="Wed, 3 Jun 2015 07:12:48 +0000"/>
                            <attachment id="12737141" name="HBASE-13806-V3.diff" size="10394" author="jingcheng.du@intel.com" created="Wed, 3 Jun 2015 09:38:07 +0000"/>
                            <attachment id="12737527" name="HBASE-13806-V4.diff" size="16210" author="jingcheng.du@intel.com" created="Thu, 4 Jun 2015 10:27:10 +0000"/>
                            <attachment id="12737768" name="HBASE-13806-V5.diff" size="16234" author="jingcheng.du@intel.com" created="Fri, 5 Jun 2015 02:54:32 +0000"/>
                            <attachment id="12738298" name="HBASE-13806-V6.diff" size="14942" author="jingcheng.du@intel.com" created="Mon, 8 Jun 2015 05:04:41 +0000"/>
                            <attachment id="12736557" name="HBASE-13806.diff" size="8010" author="jingcheng.du@intel.com" created="Mon, 1 Jun 2015 13:58:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 29 May 2015 11:00:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 21 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fdb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>