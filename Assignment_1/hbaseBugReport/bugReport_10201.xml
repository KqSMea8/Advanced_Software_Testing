<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:11:27 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10201/HBASE-10201.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10201] Port &apos;Make flush decisions per column family&apos; to trunk</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10201</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Currently the flush decision is made using the aggregate size of all column families. When large and small column families co-exist, this causes many small flushes of the smaller CF. We need to make per-CF flush decisions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12685435">HBASE-10201</key>
            <summary>Port &apos;Make flush decisions per column family&apos; to trunk</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="Apache9">Duo Zhang</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Dec 2013 19:08:41 +0000</created>
                <updated>Sun, 19 Jul 2015 12:33:56 +0000</updated>
                            <resolved>Tue, 16 Dec 2014 20:01:08 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                    <component>wal</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>21</watches>
                                                                <comments>
                            <comment id="13852034" author="yuzhihong@gmail.com" created="Wed, 18 Dec 2013 19:09:43 +0000"  >&lt;p&gt;Work in progress&lt;/p&gt;</comment>
                            <comment id="14168970" author="apache9" created="Mon, 13 Oct 2014 05:36:15 +0000"  >&lt;p&gt;I port the 3149-trunk-v1.txt patch to branch 0.98(a &quot;just make it work&quot; version, not the final version). &lt;/p&gt;

&lt;p&gt;Port to master is more difficult because of the rewrite of HLog. &lt;br/&gt;
Flush per CF means we need to record the oldest sequence id per store instead of per region, so the patch add a seqNum parameter when add kv to store, which means we need to know the seqNum before we add kv to store.&lt;br/&gt;
It is easy on branch 0.98, just need to change the order of appendNoSync of wal and write back to memstore(am I right?). But on master, HLog seems to use a event-driven framework, and I am not sure when will the seqNum be determined.&lt;/p&gt;

&lt;p&gt;The second problem is the flushSeqId. on 0.98, it is just a simple incAndGet, but on master it uses a method in HLog. So on 0.98, if we only flush some of the stores, we can set the flushSeqId to the oldest seqNum stored in the stores that not being flushed and do not inc sequenceId. But on master, I do not know the side effect of the method.Is it ok to remove the method call, or we still need to log something?&lt;/p&gt;</comment>
                            <comment id="14170602" author="apache9" created="Tue, 14 Oct 2014 06:57:48 +0000"  >&lt;p&gt;According to Ted Yu&apos;s suggestion, add a testcase called testCompareStoreFileCount in TestPerColumnFamilyFlush to confirm we really reduce the number of store files with this patch.&lt;/p&gt;</comment>
                            <comment id="14171204" author="yuzhihong@gmail.com" created="Tue, 14 Oct 2014 16:48:20 +0000"  >&lt;p&gt;There&apos;re calls to System.out.println() in the test, can you switch to calling LOG ?&lt;/p&gt;</comment>
                            <comment id="14171950" author="apache9" created="Wed, 15 Oct 2014 03:58:03 +0000"  >&lt;p&gt;Running with TestPerColumnFamilyFlush.&lt;/p&gt;

&lt;p&gt;3 CFs, 16B value for CF1, 256B value for CF2 and 4K value for CF3, 1M rows, 128M memstore flush size, 16M CF flush size.&lt;/p&gt;

&lt;p&gt;Result without per CF flush:&lt;br/&gt;
NumStoreFiles: 7, StoreFileSize: 4336644762, NumCompactionsCompleted: 46, NumFilesCompacted: 146, NumBytesCompacted: 11132103132&lt;br/&gt;
Write amplification: 2.57&lt;/p&gt;

&lt;p&gt;Result with per CF flush:&lt;br/&gt;
NumStoreFiles: 10, StoreFileSize: 4482510274, NumCompactionsCompleted: 27, NumFilesCompacted: 89, NumBytesCompacted: 10353603767&lt;br/&gt;
Write amplification: 2.31&lt;/p&gt;

&lt;p&gt;Next I will run this benchmark on a real cluster instead of minicluster.&lt;/p&gt;
</comment>
                            <comment id="14172250" author="apache9" created="Wed, 15 Oct 2014 10:44:45 +0000"  >&lt;p&gt;Run the same benchmark on a 3 regionservers cluster(2 * Xeon E5-2650 2.6G, 3T * 11 sata), the result is smililar.&lt;/p&gt;

&lt;p&gt;Without per CF flush:&lt;br/&gt;
metric_storeCount: 3,&lt;br/&gt;
metric_storeFileCount: 9,&lt;br/&gt;
metric_memStoreSize: 39965016,&lt;br/&gt;
metric_storeFileSize: 4460709275,&lt;br/&gt;
metric_compactionsCompletedCount: 46,&lt;br/&gt;
metric_numBytesCompactedCount: 11030906070,&lt;br/&gt;
metric_numFilesCompactedCount: 145,&lt;br/&gt;
Write amplification: 2.47&lt;/p&gt;

&lt;p&gt;With per CF flush:&lt;br/&gt;
metric_storeCount: 3,&lt;br/&gt;
metric_storeFileCount: 7,&lt;br/&gt;
metric_memStoreSize: 110195648,&lt;br/&gt;
metric_storeFileSize: 4369570622,&lt;br/&gt;
metric_compactionsCompletedCount: 27,&lt;br/&gt;
metric_numBytesCompactedCount: 10353718691,&lt;br/&gt;
metric_numFilesCompactedCount: 89,&lt;br/&gt;
Write amplification: 2.37&lt;/p&gt;

&lt;p&gt;The patch has a big impact on compactionsCompletedCount, but a small impact on numBytesCompactedCount. This is reasonable, the patch only prevent flushing small files of small CFs and reduce its compaction number, but most numBytesCompactedCount is contributed by large CFs which is not effected(or at least, very small) by this patch. So we only get a small improvement of write amplification(5%~10%).&lt;/p&gt;</comment>
                            <comment id="14176532" author="apache9" created="Mon, 20 Oct 2014 02:05:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;excuse me, I am currently working on porting &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3149&quot; title=&quot;Make flush decisions per column family&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3149&quot;&gt;&lt;del&gt;HBASE-3149&lt;/del&gt;&lt;/a&gt;. I ported it to 0.98 and collected some stats. The result was posted above.&lt;/p&gt;

&lt;p&gt;I need some help to know whether it is worth to solve &quot;many flushes of small CFs&quot; by this approach, and also some comments of the patch itself.&lt;/p&gt;

&lt;p&gt;Thanks very much.&lt;/p&gt;</comment>
                            <comment id="14176543" author="apache9" created="Mon, 20 Oct 2014 02:28:57 +0000"  >&lt;p&gt;sorry, should be &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14179383" author="apache9" created="Wed, 22 Oct 2014 00:18:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaurav.menghani&quot; class=&quot;user-hover&quot; rel=&quot;gaurav.menghani&quot;&gt;Gaurav Menghani&lt;/a&gt;&lt;br/&gt;
excuse me, I need some help of porting &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3149&quot; title=&quot;Make flush decisions per column family&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3149&quot;&gt;&lt;del&gt;HBASE-3149&lt;/del&gt;&lt;/a&gt; to master, Thanks. &lt;/p&gt;</comment>
                            <comment id="14179387" author="gaurav.menghani" created="Wed, 22 Oct 2014 00:20:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt;&lt;br/&gt;
Sure. Let me know how can I help.&lt;/p&gt;

&lt;p&gt;Also, can you show how you calculate WAF?&lt;/p&gt;</comment>
                            <comment id="14179391" author="apache9" created="Wed, 22 Oct 2014 00:24:43 +0000"  >&lt;p&gt;just using numBytesCompactedCount/storeFileSize&lt;/p&gt;</comment>
                            <comment id="14179413" author="apache9" created="Wed, 22 Oct 2014 00:34:56 +0000"  >&lt;p&gt;The original patch is created about one year ago, so patch it to current HBase codebase is more like a rewriting...&lt;/p&gt;

&lt;p&gt;I am familiar with 0.98, so I first patched it to 0.98 to see whether it works fine.&lt;/p&gt;

&lt;p&gt;If it works, I will try to port it to master(another rewrite... there is also a big difference between master and 0.98...)&lt;/p&gt;

&lt;p&gt;According to Ted Yu&apos;s suggestion, I need some comments of other committers and the original author of this patch, Thanks.&lt;/p&gt;</comment>
                            <comment id="14179803" author="apache9" created="Wed, 22 Oct 2014 10:57:26 +0000"  >&lt;p&gt;After reading master&apos;s FSHLog carefully, I found that it is hard to add a kv to store with seqNum.&lt;/p&gt;

&lt;p&gt;FSHLog use Disruptor to append WAL, and the sequenceId of region is determined in the consumer thread, not the thread calling appendNoSync, which means the logSeqNum in HLogKey may have not been set after calling appendNoSync, and there is no guaranty of when will the value be set except syncing WAL. &lt;/p&gt;

&lt;p&gt;Move memstore modification after syncing WAL has a big impact on the code and I do not think its a good idea.&lt;/p&gt;

&lt;p&gt;I will try to find another way to record the oldest sequenceId per store which works both for 0.98 and master(maybe a data structure like mvcc, but per store).&lt;/p&gt;</comment>
                            <comment id="14184980" author="apache9" created="Mon, 27 Oct 2014 09:11:35 +0000"  >&lt;p&gt;Sorry I was wrong, getSequenceId in HLogKey will block until logSeqNum is set, so I can get the sequence id before syncing WAL. But I do not want to change the order when mutate, so I add a method to record oldestSequenceId, which is called after WAL appendNoSync and before releasing updateLock.&lt;/p&gt;

&lt;p&gt;The patch passed all unit tests on my machine.&lt;/p&gt;</comment>
                            <comment id="14184997" author="anoop.hbase" created="Mon, 27 Oct 2014 09:31:52 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-comment&quot;&gt;// ------------------------------------------------------------------
&lt;/span&gt;+      &lt;span class=&quot;code-comment&quot;&gt;// STEP 6. Record oldest sequence id of memstore
&lt;/span&gt;+      &lt;span class=&quot;code-comment&quot;&gt;// ------------------------------------------------------------------
&lt;/span&gt;+      &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; seqId = walKey.getSequenceId();
+      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Store store: storesUpdated) {
+        store.setSeqIdOfOldestEdit(seqId);
+      }
+
       &lt;span class=&quot;code-comment&quot;&gt;// -------------------------------
&lt;/span&gt;-      &lt;span class=&quot;code-comment&quot;&gt;// STEP 6. Release row locks, etc.
&lt;/span&gt;+      &lt;span class=&quot;code-comment&quot;&gt;// STEP 7. Release row locks, etc.
&lt;/span&gt;       &lt;span class=&quot;code-comment&quot;&gt;// -------------------------------
&lt;/span&gt;       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (locked) {
         &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.updatesLock.readLock().unlock();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Adding this step here under rowlocks will make us wait more and will affect write throughput. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; done some test related to this in another Jira.&lt;/p&gt;</comment>
                            <comment id="14185013" author="apache9" created="Mon, 27 Oct 2014 09:55:16 +0000"  >&lt;p&gt;This step must be done here unless we change the behavior of internalFlushcache.&lt;/p&gt;

&lt;p&gt;In internalFlushcache, we do the following step&lt;/p&gt;

&lt;p&gt;acquire updatesLock-&amp;gt;begin mvcc insert-&amp;gt;prepare flush-&amp;gt;release updatesLock-&amp;gt;advance mvcc-&amp;gt;flushing&lt;/p&gt;

&lt;p&gt;seqIdOfOldestEdit is used by prepare flush to get a flushSeqId(because we do not flush all stores). If we do not record seqIdOfOldestEdit under updatesLock, we may get an inconsistent &lt;br/&gt;
view of the memstore&apos;s snapshot and seqIdOfOldestEdit.&lt;/p&gt;

&lt;p&gt;Maybe I canonly record it when perColumnFamilyFlushEnabled is true?&lt;/p&gt;

</comment>
                            <comment id="14185023" author="apache9" created="Mon, 27 Oct 2014 10:10:44 +0000"  >&lt;p&gt;oh, I think there is a trick to optimize it.&lt;/p&gt;

&lt;p&gt;In most case, store.setSeqIdOfOldestEdit(seqId) will not change the value of seqIdOfOldestEdit because the sequence id is increase and we need to record the smallest one.&lt;/p&gt;

&lt;p&gt;maybe we can record current sequence id before appendNoSync, and compare it with seqIdOfOldestEdit, if it is already larger than seqIdOfOldestEdit then we can skip the setSeqIdOfOldestEdit call because the actual sequence id must be larger than current sequence id value.&lt;/p&gt;</comment>
                            <comment id="14185032" author="anoop.hbase" created="Mon, 27 Oct 2014 10:22:03 +0000"  >&lt;p&gt;hmm&lt;br/&gt;
set older seqId is a one time op for a given store. (In period of one flush to next) So within HRegion level itself u can handle. Memstore API is really needed?&lt;br/&gt;
Also please note that there are other methods in HRegion in which the data addition will happen. See mutateRowsWithLocks for eg:&lt;/p&gt;</comment>
                            <comment id="14185050" author="apache9" created="Mon, 27 Oct 2014 10:37:16 +0000"  >&lt;p&gt;The original patch store the value in memstore so I store it memstore either. I think it is OK to handle it within HRegion level(just use a Map).&lt;/p&gt;

&lt;p&gt;I have modified 4 methods, which are &lt;/p&gt;

&lt;p&gt;append(Append, long, long)&lt;br/&gt;
doMiniBatchMutation(BatchOperationInProgress&amp;lt;?&amp;gt;)&lt;br/&gt;
increment(Increment, long, long)&lt;br/&gt;
processRowsWithLocks(RowProcessor&amp;lt;?, ?&amp;gt;, long, long, long)&lt;/p&gt;

&lt;p&gt;Is there any other method which add data to a HRegion? I found these methods by referencing the call to mvcc.completeMemstoreInsertWithSeqNum.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14185054" author="anoop.hbase" created="Mon, 27 Oct 2014 10:41:45 +0000"  >&lt;p&gt;Oh I just noticed doMiniBatchMutation.. I think I didn&apos;t read it fully.  Handling all these places means just fine..&lt;/p&gt;</comment>
                            <comment id="14185102" author="hadoopqa" created="Mon, 27 Oct 2014 12:52:04 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12677274/HBASE-10201.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12677274/HBASE-10201.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12677274&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 29 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 3795 checkstyle errors (more than the trunk&apos;s current 3791 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +  private final ConcurrentMap&amp;lt;Store, Long&amp;gt; lastStoreFlushTimeMap = new ConcurrentHashMap&amp;lt;Store, Long&amp;gt;();&lt;br/&gt;
+      Iterator&amp;lt;Store&amp;gt; it = storesToFlush.iterator(); // stores.values() and storeFlushCtxs have same order&lt;br/&gt;
+      StringUtils.byteDesc(totalFlushableSizeOfFlushableStores) + &quot;/&quot; + totalFlushableSizeOfFlushableStores +&lt;br/&gt;
+   * oldestUnflushedRegionSequenceIds. We use these Maps to find out the low bound regions sequence id, or&lt;br/&gt;
+      lowestFlushingRegionSequenceIdsLocal = new HashMap&amp;lt;byte[], Long&amp;gt;(this.lowestFlushingRegionSequenceIds);&lt;br/&gt;
+          Long oldValue = this.lowestFlushingRegionSequenceIds.put(encodedRegionName, oldRegionSeqNum);&lt;br/&gt;
+      hlog.startCacheFlush(hri1.getEncodedNameAsBytes(), Long.MAX_VALUE, Long.MAX_VALUE, sequenceId1);&lt;br/&gt;
+  private void flushRegion(HLog hlog, byte[] regionEncodedName, AtomicLong sequenceId) throws IOException {&lt;br/&gt;
+                final HLog wal, final long myseqid, Collection&amp;lt;Store&amp;gt; storesToFlush, MonitoredTask status)&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestHCM&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11471//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14185256" author="apache9" created="Mon, 27 Oct 2014 15:42:30 +0000"  >&lt;p&gt;Modified according to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt; &apos;s suggestion.&lt;/p&gt;

&lt;p&gt;Add a lowestPossibleSeqId check to avoid waiting for sequence id to set every time.&lt;/p&gt;

&lt;p&gt;Move oldestSeqId to HRegion, do not modify Store and MemStore. And only record oldestSeqId when perColumnFamilyFlushEnabled is true.&lt;/p&gt;</comment>
                            <comment id="14185472" author="hadoopqa" created="Mon, 27 Oct 2014 17:38:45 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12677319/HBASE-10201_1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12677319/HBASE-10201_1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12677319&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +   * oldestUnflushedRegionSequenceIds. We use these Maps to find out the low bound regions sequence id, or&lt;br/&gt;
+      lowestFlushingRegionSequenceIdsLocal = new HashMap&amp;lt;byte[], Long&amp;gt;(this.lowestFlushingRegionSequenceIds);&lt;br/&gt;
+          Long oldValue = this.lowestFlushingRegionSequenceIds.put(encodedRegionName, oldRegionSeqNum);&lt;br/&gt;
+      hlog.startCacheFlush(hri1.getEncodedNameAsBytes(), Long.MAX_VALUE, Long.MAX_VALUE, sequenceId1);&lt;br/&gt;
+  private void flushRegion(HLog hlog, byte[] regionEncodedName, AtomicLong sequenceId) throws IOException {&lt;br/&gt;
+                final HLog wal, final long myseqid, Collection&amp;lt;Store&amp;gt; storesToFlush, MonitoredTask status)&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11476//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14185675" author="stack" created="Mon, 27 Oct 2014 19:37:49 +0000"  >&lt;p&gt;Default is DEFAULT_MEMSTORE_COLUMNFAMILY_FLUSH_SIZE 16MB?  Where that come from?  If one column family only then we will flush at this lower size rather than the usual? Should it default to flush size for region?&lt;/p&gt;

&lt;p&gt;Oh, seems like this is lower bound.  Only familys &amp;gt; than this size get flushed.  Thats nice. Need to rename I&apos;d say. .... DEFAULT_MEMSTORE_COLUMNFAMILY_FLUSH_SIZE_LOWER_BOUND?&lt;/p&gt;

&lt;p&gt;nit: &apos;+    (just as usual). This value should less than half of the total memstore&apos; missing a &apos;be&apos;&lt;/p&gt;

&lt;p&gt;Are we double-accounting here?&lt;/p&gt;

&lt;p&gt;+  // keep track of oldest sequence id of edit in a store.&lt;br/&gt;
+  private final ConcurrentMap&amp;lt;Store, AtomicLong&amp;gt; oldestSeqIdOfStore =&lt;br/&gt;
+      new ConcurrentHashMap&amp;lt;Store, AtomicLong&amp;gt;();&lt;/p&gt;

&lt;p&gt;The oldest seqid to region is being done by the WAL subsystem IIRC. Now we are doing it in here by Store.  Should we do it in the one place only?  The WAL is keeping accounting so it knows when to release WALs that no longer have edits.  Does this accounting interfere?&lt;/p&gt;

&lt;p&gt;Also, sometimes we flush because we want to clear out memstores that are holding old edits just so we can cleanup our backlog of WAL files. Do you see this change intefering with this facility (we&apos;d just not pass the selectiveFlushRequest in this case? (Oh, I see later that you are aware of this issue and intentionally set selectiveFlushRequest to false when we roll logs &amp;#8211; good).&lt;/p&gt;

&lt;p&gt;Add a log WARN here: +    if (columnfamilyFlushSize &amp;lt;= 0) { ?&lt;/p&gt;

&lt;p&gt;Name &apos;getMinFlushTimeForAllStores&apos; as &apos;getEarliestFlushTimeForAllStore&apos;? I think it clearer that it does if you have &apos;earlier&apos; in there (as you have it in your comments). In sympathy add &apos;latest&apos; into this method name getMaxFlushTimeForAllStores&lt;/p&gt;

&lt;p&gt;Do these two above methods need to be public?  Can they be package private? Do they need to be exposed at all? Ditto for this isPerColumnFamilyFlushEnabled and flushcache&lt;/p&gt;

&lt;p&gt;Should be a WARN: +      LOG.debug(&quot;Disabling selective flushing of Column Families&apos; memstores.&quot;); ?&lt;/p&gt;

&lt;p&gt;This comment right?  Should it be &apos;region&apos; rather than &apos;memstore&apos; in some of the below?&lt;/p&gt;

&lt;p&gt;+        // We now have to flush the memstore since it has&lt;br/&gt;
+        // reached the threshold, however, we might not need&lt;br/&gt;
+        // to flush the entire memstore. If there are certain&lt;/p&gt;


&lt;p&gt;Make one log line rather than two:&lt;br/&gt;
+    LOG.info(&quot;Started memstore flush for &quot; + this + &quot;, current region memstore size &quot;&lt;br/&gt;
+        + StringUtils.byteDesc(this.memstoreSize.get()) + &quot;, and &quot; + storesToFlush.size() + &quot;/&quot;&lt;br/&gt;
+        + stores.size() + &quot; column families&apos; memstores are being flushed.&quot;&lt;br/&gt;
+        + ((wal != null) ? &quot;&quot; : &quot;; wal is null, using passed sequenceid=&quot; + myseqid));&lt;br/&gt;
+    for (Store store: storesToFlush) {&lt;/p&gt;

&lt;p&gt;How you justify removing this?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;flushSeqId = getNextSequenceId(wal);&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;nit: in below....&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if ((now - getLastFlushTime() &amp;lt; flushCheckInterval)) {&lt;br/&gt;
+    if ((now - getMinFlushTimeForAllStores() &amp;lt; flushCheckInterval)) {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The former is &apos;LastFlushTime&apos; and the new code is &apos;MinFlushTime&apos;... which should it be?  Do we intend same thing here?&lt;/p&gt;

&lt;p&gt;Instead of +    for (AtomicLong oldestSeqId: needToUpdate) {&lt;br/&gt;
... can you use what is in AtomicUtils?&lt;/p&gt;

&lt;p&gt;Thanks for doing this:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;long totalSize = 0l;&lt;br/&gt;
+      long totalSize = 0L;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;THis can&apos;t be package private getOldestSeqIdOfStore ?&lt;/p&gt;

&lt;p&gt;What is difference between oldest and lowest in below?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Map&amp;lt;byte[], Long&amp;gt; oldestFlushingSeqNumsLocal = null;&lt;/li&gt;
	&lt;li&gt;Map&amp;lt;byte[], Long&amp;gt; oldestUnflushedSeqNumsLocal = null;&lt;br/&gt;
+    Map&amp;lt;byte[], Long&amp;gt; lowestFlushingRegionSequenceIdsLocal = null;&lt;br/&gt;
+    Map&amp;lt;byte[], Long&amp;gt; oldestUnflushedRegionSequenceIdsLocal = null;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Hmm... looking at FSHLog., you seem to be doing good accounting by passing in the stores to flush AND the stores we are not flushing....&lt;/p&gt;

&lt;p&gt;Nice test.&lt;/p&gt;

&lt;p&gt;This patch is looking great. I&apos;d say it should be on by default in master branch at least and possibly on by default in branch-1 too.  Do up nice release note.  That it passed all unit tests is encouraging.  Need to run with the it rig to see if dataloss.&lt;/p&gt;







</comment>
                            <comment id="14185676" author="stack" created="Mon, 27 Oct 2014 19:40:27 +0000"  >&lt;p&gt;I set to 0.99.2  Would be good to get in if only as experimental.  Nice improvement.&lt;/p&gt;</comment>
                            <comment id="14186683" author="apache9" created="Tue, 28 Oct 2014 10:45:52 +0000"  >&lt;p&gt;fix some typo&lt;/p&gt;

&lt;p&gt;rename some methods and fields&lt;/p&gt;

&lt;p&gt;use AtomicUtils.updateMin&lt;/p&gt;

&lt;p&gt;change DEFAULT_HREGION_MEMSTORE_PER_COLUMN_FAMILY_FLUSH to true to make the option open by default.&lt;/p&gt;
</comment>
                            <comment id="14186735" author="apache9" created="Tue, 28 Oct 2014 11:51:43 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Oh, seems like this is lower bound. Only familys &amp;gt; than this size get flushed. Thats nice. Need to rename I&apos;d say. .... DEFAULT_MEMSTORE_COLUMNFAMILY_FLUSH_SIZE_LOWER_BOUND?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Done&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;nit: &apos;+ (just as usual). This value should less than half of the total memstore&apos; missing a &apos;be&apos;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Done&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Are we double-accounting here?&lt;br/&gt;
+ // keep track of oldest sequence id of edit in a store.&lt;br/&gt;
+ private final ConcurrentMap&amp;lt;Store, AtomicLong&amp;gt; oldestSeqIdOfStore =&lt;br/&gt;
+ new ConcurrentHashMap&amp;lt;Store, AtomicLong&amp;gt;();&lt;br/&gt;
The oldest seqid to region is being done by the WAL subsystem IIRC. Now we are doing it in here by Store. Should we do it in the one place only? The WAL is keeping accounting so it knows when to release WALs that no longer have edits. Does this accounting interfere?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I add a comment on it to noticed that there is a duplication. There is also other duplication in HRegion such as lastFlushSeqId. And for oldestSeqIdOfStore, I think it is better to store it in FSHLog because it is single-threaded and sequence id is generated in that thread, the update logic can be more straight forward without any performance issue, and also, only need to modify one place instead of four places in current solution. But this means we change FSHLog&apos;s tracking unit from Region to Store, there may be a lot of work to do which is not related to this issue. I think it is better to open another issue to handle the duplication.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Add a log WARN here: + if (columnfamilyFlushSize &amp;lt;= 0) { ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is same with memstoreFlushSize&apos;s initialize code above. &amp;lt; 0 is possible if it is not set in HTableDescriptor.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Name &apos;getMinFlushTimeForAllStores&apos; as &apos;getEarliestFlushTimeForAllStore&apos;? I think it clearer that it does if you have &apos;earlier&apos; in there (as you have it in your comments). In sympathy add &apos;latest&apos; into this method name getMaxFlushTimeForAllStores&lt;br/&gt;
Do these two above methods need to be public? Can they be package private? Do they need to be exposed at all? Ditto for this isPerColumnFamilyFlushEnabled and flushcache&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Renaming is done. getEarliestFlushTimeForAllStore should be public because TestIOFencing use it(which in another package). For other methods, they can be package private, but I see lots of other similar methods declared as public...&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Should be a WARN: + LOG.debug(&quot;Disabling selective flushing of Column Families&apos; memstores.&quot;); ?&lt;br/&gt;
This comment right? Should it be &apos;region&apos; rather than &apos;memstore&apos; in some of the below?&lt;br/&gt;
+ // We now have to flush the memstore since it has&lt;br/&gt;
+ // reached the threshold, however, we might not need&lt;br/&gt;
+ // to flush the entire memstore. If there are certain&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Done&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Make one log line rather than two:&lt;br/&gt;
+ LOG.info(&quot;Started memstore flush for &quot; + this + &quot;, current region memstore size &quot;&lt;br/&gt;
+ + StringUtils.byteDesc(this.memstoreSize.get()) + &quot;, and &quot; + storesToFlush.size() + &quot;/&quot;&lt;br/&gt;
+ + stores.size() + &quot; column families&apos; memstores are being flushed.&quot;&lt;br/&gt;
+ + ((wal != null) ? &quot;&quot; : &quot;; wal is null, using passed sequenceid=&quot; + myseqid));&lt;br/&gt;
+ for (Store store: storesToFlush) {&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I use a formatter to wrap it automatically. I modify it manually to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;HRegion.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Started memstore flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt; + &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;, current region memstore size &quot;&lt;/span&gt; + StringUtils.byteDesc(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.memstoreSize.get())
        + &lt;span class=&quot;code-quote&quot;&gt;&quot;, and &quot;&lt;/span&gt; + storesToFlush.size() + &lt;span class=&quot;code-quote&quot;&gt;&quot;/&quot;&lt;/span&gt;  + stores.size() + &lt;span class=&quot;code-quote&quot;&gt;&quot; column families&apos; memstores are being flushed.&quot;&lt;/span&gt;
        + ((wal != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) ? &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot; : &quot;&lt;/span&gt;; wal is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, using passed sequenceid=&quot; + myseqid));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Does this meet the requirement?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;How you justify removing this?&lt;br/&gt;
flushSeqId = getNextSequenceId(wal);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;it is not removed. I move it startCacheFlush.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;nit: in below....&lt;br/&gt;
if ((now - getLastFlushTime() &amp;lt; flushCheckInterval)) {&lt;br/&gt;
+ if ((now - getMinFlushTimeForAllStores() &amp;lt; flushCheckInterval)) {&lt;br/&gt;
The former is &apos;LastFlushTime&apos; and the new code is &apos;MinFlushTime&apos;... which should it be? Do we intend same thing here?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think it should be getLatestFlushTimeForAllStores, not getEarliestFlushTimeForAllStores. Although we may not flush all the stores.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Instead of + for (AtomicLong oldestSeqId: needToUpdate) {&lt;br/&gt;
... can you use what is in AtomicUtils?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Use AtomicUtils.updateMin instead. Thanks.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;THis can&apos;t be package private getOldestSeqIdOfStore ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;TestPerColumnFamilyFlush need it and is in another package.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;What is difference between oldest and lowest in below?&lt;br/&gt;
Map&amp;lt;byte[], Long&amp;gt; oldestFlushingSeqNumsLocal = null;&lt;br/&gt;
Map&amp;lt;byte[], Long&amp;gt; oldestUnflushedSeqNumsLocal = null;&lt;br/&gt;
+ Map&amp;lt;byte[], Long&amp;gt; lowestFlushingRegionSequenceIdsLocal = null;&lt;br/&gt;
+ Map&amp;lt;byte[], Long&amp;gt; oldestUnflushedRegionSequenceIdsLocal = null;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;They are just copies of class fields, so just want to keep the same name with the class field name.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
oldestFlushingSeqNumsLocal = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[], &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt;(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.lowestFlushingRegionSequenceIds);		
oldestUnflushedSeqNumsLocal = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[], &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;&amp;gt;(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.oldestUnflushedRegionSequenceIds);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This looks uncomfortable...&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;This patch is looking great. I&apos;d say it should be on by default in master branch at least and possibly on by default in branch-1 too. Do up nice release note. That it passed all unit tests is encouraging. Need to run with the it rig to see if dataloss.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I change DEFAULT_HREGION_MEMSTORE_PER_COLUMN_FAMILY_FLUSH to true in the new patch, so it is turn on by default. I will run integration test to see if there is dataloss.&lt;/p&gt;

&lt;p&gt;Thanks very much for reviewing the patch so carefully.&lt;/p&gt;</comment>
                            <comment id="14186762" author="hadoopqa" created="Tue, 28 Oct 2014 12:38:37 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12677580/HBASE-10201_2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12677580/HBASE-10201_2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12677580&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +        + &quot;, and &quot; + storesToFlush.size() + &quot;/&quot;  + stores.size() + &quot; column families&apos; memstores are being flushed.&quot;&lt;br/&gt;
+   * oldestUnflushedRegionSequenceIds. We use these Maps to find out the low bound regions sequence id, or&lt;br/&gt;
+      lowestFlushingRegionSequenceIdsLocal = new HashMap&amp;lt;byte[], Long&amp;gt;(this.lowestFlushingRegionSequenceIds);&lt;br/&gt;
+          Long oldValue = this.lowestFlushingRegionSequenceIds.put(encodedRegionName, oldRegionSeqNum);&lt;br/&gt;
+      hlog.startCacheFlush(hri1.getEncodedNameAsBytes(), Long.MAX_VALUE, Long.MAX_VALUE, sequenceId1);&lt;br/&gt;
+  private void flushRegion(HLog hlog, byte[] regionEncodedName, AtomicLong sequenceId) throws IOException {&lt;br/&gt;
+                final HLog wal, final long myseqid, Collection&amp;lt;Store&amp;gt; storesToFlush, MonitoredTask status)&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11490//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14186916" author="apache9" created="Tue, 28 Oct 2014 15:01:43 +0000"  >&lt;p&gt;Wrap lines.&lt;/p&gt;</comment>
                            <comment id="14187090" author="hadoopqa" created="Tue, 28 Oct 2014 16:57:14 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12677610/HBASE-10201_3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12677610/HBASE-10201_3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12677610&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11492//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14188022" author="apache9" created="Wed, 29 Oct 2014 05:30:38 +0000"  >&lt;p&gt;Backport to branch-1.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I tried but failed to make dev-support/test-patch.sh work properly...&lt;/p&gt;

&lt;p&gt;So I only run the unit tests, sorry...&lt;/p&gt;</comment>
                            <comment id="14188024" author="hadoopqa" created="Wed, 29 Oct 2014 05:32:48 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12677829/HBASE-10201-0.99.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12677829/HBASE-10201-0.99.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12677829&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11501//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11501//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14188070" author="stack" created="Wed, 29 Oct 2014 06:32:06 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think it is better to open another issue to handle the duplication.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OK.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;getEarliestFlushTimeForAllStore should be public because TestIOFencing use it(which in another package). &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;FYI, we mark these with @VisibleForTesting annotation..  I can do on commit.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;....but I see lots of other similar methods declared as public...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, sorry about that; we ain&apos;t always consistent.... trying.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Does this meet the requirement?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes. Out of interest, are you using the hbase formatter?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I tried but failed to make dev-support/test-patch.sh work properly...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, this stuff is focused on the master.  Unit tests passing on branch-1 would be great. Just note it here in the issue.&lt;/p&gt;

&lt;p&gt;You going to try hbase-it?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14188093" author="apache9" created="Wed, 29 Oct 2014 07:12:20 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Out of interest, are you using the hbase formatter?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No, I just use the default formatter with indent and max length changed. Only new code is formatted, old code is &quot;format&quot; manually to keep the patch clean...&lt;br/&gt;
I will try the hbase formatter later. I found it when looking for test-patch.sh, thanks.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;You going to try hbase-it?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes I have run it with &apos;mvn verify&apos; under hbase-it. There are some fails and errors, I need to see the source code to identify the reason.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14189417" author="stack" created="Thu, 30 Oct 2014 01:07:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;Yes I have run it with &apos;mvn verify&apos; under hbase-it. There are some fails and errors, I need to see the source code to identify the reason.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Suggest you first run it before your patch is applied.  It may not be in healthy state currently.&lt;/p&gt;</comment>
                            <comment id="14189517" author="apache9" created="Thu, 30 Oct 2014 02:34:58 +0000"  >&lt;p&gt;Yes, I run without the patch first, the result is &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Results :&lt;/p&gt;

&lt;p&gt;Failed tests:&lt;br/&gt;
  IntegrationTestIngestWithACL&amp;gt;IntegrationTestBase.setUp:122-&amp;gt;setUpCluster:64-&amp;gt;IntegrationTestIngest.setUpCluster:88-&amp;gt;IntegrationTestIngest.initTable:93 Failed to initialize LoadTestTool expected:&amp;lt;0&amp;gt; but was:&amp;lt;1&amp;gt;&lt;/p&gt;

&lt;p&gt;Tests in error:&lt;br/&gt;
  IntegrationTestMTTR.testRestartRsHoldingTable:261-&amp;gt;run:305 ? Execution org.apa...&lt;/p&gt;

&lt;p&gt;Tests run: 20, Failures: 1, Errors: 1, Skipped: 1&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Result with patch is&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Results :&lt;/p&gt;

&lt;p&gt;Failed tests:&lt;br/&gt;
  IntegrationTestIngestWithVisibilityLabels&amp;gt;IntegrationTestIngest.testIngest:104-&amp;gt;IntegrationTestIngest.runIngestTest:166 Update failed with error code 1&lt;br/&gt;
  IntegrationTestIngestWithACL&amp;gt;IntegrationTestBase.setUp:122-&amp;gt;setUpCluster:64-&amp;gt;IntegrationTestIngest.setUpCluster:88-&amp;gt;IntegrationTestIngest.initTable:93 Failed to initialize LoadTestTool expected:&amp;lt;0&amp;gt; but was:&amp;lt;1&amp;gt;&lt;br/&gt;
  IntegrationTestIngestWithTags&amp;gt;IntegrationTestIngest.testIngest:104-&amp;gt;IntegrationTestIngest.runIngestTest:174 Verification failed with error code 1&lt;/p&gt;

&lt;p&gt;Tests in error:&lt;br/&gt;
  IntegrationTestMTTR.testRestartRsHoldingTable:261-&amp;gt;run:305 ? Execution org.apa...&lt;br/&gt;
  IntegrationTestMTTR.testMoveRegion:271-&amp;gt;run:305 ? Execution org.apache.hadoop....&lt;/p&gt;

&lt;p&gt;Tests run: 20, Failures: 3, Errors: 2, Skipped: 1&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;For IntegrationTestMTTR.testMoveRegion, it will be passed if I run it separately with other methods in the same class being commented, and using command &quot;mvn clean test-compile failsafe:integration-test -Dit.test=IntegrationTestMTTR -DfailIfNoTests=false&quot;.&lt;/p&gt;

&lt;p&gt;Now i&apos;m debugging IntegrationTestIngestWithVisibilityLabels, but the log is flooded with&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;java.io.IOException: Compression algorithm &apos;lz4&apos; previously failed test.&lt;br/&gt;
        at org.apache.hadoop.hbase.util.CompressionTest.testCompression(CompressionTest.java:90)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.checkCompressionCodecs(HRegion.java:4936)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4923)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4896)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4868)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4824)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4775)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.openRegion(OpenRegionHandler.java:276)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.process(OpenRegionHandler.java:103)&lt;br/&gt;
        at org.apache.hadoop.hbase.executor.EventHandler.run(EventHandler.java:103)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
java.io.IOException: Compression algorithm &apos;snappy&apos; previously failed test.&lt;br/&gt;
        at org.apache.hadoop.hbase.util.CompressionTest.testCompression(CompressionTest.java:90)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.checkCompressionCodecs(HRegion.java:4936)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4923)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4896)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4868)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4824)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:4775)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.openRegion(OpenRegionHandler.java:276)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler.process(OpenRegionHandler.java:103)&lt;br/&gt;
        at org.apache.hadoop.hbase.executor.EventHandler.run(EventHandler.java:103)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;and it is hard to find useful informations from the output.&lt;/p&gt;

&lt;p&gt;I have compiled hadoop native libs, but I do not know where to place it when running tests...&lt;/p&gt;

&lt;p&gt;Or is there a way to disable compression when running integration tests? I think the result will not be changed since the patch has nothing to do with compression...&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14190775" author="stack" created="Thu, 30 Oct 2014 20:29:45 +0000"  >&lt;p&gt;Let me review this patch once more.That all tests pass with it enabled is encouraging.  Can work on these it test failures separately. It is not your issue.&lt;/p&gt;</comment>
                            <comment id="14190804" author="gaurav.menghani" created="Thu, 30 Oct 2014 20:47:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; Great work porting this patch! Glad to see this getting ported from 0.89-fb to trunk &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Please let me know if you need any help.&lt;/p&gt;</comment>
                            <comment id="14190830" author="yuzhihong@gmail.com" created="Thu, 30 Oct 2014 20:59:58 +0000"  >&lt;p&gt;+1 on turning on this in master branch.&lt;/p&gt;</comment>
                            <comment id="14191008" author="stack" created="Thu, 30 Oct 2014 23:12:39 +0000"  >&lt;p&gt;I wrote the list to get another opinion on the patch pre-commit.&lt;/p&gt;

&lt;p&gt;Has this patch been deployed somewhere in production (smile?).  If so, would be good to know.  In production, it helps?&lt;/p&gt;

&lt;p&gt;On rereview:&lt;/p&gt;

&lt;p&gt;&quot; This value should be less than half of the total memstore&lt;br/&gt;
+    threshold (hbase.hregion.memstore.flush.size).&quot;&lt;/p&gt;

&lt;p&gt;Do we ensure this in code?  If not, should we?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think it is better to open another issue to handle the duplication.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Can you do this for the accounting fixup so by-Store in HLog.&lt;/p&gt;

&lt;p&gt;Should log when we do this:&lt;/p&gt;

&lt;p&gt;+    long columnfamilyFlushSize = this.htableDescriptor&lt;br/&gt;
+        .getMemStoreColumnFamilyFlushSize();&lt;br/&gt;
+    if (columnfamilyFlushSize &amp;lt;= 0) {&lt;br/&gt;
+      columnfamilyFlushSize = conf.getLong(&lt;br/&gt;
+          HConstants.HREGION_MEMSTORE_COLUMNFAMILY_FLUSH_SIZE_LOWER_BOUND,&lt;br/&gt;
+          HTableDescriptor.DEFAULT_MEMSTORE_COLUMNFAMILY_FLUSH_SIZE_LOWER_BOUND);&lt;/p&gt;

&lt;p&gt;I can add on commit unless we are doing a new version.&lt;/p&gt;

&lt;p&gt;This does not have to be public since it is used from same package:&lt;/p&gt;

&lt;p&gt;+  public long getEarliestFlushTimeForAllStores() {&lt;/p&gt;

&lt;p&gt;ditto this&lt;/p&gt;

&lt;p&gt;getLatestFlushTimeForAllStores&lt;/p&gt;

&lt;p&gt;And this ... isPerColumnFamilyFlushEnabled&lt;/p&gt;

&lt;p&gt;nit: Guard debug logging with an if LOG.isDebugEnabled... +            LOG.debug(&quot;Since none of the CFs were above the size, flushing all.&quot;);&lt;/p&gt;

&lt;p&gt;When we flush, we write the sequenceid flush to WAL.  This patch should have no effect on it.&lt;/p&gt;

&lt;p&gt;Sequenceids are region scoped.  If we flush by Store, will there be holes in our accounting?&lt;/p&gt;

&lt;p&gt;For example, given 3 column families, A, B, and C.&lt;/p&gt;

&lt;p&gt;I write sequenceid 1 to A, sequenceid 2 to B, and sequenceid 3 to C.  I then write sequence 4 to A.  The edit at sequenceid 4 is big and pushes us over and brings on a flush.  We flush A and edits 1 and 4.  Is the fact that edits 2 and 3 are still up in memory going to mess us up.... Say the server crashes, at replay time we see we flushed up to edit 4, will we think that we edits 2 and 3 persisted? If you don&apos;t have an answer, I can work on the answer.&lt;/p&gt;
</comment>
                            <comment id="14191015" author="gaurav.menghani" created="Thu, 30 Oct 2014 23:18:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; From my design, in this case, 1 and 4 are flushed, but 2 and 3 are retained in the memory. But we can only mark 1 as safe. 2, 3 and 4 will all be replayed if the server crashes. I am not sure, if this has changed in the patch.&lt;/p&gt;

&lt;p&gt;The Per-CF change is not running in prod right now. I didn&apos;t see any big difference deploying it out of the box with the biggest customer where we have a lot of CFs (probably also high-lighted by the small difference in WAF). But I can try running it internally on a shadow cluster again. Let me know if there are some interesting metrics you want me to look at.&lt;/p&gt;</comment>
                            <comment id="14191091" author="apache9" created="Fri, 31 Oct 2014 00:18:50 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Sequenceids are region scoped. If we flush by Store, will there be holes in our accounting?&lt;br/&gt;
I write sequenceid 1 to A, sequenceid 2 to B, and sequenceid 3 to C. I then write sequence 4 to A. The edit at sequenceid 4 is big and pushes us over and brings on a flush. We flush A and edits 1 and 4. Is the fact that edits 2 and 3 are still up in memory going to mess us up.... Say the server crashes, at replay time we see we flushed up to edit 4, will we think that we edits 2 and 3 persisted? If you don&apos;t have an answer, I can work on the answer.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, we write flush seqId 1(Oh I made a mistake, I write seqId 2 in this case, &quot;flushSeqId = oldestSeqIdInStoresNotToFlush&quot; should be  &quot;flushSeqId = oldestSeqIdInStoresNotToFlush - 1&quot;, I will fix it) in this case, so there will be holes and some WAL replay is unnecessary when doing recovery. &lt;/p&gt;

&lt;p&gt;We need to store a map of seqId per store instead of a single seqId to solve this, and also need some efforts on log truncation and log replay.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Has this patch been deployed somewhere in production (smile?). If so, would be good to know. In production, it helps?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;For me, no. I am using 0.98.6.1 with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12078&quot; title=&quot;Missing Data when scanning using PREFIX_TREE DATA-BLOCK-ENCODING&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12078&quot;&gt;&lt;del&gt;HBASE-12078&lt;/del&gt;&lt;/a&gt; patched right now(so I first try to port it to 0.98 in this issue...).&lt;br/&gt;
Some test result is posted above. And in our production, I always see log like this&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;2014-09-29 13:16:25,061 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;MemStoreFlusher.0&amp;#93;&lt;/span&gt; regionserver.HRegion: Started memstore flush for sync:Snapshot,\x00\x00\x00\x00\x02$\x0CC,1411782012686.50aba6be7ff3150be983cb6fd77fc686., current region memstore size 128.3 M&lt;br/&gt;
2014-09-29 13:16:25,121 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;MemStoreFlusher.0&amp;#93;&lt;/span&gt; regionserver.DefaultStoreFlusher: Flushed, sequenceid=10932563, memsize=265.7 K, hasBloomFilter=true, into tmp file hdfs://online-hbase/hbase/data/sync/Snapshot/50aba6be7ff315&lt;br/&gt;
0be983cb6fd77fc686/.tmp/129e5ef69d7449fea9c2357aa6c4340a&lt;br/&gt;
2014-09-29 13:16:25,192 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;MemStoreFlusher.0&amp;#93;&lt;/span&gt; regionserver.DefaultStoreFlusher: Flushed, sequenceid=10932563, memsize=2.2 M, hasBloomFilter=true, into tmp file hdfs://online-hbase/hbase/data/sync/Snapshot/50aba6be7ff3150b&lt;br/&gt;
e983cb6fd77fc686/.tmp/316fee39423142e09cdb767de9f9bc5d&lt;br/&gt;
2014-09-29 13:16:25,528 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;MemStoreFlusher.0&amp;#93;&lt;/span&gt; regionserver.DefaultStoreFlusher: Flushed, sequenceid=10932563, memsize=27.9 M, hasBloomFilter=true, into tmp file hdfs://online-hbase/hbase/data/sync/Snapshot/50aba6be7ff3150&lt;br/&gt;
be983cb6fd77fc686/.tmp/a886c1e39565468fbf93be6c434f5fc5&lt;br/&gt;
2014-09-29 13:16:26,190 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;MemStoreFlusher.0&amp;#93;&lt;/span&gt; regionserver.DefaultStoreFlusher: Flushed, sequenceid=10932563, memsize=98.0 M, hasBloomFilter=true, into tmp file hdfs://online-hbase/hbase/data/sync/Snapshot/50aba6be7ff3150&lt;br/&gt;
be983cb6fd77fc686/.tmp/ec722497c6e14d0fa732c2a9d29e3391&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The smallest store is always flushed with only KBs. That&apos;s the reason why I found this issue and started to working on it...&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Can you do this for the accounting fixup so by-Store in HLog.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, I can open another issue to work on this.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14191117" author="hadoopqa" created="Fri, 31 Oct 2014 00:43:13 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12678367/HBASE-10201_4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12678367/HBASE-10201_4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12678367&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11531//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11531//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14191200" author="apache9" created="Fri, 31 Oct 2014 02:19:03 +0000"  >&lt;p&gt;rebase since master&apos;s HEAD has been moved.&lt;/p&gt;</comment>
                            <comment id="14191203" author="stack" created="Fri, 31 Oct 2014 02:23:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaurav.menghani&quot; class=&quot;user-hover&quot; rel=&quot;gaurav.menghani&quot;&gt;Gaurav Menghani&lt;/a&gt; Thank you for helping land this upstream and thanks for the update on its state at your shop.  What about the recording of last-flushed-sequenceid at the master so it knows what it can safely skip replaying edits on crash for a region; would that only report &apos;1&apos; in our scenario above?  Thanks.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; Thanks for the new patch. I think I need to go through and check sequenceid accounting.&lt;/p&gt;</comment>
                            <comment id="14191302" author="hadoopqa" created="Fri, 31 Oct 2014 03:58:39 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12678382/HBASE-10201_5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12678382/HBASE-10201_5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12678382&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.coprocessor.TestCoprocessorHConnection&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11533//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14198411" author="jmspaggi" created="Wed, 5 Nov 2014 14:16:57 +0000"  >&lt;p&gt;Do you have the metrics with the last version of the patch?&lt;/p&gt;

&lt;p&gt;From a previous version it was:&lt;br/&gt;
With per CF flush:&lt;br/&gt;
metric_storeCount: 3,&lt;br/&gt;
metric_storeFileCount: 7,&lt;br/&gt;
metric_memStoreSize: 110195648,&lt;br/&gt;
metric_storeFileSize: 4369570622,&lt;br/&gt;
metric_compactionsCompletedCount: 27,&lt;br/&gt;
metric_numBytesCompactedCount: 10353718691,&lt;br/&gt;
metric_numFilesCompactedCount: 89,&lt;br/&gt;
Write amplification: 2.37&lt;/p&gt;

&lt;p&gt;Does it changed?&lt;/p&gt;</comment>
                            <comment id="14198501" author="apache9" created="Wed, 5 Nov 2014 15:17:57 +0000"  >&lt;p&gt;No, I have not run the test on master branch yet. I will run it tomorrow cause it is already 23:15 in China...&lt;/p&gt;

&lt;p&gt;Sad for the time zone difference...&lt;/p&gt;</comment>
                            <comment id="14199822" author="apache9" created="Thu, 6 Nov 2014 05:30:07 +0000"  >&lt;p&gt;Results on master branch&lt;/p&gt;

&lt;p&gt;2.0.0-SNAPSHOT, revision=ecd708671c135052a175c88603d5215a0434e4fa&lt;/p&gt;

&lt;p&gt;metric_storeCount: 3,&lt;br/&gt;
metric_storeFileCount: 9,&lt;br/&gt;
metric_memStoreSize: 40117320,&lt;br/&gt;
metric_storeFileSize: 4461018704,&lt;br/&gt;
metric_compactionsCompletedCount: 92,&lt;br/&gt;
metric_numBytesCompactedCount: 22091556672,&lt;br/&gt;
metric_numFilesCompactedCount: 290&lt;br/&gt;
Write amplification(numBytesCompactedCount/storeFileSize): 4.95&lt;br/&gt;
Elapsed time: 23m32s&lt;/p&gt;

&lt;p&gt;2.0.0-SNAPSHOT, revision=ecd708671c135052a175c88603d5215a0434e4fa with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
metric_storeCount: 3,&lt;br/&gt;
metric_storeFileCount: 8,&lt;br/&gt;
metric_memStoreSize: 16400424,&lt;br/&gt;
metric_storeFileSize: 4483028246,&lt;br/&gt;
metric_compactionsCompletedCount: 54,&lt;br/&gt;
metric_numBytesCompactedCount: 20497293164,&lt;br/&gt;
metric_numFilesCompactedCount: 178&lt;br/&gt;
Write amplification(numBytesCompactedCount/storeFileSize): 4.57&lt;br/&gt;
Elapsed time: 23m5s&lt;/p&gt;

&lt;p&gt;2.0.0-SNAPSHOT, revision=ecd708671c135052a175c88603d5215a0434e4fa with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; but disable selective flush&lt;br/&gt;
metric_storeCount: 3,&lt;br/&gt;
metric_storeFileCount: 9,&lt;br/&gt;
metric_memStoreSize: 39937056,&lt;br/&gt;
metric_storeFileSize: 4461185232,&lt;br/&gt;
metric_compactionsCompletedCount: 92,&lt;br/&gt;
metric_numBytesCompactedCount: 22092540348,&lt;br/&gt;
metric_numFilesCompactedCount: 290&lt;br/&gt;
Write amplification(numBytesCompactedCount/storeFileSize): 4.95&lt;br/&gt;
Elapsed time: 22m51s&lt;/p&gt;

&lt;p&gt;Seems default config on master will do compactions more aggresive, but the result of WAF decrease is not changed too much.&lt;/p&gt;

&lt;p&gt;(4.95-4.57)/4.95=7.68%&lt;/p&gt;</comment>
                            <comment id="14207779" author="apache9" created="Wed, 12 Nov 2014 07:49:20 +0000"  >&lt;p&gt;plan to start working on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt;, so rebase this patch to the latest master code.&lt;/p&gt;</comment>
                            <comment id="14207872" author="hadoopqa" created="Wed, 12 Nov 2014 09:38:11 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12681029/HBASE-10201_6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12681029/HBASE-10201_6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12681029&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 1 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11649//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14208277" author="stack" created="Wed, 12 Nov 2014 17:16:46 +0000"  >&lt;p&gt;This cannot go in till &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt; is done, right? (I&apos;m trying to write up a doc on how sequenceid is used in hbase to help).&lt;/p&gt;

&lt;p&gt;How&apos;d you generate the numbers and what is WAF?&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14208962" author="apache9" created="Thu, 13 Nov 2014 00:12:51 +0000"  >&lt;p&gt;I used to think this should go into master first as an experimental feature, and &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt; is based on this issue.&lt;/p&gt;

&lt;p&gt;Now I think you&apos;are right stack, seems making &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; base on the work of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt; is more natural, not the reverse&lt;/p&gt;

&lt;p&gt;Never mind, I will finish &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt; as soon as possible&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;How&apos;d you generate the numbers and what is WAF?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I create a table with 3 CFs, disable split(use a large constants split size), and put 1M rows into the table.&lt;br/&gt;
key is a 16B, and 16B value for CF1, 256B value for CF2, 4KB value for CF3.&lt;br/&gt;
the result number is copied from the jmx web page of regionserver.&lt;/p&gt;

&lt;p&gt;WAF is short for &quot;Write Amplification&quot;, and I calculate it simply by numBytesCompactedCount/storeFileSize&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14214629" author="apache9" created="Mon, 17 Nov 2014 13:07:22 +0000"  >&lt;p&gt;Seems &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt; must be evaluated by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt;, so I combined the changes together and post it in here. &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt; can be marked as duplicated with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; maybe?&lt;/p&gt;

&lt;p&gt;Some comments:&lt;br/&gt;
I do not change the way of storeing flushedSequenceIdByRegion in ServerManager. We need to change protobuf definition(change CompleteSequenceId in RegionLoad from long to a kvlist) if we want to do this, so it may break wire compatible, at least a rolling upgrade or downgrade will be difficult.&lt;/p&gt;

&lt;p&gt;And also, I do not change the RecoveringRegionLastFlushedSequenceId stored on zk when doing distributed log replay. The reason is same.&lt;/p&gt;</comment>
                            <comment id="14214707" author="hadoopqa" created="Mon, 17 Nov 2014 14:58:11 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12681891/HBASE-10201_7.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12681891/HBASE-10201_7.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12681891&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 1 warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 3793 checkstyle errors (more than the trunk&apos;s current 3788 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +  private final ConcurrentMap&amp;lt;byte[], ConcurrentMap&amp;lt;byte[], Long&amp;gt;&amp;gt; oldestUnflushedStoreSequenceIds = new ConcurrentSkipListMap&amp;lt;byte[], ConcurrentMap&amp;lt;byte[], Long&amp;gt;&amp;gt;(&lt;br/&gt;
+      ConcurrentMap&amp;lt;byte[], Long&amp;gt; oldestUnflushedStoreSequenceIdsOfRegion = oldestUnflushedStoreSequenceIds&lt;br/&gt;
+      //       assert not empty. Less rigorous, but safer, alternative is telling the caller to stop.&lt;br/&gt;
+      Map&amp;lt;byte[], Long&amp;gt; storeSeqNumsBeforeFlushStarts = this.lowestFlushingStoreSequenceIds.remove(encodedRegionName);&lt;br/&gt;
+          if (currentSeqNum != null &amp;amp;&amp;amp; currentSeqNum.longValue() &amp;lt;= familyNameAndSeqId.getValue().longValue()) {&lt;br/&gt;
+    ConcurrentMap&amp;lt;byte[], Long&amp;gt; oldestUnflushedStoreSequenceIdsOfRegion = this.oldestUnflushedStoreSequenceIds&lt;br/&gt;
+    return oldestUnflushedStoreSequenceIdsOfRegion != null ? getLowestSeqId(oldestUnflushedStoreSequenceIdsOfRegion)&lt;br/&gt;
+    ConcurrentMap&amp;lt;byte[], Long&amp;gt; oldestUnflushedStoreSequenceIdsOfRegion = this.oldestUnflushedStoreSequenceIds&lt;br/&gt;
+                final HLog wal, final long myseqid, Collection&amp;lt;Store&amp;gt; storesToFlush, MonitoredTask status)&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11705//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14214971" author="yuzhihong@gmail.com" created="Mon, 17 Nov 2014 18:44:21 +0000"  >&lt;p&gt;@Duo:&lt;br/&gt;
Can you briefly describe the addition in patch v7 w.r.t. per store sequence Id ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  @Test
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCompareStoreFileCount() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Mind adding comment describing what the above test verifies ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Why is main() needed in the unit test ?&lt;/p&gt;</comment>
                            <comment id="14215113" author="stack" created="Mon, 17 Nov 2014 20:27:25 +0000"  >&lt;blockquote&gt;&lt;p&gt;We need to change protobuf definition&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We could add extra fields in pb and write to two places for the life of an hbase version to support rolling upgrade.&lt;/p&gt;

&lt;p&gt;I hope you do not mind me surfacing here questions asked off list &amp;#8211; its best to keep the discussion up here rather than off-list so others can participate too. &lt;/p&gt;

&lt;p&gt;You described off-list how the distributed log replay opens a region and puts the highest &lt;b&gt;sequenceid&lt;/b&gt; found up in zk and then uses this to figure which edits to replay. You also talk of how regionServerReport includes the last flush id of each region we carry and that the master keeps this around so on log replay we can skip edits already flushed. You then ask:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think I need to change all these places to use a map which stored familyName-&amp;gt;maxSeqId instead of a single SeqId. Am I right?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The sequenceid is &lt;b&gt;region-scoped&lt;/b&gt;: i.e. we keep a running sequenceid per region. For the above to work out, we&apos;d need to change the sequenceid scope to be instead column-family rather than region.  Since our memstore is by column family, and since the memstore now uses the region sequenceid as its MVCC, this might be a good direction to go in but it is not what we have now.&lt;/p&gt;

&lt;p&gt;You cannot have it so there are discontinuities in the progress of the flush sequenceid. If four column families, the edits can go in to any of the four families in any order. &lt;/p&gt;

&lt;p&gt;You could do something like &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gaurav.menghani&quot; class=&quot;user-hover&quot; rel=&quot;gaurav.menghani&quot;&gt;Gaurav Menghani&lt;/a&gt; did (See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201?focusedCommentId=14191203&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14191203&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-10201?focusedCommentId=14191203&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14191203&lt;/a&gt;) suggests above where rather than report on successful flush, the highest sequenceid of all a regions&apos; memstores involved in a flush, instead, when you flush a column family only, you&apos;d have to report one less than the oldest outstanding edit still alive up in a column family memstore.&lt;/p&gt;

&lt;p&gt;What if you did something much less involved; when there is pressure to flush, flush the stores with the oldest edits until you&apos;ve freed enough memory?&lt;/p&gt;

&lt;p&gt;Upsides are that you&apos;d clear out old edits from memory and we might let go of WALs a little faster.  Also, you might not flush all of the content in a region &amp;#8211; because flushing just a few stores might be enough to get you back under the threshold &amp;#8211; so we might make less small storefiles?&lt;/p&gt;

&lt;p&gt;Downsides are we&apos;d make some small storefiles (e.g. for those stores that have a few old edits in them and little else) and we&apos;d do the flush in series rather than in //.  Because of sequenceid accounting, we might replay more edits than we have to.&lt;/p&gt;</comment>
                            <comment id="14215472" author="apache9" created="Tue, 18 Nov 2014 00:18:05 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Can you briefly describe the addition in patch v7 w.r.t. per store sequence Id&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I move the map which stores familyName-&amp;gt;oldestSeqIdInStore to FSHLog, and when start a flush, pass the familyNames which will be flushed to HLog.&lt;br/&gt;
And when replay, skip WAL cells with seqId per store instead of a single seqId of region.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Why is main() needed in the unit test ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It is used to benchmark a real cluster&lt;/p&gt;</comment>
                            <comment id="14215501" author="apache9" created="Tue, 18 Nov 2014 00:41:48 +0000"  >&lt;blockquote&gt;
&lt;p&gt;You could do something like Gaurav Menghani did (See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201?focusedCommentId=14191203&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14191203&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-10201?focusedCommentId=14191203&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14191203&lt;/a&gt;) suggests above where rather than report on successful flush, the highest sequenceid of all a regions&apos; memstores involved in a flush, instead, when you flush a column family only, you&apos;d have to report one less than the oldest outstanding edit still alive up in a column family memstore.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, this is what the patch doing now. This is the way which has minimal impact on existing code.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;What if you did something much less involved; when there is pressure to flush, flush the stores with the oldest edits until you&apos;ve freed enough memory?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think we need to identify the reason why we need a flush. If we need a flush due to large memstore size, then flush large store is enough. If we need a flush due to the oldest seqId alived in memstore is far away from now(which means we have lots of WAL that can not be archived), then we need to flush the store which has the oldest seqId in memstore(or maybe just flush all the stores? simple but useful). Maybe I can change the return value of shouldFlush from boolean to enum to indicate the reason why we need a flush.&lt;/p&gt;</comment>
                            <comment id="14215670" author="apache9" created="Tue, 18 Nov 2014 03:10:24 +0000"  >&lt;p&gt;The pressure on log truncating is solved by LogRoller and we already have a testcase in TestPerColumnFamilyFlush, sorry...&lt;/p&gt;

&lt;p&gt;And I see that shouldFlush method in HRegion only check flushSeqId and lastFlushTime, and return true means we have some data remain in memstore for a long time, so I change PeriodicMemstoreFlusher to always flush all stores instead of doing a selective flush.&lt;/p&gt;

&lt;p&gt;Add comment to testCompareStoreFileCount.&lt;/p&gt;

&lt;p&gt;ReviewBoard: &lt;a href=&quot;https://reviews.apache.org/r/28151/diff/#&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/28151/diff/#&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14215702" author="stack" created="Tue, 18 Nov 2014 04:37:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;If we need a flush due to large memstore size, then flush large store is enough.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;To be clear, you are suggesting that we would flush the big store but we would not move the sequenceid forward; it would still be one less than the oldest edit still in a memstore?&lt;/p&gt;

&lt;p&gt;Then, our other flush forcing function, the one that wants to clear up old WALs, would come along and force the flushing of the old memstores?&lt;/p&gt;

&lt;p&gt;That is an interesting idea.&lt;/p&gt;</comment>
                            <comment id="14215724" author="hadoopqa" created="Tue, 18 Nov 2014 05:05:23 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12682076/HBASE-10201_8.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12682076/HBASE-10201_8.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12682076&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11727//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14215740" author="apache9" created="Tue, 18 Nov 2014 05:41:12 +0000"  >&lt;blockquote&gt;
&lt;p&gt;To be clear, you are suggesting that we would flush the big store but we would not move the sequenceid forward; it would still be one less than the oldest edit still in a memstore?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, the complete sequenceId is always the oldest edit still in memstore minus one except we flush all stores.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Then, our other flush forcing function, the one that wants to clear up old WALs, would come along and force the flushing of the old memstores?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, for LogRoller and PeriodicMemstoreFlusher.&lt;/p&gt;
</comment>
                            <comment id="14215743" author="stack" created="Tue, 18 Nov 2014 05:44:08 +0000"  >&lt;p&gt;You have any means of trying out your patch to get rough numbers to see if it helps &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14215745" author="stack" created="Tue, 18 Nov 2014 05:49:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; Thanks for working on this.&lt;/p&gt;</comment>
                            <comment id="14220531" author="apache9" created="Fri, 21 Nov 2014 05:08:10 +0000"  >&lt;p&gt;rebase for WAL refactoring&lt;/p&gt;</comment>
                            <comment id="14220602" author="hadoopqa" created="Fri, 21 Nov 2014 06:46:41 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12682818/HBASE-10201_9.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12682818/HBASE-10201_9.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit c5690b1be3ae84efa52ee3c4589248c447e12f3f.&lt;br/&gt;
  ATTACHMENT ID: 12682818&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 33 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +                final WAL wal, final long myseqid, Collection&amp;lt;Store&amp;gt; storesToFlush, MonitoredTask status)&lt;br/&gt;
+            new WALKey(info.getEncodedNameAsBytes(), htd.getTableName(), System.currentTimeMillis()),&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.balancer.TestBaseLoadBalancer&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11771//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14220782" author="apache9" created="Fri, 21 Nov 2014 11:16:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;&apos;s comment on rb&lt;/p&gt;</comment>
                            <comment id="14220880" author="hadoopqa" created="Fri, 21 Nov 2014 13:09:19 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12682853/HBASE-10201_10.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12682853/HBASE-10201_10.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 325cdc0987f8176ac46695f5b0c93b0fc6605ab9.&lt;br/&gt;
  ATTACHMENT ID: 12682853&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 33 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11774//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14228016" author="apache9" created="Fri, 28 Nov 2014 01:00:32 +0000"  >&lt;p&gt;rebase and some simple change&lt;/p&gt;</comment>
                            <comment id="14228057" author="hadoopqa" created="Fri, 28 Nov 2014 03:00:32 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12684125/HBASE-10201_11.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12684125/HBASE-10201_11.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 0f8894cd6435ed6962ec3d7c81be4cb0d4f7657e.&lt;br/&gt;
  ATTACHMENT ID: 12684125&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 33 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11857//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14231031" author="apache9" created="Tue, 2 Dec 2014 05:44:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;&apos;s comments on rb&lt;/p&gt;</comment>
                            <comment id="14231134" author="hadoopqa" created="Tue, 2 Dec 2014 07:49:39 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12684565/HBASE-10201_12.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12684565/HBASE-10201_12.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 94d57f81dc114feba14906b05b3d2c6b78bf3299.&lt;br/&gt;
  ATTACHMENT ID: 12684565&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 33 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 8 new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): 	at org.apache.camel.component.jms.JmsDefaultTaskExecutorTypeTest.testSimpleAsyncTaskExecutor(JmsDefaultTaskExecutorTypeTest.java:70)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11891//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14233701" author="stack" created="Thu, 4 Dec 2014 00:22:32 +0000"  >&lt;p&gt;Trying this patch out.... reviewing v12.&lt;/p&gt;

&lt;p&gt;Suggest you drop memstore from the names of these configs:&lt;/p&gt;

&lt;p&gt;hbase.hregion.memstore.percolumnfamilyflush.enabled&lt;br/&gt;
hbase.hregion.memstore.percolumnfamilyflush.size.lower.bound&lt;/p&gt;

&lt;p&gt;Its only memstores that are flushed so having memstore in the name is redundant.&lt;/p&gt;

&lt;p&gt;Same here MEMSTORE_COLUMNFAMILY_FLUSHSIZE_LOWER_BOUND and here getMemStoreColumnFamilyFlushSizeLowerBound&lt;/p&gt;

&lt;p&gt;This is a nit. Can do later if we make more patches.&lt;/p&gt;

&lt;p&gt;Importing HRegion into HMaster should be avoided &amp;#8211; we are reaching across packages &amp;#8211; especially just to get at a define. Move this config up into HConstants since it is used by two major subpackages or probably better, put it into HRegionInfo.&lt;/p&gt;

&lt;p&gt;So I enable this feature in hbase-site.xml and I can enable it globally also in hbase-site.xml but I can also enable it on a per-table basis?  Thats good.&lt;/p&gt;

&lt;p&gt;Why do we have to change the API on FlushRequest?  Can the flush implementation not do all the necessary figuring of what to flush reading necessary configs., etc.?  Maybe you need the flag to &apos;force&apos; a full region flush?  If so, should it be a force flag rather than the effete &apos;selectiveFlushRequest&apos;?&lt;/p&gt;

&lt;p&gt;Add the fact that we are doing per col flushing as an attribute on summary line printed out on region instantiation rather than give it its own log line:&lt;/p&gt;

&lt;p&gt;+    if (LOG.isDebugEnabled()) &lt;/p&gt;
{
+      LOG.debug(&quot;Per Column Family Flushing: &quot; + perColumnFamilyFlushEnabled);
+    }

&lt;p&gt;More review later. This patch is great.  THere were some rejects but easy to fix. Let me try and get some numbers to help make the case for this patch going in.&lt;/p&gt;



</comment>
                            <comment id="14234128" author="apache9" created="Thu, 4 Dec 2014 11:09:18 +0000"  >&lt;p&gt;Use a FlushPolicy instead of hbase.hregion.memstore.percolumnfamilyflush.enabled config.&lt;/p&gt;

&lt;p&gt;I&apos;m not good at naming things, and may break some rules when add the policy. So just point out if you have a better name of the policy and anything that you think is wrong in this patch. I will fix it as soon as possible.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14234975" author="apache9" created="Fri, 5 Dec 2014 02:50:26 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Suggest you drop memstore from the names of these configs:&lt;br/&gt;
hbase.hregion.memstore.percolumnfamilyflush.enabled&lt;br/&gt;
hbase.hregion.memstore.percolumnfamilyflush.size.lower.bound&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;done.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Importing HRegion into HMaster should be avoided &#8211; we are reaching across packages &#8211; especially just to get at a define. Move this config up into HConstants since it is used by two major subpackages or probably better, put it into HRegionInfo.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Now there is only a  FlushPolicy.getFlushPolicyClass(htd, conf); in HMaster. It is same with RegionSplitPolicy.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Why do we have to change the API on FlushRequest? Can the flush implementation not do all the necessary figuring of what to flush reading necessary configs., etc.? Maybe you need the flag to &apos;force&apos; a full region flush? If so, should it be a force flag rather than the effete &apos;selectiveFlushRequest&apos;?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I changed selectiveFlushRequest to forceFlushAllStores, and done a true/false reversion. Hope I didn&apos;t miss something.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Add the fact that we are doing per col flushing as an attribute on summary line printed out on region instantiation rather than give it its own log line:&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sorry I didn&apos;t find the summary log. But now the log is disappeared after the introducing of FlushPolicy.&lt;/p&gt;

&lt;p&gt;And is the QA bot still broken?&lt;/p&gt;</comment>
                            <comment id="14235174" author="stack" created="Fri, 5 Dec 2014 06:50:38 +0000"  >&lt;p&gt;Retry. Yes, hadoopqa was broke today. I think it back now. Lets see by retrying.  Still working on getting a few numbers to show with and without patch. Sorry it taking so long.&lt;/p&gt;</comment>
                            <comment id="14235277" author="hadoopqa" created="Fri, 5 Dec 2014 08:57:03 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12685263/HBASE-10201_13.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12685263/HBASE-10201_13.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 08754f2c431b829b0d6269bdb23284dd679ed8ca.&lt;br/&gt;
  ATTACHMENT ID: 12685263&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 33 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11945//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14236569" author="stack" created="Sat, 6 Dec 2014 03:54:34 +0000"  >&lt;p&gt;Ran some loadings.  Small cluster with one regionserver hosting one region.  Used the test packaged in this patch modifying it so could run ten clients in parallel rather than a single client.  The included test has a table schema of three column families and it fills them unevenly so it is &apos;ideal&apos; for demonstrating benefit.  I ran with patch turned off twice and then turned on twice.  Set flushes at 64M.&lt;/p&gt;

&lt;p&gt;I see less compactions and less hfiles (so less i/o), memstores carrying more (its hard to see but you should be able to make out memstore sizes do not go to zero or near zero when the patch is enabled)&lt;/p&gt;

&lt;p&gt;Looks good.  Let me review again to recheck sequenceid accounting and run some MTTR tests.&lt;/p&gt;</comment>
                            <comment id="14236644" author="apache9" created="Sat, 6 Dec 2014 06:31:48 +0000"  >&lt;p&gt;Ted Yu&apos;s suggestion on rb.&lt;br/&gt;
Fix typo, add FlushPolicyFactory.&lt;/p&gt;</comment>
                            <comment id="14236647" author="apache9" created="Sat, 6 Dec 2014 06:35:14 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I see less compactions and less hfiles (so less i/o), memstores carrying more (its hard to see but you should be able to make out memstore sizes do not go to zero or near zero when the patch is enabled)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Glad to see it does help&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. Thanks~&lt;/p&gt;</comment>
                            <comment id="14236671" author="hadoopqa" created="Sat, 6 Dec 2014 07:16:41 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12685524/HBASE-10201_14.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12685524/HBASE-10201_14.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 4a36f662c2738a61535cf188f27d478d72c5a38a.&lt;br/&gt;
  ATTACHMENT ID: 12685524&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 32 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 15 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11969//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14237181" author="apache9" created="Sun, 7 Dec 2014 15:41:56 +0000"  >&lt;p&gt;Seems previous hadoop QA run was exited abnormally.&lt;/p&gt;

&lt;p&gt;Rebase and retry.&lt;/p&gt;</comment>
                            <comment id="14237187" author="apache9" created="Sun, 7 Dec 2014 15:56:29 +0000"  >&lt;p&gt;fix a javadoc issue.&lt;/p&gt;</comment>
                            <comment id="14237213" author="hadoopqa" created="Sun, 7 Dec 2014 17:40:46 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12685611/HBASE-10201_14.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12685611/HBASE-10201_14.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit bb15fd5fe0a89e647cd9cefa0ceae342578f0833.&lt;br/&gt;
  ATTACHMENT ID: 12685611&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 32 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 6 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11982//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14237214" author="hadoopqa" created="Sun, 7 Dec 2014 17:48:11 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12685612/HBASE-10201_15.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12685612/HBASE-10201_15.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit bb15fd5fe0a89e647cd9cefa0ceae342578f0833.&lt;br/&gt;
  ATTACHMENT ID: 12685612&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 32 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 6 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11983//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14237331" author="apache9" created="Mon, 8 Dec 2014 00:35:47 +0000"  >&lt;p&gt;trivial change to remove javadoc warnings&lt;/p&gt;</comment>
                            <comment id="14237370" author="hadoopqa" created="Mon, 8 Dec 2014 02:28:21 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12685645/HBASE-10201_16.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12685645/HBASE-10201_16.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 9fd6db3703d3e7ec50b32b1e96c65ed9f2b1456d.&lt;br/&gt;
  ATTACHMENT ID: 12685645&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 32 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +  private static final Class&amp;lt;? extends FlushPolicy&amp;gt; DEFAULT_FLUSH_POLICY_CLASS = FlushLargeStoresPolicy.class;&lt;br/&gt;
+            new WALKey(info.getEncodedNameAsBytes(), htd.getTableName(), System.currentTimeMillis()),&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11990//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14237503" author="apache9" created="Mon, 8 Dec 2014 06:27:39 +0000"  >&lt;p&gt;line length&lt;/p&gt;</comment>
                            <comment id="14237602" author="hadoopqa" created="Mon, 8 Dec 2014 08:18:45 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12685679/HBASE-10201_17.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12685679/HBASE-10201_17.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 87e44140040ab9a864e592c13f164dcde6ed6c03.&lt;br/&gt;
  ATTACHMENT ID: 12685679&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 32 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11993//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14238808" author="stack" created="Tue, 9 Dec 2014 01:26:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; Would you mind taking a look at the sequenceid accounting that is going on in this patch? I am currently testing.  Would be good to get the view of another with a seqid fixation.&lt;/p&gt;</comment>
                            <comment id="14239008" author="jeffreyz" created="Tue, 9 Dec 2014 05:29:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; Sure. Let me take a look at this patch! &lt;/p&gt;</comment>
                            <comment id="14239062" author="stack" created="Tue, 9 Dec 2014 06:52:23 +0000"  >&lt;p&gt;Here is some feedback on reading through latest version of the patch. Lets address these minor items after we are sure the most important part is working, the sequenceid handling (I&apos;m running tests here but its taking a while &amp;#8211; first I need to prove that hbase 1.0 branch is healthy, then I intro your patch... and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt;, Mr SequenceId is going to take a look too).  So hold on making a patch till testing and Jeffrey&apos;s review are done.&lt;/p&gt;

&lt;p&gt;Sorry this is taking so long to get in.  On the one hand, you can tell we are excited about getting this patch in because the improvement is really nice but it touches a very sensitive part of hbase, the region sequenceid&apos;ing, so we need to exercise extra caution.  Thanks for you patience &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Nits to be addressed on commit or if you make a new version of the patch (you&apos;ve done enough as it is &amp;#8211; smile &amp;#8211; and I could do below on commit np).&lt;/p&gt;

&lt;p&gt;I can go over the javadoc on commit. Small edit would fix it all up nicely.&lt;/p&gt;

&lt;p&gt;Below is a nit that can be addressed in a follow-on:&lt;/p&gt;

&lt;p&gt;This config is not general.  It belongs to a particular policy (&quot;If FlushLargeStoresPolicy is used...&quot;): hbase.hregion.percolumnfamilyflush.size.lower.bound  Should probably have the policy it is for in its name.  Maybe just don&apos;t mention is in hbase-default.xml.  Let uses find it if they need it (16MB is a nice default low-bound).&lt;/p&gt;

&lt;p&gt;It is odd that this is public:&lt;/p&gt;

&lt;p&gt;public static Class&amp;lt;? extends FlushPolicy&amp;gt; getFlushPolicyClass(&lt;/p&gt;

&lt;p&gt;It is nice that the master tests that we can load a policy but it does not even use flush policy (if we fail to load fall back to default with big warning?)  And flush policies are over in regionserver package so here we have master reaching over and into the regionserver package. Would be good to avoid doing this x-package reach especially when it does not seem to be needed.&lt;/p&gt;

&lt;p&gt;I would think this would be an internal method for the factory to use?&lt;/p&gt;

&lt;p&gt;Also in HTD, you call it getFlushPolicyClassName but here you call it getFlushPolicyClass... would be good to be same.&lt;/p&gt;

&lt;p&gt;This policy stuff you&apos;ve added is nicer than what was here previous.  Good one.&lt;/p&gt;

&lt;p&gt;Should these two strings just be the same?&lt;/p&gt;

&lt;p&gt;FLUSH_SIZE_LOWER_BOUND_KEY and DEFAULT_FLUSH_SIZE_LOWER_BOUND even though they are read from different places?  No harm the key being the same especially since in HTD, you hide the key by providing getter/setters.&lt;/p&gt;

&lt;p&gt;The FlushPolicy api is a little odd.  It implements Configured but where do you do a setConf on it? Then in the configureForRegion method, you take a Region but all it is used for is to emit region name on Strings and to get instance of HTableDescriptor.  The flush takes a list of stores.  Can&apos;t it get them from the region it was given when configuredForRegion?  This is a nit comment.  Ignore for now.&lt;/p&gt;

&lt;p&gt;... Stopped at sequence id  changes.... will be back. Thanks.&lt;/p&gt;</comment>
                            <comment id="14239084" author="apache9" created="Tue, 9 Dec 2014 07:29:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; I followed RegionSplitPolicy to write FlushPolicy, expect that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt; suggested using FlushPolicyFactory and placing the factory method in it instead of FlushPolicy. Maybe the code of RegionSplitPolicy is old and need refactoring too...&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The FlushPolicy api is a little odd. It implements Configured but where do you do a setConf on it? Then in the configureForRegion method, you take a Region but all it is used for is to emit region name on Strings and to get instance of HTableDescriptor. The flush takes a list of stores. Can&apos;t it get them from the region it was given when configuredForRegion? This is a nit comment. Ignore for now.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ReflectionUtils.newInstance(clazz, conf) will call setConf. And I agreed that if we implement configureForRegion, then the list of stores is not necessary when doing selection. Can be fixed later.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; I think the biggest problem is that this patch change the flushSeqId generation. flushSeqId will not be bumped if we do not flush all stores. I think the flushSeqId should be called as &quot;highestFlushedToDiskSeqId&quot; in this patch. And actually I do not know where we use FlushMarker so I do not know the meaning of flushSeqId in the Marker...&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14239588" author="stack" created="Tue, 9 Dec 2014 16:14:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;I followed RegionSplitPolicy to write FlushPolicy&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I see. Yes you did it seems.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;...Ted Yu suggested using FlushPolicyFactory and placing the factory method in it instead of FlushPolicy. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OK. Its his fault then.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Maybe the code of RegionSplitPolicy is old and need refactoring too...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;My comments above apply to it too it seems yes.  The master is checking it can load the split policy reaching across into the regionserver package. I suppose the idea is checking split policy in one central place.  Should just load default on regionserver if we can&apos;t find the configured one.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;ReflectionUtils.newInstance(clazz, conf) will call setConf. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;ok&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can be fixed later.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;ok&lt;/p&gt;

&lt;p&gt;Yeah, looks like you followed pattern in code base so not a problem of your making. Can fix both in a followup issue.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;flushSeqId will not be bumped if we do not flush all stores.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Because?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;And actually I do not know where we use FlushMarker so I do not know the meaning of flushSeqId in the Marker...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It may not be used just yet but it will be used soon by following read replicas.&lt;/p&gt;</comment>
                            <comment id="14239658" author="yuzhihong@gmail.com" created="Tue, 9 Dec 2014 17:03:27 +0000"  >&lt;p&gt;w.r.t. FlushPolicyFactory, I made the comment before sanityCheckTableDescriptor() was added.&lt;/p&gt;

&lt;p&gt;It was not my intention that master directly references class in region server module.&lt;/p&gt;</comment>
                            <comment id="14239958" author="jeffreyz" created="Tue, 9 Dec 2014 20:02:06 +0000"  >&lt;p&gt;This is a nice feature. I scan through the patch and below are my comments:&lt;/p&gt;

&lt;p&gt;1) There may be a correctness issue for same version(same row key &amp;amp; version) updates. Because you use following code as store file flush id, we could end up multiple hstore files with exact same flush seq id. While HBase resolve same version updates by store files&apos; seqid(flush id). Therefore, we may end up with incorrect results.  This issue may only happen in 0.98 though.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; oldestUnflushedSeqId = wal
+              .getEarliestMemstoreSeqNum(encodedRegionName);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 
&lt;p&gt;In order to fix the issue, we should use current store&apos;s max flushed seq id as its real hstore seq id. While we need to change HRegion.lastFlushSeqId to use oldestUnflushedSeqId to report back Master otherwise we may have data loss issue.&lt;/p&gt;

&lt;p&gt;2)  We have a feature where we force a flush by hbase.regionserver.optionalcacheflushinterval or hbase.regionserver.flush.per.changes while I didn&apos;t see you handle both cases in selectStoresToFlush() function. This may cause HRegion.shouldFlush() always return true and end up with small hstore files.&lt;/p&gt;

&lt;p&gt;3) For region server recovery, we have an optimization by using lastFlushSeqId reported by region servers to skip writing edits into recovered.edits files. With this feature, we may unnecessarily write much more data into recovered.edits. This issue doesn&apos;t happen in log replay case.&lt;/p&gt;

&lt;p&gt;4) Relating to your FlushMarker question, FulshMarker(or similar RegionEventWALEdit) are used for region replica feature and reasoning on region/store state. As you can see(in WALEdit class), those special events are using special column family &quot;METAFAMILY&quot; which doesn&apos;t exist for data regions. You should handle those events specially in getFamilyNames() otherwise they may affect your book keeping on oldest un-flushed seqid.  &lt;/p&gt;</comment>
                            <comment id="14240207" author="apurtell" created="Tue, 9 Dec 2014 22:50:07 +0000"  >&lt;p&gt;Canceling stale patch. Moving out of 0.98.9.&lt;/p&gt;</comment>
                            <comment id="14240210" author="apurtell" created="Tue, 9 Dec 2014 22:51:22 +0000"  >&lt;p&gt;I also don&apos;t think this is a Critical priority issue, since the behavior discussed is long standing and what the changes look like are not settled. Changing priority, but feel free to change back if you disagree.&lt;/p&gt;</comment>
                            <comment id="14240419" author="apache9" created="Wed, 10 Dec 2014 00:45:50 +0000"  >&lt;blockquote&gt;
&lt;p&gt;1) There may be a correctness issue for same version(same row key &amp;amp; version) updates...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think you mean the KVScannerComparator will use sequenceId to compare if we get the same key. Yes this is a problem I missed. I think we need to change the code below as you suggested, use store&apos;s max seqId instead of flushSeqId here.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Store s : storesToFlush) {
          totalFlushableSizeOfFlushableStores += s.getFlushableSize();
          storeFlushCtxs.add(s.createFlushContext(flushSeqId));
          committedFiles.put(s.getFamily().getName(), &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; writing stores to WAL
&lt;/span&gt;        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;2) We have a feature where we force a flush...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That&apos;s why I introduce a FlushPolicy. Now the policy is simple that we only consider the size of a store. So if we keep a store for a long time then there will be a force flush all stores request which may generate unnecessary small files. I think we can introduce new FlushPolicy later to handle it better.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;3) For region server recovery...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think the issue in &quot;1)&quot; also make the problem even worse that the flushSeqId passed to createFlushContext will be used as maxSeqId in a store...I will fix it in the next patch. And If we want to skip WAL exactly, then we need to report a familyName-&amp;gt;seqId map to master which will change the rpc protocol(and the format of zk data in distributed log replay). This is a big change so I think we can reopen &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt; to handle it after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; getting in.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;4) Relating to your FlushMarker question...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I will fix getFamilyNames(), thanks. And is there anything else that make read replicas broken? I&apos;m not familiar with read replicas so may miss something.&lt;/p&gt;

&lt;p&gt;Thanks~&lt;/p&gt;</comment>
                            <comment id="14240436" author="apache9" created="Wed, 10 Dec 2014 00:53:58 +0000"  >&lt;blockquote&gt;
&lt;p&gt;OK. Its his fault then.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It&apos;s not his fault as he just let me use a factory class and didn&apos;t told me to make reference to regionserver in HMaster... &lt;br/&gt;
I think we need to find a way to do sanity check when loading tables without making reference to regionserver...&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;flushSeqId will not be bumped if we do not flush all stores.&lt;br/&gt;
Because?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The flushSeqId will be one less than the oldest edit still in a memstore if we do not flush all stores.&lt;/p&gt;</comment>
                            <comment id="14240441" author="stack" created="Wed, 10 Dec 2014 01:00:11 +0000"  >&lt;p&gt;Made it critical again. Removed it from 0.98 (not critical for 0.98).  Trying to get into 1.0 even if it is turned off by default.  Thats why I had it critical.  Speak up if you think otherwise &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;  Doing the testing for this feature as though it were critical.  Benefit is nice and its an old issue getting fixed.&lt;/p&gt;</comment>
                            <comment id="14240461" author="jeffreyz" created="Wed, 10 Dec 2014 01:16:52 +0000"  >&lt;blockquote&gt;
&lt;p&gt;(and the format of zk data in distributed log replay)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;You don&apos;t have to change this because log replay already gets max seqId per store before sending edits for replay.&lt;/p&gt;</comment>
                            <comment id="14240465" author="stack" created="Wed, 10 Dec 2014 01:18:02 +0000"  >&lt;p&gt;Changed my mind. Set it to Major. Doesn&apos;t need to be critical.  If it gets done in time, well and good.&lt;/p&gt;</comment>
                            <comment id="14240528" author="apache9" created="Wed, 10 Dec 2014 02:10:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; I think &quot;flushSeqId&quot; is ambiguous here. We have two things actually, one is maxFlushedSeqId, and the other is seqIdOfFlushOperation.&lt;/p&gt;

&lt;p&gt;Before this patch, maxFlushedSeqId is equal to seqIdOfFlushOperation because we flush all the datas before the flush operation. After this patch, they are different.&lt;br/&gt;
So I think we need to introduce a new field called maxFlushSeqId instead of lastFlushSeqId in HRegion, and generate flushSeqId in the old way(increase sequenceId of region).&lt;/p&gt;</comment>
                            <comment id="14240568" author="apache9" created="Wed, 10 Dec 2014 02:51:37 +0000"  >&lt;blockquote&gt;
&lt;p&gt;You don&apos;t have to change this because log replay already gets max seqId per store before sending edits for replay.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;There maybe some misunderstand. &lt;br/&gt;
I pass a wrong value to createFlushContext, so the maxSeqId of store is less than it should be. This will cause unnecessary log split and replay.&lt;br/&gt;
And if I fix this, then the problem will be what &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt; described. We need to store a map to solve &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt; perfectly.&lt;/p&gt;

&lt;p&gt;And for distributed log replay, postOpenDeployTasks will call updateRecoveringRegionLastFlushedSequenceId to store the maxSeqId in zk, and WALSplitter.splitLogFile will use it to skip WAL, then pass WAL to a regionserver to replay. We can use a map when replay the WAL to skip unnecessary cells(this is what we do in the patch). But if we store a map on zk, then we can skip the WAL earlier.&lt;/p&gt;</comment>
                            <comment id="14240619" author="apache9" created="Wed, 10 Dec 2014 04:18:45 +0000"  >&lt;p&gt;Oh, after digging into the code I found that the file stored on zk already have the seqId of each store, but WALSplitter.splitLogFile only use the LastFlushedSequenceId and ignore the store sequence id. So it is easy to change the split work to use sequence id of store. Let me try. Thanks.&lt;/p&gt;</comment>
                            <comment id="14240737" author="stack" created="Wed, 10 Dec 2014 06:53:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; When you say...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;... This issue may only happen in 0.98 though.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;because we are not doing DLR in 0.98 or for some other reason?  This patch is unlikely to make it back to 0.98 I&apos;d say.&lt;/p&gt;

&lt;p&gt;On the fix for 1.) above, hfiles, will be written out with the stores flushed seqid but we will tell keep on telling master the oldest unflushed edit (oldestUnflushedSeqId).  Since flush policies can return any set of Stores without regard to sequenceid, we could have edits in memstores with sequenceids that are in earlier than those of persisted hfiles.  Since telling the master oldestUnflushedSeqId does not guarantee that oldestUnflushedSeqId will be available at recovery time (it is in the master memory only IIRC, and master may crash and lose it), when region opens post-recovery, we look at sequenceids from hfiles to figure the regions sequenceid.  Will this mean we drop edits because region thinks its sequenceid is higher than it should be?&lt;/p&gt;

&lt;p&gt;3. is a &apos;known&apos; cost.  Good to know that DLR won&apos;t have this issue.&lt;/p&gt;

&lt;p&gt;4. is a good point (as is 2.)&lt;/p&gt;</comment>
                            <comment id="14240754" author="apache9" created="Wed, 10 Dec 2014 07:15:22 +0000"  >&lt;blockquote&gt;
&lt;p&gt;3. is a &apos;known&apos; cost. Good to know that DLR won&apos;t have this issue.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yeah, at last I found that LogReplayOutputSink will filter out cells using regionMaxSeqIdInStores in groupEditsByServer method. This is actually what we want.&lt;/p&gt;

&lt;p&gt;And do I need to change original log split policy to also use a familyName-&amp;gt;seqId map to filter out cells that already flushed?  &lt;br/&gt;
Thanks~&lt;/p&gt;</comment>
                            <comment id="14240779" author="apache9" created="Wed, 10 Dec 2014 07:54:03 +0000"  >&lt;blockquote&gt;
&lt;p&gt;2) We have a feature where we force a flush by hbase.regionserver.optionalcacheflushinterval or hbase.regionserver.flush.per.changes while I didn&apos;t see you handle both cases in selectStoresToFlush() function. This may cause HRegion.shouldFlush() always return true and end up with small hstore files.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think a get the point. Actually I use forceFlushAllStores=true when shouldFlush returns true so there will not be a situation that HRegion.shouldFlush() always returns true because we will flush all stores.&lt;br/&gt;
But I think we can pass forceFlushAllStores=false in that case and add old stores to the specificStoresToFlush in selectStoresToFlush to better handle it.&lt;br/&gt;
I will fix it. Thanks.&lt;/p&gt;</comment>
                            <comment id="14240882" author="apache9" created="Wed, 10 Dec 2014 10:20:23 +0000"  >&lt;p&gt;Rename lastFlushSeqId to maxFlushedSeqId in HRegion. Always generate a flushSeqId with incrementing of sequenceId and now maxFlushedSeqId is not equal to flushSeqId.&lt;br/&gt;
Rename FlushLargeStorePolicy to FlushLargeAndOldStorePolicy that also flush store which make HRegion.shouldFlush, and change forceFlushAllStores flag to false in PeriodicMemstoreFlusher.&lt;/p&gt;</comment>
                            <comment id="14241121" author="apache9" created="Wed, 10 Dec 2014 14:10:24 +0000"  >&lt;p&gt;I ran the performance test in TestPerColumnFamilyFlush to confirm the patch is still work after I changed the behavior of FlushPolicy.&lt;/p&gt;

&lt;p&gt;The result is same with previous test&lt;/p&gt;

&lt;p&gt;metric_storeCount: 3,&lt;br/&gt;
metric_storeFileCount: 9,&lt;br/&gt;
metric_memStoreSize: 1272,&lt;br/&gt;
metric_storeFileSize: 4509402744,&lt;br/&gt;
metric_compactionsCompletedCount: 56,&lt;br/&gt;
metric_numBytesCompactedCount: 20654822724,&lt;br/&gt;
metric_numFilesCompactedCount: 184,&lt;/p&gt;</comment>
                            <comment id="14241695" author="hadoopqa" created="Wed, 10 Dec 2014 20:42:42 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12686240/HBASE-10201_18.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12686240/HBASE-10201_18.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 84b41f8029fd5822832255daeee73ff2283a622a.&lt;br/&gt;
  ATTACHMENT ID: 12686240&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 32 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 1 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12045//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14241806" author="jeffreyz" created="Wed, 10 Dec 2014 21:48:03 +0000"  >&lt;blockquote&gt;
&lt;p&gt;because we are not doing DLR in 0.98 or for some other reason? This patch is unlikely to make it back to 0.98 I&apos;d say.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It&apos;s because we defer mvcc values clean up(by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11315&quot; title=&quot;Keeping MVCC for configurable longer time &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11315&quot;&gt;&lt;del&gt;HBASE-11315&lt;/del&gt;&lt;/a&gt;) but anyway we should maintain the semantics that HStore file seqId is the largest flushed SeqId for the file.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;And do I need to change original log split policy to also use a familyName-&amp;gt;seqId map to filter out cells that already flushed? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, we should but you could do in a separate issue on this though.&lt;/p&gt;</comment>
                            <comment id="14241985" author="apache9" created="Thu, 11 Dec 2014 01:51:07 +0000"  >&lt;blockquote&gt;
&lt;p&gt;but anyway we should maintain the semantics that HStore file seqId is the largest flushed SeqId for the file.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I modified the code to &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
          flushSeqId = getNextSequenceId(wal);
          &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; oldestUnflushedSeqId = wal.getEarliestMemstoreSeqNum(encodedRegionName);
          &lt;span class=&quot;code-comment&quot;&gt;// no oldestUnflushedSeqId means we flushed all stores.
&lt;/span&gt;          &lt;span class=&quot;code-comment&quot;&gt;// or the unflushed stores are all empty.
&lt;/span&gt;          maxFlushedSeqId =
              oldestUnflushedSeqId == HConstants.NO_SEQNUM ? flushSeqId : oldestUnflushedSeqId - 1;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now I always generate a new flushSeqId and use this as the seqId of flushed StoreFiles. And use a maxFlushedSeqId to record completeSequenceId that passed to HMaster. Is it OK?&lt;/p&gt;</comment>
                            <comment id="14243274" author="jeffreyz" created="Thu, 11 Dec 2014 22:32:48 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Now I always generate a new flushSeqId and use this as the seqId of flushed StoreFiles. And use a maxFlushedSeqId to record completeSequenceId that passed to HMaster. Is it OK?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sounds good to me. &lt;/p&gt;</comment>
                            <comment id="14243345" author="stack" created="Thu, 11 Dec 2014 23:27:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; What about the comment on issue w/ 1. above? See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201?focusedCommentId=14240737&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14240737&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-10201?focusedCommentId=14240737&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14240737&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14243528" author="jeffreyz" created="Fri, 12 Dec 2014 01:04:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Are you referring to the following: &quot;Will this mean we drop edits because region thinks its sequenceid is higher than it should be?&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, as of today during replay edits in both modes, we drop WAL edits whose seqId less than relating store Seq Ids. There some edge cases(like a new PUT, region move to a different RS, DELETE on the new PUT, major compaction, move back to the original RS and the RS crashes) we have to know the hFile seqId accurately otherwise the PUT may be restored after recovery. &lt;/p&gt;

&lt;p&gt;We need to pass flushed seqIds per store to master so that we can optimize recovery process but doesn&apos;t impact correctness. &lt;/p&gt;</comment>
                            <comment id="14243546" author="stack" created="Fri, 12 Dec 2014 01:17:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; I&apos;m referring to the fact that if three column families, and one has edit #1, another edit #2 (which came later) and the third had edit #3 and then if the policy decides flush the third CF, we&apos;ll write it out with a seqid of #3 but edits #1 and #2 are still in memory. We report to the master our lowest number is #1 but master crashes (so we lose info that #1 is earliest safe edit number).  The RS hosting the three column famiilies also crashes.  On recovery, we open the region and see a hfile with seqid #3 so we set the region current seqid to #4.. even though #1 and #2 were never persisted.  This is possible with this patch as is especially when policy is disconnected from flush.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We need to pass flushed seqIds per store to master so that we can optimize recovery process but doesn&apos;t impact correctness.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This would not fix the above case?  The master might know that #3 was persisted and that column family 1 and 2 had edits less than #3 but if it crashes, we&apos;re back in the scenario described above (unless we persist the flush reports?)&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14243610" author="apache9" created="Fri, 12 Dec 2014 02:25:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; In your scenario, I think we will use #1 to skip edits, not #4.&lt;br/&gt;
As I see code in replayRecoveredEditsIfAny&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; minSeqIdForTheRegion = -1;
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; maxSeqIdInStore : maxSeqIdInStores.values()) {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (maxSeqIdInStore &amp;lt; minSeqIdForTheRegion || minSeqIdForTheRegion == -1) {
        minSeqIdForTheRegion = maxSeqIdInStore;
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      maxSeqId = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.abs(&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.parseLong(fileName));
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (maxSeqId &amp;lt;= minSeqIdForTheRegion) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
          &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; msg = &lt;span class=&quot;code-quote&quot;&gt;&quot;Maximum sequenceid &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; wal is &quot;&lt;/span&gt; + maxSeqId
            + &lt;span class=&quot;code-quote&quot;&gt;&quot; and minimum sequenceid &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region is &quot;&lt;/span&gt; + minSeqIdForTheRegion
            + &lt;span class=&quot;code-quote&quot;&gt;&quot;, skipped the whole file, path=&quot;&lt;/span&gt; + edits;
          LOG.debug(msg);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And in replayRecoveredEdits, we skip edit cells using per store seqId&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &lt;span class=&quot;code-comment&quot;&gt;// Now, figure &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; we should skip &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; edit.
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (key.getLogSeqNum() &amp;lt;= maxSeqIdInStores.get(store.getFamily()
                .getName())) {
              skippedEdits++;
              &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And when splitting log, we use a lastSeqId got from HMaster to skip edits. If master crash and loss the information, then we will not skip any edits? I&apos;m not sure but I didn&apos;t find the code to get lastSeqId from any place other than HMaster. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14243631" author="jeffreyz" created="Fri, 12 Dec 2014 02:48:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; Besides &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; mentioned, we skip edits using seqId of each relating store, the #4(which is &amp;gt; #3) is only set after region is full recovered(i.e all WAL edits are already replayed).&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt; If master crash and loss the information, then we will not skip any edits?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yes, we&apos;ll lose the info and will replay more edits. &lt;/p&gt;</comment>
                            <comment id="14243714" author="stack" created="Fri, 12 Dec 2014 04:57:43 +0000"  >&lt;p&gt;Yes. I think it is going to be ok. I missed the &apos;skip edits using seqid of each relating store&apos; bit. My calc was region based.  Thanks for entertaining my question.  In my scenario, the first column family that had edit #1 should have a store seqid of -1 which would mean we&apos;d not skip edit #1 when it came into replayRecoveredEditsIfAny,&lt;/p&gt;

&lt;p&gt;I&apos;m wondering how to make a unit test.  One thought was to stand up a single HRegion of multiple column families and populate it in various ways, out of balance, and then add a means of &apos;killing&apos; the region.  Then create a &apos;recoved.edits&apos; file and reopen the region to verify edits are as expected (and do same for DLR replay scenario)?&lt;/p&gt;





</comment>
                            <comment id="14243728" author="apache9" created="Fri, 12 Dec 2014 05:17:05 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I&apos;m wondering how to make a unit test.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;TestPerColumnFamilyFlush.testLogReplay has tested log replay for selective flush. I think it only misses the things that it does not kill HMaster when log replay. I can add a testcase to test the scenario that we can not get up to date lastSeqId from HMaster(kill master first, then kill regionserver, then restart master). &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;, is this OK?&lt;/p&gt;</comment>
                            <comment id="14243758" author="stack" created="Fri, 12 Dec 2014 05:57:19 +0000"  >&lt;blockquote&gt;&lt;p&gt;TestPerColumnFamilyFlush.testLogReplay has tested log replay for selective flush.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Woah. Thats a nice test.  How long has that been around?  I missed it in previous reviews if it was present.  I think this test is enough to give us confidence in this radical change.  The kill of master so we don&apos;t have latest seqid is a nice to have but not necessary; we just over replay the edits.&lt;/p&gt;

&lt;p&gt;Let me go over your last posted patch.  Seems like a bunch of new stuff has shown up (or I was blind last time I read through the patch).&lt;/p&gt;
</comment>
                            <comment id="14245124" author="apache9" created="Sat, 13 Dec 2014 02:30:53 +0000"  >&lt;p&gt;Addressed the issue on rb&lt;/p&gt;</comment>
                            <comment id="14245187" author="hadoopqa" created="Sat, 13 Dec 2014 04:29:00 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12687009/HBASE-10201_19.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12687009/HBASE-10201_19.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a0e473730e2cd819e7442dbd2b332d7833755ba2.&lt;br/&gt;
  ATTACHMENT ID: 12687009&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 32 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 1 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12064//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14245245" author="hadoopqa" created="Sat, 13 Dec 2014 08:03:45 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12687023/HBASE-10201_19.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12687023/HBASE-10201_19.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a0e473730e2cd819e7442dbd2b332d7833755ba2.&lt;br/&gt;
  ATTACHMENT ID: 12687023&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 32 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12065//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14246385" author="stack" created="Mon, 15 Dec 2014 07:05:17 +0000"  >&lt;p&gt;I&apos;m +1 on this going into master branch.  I am +1 on this going into branch-1 but with it disabled by default as an experimental feature; users would have to enable the FlushLargeStoresPolicy explicitly (You ok w/ that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;)?&lt;/p&gt;

&lt;p&gt;Any chance of more +1s?  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt;? Any other reviews out there? This is an old issue, nicely addressed, that can make a nice dent in our i/o profile when more than one column family but it would be good to get more eyes on it given its messing with sequenceids. Thanks.&lt;/p&gt;</comment>
                            <comment id="14248724" author="enis" created="Tue, 16 Dec 2014 19:13:56 +0000"  >&lt;p&gt;I don&apos;t think we should have this in 1.0.0. I am planning on cutting the RC tomorrow, and this seems to be a huge change for the last minute. Can we target 1.1 instead? &lt;/p&gt;</comment>
                            <comment id="14248725" author="jeffreyz" created="Tue, 16 Dec 2014 19:14:08 +0000"  >&lt;p&gt;Looks good to me(+1) for master branch.  Branch-1 should rely on &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;&apos;s feedbacks.&lt;/p&gt;</comment>
                            <comment id="14248793" author="stack" created="Tue, 16 Dec 2014 19:48:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can we target 1.1 instead?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sure.&lt;/p&gt;</comment>
                            <comment id="14248810" author="stack" created="Tue, 16 Dec 2014 20:01:08 +0000"  >&lt;p&gt;Pushed to master branch&lt;/p&gt;</comment>
                            <comment id="14248816" author="stack" created="Tue, 16 Dec 2014 20:05:21 +0000"  >&lt;p&gt;I forgot to say thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; for your persistence on getting this in.&lt;/p&gt;</comment>
                            <comment id="14248943" author="hudson" created="Tue, 16 Dec 2014 21:11:49 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5930 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5930/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5930/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; Port &apos;Make flush decisions per column family&apos; to trunk (stack: rev c7fad665f34fd3c17999d5cc60b04d3faff6a7f5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestFSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WAL.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/resources/hbase-default.xml&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MemStoreFlusher.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFlushRegionEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RSRpcServices.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/wal/TestWALFactory.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHeapMemoryManager.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushLargeStoresPolicy.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushRequester.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestPerColumnFamilyFlush.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/DisabledWALProvider.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushAllStoresPolicy.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/wal/TestDefaultWALProvider.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushPolicy.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushPolicyFactory.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14249178" author="yuzhihong@gmail.com" created="Tue, 16 Dec 2014 23:51:17 +0000"  >&lt;p&gt;From &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5931/testReport/org.apache.hadoop.hbase.regionserver/TestPerColumnFamilyFlush/testLogReplayWithDistributedReplay/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5931/testReport/org.apache.hadoop.hbase.regionserver/TestPerColumnFamilyFlush/testLogReplayWithDistributedReplay/&lt;/a&gt; :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.IllegalStateException: A mini-cluster is already running
	at org.apache.hadoop.hbase.HBaseTestingUtility.startMiniCluster(HBaseTestingUtility.java:865)
	at org.apache.hadoop.hbase.HBaseTestingUtility.startMiniCluster(HBaseTestingUtility.java:799)
	at org.apache.hadoop.hbase.HBaseTestingUtility.startMiniCluster(HBaseTestingUtility.java:770)
	at org.apache.hadoop.hbase.HBaseTestingUtility.startMiniCluster(HBaseTestingUtility.java:757)
	at org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush.testLogReplay(TestPerColumnFamilyFlush.java:349)
	at org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush.testLogReplayWithDistributedReplay(TestPerColumnFamilyFlush.java:430)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Attached addendum changes TestPerColumnFamilyFlush to large test such that there would be no collision as shown above in Jenkins build.&lt;br/&gt;
TestPerColumnFamilyFlush passed with the addendum.&lt;/p&gt;</comment>
                            <comment id="14249188" author="stack" created="Tue, 16 Dec 2014 23:59:57 +0000"  >&lt;p&gt;That&apos;ll work. Thanks.&lt;/p&gt;</comment>
                            <comment id="14249191" author="yuzhihong@gmail.com" created="Wed, 17 Dec 2014 00:03:07 +0000"  >&lt;p&gt;Addendum pushed to master branch.&lt;/p&gt;</comment>
                            <comment id="14249199" author="apache9" created="Wed, 17 Dec 2014 00:13:29 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I forgot to say thank you zhangduo for your persistence on getting this in.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s my pleasure to contribute code to a famous project&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="14249275" author="hudson" created="Wed, 17 Dec 2014 01:34:13 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5933 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5933/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5933/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; Addendum changes TestPerColumnFamilyFlush to LargeTest (tedyu: rev 885b065683499540f467cb54086a3f60e64b9c8a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestPerColumnFamilyFlush.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14252596" author="stack" created="Fri, 19 Dec 2014 00:09:07 +0000"  >&lt;p&gt;Committed to branch-1 so will be in 1.1.0.&lt;/p&gt;</comment>
                            <comment id="14252761" author="hudson" created="Fri, 19 Dec 2014 01:48:04 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.1 #5 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/5/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/5/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; Port &apos;Make flush decisions per column family&apos; to trunk (stack: rev e55ef7a663dd9a18fa88a506afd8fe0ced10563d)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushRequester.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestPerColumnFamilyFlush.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/wal/TestWALFactory.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushLargeStoresPolicy.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFlushRegionEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RSRpcServices.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushAllStoresPolicy.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/wal/TestDefaultWALProvider.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushPolicy.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHeapMemoryManager.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestIOFencing.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/DisabledWALProvider.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/FlushPolicyFactory.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MemStoreFlusher.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestFSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WAL.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/resources/hbase-default.xml&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; Addendum changes TestPerColumnFamilyFlush to LargeTest (stack: rev 5d34d2d02af39037a2426fe4fb5be9a447202bd7)&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestPerColumnFamilyFlush.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14254418" author="stack" created="Sat, 20 Dec 2014 01:20:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; Any chance of your taking a look at the test failure here: &lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12165//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12165//testReport/&lt;/a&gt; It is per column family flushing....&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12165/artifact/hbase-server/target/surefire-reports/org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush-output.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12165/artifact/hbase-server/target/surefire-reports/org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush-output.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Says this:&lt;/p&gt;

&lt;p&gt;-------------------------------------------------------------------------------&lt;br/&gt;
Test set: org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush&lt;br/&gt;
-------------------------------------------------------------------------------&lt;br/&gt;
Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 248.398 sec &amp;lt;&amp;lt;&amp;lt; FAILURE! - in org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush&lt;br/&gt;
testCompareStoreFileCount(org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush)  Time elapsed: 53.153 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!&lt;br/&gt;
java.lang.AssertionError: null&lt;br/&gt;
	at org.junit.Assert.fail(Assert.java:86)&lt;br/&gt;
	at org.junit.Assert.assertTrue(Assert.java:41)&lt;br/&gt;
	at org.junit.Assert.assertTrue(Assert.java:52)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.TestPerColumnFamilyFlush.testCompareStoreFileCount(TestPerColumnFamilyFlush.java:589)&lt;/p&gt;</comment>
                            <comment id="14254432" author="apache9" created="Sat, 20 Dec 2014 01:38:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; Yeah, the testcase is flakey.. It is used to confirm that per column family flush generates less store files.&lt;/p&gt;

&lt;p&gt;But flush is asynchronized, so there maybe a change that the original flush is delayed more than the per column family flush scenario and generate less store files, it depends on the machine&apos;s state that running the testcase...&lt;/p&gt;

&lt;p&gt;I think we can make an addendum to remove it for now to get a stable testing result. I will try to find a more stable way to confirm that per column family flush does work.&lt;/p&gt;

&lt;p&gt;Thanks~&lt;/p&gt;</comment>
                            <comment id="14254450" author="stack" created="Sat, 20 Dec 2014 01:53:48 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Apache9&quot; class=&quot;user-hover&quot; rel=&quot;Apache9&quot;&gt;Duo Zhang&lt;/a&gt; Do it in new issue when you get a chance since this one is long enough already (smile).  Thanks.&lt;/p&gt;</comment>
                            <comment id="14255140" author="apache9" created="Sun, 21 Dec 2014 11:44:32 +0000"  >&lt;p&gt;A typo found when debugging &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12405&quot; title=&quot;WAL accounting by Store&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12405&quot;&gt;&lt;del&gt;HBASE-12405&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
A simple put-&amp;gt;putIfAbsent change so add it here as an addendum patch.&lt;/p&gt;

&lt;p&gt;Need to commit to master and branch-1, Thanks~&lt;/p&gt;</comment>
                            <comment id="14255185" author="yuzhihong@gmail.com" created="Sun, 21 Dec 2014 15:24:03 +0000"  >&lt;p&gt;Addendum integrated to master and branch-1&lt;/p&gt;

&lt;p&gt;Thanks Duo.&lt;/p&gt;</comment>
                            <comment id="14255212" author="hudson" created="Sun, 21 Dec 2014 16:53:08 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.1 #16 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/16/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/16/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; Addendum fixes typo of putIfAbsent (Duo Zhang) (tedyu: rev fbc852b6809184bdba0bbccb8ef3e1fe848d6f22)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14255222" author="hudson" created="Sun, 21 Dec 2014 17:20:43 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #5955 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5955/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5955/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10201&quot; title=&quot;Port &amp;#39;Make flush decisions per column family&amp;#39; to trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10201&quot;&gt;&lt;del&gt;HBASE-10201&lt;/del&gt;&lt;/a&gt; Addendum fixes typo of putIfAbsent (Duo Zhang) (tedyu: rev 51334fb951232aa56add118d142e6b82da204494)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14571134" author="ndimiduk" created="Wed, 3 Jun 2015 15:29:11 +0000"  >&lt;p&gt;Closing issues released in 1.1.0.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12788345">HBASE-13408</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12478262">HBASE-3149</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12752121">HBASE-12405</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12687614" name="10201-addendum.txt" size="1277" author="yuzhihong@gmail.com" created="Tue, 16 Dec 2014 23:51:17 +0000"/>
                            <attachment id="12619385" name="3149-trunk-v1.txt" size="91031" author="yuzhihong@gmail.com" created="Wed, 18 Dec 2013 19:09:43 +0000"/>
                            <attachment id="12674462" name="HBASE-10201-0.98.patch" size="112162" author="Apache9" created="Mon, 13 Oct 2014 05:36:15 +0000"/>
                            <attachment id="12674711" name="HBASE-10201-0.98_1.patch" size="116314" author="Apache9" created="Tue, 14 Oct 2014 06:57:48 +0000"/>
                            <attachment id="12674912" name="HBASE-10201-0.98_2.patch" size="118221" author="Apache9" created="Wed, 15 Oct 2014 03:58:03 +0000"/>
                            <attachment id="12677829" name="HBASE-10201-0.99.patch" size="106407" author="Apache9" created="Wed, 29 Oct 2014 05:30:38 +0000"/>
                            <attachment id="12688571" name="HBASE-10201-addendum_1.patch" size="1251" author="Apache9" created="Sun, 21 Dec 2014 11:44:32 +0000"/>
                            <attachment id="12677274" name="HBASE-10201.patch" size="107240" author="Apache9" created="Mon, 27 Oct 2014 09:11:35 +0000"/>
                            <attachment id="12677319" name="HBASE-10201_1.patch" size="105431" author="Apache9" created="Mon, 27 Oct 2014 15:42:30 +0000"/>
                            <attachment id="12682853" name="HBASE-10201_10.patch" size="131119" author="Apache9" created="Fri, 21 Nov 2014 11:16:38 +0000"/>
                            <attachment id="12684125" name="HBASE-10201_11.patch" size="131041" author="Apache9" created="Fri, 28 Nov 2014 01:00:32 +0000"/>
                            <attachment id="12684565" name="HBASE-10201_12.patch" size="134060" author="Apache9" created="Tue, 2 Dec 2014 05:44:16 +0000"/>
                            <attachment id="12685263" name="HBASE-10201_13.patch" size="138354" author="stack" created="Fri, 5 Dec 2014 06:50:38 +0000"/>
                            <attachment id="12685098" name="HBASE-10201_13.patch" size="138354" author="Apache9" created="Thu, 4 Dec 2014 11:09:18 +0000"/>
                            <attachment id="12685611" name="HBASE-10201_14.patch" size="140927" author="Apache9" created="Sun, 7 Dec 2014 15:41:56 +0000"/>
                            <attachment id="12685612" name="HBASE-10201_15.patch" size="140863" author="Apache9" created="Sun, 7 Dec 2014 15:56:29 +0000"/>
                            <attachment id="12685645" name="HBASE-10201_16.patch" size="140912" author="Apache9" created="Mon, 8 Dec 2014 00:35:47 +0000"/>
                            <attachment id="12685679" name="HBASE-10201_17.patch" size="140881" author="Apache9" created="Mon, 8 Dec 2014 06:27:39 +0000"/>
                            <attachment id="12686240" name="HBASE-10201_18.patch" size="142306" author="Apache9" created="Wed, 10 Dec 2014 10:20:23 +0000"/>
                            <attachment id="12687023" name="HBASE-10201_19.patch" size="147479" author="Apache9" created="Sat, 13 Dec 2014 06:02:54 +0000"/>
                            <attachment id="12677580" name="HBASE-10201_2.patch" size="106330" author="Apache9" created="Tue, 28 Oct 2014 10:45:52 +0000"/>
                            <attachment id="12677610" name="HBASE-10201_3.patch" size="106742" author="Apache9" created="Tue, 28 Oct 2014 15:01:43 +0000"/>
                            <attachment id="12678367" name="HBASE-10201_4.patch" size="107073" author="Apache9" created="Fri, 31 Oct 2014 00:37:13 +0000"/>
                            <attachment id="12678382" name="HBASE-10201_5.patch" size="106723" author="Apache9" created="Fri, 31 Oct 2014 02:19:03 +0000"/>
                            <attachment id="12681029" name="HBASE-10201_6.patch" size="106756" author="Apache9" created="Wed, 12 Nov 2014 07:49:20 +0000"/>
                            <attachment id="12681891" name="HBASE-10201_7.patch" size="127409" author="Apache9" created="Mon, 17 Nov 2014 13:07:22 +0000"/>
                            <attachment id="12682076" name="HBASE-10201_8.patch" size="130338" author="Apache9" created="Tue, 18 Nov 2014 03:10:24 +0000"/>
                            <attachment id="12682818" name="HBASE-10201_9.patch" size="138543" author="Apache9" created="Fri, 21 Nov 2014 05:08:10 +0000"/>
                            <attachment id="12685519" name="compactions.png" size="31399" author="stack" created="Sat, 6 Dec 2014 03:54:34 +0000"/>
                            <attachment id="12685517" name="count.png" size="17223" author="stack" created="Sat, 6 Dec 2014 03:54:34 +0000"/>
                            <attachment id="12685518" name="io.png" size="18435" author="stack" created="Sat, 6 Dec 2014 03:54:34 +0000"/>
                            <attachment id="12685516" name="memstore.png" size="21332" author="stack" created="Sat, 6 Dec 2014 03:54:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 13 Oct 2014 05:36:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>364512</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qtvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>364812</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Adds new flushing policy mechanism. Default, org.apache.hadoop.hbase.regionserver.FlushLargeStoresPolicy, will try to avoid flushing out the small column families in a region, those whose memstores are &amp;lt; hbase.hregion.percolumnfamilyflush.size.lower.bound. To restore the old behavior of flushes writing out all column families, set hbase.regionserver.flush.policy to org.apache.hadoop.hbase.regionserver.FlushAllStoresPolicy either in hbase-default.xml or on a per-table basis by setting the policy to use with HTableDescriptor.getFlushPolicyClassName().</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>