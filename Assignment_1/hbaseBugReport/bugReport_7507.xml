<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:46:25 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7507/HBASE-7507.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7507] Make memstore flush be able to retry after exception</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7507</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We will abort regionserver if memstore flush throws exception.&lt;/p&gt;

&lt;p&gt;I thinks we could do retry to make regionserver more stable because file system may be not ok in a transient time. e.g. Switching namenode in the NamenodeHA environment&lt;/p&gt;



&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
HRegion#internalFlushcache(){

...
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
...
}&lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(Throwable t){
DroppedSnapshotException dse = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DroppedSnapshotException(&lt;span class=&quot;code-quote&quot;&gt;&quot;region: &quot;&lt;/span&gt; +
          Bytes.toStringBinary(getRegionName()));
dse.initCause(t);
&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; dse;
}
...

}

MemStoreFlusher#flushRegion(){
...
region.flushcache();
...
 &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
}&lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(DroppedSnapshotException ex){
server.abort(&lt;span class=&quot;code-quote&quot;&gt;&quot;Replay of HLog required. Forcing server shutdown&quot;&lt;/span&gt;, ex);
}

...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12626327">HBASE-7507</key>
            <summary>Make memstore flush be able to retry after exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zjushch">chunhui shen</assignee>
                                    <reporter username="zjushch">chunhui shen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 Jan 2013 10:30:22 +0000</created>
                <updated>Fri, 12 Apr 2013 04:15:23 +0000</updated>
                            <resolved>Mon, 25 Feb 2013 20:55:38 +0000</resolved>
                                    <version>0.94.6</version>
                    <version>0.95.0</version>
                                    <fixVersion>0.94.6</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>14</watches>
                                                                <comments>
                            <comment id="13545990" author="yuzhihong@gmail.com" created="Mon, 7 Jan 2013 16:05:42 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          lastException = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(e);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If e is instanceof IOException, we don&apos;t need to wrap it, right ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          &lt;span class=&quot;code-comment&quot;&gt;// Path name is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; there is no entries to flush&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;no entries&apos; -&amp;gt; &apos;no entry&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+            validateStoreFile(pathName);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Why moving the location of validateStoreFile() call ?&lt;/p&gt;</comment>
                            <comment id="13546040" author="ram_krish" created="Mon, 7 Jan 2013 17:02:51 +0000"  >&lt;p&gt;Seems good Chunhui.  Why don&apos;t we expose it as a configuration with default 1 so that any one can change it if they have an env as stated by your usecase.&lt;/p&gt;</comment>
                            <comment id="13546173" author="stack" created="Mon, 7 Jan 2013 19:13:20 +0000"  >&lt;p&gt;I&apos;d be fine making this configurable as long as retry enabled was the default.&lt;/p&gt;

&lt;p&gt;Flushing is not the only write we do.  Should we open a new issue to retry all hdfs operations?  Put the retries into our wrapper around our filesystem instance, HFileSystem?&lt;/p&gt;
</comment>
                            <comment id="13546341" author="apurtell" created="Mon, 7 Jan 2013 22:25:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should we open a new issue to retry all hdfs operations?  Put the retries into our wrapper around our filesystem instance, HFileSystem?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We could have methods that accept parameters for the op and then an optional retry count/flag? Some cases won&apos;t want to retry?&lt;/p&gt;</comment>
                            <comment id="13546622" author="zjushch" created="Tue, 8 Jan 2013 05:30:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why moving the location of validateStoreFile() call ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We can&apos;t do the retry in HStore#commitFile, but we could do the retry if failed validateStoreFile(), so move its location&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Should we open a new issue to retry all hdfs operations? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We will do the hdfs operations for HFile and HLog, and we could tolerate IO errors in HLog now.&lt;br/&gt;
So I think retry for flush is enough since IO errors in compaction are nothing matter&lt;/p&gt;

&lt;p&gt;For other comments, I will address in new patch&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13546680" author="lhofhansl" created="Tue, 8 Jan 2013 07:46:18 +0000"  >&lt;p&gt;Seems this would be important in 0.94 as well (unless it relies on some 0.96 only stuff)&lt;/p&gt;</comment>
                            <comment id="13546694" author="hadoopqa" created="Tue, 8 Jan 2013 08:27:26 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12563715/7507-trunk%20v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12563715/7507-trunk%20v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.TestReplicationWithCompression&lt;br/&gt;
                  org.apache.hadoop.hbase.TestLocalHBaseCluster&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 2 zombie test(s): &lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3930//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13547109" author="yuzhihong@gmail.com" created="Tue, 8 Jan 2013 18:44:51 +0000"  >&lt;p&gt;Patch v2 introduced two more integer fields into HStore.&lt;br/&gt;
Can we use static variable, an example being closeCheckInterval, so that FIXED_OVERHEAD doesn&apos;t increase ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      HStore.closeCheckInterval = conf.getInt(
          &lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.hstore.close.check.interval&quot;&lt;/span&gt;, 10*1000*1000 /* 10 MB */);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13550714" author="zjushch" created="Fri, 11 Jan 2013 02:26:50 +0000"  >&lt;p&gt;Attaching patch v3 as Ted&apos;s suggestion&lt;/p&gt;</comment>
                            <comment id="13550779" author="hadoopqa" created="Fri, 11 Jan 2013 03:23:44 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12564325/7507-trunkv3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12564325/7507-trunkv3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3974//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13550790" author="yuzhihong@gmail.com" created="Fri, 11 Jan 2013 03:41:55 +0000"  >&lt;p&gt;+1 on latest patch.&lt;br/&gt;
Nice to see a green QA run.&lt;/p&gt;</comment>
                            <comment id="13550860" author="lhofhansl" created="Fri, 11 Jan 2013 05:54:05 +0000"  >&lt;p&gt;What if I do not want to retry? With the current patch that is impossible (setting the retry number to 0 will force the code to reget the parameter on each call).&lt;/p&gt;</comment>
                            <comment id="13550867" author="zjushch" created="Fri, 11 Jan 2013 06:09:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;What if I do not want to retry?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Set HStore.flush_retries_number as 1, it means no retry. Maybe name &quot;retries&quot; is not suitable. But we use &apos;retries&apos; in &quot;hbase.client.retries.number&quot;,  in order to keep the same, here I use the name &apos;retries&apos;.&lt;br/&gt;
Setting &apos;hbase.client.retries.number&apos; as 1 means no retry, did we changed this semantic?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;setting the retry number to 0 will force the code to reget the parameter on each call&lt;/p&gt;&lt;/blockquote&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (HStore.flush_retries_number &amp;lt;= 0) {
+        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException(
+            &lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.hstore.flush.retries.number must be &amp;gt; 0, not &quot;&lt;/span&gt;
+                + HStore.flush_retries_number);
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Server will go down if set the retry number to 0&lt;/p&gt;</comment>
                            <comment id="13550869" author="lhofhansl" created="Fri, 11 Jan 2013 06:14:08 +0000"  >&lt;p&gt;You&apos;re right (looked at the patch again).&lt;br/&gt;
+1 then&lt;/p&gt;</comment>
                            <comment id="13554880" author="zjushch" created="Wed, 16 Jan 2013 09:45:35 +0000"  >&lt;p&gt;Commit it tomorrow if no objections&lt;br/&gt;
Thanks for the review&#65292; Ted, Ram, Lars&lt;/p&gt;</comment>
                            <comment id="13558482" author="lhofhansl" created="Mon, 21 Jan 2013 02:01:26 +0000"  >&lt;p&gt;Feel free to commit Chunhui &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13558484" author="zjushch" created="Mon, 21 Jan 2013 02:22:46 +0000"  >&lt;p&gt;Integrated to trunk and branch 0.94&lt;/p&gt;</comment>
                            <comment id="13558507" author="hudson" created="Mon, 21 Jan 2013 03:42:31 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3772 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3772/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3772/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7507&quot; title=&quot;Make memstore flush be able to retry after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7507&quot;&gt;&lt;del&gt;HBASE-7507&lt;/del&gt;&lt;/a&gt; Make memstore flush be able to retry after exception (Chunhui) (Revision 1436111)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
zjushch : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13558531" author="hudson" created="Mon, 21 Jan 2013 04:42:57 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #748 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/748/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/748/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7507&quot; title=&quot;Make memstore flush be able to retry after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7507&quot;&gt;&lt;del&gt;HBASE-7507&lt;/del&gt;&lt;/a&gt; Make memstore flush be able to retry after exception (Chunhui) (Revision 1436110)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
zjushch : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13558722" author="hudson" created="Mon, 21 Jan 2013 12:29:12 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #364 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/364/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/364/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7507&quot; title=&quot;Make memstore flush be able to retry after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7507&quot;&gt;&lt;del&gt;HBASE-7507&lt;/del&gt;&lt;/a&gt; Make memstore flush be able to retry after exception (Chunhui) (Revision 1436111)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
zjushch : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13561717" author="hudson" created="Thu, 24 Jan 2013 16:04:48 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #96 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/96/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/96/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7507&quot; title=&quot;Make memstore flush be able to retry after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7507&quot;&gt;&lt;del&gt;HBASE-7507&lt;/del&gt;&lt;/a&gt; Make memstore flush be able to retry after exception (Chunhui) (Revision 1436110)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
zjushch : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13563583" author="lhofhansl" created="Sat, 26 Jan 2013 18:45:15 +0000"  >&lt;p&gt;I think this could be an candidate for revert in light of recent unspecific test failures. I&apos;ll double check before I do that.&lt;/p&gt;</comment>
                            <comment id="13563639" author="lhofhansl" created="Sat, 26 Jan 2013 21:20:54 +0000"  >&lt;p&gt;I would like to revert this from 0.94. Unless we wrap every write to HDFS inside a retry loop we have not gained anything anyway.&lt;br/&gt;
Please speak up if you disagree.&lt;/p&gt;</comment>
                            <comment id="13564061" author="zjushch" created="Mon, 28 Jan 2013 05:38:17 +0000"  >&lt;p&gt;I have no objection for revert.&lt;/p&gt;</comment>
                            <comment id="13564454" author="lhofhansl" created="Mon, 28 Jan 2013 18:03:23 +0000"  >&lt;p&gt;Reverted from 0.94. Sorry &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zjushch&quot; class=&quot;user-hover&quot; rel=&quot;zjushch&quot;&gt;chunhui shen&lt;/a&gt;, there just have been test issues, and I would like to reduce the number of variables.&lt;/p&gt;</comment>
                            <comment id="13564584" author="hudson" created="Mon, 28 Jan 2013 19:28:12 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #795 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/795/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/795/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7507&quot; title=&quot;Make memstore flush be able to retry after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7507&quot;&gt;&lt;del&gt;HBASE-7507&lt;/del&gt;&lt;/a&gt; Revert, due to 0.94 test stability issues (Revision 1439534)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13566300" author="hudson" created="Wed, 30 Jan 2013 08:41:28 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #102 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/102/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/102/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7507&quot; title=&quot;Make memstore flush be able to retry after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7507&quot;&gt;&lt;del&gt;HBASE-7507&lt;/del&gt;&lt;/a&gt; Revert, due to 0.94 test stability issues (Revision 1439534)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13567031" author="enis" created="Wed, 30 Jan 2013 22:55:00 +0000"  >&lt;p&gt;I just saw this. I&apos;ve encountered the same thing and logged it &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7385&quot; title=&quot;Do not abort regionserver if StoreFlusher.flushCache() fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7385&quot;&gt;&lt;del&gt;HBASE-7385&lt;/del&gt;&lt;/a&gt;. My proposal there would be not to retry in the same flush request. But on exception, just retain the same snapshot, and on the next flush request comes, it will just reuse the same snapshot created earlier. What do you thing about this approach?  &lt;/p&gt;</comment>
                            <comment id="13567035" author="enis" created="Wed, 30 Jan 2013 22:58:04 +0000"  >&lt;p&gt;Reopened due to revert. &lt;/p&gt;</comment>
                            <comment id="13567084" author="lhofhansl" created="Wed, 30 Jan 2013 23:34:22 +0000"  >&lt;p&gt;I had removed the 0.94 target and this is still in 0.96 so resolving is still valid.&lt;/p&gt;</comment>
                            <comment id="13567094" author="enis" created="Wed, 30 Jan 2013 23:38:19 +0000"  >&lt;p&gt;If the test failed on 0.94 due to this, shouldn&apos;t we revert fomr trunk as well? &lt;/p&gt;</comment>
                            <comment id="13567114" author="lhofhansl" created="Wed, 30 Jan 2013 23:50:59 +0000"  >&lt;p&gt;I still do not know if this effected any tests. Random tests were timing out or fail for other reasons that I hadn&apos;t seen before.&lt;br/&gt;
In general we want that feature. Just that in 0.94 stability trumps a new feature.&lt;/p&gt;</comment>
                            <comment id="13567170" author="enis" created="Thu, 31 Jan 2013 00:42:07 +0000"  >&lt;p&gt;Sounds fair. Chunhui, what do you think about the test failures? Shall we keep the trunk patch? We probably want this in 0.94.6.  &lt;/p&gt;</comment>
                            <comment id="13567398" author="zjushch" created="Thu, 31 Jan 2013 06:17:06 +0000"  >&lt;p&gt;I could take a deep look about the test failures for the root cause.&lt;/p&gt;

&lt;p&gt;IMO, many test cases are not very stable because of itself or potential bug&lt;/p&gt;</comment>
                            <comment id="13571000" author="hudson" created="Tue, 5 Feb 2013 03:58:31 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #11 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/11/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/11/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7507&quot; title=&quot;Make memstore flush be able to retry after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7507&quot;&gt;&lt;del&gt;HBASE-7507&lt;/del&gt;&lt;/a&gt; Revert, due to 0.94 test stability issues (Revision 1439534)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7507&quot; title=&quot;Make memstore flush be able to retry after exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7507&quot;&gt;&lt;del&gt;HBASE-7507&lt;/del&gt;&lt;/a&gt; Make memstore flush be able to retry after exception (Chunhui) (Revision 1436110)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;zjushch : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13583971" author="stack" created="Fri, 22 Feb 2013 06:47:19 +0000"  >&lt;p&gt;Do we know what tests were failing when this patch was in 0.94?  Do you remember &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13583972" author="stack" created="Fri, 22 Feb 2013 06:48:38 +0000"  >&lt;p&gt;This is an important one for riding over ha nn topology changes (as per Chunhui).  Was seen on a cluster today.&lt;/p&gt;</comment>
                            <comment id="13584563" author="lhofhansl" created="Fri, 22 Feb 2013 19:16:03 +0000"  >&lt;p&gt;I don&apos;t know whether this caused the test failures. At this point I&apos;d say probably not.&lt;/p&gt;

&lt;p&gt;IMHO, this particular fix is only important if we have fixed all other write attempts for HDFS.&lt;/p&gt;</comment>
                            <comment id="13584902" author="v.himanshu" created="Sat, 23 Feb 2013 00:54:25 +0000"  >&lt;p&gt;This patch looks safe to me (shouldn&apos;t introduce any flakiness as such). Ran it on jenkins on the current 0.94 and it was green. Rather, I think instead of re-trying the flush operation, why not just check whether the file system is available or not in a re-trying mode? That should be more efficient. Or, yo have considered that already?&lt;/p&gt;

&lt;p&gt;The other possible candidates in a running cluster I can see are Compaction and Log rolling. The former can be made to check the file system health in a retrying manner (if people agree, I can upload a patch for that). &lt;br/&gt;
The log rolling looks a bit tricky because there are two idempotent operations involved: Creating a new HLog writer, and closing the existing one. Having a retrying loop for these (especially creating a new hlog file in the .logs directory) doesn&apos;t look to be a good idea. I would avoid doing that. &lt;br/&gt;
Looking for more opinions?&lt;/p&gt;</comment>
                            <comment id="13584930" author="enis" created="Sat, 23 Feb 2013 01:29:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;This is an important one for riding over ha nn topology changes (as per Chunhui). Was seen on a cluster today.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;As I reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7385&quot; title=&quot;Do not abort regionserver if StoreFlusher.flushCache() fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7385&quot;&gt;&lt;del&gt;HBASE-7385&lt;/del&gt;&lt;/a&gt;, we&apos;ve also seen this in NN HA tests.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;IMHO, this particular fix is only important if we have fixed all other write attempts for HDFS.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We have seen some other edge case, where NN dies just before returning the RPC response for create file, next retry from the DFS client fails due to file already exists exception. I think I&apos;ve logged it somewhere. Regardless, I think, fixing the memstore flush is important, since it causes RS to abort on fail. &lt;/p&gt;

&lt;p&gt;Should we commit it, and if tests start failing, fix them later?&lt;/p&gt;</comment>
                            <comment id="13584933" author="apurtell" created="Sat, 23 Feb 2013 01:33:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should we commit it, and if tests start failing, fix them later?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I would be curious to see if committing this again causes an uptick in test failure or not, if the previous observation was in fact correlated.&lt;/p&gt;</comment>
                            <comment id="13584990" author="zjushch" created="Sat, 23 Feb 2013 03:33:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;The other possible candidates in a running cluster I can see are Compaction and Log rolling&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Failure hdfs operation of Compaction  and Log rolling won&apos;t cause RS to abort, so I think these failures are acceptable.&lt;/p&gt;</comment>
                            <comment id="13585005" author="stack" created="Sat, 23 Feb 2013 05:08:55 +0000"  >&lt;p&gt;A review of all FS access to ferret out where we should retry and where we should not is a big job.  This small patch improves the situation.  It is in trunk already.  Would you be up for Andy&apos;s suggestion Lars of trying this patch on 0.94 branch?  As Chunhui says, this patch addresses at least the most aggrevating case, the one that causes a RS crash out.  It is an ugly patch.  We should work on something more comprehensive as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hvashish%40cs.ualberta.ca&quot; class=&quot;user-hover&quot; rel=&quot;hvashish@cs.ualberta.ca&quot;&gt;Himanshu Vashishtha&lt;/a&gt; says in trunk/0.96 (thanks).&lt;/p&gt;</comment>
                            <comment id="13585043" author="lhofhansl" created="Sat, 23 Feb 2013 06:11:48 +0000"  >&lt;p&gt;Yeah, let&apos;s recommit. +1&lt;/p&gt;</comment>
                            <comment id="13585264" author="v.himanshu" created="Sun, 24 Feb 2013 03:09:20 +0000"  >&lt;p&gt;+1 to the re-commit. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zjushch&quot; class=&quot;user-hover&quot; rel=&quot;zjushch&quot;&gt;chunhui shen&lt;/a&gt; Yes compaction will not abort the rs, but HLog rolling will abort it. It&apos;s in the LogRoller#run where it catches IOException and calls the abort. If we go with the re-trying logic, we need it at two places there. First, at the log creation (one can do so at the HLog#createWriter()), and other while archiving old logs. &lt;/p&gt;

&lt;p&gt;I agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; that it is not a good fix, and I would try to avoid this for log rolling (which is not so frequent as flushes are).&lt;/p&gt;</comment>
                            <comment id="13585985" author="stack" created="Mon, 25 Feb 2013 16:58:57 +0000"  >&lt;p&gt;Regards the 0.94 patch, why are these statics?&lt;/p&gt;

&lt;p&gt;+  private static final int DEFAULT_FLUSH_RETRIES_NUMBER = 10;&lt;br/&gt;
+  private static int flush_retries_number;&lt;br/&gt;
+  private static int pauseTime;&lt;/p&gt;


&lt;p&gt;Patch looks fine.  Pity as said already that we have to localize the retry and rather we can&apos;t put all the retries behind a filesystem facade; we can do this for 0.96....&lt;/p&gt;

&lt;p&gt;I wonder what happens retrying after an IOE.    Is it ok retrying any IOE?  Has the flush path been reviewed to make sure only IOE is failed NN op?   Is it possible to get an IOE after the file has been successfully written?&lt;/p&gt;

&lt;p&gt;Just wondering.  Would say commit &amp;#8211; because helps us work with HA NN (HANN).&lt;/p&gt;</comment>
                            <comment id="13585987" author="stack" created="Mon, 25 Feb 2013 16:59:25 +0000"  >&lt;p&gt;Oh, I&apos;ll commit in a while unless I am beaten to it.&lt;/p&gt;</comment>
                            <comment id="13586000" author="stack" created="Mon, 25 Feb 2013 17:10:07 +0000"  >&lt;p&gt;Here is issue used to reapply 0.94 version of the patch to 0.94 branch.&lt;/p&gt;</comment>
                            <comment id="13586001" author="stack" created="Mon, 25 Feb 2013 17:10:39 +0000"  >&lt;p&gt;Done.  Hopefully it doesn&apos;t mess up the 0.94 tests.  Flag me and I&apos;ll remove it again.&lt;/p&gt;</comment>
                            <comment id="13586272" author="stack" created="Mon, 25 Feb 2013 20:55:38 +0000"  >&lt;p&gt;This was committed to trunk a while back.  A new issue just committed it to 0.94.  Resolving.&lt;/p&gt;</comment>
                            <comment id="13586405" author="hudson" created="Mon, 25 Feb 2013 22:50:48 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #858 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/858/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/858/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7929&quot; title=&quot;Reapply hbase-7507 &amp;quot;Make memstore flush be able to retry after exception&amp;quot; to 0.94 branch.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7929&quot;&gt;&lt;del&gt;HBASE-7929&lt;/del&gt;&lt;/a&gt; Reapply hbase-7507 &quot;Make memstore flush be able to retry after exception&quot; to 0.94 branch (Revision 1449779)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;/p&gt;</comment>
                            <comment id="13586627" author="zjushch" created="Tue, 26 Feb 2013 02:04:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;I wonder what happens retrying after an IOE. Is it ok retrying any IOE? Has the flush path been reviewed to make sure only IOE is failed NN op? Is it possible to get an IOE after the file has been successfully written?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Before flushed file committed, we could always retry flushing. &lt;/p&gt;

&lt;p&gt;Flush path is always unique by StoreFile#getUniqueFile.&lt;/p&gt;

&lt;p&gt;Store#validateStoreFile may throw exception after successfully written when switching namenode in the NamenodeHA environment. We have encountered this case.&lt;/p&gt;</comment>
                            <comment id="13586896" author="hudson" created="Tue, 26 Feb 2013 07:27:00 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #112 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/112/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/112/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7929&quot; title=&quot;Reapply hbase-7507 &amp;quot;Make memstore flush be able to retry after exception&amp;quot; to 0.94 branch.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7929&quot;&gt;&lt;del&gt;HBASE-7929&lt;/del&gt;&lt;/a&gt; Reapply hbase-7507 &quot;Make memstore flush be able to retry after exception&quot; to 0.94 branch (Revision 1449779)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;/p&gt;</comment>
                            <comment id="13589268" author="hudson" created="Thu, 28 Feb 2013 06:59:40 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #869 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/869/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/869/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7929&quot; title=&quot;Reapply hbase-7507 &amp;quot;Make memstore flush be able to retry after exception&amp;quot; to 0.94 branch.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7929&quot;&gt;&lt;del&gt;HBASE-7929&lt;/del&gt;&lt;/a&gt; Reapply hbase-7507 &quot;Make memstore flush be able to retry after exception&quot; to 0.94 branch. (Revision 1451087)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;/p&gt;</comment>
                            <comment id="13589274" author="stack" created="Thu, 28 Feb 2013 07:04:13 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zjushch&quot; class=&quot;user-hover&quot; rel=&quot;zjushch&quot;&gt;chunhui shen&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13589291" author="hudson" created="Thu, 28 Feb 2013 07:32:18 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #113 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/113/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/113/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7929&quot; title=&quot;Reapply hbase-7507 &amp;quot;Make memstore flush be able to retry after exception&amp;quot; to 0.94 branch.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7929&quot;&gt;&lt;del&gt;HBASE-7929&lt;/del&gt;&lt;/a&gt; Reapply hbase-7507 &quot;Make memstore flush be able to retry after exception&quot; to 0.94 branch. (Revision 1451087)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;/p&gt;</comment>
                            <comment id="13593197" author="hudson" created="Tue, 5 Mar 2013 07:52:18 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #12 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/12/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/12/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7929&quot; title=&quot;Reapply hbase-7507 &amp;quot;Make memstore flush be able to retry after exception&amp;quot; to 0.94 branch.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7929&quot;&gt;&lt;del&gt;HBASE-7929&lt;/del&gt;&lt;/a&gt; Reapply hbase-7507 &quot;Make memstore flush be able to retry after exception&quot; to 0.94 branch. (Revision 1451087)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7929&quot; title=&quot;Reapply hbase-7507 &amp;quot;Make memstore flush be able to retry after exception&amp;quot; to 0.94 branch.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7929&quot;&gt;&lt;del&gt;HBASE-7929&lt;/del&gt;&lt;/a&gt; Reapply hbase-7507 &quot;Make memstore flush be able to retry after exception&quot; to 0.94 branch (Revision 1449779)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;/p&gt;</comment>
                            <comment id="13629656" author="hudson" created="Fri, 12 Apr 2013 01:09:27 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #957 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/957/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/957/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7929&quot; title=&quot;Reapply hbase-7507 &amp;quot;Make memstore flush be able to retry after exception&amp;quot; to 0.94 branch.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7929&quot;&gt;&lt;del&gt;HBASE-7929&lt;/del&gt;&lt;/a&gt; Reapply hbase-7507 &apos;Make memstore flush be able to retry after exception&apos; to 0.94 branch. (Original patch by chunhui shen) (Revision 1467121)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;/p&gt;</comment>
                            <comment id="13629774" author="hudson" created="Fri, 12 Apr 2013 04:15:23 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #134 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/134/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/134/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7929&quot; title=&quot;Reapply hbase-7507 &amp;quot;Make memstore flush be able to retry after exception&amp;quot; to 0.94 branch.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7929&quot;&gt;&lt;del&gt;HBASE-7929&lt;/del&gt;&lt;/a&gt; Reapply hbase-7507 &apos;Make memstore flush be able to retry after exception&apos; to 0.94 branch. (Original patch by chunhui shen) (Revision 1467121)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12624556">HBASE-7385</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12633948">HBASE-7929</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12565724" name="7507-94.patch" size="4276" author="zjushch" created="Mon, 21 Jan 2013 02:21:53 +0000"/>
                            <attachment id="12563548" name="7507-trunk v1.patch" size="2234" author="zjushch" created="Mon, 7 Jan 2013 10:46:10 +0000"/>
                            <attachment id="12563715" name="7507-trunk v2.patch" size="4704" author="zjushch" created="Tue, 8 Jan 2013 07:21:51 +0000"/>
                            <attachment id="12564325" name="7507-trunkv3.patch" size="4361" author="zjushch" created="Fri, 11 Jan 2013 02:26:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 7 Jan 2013 16:05:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>302913</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 36 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i176db:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>250000</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>