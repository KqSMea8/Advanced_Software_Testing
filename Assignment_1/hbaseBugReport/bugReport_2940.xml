<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:06:02 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2940/HBASE-2940.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2940] Improve behavior under partial failure of region servers</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2940</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;On larger clusters, we often see failure cases where a server is &quot;up&quot; (ie heartbeating) but unable to actually service requests properly (or at a reasonable speed). This can happen for any number of reasons including:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;failing disks or disk controllers respond, but do so very slowly&lt;/li&gt;
	&lt;li&gt;the machine is swapping, so everything is still running but much more slowly than expected&lt;/li&gt;
	&lt;li&gt;HBase or the DN on the machine has been misconfigured (eg missing lzo libs) so it fails to correctly open regions, perform flushes, etc.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Here are a few proposed features that are worth considering:&lt;br/&gt;
1) Add a &quot;blacklist&quot; or &quot;remote shutdown&quot; functionality to the master. This is useful if the region server is up but for some reason the admin can&apos;t ssh in to shut it down (eg the root disk has failed). This feature would allow the admin to issue a command that will shut down any given RS.&lt;br/&gt;
2) Periodically run a &quot;health check&quot; script on the region server node. If the script returns an error code, the RS could shut itself down gracefully and report an error message on the master console.&lt;br/&gt;
3) Allow clients to report back RS-specific errors to the master. This would be useful for monitoring, and we could add heuristics to automatically shut down region servers if they have an elevated error count over some period of time.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12472821">HBASE-2940</key>
            <summary>Improve behavior under partial failure of region servers</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="11">Done</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Sun, 29 Aug 2010 20:28:39 +0000</created>
                <updated>Wed, 16 Jul 2014 22:25:26 +0000</updated>
                            <resolved>Wed, 16 Jul 2014 22:25:26 +0000</resolved>
                                                                    <component>master</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="12904033" author="ryanobjc" created="Sun, 29 Aug 2010 20:43:25 +0000"  >&lt;p&gt;I think the primary mechanism of shutdown/termination should be via the hlog&lt;br/&gt;
block. The master should close the logfile then reassign regions. Since the&lt;br/&gt;
hlog is gone any operations that were successful would terminate and the&lt;br/&gt;
reassignment would prevent new clients from talking to the dead server.&lt;/p&gt;

&lt;p&gt;heartbeating) but unable to actually service requests properly (or at a&lt;br/&gt;
reasonable speed). This can happen for any number of reasons including:&lt;br/&gt;
slowly than expected&lt;br/&gt;
libs) so it fails to correctly open regions, perform flushes, etc.&lt;br/&gt;
This is useful if the region server is up but for some reason the admin&lt;br/&gt;
can&apos;t ssh in to shut it down (eg the root disk has failed). This feature&lt;br/&gt;
would allow the admin to issue a command that will shut down any given RS.&lt;br/&gt;
the script returns an error code, the RS could shut itself down gracefully&lt;br/&gt;
and report an error message on the master console.&lt;br/&gt;
would be useful for monitoring, and we could add heuristics to automatically&lt;br/&gt;
shut down region servers if they have an elevated error count over some&lt;br/&gt;
period of time.&lt;/p&gt;</comment>
                            <comment id="12904058" author="ted_yu" created="Mon, 30 Aug 2010 00:54:50 +0000"  >&lt;p&gt;Since hbase.rootdir points to hadoop namenode, HBase Master can poll hadoop for the live data nodes. If a data node comes down for longer than specified duration and a RS happens to be on the same server, Master can blacklist that RS (assuming there is problem with heartbeat from that RS in the same time period).&lt;/p&gt;</comment>
                            <comment id="12904269" author="streamy" created="Mon, 30 Aug 2010 18:05:20 +0000"  >&lt;p&gt;I like this direction.  We&apos;re starting to use HBCK fairly heavily as a periodic health-check script and there were some ideas about some kind of basic read/write verification test on each RS as part of it.&lt;/p&gt;

&lt;p&gt;@Todd, #1 sounds good.  There has been talk from ops guys here about having a separate file with a list of blacklisted RS (there&apos;s something like this in hadoop I believe), so you can add nodes under maintenance or blacklisted from something related to this jira.  #2, see above.  definitely an RS sanity check would be nice (can you append to log, can you do basic read/write, etc).  #3, interesting.  need to think on that more.&lt;/p&gt;

&lt;p&gt;@Ryan, that seems like a secondary mechanism for shutting down an RS because it will always require log replay.  Though the reasons above might require a forceful external abort, if the RS is responsive, we should do a controlled shutdown so regions can be flushed.  If it takes too long or RS is unresponsive, then using the HLog sounds like a good strategy.  Need to be sure whatever properties of hdfs appends we&apos;re using will not change between the 0.20 implementation and the 0.21 and later one.&lt;/p&gt;

&lt;p&gt;@Ted, HBase is far better at determining live/dead nodes than the NN (zk vs 3 minute timeout heartbeats), so I wouldn&apos;t expect this to be a big win.  It&apos;s also an open question whether you would always want an RS with a dead DN on the same machine to also go down.  Maybe there is a situation where this would be useful information to have in HBase but need to think on it more.  In most instances, if there is a problem with the node and we want HBase to proactively kill an RS, we would know in HBase-land.&lt;/p&gt;</comment>
                            <comment id="14064246" author="apurtell" created="Wed, 16 Jul 2014 22:25:26 +0000"  >&lt;p&gt;Superseded by the MTTR constellation of issues. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 29 Aug 2010 20:43:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 22 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hjxr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100492</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>