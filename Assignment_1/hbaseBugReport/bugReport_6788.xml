<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:39:51 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6788/HBASE-6788.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6788] Convert AuthenticationProtocol to protocol buffer service</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6788</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;With coprocessor endpoints now exposed as protobuf defined services, we should convert over all of our built-in endpoints to PB services.&lt;/p&gt;

&lt;p&gt;AccessControllerProtocol was converted as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5448&quot; title=&quot;Support for dynamic coprocessor endpoints with PB-based RPC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5448&quot;&gt;&lt;del&gt;HBASE-5448&lt;/del&gt;&lt;/a&gt;, but the authentication token provider still needs to be changed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12607680">HBASE-6788</key>
            <summary>Convert AuthenticationProtocol to protocol buffer service</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12540505">HBASE-5305</parent>
                                    <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ghelmling">Gary Helmling</assignee>
                                    <reporter username="ghelmling">Gary Helmling</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Sep 2012 17:18:06 +0000</created>
                <updated>Mon, 23 Sep 2013 18:30:38 +0000</updated>
                            <resolved>Wed, 19 Dec 2012 21:28:27 +0000</resolved>
                                                    <fixVersion>0.95.0</fixVersion>
                                    <component>Coprocessors</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13458168" author="stack" created="Tue, 18 Sep 2012 21:05:48 +0000"  >&lt;p&gt;This should be made a blocker, huh, Gary?&lt;/p&gt;</comment>
                            <comment id="13458236" author="ghelmling" created="Tue, 18 Sep 2012 22:11:24 +0000"  >&lt;p&gt;Yes, this one definitely.  The other conversion sub-tasks would be blockers as well if we&apos;re actually going to drop the CoprocessorProtocol implementations from 0.96 instead of deprecate.&lt;/p&gt;</comment>
                            <comment id="13459762" author="ghelmling" created="Thu, 20 Sep 2012 17:23:00 +0000"  >&lt;p&gt;Looking at this, we also need to convert the serialization of AuthenticationKey to be PB-based.  AuthenticationKeys are serialized into ZK znodes to coordinate secret key rolling for authentication token signing and validation.&lt;/p&gt;</comment>
                            <comment id="13459795" author="apurtell" created="Thu, 20 Sep 2012 17:54:54 +0000"  >&lt;p&gt;I&apos;d be +1 with dropping CoprocessorProtocol from 0.96 and up, given all of the other (deliberate) incompatibilities posed with RPC going from 0.94 to 0.96 and up.&lt;/p&gt;

&lt;p&gt;Edit: Removed accidental markup.&lt;/p&gt;</comment>
                            <comment id="13526053" author="ghelmling" created="Fri, 7 Dec 2012 00:56:02 +0000"  >&lt;p&gt;Here&apos;s an initial patch dropping AuthenticationProtocol and converting TokenProvider to a PB service.&lt;/p&gt;

&lt;p&gt;I&apos;ve tested this on a local secure Hadoop + HBase setup and had token authentication working for a simple RowCounter MR job.  I&apos;m still looking to see if there&apos;s a clean way to extend TestTokenAuthentication to better test this in the absence of Kerberos.&lt;/p&gt;</comment>
                            <comment id="13530748" author="hadoopqa" created="Thu, 13 Dec 2012 07:11:08 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12559778/HBASE-6788.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12559778/HBASE-6788.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 109 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 23 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestHCM&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3517//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13530753" author="stack" created="Thu, 13 Dec 2012 07:22:30 +0000"  >&lt;p&gt;AuthenticationTokenIdentifier is still a Writable?  Is that because Exec needs to go over still Gary?&lt;/p&gt;

&lt;p&gt;Otherwise, I&apos;m not whats going on but patch looks good.&lt;/p&gt;

&lt;p&gt;Thanks Gary.&lt;/p&gt;</comment>
                            <comment id="13532069" author="stack" created="Fri, 14 Dec 2012 05:43:41 +0000"  >&lt;p&gt;I went over the patch again.  I think I follow what is going on.  This AuthenticationTokenIdentifier implements the Hadoop TokenIdentifier.  Its a Writable and nought you can do about it, not at moment, so you are outputting pb when write and expecting pb when you readFrom.  That seems to make sense given the constraint.&lt;/p&gt;

&lt;p&gt;Is this needed anymore?&lt;/p&gt;

&lt;p&gt;   public static final long VERSION = 0L;&lt;/p&gt;

&lt;p&gt;Why do this Gary?&lt;/p&gt;

&lt;p&gt;+    return AuthenticationProtos.AuthenticationService.newReflectiveService(this);&lt;/p&gt;

&lt;p&gt;Why can&apos;t we just return &apos;this&apos;?&lt;/p&gt;

&lt;p&gt;Else patch looks good (again)&lt;/p&gt;
</comment>
                            <comment id="13532100" author="ghelmling" created="Fri, 14 Dec 2012 06:50:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; Thanks for the review.  Sorry to update it again just after you&apos;ve taken a look.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;This AuthenticationTokenIdentifier implements the Hadoop TokenIdentifier. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, AuthenticationTokenIdentifier still needs to retain the Writable interface since Token (Hadoop class) uses this internally, and we rely on Token to tie in transparently to the Hadoop UGI credentials.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;public static final long VERSION = 0L;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Nice catch, no longer needed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;+ return AuthenticationProtos.AuthenticationService.newReflectiveService(this);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Since TokenProvider implements AuthenticationService.Interface, this translates that back into a Service instance.&lt;/p&gt;</comment>
                            <comment id="13532108" author="ghelmling" created="Fri, 14 Dec 2012 06:51:49 +0000"  >&lt;p&gt;Updated patch addressing Nick&apos;s comment on required PB fields, Stack&apos;s comment on VERSION and adding a real test of token auth to TestTokenAuthentication.&lt;/p&gt;</comment>
                            <comment id="13532165" author="hadoopqa" created="Fri, 14 Dec 2012 08:49:55 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12560924/HBASE-6788_2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12560924/HBASE-6788_2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool generates 5 additional warning messages with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 23 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.security.token.TestTokenAuthentication&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3543//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13532362" author="yuzhihong@gmail.com" created="Fri, 14 Dec 2012 15:06:23 +0000"  >&lt;p&gt;I added the following line to start TokenServer:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    serverThread.run();
    &lt;span class=&quot;code-comment&quot;&gt;// wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; startup
&lt;/span&gt;    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(1000);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But this call:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.rpcServer.start();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;resulted in:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.IllegalThreadStateException
  at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.start(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:656)
  at org.apache.hadoop.hbase.ipc.HBaseServer.startThreads(HBaseServer.java:2004)
  at org.apache.hadoop.hbase.ipc.ProtobufRpcEngine$Server.startThreads(ProtobufRpcEngine.java:293)
  at org.apache.hadoop.hbase.ipc.HBaseServer.start(HBaseServer.java:1986)
  at org.apache.hadoop.hbase.security.token.TestTokenAuthentication$TokenServer.initialize(TestTokenAuthentication.java:167)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Will dig some more.&lt;/p&gt;</comment>
                            <comment id="13532490" author="ghelmling" created="Fri, 14 Dec 2012 17:42:12 +0000"  >&lt;p&gt;Thanks for taking a look, Ted.  I don&apos;t think the serverThread.run() should be needed, as Threads.setDaemonRunning() does call .start() on the passed in thread.&lt;/p&gt;

&lt;p&gt;TestTokenAuthentication is passing repeatedly for me locally, but obviously something is wrong.  I&apos;ll take a look at the QA bot output and see what&apos;s going on.&lt;/p&gt;</comment>
                            <comment id="13532514" author="ghelmling" created="Fri, 14 Dec 2012 18:15:14 +0000"  >&lt;p&gt;Hadoop QA output is reporting a NPE in setupBeforeClass() &amp;#8211; the secretManager reference is null.  This shows up in the following lines of TestTokenAuthentication:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
secretManager = (AuthenticationTokenSecretManager)server.getSecretManager();
&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;(secretManager.getCurrentKey() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the while loop test, it seems that &lt;tt&gt;secretManger&lt;/tt&gt; is null.&lt;/p&gt;

&lt;p&gt;I&apos;m thinking this is a timing issue, with the TokenServer&apos;s RpcServer not yet fully started up.  I&apos;ll put in a better wait busy loop until TokenServer is up, and see if that fixes it.&lt;/p&gt;</comment>
                            <comment id="13532526" author="ghelmling" created="Fri, 14 Dec 2012 18:30:26 +0000"  >&lt;p&gt;New patch that waits for TokenServer startup in TestTokenAuthentication.&lt;/p&gt;</comment>
                            <comment id="13532598" author="hadoopqa" created="Fri, 14 Dec 2012 19:53:55 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561007/HBASE-6788_3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561007/HBASE-6788_3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool generates 5 additional warning messages with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 23 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestRollingRestart&lt;br/&gt;
                  org.apache.hadoop.hbase.security.token.TestTokenAuthentication&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are zombie tests. See build logs for details.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13532627" author="ghelmling" created="Fri, 14 Dec 2012 20:20:23 +0000"  >&lt;p&gt;Hmm, the NPE still seems to be thrown in effectively the same place.  Is there any way to see the test logging output from Hadoop QA?  I&apos;ve been unable to reproduce this locally at all.&lt;/p&gt;</comment>
                            <comment id="13532649" author="stack" created="Fri, 14 Dec 2012 20:47:50 +0000"  >&lt;p&gt;The testBasicRollingRestart failure has output but your test failure doesn&apos;t which is way unjust... &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//testReport/org.apache.hadoop.hbase.master/TestRollingRestart/testBasicRollingRestart/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3547//testReport/org.apache.hadoop.hbase.master/TestRollingRestart/testBasicRollingRestart/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13532656" author="ghelmling" created="Fri, 14 Dec 2012 21:01:33 +0000"  >&lt;p&gt;I think what&apos;s failing in Hadoop QA is the SecureTestUtil.forceInitializeSecurity() call (which I had reservations was ugly to add anyway).&lt;/p&gt;

&lt;p&gt;This patch removes the need for that by having HBaseClient and HBaseServer use User.isHBaseSecurityEnabled(), which looks for the hbase.security.authentication config value.  I think this is ultimately the more correct approach for HBaseClient/HBaseServer anyway, but I think it merits an entirely separate JIRA for discussing the change.  I&apos;m just including those changes here to verify that it does actually resolve the Hadoop QA test failure.&lt;/p&gt;</comment>
                            <comment id="13532657" author="yuzhihong@gmail.com" created="Fri, 14 Dec 2012 21:01:37 +0000"  >&lt;p&gt;Here is test output when I use patch v3:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2012-12-14 12:58:02,640 INFO  [main] log.Slf4jLog(67): Logging to org.slf4j.impl.Log4jLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog
2012-12-14 12:58:02,949 DEBUG [main] log.Slf4jLog(49): Security enabled = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2012-12-14 12:58:03,121 INFO  [main] hbase.HBaseTestingUtility(343): Created &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; mini-cluster data directory: /Users/zhihyu/trunk-hbase/hbase-server/target/test-data/e8346a90-1a41-4862-9d85-1aa325694f6e/dfscluster_3e981e0e-898b-4c8d-aa9c-c5caf69a8095
2012-12-14 12:58:03,270 INFO  [main] zookeeper.MiniZooKeeperCluster(197): Started MiniZK Cluster and connect 1 ZK server on client port: 63609
2012-12-14 12:58:03,379 WARN  [main] impl.MetricsSystemImpl(137): Metrics system not started: Cannot locate configuration: tried hadoop-metrics2-hbase.properties, hadoop-metrics2.properties
2012-12-14 12:58:03,402 DEBUG [TokenServer:10.246.204.205,58917,1355518683274] zookeeper.ZKConfig(84): Skipped reading ZK properties file &apos;zoo.cfg&apos; since &apos;hbase.config.read.zookeeper.config&apos; was not set to &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2012-12-14 12:58:03,406 DEBUG [TokenServer:10.246.204.205,58917,1355518683274] zookeeper.ZKUtil(102): TokenServer opening connection to ZooKeeper with ensemble (localhost:63609)
2012-12-14 12:58:03,426 INFO  [TokenServer:10.246.204.205,58917,1355518683274] zookeeper.RecoverableZooKeeper(104): The identifier of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; process is 81456@LM-SJC-00713032
2012-12-14 12:58:03,452 DEBUG [TokenServer:10.246.204.205,58917,1355518683274-EventThread] zookeeper.ZooKeeperWatcher(265): TokenServer Received ZooKeeper Event, type=None, state=SyncConnected, path=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
2012-12-14 12:58:03,454 DEBUG [TokenServer:10.246.204.205,58917,1355518683274-EventThread] zookeeper.ZooKeeperWatcher(342): TokenServer-0x13b9b35a83c0000 connected
2012-12-14 12:58:03,472 DEBUG [TokenServer:10.246.204.205,58917,1355518683274] log.Slf4jLog(49): Security enabled = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2012-12-14 12:58:03,570 INFO  [main] log.Slf4jLog(67): Stopping due to: Test complete
2012-12-14 12:58:03,573 INFO  [main] zookeeper.MiniZooKeeperCluster(246): Shutdown MiniZK cluster with all ZK servers
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note: security was shown as disabled.&lt;/p&gt;</comment>
                            <comment id="13532658" author="ghelmling" created="Fri, 14 Dec 2012 21:03:44 +0000"  >&lt;p&gt;Thanks, Ted.  That would verify that the SecureTestUtil.forceInitializeSecurity() call is failing.  The &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6788&quot; title=&quot;Convert AuthenticationProtocol to protocol buffer service&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6788&quot;&gt;&lt;del&gt;HBASE-6788&lt;/del&gt;&lt;/a&gt;_4.patch should fix that.&lt;/p&gt;</comment>
                            <comment id="13532665" author="yuzhihong@gmail.com" created="Fri, 14 Dec 2012 21:14:02 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Running org.apache.hadoop.hbase.security.token.TestTokenAuthentication
2012-12-14 13:10:12.964 java[81660:1903] Unable to load realm mapping info from SCDynamicStore
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.726 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now that TestTokenAuthentication passes so quickly, I wonder if it should be a large test:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 @Category(LargeTests.class)
 &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class TestTokenAuthentication {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13532674" author="yuzhihong@gmail.com" created="Fri, 14 Dec 2012 21:23:12 +0000"  >&lt;p&gt;Nice test.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; BlockingAuthenticationService
...
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; class TokenServer &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; TokenProvider
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;BlockingAuthenticationService and TokenServer are only used in TestTokenAuthentication. I think they can be private.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-comment&quot;&gt;// Creation of a HSA will force a resolve.
&lt;/span&gt;+      InetSocketAddress initialIsa = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InetSocketAddress(hostname, port);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;HSA&apos; -&amp;gt; InetSocketAddress or simply ISA.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-comment&quot;&gt;// ignore passed in controller -- it&apos;s always &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/span&gt;+      ServerRpcController serverController = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ServerRpcController();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Does the above mean similar logic needs to be used in non-test code ?&lt;/p&gt;</comment>
                            <comment id="13532738" author="hadoopqa" created="Fri, 14 Dec 2012 22:35:45 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561026/HBASE-6788_4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561026/HBASE-6788_4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool generates 5 additional warning messages with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 26 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are zombie tests. See build logs for details.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3550//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13532747" author="ghelmling" created="Fri, 14 Dec 2012 22:41:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;BlockingAuthenticationService and TokenServer are only used in TestTokenAuthentication. I think they can be private.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sure, I&apos;ll change.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&apos;HSA&apos; -&amp;gt; InetSocketAddress or simply ISA.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good catch, was a copy-n-pasted comment.  I&apos;ll fix.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Does the above mean similar logic needs to be used in non-test code ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is only required in the test code because we are exposing the TokenProvider coprocessor endpoint as a full fledged RPC server.  In the non-test endpoint implementation, this is already provided in HRegionServer.execService() and HRegion.execService().&lt;/p&gt;</comment>
                            <comment id="13532762" author="ghelmling" created="Fri, 14 Dec 2012 22:53:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;Now that TestTokenAuthentication passes so quickly, I wonder if it should be a large test:&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I could change to medium, but it does still stand up a MiniZooKeeperCluster, so in my mind it&apos;s still bigger than the small tests.&lt;/p&gt;</comment>
                            <comment id="13535554" author="ghelmling" created="Wed, 19 Dec 2012 02:00:12 +0000"  >&lt;p&gt;Updated patch rebased against current trunk.  This pulls in the &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7357&quot; title=&quot;HBaseClient and HBaseServer should use hbase.security.authentication when negotiating authentication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7357&quot;&gt;&lt;del&gt;HBASE-7357&lt;/del&gt;&lt;/a&gt; changes and makes TestTokenAuthentication work around the ZK SASL setup from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4791&quot; title=&quot;Allow Secure Zookeeper JAAS configuration to be programmatically set (rather than only by reading JAAS configuration file)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4791&quot;&gt;&lt;del&gt;HBASE-4791&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13535622" author="hadoopqa" created="Wed, 19 Dec 2012 04:02:06 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12561623/HBASE-6788_5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12561623/HBASE-6788_5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 28 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 release audit&lt;/font&gt;.  The applied patch generated 232 release audit warnings (more than the trunk&apos;s current 84 warnings).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are zombie tests. See build logs for details.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3603//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13536139" author="stack" created="Wed, 19 Dec 2012 17:09:56 +0000"  >&lt;p&gt;+1 on commit.&lt;/p&gt;</comment>
                            <comment id="13536434" author="ghelmling" created="Wed, 19 Dec 2012 21:28:27 +0000"  >&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6788&quot; title=&quot;Convert AuthenticationProtocol to protocol buffer service&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6788&quot;&gt;&lt;del&gt;HBASE-6788&lt;/del&gt;&lt;/a&gt;_5.patch committed to trunk.  Thanks all for the review.&lt;/p&gt;</comment>
                            <comment id="13536628" author="hudson" created="Thu, 20 Dec 2012 00:15:23 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3640 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3640/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3640/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6788&quot; title=&quot;Convert AuthenticationProtocol to protocol buffer service&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6788&quot;&gt;&lt;del&gt;HBASE-6788&lt;/del&gt;&lt;/a&gt;  Convert AuthenticationProtocol to protocol buffer service; ADDENDUM (Revision 1424146)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6788&quot; title=&quot;Convert AuthenticationProtocol to protocol buffer service&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6788&quot;&gt;&lt;del&gt;HBASE-6788&lt;/del&gt;&lt;/a&gt;  Convert AuthenticationProtocol to protocol buffer service (Revision 1424122)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
garyh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationProtocol.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;garyh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/AuthenticationProtos.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-protocol/src/main/protobuf/Authentication.proto&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/ServerRpcController.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenIdentifier.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSelector.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/TokenProvider.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/TokenUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/security/token/TestTokenAuthentication.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13536701" author="hudson" created="Thu, 20 Dec 2012 02:13:23 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #304 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/304/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/304/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6788&quot; title=&quot;Convert AuthenticationProtocol to protocol buffer service&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6788&quot;&gt;&lt;del&gt;HBASE-6788&lt;/del&gt;&lt;/a&gt;  Convert AuthenticationProtocol to protocol buffer service; ADDENDUM (Revision 1424146)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6788&quot; title=&quot;Convert AuthenticationProtocol to protocol buffer service&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6788&quot;&gt;&lt;del&gt;HBASE-6788&lt;/del&gt;&lt;/a&gt;  Convert AuthenticationProtocol to protocol buffer service (Revision 1424122)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
garyh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationProtocol.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;garyh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-protocol/src/main/java/org/apache/hadoop/hbase/protobuf/generated/AuthenticationProtos.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-protocol/src/main/protobuf/Authentication.proto&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/ServerRpcController.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/protobuf/ProtobufUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenIdentifier.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/AuthenticationTokenSelector.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/TokenProvider.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/token/TokenUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/security/token/TestTokenAuthentication.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13775052" author="stack" created="Mon, 23 Sep 2013 18:30:38 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12609561">HBASE-6895</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12624050">HBASE-7357</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12559778" name="HBASE-6788.patch" size="178809" author="ghelmling" created="Fri, 7 Dec 2012 00:56:02 +0000"/>
                            <attachment id="12560924" name="HBASE-6788_2.patch" size="194431" author="ghelmling" created="Fri, 14 Dec 2012 06:51:49 +0000"/>
                            <attachment id="12561007" name="HBASE-6788_3.patch" size="194625" author="ghelmling" created="Fri, 14 Dec 2012 18:30:26 +0000"/>
                            <attachment id="12561026" name="HBASE-6788_4.patch" size="195066" author="ghelmling" created="Fri, 14 Dec 2012 21:01:33 +0000"/>
                            <attachment id="12561623" name="HBASE-6788_5.patch" size="192865" author="ghelmling" created="Wed, 19 Dec 2012 02:00:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Sep 2012 21:05:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>242415</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02us7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14588</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>