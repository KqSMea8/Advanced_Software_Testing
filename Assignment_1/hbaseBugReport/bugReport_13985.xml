<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:48:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13985/HBASE-13985.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13985] Add configuration to skip validating HFile format when bulk loading</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13985</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When bulk loading millions of HFile into one HTable, checking HFile format is the most time-consuming phase. Maybe we could use a parallel mechanism to increase the speed, but when it comes to millions of HFiles, it may still cost dozens of minutes. So I think it&apos;s necessary to add an option for advanced user to bulkload without checking HFile format at all. &lt;br/&gt;
Of course, the default value of this option should be true.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12841229">HBASE-13985</key>
            <summary>Add configuration to skip validating HFile format when bulk loading</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="victorunique">Victor Xu</assignee>
                                    <reporter username="victorunique">Victor Xu</reporter>
                        <labels>
                            <label>regionserver</label>
                    </labels>
                <created>Mon, 29 Jun 2015 03:12:32 +0000</created>
                <updated>Thu, 13 Aug 2015 14:31:58 +0000</updated>
                            <resolved>Thu, 13 Aug 2015 02:04:09 +0000</resolved>
                                    <version>0.98.13</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>0.98.14</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="14605069" author="victorunique" created="Mon, 29 Jun 2015 03:13:50 +0000"  >&lt;p&gt;Add patch for this issue. Both master and 0.98 branches can apply it.&lt;/p&gt;</comment>
                            <comment id="14605101" author="yuzhihong@gmail.com" created="Mon, 29 Jun 2015 04:24:23 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
179	   * Skip reference, HFileLink, files starting with &lt;span class=&quot;code-quote&quot;&gt;&quot;_&quot;&lt;/span&gt; and non-valid hfiles.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The last part of the above comment should be revised to take new parameter into account.&lt;/p&gt;

&lt;p&gt;Do you know how much percentage hfile validation took for your workload ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="14605196" author="victorunique" created="Mon, 29 Jun 2015 06:30:00 +0000"  >&lt;p&gt;Thanks, Ted. I&apos;ll add a new patch.&lt;br/&gt;
I bulkloaded nearly 2 million hfiles into one HTable last Saturday, and I waited for more than 30 mins and it still block by validation of HFile format. So I added this configuration to skip this logic. Finally, the whole bulkload process completed in 15 mins.&lt;br/&gt;
A small test shows that HFile format validation speed could be 350/sec in single thread, so checking 3.5 million hfiles needs several hours. Even though multi-threads could speed up this process, I prefer to add a configuration to skip the whole logic completely.&lt;/p&gt;</comment>
                            <comment id="14605198" author="victorunique" created="Mon, 29 Jun 2015 06:30:12 +0000"  >&lt;p&gt;Thanks, Ted. I&apos;ll add a new patch.&lt;br/&gt;
I bulkloaded nearly 2 million hfiles into one HTable last Saturday, and I waited for more than 30 mins and it still block by validation of HFile format. So I added this configuration to skip this logic. Finally, the whole bulkload process completed in 15 mins.&lt;br/&gt;
A small test shows that HFile format validation speed could be 350/sec in single thread, so checking 3.5 million hfiles needs several hours. Even though multi-threads could speed up this process, I prefer to add a configuration to skip the whole logic completely.&lt;/p&gt;</comment>
                            <comment id="14605199" author="victorunique" created="Mon, 29 Jun 2015 06:30:12 +0000"  >&lt;p&gt;Thanks, Ted. I&apos;ll add a new patch.&lt;br/&gt;
I bulkloaded nearly 2 million hfiles into one HTable last Saturday, and I waited for more than 30 mins and it still block by validation of HFile format. So I added this configuration to skip this logic. Finally, the whole bulkload process completed in 15 mins.&lt;br/&gt;
A small test shows that HFile format validation speed could be 350/sec in single thread, so checking 3.5 million hfiles needs several hours. Even though multi-threads could speed up this process, I prefer to add a configuration to skip the whole logic completely.&lt;/p&gt;</comment>
                            <comment id="14605201" author="victorunique" created="Mon, 29 Jun 2015 06:40:55 +0000"  >&lt;p&gt;Change the comment for visitBulkHFiles().&lt;/p&gt;</comment>
                            <comment id="14605249" author="jmspaggi" created="Mon, 29 Jun 2015 08:08:35 +0000"  >&lt;p&gt;Can we print a warning when this parameter is used? Like:&lt;br/&gt;
&quot;You are skipping HFiles validation, it might cause this or that issue of files are not correct. If you fail to read data from your table after using this option, consider removing the files and push again without the option&quot;? &lt;/p&gt;

&lt;p&gt;It&apos;s just a very bad example, but just something to say it&apos;s dangerous?&lt;/p&gt;</comment>
                            <comment id="14606908" author="victorunique" created="Tue, 30 Jun 2015 03:12:42 +0000"  >&lt;p&gt;Thanks for your suggestion!&lt;/p&gt;</comment>
                            <comment id="14606916" author="victorunique" created="Tue, 30 Jun 2015 03:17:05 +0000"  >&lt;p&gt;Add warning log when using this option.&lt;/p&gt;</comment>
                            <comment id="14606917" author="jmspaggi" created="Tue, 30 Jun 2015 03:20:18 +0000"  >&lt;p&gt;Thanks for adding the warning. LGTM. We will need to online book to be updated to add the option too. Can be done in another JIRA I guess.&lt;/p&gt;</comment>
                            <comment id="14694527" author="apurtell" created="Thu, 13 Aug 2015 01:34:48 +0000"  >&lt;p&gt;Ok, committing shortly&lt;/p&gt;</comment>
                            <comment id="14694555" author="apurtell" created="Thu, 13 Aug 2015 02:04:09 +0000"  >&lt;p&gt;Pushed to 0.98, branch-1.2, branch-1, and master. Bulk load units pass on all branches.&lt;/p&gt;</comment>
                            <comment id="14694648" author="hudson" created="Thu, 13 Aug 2015 03:44:22 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6722 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6722/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6722/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13985&quot; title=&quot;Add configuration to skip validating HFile format when bulk loading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13985&quot;&gt;&lt;del&gt;HBASE-13985&lt;/del&gt;&lt;/a&gt; Add configuration to skip validating HFile format when bulk loading (Victor Xu) (apurtell: rev d7178aa27c55ae06cfbd6db94d6839311dfb4089)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14694762" author="hudson" created="Thu, 13 Aug 2015 06:06:22 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3 #106 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/106/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/106/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13985&quot; title=&quot;Add configuration to skip validating HFile format when bulk loading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13985&quot;&gt;&lt;del&gt;HBASE-13985&lt;/del&gt;&lt;/a&gt; Add configuration to skip validating HFile format when bulk loading (Victor Xu) (apurtell: rev ca19f961a25dce5359bfb9b35c0bbbd64ec0fb0b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14694805" author="hudson" created="Thu, 13 Aug 2015 06:52:25 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2-IT #88 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2-IT/88/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2-IT/88/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13985&quot; title=&quot;Add configuration to skip validating HFile format when bulk loading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13985&quot;&gt;&lt;del&gt;HBASE-13985&lt;/del&gt;&lt;/a&gt; Add configuration to skip validating HFile format when bulk loading (Victor Xu) (apurtell: rev 222102196f358667462dfbeeb8a63b6826ece397)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14694814" author="hudson" created="Thu, 13 Aug 2015 06:58:42 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #87 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/87/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/87/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13985&quot; title=&quot;Add configuration to skip validating HFile format when bulk loading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13985&quot;&gt;&lt;del&gt;HBASE-13985&lt;/del&gt;&lt;/a&gt; Add configuration to skip validating HFile format when bulk loading (Victor Xu) (apurtell: rev ca19f961a25dce5359bfb9b35c0bbbd64ec0fb0b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14694818" author="hudson" created="Thu, 13 Aug 2015 07:06:29 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #1032 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1032/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1032/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13985&quot; title=&quot;Add configuration to skip validating HFile format when bulk loading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13985&quot;&gt;&lt;del&gt;HBASE-13985&lt;/del&gt;&lt;/a&gt; Add configuration to skip validating HFile format when bulk loading (Victor Xu) (apurtell: rev 82866bd09c3d75d7ff556827920a93d360c65231)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14694821" author="hudson" created="Thu, 13 Aug 2015 07:06:35 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #1079 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/1079/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/1079/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13985&quot; title=&quot;Add configuration to skip validating HFile format when bulk loading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13985&quot;&gt;&lt;del&gt;HBASE-13985&lt;/del&gt;&lt;/a&gt; Add configuration to skip validating HFile format when bulk loading (Victor Xu) (apurtell: rev 82866bd09c3d75d7ff556827920a93d360c65231)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14694833" author="hudson" created="Thu, 13 Aug 2015 07:24:26 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.2 #106 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/106/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/106/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13985&quot; title=&quot;Add configuration to skip validating HFile format when bulk loading&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13985&quot;&gt;&lt;del&gt;HBASE-13985&lt;/del&gt;&lt;/a&gt; Add configuration to skip validating HFile format when bulk loading (Victor Xu) (apurtell: rev 222102196f358667462dfbeeb8a63b6826ece397)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12742459" name="HBASE-13985-v2.patch" size="3834" author="victorunique" created="Mon, 29 Jun 2015 06:40:55 +0000"/>
                            <attachment id="12742702" name="HBASE-13985-v3.patch" size="4177" author="victorunique" created="Tue, 30 Jun 2015 03:17:05 +0000"/>
                            <attachment id="12742442" name="HBASE-13985.patch" size="3714" author="victorunique" created="Mon, 29 Jun 2015 03:13:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 29 Jun 2015 04:24:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 18 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2glwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>A new config, hbase.loadincremental.validate.hfile , is introduced - default to true&lt;br/&gt;
When set to false, checking hfile format is skipped during bulkloading.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>