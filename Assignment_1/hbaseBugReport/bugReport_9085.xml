<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:01:14 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-9085/HBASE-9085.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-9085] Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-9085</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I was running the following test over a Distributed Cluster:&lt;br/&gt;
bin/hbase org.apache.hadoop.hbase.IntegrationTestsDriver IntegrationTestDataIngestSlowDeterministic&lt;/p&gt;

&lt;p&gt;The IntegrationTestingUtility.restoreCluster() is called in the teardown phase of the test.&lt;br/&gt;
For a distributed cluster, it ends up calling DistributedHBaseCluster.restoreClusterStatus, which does the task &lt;br/&gt;
of restoring the cluster back to original state.&lt;/p&gt;

&lt;p&gt;The restore steps done here, does not solve one specific case:&lt;br/&gt;
When the initial HBase Master is currently down, and the current HBase Master is different from the initial one.&lt;/p&gt;

&lt;p&gt;You get into this flow:&lt;/p&gt;

&lt;p&gt;    //check whether current master has changed&lt;br/&gt;
    if (!ServerName.isSameHostnameAndPort(initial.getMaster(), current.getMaster())) &lt;/p&gt;
{
	.............
    }

&lt;p&gt;In the above code path, the current backup masters are stopped, and the current active master is also stopped.&lt;br/&gt;
At this point, for the aforementioned usecase, none of the Hbase Masters would be available, hence the subsequent&lt;br/&gt;
attempts to do any operation over the cluster would fail, resulting in Test Failure.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12660623">HBASE-9085</key>
            <summary>Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gautam.soni">gautam</assignee>
                                    <reporter username="gautam.soni">gautam</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Jul 2013 09:49:27 +0000</created>
                <updated>Wed, 21 Aug 2013 00:08:50 +0000</updated>
                            <resolved>Fri, 2 Aug 2013 04:44:43 +0000</resolved>
                                    <version>0.95.0</version>
                    <version>0.94.9</version>
                    <version>0.94.10</version>
                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.95.2</fixVersion>
                    <fixVersion>0.94.11</fixVersion>
                                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13723644" author="gautam.soni" created="Tue, 30 Jul 2013 09:51:21 +0000"  >&lt;p&gt;I will put a git patch with the fix soon.&lt;/p&gt;</comment>
                            <comment id="13723727" author="gautam.soni" created="Tue, 30 Jul 2013 11:19:57 +0000"  >&lt;p&gt;Find the fix attached here. This will ensure we never get into a complete cluster shutdown, if initially marked active HBase Master is down before restore.&lt;/p&gt;</comment>
                            <comment id="13725892" author="enis" created="Thu, 1 Aug 2013 00:18:59 +0000"  >&lt;p&gt;Thanks for working on this. This area of the code base was not tested properly (there should be some comments saying so). It seems that your patch would fix the problem. Did you test it in your setup? If so I&apos;ll commit this one. &lt;/p&gt;</comment>
                            <comment id="13725938" author="gautam.soni" created="Thu, 1 Aug 2013 01:17:43 +0000"  >&lt;p&gt;Thanks Enis. Yes, I tested this on my setup. The restore worked properly in all cases. You can commit this.&lt;/p&gt;</comment>
                            <comment id="13727320" author="enis" created="Fri, 2 Aug 2013 04:44:43 +0000"  >&lt;p&gt;I&apos;ve committed this to 0.94,0.95 and trunk. Thanks for the patch gautam. &lt;/p&gt;</comment>
                            <comment id="13727388" author="hudson" created="Fri, 2 Aug 2013 06:11:53 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94-security #240 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/240/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/240/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9085&quot; title=&quot;Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9085&quot;&gt;&lt;del&gt;HBASE-9085&lt;/del&gt;&lt;/a&gt; Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly. (gautam) (enis: rev 1509540)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/DistributedHBaseCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13727434" author="hudson" created="Fri, 2 Aug 2013 07:02:10 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94 #1088 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1088/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1088/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9085&quot; title=&quot;Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9085&quot;&gt;&lt;del&gt;HBASE-9085&lt;/del&gt;&lt;/a&gt; Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly. (gautam) (enis: rev 1509540)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/DistributedHBaseCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13727454" author="hudson" created="Fri, 2 Aug 2013 07:34:29 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #4332 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4332/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4332/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9085&quot; title=&quot;Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9085&quot;&gt;&lt;del&gt;HBASE-9085&lt;/del&gt;&lt;/a&gt; Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly. (gautam) (enis: rev 1509538)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-it/src/test/java/org/apache/hadoop/hbase/DistributedHBaseCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13727467" author="hudson" created="Fri, 2 Aug 2013 08:03:50 +0000"  >&lt;p&gt;SUCCESS: Integrated in hbase-0.95 #395 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/395/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/395/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9085&quot; title=&quot;Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9085&quot;&gt;&lt;del&gt;HBASE-9085&lt;/del&gt;&lt;/a&gt; Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly. (gautam) (enis: rev 1509539)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-it/src/test/java/org/apache/hadoop/hbase/DistributedHBaseCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13727603" author="hudson" created="Fri, 2 Aug 2013 11:46:01 +0000"  >&lt;p&gt;SUCCESS: Integrated in hbase-0.95-on-hadoop2 #214 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95-on-hadoop2/214/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95-on-hadoop2/214/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9085&quot; title=&quot;Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9085&quot;&gt;&lt;del&gt;HBASE-9085&lt;/del&gt;&lt;/a&gt; Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly. (gautam) (enis: rev 1509539)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-it/src/test/java/org/apache/hadoop/hbase/DistributedHBaseCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13727644" author="hudson" created="Fri, 2 Aug 2013 12:48:15 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #648 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/648/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/648/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9085&quot; title=&quot;Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9085&quot;&gt;&lt;del&gt;HBASE-9085&lt;/del&gt;&lt;/a&gt; Integration Tests fails because of bug in teardown phase where the cluster state is not being restored properly. (gautam) (enis: rev 1509538)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-it/src/test/java/org/apache/hadoop/hbase/DistributedHBaseCluster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="12657209">HBASE-8928</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12594934" name="HBASE-9085.patch._0.94" size="2741" author="gautam.soni" created="Tue, 30 Jul 2013 11:19:57 +0000"/>
                            <attachment id="12594933" name="HBASE-9085.patch._0.95_or_trunk" size="2777" author="gautam.soni" created="Tue, 30 Jul 2013 11:19:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 1 Aug 2013 00:18:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>340813</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 20 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ms3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>341131</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>