<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:00:08 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2233/HBASE-2233.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2233] Support both Hadoop 0.20, 0.21, and 0.22</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2233</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Since Hadoop 0.21 isn&apos;t going to be well supported and that a lot of users may wish to stick on 0.20, the next HBase major release should support both 0.20 and 0.21. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-265&quot; title=&quot;Revisit append&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-265&quot;&gt;&lt;del&gt;HDFS-265&lt;/del&gt;&lt;/a&gt; support will be swapped for &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-200&quot; title=&quot;In HDFS, sync() not yet guarantees data available to the new readers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-200&quot;&gt;&lt;del&gt;HDFS-200&lt;/del&gt;&lt;/a&gt; if running on HDFS 0.20. A cluster without that patchset shouldn&apos;t be supported.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12456577">HBASE-2233</key>
            <summary>Support both Hadoop 0.20, 0.21, and 0.22</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Feb 2010 19:26:05 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:25 +0000</updated>
                            <resolved>Thu, 9 Jun 2011 21:31:18 +0000</resolved>
                                                    <fixVersion>0.92.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="12834951" author="kaykay.unique" created="Wed, 17 Feb 2010 19:31:25 +0000"  >&lt;p&gt;Unfortunate, but do not have an option. &lt;/p&gt;</comment>
                            <comment id="12834971" author="kaykay.unique" created="Wed, 17 Feb 2010 20:12:39 +0000"  >&lt;p&gt;so - at its current stage of HBase trunk - what are the patches suggested/ advisable for hdfs - 0.21 ? &lt;/p&gt;


&lt;p&gt;what would be the similar patches ( if applicable) for hadoop 0.20.x as well ? &lt;/p&gt;</comment>
                            <comment id="12834979" author="jdcryans" created="Wed, 17 Feb 2010 20:39:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;so - at its current stage of HBase trunk - what are the patches suggested/ advisable for hdfs - 0.21 ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;None that I know of.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;what would be the similar patches ( if applicable) for hadoop 0.20.x as well ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s not all done yet but there&apos;s &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-200&quot; title=&quot;In HDFS, sync() not yet guarantees data available to the new readers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-200&quot;&gt;&lt;del&gt;HDFS-200&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-142&quot; title=&quot;In 0.20, move blocks being written into a blocksBeingWritten directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-142&quot;&gt;&lt;del&gt;HDFS-142&lt;/del&gt;&lt;/a&gt; and one other that I don&apos;t remember. Dhruba said he will tag them &quot;hbase&quot;.&lt;/p&gt;</comment>
                            <comment id="12902207" author="jdcryans" created="Wed, 25 Aug 2010 00:33:38 +0000"  >&lt;p&gt;0.21.0 was released today, we need to decide if we support it in the scope of 0.90.&lt;/p&gt;</comment>
                            <comment id="12918189" author="streamy" created="Tue, 5 Oct 2010 21:06:32 +0000"  >&lt;p&gt;What&apos;s plan for this?&lt;/p&gt;</comment>
                            <comment id="12925935" author="stack" created="Thu, 28 Oct 2010 20:21:42 +0000"  >&lt;p&gt;Moving out&lt;/p&gt;</comment>
                            <comment id="13032234" author="stack" created="Thu, 12 May 2011 02:08:27 +0000"  >&lt;p&gt;This is what I did at the 0.22 hackathon today... There is more to do bringing us over to new append.   Asking Hairong about recovery of lease which is not in 0.22, if it makes sense to add it.   This code compiles but I need to check tests.&lt;/p&gt;

&lt;p&gt;It looks for hflush in the dfsclient outputstream.  If present, we&apos;ll call it on each sync invocation (we are not asking SequenceFile to do it as 0.20 does since there is no &apos;hflush&apos; in SequenceFile)&lt;/p&gt;</comment>
                            <comment id="13040362" author="stack" created="Fri, 27 May 2011 18:13:18 +0000"  >&lt;p&gt;Hack on pom so it works with hadoop trunk.&lt;/p&gt;</comment>
                            <comment id="13040515" author="stack" created="Sat, 28 May 2011 00:03:59 +0000"  >&lt;p&gt;Here is something that actually compiles against 0.22.  Doesn&apos;t work though yet.  I&apos;m working through the unit tests.  Has hackups to get around changes in hadoop API including switch to use hadoop&apos;s TOP if suitable one is available and removal from RPC of user passing since its Type changed across Hadoop versions (and Gary&apos;s security work does this stuff for us &amp;#8211; no need to do it here in plain-hbase).&lt;/p&gt;</comment>
                            <comment id="13040517" author="tlipcon" created="Sat, 28 May 2011 00:11:59 +0000"  >&lt;p&gt;Do any of the 0.22 incompatibilities seem like things that are Hadoop&apos;s fault? Or all cases where we&apos;ve used somewhat internal APIs like UGI?&lt;/p&gt;</comment>
                            <comment id="13040545" author="stack" created="Sat, 28 May 2011 03:59:51 +0000"  >&lt;p&gt;+ UGI in RPC ConnectionHeader and in some test code.&lt;br/&gt;
+ The hackary around the bringing of TotalOrderPartitioner local under hadoopbackport subpackage.  In particular the move of TaskAttemptContext from Class to Interface.&lt;br/&gt;
+ The HttpServer changes the signature on one of its add webapp methods so you now need to pass a Configuration&lt;br/&gt;
+ Some mess where we gave ourselves access to NameNode internals so we could set leases; add hackery to expose something that once was exposed.&lt;/p&gt;

&lt;p&gt;Considering we&apos;re jumping two versions, not too bad.&lt;/p&gt;

&lt;p&gt;Still may be more and I need to go over the patch again before its final.&lt;/p&gt;</comment>
                            <comment id="13040548" author="stack" created="Sat, 28 May 2011 04:56:32 +0000"  >&lt;p&gt;Hmm... some fs behaviors have changed.  You can&apos;t do a listing of a non-existent directory anymore.   Now it throws FileNotFoundException where before it just soldiered on.&lt;/p&gt;</comment>
                            <comment id="13041903" author="stack" created="Wed, 1 Jun 2011 00:11:06 +0000"  >&lt;p&gt;This patch gets pretty far in the tests.  Still running.  Need to make sure works w/ 0.20 hadoop next.&lt;/p&gt;</comment>
                            <comment id="13043151" author="stack" created="Fri, 3 Jun 2011 00:14:14 +0000"  >&lt;p&gt;Just TestReplication and TestHFileOutputFormat failing now; issues running mapreduce.&lt;/p&gt;</comment>
                            <comment id="13044139" author="stack" created="Fri, 3 Jun 2011 23:53:25 +0000"  >&lt;p&gt;All tests pass now building against 0.22 hadoop but with one kink. TestHFileOutputFormat fails by hanging BECAUSE our avro is 1.4.1 but the avro in hadoop 0.22 is 1.3.2; when this test runs IF YOU ENABLE MR DEBUG you&apos;ll see NoSuchMethodException thrown (Thanks to Todd for help in here).  I&apos;m tempted to cut avro from hbase core.&lt;/p&gt;

&lt;p&gt;I am now testing hbase up on cluster.&lt;/p&gt;

&lt;p&gt;Still to do is verify this patch passes all tests with hadoop 0.20 under it.&lt;/p&gt;</comment>
                            <comment id="13045180" author="jiraposter@reviews.apache.org" created="Mon, 6 Jun 2011 22:28:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/858/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Patch for HBASE TRUNK that makes it so we run on hadoop 0.20.x or hadoop 0.22 branch (as it is now).&lt;/p&gt;

&lt;p&gt;Needed hdfs-1948 and hadoop-7531 applied to hadoop 0.22 branch.  Because these issues are NOT in hadoop 0.21, hbase will not work against 0.21 hadoop, not w/o these patches and a rebuild.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2233&quot; title=&quot;Support both Hadoop 0.20, 0.21, and 0.22&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2233&quot;&gt;&lt;del&gt;HBASE-2233&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2233&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-2233&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/ipc/ConnectionHeader.java c2a7649 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/mapreduce/HFileOutputFormat.java 95407d1 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/mapreduce/hadoopbackport/InputSampler.java c3e0a68 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java b8489ac &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/ServerManager.java f735e41 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6404538 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java 0716788 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java db29e56 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/wal/SequenceFileLogWriter.java 8dc9a5e &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3409108 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/InfoServer.java 6ed9fe6 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java babd788 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/mapreduce/TestHFileOutputFormat.java f6a7210 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogSplit.java f1f4c6b &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java 5b487a9 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java c8fc065 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/858/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Ran this patch with hadoop 0.20 and hadoop 0.22 underneath hbase (I used the patch for the pom that is attached to the issue to switch to hadoop 0.22).  All unit tests seem to pass except TestHFileOutputFormat when up on hadoop 0.22; hadoop 0.22 uses avro 1.3.2 whereas hbase is up on avro 1.4.1.  The test fails with a method not found exception.  You need to enable mapreduce logging to see the exception.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Michael&lt;/p&gt;
</comment>
                            <comment id="13045182" author="stack" created="Mon, 6 Jun 2011 22:30:30 +0000"  >&lt;p&gt;Looking for a bit of a review before I commit (Patch is not too big &amp;#8211; just a little messy)&lt;/p&gt;</comment>
                            <comment id="13045191" author="jiraposter@reviews.apache.org" created="Mon, 6 Jun 2011 22:53:00 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/858/#review769&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/#review769&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;nice work &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; just some small comments.&lt;/p&gt;


&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/#comment1651&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/#comment1651&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    is this change related?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/#comment1652&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/#comment1652&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    also this&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/#comment1653&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/#comment1653&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    hrm, I dont understand this line&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/#comment1654&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/#comment1654&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    did our behavior here change? I think we used to return null, but I thought now we returned an empty list?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/#comment1655&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/#comment1655&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    same q here&lt;/p&gt;



&lt;p&gt;src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/#comment1656&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/#comment1656&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    CONFI?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Todd&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-06 22:27:56, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/858/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-06 22:27:56)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Patch for HBASE TRUNK that makes it so we run on hadoop 0.20.x or hadoop 0.22 branch (as it is now).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Needed hdfs-1948 and hadoop-7531 applied to hadoop 0.22 branch.  Because these issues are NOT in hadoop 0.21, hbase will not work against 0.21 hadoop, not w/o these patches and a rebuild.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2233&quot; title=&quot;Support both Hadoop 0.20, 0.21, and 0.22&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2233&quot;&gt;&lt;del&gt;HBASE-2233&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2233&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-2233&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ipc/ConnectionHeader.java c2a7649 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/HFileOutputFormat.java 95407d1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/hadoopbackport/InputSampler.java c3e0a68 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java b8489ac &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/ServerManager.java f735e41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6404538 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java 0716788 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java db29e56 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/SequenceFileLogWriter.java 8dc9a5e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3409108 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/InfoServer.java 6ed9fe6 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java babd788 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/mapreduce/TestHFileOutputFormat.java f6a7210 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogSplit.java f1f4c6b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java 5b487a9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java c8fc065 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/858/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Ran this patch with hadoop 0.20 and hadoop 0.22 underneath hbase (I used the patch for the pom that is attached to the issue to switch to hadoop 0.22).  All unit tests seem to pass except TestHFileOutputFormat when up on hadoop 0.22; hadoop 0.22 uses avro 1.3.2 whereas hbase is up on avro 1.4.1.  The test fails with a method not found exception.  You need to enable mapreduce logging to see the exception.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13045199" author="jiraposter@reviews.apache.org" created="Mon, 6 Jun 2011 23:08:59 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-06-06 22:51:07, Todd Lipcon wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/master/ServerManager.java, line 360&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/diff/1/?file=20611#file20611line360&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/diff/1/?file=20611#file20611line360&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     is this change related?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not related but needed.  I could do in separate issue.   Saw ugly NPE when stuff came up ugly when not patched properly.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-06-06 22:51:07, Todd Lipcon wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java, line 791&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/diff/1/?file=20613#file20613line791&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/diff/1/?file=20613#file20613line791&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     hrm, I dont understand this line&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good one.  Test should be inverted.  Fixing...&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-06-06 22:51:07, Todd Lipcon wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java, line 1343&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/diff/1/?file=20613#file20613line1343&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/diff/1/?file=20613#file20613line1343&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     did our behavior here change? I think we used to return null, but I thought now we returned an empty list?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;fs.listStatus changed in that if you pass it a dir that does not exist, before it would return empty list but no throws FileNotFoundException.&lt;/p&gt;

&lt;p&gt;Regards our behavior changing around the return out of this method, I don&apos;t think so.  I looked at 0.90 and it does this too:&lt;/p&gt;

&lt;p&gt;    if (files == null) return filesSorted;&lt;/p&gt;

&lt;p&gt;... returning empty NavigableSet if nothing found.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2011-06-06 22:51:07, Todd Lipcon wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java, line 127&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/858/diff/1/?file=20621#file20621line127&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/diff/1/?file=20621#file20621line127&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     CONFI?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah.  Takes variable named &apos;conf1&apos;.  I changed it to be less surprising CONF_WITH_LOCALFS&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Michael&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/858/#review769&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/#review769&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-06-06 22:27:56, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/858/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-06 22:27:56)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Patch for HBASE TRUNK that makes it so we run on hadoop 0.20.x or hadoop 0.22 branch (as it is now).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Needed hdfs-1948 and hadoop-7531 applied to hadoop 0.22 branch.  Because these issues are NOT in hadoop 0.21, hbase will not work against 0.21 hadoop, not w/o these patches and a rebuild.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2233&quot; title=&quot;Support both Hadoop 0.20, 0.21, and 0.22&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2233&quot;&gt;&lt;del&gt;HBASE-2233&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2233&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-2233&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ipc/ConnectionHeader.java c2a7649 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/HFileOutputFormat.java 95407d1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/hadoopbackport/InputSampler.java c3e0a68 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java b8489ac &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/ServerManager.java f735e41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6404538 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java 0716788 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java db29e56 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/SequenceFileLogWriter.java 8dc9a5e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3409108 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/InfoServer.java 6ed9fe6 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java babd788 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/mapreduce/TestHFileOutputFormat.java f6a7210 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogSplit.java f1f4c6b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java 5b487a9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java c8fc065 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/858/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Ran this patch with hadoop 0.20 and hadoop 0.22 underneath hbase (I used the patch for the pom that is attached to the issue to switch to hadoop 0.22).  All unit tests seem to pass except TestHFileOutputFormat when up on hadoop 0.22; hadoop 0.22 uses avro 1.3.2 whereas hbase is up on avro 1.4.1.  The test fails with a method not found exception.  You need to enable mapreduce logging to see the exception.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13045542" author="jiraposter@reviews.apache.org" created="Tue, 7 Jun 2011 17:10:59 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/858/#review776&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/#review776&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Ship it!&lt;/p&gt;


&lt;p&gt;sounds good, +1 after fixing that condition&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Todd&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-06-06 22:27:56, Michael Stack wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/858/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-06-06 22:27:56)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Patch for HBASE TRUNK that makes it so we run on hadoop 0.20.x or hadoop 0.22 branch (as it is now).&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Needed hdfs-1948 and hadoop-7531 applied to hadoop 0.22 branch.  Because these issues are NOT in hadoop 0.21, hbase will not work against 0.21 hadoop, not w/o these patches and a rebuild.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2233&quot; title=&quot;Support both Hadoop 0.20, 0.21, and 0.22&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2233&quot;&gt;&lt;del&gt;HBASE-2233&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2233&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-2233&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/ipc/ConnectionHeader.java c2a7649 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/HFileOutputFormat.java 95407d1 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/hadoopbackport/InputSampler.java c3e0a68 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java b8489ac &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/ServerManager.java f735e41 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 6404538 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java 0716788 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java db29e56 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/wal/SequenceFileLogWriter.java 8dc9a5e &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/FSUtils.java 3409108 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/main/java/org/apache/hadoop/hbase/util/InfoServer.java 6ed9fe6 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java babd788 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/mapreduce/TestHFileOutputFormat.java f6a7210 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestHLogSplit.java f1f4c6b &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java 5b487a9 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;src/test/java/org/apache/hadoop/hbase/util/TestFSUtils.java c8fc065 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/858/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/858/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Ran this patch with hadoop 0.20 and hadoop 0.22 underneath hbase (I used the patch for the pom that is attached to the issue to switch to hadoop 0.22).  All unit tests seem to pass except TestHFileOutputFormat when up on hadoop 0.22; hadoop 0.22 uses avro 1.3.2 whereas hbase is up on avro 1.4.1.  The test fails with a method not found exception.  You need to enable mapreduce logging to see the exception.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Michael&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13046828" author="stack" created="Thu, 9 Jun 2011 21:37:27 +0000"  >&lt;p&gt;OK.  Did a bit more testing first.  There may be some tests that need addressing if hadoop 0.22 is under hbase.  I think I got them all.  TestHSplitLog was the last one I was working on; it seemed to have failing unit tests but coming back to it, they pass now (TestHFileOutputFormat does not pass, not w/o reverting the avro version to that of hadoop 0.22).  Will create new issues for tests that fail against hadoop 0.22.  Committed to TRUNK&lt;/p&gt;

&lt;p&gt;Thanks for review Todd.&lt;/p&gt;

&lt;p&gt;As said above we do not work against hadoop 0.21, not w/o backport of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7351&quot; title=&quot;Regression: HttpServer#getWebAppsPath used to be protected so subclasses could supply alternate webapps path but it was made private by HADOOP-6461&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7351&quot;&gt;&lt;del&gt;HADOOP-7351&lt;/del&gt;&lt;/a&gt;  Regression: HttpServer#getWebAppsPath used to be protected so subclasses could supply alternate webapps path but it was made private by &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-6461&quot; title=&quot;webapps aren&amp;#39;t located correctly post-split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-6461&quot;&gt;&lt;del&gt;HADOOP-6461&lt;/del&gt;&lt;/a&gt;&quot; and &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-1948&quot; title=&quot;Forward port &amp;#39;hdfs-1520 lightweight namenode operation to trigger lease reccovery&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-1948&quot;&gt;&lt;del&gt;HDFS-1948&lt;/del&gt;&lt;/a&gt;  Forward port &apos;hdfs-1520 lightweight namenode operation to trigger lease recovery&apos;&quot;&lt;/p&gt;</comment>
                            <comment id="13050974" author="hudson" created="Fri, 17 Jun 2011 11:00:03 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #1976 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/1976/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/1976/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="15016970" author="lars_francke" created="Fri, 20 Nov 2015 12:41:25 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12480725" name="2233-v2.txt" size="29250" author="stack" created="Sat, 28 May 2011 00:03:59 +0000"/>
                            <attachment id="12481016" name="2233-v3.txt" size="36276" author="stack" created="Wed, 1 Jun 2011 00:11:06 +0000"/>
                            <attachment id="12481308" name="2233-v4.txt" size="43469" author="stack" created="Fri, 3 Jun 2011 00:14:14 +0000"/>
                            <attachment id="12481419" name="2233-v5.txt" size="45477" author="stack" created="Fri, 3 Jun 2011 23:53:25 +0000"/>
                            <attachment id="12478930" name="2233.txt" size="7375" author="stack" created="Thu, 12 May 2011 02:08:27 +0000"/>
                            <attachment id="12480679" name="pom.to.go.against.hadoop.trunk.txt" size="3931" author="stack" created="Fri, 27 May 2011 18:13:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 17 Feb 2010 19:31:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32471</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05i4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30034</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>HBase will run unadorned on hadoop 0.22 (HBase does not run on hadoop 0.21, not without forward port of recoverLease, &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-1948&quot; title=&quot;Forward port &amp;#39;hdfs-1520 lightweight namenode operation to trigger lease reccovery&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-1948&quot;&gt;&lt;strike&gt;HDFS-1948&lt;/strike&gt;&lt;/a&gt;, and change to httpserver, &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7351&quot; title=&quot;Regression: HttpServer#getWebAppsPath used to be protected so subclasses could supply alternate webapps path but it was made private by HADOOP-6461&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7351&quot;&gt;&lt;strike&gt;HADOOP-7351&lt;/strike&gt;&lt;/a&gt;)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>