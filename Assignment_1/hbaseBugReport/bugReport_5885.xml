<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:31:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5885/HBASE-5885.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5885] Invalid HFile block magic on Local file System</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5885</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;ERROR: java.lang.RuntimeException: org.apache.hadoop.hbase.client.RetriesExhaustedException: Failed after attempts=7, exceptions:&lt;br/&gt;
Thu Apr 26 11:19:18 PDT 2012, org.apache.hadoop.hbase.client.ScannerCallable@190a621a, java.io.IOException: java.io.IOException: Could not iterate StoreFileScanner[HFileScanner for reader reader=&lt;a href=&quot;file:/tmp/hbase-eclark/hbase/TestTable/e2d1c846363c75262cbfd85ea278b342/info/bae2681d63734066957b58fe791a0268&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/tmp/hbase-eclark/hbase/TestTable/e2d1c846363c75262cbfd85ea278b342/info/bae2681d63734066957b58fe791a0268&lt;/a&gt;, compression=none, cacheConf=CacheConfig:enabled &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheDataOnRead=true&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheDataOnWrite=false&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheIndexesOnWrite=false&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheBloomsOnWrite=false&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheEvictOnClose=false&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;cacheCompressed=false&amp;#93;&lt;/span&gt;, firstKey=0000000001/info:data/1335463981520/Put, lastKey=0002588100/info:data/1335463902296/Put, avgKeyLen=30, avgValueLen=1000, entries=1215085, length=1264354417, cur=0000000248/info:data/1335463994457/Put/vlen=1000/ts=0]&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.next(StoreFileScanner.java:135)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.KeyValueHeap.next(KeyValueHeap.java:95)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreScanner.next(StoreScanner.java:368)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.KeyValueHeap.next(KeyValueHeap.java:127)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion$RegionScannerImpl.nextInternal(HRegion.java:3323)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion$RegionScannerImpl.next(HRegion.java:3279)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion$RegionScannerImpl.next(HRegion.java:3296)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegionServer.next(HRegionServer.java:2393)&lt;br/&gt;
	at sun.reflect.GeneratedMethodAccessor15.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.WritableRpcEngine$Server.call(WritableRpcEngine.java:364)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1376)&lt;br/&gt;
Caused by: java.io.IOException: Invalid HFile block magic: \xEC\xD5\x9D\xB4\xC2bfo&lt;br/&gt;
	at org.apache.hadoop.hbase.io.hfile.BlockType.parse(BlockType.java:153)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.hfile.BlockType.read(BlockType.java:164)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.hfile.HFileBlock.&amp;lt;init&amp;gt;(HFileBlock.java:254)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.hfile.HFileBlock$FSReaderV2.readBlockDataInternal(HFileBlock.java:1779)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.hfile.HFileBlock$FSReaderV2.readBlockData(HFileBlock.java:1637)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.hfile.HFileReaderV2.readBlock(HFileReaderV2.java:327)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.hfile.HFileReaderV2$AbstractScannerV2.readNextDataBlock(HFileReaderV2.java:555)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.hfile.HFileReaderV2$ScannerV2.next(HFileReaderV2.java:651)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.next(StoreFileScanner.java:130)&lt;br/&gt;
	... 12 more&lt;/p&gt;

&lt;p&gt;Thu Apr 26 11:19:19 PDT 2012, org.apache.hadoop.hbase.client.ScannerCallable@190a621a, java.io.IOException: java.io.IOException: java.lang.IllegalArgumentException&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegionServer.convertThrowableToIOE(HRegionServer.java:1132)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegionServer.convertThrowableToIOE(HRegionServer.java:1121)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegionServer.next(HRegionServer.java:2420)&lt;br/&gt;
	at sun.reflect.GeneratedMethodAccessor15.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.WritableRpcEngine$Server.call(WritableRpcEngine.java:364)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1376)&lt;br/&gt;
Caused by: java.lang.IllegalArgumentException&lt;br/&gt;
	at java.nio.Buffer.position(Buffer.java:216)&lt;br/&gt;
	at org.apache.hadoop.hbase.io.hfile.HFileReaderV2$ScannerV2.next(HFileReaderV2.java:630)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.next(StoreFileScanner.java:130)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.KeyValueHeap.next(KeyValueHeap.java:95)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreScanner.next(StoreScanner.java:406)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.KeyValueHeap.next(KeyValueHeap.java:127)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion$RegionScannerImpl.nextInternal(HRegion.java:3323)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion$RegionScannerImpl.next(HRegion.java:3279)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion$RegionScannerImpl.next(HRegion.java:3296)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegionServer.next(HRegionServer.java:2393)&lt;br/&gt;
	... 5 more&lt;/p&gt;



&lt;p&gt;On latest 0.94 branch I spun up a new standalone hbase.  Then I started a performance evaluation run hbase/bin/hbase org.apache.hadoop.hbase.PerformanceEvaluation --nomapred randomWrite 10&lt;br/&gt;
after that completed I tried a scan of TestTable.  The scan got the above error.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12552887">HBASE-5885</key>
            <summary>Invalid HFile block magic on Local file System</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eclark">Elliott Clark</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Apr 2012 18:26:24 +0000</created>
                <updated>Wed, 18 Sep 2013 22:11:41 +0000</updated>
                            <resolved>Sat, 28 Apr 2012 04:04:38 +0000</resolved>
                                    <version>0.94.0</version>
                    <version>0.95.2</version>
                                    <fixVersion>0.94.0</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13262828" author="eclark" created="Thu, 26 Apr 2012 18:27:59 +0000"  >&lt;p&gt;Forgot to add that I also tried this with and without &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5864&quot; title=&quot;Error while reading from hfile in 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5864&quot;&gt;&lt;del&gt;HBASE-5864&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13262837" author="stack" created="Thu, 26 Apr 2012 18:38:11 +0000"  >&lt;p&gt;What if you disable this setting?   Does it still fail?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  /** 
+   * If &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; parameter is set to &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, then hbase will read
+   * data and then verify checksums. Checksum verification 
+   * inside hdfs will be switched off.  However, &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the hbase-checksum 
+   * verification fails, then it will &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; back to using
+   * hdfs checksums &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; verifiying data that is being read from storage.
+   *
+   * If &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; parameter is set to &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, then hbase will not
+   * verify any checksums, instead it will depend on checksum verification
+   * being done in the hdfs client.
+   */
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; HBASE_CHECKSUM_VERIFICATION = 
+      &lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.regionserver.checksum.verify&quot;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13262880" author="eclark" created="Thu, 26 Apr 2012 18:57:53 +0000"  >&lt;p&gt;I don&apos;t get an exception when that is set to false.&lt;/p&gt;</comment>
                            <comment id="13263206" author="lhofhansl" created="Thu, 26 Apr 2012 22:33:44 +0000"  >&lt;p&gt;So specifically this only happens in local mode (where HBase writes directly to the local file system)? If so, can we disable this feature in local mode (where it is pointless anyway)&lt;/p&gt;</comment>
                            <comment id="13263286" author="lhofhansl" created="Fri, 27 Apr 2012 01:03:22 +0000"  >&lt;p&gt;Are you working on this Elliot?&lt;/p&gt;</comment>
                            <comment id="13263288" author="eclark" created="Fri, 27 Apr 2012 01:18:09 +0000"  >&lt;p&gt;Stack and I were looking into this; I&apos;ll pick it back up first thing tomorrow morning.  Brain dump below so that I remember it all in the morning.&lt;/p&gt;

&lt;p&gt;Running a standalone instance with hbase.regionserver.checksum.verify to true will see an error when trying to read.&lt;br/&gt;
Running a standalone instance on the same data with hbase.regionserver.checksum.verify set to false will not see this error and all data looks intact.&lt;/p&gt;

&lt;p&gt;The first read through an HFileReader seems to be fine no matter what.  It&apos;s the second read that seems to be erroring out. &lt;/p&gt;

&lt;p&gt;Looking at data files they all start with &apos;DATABLK*&apos; and there are several of those headers in the files. So data too much data is being written per block, or not enough is being read.&lt;/p&gt;</comment>
                            <comment id="13263751" author="stack" created="Fri, 27 Apr 2012 15:46:20 +0000"  >&lt;p&gt;With one region with one file only in it, I run into the issue.  I can read the file outside of hbase using HFile tool fine.  When I scan, the problem happens at a random seeming point each time; i.e. run it once and its at key 162, run it again its at key 246, etc.  There does not seem to be correlation with index boundaries if I dump them out with:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
pynchon:0.94 stack$ ./bin/hbase org.apache.hadoop.hbase.io.hfile.HFile -m -s -b -f /tmp/hbase-stack/hbase/TestTable/75c7e8e6612fdf1fa308f9a34104e847/info/2830d6bcf8e34767af9baaf94228559a 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13263768" author="lhofhansl" created="Fri, 27 Apr 2012 16:24:23 +0000"  >&lt;p&gt;Scary. Just to confirm, you still only see this in local mode &lt;b&gt;and&lt;/b&gt; with HBase checksums enabled, right?&lt;/p&gt;</comment>
                            <comment id="13264050" author="eclark" created="Fri, 27 Apr 2012 22:34:51 +0000"  >&lt;p&gt;94 patch.&lt;/p&gt;</comment>
                            <comment id="13264051" author="eclark" created="Fri, 27 Apr 2012 22:37:03 +0000"  >&lt;p&gt;Trunk patch.&lt;br/&gt;
org.apache.hadoop.LocalFileSystem&apos;s seek does not work as expected when setVerifyChecksum is set to false.&lt;/p&gt;

&lt;p&gt;This patch means that on the local machine all reads will use the underlying checksum.&lt;/p&gt;</comment>
                            <comment id="13264103" author="lhofhansl" created="Fri, 27 Apr 2012 23:27:27 +0000"  >&lt;p&gt;Do you envision this as the final fix, or as a tempory solutions for now?&lt;br/&gt;
Might still be nice to know what exactly causes this for the local fs.&lt;/p&gt;</comment>
                            <comment id="13264105" author="lhofhansl" created="Fri, 27 Apr 2012 23:28:01 +0000"  >&lt;p&gt;+1 on patch&lt;/p&gt;</comment>
                            <comment id="13264114" author="stack" created="Fri, 27 Apr 2012 23:37:34 +0000"  >&lt;p&gt;+1 on patch.&lt;/p&gt;</comment>
                            <comment id="13264121" author="eclark" created="Fri, 27 Apr 2012 23:47:26 +0000"  >&lt;p&gt;I would see this as the final solution.  Anything else would either be much bigger and more invasive or would rely on hadoop changes which is unlikely.&lt;br/&gt;
Inside local FS they seek to the next boundary of checksums.  However when not reading checksums it gives the wrong data when a read is issued.&lt;/p&gt;</comment>
                            <comment id="13264132" author="lhofhansl" created="Sat, 28 Apr 2012 00:01:13 +0000"  >&lt;p&gt;@Elliot: fair enough &lt;/p&gt;

</comment>
                            <comment id="13264134" author="hadoopqa" created="Sat, 28 Apr 2012 00:02:24 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12524942/HBASE-5885-trunk-0.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12524942/HBASE-5885-trunk-0.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.TestReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestChecksum&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestForceCacheImportantBlocks&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1675//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1675//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1675//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1675//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1675//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1675//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13264148" author="eclark" created="Sat, 28 Apr 2012 00:18:11 +0000"  >&lt;p&gt;94 missed a couple asserts&lt;/p&gt;</comment>
                            <comment id="13264149" author="eclark" created="Sat, 28 Apr 2012 00:18:25 +0000"  >&lt;p&gt;trunk&lt;/p&gt;</comment>
                            <comment id="13264150" author="eclark" created="Sat, 28 Apr 2012 00:19:47 +0000"  >&lt;p&gt;Missed a couple of asserts.  This should fix the TestChecksum test.  TestForceCacheImportantBlocks passes for me and TestReplication doesn&apos;t run for me.&lt;/p&gt;

&lt;p&gt;I&apos;ve got to run to catch a plane but I&apos;ll try and check on this later.&lt;/p&gt;</comment>
                            <comment id="13264176" author="hadoopqa" created="Sat, 28 Apr 2012 01:01:57 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12524953/HBASE-5885-trunk-1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12524953/HBASE-5885-trunk-1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1677//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1677//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13264178" author="tlipcon" created="Sat, 28 Apr 2012 01:04:57 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I would see this as the final solution. Anything else would either be much bigger and more invasive or would rely on hadoop changes which is unlikely.&lt;br/&gt;
Inside local FS they seek to the next boundary of checksums. However when not reading checksums it gives the wrong data when a read is issued.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Please file an upstream bug in the hadoop project for this as well - we should absolutely fix this. I agree a workaround in the near term makes sense, but if LocalFileSystem is broken, we should fix it!&lt;/p&gt;</comment>
                            <comment id="13264197" author="yuzhihong@gmail.com" created="Sat, 28 Apr 2012 01:56:16 +0000"  >&lt;p&gt;Wrong patch was attached as trunk-1.&lt;/p&gt;

&lt;p&gt;Re-attaching patch for trunk.&lt;/p&gt;</comment>
                            <comment id="13264201" author="hadoopqa" created="Sat, 28 Apr 2012 02:48:22 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12524960/5885-trunk-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12524960/5885-trunk-v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1678//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1678//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1678//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1678//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1678//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1678//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13264208" author="stack" created="Sat, 28 Apr 2012 04:04:38 +0000"  >&lt;p&gt;Committed 0.94 and trunk.  Thanks for the patch Elliott (See Todd&apos;s comment above &amp;#8211; add an old hadoop issue when you get a chance)&lt;/p&gt;</comment>
                            <comment id="13264226" author="hudson" created="Sat, 28 Apr 2012 05:40:07 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #153 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/153/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/153/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5885&quot; title=&quot;Invalid HFile block magic on Local file System&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5885&quot;&gt;&lt;del&gt;HBASE-5885&lt;/del&gt;&lt;/a&gt;  Invalid HFile block magic on Local file System (Revision 1331676)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/fs/HFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestChecksum.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13264229" author="hudson" created="Sat, 28 Apr 2012 06:16:30 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2823 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2823/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2823/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5885&quot; title=&quot;Invalid HFile block magic on Local file System&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5885&quot;&gt;&lt;del&gt;HBASE-5885&lt;/del&gt;&lt;/a&gt;  Invalid HFile block magic on Local file System (Revision 1331675)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/fs/HFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestChecksum.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13264240" author="hudson" created="Sat, 28 Apr 2012 07:17:23 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #187 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/187/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/187/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5885&quot; title=&quot;Invalid HFile block magic on Local file System&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5885&quot;&gt;&lt;del&gt;HBASE-5885&lt;/del&gt;&lt;/a&gt;  Invalid HFile block magic on Local file System (Revision 1331675)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/fs/HFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestChecksum.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13264421" author="hudson" created="Sat, 28 Apr 2012 22:24:39 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #24 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/24/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/24/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5885&quot; title=&quot;Invalid HFile block magic on Local file System&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5885&quot;&gt;&lt;del&gt;HBASE-5885&lt;/del&gt;&lt;/a&gt;  Invalid HFile block magic on Local file System (Revision 1331676)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/fs/HFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestChecksum.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13264441" author="zhihyu@ebaysf.com" created="Sun, 29 Apr 2012 00:24:05 +0000"  >&lt;p&gt;Now that &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5611&quot; title=&quot;Replayed edits from regions that failed to open during recovery aren&amp;#39;t removed from the global MemStore size&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5611&quot;&gt;&lt;del&gt;HBASE-5611&lt;/del&gt;&lt;/a&gt; was taken out of 0.94, yet we still see the following test failure:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
https:&lt;span class=&quot;code-comment&quot;&gt;//builds.apache.org/view/G-L/view/HBase/job/HBase-0.94/159/testReport/org.apache.hadoop.hbase.io.encoding/TestChangingEncoding/testFlippingEncodeOnDisk/&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I start to think that this JIRA is related to the failure above.&lt;/p&gt;</comment>
                            <comment id="13264448" author="lhofhansl" created="Sun, 29 Apr 2012 02:14:28 +0000"  >&lt;p&gt;I don&apos;t see that failures in earlier test runs that include this patch.&lt;/p&gt;</comment>
                            <comment id="13264452" author="zhihyu@ebaysf.com" created="Sun, 29 Apr 2012 03:06:26 +0000"  >&lt;p&gt;Here is another one:&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/157/testReport/org.apache.hadoop.hbase.io.encoding/TestChangingEncoding/testFlippingEncodeOnDisk/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/157/testReport/org.apache.hadoop.hbase.io.encoding/TestChangingEncoding/testFlippingEncodeOnDisk/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13265068" author="stack" created="Mon, 30 Apr 2012 18:09:17 +0000"  >&lt;p&gt;I don&apos;t think the TestChangingEncoding is related to this change.  It enables verification of checksum in local filesystem.  The TestChangingEncoding doesn&apos;t even use local filesystem.  I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5906&quot; title=&quot;TestChangingEncoding failing sporadically in 0.94 build&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5906&quot;&gt;&lt;del&gt;HBASE-5906&lt;/del&gt;&lt;/a&gt; to look into the TestChangingEncoding fails.&lt;/p&gt;</comment>
                            <comment id="13266352" author="lhofhansl" created="Wed, 2 May 2012 05:12:02 +0000"  >&lt;p&gt;Did anybody file an upstream hadoop bug, yet? If not, I&apos;ll do so.&lt;/p&gt;</comment>
                            <comment id="13266383" author="tlipcon" created="Wed, 2 May 2012 06:27:42 +0000"  >&lt;p&gt;Elliott filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8336&quot; title=&quot;LocalFileSystem Does not seek to the correct location when Checksumming is off.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8336&quot;&gt;&lt;del&gt;HADOOP-8336&lt;/del&gt;&lt;/a&gt; but I can&apos;t seem to reproduce it there. Will comment there momentarily.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12603518">HBASE-6586</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12524960" name="5885-trunk-v2.txt" size="2224" author="yuzhihong@gmail.com" created="Sat, 28 Apr 2012 01:56:16 +0000"/>
                            <attachment id="12524941" name="HBASE-5885-94-0.patch" size="1417" author="eclark" created="Fri, 27 Apr 2012 22:34:51 +0000"/>
                            <attachment id="12524952" name="HBASE-5885-94-1.patch" size="2375" author="eclark" created="Sat, 28 Apr 2012 00:18:11 +0000"/>
                            <attachment id="12524942" name="HBASE-5885-trunk-0.patch" size="1417" author="eclark" created="Fri, 27 Apr 2012 22:37:03 +0000"/>
                            <attachment id="12524953" name="HBASE-5885-trunk-1.patch" size="710" author="eclark" created="Sat, 28 Apr 2012 00:18:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 26 Apr 2012 18:38:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236695</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 33 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i068nr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34334</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>