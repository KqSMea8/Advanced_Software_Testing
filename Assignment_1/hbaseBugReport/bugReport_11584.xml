<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:24:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11584/HBASE-11584.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11584] HBase file encryption, consistences observed and data loss</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11584</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;HBase file encryption some consistences observed and data loss happens after running the hbck tool,&lt;br/&gt;
the operation steps are as below.&lt;/p&gt;

&lt;p&gt;Procedure:&lt;br/&gt;
1. Start the Hbase services (HMaster &amp;amp; region Server)&lt;br/&gt;
2. Enable HFile encryption and WAL file encryption as below, and perform &apos;table4-0&apos; put operations (100 records added)&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.crypto.keyprovider&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;org.apache.hadoop.hbase.io.crypto.KeyStoreKeyProvider&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.crypto.keyprovider.parameters&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;jceks:///opt/shankar1/kdc_keytab/hbase.jks?password=Hadoop@234&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.crypto.master.key.name&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;hdfs&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hfile.format.version&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;3&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.regionserver.hlog.reader.impl&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;org.apache.hadoop.hbase.regionserver.wal.SecureProtobufLogReader&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.regionserver.hlog.writer.impl&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;org.apache.hadoop.hbase.regionserver.wal.SecureProtobufLogWriter&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.regionserver.wal.encryption&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;3. Machine went down, so all process went down&lt;br/&gt;
4. We disabled the WAL file encryption for performance reason, and keep encryption only for Hfile, as below&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.crypto.keyprovider&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;org.apache.hadoop.hbase.io.crypto.KeyStoreKeyProvider&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.crypto.keyprovider.parameters&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;jceks:///opt/shankar1/kdc_keytab/hbase.jks?password=Hadoop@234&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.crypto.master.key.name&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;hdfs&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hfile.format.version&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;3&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;5. Start the Region Server and query the &apos;table4-0&apos; data&lt;br/&gt;
hbase(main):003:0&amp;gt; count &apos;table4-0&apos;&lt;br/&gt;
ERROR: org.apache.hadoop.hbase.NotServingRegionException: Region table4-0,,1406207815456.fc10620a3dcc14e004ab034420f7d332. is not online on XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegionByEncodedName(HRegionServer.java:2685)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:4119)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.scan(HRegionServer.java:3066)&lt;br/&gt;
        at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:29497)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2084)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:98)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler.consumerLoop(SimpleRpcScheduler.java:168)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler.access$000(SimpleRpcScheduler.java:39)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler$1.run(SimpleRpcScheduler.java:111)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;

&lt;p&gt;6. Not able to read the data, so we decided to revert back the configuration (as original)&lt;/p&gt;

&lt;p&gt;7. Kill/Stop the Region Server, revert all the configurations as original, as below&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.crypto.keyprovider&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;org.apache.hadoop.hbase.io.crypto.KeyStoreKeyProvider&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.crypto.keyprovider.parameters&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;jceks:///opt/shankar1/kdc_keytab/hbase.jks?password=Hadoop@234&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.crypto.master.key.name&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;hdfs&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hfile.format.version&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;3&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.regionserver.hlog.reader.impl&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;org.apache.hadoop.hbase.regionserver.wal.SecureProtobufLogReader&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.regionserver.hlog.writer.impl&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;org.apache.hadoop.hbase.regionserver.wal.SecureProtobufLogWriter&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;property&amp;gt;&lt;br/&gt;
 &amp;lt;name&amp;gt;hbase.regionserver.wal.encryption&amp;lt;/name&amp;gt;&lt;br/&gt;
 &amp;lt;value&amp;gt;true&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;7. Start the Region Server, and perform the &apos;table4-0&apos; query &lt;br/&gt;
hbase(main):003:0&amp;gt; count &apos;table4-0&apos;&lt;br/&gt;
ERROR: org.apache.hadoop.hbase.NotServingRegionException: Region table4-0,,1406207815456.fc10620a3dcc14e004ab034420f7d332. is not online on XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegionByEncodedName(HRegionServer.java:2685)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegion(HRegionServer.java:4119)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.scan(HRegionServer.java:3066)&lt;br/&gt;
        at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:29497)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2084)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:98)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler.consumerLoop(SimpleRpcScheduler.java:168)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler.access$000(SimpleRpcScheduler.java:39)&lt;br/&gt;
        at org.apache.hadoop.hbase.ipc.SimpleRpcScheduler$1.run(SimpleRpcScheduler.java:111)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;

&lt;p&gt;8. Run the hbase hbck to repair, as below&lt;br/&gt;
./hbase hbck -details&lt;br/&gt;
.........................&lt;br/&gt;
Summary:&lt;br/&gt;
  table1-0 is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  table2-0 is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  table3-0 is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  table4-0 is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  table5-0 is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  table6-0 is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  table7-0 is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  table8-0 is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  table9-0 is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  hbase:meta is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  hbase:acl is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
  hbase:namespace is okay.&lt;br/&gt;
    Number of regions: 0&lt;br/&gt;
    Deployed on:&lt;br/&gt;
22 inconsistencies detected.&lt;br/&gt;
Status: INCONSISTENT&lt;br/&gt;
2014-07-24 19:13:05,532 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; client.HConnectionManager$HConnectionImplementation: Closing master protocol: MasterService&lt;br/&gt;
2014-07-24 19:13:05,533 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; client.HConnectionManager$HConnectionImplementation: Closing zookeeper sessionid=0x1475d1611611bcf&lt;br/&gt;
2014-07-24 19:13:05,533 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ZooKeeper: Closing session: 0x1475d1611611bcf&lt;br/&gt;
2014-07-24 19:13:05,533 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: Closing client for session: 0x1475d1611611bcf&lt;br/&gt;
2014-07-24 19:13:05,546 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread(XX-XX-XX-XX:2181)&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: Reading reply sessionid:0x1475d1611611bcf, packet:: clientPath:null serverPath:null finished:false header:: 6,-11  replyHeader:: 6,4295102074,0  request:: null response:: null&lt;br/&gt;
2014-07-24 19:13:05,546 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: Disconnecting client for session: 0x1475d1611611bcf&lt;br/&gt;
2014-07-24 19:13:05,546 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread(XX-XX-XX-XX:2181)&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: An exception was thrown while closing send thread for session 0x1475d1611611bcf : Unable to read additional data from server sessionid 0x1475d1611611bcf, likely server has closed socket&lt;br/&gt;
2014-07-24 19:13:05,546 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main-EventThread&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: EventThread shut down&lt;br/&gt;
2014-07-24 19:13:05,546 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ZooKeeper: Session: 0x1475d1611611bcf closed&lt;br/&gt;
shankar1@XX-XX-XX-XX:~/DataSight/hbase/bin&amp;gt;&lt;/p&gt;


&lt;p&gt;9. Fix the assignments as below&lt;br/&gt;
./hbase hbck -fixAssignments&lt;br/&gt;
Summary:&lt;br/&gt;
  table1-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table2-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table3-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table4-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table5-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table6-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table7-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table8-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table9-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  hbase:meta is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  hbase:acl is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  hbase:namespace is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
0 inconsistencies detected.&lt;br/&gt;
Status: OK&lt;br/&gt;
2014-07-24 19:44:55,194 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; client.HConnectionManager$HConnectionImplementation: Closing master protocol: MasterService&lt;br/&gt;
2014-07-24 19:44:55,194 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; client.HConnectionManager$HConnectionImplementation: Closing zookeeper sessionid=0x2475d15f7b31b73&lt;br/&gt;
2014-07-24 19:44:55,194 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ZooKeeper: Closing session: 0x2475d15f7b31b73&lt;br/&gt;
2014-07-24 19:44:55,194 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: Closing client for session: 0x2475d15f7b31b73&lt;br/&gt;
2014-07-24 19:44:55,203 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread(XX-XX-XX-XX:2181)&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: Reading reply sessionid:0x2475d15f7b31b73, packet:: clientPath:null serverPath:null finished:false header:: 7,-11  replyHeader:: 7,4295102377,0  request:: null response:: null&lt;br/&gt;
2014-07-24 19:44:55,203 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: Disconnecting client for session: 0x2475d15f7b31b73&lt;br/&gt;
2014-07-24 19:44:55,204 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread(XX-XX-XX-XX:2181)&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: An exception was thrown while closing send thread for session 0x2475d15f7b31b73 : Unable to read additional data from server sessionid 0x2475d15f7b31b73, likely server has closed socket&lt;br/&gt;
2014-07-24 19:44:55,204 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ZooKeeper: Session: 0x2475d15f7b31b73 closed&lt;br/&gt;
2014-07-24 19:44:55,204 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main-EventThread&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: EventThread shut down&lt;/p&gt;

&lt;p&gt;10. Fix the assignments as below&lt;br/&gt;
./hbase hbck -fixAssignments -fixMeta&lt;br/&gt;
Summary:&lt;br/&gt;
  table1-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table2-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table3-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table4-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table5-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table6-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table7-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table8-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  table9-0 is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  hbase:meta is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  hbase:acl is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
  hbase:namespace is okay.&lt;br/&gt;
    Number of regions: 1&lt;br/&gt;
    Deployed on:  XX-XX-XX-XX,60020,1406209023146&lt;br/&gt;
0 inconsistencies detected.&lt;br/&gt;
Status: OK&lt;br/&gt;
2014-07-24 19:46:16,290 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; client.HConnectionManager$HConnectionImplementation: Closing master protocol: MasterService&lt;br/&gt;
2014-07-24 19:46:16,290 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; client.HConnectionManager$HConnectionImplementation: Closing zookeeper sessionid=0x3475d1605321be9&lt;br/&gt;
2014-07-24 19:46:16,290 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ZooKeeper: Closing session: 0x3475d1605321be9&lt;br/&gt;
2014-07-24 19:46:16,290 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: Closing client for session: 0x3475d1605321be9&lt;br/&gt;
2014-07-24 19:46:16,300 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread(XX-XX-XX-XX:2181)&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: Reading reply sessionid:0x3475d1605321be9, packet:: clientPath:null serverPath:null finished:false header:: 6,-11  replyHeader:: 6,4295102397,0  request:: null response:: null&lt;br/&gt;
2014-07-24 19:46:16,300 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: Disconnecting client for session: 0x3475d1605321be9&lt;br/&gt;
2014-07-24 19:46:16,300 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread(XX-XX-XX-XX:2181)&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: An exception was thrown while closing send thread for session 0x3475d1605321be9 : Unable to read additional data from server sessionid 0x3475d1605321be9, likely server has closed socket&lt;br/&gt;
2014-07-24 19:46:16,300 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; zookeeper.ZooKeeper: Session: 0x3475d1605321be9 closed&lt;br/&gt;
2014-07-24 19:46:16,300 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main-EventThread&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn: EventThread shut down&lt;/p&gt;

&lt;p&gt;hbase(main):006:0&amp;gt; count &apos;table4-0&apos;&lt;br/&gt;
0 row(s) in 0.0200 seconds&lt;/p&gt;

&lt;p&gt;=&amp;gt; 0&lt;br/&gt;
hbase(main):007:0&amp;gt; &lt;/p&gt;

&lt;p&gt;Complete data loss happened,&lt;/p&gt;

&lt;p&gt;WALs, oldWALs &amp;amp; /hbase/data/default/table4-0/ does not have any data&lt;/p&gt;</description>
                <environment>&lt;p&gt;SuSE 11 SP3&lt;/p&gt;</environment>
        <key id="12729472">HBASE-11584</key>
            <summary>HBase file encryption, consistences observed and data loss</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shankarlingayya">shankarlingayya</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Jul 2014 14:39:22 +0000</created>
                <updated>Thu, 24 Jul 2014 19:14:50 +0000</updated>
                            <resolved>Thu, 24 Jul 2014 19:14:50 +0000</resolved>
                                    <version>0.98.3</version>
                                                    <component>hbck</component>
                    <component>HFile</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="14073303" author="anoop.hbase" created="Thu, 24 Jul 2014 15:42:42 +0000"  >&lt;p&gt;In Step#4, instead of removing these configs, can you make this way and check once?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;property&amp;gt;
&amp;lt;name&amp;gt;hbase.regionserver.hlog.reader.impl&amp;lt;/name&amp;gt;
&amp;lt;value&amp;gt;org.apache.hadoop.hbase.regionserver.wal.SecureProtobufLogReader&amp;lt;/value&amp;gt;
&amp;lt;/property&amp;gt;
&amp;lt;property&amp;gt;
&amp;lt;name&amp;gt;hbase.regionserver.hlog.writer.impl&amp;lt;/name&amp;gt;
&amp;lt;value&amp;gt;org.apache.hadoop.hbase.regionserver.wal.SecureProtobufLogWriter&amp;lt;/value&amp;gt;
&amp;lt;/property&amp;gt;
&amp;lt;property&amp;gt;
&amp;lt;name&amp;gt;hbase.regionserver.wal.encryption&amp;lt;/name&amp;gt;
&amp;lt;value&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;lt;/value&amp;gt;
&amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Still WAL encryption will be disabled for new writes.&lt;/p&gt;</comment>
                            <comment id="14073538" author="apurtell" created="Thu, 24 Jul 2014 19:14:50 +0000"  >&lt;p&gt;Please mail user@hbase.apache.org for reporting potential problems and community assistance in troubleshooting. JIRA isn&apos;t the correct forum for reporting problems until the cause is known. Nothing reported on this issue indicates encryption is more than an incidental detail. We don&apos;t encrypt the META table. There could be many reasons why you lost your HFiles. Did you keep the test configuration that puts the HBase root in /tmp for example. Anyway, please don&apos;t reply here, take this to user@hbase.apache.org. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 24 Jul 2014 15:42:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407546</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 21 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1y4of:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407560</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>