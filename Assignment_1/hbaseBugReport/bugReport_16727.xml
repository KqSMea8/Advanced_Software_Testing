<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:17:11 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-16727/HBASE-16727.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-16727] Backup refactoring: remove MR dependencies from HMaster</title>
                <link>https://issues.apache.org/jira/browse/HBASE-16727</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;ul&gt;
	&lt;li&gt;No MR jobs in HMaster&lt;/li&gt;
	&lt;li&gt;No proc2 implementation&lt;/li&gt;
	&lt;li&gt;client-driven backup-restore&lt;/li&gt;
	&lt;li&gt;basic security: only super user is allowed to run backup/restore&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13008329">HBASE-16727</key>
            <summary>Backup refactoring: remove MR dependencies from HMaster</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vrodionov">Vladimir Rodionov</assignee>
                                    <reporter username="vrodionov">Vladimir Rodionov</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Sep 2016 18:40:54 +0000</created>
                <updated>Wed, 5 Oct 2016 23:30:54 +0000</updated>
                            <resolved>Wed, 5 Oct 2016 23:30:53 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="15530519" author="vrodionov" created="Wed, 28 Sep 2016 18:50:20 +0000"  >&lt;p&gt;We will try to minimize work first.&lt;/p&gt;

&lt;p&gt;Backup code is currently split between client and server module. &lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;We will not create a separate module for backup unless it will be requested by community.&lt;/li&gt;
	&lt;li&gt;Backup/restore code will be removed from Master&lt;/li&gt;
	&lt;li&gt;Backup / restore procedures will be converted to utility classes in a &lt;b&gt;server&lt;/b&gt; module for command-line driven tools (BackupDriver and RestoreDriver)&lt;/li&gt;
	&lt;li&gt;We will need to remove completely BackupAdmin API, because after refactoring it will no longer be possible to trigger backup/restore   from client module.&lt;/li&gt;
	&lt;li&gt;The only backup/ restore API we will provide to users are command-line tools.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="15530535" author="vrodionov" created="Wed, 28 Sep 2016 18:53:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=devaraj&quot; class=&quot;user-hover&quot; rel=&quot;devaraj&quot;&gt;Devaraj Das&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;, your comments are welcomed.&lt;/p&gt;

&lt;p&gt;Should we create a separate branch for refactoring? A lot of code will be removed (BackupAdmin API, Master integration, procedures). I suggest freezing &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7912&quot; title=&quot;HBase Backup/Restore Based on HBase Snapshot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7912&quot;&gt;HBASE-7912&lt;/a&gt; (we could recover old version there) and creating separate branch for the refactoring work. &lt;/p&gt;</comment>
                            <comment id="15530588" author="devaraj" created="Wed, 28 Sep 2016 19:16:59 +0000"  >&lt;p&gt;Yeah let&apos;s preserve the current hbase-7912 branch&lt;/p&gt;</comment>
                            <comment id="15530594" author="busbey" created="Wed, 28 Sep 2016 19:19:22 +0000"  >&lt;p&gt;this is just the MR stuff for backup/restore, right?&lt;/p&gt;</comment>
                            <comment id="15530652" author="devaraj" created="Wed, 28 Sep 2016 19:42:03 +0000"  >&lt;p&gt;Right &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;... The title is probably a tad misleading. It&apos;s about removing the dependency on the MR runtime from the master that the code in the backup branch introduced.&lt;/p&gt;</comment>
                            <comment id="15530677" author="vrodionov" created="Wed, 28 Sep 2016 19:50:14 +0000"  >&lt;p&gt;Yes. We pull MR stuff out from Master. But we have to keep it in server module due to dependencies on server internal API (HFile/WAL reader writer classes)&lt;/p&gt;</comment>
                            <comment id="15530684" author="yuzhihong@gmail.com" created="Wed, 28 Sep 2016 19:51:53 +0000"  >&lt;p&gt;I am fine with creating &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14123&quot; title=&quot;HBase Backup/Restore Phase 2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14123&quot;&gt;HBASE-14123&lt;/a&gt; branch based on the master branch which catches up to the tip of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7912&quot; title=&quot;HBase Backup/Restore Based on HBase Snapshot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7912&quot;&gt;HBASE-7912&lt;/a&gt; branch.&lt;/p&gt;</comment>
                            <comment id="15530686" author="vrodionov" created="Wed, 28 Sep 2016 19:52:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt; what do you think? It is time now to give +-1 on this before we start refactoring.&lt;/p&gt;</comment>
                            <comment id="15530706" author="mbertozzi" created="Wed, 28 Sep 2016 19:58:51 +0000"  >&lt;p&gt;+1 for me&lt;/p&gt;</comment>
                            <comment id="15531237" author="stack" created="Wed, 28 Sep 2016 23:34:07 +0000"  >&lt;p&gt;+1 from me. Thanks Vladimir.&lt;/p&gt;</comment>
                            <comment id="15534645" author="vrodionov" created="Fri, 30 Sep 2016 01:03:57 +0000"  >&lt;p&gt;v1. It is huge. Sorry, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I moved all the code from hbase-client back to hbase-server, it does not make sense anymore to keep it in client.&lt;/p&gt;

&lt;p&gt;it is still &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7912&quot; title=&quot;HBase Backup/Restore Based on HBase Snapshot&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7912&quot;&gt;HBASE-7912&lt;/a&gt; based.&lt;/p&gt;</comment>
                            <comment id="15534676" author="yuzhihong@gmail.com" created="Fri, 30 Sep 2016 01:20:19 +0000"  >&lt;p&gt;Any chance of putting it on review board ?&lt;/p&gt;</comment>
                            <comment id="15534757" author="yuzhihong@gmail.com" created="Fri, 30 Sep 2016 02:03:23 +0000"  >&lt;p&gt;I looked at FullTableBackupClient.java&lt;br/&gt;
Suppose there was some interruption in the middle of execution, how does the next invocation recover ?&lt;/p&gt;

&lt;p&gt;Or, user always starts with new backup request ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="15534763" author="vrodionov" created="Fri, 30 Sep 2016 02:06:51 +0000"  >&lt;p&gt;We have separate JIRA for that, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;. For fault tolerance.&lt;/p&gt;</comment>
                            <comment id="15534771" author="vrodionov" created="Fri, 30 Sep 2016 02:12:15 +0000"  >&lt;p&gt;Review board&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/52413/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/52413/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Unit test now run 70% slower (47 vs 28 min). No explanation yet.&lt;/p&gt;</comment>
                            <comment id="15543492" author="vrodionov" created="Mon, 3 Oct 2016 21:32:11 +0000"  >&lt;p&gt;With the patch during ExportSnapshot phase the following WARNs messages appear in a log file:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2016-10-03 14:15:08,801 WARN  [ResourceManager Event Processor] capacity.LeafQueue(610): maximum-am-resource-percent is insufficient to start a single application in queue, it is likely set too low. skipping enforcement to allow at least one application to start
2016-10-03 14:15:08,801 WARN  [ResourceManager Event Processor] capacity.LeafQueue(631): maximum-am-resource-percent is insufficient to start a single application in queue &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; user, it is likely set too low. skipping enforcement to allow at least one application to start
2016-10-03 14:15:18,095 WARN  [ContainersLauncher #1] nodemanager.DefaultContainerExecutor(223): Exit code from container container_1475529282221_0001_01_000002 is : 143
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;No messages when we run ExportSnapshot phase w/o patch. &lt;/p&gt;</comment>
                            <comment id="15543499" author="yuzhihong@gmail.com" created="Mon, 3 Oct 2016 21:35:04 +0000"  >&lt;p&gt;Looking back at a TestIncrementalBackup output from two weeks ago:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2016-08-16 10:14:09,805 WARN  [ResourceManager Event Processor] capacity.LeafQueue(632): maximum-am-resource-percent is insufficient to start a single application in queue, it is likely set too low. skipping enforcement to allow at least one application to start
2016-08-16 10:14:09,805 WARN  [ResourceManager Event Processor] capacity.LeafQueue(653): maximum-am-resource-percent is insufficient to start a single application in queue &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;    user, it is likely set too low. skipping enforcement to allow at least one application to start
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15543561" author="vrodionov" created="Mon, 3 Oct 2016 22:01:58 +0000"  >&lt;p&gt;I will double check, but in my environment it seems true. W.o patch no WARN in mapred. Digging into this.&lt;/p&gt;</comment>
                            <comment id="15544282" author="vrodionov" created="Tue, 4 Oct 2016 04:11:36 +0000"  >&lt;p&gt;v2 fixes unit tests performance regression&lt;/p&gt;

&lt;p&gt;Fix is to provide MR jobs with Configuration from HBase Master and not from HBase Connection.  &lt;br/&gt;
(see TestBackupBase class - populateFromMasterConfig)&lt;/p&gt;</comment>
                            <comment id="15545526" author="yuzhihong@gmail.com" created="Tue, 4 Oct 2016 14:42:02 +0000"  >&lt;p&gt;Mind updating review board ?&lt;/p&gt;</comment>
                            <comment id="15546661" author="yuzhihong@gmail.com" created="Tue, 4 Oct 2016 21:06:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;:&lt;br/&gt;
Are you good with the latest patch ?&lt;/p&gt;</comment>
                            <comment id="15550287" author="yuzhihong@gmail.com" created="Wed, 5 Oct 2016 23:30:26 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15550290" author="yuzhihong@gmail.com" created="Wed, 5 Oct 2016 23:30:54 +0000"  >&lt;p&gt;Thanks for the patch, Vlad.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13008328">HBASE-16726</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12863549">HBASE-14414</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12831036" name="HBASE-16727-v1.patch" size="1493287" author="vrodionov" created="Fri, 30 Sep 2016 01:03:57 +0000"/>
                            <attachment id="12831456" name="HBASE-16727-v2.patch" size="1499138" author="vrodionov" created="Tue, 4 Oct 2016 04:11:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 28 Sep 2016 19:16:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i347in:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>