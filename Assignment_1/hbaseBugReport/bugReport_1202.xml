<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:51:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1202/HBASE-1202.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1202] getRow does not always work when specifying number of versions</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1202</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When a cell that exists is updated, getRow specifying number of versions does not work.&lt;br/&gt;
What is returned is the original value at that timestamp, instead of the updated value.&lt;/p&gt;

&lt;p&gt;Note that this only applies when more than one version is specified. getRow with (implied) timestamp = latest does work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12414911">HBASE-1202</key>
            <summary>getRow does not always work when specifying number of versions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jimk">Jim Kellerman</assignee>
                                    <reporter username="jimk">Jim Kellerman</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Feb 2009 04:12:20 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:25 +0000</updated>
                            <resolved>Fri, 10 Apr 2009 20:00:08 +0000</resolved>
                                    <version>0.19.0</version>
                    <version>0.19.1</version>
                    <version>0.20.0</version>
                                    <fixVersion>0.19.2</fixVersion>
                    <fixVersion>0.20.0</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12674093" author="jimk" created="Tue, 17 Feb 2009 04:14:19 +0000"  >&lt;p&gt;This is a test program that demonstrates the problem.&lt;/p&gt;</comment>
                            <comment id="12679890" author="jimk" created="Sat, 7 Mar 2009 16:48:18 +0000"  >&lt;p&gt;Downgrading to major and moving 0.19.2. It can be fixed when we do scanners with multiple versions.&lt;/p&gt;</comment>
                            <comment id="12682379" author="stack" created="Mon, 16 Mar 2009 17:10:02 +0000"  >&lt;p&gt;I just noticed in memcache that numVersions is not per column but a count of all results found so far.  Maybe related?&lt;/p&gt;</comment>
                            <comment id="12697895" author="jimk" created="Fri, 10 Apr 2009 18:11:37 +0000"  >&lt;p&gt;I don&apos;t think numVersions being a count of all results is the issue. (but it is a problem if it hasn&apos;t been fixed).&lt;/p&gt;

&lt;p&gt;What the test does is:&lt;br/&gt;
1. store the value &quot;value1&quot; in column contents:contents at a specified timestamp.&lt;br/&gt;
2. shutdown and restart the cluster to force data to disk.&lt;br/&gt;
3. store the value &quot;value2&quot; in column contents:contents at the &lt;b&gt;same&lt;/b&gt; timestamp as the first value.&lt;br/&gt;
4. call getRow(row) and it gets back &quot;value2&quot; as expected.&lt;br/&gt;
5. call getRow(row, HConstants.ALL_VERSIONS) and it gets back &quot;value1&quot; and not &quot;value2&quot;&lt;/p&gt;

&lt;p&gt;But now I understand what is going on.&lt;/p&gt;

&lt;p&gt;Cell contains a SortedMap&amp;lt;Long, byte[]&amp;gt; (where Long is the timestamp). So what happens is that &quot;value2&quot; is fetched out of the memcache and then &quot;value1&quot; is fetched from disk and because the timestamps are the same, overwrites the entry containing &quot;value2&quot;. &lt;/p&gt;

&lt;p&gt;I think when we are looking for multiple versions, we need to check if we already have a match for row/column/timestamp and not insert a second value if we already have one at that timestamp.&lt;/p&gt;</comment>
                            <comment id="12697907" author="jimk" created="Fri, 10 Apr 2009 18:32:11 +0000"  >&lt;p&gt;It turns out that HStore has the same problem as Memcache, i.e., keeping a count of versions on a per-column basis instead of per-cell.&lt;/p&gt;</comment>
                            <comment id="12697941" author="jimk" created="Fri, 10 Apr 2009 19:31:57 +0000"  >&lt;p&gt;I was wrong about Memcache and HStore. After reading more closely, they do count numVersions on a per cell basis.&lt;/p&gt;</comment>
                            <comment id="12697953" author="jimk" created="Fri, 10 Apr 2009 20:00:08 +0000"  >&lt;p&gt;Added new test case TestGetRowVersions.&lt;br/&gt;
Committed to branch and trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12400307" name="TestGetRowVersions.java" size="3804" author="jimk" created="Tue, 17 Feb 2009 04:14:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 16 Mar 2009 17:10:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25623</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hbxj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99195</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>