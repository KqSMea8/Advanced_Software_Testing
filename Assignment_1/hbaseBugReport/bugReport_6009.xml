<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:32:58 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6009/HBASE-6009.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6009] Changes for HBASE-5209 are technically incompatible</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6009</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The additions to add backup masters to ClusterStatus are technically incompatible between clients and servers.  Older clients will basically not read the extra bits that the newer server pushes for the backup masters, thus screwing up the serialization for the next blob in the pipe.&lt;/p&gt;

&lt;p&gt;For the Writable, we can add a total size field for ClusterStatus at the beginning, or we can have start and end markers.  I can make a patch for either approach; interested in whatever folks have to suggest.  Would be good to get this in soon to limit the damage to 0.92.1 (don&apos;t know if we can get this in in time for 0.94.0).&lt;/p&gt;

&lt;p&gt;Either change will make us forward-compatible starting with when the change goes in, but will not fix the backwards incompatibility, which we will have to mark with a release note as there have already been releases with this change.&lt;/p&gt;

&lt;p&gt;Hopefully we can do this in a cleaner way when wire compat rolls around in 0.96.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12555936">HBASE-6009</key>
            <summary>Changes for HBASE-5209 are technically incompatible</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="dsw">David S. Wang</assignee>
                                    <reporter username="dsw">David S. Wang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 May 2012 00:17:14 +0000</created>
                <updated>Mon, 25 Jun 2012 21:56:10 +0000</updated>
                            <resolved>Mon, 25 Jun 2012 21:56:10 +0000</resolved>
                                    <version>0.92.1</version>
                    <version>0.94.0</version>
                                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13276400" author="zhihyu@ebaysf.com" created="Wed, 16 May 2012 02:54:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;or we can have start and end markers&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;How do we define the markers ? Through a series of magic bytes ?&lt;/p&gt;

&lt;p&gt;Looks like total size field for ClusterStatus is better choice.&lt;/p&gt;</comment>
                            <comment id="13277810" author="dsw" created="Thu, 17 May 2012 13:51:57 +0000"  >&lt;p&gt;I looked at the total size field option for this, starting from the write case.&lt;/p&gt;

&lt;p&gt;To calculate total size written, you have to know how many bytes were written for each write() call on ClusterStatus, including any objects contained inside it.&lt;/p&gt;

&lt;p&gt;The DataOutput interface for Writables doesn&apos;t have a way to return how many bytes were written to the stream.  This is not a problem for primitive types as we can figure that out trivially.  Even for somewhat more complicated situations such as modified UTF-8s written with the writeUTF call, the number of written bytes for a String can at least be calculated based on the formula for modified UTF-8 conversion.&lt;/p&gt;

&lt;p&gt;However, for calls to Object&apos;s write functions (e.g. for HRegionLoad), this becomes somewhat more problematic as there is no obvious answer as to how many bytes were written.  We could use reflection to grab the fields, but then there is no guarantee that all of the fields of the Object are actually written to the stream when write() is called.  So you&apos;d have to introduce some hardcoded way of knowing how much was written for each Object, which is Bad.&lt;/p&gt;

&lt;p&gt;I&apos;m tempted to say that we shouldn&apos;t add any more fields to ClusterStatus or similar APIs until 0.96, when hopefully our wire compatibility efforts will kick in and we can do this in a compatible way without having to jump through hoops.&lt;/p&gt;</comment>
                            <comment id="13277834" author="zhihyu@ebaysf.com" created="Thu, 17 May 2012 14:08:04 +0000"  >&lt;p&gt;@David:&lt;br/&gt;
See the following:&lt;br/&gt;
&lt;a href=&quot;http://stackoverflow.com/questions/2984538/how-to-use-bytearrayoutputstream-and-dataoutputstream-simultaneously-java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://stackoverflow.com/questions/2984538/how-to-use-bytearrayoutputstream-and-dataoutputstream-simultaneously-java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13279043" author="stack" created="Fri, 18 May 2012 18:16:46 +0000"  >&lt;p&gt;Lets try and avoid serializing fat ClusterStatus objects twice.&lt;/p&gt;

&lt;p&gt;We have never made guarantee that old clients could talk to new servers pre-0.96 (Too hard in the Writables world).  What is the scenario David?  You cannot update the clients?  Wouldn&apos;t you have to update the clients anyways if you introduce clusterstatus size?  Pardon me if I&apos;m not getting this.&lt;/p&gt;</comment>
                            <comment id="13279067" author="dsw" created="Fri, 18 May 2012 18:39:48 +0000"  >&lt;p&gt;The immediate issue here is that &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5209&quot; title=&quot;HConnection/HMasterInterface should allow for way to get hostname of currently active master in multi-master HBase setup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5209&quot;&gt;&lt;del&gt;HBASE-5209&lt;/del&gt;&lt;/a&gt; was committed in 0.92.1, and that broke compatibility with 0.92.0.  I suppose anyone who cares about 0.92 branch has moved to 0.92.1 so that there is no practical hit.&lt;/p&gt;

&lt;p&gt;You are right that adding a size would be another incompatible change, hence my later comment about &quot;let&apos;s just not make any more changes until 0.96&quot;.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Anyway in the absence of any changes, I can at least add a release note to 0.92.1 stating this incompatibility with 0.92.0.  I&apos;ll use this JIRA to track that.&lt;/p&gt;</comment>
                            <comment id="13279075" author="enis" created="Fri, 18 May 2012 18:53:13 +0000"  >&lt;p&gt;+1 for the release note on 0.92.1. &lt;/p&gt;</comment>
                            <comment id="13279077" author="stack" created="Fri, 18 May 2012 18:55:11 +0000"  >&lt;p&gt;bq ...that &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5209&quot; title=&quot;HConnection/HMasterInterface should allow for way to get hostname of currently active master in multi-master HBase setup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5209&quot;&gt;&lt;del&gt;HBASE-5209&lt;/del&gt;&lt;/a&gt; was committed in 0.92.1, and that broke compatibility with 0.92.0&lt;/p&gt;

&lt;p&gt;That was dumb.  Did I do it?  Probably.&lt;/p&gt;

&lt;p&gt;Should we back it out for 0.92.2?&lt;/p&gt;</comment>
                            <comment id="13279090" author="zhihyu@ebaysf.com" created="Fri, 18 May 2012 19:05:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5209&quot; title=&quot;HConnection/HMasterInterface should allow for way to get hostname of currently active master in multi-master HBase setup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5209&quot;&gt;&lt;del&gt;HBASE-5209&lt;/del&gt;&lt;/a&gt; is an improvement.&lt;br/&gt;
Backing it out wouldn&apos;t be too bad.&lt;/p&gt;</comment>
                            <comment id="13279093" author="dsw" created="Fri, 18 May 2012 19:07:08 +0000"  >&lt;p&gt;I wouldn&apos;t back it out ... I think that would just create another incompatibility event between 0.92.1 and 0.92.2.&lt;/p&gt;

&lt;p&gt;The original goal was to get this committed for 0.92.0 (which would have avoided this), but I suppose we didn&apos;t make it for 0.92.0.  I should have said something about not doing this once 0.92.0 came out, so my apologies on that.&lt;/p&gt;</comment>
                            <comment id="13400939" author="jmhsieh" created="Mon, 25 Jun 2012 21:56:10 +0000"  >&lt;p&gt;It seems like from discussion and inaction, we&apos;ve decided to keep this in the acknowledge the incompatiblity between 0.92.0 and 0.92.1+ series, and keep this in 0.94.0 series allowing for compatibility between 0.92.1+ and 0.94.0&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 May 2012 02:54:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245433</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 25 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i068hr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34307</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5209&quot; title=&quot;HConnection/HMasterInterface should allow for way to get hostname of currently active master in multi-master HBase setup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5209&quot;&gt;&lt;strike&gt;HBASE-5209&lt;/strike&gt;&lt;/a&gt; was introduced in 0.92.1 and 0.94.0 but introduced an incompatibility from a 0.92.0 client.  Since this had maded it into two releases already, we&amp;#39;ve decided to leave it in.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>