<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:55:47 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8495/HBASE-8495.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8495] Change ownership of the directory to bulk load</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8495</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;To bulk load something you need to change the ownership of the data directory to allow the hbase user to read and move the files, also in the split case you must use the hbase user to run the LoadIncrementalHFiles tool, since internally some directories &quot;_tmp&quot; are created to add the split reference files.&lt;/p&gt;

&lt;p&gt;In a secure cluster, the SecureBulkLoadEndPoint will take care of this problem by doing a chmod 777 on the directory to bulk load.&lt;/p&gt;

&lt;p&gt;NOTE that a chown is not possible since you must be a super user to change the ownership, a change group may be possible but the user must be in the hbase group... and anyway it will require a chmod to allow the group to perform the move.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: org.apache.hadoop.security.AccessControlException: Permission denied: user=hbase, access=WRITE, inode=&lt;span class=&quot;code-quote&quot;&gt;&quot;/test/cf&quot;&lt;/span&gt;:th30z:supergroup:drwxr-xr-x
	at org.apache.hadoop.hdfs.server.namenode.FSPermissionChecker.check(FSPermissionChecker.java:205)
Caused by: org.apache.hadoop.hbase.ipc.RemoteWithExtrasException(java.io.IOException): java.io.IOException: Exception in rename
	at org.apache.hadoop.hbase.regionserver.HRegionFileSystem.rename(HRegionFileSystem.java:928)
	at org.apache.hadoop.hbase.regionserver.HRegionFileSystem.commitStoreFile(HRegionFileSystem.java:340)
	at org.apache.hadoop.hbase.regionserver.HRegionFileSystem.bulkLoadStoreFile(HRegionFileSystem.java:414)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12646122">HBASE-8495</key>
            <summary>Change ownership of the directory to bulk load</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mbertozzi">Matteo Bertozzi</assignee>
                                    <reporter username="mbertozzi">Matteo Bertozzi</reporter>
                        <labels>
                    </labels>
                <created>Sun, 5 May 2013 10:33:31 +0000</created>
                <updated>Mon, 22 Sep 2014 18:49:17 +0000</updated>
                            <resolved>Mon, 9 Jun 2014 21:35:01 +0000</resolved>
                                    <version>0.94.7</version>
                    <version>0.95.0</version>
                                    <fixVersion>0.99.0</fixVersion>
                    <fixVersion>0.94.21</fixVersion>
                    <fixVersion>0.98.4</fixVersion>
                                    <component>mapreduce</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>13</watches>
                                                                <comments>
                            <comment id="14021344" author="apurtell" created="Sun, 8 Jun 2014 21:17:33 +0000"  >&lt;p&gt;lgtm. For 0.94 only. Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14021518" author="lhofhansl" created="Mon, 9 Jun 2014 01:50:06 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14025909" author="hudson" created="Mon, 9 Jun 2014 23:12:01 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-security #490 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/490/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/490/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8495&quot; title=&quot;Change ownership of the directory to bulk load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8495&quot;&gt;&lt;del&gt;HBASE-8495&lt;/del&gt;&lt;/a&gt; Change ownership of the directory to bulk load (matteo.bertozzi: rev 9498adde2a190b46de2289e67ced4b2f73a8baeb)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14025938" author="hudson" created="Mon, 9 Jun 2014 23:44:30 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94 #1374 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1374/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1374/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8495&quot; title=&quot;Change ownership of the directory to bulk load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8495&quot;&gt;&lt;del&gt;HBASE-8495&lt;/del&gt;&lt;/a&gt; Change ownership of the directory to bulk load (matteo.bertozzi: rev 9498adde2a190b46de2289e67ced4b2f73a8baeb)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14025965" author="hudson" created="Tue, 10 Jun 2014 00:18:12 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-JDK7 #142 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-JDK7/142/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-JDK7/142/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8495&quot; title=&quot;Change ownership of the directory to bulk load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8495&quot;&gt;&lt;del&gt;HBASE-8495&lt;/del&gt;&lt;/a&gt; Change ownership of the directory to bulk load (matteo.bertozzi: rev 9498adde2a190b46de2289e67ced4b2f73a8baeb)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14026017" author="hudson" created="Tue, 10 Jun 2014 01:45:34 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5188 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5188/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5188/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8495&quot; title=&quot;Change ownership of the directory to bulk load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8495&quot;&gt;&lt;del&gt;HBASE-8495&lt;/del&gt;&lt;/a&gt; Change ownership of the directory to bulk load (matteo.bertozzi: rev 548d5061c96f98eedf39f6fec77b53f88e088412)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14026034" author="hudson" created="Tue, 10 Jun 2014 02:01:36 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98 #329 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/329/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/329/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8495&quot; title=&quot;Change ownership of the directory to bulk load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8495&quot;&gt;&lt;del&gt;HBASE-8495&lt;/del&gt;&lt;/a&gt; Change ownership of the directory to bulk load (matteo.bertozzi: rev 4980a67e672d767b9c6a15fda8aa08dd37c757c4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14026049" author="hudson" created="Tue, 10 Jun 2014 02:22:36 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98-on-Hadoop-1.1 #311 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/311/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/311/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8495&quot; title=&quot;Change ownership of the directory to bulk load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8495&quot;&gt;&lt;del&gt;HBASE-8495&lt;/del&gt;&lt;/a&gt; Change ownership of the directory to bulk load (matteo.bertozzi: rev 4980a67e672d767b9c6a15fda8aa08dd37c757c4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/LoadIncrementalHFiles.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14123387" author="jeffreyz" created="Fri, 5 Sep 2014 18:57:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt; We also see the same issue. It seems that the fix can only work for cases when bulk loaded files needs split as shown the code below. Thanks.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!lastKeyInRange) {
      List&amp;lt;LoadQueueItem&amp;gt; lqis = splitStoreFile(item, table,
          startEndKeys.getFirst()[indexForCallable],
          startEndKeys.getSecond()[indexForCallable]);
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; lqis;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="14123442" author="mbertozzi" created="Fri, 5 Sep 2014 19:34:38 +0000"  >&lt;p&gt;correct the fix is only on the dir/files that the tool generates.&lt;br/&gt;
you need to open the directory if you want allow to read files from that dir, i think is documented.&lt;br/&gt;
this jira solves the problem when you allow the tool to pick the files, but the generated files were not loadable.&lt;br/&gt;
Adding a chmod 777 doesn&apos;t look the right choice, since not everyone may want to open the dir to everyone&lt;/p&gt;</comment>
                            <comment id="14123521" author="jeffreyz" created="Fri, 5 Sep 2014 20:32:47 +0000"  >&lt;blockquote&gt;
&lt;p&gt;&quot;Adding a chmod 777 doesn&apos;t look the right choice, since not everyone may want to open the dir to everyone&quot;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, you&apos;re right. SecureBulkLoad seems solve this issue nicely. I&apos;m planning to do the similar for un-secure case. Basically creating a folder under hbase staging directory and use doAs to move files from input folder to this staging directory and then bulk load files from the newly folder under staging directory. &lt;/p&gt;</comment>
                            <comment id="14127378" author="dschorow" created="Tue, 9 Sep 2014 18:49:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m planning to do the similar for un-secure case ...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Is that going to be in a new Jira, since this one is closed?&lt;/p&gt;</comment>
                            <comment id="14127388" author="mbertozzi" created="Tue, 9 Sep 2014 18:52:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dschorow&quot; class=&quot;user-hover&quot; rel=&quot;dschorow&quot;&gt;David Schorow&lt;/a&gt; yes, new jira&lt;/p&gt;</comment>
                            <comment id="14143620" author="jeffreyz" created="Mon, 22 Sep 2014 18:49:17 +0000"  >&lt;p&gt;I&apos;ve created &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12052&quot; title=&quot;BulkLoad Failed due to no write permission on input files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12052&quot;&gt;&lt;del&gt;HBASE-12052&lt;/del&gt;&lt;/a&gt; for bulk load permission issue in a un-secure env. Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12640742" name="HBASE-8495-0.94-v0.patch" size="1253" author="mbertozzi" created="Fri, 18 Apr 2014 00:16:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 8 Jun 2014 21:17:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>326480</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kbon:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>326825</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>