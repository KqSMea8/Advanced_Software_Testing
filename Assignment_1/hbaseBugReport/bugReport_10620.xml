<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:15:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10620/HBASE-10620.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10620] LoadBalancer.needsBalance() should check for co-located region replicas as well</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10620</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This is a left over TODO from reviews of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10351&quot; title=&quot;LoadBalancer changes for supporting region replicas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10351&quot;&gt;&lt;del&gt;HBASE-10351&lt;/del&gt;&lt;/a&gt;. &lt;br/&gt;
LB.needsBalance() does some basic checking before running the LB.balance() method. We need to check whether there are co-located regions in this method so that the balancer can increase availability. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12697464">HBASE-10620</key>
            <summary>LoadBalancer.needsBalance() should check for co-located region replicas as well</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12682280">HBASE-10070</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="devaraj">Devaraj Das</assignee>
                                    <reporter username="enis">Enis Soztutar</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Feb 2014 21:46:13 +0000</created>
                <updated>Sat, 21 Feb 2015 23:29:43 +0000</updated>
                            <resolved>Thu, 6 Mar 2014 23:35:02 +0000</resolved>
                                                    <fixVersion>0.99.0</fixVersion>
                    <fixVersion>hbase-10070</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13921931" author="devaraj" created="Thu, 6 Mar 2014 02:39:49 +0000"  >&lt;p&gt;Patch that fixes this issue and another to do with erroneously returning true when HMaster.balance is called.&lt;/p&gt;</comment>
                            <comment id="13921942" author="yuzhihong@gmail.com" created="Thu, 6 Mar 2014 02:57:16 +0000"  >&lt;p&gt;lgtm&lt;br/&gt;
nit:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    regionReplicaHostCostFunction.init(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Cluster(cs.getClusterState(), loads, regionFinder,
+        rackManager));
+    regionReplicaRackCostFunction.init(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Cluster(cs.getClusterState(), loads, regionFinder,
+        rackManager));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The Cluster instance can be shared between regionReplicaHostCostFunction.init() and regionReplicaRackCostFunction.init(), right ?&lt;/p&gt;</comment>
                            <comment id="13922112" author="devaraj" created="Thu, 6 Mar 2014 07:40:12 +0000"  >&lt;p&gt;Oh yeah, that was a copy paste overlook. This patch fixes that issue, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tedyu@apache.org&quot;&gt;Ted Yu&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13922945" author="enis" created="Thu, 6 Mar 2014 19:36:52 +0000"  >&lt;p&gt;+1. Nice patch! &lt;/p&gt;</comment>
                            <comment id="13922949" author="enis" created="Thu, 6 Mar 2014 19:39:13 +0000"  >&lt;p&gt;Before commit though, can we change it so that the Cluster object is constructed only once? It is a relatively costly operation. in SLB.balanceCluster() we construct the Cluster object after calling needsBalance(). Maybe we should change needsBalance() to take Cluster instead of ClusterLoadState. &lt;/p&gt;</comment>
                            <comment id="13923242" author="devaraj" created="Thu, 6 Mar 2014 23:19:05 +0000"  >&lt;p&gt;Updated patch with the comment addressed.&lt;/p&gt;</comment>
                            <comment id="13923246" author="enis" created="Thu, 6 Mar 2014 23:27:18 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13923253" author="devaraj" created="Thu, 6 Mar 2014 23:35:02 +0000"  >&lt;p&gt;Committed. Thanks for the reviews.&lt;/p&gt;</comment>
                            <comment id="13932476" author="enis" created="Wed, 12 Mar 2014 22:04:58 +0000"  >&lt;p&gt;v3 patch fixed a LB bug: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-      balancerRan = plans != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
+      balancerRan = plans.size() != 0;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;plans is previously initialized to a new ArrayList, so balancerRan was always true regardless of whether the LB generated any plans or not. Although the patches fixes the code to be correct in terms of the intended semantics, I think the intended semantics was wrong. Namely, if the LB does not generate any plans (because the cluster is already balanced) we should return TRUE. Otherwise outside callers (from shell) have no way of distinguishing whether the balancer cannot be run because of RIT, or it was able to run, but no plans were generated (because needsBalance() returned false) etc. &lt;/p&gt;</comment>
                            <comment id="13932478" author="enis" created="Wed, 12 Mar 2014 22:05:52 +0000"  >&lt;p&gt;Simple addendum patch for fixing the semantics according to previous behavior. &lt;/p&gt;</comment>
                            <comment id="13932516" author="devaraj" created="Wed, 12 Mar 2014 22:16:22 +0000"  >&lt;p&gt;Makes sense. +1 on the addendum.&lt;/p&gt;</comment>
                            <comment id="13932574" author="enis" created="Wed, 12 Mar 2014 22:45:26 +0000"  >&lt;p&gt;Thanks Devaraj. I committed the addendum patch. &lt;/p&gt;</comment>
                            <comment id="14046615" author="enis" created="Sat, 28 Jun 2014 01:47:14 +0000"  >&lt;p&gt;Attaching rebased patch for master that is committed&lt;/p&gt;</comment>
                            <comment id="14046620" author="enis" created="Sat, 28 Jun 2014 01:47:28 +0000"  >&lt;p&gt;Attaching rebased patch for master that is committed&lt;/p&gt;</comment>
                            <comment id="14046664" author="enis" created="Sat, 28 Jun 2014 02:08:05 +0000"  >&lt;p&gt;Committed to master as part of hbase-10070 branch merge&lt;/p&gt;</comment>
                            <comment id="14046669" author="enis" created="Sat, 28 Jun 2014 02:08:23 +0000"  >&lt;p&gt;Committed to master as part of hbase-10070 branch merge&lt;/p&gt;</comment>
                            <comment id="14046744" author="hudson" created="Sat, 28 Jun 2014 06:13:54 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5245 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5245/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5245/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10620&quot; title=&quot;LoadBalancer.needsBalance() should check for co-located region replicas as well&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10620&quot;&gt;&lt;del&gt;HBASE-10620&lt;/del&gt;&lt;/a&gt;. LoadBalancer.needsBalance() should check for co-located region replicas as well (enis: rev e34dae0c9a1ef8b729d124b328c750487b74d37d)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestStochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/TestRegionRebalancing.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10620&quot; title=&quot;LoadBalancer.needsBalance() should check for co-located region replicas as well&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10620&quot;&gt;&lt;del&gt;HBASE-10620&lt;/del&gt;&lt;/a&gt; LoadBalancer.needsBalance() should check for co-located region replicas as well (Addendum patch to fix return value from balance() call) (enis: rev fa68470fe656d2adbda31767908e37da3aa9fc7c)&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14330598" author="enis" created="Sat, 21 Feb 2015 23:29:43 +0000"  >&lt;p&gt;Closing this issue after 0.99.0 release. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12689113">HBASE-10351</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12704138">HBASE-10858</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12652954" name="0016-HBASE-10620.-LoadBalancer.needsBalance-should-check-.patch" size="16980" author="enis" created="Sat, 28 Jun 2014 01:47:13 +0000"/>
                            <attachment id="12652959" name="0021-HBASE-10620-LoadBalancer.needsBalance-should-check-f.patch" size="2076" author="enis" created="Sat, 28 Jun 2014 01:47:27 +0000"/>
                            <attachment id="12633016" name="10620-1.txt" size="9174" author="devaraj" created="Thu, 6 Mar 2014 02:39:49 +0000"/>
                            <attachment id="12633067" name="10620-2.txt" size="9159" author="devaraj" created="Thu, 6 Mar 2014 07:40:12 +0000"/>
                            <attachment id="12634280" name="10620-3-addendum.patch" size="1340" author="enis" created="Wed, 12 Mar 2014 22:05:52 +0000"/>
                            <attachment id="12633250" name="10620-3.txt" size="12664" author="devaraj" created="Thu, 6 Mar 2014 23:19:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 6 Mar 2014 02:39:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>375938</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ss5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>376234</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>