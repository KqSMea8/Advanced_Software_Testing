<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:43:45 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13479/HBASE-13479.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13479] [branch-1.0] Master should not bind to region server ports</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13479</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In parent jira, we have brought back old config value &lt;tt&gt;hbase.master.port&lt;/tt&gt; and made it so that if it is configured (which is by default), master does not bind to the region servers&apos;s RPC and info ports now. We have realized that master binding to RS ports turns out to be a pain point and unnecessary frustration for users (although we were expecting the opposite). &lt;/p&gt;

&lt;p&gt;Let&apos;s use this jira to see what we can do in 1.0.x series. In 1.0.0, master binds to ports&lt;br/&gt;
&lt;tt&gt;hbase.regionserver.port&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;hbase.master.info.port&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;hbase.regionserver.info.port&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;In 1.0.x, we have a couple of options I think:&lt;br/&gt;
(a) don&apos;t do anything. &lt;br/&gt;
(b) Commit patch from master as it is. All upgrades from 1.0.0 will observe changed ports. &lt;br/&gt;
(c) Commit the patch, disabled by default. If user has &lt;tt&gt;hbase.master.port&lt;/tt&gt; set, bind to the port. Only users who set the conf value will observe changed ports. &lt;br/&gt;
(d) Commit the patch with an extra config option &lt;tt&gt;hbase.master.compat.mode&lt;/tt&gt;. The users have to explicitly enable this in 1.0. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12821272">HBASE-13479</key>
            <summary>[branch-1.0] Master should not bind to region server ports</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12820164">HBASE-13453</parent>
                                    <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="enis">Enis Soztutar</assignee>
                                    <reporter username="enis">Enis Soztutar</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Apr 2015 19:28:03 +0000</created>
                <updated>Fri, 22 May 2015 10:15:35 +0000</updated>
                            <resolved>Thu, 16 Apr 2015 19:01:11 +0000</resolved>
                                                    <fixVersion>1.0.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="14496764" author="enis" created="Wed, 15 Apr 2015 19:29:28 +0000"  >&lt;p&gt;I have this as a blocker for 1.0.1. If we decide to do this, I&apos;ll sink the RC, since having it early in the 1.0.x lifetime is important. &lt;/p&gt;</comment>
                            <comment id="14496802" author="esteban" created="Wed, 15 Apr 2015 19:59:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;(b) Commit patch from master as it is. All upgrades from 1.0.0 will observe changed ports. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Users that have upgraded already from pre-1.0 to 1.0 know about this problem and they had to work around this with new configurations (pretty much as expected as this is the 1.0 release) With the patch from master (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13453&quot; title=&quot;Master should not bind to region server ports&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13453&quot;&gt;&lt;del&gt;HBASE-13453&lt;/del&gt;&lt;/a&gt;) it reverts the behavior and will need to be a release note if we go this in direction, and I don&apos;t think is something good to do.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(c) Commit the patch, disabled by default. If user has hbase.master.port set, bind to the port. Only users who set the conf value will observe changed ports.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thats what I would expect.&lt;/p&gt;
</comment>
                            <comment id="14496821" author="stack" created="Wed, 15 Apr 2015 20:06:04 +0000"  >&lt;p&gt;I&apos;d think c. enough but could go with d. too.&lt;/p&gt;</comment>
                            <comment id="14496923" author="enis" created="Wed, 15 Apr 2015 20:49:35 +0000"  >&lt;p&gt;Attaching a patch for approach (c) above. In 1.0+, we already respect &lt;tt&gt;hbase.master.info.port&lt;/tt&gt;. So the behavior is: &lt;/p&gt;

&lt;p&gt;&lt;b&gt;1.0.0:&lt;/b&gt;&lt;br/&gt;
RPC: &lt;tt&gt;hbase.master.port&lt;/tt&gt; IS NOT respected. Master binds to &lt;tt&gt;hbase.regionserver.port&lt;/tt&gt;&lt;br/&gt;
INFO: Master binds to &lt;tt&gt;hbase.master.info.port&lt;/tt&gt; AND &lt;tt&gt;hbase.regionserver.info.port&lt;/tt&gt;.&lt;br/&gt;
By default, master will use: 16010, 16020, 16030  &lt;br/&gt;
&lt;b&gt;1.0.1+:&lt;/b&gt;&lt;br/&gt;
RPC: &lt;tt&gt;hbase.master.port&lt;/tt&gt; IS respected if configured. Master binds to &lt;tt&gt;hbase.regionserver.port&lt;/tt&gt; by default if not configured.&lt;br/&gt;
INFO: Master binds to &lt;tt&gt;hbase.master.info.port&lt;/tt&gt; only. &lt;br/&gt;
By default, master will use: 16010, 16020.&lt;/p&gt;

&lt;p&gt;What do you guys think? &lt;/p&gt;</comment>
                            <comment id="14497081" author="devaraj" created="Wed, 15 Apr 2015 21:56:01 +0000"  >&lt;p&gt;Seems okay to me.. (I was thinking that we&apos;ll have issues if we have colocation turned on with this but it seems to be okay).&lt;/p&gt;</comment>
                            <comment id="14497098" author="esteban" created="Wed, 15 Apr 2015 22:02:28 +0000"  >&lt;p&gt;lgtm&lt;/p&gt;</comment>
                            <comment id="14497552" author="stack" created="Thu, 16 Apr 2015 04:48:09 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;I tried it.&lt;/p&gt;

&lt;p&gt;I added these configs:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/conf/hbase-env.sh b/conf/hbase-env.sh
index 2bbde1a..87745d7 100644
--- a/conf/hbase-env.sh
+++ b/conf/hbase-env.sh
@@ -124,6 +124,7 @@ export HBASE_OPTS=&lt;span class=&quot;code-quote&quot;&gt;&quot;-XX:+UseConcMarkSweepGC&quot;&lt;/span&gt;

 # Tell HBase whether it should manage it&apos;s own instance of Zookeeper or not.
 # export HBASE_MANAGES_ZK=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
+export HBASE_MANAGES_ZK=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;

 # The &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; log rolling policy is RFA, where the log file is rolled as per the size defined &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the
 # RFA appender. Please refer to the log4j.properties file to see more details on &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; appender.
diff --git a/conf/hbase-site.xml b/conf/hbase-site.xml
index c516ac7..c88ad7e 100644
--- a/conf/hbase-site.xml
+++ b/conf/hbase-site.xml
@@ -21,4 +21,20 @@
  */
 --&amp;gt;
 &amp;lt;configuration&amp;gt;
+  &amp;lt;property &amp;gt;
+    &amp;lt;name&amp;gt;hbase.cluster.distributed&amp;lt;/name&amp;gt;
+    &amp;lt;value&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/value&amp;gt;
+    &amp;lt;description&amp;gt;The mode the cluster will be in. Possible values are
+      &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; standalone mode and &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; distributed mode.  If
+      &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, startup will run all HBase and ZooKeeper daemons together
+      in the one JVM.&amp;lt;/description&amp;gt;
+  &amp;lt;/property&amp;gt;
+  &amp;lt;property &amp;gt;
+    &amp;lt;name&amp;gt;hbase.master.port&amp;lt;/name&amp;gt;
+    &amp;lt;value&amp;gt;16010&amp;lt;/value&amp;gt;
+  &amp;lt;/property&amp;gt;
+  &amp;lt;property &amp;gt;
+    &amp;lt;name&amp;gt;hbase.master.info.port&amp;lt;/name&amp;gt;
+    &amp;lt;value&amp;gt;16011&amp;lt;/value&amp;gt;
+  &amp;lt;/property&amp;gt;
 &amp;lt;/configuration&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I started zk, then master.  I could not start regionserver because ports were occupied (the hbase.master.port configs were ignored in hbase-site.xml).&lt;/p&gt;

&lt;p&gt;I applied the patch and I was able to start master and then regionserver successfully.&lt;/p&gt;

&lt;p&gt;I think it a good call sinking the RC to get this one in. Its still bad but at least there is an out now. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14498519" author="enis" created="Thu, 16 Apr 2015 19:01:11 +0000"  >&lt;p&gt;I have committed this to 1.0. Thanks for reviews and trying it out. &lt;/p&gt;</comment>
                            <comment id="14498746" author="hudson" created="Thu, 16 Apr 2015 21:17:34 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #865 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/865/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/865/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13479&quot; title=&quot;[branch-1.0] Master should not bind to region server ports&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13479&quot;&gt;&lt;del&gt;HBASE-13479&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;branch-1.0&amp;#93;&lt;/span&gt; Master should not bind to region server ports (enis: rev 071298c65f450a012e5d1a56f861c981228b8e22)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RSRpcServices.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14517743" author="enis" created="Tue, 28 Apr 2015 19:18:31 +0000"  >&lt;p&gt;Closing this issue after 1.0.1 release.&lt;/p&gt;</comment>
                            <comment id="14555938" author="sidd123" created="Fri, 22 May 2015 10:15:35 +0000"  >&lt;p&gt;Faced this issue while istallation of 1.0.1 Hbase . The above suggestion worked well.&lt;br/&gt;
just need to configure these&lt;br/&gt;
1. hbase.regionserver.port&lt;br/&gt;
2. hbase.master.info.port&lt;br/&gt;
3. hbase.regionserver.info.port&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12725682" name="hbase-13479_v1.patch" size="3125" author="enis" created="Wed, 15 Apr 2015 20:49:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 15 Apr 2015 19:59:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2dawf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>HBase master now respects the configuration hbase.master.port if set. By default it is not set in hbase-default.xml in 1.0.x releases. Master also respects the parameter hbase.master.info.port, which is not changed. However, master will not bind to hbase.regionserver.info.port anymore. It only binds to hbase.master.info.port. &lt;br/&gt;
&lt;br/&gt;
The behavior:&lt;br/&gt;
1.0.0:&lt;br/&gt;
RPC: hbase.master.port IS NOT respected. Master binds to hbase.regionserver.port&lt;br/&gt;
INFO: Master binds to hbase.master.info.port AND hbase.regionserver.info.port.&lt;br/&gt;
By default, master will use: 16010, 16020, 16030 &lt;br/&gt;
1.0.1+:&lt;br/&gt;
RPC: hbase.master.port IS respected if configured. Master binds to hbase.regionserver.port by default if not configured.&lt;br/&gt;
INFO: Master binds to hbase.master.info.port only. &lt;br/&gt;
By default, master will use: 16010, 16020.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>