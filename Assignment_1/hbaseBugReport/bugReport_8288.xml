<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:53:48 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8288/HBASE-8288.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8288] HBaseFileSystem: Refactoring and correct semantics for createPath methods</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8288</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This jira is for two issues I see in the HBaseFileSystem class:&lt;br/&gt;
1) Load testing on a 7 node cluster using ycsb insert workload shows that static initialization of conf properties results in a slightly better throughput. Though the initialization uses HBaseConfiguration.create() call which is expensive (and I tried to avoid that in its first version), this class is used for most of the filesystem class, and had to invoke an additional checkAndSetXX call before making the fs call because it is not certain whether the retry properties are set or not. Having initialize them in static block removes that limitation.&lt;/p&gt;

&lt;p&gt;2) Correct semantics for CreatePathXXX method. In case the overwrite flag is false and file already exists, underlying fs throws an exception. It should be re-thrown to the caller.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12641317">HBASE-8288</key>
            <summary>HBaseFileSystem: Refactoring and correct semantics for createPath methods</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="v.himanshu">Himanshu Vashishtha</assignee>
                                    <reporter username="v.himanshu">Himanshu Vashishtha</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Apr 2013 05:36:56 +0000</created>
                <updated>Sat, 27 Apr 2013 15:55:16 +0000</updated>
                            <resolved>Mon, 8 Apr 2013 19:53:00 +0000</resolved>
                                    <version>0.94.6</version>
                                    <fixVersion>0.94.7</fixVersion>
                                    <component>Filesystem Integration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13625165" author="v.himanshu" created="Mon, 8 Apr 2013 05:44:43 +0000"  >&lt;p&gt;Added a test case for createPath with a false overwrite flag.&lt;/p&gt;</comment>
                            <comment id="13625168" author="v.himanshu" created="Mon, 8 Apr 2013 05:48:14 +0000"  >&lt;p&gt;Some numbers.&lt;br/&gt;
With out patch:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Target Throughput	Threads	Workload	 Operation	 &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of Operations	Average Throughput	Average Latency	Average MinLatency	Average MaxLatency	Average 95thPercentileLatency	 Average 99thPercentileLatency		
120000	240	 randomWrite	 INSERT	36000000	102970	1875	7	28260540	0	0		
												
140000	280	 randomWrite	 INSERT	42000000	97722	2376	7	38097746	0	0		
												
180000	360	 randomWrite	 INSERT	54000000	85490	3541	7	49078551	0	0		
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With patch:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Target Throughput	Threads	Workload	 Operation	 &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of Operations	Average Throughput	Average Latency	Average MinLatency	Average MaxLatency	Average 95thPercentileLatency	 Average 99thPercentileLatency		
120000	240	 randomWrite	 INSERT	36000000	104425	1835	7	27400334	0	0		
												
140000	280	 randomWrite	 INSERT	42000000	100603	2286	7	31676418	0	0		
												
180000	360	 randomWrite	 INSERT	54000000	88809	3338	7	47636500	0	0		
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13625247" author="mbertozzi" created="Mon, 8 Apr 2013 09:30:15 +0000"  >&lt;p&gt;I&apos;m +1 on the idea, but why you still have the &quot;conf&quot; arg to each function?&lt;/p&gt;

&lt;p&gt;The only problem that I see is that in a test I want to start a cluster with the dfs retries = X. In this case my value is ignored because you use the hbase-*.xml.&lt;/p&gt;

&lt;p&gt;It should be fine in a normal situation since the server is started by the external script and no one should change the conf object, but test values are ignored.&lt;/p&gt;

&lt;p&gt;If instead of calling HBaseConfig.create() you introduce a singleton on the configuration, as you have mentioned time ago, the test can set the configuration and the HBaseFileSystem will pickup the singleton conf that will contains the hbase-*.xml + the &quot;test&quot; config.&lt;/p&gt;

&lt;p&gt;It&apos;s more work and maybe a more intrusive change, so I&apos;m ok to have it in another jira and commit this one as initial version since the &quot;problem&quot; is just related to the tests.&lt;/p&gt;</comment>
                            <comment id="13625483" author="v.himanshu" created="Mon, 8 Apr 2013 15:55:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;but why you still have the &quot;conf&quot; arg to each function?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Refactored the calls to remove the conf object. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The only problem that I see is that in a test I want to start a cluster with the dfs retries = X. In this case my value is ignored because you use the hbase-*.xml.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, one can call HBaseFileSystem.setRetryCounts(conf) call. TestHBaseFileSystem and HBaseTestingUtility use that.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;HBaseConfig.create() you introduce a singleton on the configuration,&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Hmm, I thought it is done in trunk. Will look into that. But yes, a separate jira.&lt;/p&gt;</comment>
                            <comment id="13625490" author="mbertozzi" created="Mon, 8 Apr 2013 16:06:36 +0000"  >&lt;p&gt;+1, v2 looks good to me.&lt;/p&gt;

&lt;p&gt;let me know the results of the the jenkins run&lt;/p&gt;</comment>
                            <comment id="13625567" author="v.himanshu" created="Mon, 8 Apr 2013 17:26:06 +0000"  >&lt;p&gt;Jenkins is good. One medium test, TestMetaReadeEditor failed, but when ran independently, it passes. Since it is a medium test, it is ok.&lt;/p&gt;</comment>
                            <comment id="13625575" author="mbertozzi" created="Mon, 8 Apr 2013 17:30:30 +0000"  >&lt;p&gt;Ok, if no other comments I&apos;m going to commit it in a couple of hours.&lt;/p&gt;</comment>
                            <comment id="13625626" author="ndimiduk" created="Mon, 8 Apr 2013 18:16:58 +0000"  >&lt;p&gt;Since use of the static block is purely performance, please add a comment saying as much. Otherwise, v2 looks good to me as well.&lt;/p&gt;</comment>
                            <comment id="13625653" author="v.himanshu" created="Mon, 8 Apr 2013 18:43:57 +0000"  >&lt;p&gt;Done. Thanks for the review guys.&lt;/p&gt;</comment>
                            <comment id="13625725" author="mbertozzi" created="Mon, 8 Apr 2013 19:53:00 +0000"  >&lt;p&gt;committed to 0.94. Thanks Himanshu for the patch and Nick for the review!&lt;/p&gt;</comment>
                            <comment id="13625939" author="hudson" created="Mon, 8 Apr 2013 22:56:31 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #951 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/951/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/951/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8288&quot; title=&quot;HBaseFileSystem: Refactoring and correct semantics for createPath methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8288&quot;&gt;&lt;del&gt;HBASE-8288&lt;/del&gt;&lt;/a&gt; HBaseFileSystem: Refactoring and correct semantics for createPath methods (Himanshu Vashishtha) (Revision 1465747)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
mbertozzi : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HBaseFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/backup/HFileArchiver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/cleaner/CleanerChore.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/DeleteTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKSplitLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/TestHBaseFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13626343" author="hudson" created="Tue, 9 Apr 2013 07:33:24 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #133 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/133/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/133/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8288&quot; title=&quot;HBaseFileSystem: Refactoring and correct semantics for createPath methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8288&quot;&gt;&lt;del&gt;HBASE-8288&lt;/del&gt;&lt;/a&gt; HBaseFileSystem: Refactoring and correct semantics for createPath methods (Himanshu Vashishtha) (Revision 1465747)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
mbertozzi : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HBaseFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/backup/HFileArchiver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/Reference.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/SplitLogManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/cleaner/CleanerChore.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/CreateTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/DeleteTableHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogSplitter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/util/FSTableDescriptors.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/util/FSUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKSplitLog.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/TestHBaseFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12577487" name="HBase-8288-v1.patch" size="9688" author="v.himanshu" created="Mon, 8 Apr 2013 05:44:43 +0000"/>
                            <attachment id="12577550" name="HBase-8288-v2.patch" size="47936" author="v.himanshu" created="Mon, 8 Apr 2013 15:53:59 +0000"/>
                            <attachment id="12577586" name="HBase-8288-v3.patch" size="48132" author="v.himanshu" created="Mon, 8 Apr 2013 18:43:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Apr 2013 09:30:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>321733</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 36 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jiev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322078</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>