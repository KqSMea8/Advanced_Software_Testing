<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:30:15 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5711/HBASE-5711.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5711] Tests are failing with incorrect data directory permissions.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5711</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When we run some tests in Hbase (TestAdmin), it is failing with following error.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Starting DataNode 0 with dfs.data.dir: E:\Repositories\Hbase\target\test-data\5ff23198-892e-4f1c-8022-b3d9969fcf0b\dfscluster_0ecc6984-1925-4870-ac7c-439fceede4cb\dfs\data\data1,E:\Repositories\Hbase\target\test-data\5ff23198-892e-4f1c-8022-b3d9969fcf0b\dfscluster_0ecc6984-1925-4870-ac7c-439fceede4cb\dfs\data\data2&lt;br/&gt;
2012-04-04 18:04:51,036 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; impl.MetricsSystemImpl(137): Metrics system not started: Cannot locate configuration: tried hadoop-metrics2-datanode.properties, hadoop-metrics2.properties&lt;br/&gt;
2012-04-04 18:04:51,255 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; datanode.DataNode(1548): Invalid directory in dfs.data.dir: Incorrect permission for E:/Repositories/Hbase/target/test-data/5ff23198-892e-4f1c-8022-b3d9969fcf0b/dfscluster_0ecc6984-1925-4870-ac7c-439fceede4cb/dfs/data/data1, expected: rwxr-xr-x, while actual: rwx------&lt;br/&gt;
2012-04-04 18:04:51,411 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; datanode.DataNode(1548): Invalid directory in dfs.data.dir: Incorrect permission for E:/Repositories/Hbase/target/test-data/5ff23198-892e-4f1c-8022-b3d9969fcf0b/dfscluster_0ecc6984-1925-4870-ac7c-439fceede4cb/dfs/data/data2, expected: rwxr-xr-x, while actual: rwx------&lt;br/&gt;
2012-04-04 18:04:51,411 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; datanode.DataNode(1554): All directories in dfs.data.dir are invalid.&lt;br/&gt;
2012-04-04 18:04:51,411 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; hbase.HBaseTestingUtility(684): Shutting down minicluster&lt;br/&gt;
2012-04-04 18:04:51,646 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; hbase.HBaseTestingUtility(696): Failed delete of E:\Repositories\Hbase\target\test-data\5ff23198-892e-4f1c-8022-b3d9969fcf0b\dfscluster_0ecc6984-1925-4870-ac7c-439fceede4cb&lt;br/&gt;
2012-04-04 18:04:51,646 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; hbase.HBaseTestingUtility(700): Minicluster is down&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12549494">HBASE-5711</key>
            <summary>Tests are failing with incorrect data directory permissions.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="umamaheswararao">Uma Maheswara Rao G</assignee>
                                    <reporter username="umamaheswararao">Uma Maheswara Rao G</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Apr 2012 12:39:05 +0000</created>
                <updated>Thu, 12 Jul 2012 03:48:57 +0000</updated>
                                                            <fixVersion>0.92.3</fixVersion>
                                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13246219" author="umamaheswararao" created="Wed, 4 Apr 2012 12:41:29 +0000"  >&lt;p&gt;looks like we have to set &quot;dfs.datanode.data.dir.perm&quot; to 700.&lt;/p&gt;

&lt;p&gt;Tests are running properly after setting this property in cluster conf.&lt;/p&gt;</comment>
                            <comment id="13246530" author="umamaheswararao" created="Wed, 4 Apr 2012 18:12:48 +0000"  >&lt;p&gt;Attached simple patch, which sets the permission to dfs data directories with 700.&lt;/p&gt;</comment>
                            <comment id="13246532" author="umamaheswararao" created="Wed, 4 Apr 2012 18:13:33 +0000"  >&lt;p&gt;@Ram, could you please take a look?&lt;/p&gt;</comment>
                            <comment id="13246557" author="hadoopqa" created="Wed, 4 Apr 2012 18:30:37 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12521350/HBASE-5711.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12521350/HBASE-5711.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.coprocessor.TestRowProcessorEndpoint&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1388//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1388//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1388//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1388//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1388//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1388//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13246998" author="ram_krish" created="Thu, 5 Apr 2012 04:04:55 +0000"  >&lt;p&gt;+1 on patch.  This patch is needed so that test cases can be run locally.&lt;br/&gt;
Thanks Uma for the patch.&lt;/p&gt;</comment>
                            <comment id="13247554" author="lewismc" created="Thu, 5 Apr 2012 19:22:55 +0000"  >&lt;p&gt;We do not see the ERROR but certainly see the WARN&apos;s when using HBaseTestingUtility across MR in our Apache Gora tests &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;. We see many &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
12/04/05 16:56:05 WARN impl.MetricsSystemImpl: Metrics system not started: Cannot locate configuration: tried hadoop-metrics2-namenode.properties, hadoop-metrics2.properties
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://svn.apache.org/viewvc/gora/trunk/gora-hbase/src/test/java/org/apache/gora/hbase/GoraHBaseTestDriver.java?view=markup&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/viewvc/gora/trunk/gora-hbase/src/test/java/org/apache/gora/hbase/GoraHBaseTestDriver.java?view=markup&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13247568" author="umamaheswararao" created="Thu, 5 Apr 2012 19:42:00 +0000"  >&lt;p&gt;@Ram, Thanks a lot for review!&lt;/p&gt;

&lt;p&gt;@Lewis, this is filed for permissions related problem. Unfortunately trace contains this warning as well. Not for metrics system warning. I think, if you are not looking for any metrics, you need not worry about that warning.&lt;/p&gt;</comment>
                            <comment id="13247575" author="lewismc" created="Thu, 5 Apr 2012 19:46:20 +0000"  >&lt;p&gt;My apologies, I found it elsewhere &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4709&quot; title=&quot;Hadoop metrics2 setup in test MiniDFSClusters spewing JMX errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4709&quot;&gt;&lt;del&gt;HBASE-4709&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13247665" author="hudson" created="Thu, 5 Apr 2012 21:04:25 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #158 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/158/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/158/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions. (Revision 1310050)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13247720" author="hudson" created="Thu, 5 Apr 2012 21:42:07 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2715 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2715/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2715/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions. (Revision 1310050)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13247725" author="hudson" created="Thu, 5 Apr 2012 21:43:19 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #356 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/356/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/356/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions. (Revision 1310053)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13247732" author="hudson" created="Thu, 5 Apr 2012 21:46:12 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #90 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/90/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/90/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions. (Revision 1310051)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13247742" author="zhihyu@ebaysf.com" created="Thu, 5 Apr 2012 21:54:00 +0000"  >&lt;p&gt;@ 04/Apr/12 18:30, TestRowProcessorEndpoint was reported by Hadoop QA to fail.&lt;/p&gt;

&lt;p&gt;After I reverted the patch, TestRowProcessorEndpoint passed on trunk.&lt;/p&gt;</comment>
                            <comment id="13247752" author="stack" created="Thu, 5 Apr 2012 22:06:45 +0000"  >&lt;p&gt;Yeah, just noticed this myself trying another fix.  Reverted from trunk and 0.94.&lt;/p&gt;</comment>
                            <comment id="13247757" author="zhihyu@ebaysf.com" created="Thu, 5 Apr 2012 22:12:43 +0000"  >&lt;p&gt;Thanks for the quick response.&lt;/p&gt;

&lt;p&gt;What about 0.92 ?&lt;/p&gt;</comment>
                            <comment id="13247765" author="stack" created="Thu, 5 Apr 2012 22:17:08 +0000"  >&lt;p&gt;Done.  Thanks for reminder.&lt;/p&gt;</comment>
                            <comment id="13247821" author="hudson" created="Thu, 5 Apr 2012 23:10:32 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2716 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2716/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2716/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; RE-REVERT (Revision 1310102)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; OVER-REVERTED; UNDOING LAST COMMIT (Revision 1310097)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; REVERT (Revision 1310095)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/TestZooKeeper.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/TestZooKeeper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13247843" author="hudson" created="Thu, 5 Apr 2012 23:31:13 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #91 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/91/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/91/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; RE-REVERT (Revision 1310101)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13247877" author="hudson" created="Fri, 6 Apr 2012 00:09:57 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #357 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/357/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/357/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; REVERT (Revision 1310107)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13247923" author="jmhsieh" created="Fri, 6 Apr 2012 00:58:46 +0000"  >&lt;p&gt;I&apos;ve been working around this by setting &apos;umask 022&apos; in my shell before executing tests/eclipse, etc.&lt;/p&gt;</comment>
                            <comment id="13247995" author="hudson" created="Fri, 6 Apr 2012 03:29:14 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #159 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/159/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/159/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; RE-REVERT (Revision 1310102)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; OVER-REVERTED; UNDOING LAST COMMIT (Revision 1310097)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; REVERT (Revision 1310095)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/TestZooKeeper.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKUtil.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/TestZooKeeper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13248037" author="ram_krish" created="Fri, 6 Apr 2012 04:27:48 +0000"  >&lt;p&gt;Surprising that the tests are failing.  Without the patch we get nullpointer exception and the stack trace saying invalid directories.&lt;/p&gt;

&lt;p&gt;With patch we are able to run the tests cleanly. &lt;/p&gt;</comment>
                            <comment id="13248074" author="umamaheswararao" created="Fri, 6 Apr 2012 05:28:17 +0000"  >&lt;p&gt;Strange....I ran several times this tests, passes for me. Still tests are failing without this patch. Let me check again, if I get some clue.&lt;/p&gt;

&lt;p&gt;@Jon&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I&apos;ve been working around this by setting &apos;umask 022&apos; in my shell before executing tests/eclipse, etc.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We are woking on windows/eclipse for dev env. Where exactly you are modifying this to take effect in eclipse execution?  I guess your dev env might be linux?&lt;/p&gt;</comment>
                            <comment id="13248087" author="jmhsieh" created="Fri, 6 Apr 2012 05:45:10 +0000"  >&lt;p&gt;@Uma &lt;br/&gt;
Yeah, I&apos;m a linux+eclipse guy for dev environment &amp;#8211; it is just in scripts for running tests or in my login script before I kick off eclipse.  I think I answered question on the mailing list about this the person came back saying they were in windows as well.&lt;/p&gt;</comment>
                            <comment id="13248100" author="ram_krish" created="Fri, 6 Apr 2012 05:56:21 +0000"  >&lt;p&gt;@Jon&lt;br/&gt;
It was me who sent that mail in the mailing list.&lt;/p&gt;</comment>
                            <comment id="13248106" author="lhofhansl" created="Fri, 6 Apr 2012 06:00:42 +0000"  >&lt;p&gt;We had this problem forever. I posted a message on this to the mailing on October 27th.&lt;br/&gt;
This is not in the way of an RC1 for 0.94.0.&lt;/p&gt;</comment>
                            <comment id="13249188" author="hudson" created="Sat, 7 Apr 2012 06:19:05 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #8 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/8/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/8/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; RE-REVERT (Revision 1310101)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions. (Revision 1310051)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13259514" author="hudson" created="Mon, 23 Apr 2012 11:00:50 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #105 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/105/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/105/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions &amp;#8211; REVERT (Revision 1310107)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5711&quot; title=&quot;Tests are failing with incorrect data directory permissions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5711&quot;&gt;HBASE-5711&lt;/a&gt; Tests are failing with incorrect data directory permissions. (Revision 1310053)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13412487" author="dave_revell" created="Thu, 12 Jul 2012 03:48:57 +0000"  >&lt;p&gt;Here&apos;s a workaround for people running into permission problems while embedding a minicluster.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;            hbaseTestUtil = new HBaseTestingUtility();

            // Workaround for HBASE-5711, we need to set config value dfs.datanode.data.dir.perm
            // equal to the permissions of the temp dirs on the filesystem. These temp dirs were
            // probably created using this process&apos; umask. So we guess the temp dir permissions as
            // 0777 &amp;amp; ~umask, and use that to set the config value.
            try {
                Process process = Runtime.getRuntime().exec(&quot;/bin/sh -c umask&quot;);
                BufferedReader br = new BufferedReader(new InputStreamReader(process.getInputStream()));
                int rc = process.waitFor();
                if(rc == 0) {
                    String umask = br.readLine();
    
                    int umaskBits = Integer.parseInt(umask, 8);
                    int permBits = 0777 &amp;amp; ~umaskBits;
                    String perms = Integer.toString(permBits, 8);
                    
                    log.info(&quot;Setting dfs.datanode.data.dir.perm to &quot; + perms);
                    hbaseTestUtil.getConfiguration().set(&quot;dfs.datanode.data.dir.perm&quot;, perms);
                } else {
                    log.warn(&quot;Failed running umask command in a shell, nonzero return value&quot;);
                }
            } catch (Exception e) {
                // ignore errors, we might not be running on POSIX, or &quot;sh&quot; might not be on the path
                log.warn(&quot;Couldn&apos;t get umask&quot;, e);
            }
            
            hbaseTestUtil.startMiniCluster();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12521350" name="HBASE-5711.patch" size="694" author="umamaheswararao" created="Wed, 4 Apr 2012 18:12:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 4 Apr 2012 18:30:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>234485</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 23 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02ckn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11638</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>