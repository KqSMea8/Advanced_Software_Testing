<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:25:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5138/HBASE-5138.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5138] [ref manual] Add a discussion on the number of regions</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5138</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;ntelford on IRC made the good point that we say people shouldn&apos;t have too many regions, but we don&apos;t say why. His problem currently is:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;09:21 &amp;lt; ntelford&amp;gt; problem is, if you&apos;re running MR jobs on a subset of that data, you need the regions to be as small as possible otherwise tasks don&apos;t get allocated in parallel much&lt;br/&gt;
09:22 &amp;lt; ntelford&amp;gt; so we&apos;ve found we have to strike a balance between keeping them small for MR and keeping them large for HBase to behave well&lt;br/&gt;
09:22 &amp;lt; ntelford&amp;gt; we erred on the side of smaller regions because our MR issues were more immediate - we couldn&apos;t find any documentation or anecdotal evidence as to why HBase doesn&apos;t like lots of regions&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The three main issues I can think of when having too many regions are:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;mslab requires 2mb per memstore (that&apos;s 2mb per family per region). 1000 regions that have 2 families each is 3.9GB of heap used, and it&apos;s not even storing data yet. NB: the 2MB value is configurable.&lt;/li&gt;
	&lt;li&gt;if you fill all the regions at somewhat the same rate, the global memory usage makes it that it forces tiny flushes when you have too many regions which in turn generates compactions. Rewriting the same data tens of times is the last thing you want. An example is filling 1000 regions (with one family) equally and let&apos;s consider a lower bound for global memstore usage of 5GB (the region server would have a big heap). Once it reaches 5GB it will force flush the biggest region, at that point they should almost all have about 5MB of data so it would flush that amount. 5MB inserted later, it would flush another region that will now have a bit over 5MB of data, and so on.&lt;/li&gt;
	&lt;li&gt;the new master is allergic to tons of regions, and will take a lot of time assigning them and moving them around in batches. The reason is that it&apos;s heavy on ZK usage, and it&apos;s not very async at the moment (could really be improved).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Another issue is the effect of the number of regions on mapreduce jobs. Keeping 5 regions per RS would be too low for a job, whereas 1000 will generate too many maps. This comes back to ntelford&apos;s problem of needing to scan portions of tables. To solve his problem, we discussed using a custom input format that generates many splits per region.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12537558">HBASE-5138</key>
            <summary>[ref manual] Add a discussion on the number of regions</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Jan 2012 18:14:41 +0000</created>
                <updated>Mon, 23 Sep 2013 18:31:11 +0000</updated>
                            <resolved>Sun, 20 Jan 2013 23:11:12 +0000</resolved>
                                                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13182117" author="stack" created="Sat, 7 Jan 2012 22:09:13 +0000"  >&lt;p&gt;+1 on nice doc.&lt;/p&gt;</comment>
                            <comment id="13558133" author="stack" created="Sun, 20 Jan 2013 00:03:31 +0000"  >&lt;p&gt;Making critical.  Lets get it in.  Its written.  Just need to add to refguide.&lt;/p&gt;</comment>
                            <comment id="13558182" author="lhofhansl" created="Sun, 20 Jan 2013 07:13:09 +0000"  >&lt;p&gt;There&apos;s also the fact that the memstores will be filled during write load, so with too many of them there&apos;ll be too much unnecessary flushing.&lt;/p&gt;</comment>
                            <comment id="13558183" author="lhofhansl" created="Sun, 20 Jan 2013 07:14:49 +0000"  >&lt;p&gt;Never mind, that&apos;s mentioned. &lt;/p&gt;</comment>
                            <comment id="13558186" author="lhofhansl" created="Sun, 20 Jan 2013 07:17:56 +0000"  >&lt;p&gt;We do not really say what we recommend, I.e how much memory for what amount of disk space.&lt;/p&gt;</comment>
                            <comment id="13558424" author="stack" created="Sun, 20 Jan 2013 23:11:12 +0000"  >&lt;p&gt;Committed the text under number of regions discussion that already exists in refguide in configuration section.&lt;/p&gt;</comment>
                            <comment id="13558456" author="hudson" created="Mon, 21 Jan 2013 00:18:47 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3771 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3771/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3771/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5138&quot; title=&quot;[ref manual] Add a discussion on the number of regions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5138&quot;&gt;&lt;del&gt;HBASE-5138&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;ref manual&amp;#93;&lt;/span&gt; Add a discussion on the number of regions (Revision 1435998)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/docbkx/configuration.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13558465" author="hudson" created="Mon, 21 Jan 2013 00:50:46 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #363 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/363/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/363/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5138&quot; title=&quot;[ref manual] Add a discussion on the number of regions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5138&quot;&gt;&lt;del&gt;HBASE-5138&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;ref manual&amp;#93;&lt;/span&gt; Add a discussion on the number of regions (Revision 1435998)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/docbkx/configuration.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13775292" author="stack" created="Mon, 23 Sep 2013 18:31:11 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 7 Jan 2012 22:09:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>223064</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hsuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101935</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>