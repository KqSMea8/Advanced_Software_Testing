<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:55:13 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14662/HBASE-14662.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14662] Fix NPE in HFileOutputFormat2</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14662</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When i dig in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14659&quot; title=&quot;Fix flakey TestHFileOutputFormat&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14659&quot;&gt;&lt;del&gt;HBASE-14659&lt;/del&gt;&lt;/a&gt;,  i run testWritingPEData. There are a lot of NPE thrown and testcase run a long time. &lt;/p&gt;

&lt;p&gt;The reason is that, in &lt;tt&gt;HFileOutputFormat2&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            HRegionLocation loc = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tableName = conf.get(OUTPUT_TABLE_NAME_CONF_KEY);

            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (Connection connection = ConnectionFactory.createConnection(conf);
                   RegionLocator locator =
                     connection.getRegionLocator(TableName.valueOf(tableName))) {
              loc = locator.getRegionLocation(rowKey);
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable e) {
              LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;there&apos;s something wrong when locating rowkey: &quot;&lt;/span&gt; +
                Bytes.toString(rowKey), e);
              loc = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because we did not set &lt;tt&gt;OUTPUT_TABLE_NAME_CONF_KEY&lt;/tt&gt;, So tableName is null,  So NPE thrown.&lt;/p&gt;

&lt;p&gt;And connection will be created which RegionLocator use to find region location. Because zk is not start in this testcase, So it will retry many times. &lt;/p&gt;

&lt;p&gt;But all this actions are not required,  we can skip create connection by check whether tableName is null&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12906481">HBASE-14662</key>
            <summary>Fix NPE in HFileOutputFormat2</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12906422">HBASE-14659</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chenheng">Heng Chen</assignee>
                                    <reporter username="chenheng">Heng Chen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Oct 2015 09:41:49 +0000</created>
                <updated>Thu, 22 Oct 2015 08:56:56 +0000</updated>
                            <resolved>Thu, 22 Oct 2015 04:54:40 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="14966556" author="chenheng" created="Wed, 21 Oct 2015 09:45:07 +0000"  >&lt;p&gt;With this patch,  testcase &lt;tt&gt;TestHFileOutputFormat.testWritingPEData&lt;/tt&gt; will run much more faster.&lt;/p&gt;</comment>
                            <comment id="14966790" author="hadoopqa" created="Wed, 21 Oct 2015 13:16:50 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12767763/HBASE-14662.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12767763/HBASE-14662.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 6e3b7af0efced7351163a5011a44bfc18851fce0.&lt;br/&gt;
  ATTACHMENT ID: 12767763&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16140//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16140//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16140//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16140//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16140//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16140//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16140//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16140//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14967405" author="stack" created="Wed, 21 Oct 2015 16:35:42 +0000"  >&lt;p&gt;That is a nice find. Are there times when table can be legitimately null?&lt;/p&gt;</comment>
                            <comment id="14967463" author="stack" created="Wed, 21 Oct 2015 17:02:24 +0000"  >&lt;p&gt;In other words, if no table, does it make sense that the creation of a record writer should succeed? Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chenheng&quot; class=&quot;user-hover&quot; rel=&quot;chenheng&quot;&gt;Heng Chen&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14968242" author="chenheng" created="Thu, 22 Oct 2015 00:23:51 +0000"  >&lt;blockquote&gt;
&lt;p&gt;In other words, if no table, does it make sense that the creation of a record writer should succeed? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This table is only help to locate region,  and the region location info is only help to do locality on HDFS in StoreFile.Writer,  &lt;br/&gt;
it is NOT necessary in local mode. &lt;/p&gt;

&lt;p&gt;So no matter this table exist or not,  record writer should succeed.&lt;/p&gt;</comment>
                            <comment id="14968555" author="stack" created="Thu, 22 Oct 2015 04:54:40 +0000"  >&lt;p&gt;Pushed to branch-1 and to master (doesn&apos;t seem to go back any further). Nice fix &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chenheng&quot; class=&quot;user-hover&quot; rel=&quot;chenheng&quot;&gt;Heng Chen&lt;/a&gt;  Agree with your reasoning. Thanks.&lt;/p&gt;</comment>
                            <comment id="14968693" author="hudson" created="Thu, 22 Oct 2015 07:25:02 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3 #289 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/289/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/289/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14662&quot; title=&quot;Fix NPE in HFileOutputFormat2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14662&quot;&gt;&lt;del&gt;HBASE-14662&lt;/del&gt;&lt;/a&gt; Fix NPE in HFileOutputFormat2 (Heng Chen) (stack: rev 35c34ba84e592353e49aa6568f4bdac4c208cae9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/HFileOutputFormat2.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14968805" author="hudson" created="Thu, 22 Oct 2015 08:44:42 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6937 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6937/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6937/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14662&quot; title=&quot;Fix NPE in HFileOutputFormat2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14662&quot;&gt;&lt;del&gt;HBASE-14662&lt;/del&gt;&lt;/a&gt; Fix NPE in HFileOutputFormat2 (Heng Chen) (stack: rev 81e2aba1f9bbe592d9d9284e701af5bedad3cd56)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/HFileOutputFormat2.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14968822" author="hudson" created="Thu, 22 Oct 2015 08:56:56 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #259 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/259/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/259/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14662&quot; title=&quot;Fix NPE in HFileOutputFormat2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14662&quot;&gt;&lt;del&gt;HBASE-14662&lt;/del&gt;&lt;/a&gt; Fix NPE in HFileOutputFormat2 (Heng Chen) (stack: rev 35c34ba84e592353e49aa6568f4bdac4c208cae9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/HFileOutputFormat2.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12767763" name="HBASE-14662.patch" size="2043" author="chenheng" created="Wed, 21 Oct 2015 09:45:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 21 Oct 2015 13:16:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 8 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2na1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>