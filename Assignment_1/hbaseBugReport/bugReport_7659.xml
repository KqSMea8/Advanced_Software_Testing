<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:47:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7659/HBASE-7659.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7659] add an option for timeout, rather than retry limit, in HCM</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7659</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Retry count limit is not the most useful user-facing measure for failing the request, especially multi-requests that currently fail if any one sub-action reaches the retry count. &lt;br/&gt;
Given the current deterministic implementation of retry count limit and deterministic (+-jitter) sleep time between retries, the user is already giving us an upper time bound for an operation to expire (with default 10 retries, around a minute).&lt;br/&gt;
We can make this explicit.&lt;br/&gt;
That will also make making retries smarter (e.g. retrying faster on certain errors) more easy.&lt;/p&gt;

&lt;p&gt;In future these things can be set per request, which can be usable for people using HBase directly from their code.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12629158">HBASE-7659</key>
            <summary>add an option for timeout, rather than retry limit, in HCM</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sershe">Sergey Shelukhin</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Jan 2013 21:51:00 +0000</created>
                <updated>Tue, 1 Sep 2015 17:50:13 +0000</updated>
                                                                            <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13564675" author="jdcryans" created="Mon, 28 Jan 2013 21:01:25 +0000"  >&lt;p&gt;How would this relate to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2937&quot; title=&quot;Facilitate Timeouts In HBase Client&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2937&quot;&gt;&lt;del&gt;HBASE-2937&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13564949" author="sershe" created="Tue, 29 Jan 2013 01:21:26 +0000"  >&lt;p&gt;Hmm, that is an interesting question. First, it only appears to apply to some operations inside HTable, and is not used for processBatchCallback at all.&lt;br/&gt;
Should processBatchCallback internally use it too?&lt;br/&gt;
Second, I wonder if we should switch HCM to it then and do away with explicit retry count? &lt;br/&gt;
For backward compat we can derive the time from existing retry count if timeout is not set, or use default timeout (derived from current default retries once, now) if none are set.&lt;/p&gt;</comment>
                            <comment id="13583751" author="sershe" created="Fri, 22 Feb 2013 00:43:32 +0000"  >&lt;p&gt;any opinions/objections?&lt;/p&gt;</comment>
                            <comment id="13587844" author="jdcryans" created="Wed, 27 Feb 2013 01:28:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should processBatchCallback internally use it too?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah I wonder why it&apos;s only used for a few methods... lost in the sea of patches?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Second, I wonder if we should switch HCM to it then and do away with explicit retry count? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We should.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;For backward compat we can derive the time from existing retry count if timeout is not set, or use default timeout (derived from current default retries once, now) if none are set.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good idea.&lt;/p&gt;</comment>
                            <comment id="13621307" author="nkeywal" created="Wed, 3 Apr 2013 20:53:21 +0000"  >&lt;p&gt;Each time I look at this JIRA, I think it&apos;s a good idea, but I can&apos;t see all the implications.&lt;/p&gt;

&lt;p&gt;So here are some randoms thought:&lt;br/&gt;
1) I think we can have two settings: a retry.count.min and a timeout. This way:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;people who wants the system to behave as it used to can set the retry min to the current retry limit and the timeout to +inf&lt;/li&gt;
	&lt;li&gt;people who fancies new stuff can use the timeout&lt;/li&gt;
	&lt;li&gt;the recommended setting would be at least 2 or 3 retries&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;2) Such scenarios should still be supported imho:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;client calls server S1. S1 is dead, so client waits until the socket timeout is raised (1 minute by default, sometimes more)&lt;/li&gt;
	&lt;li&gt;actually, while the client was waiting, the regions on S1 were moved to S2.&lt;/li&gt;
	&lt;li&gt;client goes to .meta., .meta. says go to S2. Client is happy (while a single 1 minute timeout would have made it failed as it would not have done the second try)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;My fear here is the subcases of this one, when there is a major crash: may be .meta. moved, so the second try may fail while the third would do it.&lt;/p&gt;

&lt;p&gt;3) If we use a &quot;Future&quot; approach on top of the existing code, we may may leave running attempts in the system (i.e. we&apos;re still trying and holding resources, but nobody cares of the final result).&lt;/p&gt;

&lt;p&gt;4) When the system go crazy, it takes ~15 minutes to recover (it could be even more). The client code may not like it, but there is nothing much we can do. Typically, I think we could have two settings:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;insert it whatever the time it takes (critical data)&lt;/li&gt;
	&lt;li&gt;insert it if possible (lower value data like &apos;i like&apos; increment).&lt;br/&gt;
For this kind of functional segregation, the retry count could be enough: with 20 retries for the first category and 3 retries for the second one?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13702438" author="stack" created="Mon, 8 Jul 2013 21:19:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8896&quot; title=&quot;Refactor RetryCounter so it is generally useful&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8896&quot;&gt;HBASE-8896&lt;/a&gt; would help.  If we think so, lets get it reviewed and committed... then can start in on this issue w/ it as basis.  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8896&quot; title=&quot;Refactor RetryCounter so it is generally useful&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8896&quot;&gt;HBASE-8896&lt;/a&gt; is facility for putting upper bound on the retries after which we no longer progress.  My thought is that we should ramp up to retries every ten seconds or so so that we find regions soon after the come back on line.  More than ten seconds and it hurts our MTTR.  Less and we are piling on the poor recovering servers.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 28 Jan 2013 21:01:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>309002</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 23 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1dybz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>289659</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>