<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:43:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7243/HBASE-7243.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7243] Test for creating a large number of regions</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7243</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;After &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7220&quot; title=&quot;Creating a table with 3000 regions on 2 nodes fails after 1 hour&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7220&quot;&gt;&lt;del&gt;HBASE-7220&lt;/del&gt;&lt;/a&gt;, I think it will be good to write a unit test/IT to create a large number of regions. We can put a reasonable timeout to the test. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12618261">HBASE-7243</key>
            <summary>Test for creating a large number of regions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ndimiduk">Nick Dimiduk</assignee>
                                    <reporter username="enis">Enis Soztutar</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Nov 2012 02:13:41 +0000</created>
                <updated>Tue, 5 Aug 2014 20:11:36 +0000</updated>
                            <resolved>Wed, 12 Dec 2012 23:35:45 +0000</resolved>
                                                    <fixVersion>0.95.0</fixVersion>
                                    <component>Region Assignment</component>
                    <component>regionserver</component>
                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13507251" author="nkeywal" created="Fri, 30 Nov 2012 10:32:50 +0000"  >&lt;p&gt;+1. You don&apos;t mention it, but it should be be an integration test, no?&lt;/p&gt;</comment>
                            <comment id="13528330" author="ndimiduk" created="Mon, 10 Dec 2012 21:53:21 +0000"  >&lt;p&gt;Review posted: &lt;a href=&quot;https://reviews.apache.org/r/8447/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/8447/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13528343" author="sershe" created="Mon, 10 Dec 2012 22:07:23 +0000"  >&lt;p&gt;It&apos;s a good idea to attach patch to JIRA to have Hadoop QA run tests against it (and for posterity &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;)&lt;/p&gt;</comment>
                            <comment id="13528349" author="ndimiduk" created="Mon, 10 Dec 2012 22:12:35 +0000"  >&lt;p&gt;Patch available on &lt;a href=&quot;https://reviews.apache.org/r/8447/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/8447/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13528362" author="sershe" created="Mon, 10 Dec 2012 22:25:56 +0000"  >&lt;p&gt;Is 10 minutes an appropriate time for the minicluster? Seems like it should be much less. On real cluster the person executing the test would probably set the value appropriately.&lt;/p&gt;

&lt;p&gt;Why does the test need 2 region servers by default?&lt;/p&gt;

&lt;p&gt;Nit: not sure what the casing convention is, but fields like REGION_SERVER_COUNT appear to be constants when they aren&apos;t.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    util.initializeCluster(REGION_SERVER_COUNT);
      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cluster initialized&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Some spacing issues.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; HBaseAdmin admin;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;final?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
         LOG.info(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;Pre-split table created successfully in %sms.&quot;&lt;/span&gt;, (endTime - startTime)));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Not sure if it matters in Java... %s format for a long.&lt;/p&gt;</comment>
                            <comment id="13528385" author="ndimiduk" created="Mon, 10 Dec 2012 22:41:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; Running this integration test locally to create 3000 splits results in OOM. Can you recommend reasonable defaults on both this value and the timeout?&lt;/p&gt;</comment>
                            <comment id="13528464" author="ndimiduk" created="Mon, 10 Dec 2012 23:59:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why does the test need 2 region servers by default?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The test defined in this patch replicate the values defined by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7220&quot; title=&quot;Creating a table with 3000 regions on 2 nodes fails after 1 hour&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7220&quot;&gt;&lt;del&gt;HBASE-7220&lt;/del&gt;&lt;/a&gt;. The timeout is arbitrary.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Nit: not sure what the casing convention is, but fields like REGION_SERVER_COUNT appear to be constants when they aren&apos;t.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;These fields are effectively constant in that they&apos;re resolved via configuration. I&apos;m open to recommendations on formatting conventions.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Some spacing issues.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;final?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Not sure if it matters in Java... %s format for a long.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Java will call .toString() as appropriate. Switched to %d.&lt;/p&gt;

&lt;p&gt;Will upload a new patch once &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nkeywal&quot; class=&quot;user-hover&quot; rel=&quot;nkeywal&quot;&gt;Nicolas Liochon&lt;/a&gt; has an opportunity to chime in.&lt;/p&gt;</comment>
                            <comment id="13528482" author="eclark" created="Tue, 11 Dec 2012 00:15:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7220&quot; title=&quot;Creating a table with 3000 regions on 2 nodes fails after 1 hour&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7220&quot;&gt;&lt;del&gt;HBASE-7220&lt;/del&gt;&lt;/a&gt; didn&apos;t really need more than one region server.&lt;/p&gt;</comment>
                            <comment id="13528851" author="nkeywal" created="Tue, 11 Dec 2012 10:01:56 +0000"  >&lt;p&gt;Yep, 1 region server should be fast enough.&lt;br/&gt;
I think you could do the test with 1000 regions: it should push the system enough while being reliable in the results shown.&lt;br/&gt;
To determine the max time, I think there is no other way than trying and then add a 50% security. To lower variance, I personally use a ramdisk, but it&apos;s not something easy to generalize...&lt;br/&gt;
You can set a timeout in junit btw: @Test(timeout=10000)&lt;/p&gt;

&lt;p&gt;This patch will be very useful to detect errors sooner (and before go live &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</comment>
                            <comment id="13529294" author="ndimiduk" created="Tue, 11 Dec 2012 20:10:46 +0000"  >&lt;p&gt;Reducing this to a single regionserver with 1000 regions allows this test to execute within the memory constrains already imposed by the hbase-it/pom.xml. It completes pretty consistently in 150-200 secs on my laptop (no ramdisk).&lt;/p&gt;

&lt;p&gt;Using the @Test(timeout=...) feature is appealing because it simplifies the test logic considerably. However, only constant expressions are accepted as arguments to the @Test annotation. That means this setting cannot be altered by a local administrator who is also interested in tweaking the other values. For this reason, I&apos;ll retain the existing timer logic &amp;#8211; that is, unless there&apos;s a strong desire to remove configurability in general from this patch.&lt;/p&gt;</comment>
                            <comment id="13529319" author="ndimiduk" created="Tue, 11 Dec 2012 20:36:09 +0000"  >&lt;p&gt;Updated patch according to review comments.&lt;/p&gt;</comment>
                            <comment id="13530206" author="sershe" created="Wed, 12 Dec 2012 18:53:06 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13530264" author="enis" created="Wed, 12 Dec 2012 20:01:16 +0000"  >&lt;p&gt;Integration test class name should start with &quot;IntegrationTest&quot;, can you rename it: &lt;a href=&quot;http://hbase.apache.org/book/hbase.tests.html#integration.tests&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/book/hbase.tests.html#integration.tests&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="13530277" author="enis" created="Wed, 12 Dec 2012 20:09:43 +0000"  >&lt;p&gt;Also, can you interrupt the Worker thread on timeout? &lt;/p&gt;</comment>
                            <comment id="13530448" author="ndimiduk" created="Wed, 12 Dec 2012 22:41:27 +0000"  >&lt;p&gt;Done and done.&lt;/p&gt;</comment>
                            <comment id="13530455" author="ndimiduk" created="Wed, 12 Dec 2012 22:46:13 +0000"  >&lt;p&gt;Canceling request for first patch, which hasn&apos;t run yet.&lt;/p&gt;</comment>
                            <comment id="13530483" author="stack" created="Wed, 12 Dec 2012 23:25:40 +0000"  >&lt;p&gt;+1 from me too.  Will commit after hadoopqa run...&lt;/p&gt;</comment>
                            <comment id="13530487" author="stack" created="Wed, 12 Dec 2012 23:29:35 +0000"  >&lt;p&gt;Maybe hadoopqa is messing w/ us again and ain&apos;t running.  Let me commit this.  Usually we name patches w/ a version going forward: i.e. the third version has a v3 or something on it... FYI.&lt;/p&gt;</comment>
                            <comment id="13530490" author="ndimiduk" created="Wed, 12 Dec 2012 23:34:00 +0000"  >&lt;p&gt;Rgr. While you have your infra hat on: review board isn&apos;t posting notifications back to JIRA. Configuration bug?&lt;/p&gt;</comment>
                            <comment id="13530492" author="stack" created="Wed, 12 Dec 2012 23:35:45 +0000"  >&lt;p&gt;Committed to trunk.  Thanks Nick for the patch.&lt;/p&gt;</comment>
                            <comment id="13530651" author="hudson" created="Thu, 13 Dec 2012 03:55:42 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3616 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3616/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3616/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7243&quot; title=&quot;Test for creating a large number of regions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7243&quot;&gt;&lt;del&gt;HBASE-7243&lt;/del&gt;&lt;/a&gt; Test for creating a large number of regions (Revision 1421039)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-it/src/test/java/org/apache/hadoop/hbase/IntegrationTestManyRegions.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13530933" author="hudson" created="Thu, 13 Dec 2012 12:00:19 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #294 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/294/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/294/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7243&quot; title=&quot;Test for creating a large number of regions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7243&quot;&gt;&lt;del&gt;HBASE-7243&lt;/del&gt;&lt;/a&gt; Test for creating a large number of regions (Revision 1421039)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-it/src/test/java/org/apache/hadoop/hbase/IntegrationTestManyRegions.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13775176" author="stack" created="Mon, 23 Sep 2013 18:30:54 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12560663" name="7243-integration-test-many-splits.diff" size="6476" author="ndimiduk" created="Wed, 12 Dec 2012 22:41:27 +0000"/>
                            <attachment id="12560448" name="7243-integration-test-many-splits.diff" size="6320" author="ndimiduk" created="Tue, 11 Dec 2012 20:36:09 +0000"/>
                            <attachment id="12560291" name="7243-integration-test-many-splits.diff" size="6174" author="ndimiduk" created="Mon, 10 Dec 2012 22:12:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 30 Nov 2012 10:32:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>292891</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0sg87:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164106</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>