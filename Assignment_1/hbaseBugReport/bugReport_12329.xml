<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:31:58 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-12329/HBASE-12329.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-12329] Table create with duplicate column family names quietly succeeds</title>
                <link>https://issues.apache.org/jira/browse/HBASE-12329</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;From the mailing list&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I was expecting that it is forbidden, *&lt;b&gt;but&lt;/b&gt;* this call does not throw any&lt;br/&gt;
exception&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] families = {&lt;span class=&quot;code-quote&quot;&gt;&quot;cf&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;cf&quot;&lt;/span&gt;};
        HTableDescriptor desc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HTableDescriptor(name);
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; cf : families) {
          HColumnDescriptor coldef = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HColumnDescriptor(cf);
          desc.addFamily(coldef);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            admin.createTable(desc);
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (TableExistsException e) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;table \&apos;&quot;&lt;/span&gt; + name + &lt;span class=&quot;code-quote&quot;&gt;&quot;\&apos; already exists&quot;&lt;/span&gt;);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;

&lt;p&gt;And Ted&apos;s follow up replicates in the shell&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hbase(main):001:0&amp;gt; create &apos;t2&apos;, {NAME =&amp;gt; &apos;f1&apos;}, {NAME =&amp;gt; &apos;f1&apos;}

The table got created - with 1 column family:

hbase(main):002:0&amp;gt; describe &apos;t2&apos;
DESCRIPTION
                       ENABLED
 &apos;t2&apos;, {NAME =&amp;gt; &apos;f1&apos;, DATA_BLOCK_ENCODING =&amp;gt; &apos;NONE&apos;, BLOOMFILTER =&amp;gt; &apos;ROW&apos;,
REPLICATION_SCOPE =&amp;gt; &apos;0 &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
 &apos;, VERSIONS =&amp;gt; &apos;1&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, MIN_VERSIONS =&amp;gt; &apos;0&apos;, TTL =&amp;gt;
&apos;2147483647&apos;, KEEP_DELETED
 _CELLS =&amp;gt; &apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;, BLOCKSIZE =&amp;gt; &apos;65536&apos;, IN_MEMORY =&amp;gt; &apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;, BLOCKCACHE
=&amp;gt; &apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;}
1 row(s) in 0.1000 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12750084">HBASE-12329</key>
            <summary>Table create with duplicate column family names quietly succeeds</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jingcheng.du@intel.com">Jingcheng Du</assignee>
                                    <reporter username="busbey">Sean Busbey</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Oct 2014 15:06:53 +0000</created>
                <updated>Sat, 21 Feb 2015 23:45:33 +0000</updated>
                            <resolved>Thu, 6 Nov 2014 01:41:05 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>0.99.2</fixVersion>
                                    <component>Client</component>
                    <component>shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="14181434" author="busbey" created="Thu, 23 Oct 2014 15:09:47 +0000"  >&lt;p&gt;I&apos;d be curious what happens if you give different per-CF options.&lt;/p&gt;

&lt;p&gt;It might be safe to just issue a WARN in the shell case and have the call to ``desc.addFamily`` throw. Opinions?&lt;/p&gt;</comment>
                            <comment id="14182381" author="jingcheng.du@intel.com" created="Fri, 24 Oct 2014 03:34:24 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;, can I work on this?&lt;/p&gt;</comment>
                            <comment id="14182423" author="busbey" created="Fri, 24 Oct 2014 04:33:41 +0000"  >&lt;p&gt;yes, please do! I&apos;d be happy to provide a review when you have something.&lt;/p&gt;</comment>
                            <comment id="14182606" author="jingcheng.du@intel.com" created="Fri, 24 Oct 2014 08:57:02 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;, I&apos;m thinking how to differentiate the operations createTable and modifyTable.&lt;br/&gt;
In the modifyTable, users fetch the htd from the admin.getTableDescriptor which has all the existing hcds, in this case, it&apos;s allowed to add a new column to replace the old one by using htd.addFamily whereas in createTable it&apos;s not allowed. They&apos;re contrary, we need to know the HBaseAdmin ops(create or modify) in the HCD which is not reasonable.&lt;br/&gt;
I think this JIRA won&apos;t be a problem, users should be aware that if they add duplicated columns into the htd, the latter one will replace the former one.&lt;br/&gt;
What&apos;s your opinion one this? Please advise. Thanks.&lt;/p&gt;</comment>
                            <comment id="14182836" author="busbey" created="Fri, 24 Oct 2014 14:31:16 +0000"  >&lt;p&gt;I&apos;d say add a new method for the update case (setFamily? updateFamily?) and have the modify call use that.&lt;/p&gt;

&lt;p&gt;We&apos;ll need to release note the change in behavior. Even though the API is flagged as Evolving we&apos;re probably best off saving the exception throwing for 2.0 and doing a warning cycle. That&apos;d mean getting the new method and a javadoc warning (about how it will be an error and how last-write-wins right now) into branch-1 and maybe 0.98. The shell can warn in all versions.&lt;/p&gt;</comment>
                            <comment id="14186528" author="jingcheng.du@intel.com" created="Tue, 28 Oct 2014 07:44:30 +0000"  >&lt;p&gt;Upload the first patch.&lt;br/&gt;
1. Warn the usage in the comments of the addFamily.&lt;br/&gt;
2. Add the updateFamily in HTableDescriptor.&lt;br/&gt;
3. Add warn for create operation with duplicate families in hbase shell.&lt;br/&gt;
Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;, could you please help look at it. Thanks.&lt;/p&gt;</comment>
                            <comment id="14186745" author="busbey" created="Tue, 28 Oct 2014 12:14:34 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;org.apache.hadoop.hbase.client.UnmodifyableHTableDescriptor needs to be updated to add the new method.&lt;/li&gt;
	&lt;li&gt;needs unit tests that verify expected behavior for the update method and handling of duplicate addFamily calls&lt;/li&gt;
	&lt;li&gt;either update the API example in the ref guide (currently Example 10.2) to show &quot;update an existing CF&quot; or file a follow on ticket that such docs are needed&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   /**
    * Adds a column family.
+   * If multiple families with the same name are added, only the last one will be saved.
+   * For the updating purpose please use {@link #updateFamily(HColumnDescriptor)} instead.
    * @param family HColumnDescriptor of family to add.
    */
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; HTableDescriptor addFamily(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HColumnDescriptor family) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since the initial patch targets master, instead of having the &quot;last one wins&quot; warning have the method throw on duplicates. We&apos;ll leave a note here on the jira for the committer to replace that behavior on backport with a warning about last one wins and the throwing in a future version.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * Updates the existing column family.
+   * @param family HColumnDescriptor of family to update
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; chained invocation)
+   */
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; HTableDescriptor updateFamily(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HColumnDescriptor family) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Consider naming the method &lt;tt&gt;modifyFamily&lt;/tt&gt; to match o.a.h.h.client.Admin.modifyColumn&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (family.getName() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || family.getName().length &amp;lt;= 0) {
+      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; NullPointerException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Family name cannot be &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; or empty&quot;&lt;/span&gt;);
+    }
+
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;when the string is empty, throw an IllegalArgumentException.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          # Warn &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; duplicate columns are added
+          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; htd.hasFamily(descriptor.getName)
+            puts &lt;span class=&quot;code-quote&quot;&gt;&quot;Family &apos;&quot;&lt;/span&gt; + descriptor.getNameAsString() + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos; already exists, the old one will be replaced&quot;&lt;/span&gt;
+          end
+          htd.addFamily(descriptor)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use htd the way we are updating the API to suggest people use it: use updateFamily after warning, only use addFamily when it won&apos;t be an update.&lt;/p&gt;</comment>
                            <comment id="14189726" author="jingcheng.du@intel.com" created="Thu, 30 Oct 2014 07:06:47 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt; for the review, will submit another patch soon.&lt;/p&gt;</comment>
                            <comment id="14191779" author="jingcheng.du@intel.com" created="Fri, 31 Oct 2014 13:17:49 +0000"  >&lt;p&gt;The latest patch is uploaded.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;either update the API example in the ref guide (currently Example 10.2) to show &quot;update an existing CF&quot; or file a follow on ticket that such docs are needed&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think it&apos;s better to be done by Misty for the ref guide? &lt;br/&gt;
Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=misty&quot; class=&quot;user-hover&quot; rel=&quot;misty&quot;&gt;Misty Stanley-Jones&lt;/a&gt;, do you want to update the ref guide(currently Example 10.2 to show &quot;update an existing CF&quot; with the new API modifyFamily in master) after this JIRA is committed? Thanks a lot!&lt;/p&gt;

&lt;p&gt;Hi all, please be noted, this patch is targeted to master. If it&apos;s backported to lower versions, should have the &quot;last one wins&quot; warning in addFamily method instead of throwing a runtime exception.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="14191840" author="busbey" created="Fri, 31 Oct 2014 14:22:55 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I think it&apos;s better to be done by Misty for the ref guide? &lt;br/&gt;
Hi, Misty Stanley-Jones, do you want to update the ref guide(currently Example 10.2 to show &quot;update an existing CF&quot; with the new API modifyFamily in master) after this JIRA is committed? Thanks a lot!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Please file as a follow on ticket. If Misty wants to take it up, then she can. Otherwise someone else can do it.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  @Test
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testModifyFamily() {
+    HTableDescriptor htd = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HTableDescriptor(TableName.valueOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;table&quot;&lt;/span&gt;));
+    &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] familyName = Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;cf&quot;&lt;/span&gt;);
+    HColumnDescriptor hcd = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HColumnDescriptor(familyName);
+    hcd.setBlocksize(1000);
+    htd.addFamily(hcd);
+    assertEquals(1000, htd.getFamily(familyName).getBlocksize());
+    hcd.setBlocksize(2000);
+    htd.modifyFamily(hcd);
+    assertEquals(2000, htd.getFamily(familyName).getBlocksize());
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Make a second HColumnDescriptor for the update to make sure we&apos;re not just mutating state on an old version in the htd.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  @Test
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testModifyInexistentFamily() {
+    HTableDescriptor htd = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HTableDescriptor(TableName.valueOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;table&quot;&lt;/span&gt;));
+    &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] familyName = Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;cf&quot;&lt;/span&gt;);
+    HColumnDescriptor hcd = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HColumnDescriptor(familyName);
+    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; hasException = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+      htd.modifyFamily(hcd);
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
+      hasException = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    }
+    assertTrue(hasException);
+  }
+
+  @Test
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testAddDuplicateFamilies() {
+    HTableDescriptor htd = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HTableDescriptor(TableName.valueOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;table&quot;&lt;/span&gt;));
+    &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] familyName = Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;cf&quot;&lt;/span&gt;);
+    HColumnDescriptor hcd = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HColumnDescriptor(familyName);
+    hcd.setBlocksize(1000);
+    htd.addFamily(hcd);
+    assertEquals(1000, htd.getFamily(familyName).getBlocksize());
+    hcd.setBlocksize(2000);
+    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; hasException = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+      htd.addFamily(hcd);
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
+      hasException = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    }
+    assertTrue(hasException);
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use the &lt;tt&gt;@Test(expected=IllegalArgumentException.class)&lt;/tt&gt; form for both of these instead.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (htd.hasFamily(hcd.getName())) {
+      htd.modifyFamily(hcd);
+    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
+      htd.addFamily(hcd);
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m just thinking out loud here, but do we think this is going to be a common idiom? Should we add a third method &quot;setFamily&quot; that behaves like the old add?&lt;/p&gt;</comment>
                            <comment id="14192082" author="jingcheng.du@intel.com" created="Fri, 31 Oct 2014 17:10:28 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt; for the review.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Please file as a follow on ticket. If Misty wants to take it up, then she can. Otherwise someone else can do it.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sure, will create a follow on jira.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Should we add a third method &quot;setFamily&quot; that behaves like the old add?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If it&apos;s added, does it imply such an operation (add or update in one method) is allowed, and users should be aware of &quot;last one wins&quot; at that time? If so why do we re-implement addFamily and add modifyFamily? The existing addFamily is enough. Is it?&lt;/p&gt;</comment>
                            <comment id="14192097" author="busbey" created="Fri, 31 Oct 2014 17:16:36 +0000"  >&lt;blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Should we add a third method &quot;setFamily&quot; that behaves like the old add?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If it&apos;s added, does it imply such an operation (add or update in one method) is allowed, and users should be aware of &quot;last one wins&quot; at that time? If so why do we re-implement addFamily and add modifyFamily? The existing addFamily is enough. Is it?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s API semantics. &quot;addXXX&quot; means to put something new in, &quot;modifyXXX&quot; means to update something already present. &quot;setXXX&quot; is used in other places to mean &quot;add or update&quot;, knowledge of &quot;last write wins&quot; is already baked into the naming.&lt;/p&gt;</comment>
                            <comment id="14192100" author="busbey" created="Fri, 31 Oct 2014 17:17:45 +0000"  >&lt;p&gt;Thinking through things more, let&apos;s skip the third method. We can always add it later if the idiom shows up often downstream. Once it&apos;s there removing it is hard.&lt;/p&gt;</comment>
                            <comment id="14192145" author="busbey" created="Fri, 31 Oct 2014 17:41:59 +0000"  >&lt;p&gt;+1 pending QA.&lt;/p&gt;

&lt;p&gt;applies cleanly, ran through the tests altered by the patch.&lt;/p&gt;

&lt;p&gt;switching to &quot;Patch Available&quot; to get a QA run.&lt;/p&gt;</comment>
                            <comment id="14192324" author="hadoopqa" created="Fri, 31 Oct 2014 19:39:59 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12678501/HBASE-12329-V3.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12678501/HBASE-12329-V3.diff&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12678501&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-rest.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11546//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14192361" author="busbey" created="Fri, 31 Oct 2014 20:01:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jingcheng.du%40intel.com&quot; class=&quot;user-hover&quot; rel=&quot;jingcheng.du@intel.com&quot;&gt;Jingcheng Du&lt;/a&gt; please link the follow on jira for the docs change to this issue once it&apos;s been created.&lt;/p&gt;</comment>
                            <comment id="14194291" author="jingcheng.du@intel.com" created="Mon, 3 Nov 2014 06:15:14 +0000"  >&lt;p&gt;Sure, thanks.&lt;br/&gt;
The follow on JIRA is created, it&apos;s &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12412&quot; title=&quot;update the ref guide(currently Example 10.2) to show &amp;quot;update an existing CF&amp;quot; with the new API modifyFamily in master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12412&quot;&gt;&lt;del&gt;HBASE-12412&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14199584" author="stack" created="Thu, 6 Nov 2014 01:41:05 +0000"  >&lt;p&gt;Applied to branch-1+  Cherry-pick to 0.98 didn&apos;t work. Tests failed and in HTD, complaint was on test compile&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.5.1:compile (default-compile) on project hbase-client: Compilation failure&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; /Users/stack/checkouts/hbase.git.commit/hbase-client/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;791,11&amp;#93;&lt;/span&gt; error: cannot return a value from method whose result type is void&lt;/p&gt;
</comment>
                            <comment id="14199586" author="stack" created="Thu, 6 Nov 2014 01:41:35 +0000"  >&lt;p&gt;Thanks for patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jingchengdu&quot; class=&quot;user-hover&quot; rel=&quot;jingchengdu&quot;&gt;JingchengDu&lt;/a&gt; (and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt; for reviews)&lt;/p&gt;</comment>
                            <comment id="14199691" author="hudson" created="Thu, 6 Nov 2014 02:58:01 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.0 #437 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/437/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/437/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12329&quot; title=&quot;Table create with duplicate column family names quietly succeeds&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12329&quot;&gt;&lt;del&gt;HBASE-12329&lt;/del&gt;&lt;/a&gt; Table create with duplicate column family names quietly succeeds (Jingcheng Du) (stack: rev 15f96c7a00cceb92b797d852b4c95893e0077ba1)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/client/UnmodifyableHTableDescriptor.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestRowTooBig.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/SnapshotTestingUtils.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide3.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;hbase-shell/src/main/ruby/hbase/admin.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14199708" author="hudson" created="Thu, 6 Nov 2014 03:26:58 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #5749 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5749/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5749/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12329&quot; title=&quot;Table create with duplicate column family names quietly succeeds&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12329&quot;&gt;&lt;del&gt;HBASE-12329&lt;/del&gt;&lt;/a&gt; Table create with duplicate column family names quietly succeeds (Jingcheng Du) (stack: rev c71244c02dd7a39443c4e60d3b02413cac59dc42)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/filter/TestFilter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide3.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/test/java/org/apache/hadoop/hbase/TestHTableDescriptor.java&lt;/li&gt;
	&lt;li&gt;hbase-shell/src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestRowTooBig.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/SnapshotTestingUtils.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/HTableDescriptor.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/client/UnmodifyableHTableDescriptor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14331640" author="enis" created="Sat, 21 Feb 2015 23:45:33 +0000"  >&lt;p&gt;Closing this issue after 0.99.2 release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12752368">HBASE-12412</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12678466" name="HBASE-12329-V2.diff" size="11543" author="jingcheng.du@intel.com" created="Fri, 31 Oct 2014 13:17:49 +0000"/>
                            <attachment id="12678501" name="HBASE-12329-V3.diff" size="11431" author="jingcheng.du@intel.com" created="Fri, 31 Oct 2014 17:14:46 +0000"/>
                            <attachment id="12677551" name="HBASE-12329.diff" size="2591" author="jingcheng.du@intel.com" created="Tue, 28 Oct 2014 07:44:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 24 Oct 2014 03:34:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21i0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tables created with duplicate column family names use to succeed silently.  This removes fix removes ambiguity and will change the behavior of code that depended upon this behavior.  Instead of just using addFamil, a change to the CF definition now requires a modifyFamily call.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>