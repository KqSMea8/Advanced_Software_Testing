<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:52:04 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1261/HBASE-1261.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1261] Improvements to flushing, compacting, and splitting</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1261</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This issue concludes my task for GSoC 2009 &lt;br/&gt;
The idea is to make all futures from Bigtable paper and other ideas in this processes of to flushing, compacting and splitting.&lt;/p&gt;

&lt;p&gt;Some talk in IRC related to this issue creation:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;22:37&amp;#93;&lt;/span&gt; &amp;lt;jgray2&amp;gt; bigtable has an optimization which, when flushing the memcache, will actually write out a new storefile that merges the existing storefile with the memcache&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;22:37&amp;#93;&lt;/span&gt; &amp;lt;jgray2&amp;gt; that way you don&apos;t have more than one storefile&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;22:37&amp;#93;&lt;/span&gt; &amp;lt;jgray2&amp;gt; which is a huge inefficiency&lt;/p&gt;</description>
                <environment></environment>
        <key id="12416866">HBASE-1261</key>
            <summary>Improvements to flushing, compacting, and splitting</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apparition">Evgeny Ryabitskiy</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Mar 2009 19:58:34 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:28 +0000</updated>
                            <resolved>Tue, 21 Jul 2009 05:27:52 +0000</resolved>
                                    <version>0.19.0</version>
                                    <fixVersion>0.20.0</fixVersion>
                                    <component>documentation</component>
                    <component>master</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                            <comments>
                            <comment id="12683607" author="stack" created="Thu, 19 Mar 2009 20:52:07 +0000"  >&lt;p&gt;I added this issue up here: &lt;a href=&quot;http://wiki.apache.org/general/SummerOfCode2009&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/general/SummerOfCode2009&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12702616" author="erikholstad@gmail.com" created="Fri, 24 Apr 2009 23:19:00 +0000"  >&lt;p&gt;wo types of compactions, minor and major.&lt;br/&gt;
Tasks that can be performed during a compaction:&lt;br/&gt;
1. Sorting the KeyValue from the different file&lt;br/&gt;
2. Checking TTL&lt;br/&gt;
3. Checking number of versions to keep&lt;br/&gt;
4. Removing KeyValues that are effected by deletes&lt;br/&gt;
5. Removing the deletes&lt;/p&gt;

&lt;p&gt;For a major compaction all of the above is done, so the question is what we&lt;br/&gt;
should do for a minor. &lt;/p&gt;

&lt;p&gt;The thing is that when merging the different files into one list we need to sort&lt;br/&gt;
the smallest entry in all the files to be able to tell which one to put in first&lt;br/&gt;
,which means that we already are doing most of the work. So adding 2,3 and 4&lt;br/&gt;
will only add 3 extra checks, but will probably give better performance in the&lt;br/&gt;
system in total, but needs to be tested. The deletes can&apos;t be removes for a non&lt;br/&gt;
major compaction, so they will be kept in the new file, but will only apply to &lt;br/&gt;
older files, which will speed up reading.&lt;/p&gt;

&lt;p&gt;Today when doing the merge we open up a scanner for all the n files that we want&lt;br/&gt;
to merge and for every value we put into the new file we do n compares, so if&lt;br/&gt;
the total number of inserts are m we get something like m*n compares since we&lt;br/&gt;
are not using any of the information from the last compare, so we end up redoing&lt;br/&gt;
a lot of work. &lt;/p&gt;

&lt;p&gt;I propose a TreeSet or a Heap structure so we get something like m*log&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. &lt;br/&gt;
After that we just need to do some testing to see how much the extra compares&lt;br/&gt;
will add and how big the read performance gain will be by enforcing the extra&lt;br/&gt;
checks.&lt;/p&gt;</comment>
                            <comment id="12715178" author="viper799" created="Mon, 1 Jun 2009 18:00:19 +0000"  >&lt;p&gt;currently with timestamps being provided by the client we can not do #3 in a minor compaction/merge&lt;br/&gt;
the reason is we might delete the wrong version if we are not aware of all version with all timestamps.&lt;br/&gt;
also I thank last time I checked we are doing  #2 in minor compaction/merge&lt;/p&gt;</comment>
                            <comment id="12733486" author="streamy" created="Tue, 21 Jul 2009 05:27:52 +0000"  >&lt;p&gt;Closing this issue as duplicate.  We made the minor/major compactions outlined by erik.&lt;/p&gt;

&lt;p&gt;We also made other improvements with all the &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1234&quot; title=&quot;Change HBase StoreKey format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1234&quot;&gt;&lt;del&gt;HBASE-1234&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1249&quot; title=&quot;Rearchitecting of server, client, API, key format, etc for 0.20&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1249&quot;&gt;&lt;del&gt;HBASE-1249&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-880&quot; title=&quot;Improve the current client API by creating new container classes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-880&quot;&gt;&lt;del&gt;HBASE-880&lt;/del&gt;&lt;/a&gt; etc etc for 0.20&lt;/p&gt;

&lt;p&gt;Any other plans to improve flushes/compactions/splits should be handled in new issues targeted at 0.20 and beyond&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12416382">HBASE-1248</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12413700">HBASE-1171</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12424055">HBASE-1354</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 19 Mar 2009 20:52:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32068</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 22 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hc9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99249</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>