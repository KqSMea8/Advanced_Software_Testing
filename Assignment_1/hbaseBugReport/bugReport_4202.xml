<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:16:48 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4202/HBASE-4202.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4202] Check filesystem permissions on startup</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4202</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We added a new node to a 44 node cluster starting the datanode, mapred and regionserver processes on it. The Unix filesystem was configured incorrectly, i.e. /tmp was not writable to processes. All three processes had issues with this. Datanode and mapred shutdown on exception.&lt;br/&gt;
Regionserver did not stop, in fact reported to master that its up without regions. So master assigned regions to it. Regionserver would not accept them, resulting in a constant assign, reject, reassign cycle, that put many regions into a state of not being available. There are no logs about this, but we could observer the regioncount fluctuate by hundredths of regions and the application throwing many NotServingRegion exceptions.  &lt;/p&gt;

&lt;p&gt;In fact to the master process the regionserver looked fine, so it was trying to send regions its way. Regionserver rejected them. So the master/balancer was going into a assign/reassign cycle destabilizing the cluster. Many puts and gets simply failed with NotServingRegionExceptions and took a long time to complete.&lt;/p&gt;

&lt;p&gt;Exception from regionserver:&lt;br/&gt;
2011-08-06 23:57:13,953 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Got ZooKeeper event, state: SyncConnected, type: NodeCreated, path: /hbase/master&lt;br/&gt;
2011-08-06 23:57:13,957 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Telling master at 17.1.0.1:60000 that we are up&lt;br/&gt;
2011-08-06 23:57:13,957 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: Telling master at 17.1.0.1:60000 that we are up&lt;br/&gt;
2011-08-07 00:07:39.648::INFO:  Logging to STDERR via org.mortbay.log.StdErrLog&lt;br/&gt;
2011-08-07 00:07:39.712::INFO:  jetty-6.1.14&lt;br/&gt;
2011-08-07 00:07:39.742::WARN:  tmpdir&lt;br/&gt;
java.io.IOException: Permission denied&lt;br/&gt;
        at java.io.UnixFileSystem.createFileExclusively(Native Method)&lt;br/&gt;
        at java.io.File.checkAndCreate(File.java:1704)&lt;br/&gt;
        at java.io.File.createTempFile(File.java:1792)&lt;br/&gt;
        at java.io.File.createTempFile(File.java:1828)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.getTempDirectory(WebAppContext.java:745)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:458)&lt;br/&gt;
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:156)&lt;br/&gt;
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)&lt;br/&gt;
        at org.mortbay.jetty.Server.doStart(Server.java:222)&lt;br/&gt;
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
        at org.apache.hadoop.http.HttpServer.start(HttpServer.java:461)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.startServiceThreads(HRegionServer.java:1168)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.init(HRegionServer.java:792)&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegionServer.run(HRegionServer.java:430)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;

&lt;p&gt;Exception from datanode:&lt;br/&gt;
2011-08-06 23:37:20,444 INFO org.apache.hadoop.http.HttpServer: Jetty bound to port 50075&lt;br/&gt;
2011-08-06 23:37:20,444 INFO org.mortbay.log: jetty-6.1.14&lt;br/&gt;
2011-08-06 23:37:20,469 WARN org.mortbay.log: tmpdir&lt;br/&gt;
java.io.IOException: Permission denied&lt;br/&gt;
        at java.io.UnixFileSystem.createFileExclusively(Native Method)&lt;br/&gt;
        at java.io.File.checkAndCreate(File.java:1704)&lt;br/&gt;
        at java.io.File.createTempFile(File.java:1792)&lt;br/&gt;
        at java.io.File.createTempFile(File.java:1828)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.getTempDirectory(WebAppContext.java:745)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:458)&lt;br/&gt;
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:156)&lt;br/&gt;
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)&lt;br/&gt;
        at org.mortbay.jetty.Server.doStart(Server.java:222)&lt;br/&gt;
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
        at org.apache.hadoop.http.HttpServer.start(HttpServer.java:463)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.datanode.DataNode.startDataNode(DataNode.java:384)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.datanode.DataNode.&amp;lt;init&amp;gt;(DataNode.java:225)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.datanode.DataNode.makeInstance(DataNode.java:1309)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.datanode.DataNode.instantiateDataNode(DataNode.java:1264)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.datanode.DataNode.createDataNode(DataNode.java:1272)&lt;br/&gt;
        at org.apache.hadoop.hdfs.server.datanode.DataNode.main(DataNode.java:1394)&lt;br/&gt;
2011-08-06 23:37:20,471 INFO org.apache.hadoop.hdfs.server.datanode.DataNode: SHUTDOWN_MSG: &lt;br/&gt;
/************************************************************&lt;br/&gt;
SHUTDOWN_MSG: Shutting down DataNode at hdp1122/17.1.0.22&lt;br/&gt;
************************************************************/&lt;/p&gt;

&lt;p&gt;Exception from tasktracker:&lt;br/&gt;
2011-08-06 23:33:50,380 INFO org.apache.hadoop.http.HttpServer: Jetty bound to port 50060&lt;br/&gt;
2011-08-06 23:33:50,380 INFO org.mortbay.log: jetty-6.1.14&lt;br/&gt;
2011-08-06 23:33:50,415 WARN org.mortbay.log: tmpdir&lt;br/&gt;
java.io.IOException: Permission denied&lt;br/&gt;
        at java.io.UnixFileSystem.createFileExclusively(Native Method)&lt;br/&gt;
        at java.io.File.checkAndCreate(File.java:1704)&lt;br/&gt;
        at java.io.File.createTempFile(File.java:1792)&lt;br/&gt;
        at java.io.File.createTempFile(File.java:1828)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.getTempDirectory(WebAppContext.java:745)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:458)&lt;br/&gt;
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:156)&lt;br/&gt;
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)&lt;br/&gt;
        at org.mortbay.jetty.Server.doStart(Server.java:222)&lt;br/&gt;
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)&lt;br/&gt;
        at org.apache.hadoop.http.HttpServer.start(HttpServer.java:463)&lt;br/&gt;
        at org.apache.hadoop.mapred.TaskTracker.&amp;lt;init&amp;gt;(TaskTracker.java:935)&lt;br/&gt;
        at org.apache.hadoop.mapred.TaskTracker.main(TaskTracker.java:2837)&lt;br/&gt;
2011-08-06 23:33:50,416 INFO org.apache.hadoop.mapred.TaskTracker: SHUTDOWN_MSG: &lt;br/&gt;
/************************************************************&lt;br/&gt;
SHUTDOWN_MSG: Shutting down TaskTracker at hdp1122/17.1.0.22&lt;br/&gt;
************************************************************/&lt;/p&gt;

</description>
                <environment>&lt;p&gt;debian squeeze&lt;/p&gt;</environment>
        <key id="12518957">HBASE-4202</key>
            <summary>Check filesystem permissions on startup</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="ram_krish">ramkrishna.s.vasudevan</assignee>
                                    <reporter username="hofschen">Matthias Hofschen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Aug 2011 06:25:54 +0000</created>
                <updated>Tue, 5 Aug 2014 20:11:43 +0000</updated>
                            <resolved>Fri, 24 Aug 2012 03:49:31 +0000</resolved>
                                    <version>0.20.4</version>
                                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13085952" author="stack" created="Tue, 16 Aug 2011 20:26:02 +0000"  >&lt;p&gt;Marking as noob.  Would be sweet if someone tried this on 0.90.x hbase and if still an issue, make a change so we exit rather than do the pathological dance Matthias describes above.&lt;/p&gt;</comment>
                            <comment id="13086827" author="ram_krish" created="Thu, 18 Aug 2011 05:49:50 +0000"  >&lt;p&gt;@Stack,&lt;br/&gt;
I think 0.90.x behaves correctly. I checked the behaviour.  Below are the logs&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2011-08-18 10:57:49,345 INFO org.mortbay.log: Logging to org.slf4j.impl.Log4jLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog
2011-08-18 10:57:49,475 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: STOPPED: Failed initialization
2011-08-18 10:57:49,479 ERROR org.apache.hadoop.hbase.regionserver.HRegionServer: Failed init
java.lang.IllegalArgumentException: Bad temp directory: /tmp/hadoop-test666/Jetty/regionserver
	at org.mortbay.jetty.webapp.WebAppContext.setTempDirectory(WebAppContext.java:1201)
	at org.apache.hadoop.http.HttpServer.&amp;lt;init&amp;gt;(HttpServer.java:128)
	at org.apache.hadoop.hbase.util.InfoServer.&amp;lt;init&amp;gt;(InfoServer.java:54)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.startServiceThreads(HRegionServer.java:1262)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.handleReportForDutyResponse(HRegionServer.java:880)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.tryReportForDuty(HRegionServer.java:1481)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.run(HRegionServer.java:571)
	at java.lang.Thread.run(Thread.java:619)
2011-08-18 10:57:49,488 FATAL org.apache.hadoop.hbase.regionserver.HRegionServer: ABORTING region server serverName=linux-kxjl,60020,1313645267001, load=(requests=0, regions=0, usedHeap=22, maxHeap=995): Unhandled exception: Region server startup failed
java.io.IOException: Region server startup failed
	at org.apache.hadoop.hbase.regionserver.HRegionServer.convertThrowableToIOE(HRegionServer.java:987)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.handleReportForDutyResponse(HRegionServer.java:889)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.tryReportForDuty(HRegionServer.java:1481)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.run(HRegionServer.java:571)
	at java.lang.Thread.run(Thread.java:619)
Caused by: java.lang.IllegalArgumentException: Bad temp directory: /tmp/hadoop-test666/Jetty/regionserver
	at org.mortbay.jetty.webapp.WebAppContext.setTempDirectory(WebAppContext.java:1201)
	at org.apache.hadoop.http.HttpServer.&amp;lt;init&amp;gt;(HttpServer.java:128)
	at org.apache.hadoop.hbase.util.InfoServer.&amp;lt;init&amp;gt;(InfoServer.java:54)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.startServiceThreads(HRegionServer.java:1262)
	at org.apache.hadoop.hbase.regionserver.HRegionServer.handleReportForDutyResponse(HRegionServer.java:880)
	... 3 more
-----------
2011-08-18 10:57:49,770 INFO org.apache.hadoop.hbase.regionserver.ShutdownHook: Shutdown hook starting; hbase.shutdown.hook=true; fsShutdownHook=Thread[Thread-14,5,main]
2011-08-18 10:57:49,771 INFO org.apache.hadoop.hbase.regionserver.HRegionServer: STOPPED: Shutdown hook
2011-08-18 10:57:49,771 INFO org.apache.hadoop.hbase.regionserver.ShutdownHook: Starting fs shutdown hook thread.
2011-08-18 10:57:49,874 INFO org.apache.hadoop.hbase.regionserver.ShutdownHook: Shutdown hook finished.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This defect may not be valid in 0.90.x version. &lt;/p&gt;</comment>
                            <comment id="13087524" author="stack" created="Fri, 19 Aug 2011 04:36:38 +0000"  >&lt;p&gt;Thanks for doing the check Ram.&lt;/p&gt;

&lt;p&gt;I&apos;m marking this a &apos;trivial&apos; bug since it seems it only an issue in old 0.20.x hbase fixed (it looks like) in 0.90.x&lt;/p&gt;</comment>
                            <comment id="13440573" author="lhofhansl" created="Thu, 23 Aug 2012 19:17:48 +0000"  >&lt;p&gt;@Ram: are you still doing this, or should we close?&lt;/p&gt;</comment>
                            <comment id="13440915" author="ram_krish" created="Fri, 24 Aug 2012 03:45:30 +0000"  >&lt;p&gt;@Lars&lt;br/&gt;
Am not doing this and may not take up any time sooner i feel.. We can close this Lars.&lt;/p&gt;</comment>
                            <comment id="13440921" author="lhofhansl" created="Fri, 24 Aug 2012 03:49:31 +0000"  >&lt;p&gt;Alright. Can always reopen.&lt;br/&gt;
(We&apos;re doing some jira house cleaning at Salesforce)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Aug 2011 20:26:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27217</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 17 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hpv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101452</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>