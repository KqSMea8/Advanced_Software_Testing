<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:49:52 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1006/HBASE-1006.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1006] Resevoir of memory not freed on OOME</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1006</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Here is the OOME:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;#
2008-11-17 17:04:18,812 FATAL org.apache.hadoop.hbase.regionserver.MemcacheFlusher: Replay of hlog required. Forcing server shutdown
#
org.apache.hadoop.hbase.DroppedSnapshotException: region: streamitems,^@^@^@^@^A&#239;&#191;&#189;?&#239;&#191;&#189;,1226968617756
#
        at org.apache.hadoop.hbase.regionserver.HRegion.internalFlushcache(HRegion.java:865)
#
        at org.apache.hadoop.hbase.regionserver.HRegion.flushcache(HRegion.java:761)
#
        at org.apache.hadoop.hbase.regionserver.MemcacheFlusher.flushRegion(MemcacheFlusher.java:179)
#
        at org.apache.hadoop.hbase.regionserver.MemcacheFlusher.flushSomeRegions(MemcacheFlusher.java:232)
#
        at org.apache.hadoop.hbase.regionserver.MemcacheFlusher.reclaimMemcacheMemory(MemcacheFlusher.java:213)
#
        at org.apache.hadoop.hbase.regionserver.HRegionServer.batchUpdates(HRegionServer.java:1312)
#
        at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
#
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
#
        at java.lang.reflect.Method.invoke(Method.java:597)
#
        at org.apache.hadoop.hbase.ipc.HbaseRPC$Server.call(HbaseRPC.java:634)
#
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:888)
#
Caused by: java.lang.OutOfMemoryError: GC overhead limit exceeded
#
        at org.apache.hadoop.hbase.util.Bytes.readByteArray(Bytes.java:62)
#
        at org.apache.hadoop.hbase.HStoreKey.readFields(HStoreKey.java:589)
#
        at org.apache.hadoop.io.MapFile$Writer.checkKey(MapFile.java:213)
#
        at org.apache.hadoop.io.MapFile$Writer.append(MapFile.java:192)
#
        at org.apache.hadoop.hbase.io.BloomFilterMapFile$Writer.append(BloomFilterMapFile.java:201)
#
        at org.apache.hadoop.hbase.regionserver.HStore.internalFlushCache(HStore.java:674)
#
        at org.apache.hadoop.hbase.regionserver.HStore.flushCache(HStore.java:627)
#
        at org.apache.hadoop.hbase.regionserver.HRegion.internalFlushcache(HRegion.java:852)
#
        at org.apache.hadoop.hbase.regionserver.HRegion.internalFlushcache(HRegion.java:852)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looking in heap, the resevoir had not been released.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12408773">HBASE-1006</key>
            <summary>Resevoir of memory not freed on OOME</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Nov 2008 21:23:56 +0000</created>
                <updated>Tue, 25 Nov 2008 06:34:51 +0000</updated>
                            <resolved>Tue, 25 Nov 2008 06:34:51 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12650476" author="stack" created="Tue, 25 Nov 2008 06:34:51 +0000"  >&lt;p&gt;Resevoir is cleared in call to abort.  It happens silently. With above exception we do not abort because in BatchUpdate, we see the DSE as an IOE as it goes by, not as an OOME.  OOMEs can happen anywhere.  Thats a bit of a problem given as there is no single entry point into HRS.&lt;/p&gt;

&lt;p&gt;Resolving as fixed as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1020&quot; title=&quot;Regionserver OOME handler should dump vital stats&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1020&quot;&gt;&lt;del&gt;HBASE-1020&lt;/del&gt;&lt;/a&gt;.  Over there, I&apos;ll add a check for OOME everywhere in HRS.  If an OOME, will abort.   Abort will then do the clear of the resevoir so the abort can run smoothly.  Will also dump metrics.&lt;/p&gt;

&lt;p&gt;As to whether abort and shutdown on OOME is the right thing to do, thats we should discuss.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12409056">HBASE-1020</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25521</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 4 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0harr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99007</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>