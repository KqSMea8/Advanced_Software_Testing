<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:30:14 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-12152/HBASE-12152.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-12152] TestLoadIncrementalHFiles shows up as zombie test</title>
                <link>https://issues.apache.org/jira/browse/HBASE-12152</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;TestLoadIncrementalHFiles and TestLoadIncrementalHFilesSplitRecovery frequently show up as zombie tests (from 0.98 to master branch).&lt;br/&gt;
e.g. &lt;a href=&quot;https://builds.apache.org/job/hbase-0.98/558/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.98/558/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here is snippet of stack trace for TestLoadIncrementalHFilesSplitRecovery :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; prio=10 tid=0x00007f8670008000 nid=0x1105 waiting on condition [0x00007f8674b57000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (parking)
  at sun.misc.Unsafe.park(Native Method)
  - parking to wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;  &amp;lt;0x000000078d4c3ba0&amp;gt; (a java.util.concurrent.FutureTask$Sync)
  at java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:834)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:994)
  at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1303)
  at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:248)
  at java.util.concurrent.FutureTask.get(FutureTask.java:111)
  at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles.bulkLoadPhase(LoadIncrementalHFiles.java:382)
  at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles.doBulkLoad(LoadIncrementalHFiles.java:324)
  at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFilesSplitRecovery.testGroupOrSplitWhenRegionHoleExistsInMeta(TestLoadIncrementalHFilesSplitRecovery. java:470)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12745404">HBASE-12152</key>
            <summary>TestLoadIncrementalHFiles shows up as zombie test</summary>
                <type id="6" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/requirement.png">Test</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Oct 2014 03:14:20 +0000</created>
                <updated>Fri, 3 Oct 2014 17:30:22 +0000</updated>
                            <resolved>Thu, 2 Oct 2014 23:37:09 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="14156038" author="apurtell" created="Thu, 2 Oct 2014 03:23:31 +0000"  >&lt;p&gt;So what do you think we should do here Ted? Should this be moved to hbase-it? &lt;/p&gt;</comment>
                            <comment id="14156040" author="yuzhihong@gmail.com" created="Thu, 2 Oct 2014 03:26:34 +0000"  >&lt;p&gt;From earlier in the stack trace:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;LoadIncrementalHFiles-10&quot;&lt;/span&gt; prio=10 tid=0x00007f86716ee800 nid=0x7b5a in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x00007f8642bea000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: TIMED_WAITING (on object monitor)
  at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
  at org.apache.hadoop.hbase.client.RpcRetryingCaller.callWithRetries(RpcRetryingCaller.java:147)
  - locked &amp;lt;0x00000007e4dbf6a0&amp;gt; (a java.util.concurrent.atomic.AtomicBoolean)
  at org.apache.hadoop.hbase.ipc.RegionCoprocessorRpcChannel.callExecService(RegionCoprocessorRpcChannel.java:95)
  at org.apache.hadoop.hbase.ipc.CoprocessorRpcChannel.callMethod(CoprocessorRpcChannel.java:57)
  at org.apache.hadoop.hbase.protobuf.generated.SecureBulkLoadProtos$SecureBulkLoadService$Stub.secureBulkLoadHFiles(SecureBulkLoadProtos.java:4720)
  at org.apache.hadoop.hbase.client.coprocessor.SecureBulkLoadClient.bulkLoadHFiles(SecureBulkLoadClient.java:162)
  at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles$3.call(LoadIncrementalHFiles.java:649)
  at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles$3.call(LoadIncrementalHFiles.java:634)
  at org.apache.hadoop.hbase.client.RpcRetryingCaller.callWithRetries(RpcRetryingCaller.java:111)
  at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles.tryAtomicRegionLoad(LoadIncrementalHFiles.java:690)
  at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles$1.call(LoadIncrementalHFiles.java:371)
  at org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles$1.call(LoadIncrementalHFiles.java:369)
  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I haven&apos;t figured out why SecureBulkLoadClient came into play where the test specifies &quot;&quot; for CoprocessorHost.REGION_COPROCESSOR_CONF_KEY&lt;/p&gt;</comment>
                            <comment id="14156098" author="stack" created="Thu, 2 Oct 2014 05:28:24 +0000"  >&lt;p&gt;And.... Would be cool if someone fixed this else lets just turn it off.&lt;/p&gt;</comment>
                            <comment id="14156753" author="stack" created="Thu, 2 Oct 2014 16:59:28 +0000"  >&lt;p&gt;Adding timeouts on these tests.  Pushed to branch-1+&lt;/p&gt;</comment>
                            <comment id="14156810" author="apurtell" created="Thu, 2 Oct 2014 17:28:59 +0000"  >&lt;p&gt;Cool I cherry picked the timeout additions back to 0.98 and pushed them, they applied cleanly.&lt;/p&gt;</comment>
                            <comment id="14156913" author="hudson" created="Thu, 2 Oct 2014 18:16:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5607 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5607/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5607/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12152&quot; title=&quot;TestLoadIncrementalHFiles shows up as zombie test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12152&quot;&gt;&lt;del&gt;HBASE-12152&lt;/del&gt;&lt;/a&gt; TestLoadIncrementalHFiles shows up as zombie test; ADD TIMEOUT ON TESTS (stack: rev e92036cd54ac313482a5c6cc3416add560c7600c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFilesSplitRecovery.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14156934" author="hudson" created="Thu, 2 Oct 2014 18:24:50 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #532 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/532/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/532/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12152&quot; title=&quot;TestLoadIncrementalHFiles shows up as zombie test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12152&quot;&gt;&lt;del&gt;HBASE-12152&lt;/del&gt;&lt;/a&gt; TestLoadIncrementalHFiles shows up as zombie test; ADD TIMEOUT ON TESTS (apurtell: rev b5360829398922ceccc87fa24ba901543ed4db32)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFilesSplitRecovery.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14157007" author="hudson" created="Thu, 2 Oct 2014 19:13:17 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #261 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/261/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/261/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12152&quot; title=&quot;TestLoadIncrementalHFiles shows up as zombie test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12152&quot;&gt;&lt;del&gt;HBASE-12152&lt;/del&gt;&lt;/a&gt; TestLoadIncrementalHFiles shows up as zombie test; ADD TIMEOUT ON TESTS (stack: rev 4598628ef27f5c4b205f44fcd38e5ac9136f52e1)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFilesSplitRecovery.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14157078" author="yuzhihong@gmail.com" created="Thu, 2 Oct 2014 20:01:03 +0000"  >&lt;p&gt;I got the following test failure:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
testGroupOrSplitPresplit(org.apache.hadoop.hbase.mapreduce.TestSecureLoadIncrementalHFilesSplitRecovery)  Time elapsed: 0.147 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
java.lang.Exception: test timed out after 120 milliseconds
	at org.apache.hadoop.conf.Configuration.getInt(Configuration.java:1087)
	at org.apache.hadoop.hbase.client.HTable.getDefaultExecutor(HTable.java:205)
	at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:302)
	at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:280)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:145)
	at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:86)
	at org.apache.hadoop.hbase.client.HBaseAdmin.createTable(HBaseAdmin.java:538)
	at org.apache.hadoop.hbase.client.HBaseAdmin.createTable(HBaseAdmin.java:430)
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFilesSplitRecovery.setupTable(TestLoadIncrementalHFilesSplitRecovery.java:132)
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFilesSplitRecovery.testGroupOrSplitPresplit(TestLoadIncrementalHFilesSplitRecovery.java:380)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Looks like timeout was specified as 120 milliseconds&lt;/p&gt;</comment>
                            <comment id="14157102" author="hudson" created="Thu, 2 Oct 2014 20:15:46 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #561 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/561/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/561/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12152&quot; title=&quot;TestLoadIncrementalHFiles shows up as zombie test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12152&quot;&gt;&lt;del&gt;HBASE-12152&lt;/del&gt;&lt;/a&gt; TestLoadIncrementalHFiles shows up as zombie test; ADD TIMEOUT ON TESTS (apurtell: rev b5360829398922ceccc87fa24ba901543ed4db32)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFilesSplitRecovery.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14157112" author="stack" created="Thu, 2 Oct 2014 20:20:40 +0000"  >&lt;p&gt;Upped timeout from 120 to 120000 in 0.98+&lt;/p&gt;</comment>
                            <comment id="14157134" author="hudson" created="Thu, 2 Oct 2014 20:35:02 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #562 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/562/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/562/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12152&quot; title=&quot;TestLoadIncrementalHFiles shows up as zombie test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12152&quot;&gt;&lt;del&gt;HBASE-12152&lt;/del&gt;&lt;/a&gt; TestLoadIncrementalHFiles shows up as zombie test; ADD TIMEOUT ON TESTS &amp;#8211; Up timeout from 120 to 120000 (stack: rev d2111dbda4a874224f9f4f0ba9d16edcc104c98a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFilesSplitRecovery.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14157153" author="hudson" created="Thu, 2 Oct 2014 20:48:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #263 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/263/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/263/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12152&quot; title=&quot;TestLoadIncrementalHFiles shows up as zombie test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12152&quot;&gt;&lt;del&gt;HBASE-12152&lt;/del&gt;&lt;/a&gt; TestLoadIncrementalHFiles shows up as zombie test; ADD TIMEOUT ON TESTS &amp;#8211; Up timeout from 120 to 120000 (stack: rev 74c4dbdf39fa11aa0537b8c4b17785452c2dae21)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFilesSplitRecovery.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14157202" author="apurtell" created="Thu, 2 Oct 2014 21:21:54 +0000"  >&lt;p&gt;Oops &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14157213" author="hudson" created="Thu, 2 Oct 2014 21:29:52 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #533 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/533/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/533/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12152&quot; title=&quot;TestLoadIncrementalHFiles shows up as zombie test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12152&quot;&gt;&lt;del&gt;HBASE-12152&lt;/del&gt;&lt;/a&gt; TestLoadIncrementalHFiles shows up as zombie test; ADD TIMEOUT ON TESTS &amp;#8211; Up timeout from 120 to 120000 (stack: rev d2111dbda4a874224f9f4f0ba9d16edcc104c98a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFilesSplitRecovery.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14157254" author="yuzhihong@gmail.com" created="Thu, 2 Oct 2014 21:50:47 +0000"  >&lt;p&gt;Proposed fix&lt;br/&gt;
Thanks to Jeffrey for suggestion.&lt;/p&gt;</comment>
                            <comment id="14157262" author="stack" created="Thu, 2 Oct 2014 21:56:06 +0000"  >&lt;p&gt;Why does it fix the problem?&lt;/p&gt;</comment>
                            <comment id="14157324" author="hudson" created="Thu, 2 Oct 2014 22:30:02 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5610 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5610/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5610/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12152&quot; title=&quot;TestLoadIncrementalHFiles shows up as zombie test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12152&quot;&gt;&lt;del&gt;HBASE-12152&lt;/del&gt;&lt;/a&gt; TestLoadIncrementalHFiles shows up as zombie test; ADD TIMEOUT ON TESTS &amp;#8211; Up timeout from 120 to 120000 (stack: rev 546f436a4145647e595354372af23cdb6d8a1f28)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFilesSplitRecovery.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14157337" author="yuzhihong@gmail.com" created="Thu, 2 Oct 2014 22:45:10 +0000"  >&lt;p&gt;In SecureBulkLoadEndpoint, the following condition isn&apos;t met during test run:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (request.getFsToken().hasIdentifier() &amp;amp;&amp;amp; request.getFsToken().hasPassword()) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;leading to userToken being null which aborts secure bulk load.&lt;br/&gt;
The proposed change would allow userToken to be created.&lt;/p&gt;

&lt;p&gt;Jeff has another fix for the hanging test.&lt;/p&gt;</comment>
                            <comment id="14157342" author="stack" created="Thu, 2 Oct 2014 22:48:35 +0000"  >&lt;p&gt;So it is not a fix for TestLoadIncrementalHFiles?&lt;/p&gt;</comment>
                            <comment id="14157348" author="yuzhihong@gmail.com" created="Thu, 2 Oct 2014 22:51:11 +0000"  >&lt;p&gt;My attachment is to make TestSecureLoadIncrementalHFilesSplitRecovery pass.&lt;/p&gt;

&lt;p&gt;Jeff has another fix for TestLoadIncrementalHFiles&lt;/p&gt;</comment>
                            <comment id="14157352" author="stack" created="Thu, 2 Oct 2014 22:55:13 +0000"  >&lt;p&gt;This issue is &apos;TestLoadIncrementalHFiles shows up as zombie test&apos;.&lt;/p&gt;</comment>
                            <comment id="14157359" author="yuzhihong@gmail.com" created="Thu, 2 Oct 2014 23:00:00 +0000"  >&lt;p&gt;Let me create another JIRA for fixing TestSecureLoadIncrementalHFilesSplitRecovery&lt;/p&gt;</comment>
                            <comment id="14157367" author="stack" created="Thu, 2 Oct 2014 23:04:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ted_yu&quot; class=&quot;user-hover&quot; rel=&quot;ted_yu&quot;&gt;Ted Yu&lt;/a&gt; you are impossible to fathom/follow.  Are you doing relay between this issue and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt;? Is &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; unable?&lt;/p&gt;



&lt;p&gt;TestSecureLoadIncremtalHFileSplitRecovery is failing in here in SecureBulkLoadEndpoint....&lt;/p&gt;

&lt;p&gt;     } else if (userProvider.isHadoopSecurityEnabled()) {&lt;br/&gt;
       //we allow this to pass through in &quot;simple&quot; security mode&lt;br/&gt;
       //for mini cluster testing&lt;br/&gt;
       ResponseConverter.setControllerException(controller,&lt;br/&gt;
           new DoNotRetryIOException(&quot;User token cannot be null&quot;));&lt;br/&gt;
// HERE... we are returning w/o setitng &apos;loaded&apos;.&lt;br/&gt;
+      done.run(SecureBulkLoadHFilesResponse.newBuilder().setLoaded(false).build());&lt;br/&gt;
       return;&lt;/p&gt;

&lt;p&gt;Which is causing &lt;/p&gt;

&lt;p&gt;2014-10-02 15:48:44,970 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;B.defaultRpcServer.handler=2,queue=0,port=60236&amp;#93;&lt;/span&gt; ipc.RpcServer(2053): Unexpected throwable object&lt;br/&gt;
com.google.protobuf.UninitializedMessageException: Message missing required fields: loaded&lt;br/&gt;
	at com.google.protobuf.AbstractMessage$Builder.newUninitializedMessageException(AbstractMessage.java:770)&lt;br/&gt;
	at org.apache.hadoop.hbase.protobuf.generated.SecureBulkLoadProtos$SecureBulkLoadHFilesResponse$Builder.build(SecureBulkLoadProtos.java:1542)&lt;br/&gt;
	at org.apache.hadoop.hbase.protobuf.generated.SecureBulkLoadProtos$SecureBulkLoadHFilesResponse$Builder.build(SecureBulkLoadProtos.java:1486)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion.execService(HRegion.java:5901)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.RSRpcServices.execServiceOnRegion(RSRpcServices.java:1644)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.RSRpcServices.execService(RSRpcServices.java:1626)&lt;br/&gt;
	at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:30426)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2020)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:108)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:114)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:94)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:745)&lt;/p&gt;

&lt;p&gt;... test does not complete.&lt;/p&gt;
</comment>
                            <comment id="14157369" author="yuzhihong@gmail.com" created="Thu, 2 Oct 2014 23:07:45 +0000"  >&lt;p&gt;I debugged the failure in TestSecureLoadIncrementalHFilesSplitRecovery with Jeff.&lt;/p&gt;

&lt;p&gt;I tried the above change which didn&apos;t make TestSecureLoadIncrementalHFilesSplitRecovery pass - userToken is null, skipping the bulk load.&lt;/p&gt;</comment>
                            <comment id="14157385" author="stack" created="Thu, 2 Oct 2014 23:17:50 +0000"  >&lt;p&gt;I give up.&lt;/p&gt;</comment>
                            <comment id="14157410" author="hadoopqa" created="Thu, 2 Oct 2014 23:25:14 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12672658/12152-v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12672658/12152-v3.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12672658&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.regionserver.TestRegionReplicaReplicationEndpoint&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestDistributedLogSplitting&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//artifact/patchprocess/newPatchFindbugsWarningshbase-annotations.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/11198//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14157423" author="apurtell" created="Thu, 2 Oct 2014 23:37:09 +0000"  >&lt;p&gt;The patch on this issue doesn&apos;t match the title or the OP. I tried to follow along with the above but this issue is best resolved as invalid, so I&apos;m going to do that. We have a new test time out. If the test times out, open an issue for that. For the unrelated work above, open an issue for that. Nothing more needs doing here.&lt;/p&gt;</comment>
                            <comment id="14157433" author="yuzhihong@gmail.com" created="Thu, 2 Oct 2014 23:41:13 +0000"  >&lt;p&gt;In the QA run above, TestLoadIncrementalHFiles didn&apos;t hang, neither did TestSecureLoadIncrementalHFilesSplitRecovery.&lt;/p&gt;

&lt;p&gt;The initial subject of the JIRA was inaccurate - although TestLoadIncrementalHFiles showed up in stack trace of hanging test, it was TestSecureLoadIncrementalHFilesSplitRecovery that actually hung because of userToken being null, aborting bulk load.&lt;/p&gt;

&lt;p&gt;Since there was no timeout prior to today, TestSecureLoadIncrementalHFilesSplitRecovery hung.&lt;br/&gt;
The addition of the timeout exposed the bug.&lt;/p&gt;

&lt;p&gt;The above was result of discussion with Jeff.&lt;/p&gt;</comment>
                            <comment id="14157436" author="apurtell" created="Thu, 2 Oct 2014 23:42:16 +0000"  >&lt;p&gt;Definitely invalid then, good resolution. &lt;/p&gt;</comment>
                            <comment id="14157438" author="jeffreyz" created="Thu, 2 Oct 2014 23:43:14 +0000"  >&lt;p&gt;Sorry I came to the thread late. The fix I suggested to Ted is due to my recent change where I added this following line to prevent possible toByteArray() from throwing NPE. While it seems, in test case, request.getFsToken().hasIdentifier() returns false and request.getFsToken().getIdentifier() is empty byte array. So my previous NPE worry isn&apos;t needed and the fix just restores previous behavior. &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;if (request.getFsToken().hasIdentifier() &amp;amp;&amp;amp; request.getFsToken().hasPassword()) {&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="14157440" author="apurtell" created="Thu, 2 Oct 2014 23:44:42 +0000"  >&lt;p&gt;I suggest opening a clean issue that clearly explains this and provides a patch. This issue is FUBAR&lt;/p&gt;</comment>
                            <comment id="14157446" author="jeffreyz" created="Thu, 2 Oct 2014 23:46:55 +0000"  >&lt;p&gt;What Stack found is another bug that &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;done.run(null)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;doesn&apos;t work in existing code and we have to use something proposed by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
done.run(SecureBulkLoadHFilesResponse.newBuilder().setLoaded(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;).build());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14158217" author="eclark" created="Fri, 3 Oct 2014 17:30:22 +0000"  >&lt;p&gt;Please take other comments/more findings to a new jira. This one has been rendered un-usable.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12672684" name="TestSecureLoadIncrementalHFilesSplitRecovery-fix.txt" size="954" author="yuzhihong@gmail.com" created="Thu, 2 Oct 2014 23:25:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 2 Oct 2014 03:23:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 11 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20pnb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>