<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:18:09 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4351/HBASE-4351.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4351] If from Admin we try to unassign a region forcefully, though a valid region name is given the master is not able to identify the region to unassign.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4351</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The following is the problem&lt;br/&gt;
Get the exact region name from UI and call&lt;br/&gt;
HBaseAdmin.unassign(regionname, true).&lt;br/&gt;
Here true is forceful option.&lt;br/&gt;
As part of unassign api&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void unassign(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [] regionName, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; force)
  &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    Pair&amp;lt;HRegionInfo, HServerAddress&amp;gt; pair =
      MetaReader.getRegion(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.catalogTracker, regionName);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (pair == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UnknownRegionException(Bytes.toStringBinary(regionName));
    HRegionInfo hri = pair.getFirst();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (force) &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.clearRegionFromTransition(hri);
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.unassign(hri, force);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As part of clearRegionFromTransition()&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions) {
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions.remove(hri);
      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Set&amp;lt;HRegionInfo&amp;gt; regions : &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.servers.values()) {
        regions.remove(hri);
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the region is also removed.  Hence when the master tries to identify the region&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!regions.containsKey(region)) {
        debugLog(region, &lt;span class=&quot;code-quote&quot;&gt;&quot;Attempted to unassign region &quot;&lt;/span&gt; +
          region.getRegionNameAsString() + &lt;span class=&quot;code-quote&quot;&gt;&quot; but it is not &quot;&lt;/span&gt; +
          &lt;span class=&quot;code-quote&quot;&gt;&quot;currently assigned anywhere&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It is not able to identify the region.  It exists in trunk and 0.90.x also.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux&lt;/p&gt;</environment>
        <key id="12522223">HBASE-4351</key>
            <summary>If from Admin we try to unassign a region forcefully, though a valid region name is given the master is not able to identify the region to unassign.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ram_krish">ramkrishna.s.vasudevan</assignee>
                                    <reporter username="ram_krish">ramkrishna.s.vasudevan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Sep 2011 07:22:25 +0000</created>
                <updated>Fri, 20 Nov 2015 11:53:01 +0000</updated>
                            <resolved>Thu, 15 Sep 2011 03:21:17 +0000</resolved>
                                                    <fixVersion>0.90.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13100395" author="ram_krish" created="Thu, 8 Sep 2011 15:40:38 +0000"  >&lt;p&gt;The impact could be like the region is removed from the regions map in master and until we restart the master becomes unaware of the region.&lt;br/&gt;
Kindly correct me if am wrong.&lt;/p&gt;</comment>
                            <comment id="13100403" author="stack" created="Thu, 8 Sep 2011 15:45:17 +0000"  >&lt;p&gt;That looks like a silly mistake.  Good one Ram.&lt;/p&gt;</comment>
                            <comment id="13100510" author="jdcryans" created="Thu, 8 Sep 2011 18:00:21 +0000"  >&lt;p&gt;A force unassign is a different &quot;type&quot; of unassignment. If not forcing, we kindly ask the RS to close the region. If forcing, then we explicitly wipe out the master&apos;s knowledge of that region... which can be still be fixed later by a run of hbck -fix. I think the current behavior is correct, and if there&apos;s anything to fix it would be to skip calling this.assignmentManager.unassign(hri, force) altogether when force=true.&lt;/p&gt;</comment>
                            <comment id="13100530" author="ram_krish" created="Thu, 8 Sep 2011 18:16:18 +0000"  >&lt;p&gt;@J-D&lt;br/&gt;
Sorry I may be wrong. I was going through the javadoc and it read like&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   * @param force If true, force unassign (Will remove region from
   * regions-in-transition too if present).
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and because after &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (force) this.assignmentManager.clearRegionFromTransition(hri);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;we were calling the unassign().  So this made me think that something was wrong here.&lt;br/&gt;
Thanks for correcting me. So can we invalidate this issue?&lt;/p&gt;
</comment>
                            <comment id="13100541" author="jdcryans" created="Thu, 8 Sep 2011 18:28:40 +0000"  >&lt;p&gt;Well there&apos;s definitely something we need to do. For example the shell help says:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Pass &apos;true&apos; to force the unassignment (&apos;force&apos; will clear all in-memory state in master before the reassign). &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This doesn&apos;t make sense since you can&apos;t wipe out the in-memory state, and then know where to unassign (you just wiped that). Maybe we could do something better since we&apos;re not going to send a close... like I mentioned, I have to hbck -fix to reassign the region after using this, maybe we could call assign in the unassign method when force=true?&lt;/p&gt;

&lt;p&gt;I know it sounds dumb, but in the end that&apos;s what happens anyway when you unassign with force=false because when the master receives the notification that the region is closed then it reassigns it.&lt;/p&gt;</comment>
                            <comment id="13102755" author="ram_krish" created="Mon, 12 Sep 2011 16:01:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;Maybe we could do something better since we&apos;re not going to send a close... like I mentioned, I have to hbck -fix to reassign the region after using this, maybe we could call assign in the unassign method when force=true?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I have just called the assignRegion if force=true.  And have added javadoc saying possible double assignment and use hbck -fix.  &lt;/p&gt;</comment>
                            <comment id="13103185" author="jdcryans" created="Mon, 12 Sep 2011 23:41:31 +0000"  >&lt;p&gt;In HMaster don&apos;t you need to go through the coprocessor too? (unsure myself)&lt;/p&gt;</comment>
                            <comment id="13103753" author="ram_krish" created="Tue, 13 Sep 2011 16:58:11 +0000"  >&lt;p&gt;Resubmitting patch with minor changes&lt;/p&gt;</comment>
                            <comment id="13103792" author="stack" created="Tue, 13 Sep 2011 17:26:41 +0000"  >&lt;p&gt;+1 on patch.  J-D?&lt;/p&gt;</comment>
                            <comment id="13103802" author="jdcryans" created="Tue, 13 Sep 2011 17:31:55 +0000"  >&lt;p&gt;Why not just:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (force) {
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.clearRegionFromTransition(hri);
      assignRegion(hri);
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.unassign(hri, force);
    }
    cpPostUnassign(hri, force);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;No return, no double cpPostUnassign call.&lt;/p&gt;</comment>
                            <comment id="13103871" author="ram_krish" created="Tue, 13 Sep 2011 18:29:14 +0000"  >&lt;p&gt;J-D&apos;s comment updated in patch&lt;/p&gt;</comment>
                            <comment id="13103891" author="jdcryans" created="Tue, 13 Sep 2011 18:43:36 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13103892" author="jdcryans" created="Tue, 13 Sep 2011 18:43:47 +0000"  >&lt;p&gt;If it passes the tests &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13104510" author="ram_krish" created="Wed, 14 Sep 2011 14:05:58 +0000"  >&lt;p&gt;No testcases failures due to this fix.&lt;/p&gt;</comment>
                            <comment id="13105080" author="yuzhihong@gmail.com" created="Thu, 15 Sep 2011 02:49:05 +0000"  >&lt;p&gt;Integrated to TRUNK and branch.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Ramkrishna.&lt;/p&gt;</comment>
                            <comment id="13105116" author="hudson" created="Thu, 15 Sep 2011 05:08:21 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2212 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2212/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2212/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4351&quot; title=&quot;If from Admin we try to unassign a region forcefully, though a valid region name is given the master is not able to identify the region to unassign.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4351&quot;&gt;&lt;del&gt;HBASE-4351&lt;/del&gt;&lt;/a&gt; If from Admin we try to unassign a region forcefully, though a valid region name is given the master is not able to identify the region to unassign.(Ramkrishna)&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/ipc/HMasterInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/ruby/shell/commands/unassign.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15015889" author="lars_francke" created="Fri, 20 Nov 2015 11:53:01 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12494050" name="HBASE-4351.patch" size="4506" author="ram_krish" created="Mon, 12 Sep 2011 15:59:56 +0000"/>
                            <attachment id="12494254" name="HBASE-4351_1.patch" size="4679" author="ram_krish" created="Tue, 13 Sep 2011 16:21:34 +0000"/>
                            <attachment id="12494268" name="HBASE-4351_2.patch" size="4685" author="ram_krish" created="Tue, 13 Sep 2011 16:58:11 +0000"/>
                            <attachment id="12494291" name="HBASE-4351_3.patch" size="3005" author="ram_krish" created="Tue, 13 Sep 2011 18:29:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 8 Sep 2011 15:45:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3521</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hqjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101563</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>