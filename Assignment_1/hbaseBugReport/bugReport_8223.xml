<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:53:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8223/HBASE-8223.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8223] [89-FB] Fix race condition between append/sync and HLog.close() work flow.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8223</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The RegionServer was performing a shutdown as it got YouAreDeadException. It closed the HLog and was waiting to close all the regions where it got stuck.&lt;/p&gt;

&lt;p&gt;The reason region close is stuck because it&apos;s trying to obtain a lock which is occupied by the put op, which in turn is waiting for append to HLog to complete.&lt;/p&gt;

&lt;p&gt;There is race condition here is between append/sync and HLog.close() work flow. &lt;/p&gt;

&lt;p&gt;Scenario:&lt;/p&gt;

&lt;p&gt;Thread 1 =&amp;gt; doing the append&lt;br/&gt;
Thread 2 =&amp;gt; doing HregionServer shutdown&lt;/p&gt;

&lt;p&gt;Timeline:&lt;/p&gt;

&lt;p&gt;t1&amp;gt; 1: Verifies that LogSyncer is not shutting down and HLog is not closed and calls sync()&lt;br/&gt;
t2&amp;gt; 2: HRegionServer issued HLog.close()&lt;br/&gt;
t3&amp;gt; 2: In HLog.close(), it joins the LogSyncer thread, which signals all the threads waiting on syncDone and exits.&lt;br/&gt;
t4&amp;gt; 1: In sync, it sees that the sync has not complete until its txd, hence adds itself to the syncDone.await queue.&lt;/p&gt;

&lt;p&gt;Note: at t4, it does not check whether the LogSyncer Thread is alive or not, which caused this hang.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12639869">HBASE-8223</key>
            <summary>[89-FB] Fix race condition between append/sync and HLog.close() work flow.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="rshroff">Rishit Shroff</assignee>
                                    <reporter username="rshroff">Rishit Shroff</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Mar 2013 19:19:34 +0000</created>
                <updated>Fri, 14 Feb 2014 00:23:54 +0000</updated>
                                            <version>0.89-fb</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320338</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 38 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j9sf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320679</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>