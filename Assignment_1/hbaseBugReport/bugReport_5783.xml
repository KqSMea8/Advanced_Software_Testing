<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:30:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5783/HBASE-5783.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5783] Faster HBase bulk loader</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5783</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We can get a 3x to 4x gain based on a prototype demonstrating this approach in effect (hackily) over the MR bulk loader for very large data sets by doing the following:&lt;/p&gt;

&lt;p&gt;1. Do direct multi-puts from HBase client using GZIP compressed RPC&apos;s&lt;br/&gt;
2. Turn off WAL (we will ensure no data loss in another way)&lt;br/&gt;
3. For each bulk load client, we need to:&lt;br/&gt;
3.1 do a put&lt;br/&gt;
3.2 get back a tracking cookie (memstoreTs or HLogSequenceId) per put&lt;br/&gt;
3.3 be able to ask the RS if the tracking cookie has been flushed to disk&lt;br/&gt;
4. For each client, we can succeed it if the tracking cookie for the last put it did (for every RS) makes it to disk. Otherwise the map task fails and is retried.&lt;br/&gt;
5. If the last put did not make it to disk for a timeout (say a second or so) we issue a manual flush.&lt;/p&gt;

&lt;p&gt;Enhancements:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Increase the memstore size so that we flush larger files&lt;/li&gt;
	&lt;li&gt;Decrease the compaction ratios (say increase the number of files to compact)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Quick background:&lt;/p&gt;

&lt;p&gt;The bottlenecks in the multiput approach are that the data is transferred &lt;b&gt;uncompressed&lt;/b&gt; twice over the top-of-rack: once from the client to the RS (on the multi put call) and again because of WAL (HDFS replication). We reduced the former with RPC compression and eliminated the latter above while still guaranteeing that data wont be lost.&lt;/p&gt;

&lt;p&gt;This is better than the MR bulk loader at a high level because we dont need to merge sort all the files for a given region and then make it a HFile - thats the equivalent of bulk loading AND majorcompacting in one shot. Also there is much more disk involved in the MR method (sort/spill).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12550865">HBASE-5783</key>
            <summary>Faster HBase bulk loader</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="amitanand">Amitanand Aiyer</assignee>
                                    <reporter username="karthik.ranga">Karthik Ranganathan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Apr 2012 19:19:37 +0000</created>
                <updated>Sun, 24 Mar 2013 05:17:38 +0000</updated>
                            <resolved>Wed, 6 Mar 2013 23:12:03 +0000</resolved>
                                                    <fixVersion>0.89-fb</fixVersion>
                                    <component>Client</component>
                    <component>IPC/RPC</component>
                    <component>Performance</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                <comments>
                            <comment id="13476780" author="lhofhansl" created="Tue, 16 Oct 2012 06:10:06 +0000"  >&lt;p&gt;The tracking cookie is a very interesting idea!&lt;br/&gt;
Do we need to track every single cookie? Or can we just track the highest one per region, and if that made it to disk all previous ones are on disk?&lt;/p&gt;

&lt;p&gt;With &quot;MR Bulk Loader&quot; you mean LoadIncrementalHFiles? Or Import/ImportTsv?&lt;/p&gt;
</comment>
                            <comment id="13477137" author="karthik.ranga" created="Tue, 16 Oct 2012 16:33:10 +0000"  >&lt;p&gt;No, we track only the last (highest) one per region. Also, in the actual implementation, we did it with just timestamps from the RS. So, after doing all the puts the loader gets the time on the RS (t1). The server tracks the start time of the last successfully completed flush {t2). Querying that and making sure t2 &amp;gt; t1 is enough. Of course - if the region has moved gracefully, thats considered a success too as an optimization.&lt;/p&gt;

&lt;p&gt;We used the term &quot;MR Bulk Loader&quot; simply to say that the load of the data should be repeatable in case of failure (as opposed to a online use case).&lt;/p&gt;</comment>
                            <comment id="13595531" author="anoopsamjohn" created="Thu, 7 Mar 2013 04:20:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amitanand&quot; class=&quot;user-hover&quot; rel=&quot;amitanand&quot;&gt;Amitanand Aiyer&lt;/a&gt; This issue now marked as fixed? This is fixed in which version? 89fb? How can I see a patch for this?&lt;/p&gt;</comment>
                            <comment id="13609616" author="amitanand" created="Thu, 21 Mar 2013 22:34:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt; This was implememted for 89fb. You can find the diff here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5783&quot; title=&quot;Faster HBase bulk loader&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5783&quot;&gt;&lt;del&gt;HBASE-5783&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0.89-fb&amp;#93;&lt;/span&gt; Reliably bulk load Puts/Deletes to HBase, without WAL.&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=r1387312&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=r1387312&lt;/a&gt;&lt;br/&gt;
 &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5783&quot; title=&quot;Faster HBase bulk loader&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5783&quot;&gt;&lt;del&gt;HBASE-5783&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0.89-fb&amp;#93;&lt;/span&gt; Improve false positives: Retry only if the server restarts&lt;br/&gt;
 &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=r1388800&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=r1388800&lt;/a&gt; &lt;/p&gt;
</comment>
                            <comment id="13609705" author="jmhsieh" created="Thu, 21 Mar 2013 23:50:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amitanand&quot; class=&quot;user-hover&quot; rel=&quot;amitanand&quot;&gt;Amitanand Aiyer&lt;/a&gt; Can you update the &apos;fix versions&apos; (versions this was committed to) on this issue (and others you&apos;ve worked on?).  It really helps folks on the upstream 0.9x branches when we look for some history and to potentially port to them.  &lt;/p&gt;</comment>
                            <comment id="13609708" author="amitanand" created="Thu, 21 Mar 2013 23:52:30 +0000"  >&lt;p&gt;Sure.&lt;/p&gt;</comment>
                            <comment id="13609883" author="anoopsamjohn" created="Fri, 22 Mar 2013 04:01:33 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amitanand&quot; class=&quot;user-hover&quot; rel=&quot;amitanand&quot;&gt;Amitanand Aiyer&lt;/a&gt;&lt;br/&gt;
Yes when I have done SVN Update for my 0.89fb code base I have noticed the change log for some files and seen the diff. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13611980" author="amitanand" created="Sun, 24 Mar 2013 05:17:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmhsieh&quot; class=&quot;user-hover&quot; rel=&quot;jmhsieh&quot;&gt;Jonathan Hsieh&lt;/a&gt;sure. will do.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Oct 2012 06:10:06 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>235729</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 38 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i016fz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4813</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>