<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:18:00 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10873/HBASE-10873.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10873] Control number of regions assigned to backup masters</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10873</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;By default, a backup master is treated just like another regionserver. So it can host as many regions as other regionserver does. When the backup master becomes the active one, region balancer needs to move those user regions on this master to other region servers. To minimize the impact, it&apos;s better not to assign too many regions on backup masters. It may not be good to leave the backup masters idle and not host any region either.&lt;/p&gt;

&lt;p&gt;We should make this adjustable so that users can control how many regions to assign to each backup master.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12705705">HBASE-10873</key>
            <summary>Control number of regions assigned to backup masters</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jxiang">Jimmy Xiang</assignee>
                                    <reporter username="jxiang">Jimmy Xiang</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Mar 2014 16:54:55 +0000</created>
                <updated>Sat, 21 Feb 2015 23:28:51 +0000</updated>
                            <resolved>Fri, 25 Apr 2014 16:49:40 +0000</resolved>
                                                    <fixVersion>0.99.0</fixVersion>
                                    <component>Balancer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13962013" author="jxiang" created="Mon, 7 Apr 2014 16:56:58 +0000"  >&lt;p&gt;Attached the first patch. It&apos;s also on RB: &lt;a href=&quot;https://reviews.apache.org/r/20088/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/20088/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This patch introduced a weight concept for user regions assigned to active/backup master. Adjusting the weight can control the number of user regions assigned to backup masters. The weight logic is used for 1) region balancing, 2) round robin assignment, 3) random assignment. When retaining assignment finds the original server is not avaiable, the same random assignment logic based on weight is used to choose a new server.&lt;/p&gt;
</comment>
                            <comment id="13962128" author="hadoopqa" created="Mon, 7 Apr 2014 18:45:50 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12639016/hbase-10873.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12639016/hbase-10873.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12639016&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 12 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.procedure.TestZKProcedure&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9216//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13970034" author="jxiang" created="Tue, 15 Apr 2014 20:40:26 +0000"  >&lt;p&gt;Attached patch v2 that addressed Matteo&apos;s review comments. Thanks.&lt;/p&gt;</comment>
                            <comment id="13970214" author="hadoopqa" created="Tue, 15 Apr 2014 23:50:42 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12640327/hbase-10873_v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12640327/hbase-10873_v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12640327&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 12 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9297//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13970226" author="mbertozzi" created="Tue, 15 Apr 2014 23:57:38 +0000"  >&lt;p&gt;+1, v2 looks good to me&lt;/p&gt;</comment>
                            <comment id="13970345" author="enis" created="Wed, 16 Apr 2014 02:01:57 +0000"  >&lt;p&gt;Is this a good idea? Today META/ns tables are already shared with the other tables, and there is little special treatment for the region server hosting meta. &lt;br/&gt;
In 0.98- deployments, in deployments where master and backup masters are co-located with region servers, this would basically reduce the capacity of the cluster. Otherwise in deployments where backup masters and active master is not co-located, the users will probably want backup masters to not host any region server (since it was the case already). &lt;/p&gt;

&lt;p&gt;I think we should do a all-or-nothing approach rather that this weight based config which is just yet another parameter to worry about. &lt;/p&gt;</comment>
                            <comment id="13970373" author="jxiang" created="Wed, 16 Apr 2014 02:51:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;Today META/ns tables are already shared with the other tables, and there is little special treatment for the region server hosting meta. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think that&apos;s the issue we&apos;d like to enhance. We want the region server hosting meta doesn&apos;t host too many heavy regions so that we can improve the meta availability, right?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think we should do a all-or-nothing approach rather that this weight based config which is just yet another parameter to worry about. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Currently, we already support all or nothing. With this patch, it will make it more flexible so that users don&apos;t have to leave those backup masters totally idle, they don&apos;t need to worry too much about region movement/data locality in case each region server hosts many regions.&lt;/p&gt;
</comment>
                            <comment id="13973598" author="jxiang" created="Fri, 18 Apr 2014 00:02:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;, what do you think? Are you ok to get this patch in? Thanks.&lt;/p&gt;</comment>
                            <comment id="13974271" author="enis" created="Fri, 18 Apr 2014 17:27:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think that&apos;s the issue we&apos;d like to enhance. We want the region server hosting meta doesn&apos;t host too many heavy regions so that we can improve the meta availability, right?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We already have separate priority handlers and separate wal, etc in place right? Plus the active master right now only hosts system tables, so this is not a problem for backup masters right? Are you concerned with the failover? &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Currently, we already support all or nothing. With this patch, it will make it more flexible so that users don&apos;t have to leave those backup masters totally idle, they don&apos;t need to worry too much about region movement/data locality in case each region server hosts many regions.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Fair enough, but configuring this for a cluster is still not clear. What value should we default? What value should a 20 node cluster use, etc. It might be ok if we default to backups not hosting any regions. Then if the user prefers to use the capacity, they can explicitly request so. &lt;/p&gt;</comment>
                            <comment id="13974436" author="jxiang" created="Fri, 18 Apr 2014 20:15:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;Are you concerned with the failover?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, that&apos;s the concern here. I was thinking later on, we can open the meta on the backup master as well after we support opening a region in multiple servers. This way, it will be much fast to fail over an active master change.&lt;/p&gt;

&lt;p&gt;As to the weight, basically, it means how many regions to host by a backup master compared to a normal region server. The default is 4, i.e. by default, the number of regions opened on a backup master is 1/4 of the number of regions opened on a normal region server. Should we set the default value to 1 (backup master is treated the same as a normal region server) or a big number (less regions)?  If big, how big should be proper?&lt;/p&gt;

&lt;p&gt;If we set the weight to 1, it means there is no default behavior change: you can just ignore the new configuration parameter; in the meantime, others can fine-tune it and get more flexibility if needed.&lt;/p&gt;</comment>
                            <comment id="13975844" author="enis" created="Mon, 21 Apr 2014 18:30:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should we set the default value to 1 (backup master is treated the same as a normal region server) or a big number (less regions)? If big, how big should be proper?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I was thinking of setting the value to 0, which gives us the 0.98- behavior of backup masters not hosting any regions. If users want to use extra capacity they can enable this setting manually.&lt;/p&gt;</comment>
                            <comment id="13975883" author="jxiang" created="Mon, 21 Apr 2014 18:46:19 +0000"  >&lt;p&gt;The patch is just for trunk. I thought we prefer 1.0 to have the new behavior.&lt;/p&gt;</comment>
                            <comment id="13975974" author="stack" created="Mon, 21 Apr 2014 20:10:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;I was thinking of setting the value to 0, which gives us the 0.98- behavior of backup masters not hosting any regions. If users want to use extra capacity they can enable this setting manually.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I suggest we let this issue in and then elsewhere discuss what 1.0 rolls out with elsewhere &amp;#8211; in subtask on the 1.0 issue.&lt;/p&gt;

&lt;p&gt;I&apos;d be in favor of master and backup masters carrying full complement of regions in 1.0  (if we can ensure that the master  handlers are processed ahead of any others); i.e. more radical than Jimmy has it his adding support for master and backup masters carrying &apos;light&apos; loadings.   Sounds like you&apos;d like us to replicate the old deploy layout &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; but with option to move to the &apos;new&apos;.&lt;/p&gt;</comment>
                            <comment id="13976006" author="enis" created="Mon, 21 Apr 2014 20:37:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;Sounds like you&apos;d like us to replicate the old deploy layout Enis Soztutar but with option to move to the &apos;new&apos;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes. Least amount of surprises. Since we are right now defaulting to master having no user level regions, we should also default to backup masters not having any user level regions. &lt;br/&gt;
It may be ok to change the defaults so that both active and backup masters have normal region load (weight 1), but I think we should be consistent for region loads of active and backup masters. Since META is already shared in 0.98- setups, it should be fine to have master be just another region server. In that case, we do not even need this issue? &lt;/p&gt;</comment>
                            <comment id="13976031" author="stack" created="Mon, 21 Apr 2014 21:03:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;In that case, we do not even need this issue?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Perhaps.  I&apos;m not sure how we currently keep backup masters &apos;clear&apos;.  Wouldn&apos;t we want it done in the LB?  Or how is it done currently &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt;?  Thanks.&lt;/p&gt;</comment>
                            <comment id="13976050" author="jxiang" created="Mon, 21 Apr 2014 21:14:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;In that case, we do not even need this issue?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This patch makes it possible to put some load on backup masters. So that users can make adjustments per their need.  I hope we don&apos;t need this issue, if not for the region moving concern during master failover.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;m not sure how we currently keep backup masters &apos;clear&apos;.  Wouldn&apos;t we want it done in the LB?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, it&apos;s done in the LB.&lt;/p&gt;
</comment>
                            <comment id="13977144" author="jxiang" created="Tue, 22 Apr 2014 18:08:07 +0000"  >&lt;p&gt;Can we get this in and deal with the default values in a followup issue?&lt;/p&gt;</comment>
                            <comment id="13977199" author="stack" created="Tue, 22 Apr 2014 18:55:47 +0000"  >&lt;p&gt;Good by me.  Thinking on it, I think it&apos;d be fine to flag in a release note that Master and BUMaster will carry full-complement of regions after upgrade (unless you configure it to work the old way).  Having this option where *Master&apos;s carry a lighter loading would be a nice-to-have though I think it will be little used.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt; If we set it so backup masters should NOT carry regions, does it use this code path &amp;#8211; the one in this patch?&lt;/p&gt;

&lt;p&gt;See what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; says.&lt;/p&gt;</comment>
                            <comment id="13977232" author="jxiang" created="Tue, 22 Apr 2014 19:13:47 +0000"  >&lt;blockquote&gt;&lt;p&gt;If we set it so backup masters should NOT carry regions, does it use this code path &#8211; the one in this patch?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No, it doesn&apos;t use this patch. It is a different configuration. Probably it&apos;s better to do some consolidation and use just the configuration in this patch?&lt;/p&gt;</comment>
                            <comment id="13977537" author="stack" created="Tue, 22 Apr 2014 22:07:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;Probably it&apos;s better to do some consolidation and use just the configuration in this patch?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It would make this patch indispensible (smile).&lt;/p&gt;</comment>
                            <comment id="13978349" author="jxiang" created="Wed, 23 Apr 2014 15:56:04 +0000"  >&lt;p&gt;Attached patch v3 that uses only one configuration to control if assigning any regions to backup masters, if so, the number of regions to assign to backup masters relative to normal region servers. The default weight is 1, i.e. a backup master is treated the same as a normal region server in region assignment.&lt;/p&gt;</comment>
                            <comment id="13978542" author="hadoopqa" created="Wed, 23 Apr 2014 17:58:18 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12641492/hbase-10873_v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12641492/hbase-10873_v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12641492&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 12 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestMultiParallel&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9372//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13979125" author="jxiang" created="Thu, 24 Apr 2014 00:18:19 +0000"  >&lt;p&gt;The test failure is not related. If no objection, I will commit v3 tomorrow. We can change the default setting in a separate issue if needed.&lt;/p&gt;</comment>
                            <comment id="13981235" author="jxiang" created="Fri, 25 Apr 2014 16:49:40 +0000"  >&lt;p&gt;Integrated into trunk. Thanks.&lt;/p&gt;</comment>
                            <comment id="13981485" author="hudson" created="Fri, 25 Apr 2014 19:30:17 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5117 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5117/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5117/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10873&quot; title=&quot;Control number of regions assigned to backup masters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10873&quot;&gt;&lt;del&gt;HBASE-10873&lt;/del&gt;&lt;/a&gt; Control number of regions assigned to backup masters (jxiang: rev 1590078)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/resources/hbase-default.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/BaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/ClusterLoadState.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/FavoredNodeLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/SimpleLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/balancer/StochasticLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/BalancerTestBase.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestBaseLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestDefaultLoadBalancer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/master/balancer/TestStochasticLoadBalancer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14330487" author="enis" created="Sat, 21 Feb 2015 23:28:51 +0000"  >&lt;p&gt;Closing this issue after 0.99.0 release. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12703241">HBASE-10815</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12706986">HBASE-10923</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12639016" name="hbase-10873.patch" size="43265" author="jxiang" created="Mon, 7 Apr 2014 16:55:09 +0000"/>
                            <attachment id="12640327" name="hbase-10873_v2.patch" size="44757" author="jxiang" created="Tue, 15 Apr 2014 20:39:47 +0000"/>
                            <attachment id="12641492" name="hbase-10873_v3.patch" size="46120" author="jxiang" created="Wed, 23 Apr 2014 15:56:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 7 Apr 2014 18:45:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>384039</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1u5uf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>384307</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>