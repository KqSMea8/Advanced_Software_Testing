<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:18:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4398/HBASE-4398.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4398] If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4398</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.&lt;/p&gt;

&lt;p&gt;We can reproduce the problem by the following instructions:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;- Add HRegionPartitioner.class to the 4th argument of

TableMapReduceUtil#initTableReducerJob()

at line around 133
in src/test/java/org/apache/hadoop/hbase/mapreduce/TestTableMapReduce.java

- Change or remove &quot;hbase.zookeeper.property.clientPort&quot; property

in hbase-site.xml ( for example, changed to 12345 ).

- run testMultiRegionTable()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then I got error messages as following:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2011-09-12 22:28:51,020 DEBUG [Thread-832] zookeeper.ZKUtil(93): hconnection opening connection to ZooKeeper with ensemble (localhost:12345)
2011-09-12 22:28:51,022 INFO  [Thread-832] zookeeper.RecoverableZooKeeper(89): The identifier of this process is 43200@imac.local
2011-09-12 22:28:51,123 WARN  [Thread-832] zookeeper.RecoverableZooKeeper(161): Possibly transient ZooKeeper exception: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /hbase/master
2011-09-12 22:28:51,123 INFO  [Thread-832] zookeeper.RecoverableZooKeeper(173): The 1 times to retry ZooKeeper after sleeping 1000 ms

 =====

2011-09-12 22:29:02,418 ERROR [Thread-832] mapreduce.HRegionPartitioner(125): java.io.IOException: org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation@2e54e48d closed
2011-09-12 22:29:02,422 WARN  [Thread-832] mapred.LocalJobRunner$Job(256): job_local_0001
java.lang.NullPointerException
       at org.apache.hadoop.hbase.mapreduce.HRegionPartitioner.setConf(HRegionPartitioner.java:128)
       at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:62)
       at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
       at org.apache.hadoop.mapred.MapTask$NewOutputCollector.&amp;lt;init&amp;gt;(MapTask.java:527)
       at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:613)
       at org.apache.hadoop.mapred.MapTask.run(MapTask.java:305)
       at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:177)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think HTable should connect to ZooKeeper at port 21818 configured at client side instead of 12345 in hbase-site.xml&lt;br/&gt;
and It might be caused by &quot;HBaseConfiguration.addHbaseResources(conf);&quot; in HRegionPartitioner#setConf(Configuration).&lt;/p&gt;

&lt;p&gt;And this might mean that all of client side configurations, also configured in hbase-site.xml, are overwritten caused by this problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12522982">HBASE-4398</key>
            <summary>If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ueshin">Takuya Ueshin</assignee>
                                    <reporter username="ueshin">Takuya Ueshin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Sep 2011 01:15:58 +0000</created>
                <updated>Wed, 3 Apr 2013 05:54:46 +0000</updated>
                            <resolved>Thu, 29 Mar 2012 21:26:45 +0000</resolved>
                                    <version>0.90.4</version>
                                    <fixVersion>0.94.0</fixVersion>
                    <fixVersion>0.95.1</fixVersion>
                                    <component>mapreduce</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13241260" author="ueshin" created="Thu, 29 Mar 2012 14:24:32 +0000"  >&lt;p&gt;I attatched a patch file.&lt;br/&gt;
Tnis includes a patch for HRegionPartitioner and a test case.&lt;/p&gt;</comment>
                            <comment id="13241787" author="stack" created="Thu, 29 Mar 2012 21:21:39 +0000"  >&lt;p&gt;Good one Takuya.  Thats broke.  I would suggest that your test case while comprehensive, it is way overkill for your fix.  Its also mostly a copy of another heavy-weight test we already run.   I can&apos;t believe I&apos;m saying this but I&apos;m going to commit this fix w/o including the test.&lt;/p&gt;</comment>
                            <comment id="13241792" author="stack" created="Thu, 29 Mar 2012 21:27:10 +0000"  >&lt;p&gt;Thanks for the patch Takuya.  I applied it to 0.92, 0.94, and trunk.&lt;/p&gt;</comment>
                            <comment id="13241891" author="hudson" created="Thu, 29 Mar 2012 22:45:34 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #67 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/67/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/67/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4398&quot; title=&quot;If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4398&quot;&gt;&lt;del&gt;HBASE-4398&lt;/del&gt;&lt;/a&gt; If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml (Revision 1307117)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapreduce/HRegionPartitioner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13241994" author="hudson" created="Fri, 30 Mar 2012 01:25:31 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #344 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/344/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/344/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4398&quot; title=&quot;If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4398&quot;&gt;&lt;del&gt;HBASE-4398&lt;/del&gt;&lt;/a&gt; If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml (Revision 1307118)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/mapreduce/HRegionPartitioner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13242062" author="hudson" created="Fri, 30 Mar 2012 05:05:34 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #154 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/154/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/154/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4398&quot; title=&quot;If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4398&quot;&gt;&lt;del&gt;HBASE-4398&lt;/del&gt;&lt;/a&gt; If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml (Revision 1307116)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/HRegionPartitioner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13242447" author="hudson" created="Fri, 30 Mar 2012 15:33:44 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #6 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/6/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/6/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4398&quot; title=&quot;If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4398&quot;&gt;&lt;del&gt;HBASE-4398&lt;/del&gt;&lt;/a&gt; If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml (Revision 1307117)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapreduce/HRegionPartitioner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13242473" author="hudson" created="Fri, 30 Mar 2012 15:53:52 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2698 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2698/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2698/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4398&quot; title=&quot;If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4398&quot;&gt;&lt;del&gt;HBASE-4398&lt;/del&gt;&lt;/a&gt; If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml (Revision 1307116)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/HRegionPartitioner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13245363" author="ueshin" created="Tue, 3 Apr 2012 14:44:47 +0000"  >&lt;p&gt;Rolled back in trunk?&lt;/p&gt;</comment>
                            <comment id="13245381" author="stack" created="Tue, 3 Apr 2012 14:59:44 +0000"  >&lt;p&gt;@Takuya Sorry about that.  A temporary disable while trying to figure why trunk build was broken got committed.  I fixed  trunk over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5704&quot; title=&quot;HBASE-4398 mistakenly rolled back on trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5704&quot;&gt;&lt;del&gt;HBASE-5704&lt;/del&gt;&lt;/a&gt;.  Thanks for noticing this.&lt;/p&gt;</comment>
                            <comment id="13245750" author="hudson" created="Tue, 3 Apr 2012 21:08:36 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2706 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2706/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2706/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5704&quot; title=&quot;HBASE-4398 mistakenly rolled back on trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5704&quot;&gt;&lt;del&gt;HBASE-5704&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4398&quot; title=&quot;If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4398&quot;&gt;&lt;del&gt;HBASE-4398&lt;/del&gt;&lt;/a&gt; mistakenly rolled back on trunk (Revision 1308964)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/HRegionPartitioner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13246954" author="hudson" created="Thu, 5 Apr 2012 02:52:05 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #104 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/104/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/104/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4398&quot; title=&quot;If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4398&quot;&gt;&lt;del&gt;HBASE-4398&lt;/del&gt;&lt;/a&gt; If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml (Revision 1307118)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/mapreduce/HRegionPartitioner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13247030" author="hudson" created="Thu, 5 Apr 2012 05:06:42 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #157 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/157/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/157/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5704&quot; title=&quot;HBASE-4398 mistakenly rolled back on trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5704&quot;&gt;&lt;del&gt;HBASE-5704&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4398&quot; title=&quot;If HRegionPartitioner is used in MapReduce, client side configurations are overwritten by hbase-site.xml.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4398&quot;&gt;&lt;del&gt;HBASE-4398&lt;/del&gt;&lt;/a&gt; mistakenly rolled back on trunk (Revision 1308964)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/HRegionPartitioner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12520426" name="HBASE-4398.patch" size="10768" author="ueshin" created="Thu, 29 Mar 2012 14:24:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 29 Mar 2012 21:21:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27286</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 37 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08rqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49094</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>