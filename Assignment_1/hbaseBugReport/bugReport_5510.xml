<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:28:24 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5510/HBASE-5510.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5510] Pass region info in LoadBalancer.randomAssignment(List&lt;ServerName&gt; servers)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5510</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt; In LB there is randomAssignment(List&amp;lt;ServerName servers&amp;gt;) API which will be used by AM to assign&lt;br/&gt;
 a region from a down RS. &lt;span class=&quot;error&quot;&gt;&amp;#91;This will be also used in other cases like call to assign() API from client&amp;#93;&lt;/span&gt;&lt;br/&gt;
 I feel it would be better to pass the HRegionInfo also into this method. When the LB making a choice for a region&lt;br/&gt;
 assignment, when one RS is down, it would be nice that the LB knows for which region it is doing this server selection.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Scenario&lt;/ins&gt;&lt;br/&gt;
 While one RS down, we wanted the regions to get moved to other RSs but a set of regions stay together. We are having custom load balancer but with the current way of LB interface this is not possible. Another way is I can allow a random assignment of the regions at the RS down time. Later with a cluster balance I can balance the regions as I need. But this might make regions assign 1st to one RS and then again move to another. Also for some time period my business use case can not get satisfied.&lt;/p&gt;

&lt;p&gt;Also I have seen some issue in JIRA which speaks about making sure that Root and META regions always sit in some specific RSs. With the current LB API this wont be possible in future.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12544956">HBASE-5510</key>
            <summary>Pass region info in LoadBalancer.randomAssignment(List&lt;ServerName&gt; servers)</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anoopsamjohn">Anoop Sam John</assignee>
                                    <reporter username="anoopsamjohn">Anoop Sam John</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Mar 2012 15:50:55 +0000</created>
                <updated>Mon, 23 Sep 2013 18:31:22 +0000</updated>
                            <resolved>Thu, 22 Mar 2012 10:53:46 +0000</resolved>
                                    <version>0.92.0</version>
                                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13221027" author="ram_krish" created="Fri, 2 Mar 2012 16:24:15 +0000"  >&lt;p&gt;@Ted&lt;/p&gt;

&lt;p&gt;If interface change is ok, I can make a patch for it. &lt;/p&gt;</comment>
                            <comment id="13221045" author="zhihyu@ebaysf.com" created="Fri, 2 Mar 2012 16:52:04 +0000"  >&lt;p&gt;For getRegionPlan(), we already provide server to exclude:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  RegionPlan getRegionPlan(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; RegionState state,
      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ServerName serverToExclude, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; forceNewPlan) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Does the above not serve the purpose of migrating region away ?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;but a set of regions stay together&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Can I get some explanation for the rationale here ?&lt;br/&gt;
Load balancer should honor block locality when moving regions. Why should these regions stay together ?&lt;/p&gt;

&lt;p&gt;Changing interface is fine for TRUNK.&lt;/p&gt;

&lt;p&gt;But I want to understand the use case more.&lt;/p&gt;</comment>
                            <comment id="13221094" author="ram_krish" created="Fri, 2 Mar 2012 17:53:46 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
The rationale is like,&lt;br/&gt;
I have set of regions S1...Sn and R1...Rn...In this i expect S1-R1, S2-R2 ...to be colocated in the same RS.&lt;/p&gt;

&lt;p&gt;S1...Sn are balanced by one LB.&lt;br/&gt;
There is a custom LB which will balance R1..Rn. Now this LB should get the assignment done by first LB and based on that it will assign R1..Rn.  Finally ensuring the colocation.&lt;br/&gt;
Am i clear Ted?  &lt;/p&gt;</comment>
                            <comment id="13221105" author="zhihyu@ebaysf.com" created="Fri, 2 Mar 2012 18:03:26 +0000"  >&lt;p&gt;Should colocation be satisfied by randomAssignment() ?&lt;/p&gt;

&lt;p&gt;By the time of assigning regions R1 to Rn, one of more of S1 to Sn may have been moved to new location (manual operation, server downtime, etc). How do we address this scenario ?&lt;/p&gt;

&lt;p&gt;The HRegionInfo Anoop suggested passing to randomAssignment() is that of the region to be assigned, how do we retrieve its buddy region&apos;s information ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13221537" author="anoopsamjohn" created="Sat, 3 Mar 2012 07:34:31 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
      Thanks for your reply. R1-S1 mapping can be found out using the start and end keys of both these regions. Our design will be so that whenever we see S1 when will be able to judge which R1 is its buddy..  am I clear to you? But now the issue is randomAssignment() will not reveal the region for which the selection is happening now. If we can get this we will be able to do our business scenario using our LB..  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;@Ram : Thanks for the explanation comment.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13221547" author="zhihyu@ebaysf.com" created="Sat, 3 Mar 2012 09:43:15 +0000"  >&lt;p&gt;Can I see the patch ?&lt;/p&gt;</comment>
                            <comment id="13221556" author="anoopsamjohn" created="Sat, 3 Mar 2012 11:22:36 +0000"  >&lt;p&gt;Pls see the patch.&lt;/p&gt;</comment>
                            <comment id="13221600" author="zhihyu@ebaysf.com" created="Sat, 3 Mar 2012 14:51:27 +0000"  >&lt;p&gt;Looking at other methods in LoadBalancer, the regions are passed as first parameter.&lt;br/&gt;
I think randomAssignment() should follow this convention.&lt;/p&gt;

&lt;p&gt;Please wrap long lines in the patch.&lt;/p&gt;

&lt;p&gt;Currently LoadBalancer is marked @InterfaceAudience.Private&lt;br/&gt;
I think the use case presented in this JIRA clearly means it shouldn&apos;t be private.&lt;br/&gt;
Please change it to @InterfaceAudience.Public in the next patch.&lt;/p&gt;</comment>
                            <comment id="13221812" author="anoopsamjohn" created="Sun, 4 Mar 2012 07:03:32 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
     Addressed your comments in the new patch.&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="13221815" author="ram_krish" created="Sun, 4 Mar 2012 07:17:53 +0000"  >&lt;p&gt;The patch looks good to me.&lt;br/&gt;
@Ted&lt;br/&gt;
Do you want to take a look at the updated patch?&lt;/p&gt;</comment>
                            <comment id="13221909" author="zhihyu@ebaysf.com" created="Sun, 4 Mar 2012 14:57:32 +0000"  >&lt;p&gt;Patch v2 looks good.&lt;/p&gt;

&lt;p&gt;Minor comments:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      balancer.randomAssignment(state.getRegion(),servers));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;A space is needed between comma and servers.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; ServerName randomAssignment(HRegionInfo regionInfo,List&amp;lt;ServerName&amp;gt; servers);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Wrap long line, please.&lt;/p&gt;</comment>
                            <comment id="13221920" author="hadoopqa" created="Sun, 4 Mar 2012 15:45:59 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12516978/HBase-5510_2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12516978/HBase-5510_2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -129 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 154 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1089//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1089//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1089//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1089//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1089//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1089//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13221938" author="zhihyu@ebaysf.com" created="Sun, 4 Mar 2012 17:10:52 +0000"  >&lt;p&gt;+1 on patch v3&lt;/p&gt;

&lt;p&gt;I will integrate to TRUNK Monday afternoon if there is no objection.&lt;/p&gt;</comment>
                            <comment id="13221952" author="hadoopqa" created="Sun, 4 Mar 2012 17:55:03 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12517004/HBase-5010_3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12517004/HBase-5010_3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -129 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 154 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1092//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1092//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1092//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1092//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1092//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1092//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13222490" author="zhihyu@ebaysf.com" created="Mon, 5 Mar 2012 18:43:42 +0000"  >&lt;p&gt;Integrated to TRUNK.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Anoop.&lt;/p&gt;</comment>
                            <comment id="13775376" author="stack" created="Mon, 23 Sep 2013 18:31:22 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12517004" name="HBase-5010_3.patch" size="2226" author="anoopsamjohn" created="Sun, 4 Mar 2012 17:07:21 +0000"/>
                            <attachment id="12516934" name="HBase-5510.patch" size="1985" author="anoopsamjohn" created="Sat, 3 Mar 2012 11:21:58 +0000"/>
                            <attachment id="12516978" name="HBase-5510_2.patch" size="2217" author="anoopsamjohn" created="Sun, 4 Mar 2012 07:02:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 2 Mar 2012 16:24:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>230142</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0htk7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102051</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>