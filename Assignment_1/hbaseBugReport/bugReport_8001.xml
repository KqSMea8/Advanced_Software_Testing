<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:51:07 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8001/HBASE-8001.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8001] Avoid unnecessary lazy seek</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8001</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Lazy seek helps to reduce the real seek needed for multi hfile, when the kv from newer hfile is enough to satisfy the query.&lt;/p&gt;

&lt;p&gt;While in many case, it just push the real seek later, and do not reduce the number of real seek. e.g. there are only one hfile, or storefilescanner is closed and only one left, or the scan need to go through all the versions, or there are only one version of row and a sequence scan is performed. In these case, lazy seek just bring extra overhead.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12635294">HBASE-8001</key>
            <summary>Avoid unnecessary lazy seek</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="colorant">Raymond Liu</assignee>
                                    <reporter username="colorant">Raymond Liu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Mar 2013 08:30:04 +0000</created>
                <updated>Mon, 23 Sep 2013 19:22:24 +0000</updated>
                            <resolved>Wed, 19 Jun 2013 05:01:17 +0000</resolved>
                                    <version>0.94.5</version>
                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.95.2</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>14</watches>
                                                                <comments>
                            <comment id="13594264" author="colorant" created="Wed, 6 Mar 2013 02:50:35 +0000"  >&lt;p&gt;In HBase-8001_onescanner patch, the idea is that when there are only one scanner left, then there is no need for lazy seek. a real seek should always been performed. This is the most simple and easy case can be detected automatically. And it involves the possibility of switch from lazy seek to non lazy reseek, this requires that the scanner is reseekable, there might be multiple place to check this condition. I choose to do it in the scanner level in this patch. it could be done in heap level, while require extra API from scanner.&lt;/p&gt;

&lt;p&gt;Anyway, this is my first thought on how to reduce unnecessary lazy seek. When benchmark this on a single hfile region, the overall table scan throughput can be improved by 8-10%.&lt;/p&gt;</comment>
                            <comment id="13594266" author="colorant" created="Wed, 6 Mar 2013 02:51:25 +0000"  >&lt;p&gt;please help to take a review on this. Thx&lt;/p&gt;</comment>
                            <comment id="13594336" author="hadoopqa" created="Wed, 6 Mar 2013 04:05:12 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12572234/HBASE-8001_onescanner.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12572234/HBASE-8001_onescanner.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4690//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13594444" author="colorant" created="Wed, 6 Mar 2013 07:03:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mikhail&quot; class=&quot;user-hover&quot; rel=&quot;mikhail&quot;&gt;Mikhail Bautin&lt;/a&gt;: would you mind to take a review on this one &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13596792" author="yuzhihong@gmail.com" created="Fri, 8 Mar 2013 04:15:47 +0000"  >&lt;p&gt;If &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8012&quot; title=&quot;Reseek should position to the beginning of file for the first time it is invoked with a KV smaller than the first KV in file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8012&quot;&gt;&lt;del&gt;HBASE-8012&lt;/del&gt;&lt;/a&gt; is checked in, we don&apos;t need this patch, right ?&lt;/p&gt;</comment>
                            <comment id="13596811" author="colorant" created="Fri, 8 Mar 2013 04:36:58 +0000"  >&lt;p&gt;no, will still need this patch to reduce the number of lazy seek, but do not need extra check whether scanner already do a reseek or not&lt;/p&gt;</comment>
                            <comment id="13596813" author="colorant" created="Fri, 8 Mar 2013 04:38:29 +0000"  >&lt;p&gt;typo, s/reseek/real seek/&lt;/p&gt;</comment>
                            <comment id="13596822" author="stack" created="Fri, 8 Mar 2013 04:48:45 +0000"  >&lt;p&gt;+1 on patch.  I will add missing parens on commit here... &lt;/p&gt;

&lt;p&gt;+    if (!this.isReseekable)&lt;br/&gt;
+      return seek(key);&lt;br/&gt;
+&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=colorant&quot; class=&quot;user-hover&quot; rel=&quot;colorant&quot;&gt;Raymond Liu&lt;/a&gt; Mind adding your test run results in here?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; Want to take a look?  This looks like nice improvement.&lt;/p&gt;</comment>
                            <comment id="13596823" author="yuzhihong@gmail.com" created="Fri, 8 Mar 2013 04:56:05 +0000"  >&lt;p&gt;Patch looks good.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isLazy &amp;amp;&amp;amp; (heap.size() &amp;gt; 0)) {
+        &lt;span class=&quot;code-comment&quot;&gt;// If there are only one scanner left, we don&apos;t &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; lazy seek.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;nit: parentheses around new check can be omitted.&lt;/p&gt;</comment>
                            <comment id="13596826" author="lhofhansl" created="Fri, 8 Mar 2013 05:02:18 +0000"  >&lt;p&gt;Looks good to me.&lt;br/&gt;
(This is a simple improvement, I think I want this in 0.94 as well. I&apos;ll do some extra testing there)&lt;/p&gt;</comment>
                            <comment id="13596832" author="ram_krish" created="Fri, 8 Mar 2013 05:07:39 +0000"  >&lt;p&gt;+1 from me.&lt;/p&gt;</comment>
                            <comment id="13596836" author="yuzhihong@gmail.com" created="Fri, 8 Mar 2013 05:10:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;Mind adding your test run results in here?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;QA test result is recorded above.&lt;/p&gt;</comment>
                            <comment id="13596837" author="stack" created="Fri, 8 Mar 2013 05:11:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; Will hold till hear result of your testing.  Thanks.&lt;/p&gt;</comment>
                            <comment id="13596847" author="lhofhansl" created="Fri, 8 Mar 2013 05:29:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; I meant 0.94 testing. Not sure when I&apos;ll get to that. Don&apos;t wait for that.&lt;/p&gt;</comment>
                            <comment id="13596868" author="lhofhansl" created="Fri, 8 Mar 2013 06:18:15 +0000"  >&lt;p&gt;In my scenario I can not measure an improvement:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;all data in the blockcache&lt;/li&gt;
	&lt;li&gt;40m small KVs (8 byte keys, 20 byte values) across two CFs&lt;/li&gt;
	&lt;li&gt;scan + filter where filter filters everything at the server&lt;/li&gt;
	&lt;li&gt;column family with a single column&lt;/li&gt;
	&lt;li&gt;VERSIONS=1&lt;/li&gt;
	&lt;li&gt;table is fully compacted&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Tests:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;adding a single family to Scan object: 11.8&lt;/li&gt;
	&lt;li&gt;adding the family+column to the Scan object: 13.1&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I get the same numbers with or without the patch. The 2nd number should have improved.&lt;/p&gt;</comment>
                            <comment id="13596876" author="stack" created="Fri, 8 Mar 2013 06:25:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; Thanks.&lt;/p&gt;</comment>
                            <comment id="13596882" author="colorant" created="Fri, 8 Mar 2013 06:32:54 +0000"  >&lt;p&gt;Lars Hofhansl : In my case, as I mentioned in 4433, it reduce from 260 to 240s. And in your case the difference of 11.8 v.s 13.1 is 1 next v.s. twice seek(lazy+real). with this patch a lazy seek is avoid, it seems to me should have some improvement, strange.&lt;/p&gt;</comment>
                            <comment id="13596891" author="lhofhansl" created="Fri, 8 Mar 2013 06:38:14 +0000"  >&lt;p&gt;I thought so too. I&apos;ll do some more tests tomorrow. One explanation is that the extra lazy seek does not cost much if the data is all the blockcache...?&lt;/p&gt;</comment>
                            <comment id="13596894" author="colorant" created="Fri, 8 Mar 2013 06:41:59 +0000"  >&lt;p&gt;update to depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8012&quot; title=&quot;Reseek should position to the beginning of file for the first time it is invoked with a KV smaller than the first KV in file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8012&quot;&gt;&lt;del&gt;HBASE-8012&lt;/del&gt;&lt;/a&gt; , do not need to check isReseekable anymore. ( actually will be removed by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8012&quot; title=&quot;Reseek should position to the beginning of file for the first time it is invoked with a KV smaller than the first KV in file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8012&quot;&gt;&lt;del&gt;HBASE-8012&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="13596907" author="colorant" created="Fri, 8 Mar 2013 07:06:25 +0000"  >&lt;p&gt;If it is all blockcache, then performance difference of lazy seek v.s. real seek should have been even smaller?  since then without need to load data, compare to lazy seek, a real seek actually just do an extra block position op. this should not cost much time. And in my test, when Compare family only scan v.s. family+column scan, the majority part of extra time cost is on Create fake key and compare keys between scanner. Then, when in lazy seek path it need to construct two fake key and more compare, while real seek path only need one fake key and less compare. Should save around 1/3 of time. So, might be some other fact we are miss out?&lt;/p&gt;</comment>
                            <comment id="13596919" author="hadoopqa" created="Fri, 8 Mar 2013 07:38:38 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12572716/HBASE-8001_onescanner_v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12572716/HBASE-8001_onescanner_v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestBlocksScanned&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestMinVersions&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestScanner&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4727//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13596924" author="colorant" created="Fri, 8 Mar 2013 07:46:36 +0000"  >&lt;p&gt;Seems a depends relation won&apos;t have the depend on issue&apos;s patch been applied first then apply the current patch? How should I achieve this purpose?&lt;/p&gt;</comment>
                            <comment id="13597036" author="yuzhihong@gmail.com" created="Fri, 8 Mar 2013 11:39:12 +0000"  >&lt;p&gt;You can upload combined patch. &lt;/p&gt;</comment>
                            <comment id="13597354" author="lhofhansl" created="Fri, 8 Mar 2013 18:05:04 +0000"  >&lt;p&gt;Yeah, combined patch is better. Then we can close of the issues as dup.&lt;/p&gt;</comment>
                            <comment id="13597356" author="lhofhansl" created="Fri, 8 Mar 2013 18:06:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=colorant&quot; class=&quot;user-hover&quot; rel=&quot;colorant&quot;&gt;Raymond Liu&lt;/a&gt; Are you testing with sequential Scans, or bulk Gets? (My test was with sequential Scans).&lt;/p&gt;</comment>
                            <comment id="13598461" author="colorant" created="Mon, 11 Mar 2013 01:10:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; I do the test with sequential scans. And without short circuit read, with 1000 client scan caching. 4 node, on each node, 24 map task scan on 24 local region for the single CF, 18 columns table. other than these, seems no other special thing need to mention.&lt;/p&gt;</comment>
                            <comment id="13601002" author="yuzhihong@gmail.com" created="Wed, 13 Mar 2013 10:05:34 +0000"  >&lt;p&gt;@raymond:&lt;br/&gt;
Can you take a look at the test failure above ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13601923" author="colorant" created="Thu, 14 Mar 2013 00:59:15 +0000"  >&lt;p&gt;@Ted:&lt;br/&gt;
That&apos;s due to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8012&quot; title=&quot;Reseek should position to the beginning of file for the first time it is invoked with a KV smaller than the first KV in file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8012&quot;&gt;&lt;del&gt;HBASE-8012&lt;/del&gt;&lt;/a&gt; is not landed, now since 8012 landed, this one should pass the test&lt;/p&gt;</comment>
                            <comment id="13604484" author="lhofhansl" created="Sun, 17 Mar 2013 02:35:07 +0000"  >&lt;p&gt;I would really like to understand what specific scenario this is optimizing. Since you&apos;re doing an M/R job, maybe this is improving only with multiple threads?&lt;br/&gt;
In a single threaded env with a single RS and DN only, I cannot discern any improvement from this, so it must be somewhere else.&lt;/p&gt;</comment>
                            <comment id="13604487" author="lhofhansl" created="Sun, 17 Mar 2013 03:00:50 +0000"  >&lt;p&gt;Does this need many columns and/or column families to show an effect?&lt;/p&gt;</comment>
                            <comment id="13604822" author="colorant" created="Mon, 18 Mar 2013 01:00:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;: I will test upon your scenario to see whether it is due to single thread of single column family or not.&lt;/p&gt;</comment>
                            <comment id="13672771" author="colorant" created="Mon, 3 Jun 2013 02:48:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ted_yu&quot; class=&quot;user-hover&quot; rel=&quot;ted_yu&quot;&gt;Ted Yu&lt;/a&gt;: sorry for late on this issue. busy for other staff. I do this test again in with single RS. I still use M/R job, while the table only have one region. and is 2M rows ,1CF, 18col, without any compression or encoding. size about 3G on disk. And I don&apos;t use blockcache,every time the data is read from disk by a real seek. but as we discussed before, use of blockcache will only led to more gain with this patch.&lt;/p&gt;

&lt;p&gt;with this patch, a 18col full table scan cost 99-101s, while without this patch it will cost 108-109s. still noticeable difference. I test it for several times on each case. the result is pretty stable.&lt;/p&gt;

&lt;p&gt;Do you mind to take a end2end test? I am not sure is there any other thing might still have impact upon your test case. might be that the data size is too small? &lt;/p&gt;</comment>
                            <comment id="13673356" author="lhofhansl" created="Mon, 3 Jun 2013 17:42:31 +0000"  >&lt;p&gt;In any event the v2 patch looks good to me.&lt;/p&gt;

&lt;p&gt;I&apos;m happy to just commit this. Any objections from anybody?&lt;/p&gt;</comment>
                            <comment id="13677626" author="stack" created="Thu, 6 Jun 2013 22:50:40 +0000"  >&lt;p&gt;Should heap.size() &amp;gt; 0 be heap.size() &amp;gt; 1 so we don&apos;t do lazy against single file? (I am not up on this code so could be way off)&lt;/p&gt;</comment>
                            <comment id="13677753" author="colorant" created="Fri, 7 Jun 2013 01:59:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; because the last scanner is poll out before this.&lt;/p&gt;</comment>
                            <comment id="13677800" author="lhofhansl" created="Fri, 7 Jun 2013 04:16:28 +0000"  >&lt;p&gt;Yeah, the heap has all the scanners except the current one. So if he heap is empty there&apos;s only a single scanner left.&lt;/p&gt;</comment>
                            <comment id="13677803" author="stack" created="Fri, 7 Jun 2013 04:29:12 +0000"  >&lt;p&gt;Ok.  Sounds reasonable.  Thanks.&lt;/p&gt;</comment>
                            <comment id="13687614" author="stack" created="Wed, 19 Jun 2013 05:01:18 +0000"  >&lt;p&gt;I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8767&quot; title=&quot;Backport hbase-8001 and hbase-8012, avoid lazy seek&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8767&quot;&gt;&lt;del&gt;HBASE-8767&lt;/del&gt;&lt;/a&gt; for 0.94.9.  Committed to 0.95 and trunk.  Thanks Raymond for patch.&lt;/p&gt;</comment>
                            <comment id="13687831" author="hudson" created="Wed, 19 Jun 2013 10:16:48 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #173 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/173/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/173/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8767&quot; title=&quot;Backport hbase-8001 and hbase-8012, avoid lazy seek&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8767&quot;&gt;&lt;del&gt;HBASE-8767&lt;/del&gt;&lt;/a&gt; Backport hbase-8001, avoid lazy seek (original patch by Raymond Liu) (Revision 1494494)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;/p&gt;</comment>
                            <comment id="13687880" author="hudson" created="Wed, 19 Jun 2013 11:08:07 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #1018 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1018/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1018/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8767&quot; title=&quot;Backport hbase-8001 and hbase-8012, avoid lazy seek&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8767&quot;&gt;&lt;del&gt;HBASE-8767&lt;/del&gt;&lt;/a&gt; Backport hbase-8001, avoid lazy seek (original patch by Raymond Liu) (Revision 1494494)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;/p&gt;</comment>
                            <comment id="13697916" author="hudson" created="Tue, 2 Jul 2013 16:07:20 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #187 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/187/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/187/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8767&quot; title=&quot;Backport hbase-8001 and hbase-8012, avoid lazy seek&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8767&quot;&gt;&lt;del&gt;HBASE-8767&lt;/del&gt;&lt;/a&gt; Backport hbase-8001 and hbase-8012, avoid lazy seek (original patches by Raymond Liu) (Revision 1498953)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;/p&gt;</comment>
                            <comment id="13697925" author="hudson" created="Tue, 2 Jul 2013 16:13:17 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #1032 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1032/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1032/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8767&quot; title=&quot;Backport hbase-8001 and hbase-8012, avoid lazy seek&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8767&quot;&gt;&lt;del&gt;HBASE-8767&lt;/del&gt;&lt;/a&gt; Backport hbase-8001 and hbase-8012, avoid lazy seek (original patches by Raymond Liu) (Revision 1498953)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12523503">HBASE-4433</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12524372">HBASE-4465</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12635495">HBASE-8012</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12572234" name="HBASE-8001_onescanner.patch" size="1841" author="colorant" created="Wed, 6 Mar 2013 02:50:35 +0000"/>
                            <attachment id="12572716" name="HBASE-8001_onescanner_v2.patch" size="775" author="colorant" created="Fri, 8 Mar 2013 06:41:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 6 Mar 2013 04:05:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315787</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ihpr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316130</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>