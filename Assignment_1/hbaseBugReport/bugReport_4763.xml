<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:21:49 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4763/HBASE-4763.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4763] Integrate surefire and junit for category management</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4763</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;As of today, Surefire integrates category on the trunk of 2.11 version: &lt;a href=&quot;http://jira.codehaus.org/browse/SUREFIRE-329&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://jira.codehaus.org/browse/SUREFIRE-329&lt;/a&gt; . It may requires private patches as well.&lt;/p&gt;

&lt;p&gt;It may impact JUnit: &lt;a href=&quot;https://github.com/KentBeck/junit/issues/359&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/KentBeck/junit/issues/359&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This jira is about this integration. We will need a repo for this.&lt;/p&gt;

&lt;p&gt;For the naming of the versions to be created, I don&apos;t know if there is a convention. If not I would propose: 2.10-patched-HBASE&lt;/p&gt;

&lt;p&gt;Obviously, it&apos;s important to get our changes integrated in the main release: we&apos;re not forking surefire &amp;amp; junit!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12530939">HBASE-4763</key>
            <summary>Integrate surefire and junit for category management</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nkeywal">Nicolas Liochon</assignee>
                                    <reporter username="nkeywal">Nicolas Liochon</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Nov 2011 23:46:21 +0000</created>
                <updated>Sat, 26 Nov 2011 18:37:10 +0000</updated>
                            <resolved>Sat, 26 Nov 2011 18:37:10 +0000</resolved>
                                    <version>0.94.0</version>
                                                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13148621" author="nkeywal" created="Fri, 11 Nov 2011 17:56:40 +0000"  >&lt;p&gt;Ok, I have it working on my env now. Still testing, but there is now a reasonable chance to have it working well, so we can start the next step. We need a private version for surefire &amp;amp; junit on a shared maven repository.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;surefire 2.11 trunk r1200541 patched (see attached file)&lt;br/&gt;
Why a private version: because we need the &apos;Category&apos; feature and there is not yet an official release for it. See surefire issues #329 and #786. We also need to fix some output stuff already in progress at surefire team but not yet in the trunk. I hope this will be solved in 2.12.&lt;br/&gt;
This version would be named: 2.11-TRUNK-HBASE&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;JUnit 4.10 final patched, available on the branch &quot;hbase&quot; at &lt;a href=&quot;https://github.com/nkeywal/junit&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/nkeywal/junit&lt;/a&gt;&lt;br/&gt;
Why a private version: to filter the tests by categories, JUNit does a &apos;class.forName&apos; that initializes fully the static. With HBase it costly and fails because the initialization needs specific config files that are not in the initial class loader. The private patch fixes this, and with some luck this patch will be included in the next version of JUnit. See issue #359.&lt;br/&gt;
This version would be named: 4.10-HBASE&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Surefire is integrated with maven, and publishing to a repository should be easy.&lt;br/&gt;
That&apos;s not the case with JUnit, the build script does not seem to include a maven repository integration.&lt;/p&gt;

&lt;p&gt;I can make available to the repository owner:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;for surefire: full maven compiles results (ex: extract of the local repo after a mvn install).&lt;/li&gt;
	&lt;li&gt;for junit: the compiled jar.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Important point for the categories: what seems to be working is:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;categories on classes&lt;/li&gt;
	&lt;li&gt;you can set the categories you want to use, excluding categories was not working after #329 (not tried on #786)&lt;/li&gt;
	&lt;li&gt;if you have a class without category, you will have a nice error message: initializationError(org.junit.runner.manipulation.Filter).&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13151107" author="nkeywal" created="Wed, 16 Nov 2011 09:34:57 +0000"  >&lt;p&gt;Note that:I found a new bug in surefire, and fixed it. It&apos;s &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-791&quot; title=&quot;JUnit47 provider reports incorrect elapsed time on test failure.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-791&quot;&gt;&lt;del&gt;SUREFIRE-791&lt;/del&gt;&lt;/a&gt; (Unit47 provider reports incorrect elapsed time on test failure.). It should be on their trunk soon, so it makes sense to take it, as they fixed as well a regression of the 2.10, &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-785&quot; title=&quot;Lots of newlines being strewn about in test output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-785&quot;&gt;&lt;del&gt;SUREFIRE-785&lt;/del&gt;&lt;/a&gt;, (Lots of newlines being strewn about in test output). Not mandatory, but nicer.&lt;/p&gt;</comment>
                            <comment id="13151566" author="nkeywal" created="Wed, 16 Nov 2011 22:07:45 +0000"  >&lt;p&gt;Surefire revision for &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-791&quot; title=&quot;JUnit47 provider reports incorrect elapsed time on test failure.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-791&quot;&gt;&lt;del&gt;SUREFIRE-791&lt;/del&gt;&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-785&quot; title=&quot;Lots of newlines being strewn about in test output&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-785&quot;&gt;&lt;del&gt;SUREFIRE-785&lt;/del&gt;&lt;/a&gt;: r1202059&lt;/p&gt;</comment>
                            <comment id="13151577" author="stack" created="Wed, 16 Nov 2011 22:25:29 +0000"  >&lt;p&gt;You want to give us plugins to host N?   Seems like Gary is volunteering hosting .&lt;/p&gt;</comment>
                            <comment id="13151586" author="nkeywal" created="Wed, 16 Nov 2011 22:35:34 +0000"  >&lt;p&gt;Yes, I am working with him, he&apos;s building surefire &amp;amp; junit today.&lt;/p&gt;</comment>
                            <comment id="13151673" author="ghelmling" created="Thu, 17 Nov 2011 00:22:29 +0000"  >&lt;p&gt;Tweaks to surefire patch changing version number to 2.11-TRUNK-&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1&quot; title=&quot;rest server port should be configurable by hbase-site.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1&quot;&gt;&lt;del&gt;HBASE-1&lt;/del&gt;&lt;/a&gt;, and removing already applied change.&lt;/p&gt;</comment>
                            <comment id="13151677" author="ghelmling" created="Thu, 17 Nov 2011 00:26:30 +0000"  >&lt;p&gt;You should be able to use my repo builds now, by adding the following repository to the HBase pom.xml:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   &amp;lt;repository&amp;gt;
     &amp;lt;id&amp;gt;ghelmling.testing&amp;lt;/id&amp;gt;
     &amp;lt;name&amp;gt;Gary Helmling test repo&amp;lt;/name&amp;gt;
     &amp;lt;url&amp;gt;http:&lt;span class=&quot;code-comment&quot;&gt;//people.apache.org/~garyh/mvn/&amp;lt;/url&amp;gt;
&lt;/span&gt;     &amp;lt;snapshots&amp;gt;
       &amp;lt;enabled&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/enabled&amp;gt;
     &amp;lt;/snapshots&amp;gt;
     &amp;lt;releases&amp;gt;
       &amp;lt;enabled&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/enabled&amp;gt;
     &amp;lt;/releases&amp;gt;
   &amp;lt;/repository&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then change the junit and maven-surefire versions to be:&lt;br/&gt;
junit: 4.10&amp;#45;HBASE&amp;#45;1&lt;br/&gt;
surefire: 2.11&amp;#45;TRUNK&amp;#45;HBASE&amp;#45;1&lt;/p&gt;</comment>
                            <comment id="13152355" author="nkeywal" created="Thu, 17 Nov 2011 21:41:32 +0000"  >&lt;p&gt;We&apos;re going to need &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-793&quot; title=&quot;JUnit47 provider reports incorrect time in the XML report&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-793&quot;&gt;&lt;del&gt;SUREFIRE-793&lt;/del&gt;&lt;/a&gt; (JUnit47 provider reports incorrect time in the XML report). I&apos;ve got a very dirty patch with many many modifications, I need to spend some time on it to clean it as much as possible (it won&apos;t be very clean however).&lt;/p&gt;</comment>
                            <comment id="13152803" author="nkeywal" created="Fri, 18 Nov 2011 12:01:41 +0000"  >&lt;p&gt;Fix for surefire 793. I&apos;ve been able to reduce the changes to a minimum. Tested on a full build, seems to run fine. I push it on they jira as well, but it will require some changes to manage some cases we don&apos;t care about and to be more integrated in their design, so we should not wait for the trunk here.&lt;/p&gt;</comment>
                            <comment id="13153412" author="stack" created="Sat, 19 Nov 2011 06:37:00 +0000"  >&lt;p&gt;@nkeywal The attached patch needs to be applied to current surefire trunk, built, and then uploaded to Gary&apos;s repo on apache?&lt;/p&gt;</comment>
                            <comment id="13153494" author="nkeywal" created="Sat, 19 Nov 2011 13:58:08 +0000"  >&lt;p&gt;@stack: yes, but Gary has actually created a special repo for surefire and built it from this.&lt;/p&gt;

&lt;p&gt;Now we have:&lt;br/&gt;
Junit: 4.10-&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1&quot; title=&quot;rest server port should be configurable by hbase-site.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1&quot;&gt;&lt;del&gt;HBASE-1&lt;/del&gt;&lt;/a&gt;, source code on &lt;a href=&quot;https://github.com/nkeywal/junit&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/nkeywal/junit&lt;/a&gt;, branch &quot;hbase&quot;&lt;br/&gt;
Surefire: 2.11-TRUNK-&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2&quot; title=&quot;hlog numbers should wrap around when they reach 999&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2&quot;&gt;&lt;del&gt;HBASE-2&lt;/del&gt;&lt;/a&gt;, source code on &lt;a href=&quot;https://github.com/ghelmling/maven-surefire&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/ghelmling/maven-surefire&lt;/a&gt; branch &quot;2.11-TRUNK-HBASE&quot;&lt;/p&gt;

&lt;p&gt;Both are in Gary&apos;s repo on &lt;a href=&quot;http://people.apache.org/~garyh/mvn&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~garyh/mvn&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4781&quot; title=&quot;Pom update to use the new versions of surefire &amp;amp; junit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4781&quot;&gt;&lt;del&gt;HBASE-4781&lt;/del&gt;&lt;/a&gt;, I am currently checking that it works well with Jenkins, if yes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the patch on pom.xml in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4781&quot; title=&quot;Pom update to use the new versions of surefire &amp;amp; junit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4781&quot;&gt;&lt;del&gt;HBASE-4781&lt;/del&gt;&lt;/a&gt; will be commited.&lt;/li&gt;
	&lt;li&gt;we will be able to close the two Jiras.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13157519" author="nkeywal" created="Sat, 26 Nov 2011 15:29:27 +0000"  >&lt;p&gt;I believe the integration is successful, we now have to wait for the fix to be available in official versions, but we can close this JIRA. We will need new JIRA to integrate the official versions. We will need:&lt;/p&gt;

&lt;p&gt;JUnit. Could be for JUnit 4.11. Issue to monitor:&lt;br/&gt;
&lt;a href=&quot;https://github.com/KentBeck/junit/issues/359:&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/KentBeck/junit/issues/359:&lt;/a&gt; fixed in our version, no feedback for an integration on trunk&lt;/p&gt;

&lt;p&gt;Surefire: Could be for Surefire 2.11. Issues to monitor are:&lt;br/&gt;
329 (category support): fixed, we use the official implementation from the trunk&lt;br/&gt;
786 (@Category with forkMode=always): fixed, we use the official implementation from the trunk&lt;br/&gt;
791 (incorrect elapsed time on test failure): fixed, we use the official implementation from the trunk&lt;br/&gt;
793 (incorrect time in the XML report): fixed on trunk, our fix is different. Trunk should be ok.&lt;br/&gt;
760 (does not take into account the test method): fixed in trunk, not fixed in our version&lt;br/&gt;
798 (print immediately the test class name): not fixed in trunk, not fixed in our version&lt;br/&gt;
799 (Allow test parallelization when forkMode=always): not fixed in trunk, not fixed in our version&lt;br/&gt;
800 (redirectTestOutputToFile not taken into account): not yet fix on trunk, fixed on our version&lt;/p&gt;

&lt;p&gt;800 is the more important to monitor, it&apos;s the only one that is fixed in our version but not on trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12531231">HBASE-4779</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12531363">HBASE-4781</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12527439">HBASE-4602</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12504203" name="surefire_793_trunk.v3.patch" size="3729" author="nkeywal" created="Fri, 18 Nov 2011 11:55:43 +0000"/>
                            <attachment id="12503392" name="surefire_hbase.v2.patch" size="12101" author="nkeywal" created="Fri, 11 Nov 2011 18:00:06 +0000"/>
                            <attachment id="12503997" name="surefire_hbase.v3.patch" size="11262" author="ghelmling" created="Thu, 17 Nov 2011 00:22:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Nov 2011 22:25:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>216677</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 3 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hs53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101821</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>