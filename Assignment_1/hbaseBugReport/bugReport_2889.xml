<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:05:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2889/HBASE-2889.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2889] Tool to look at HLogs -- parse and tail -f</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2889</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We need a tool for looking at wals.  A tail -f would be sweet though it might be ugly having to open each time it wants to dump next lot of edits out wal log.&lt;/p&gt;

&lt;p&gt;From Kannan:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;20:45 &amp;lt;kannan&amp;gt; WALEdit already has a toString().
20:46 &amp;lt;kannan&amp;gt; And append/sync support allows you to read concurrently a file that is being written too... (like JDs replication).
20:46 &amp;lt;kannan&amp;gt; So it would be good &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; I could &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; a bin/hbase hlogprint -f hdfs:&lt;span class=&quot;code-comment&quot;&gt;//...../.logs/&amp;lt;filename&amp;gt; -v -p
&lt;/span&gt;20:46 &amp;lt;kannan&amp;gt; much like the HFile pretty printer... except the HLog one is effectively a tail -f.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12470400">HBASE-2889</key>
            <summary>Tool to look at HLogs -- parse and tail -f</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="7">Later</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jul 2010 03:49:40 +0000</created>
                <updated>Fri, 18 Jul 2014 17:19:08 +0000</updated>
                            <resolved>Thu, 17 Jul 2014 03:31:42 +0000</resolved>
                                                                    <component>wal</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="12907102" author="stack" created="Wed, 8 Sep 2010 06:07:46 +0000"  >&lt;p&gt;There is already&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ hbase/bin/hbase org.apache.hadoop.hbase.regionserver.wal.HLog --dump hdfs:&lt;span class=&quot;code-comment&quot;&gt;//example.com:9000/hbase/10.10.21.18%3A60020.1283907407862&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Need to make it tail...&lt;/p&gt;

&lt;p&gt;Also, need to add this to the dump command:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java
===================================================================
--- src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java    (revision 993076)
+++ src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java    (working copy)
@@ -1830,9 +1830,12 @@
         }
         Reader log = getReader(fs, logPath, conf);
         &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+          &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; count = 0;
           HLog.Entry entry;
           &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ((entry = log.next()) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
-            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(entry.toString());
+            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;#&quot;&lt;/span&gt; + count + &lt;span class=&quot;code-quote&quot;&gt;&quot;, pos=&quot;&lt;/span&gt; + log.getPosition() +
+              &lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt; + entry.toString());
+            count++;
           }
         } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
           log.close();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... so can see where emitted edit is in file.&lt;/p&gt;
</comment>
                            <comment id="12907353" author="stack" created="Wed, 8 Sep 2010 18:33:03 +0000"  >&lt;p&gt;Add to hlog main:&lt;/p&gt;

&lt;p&gt;+ Emission of filename, position, and edit count if issue.  We used to do this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ ./bin/hbase org.apache.hadoop.hbase.regionserver.wal.HLog --dump ~/Downloads/10.10.21.18%3A60020.1283907407862  &amp;gt; /dev/&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; 
java.io.IOException: File is corrupt!
        at org.apache.hadoop.io.SequenceFile$Reader.readRecordLength(SequenceFile.java:1907)
        at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1932)
        at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1837)
        at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1883)
        at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.next(SequenceFileLogReader.java:121)
        at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.next(SequenceFileLogReader.java:113)
        at org.apache.hadoop.hbase.regionserver.wal.HLog.dump(HLog.java:1817)
        at org.apache.hadoop.hbase.regionserver.wal.HLog.main(HLog.java:1867)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... now we do this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ ./bin/hbase org.apache.hadoop.hbase.regionserver.wal.HLog --dump ~/Downloads/10.10.21.18%3A60020.1283907407862  &amp;gt; /dev/nulljava.io.IOException: /Users/Stack/Downloads/10.10.21.18%3A60020.1283907407862, pos=20076465, edit=6928
        at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.addFileInfoToException(SequenceFileLogReader.java:165)
        at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.next(SequenceFileLogReader.java:137)
        at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.next(SequenceFileLogReader.java:122)
        at org.apache.hadoop.hbase.regionserver.wal.HLog.dump(HLog.java:1817)
        at org.apache.hadoop.hbase.regionserver.wal.HLog.main(HLog.java:1867)
Caused by: java.io.IOException: File is corrupt!
        at org.apache.hadoop.io.SequenceFile$Reader.readRecordLength(SequenceFile.java:1907)
        at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1932)
        at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1837)
        at org.apache.hadoop.io.SequenceFile$Reader.next(SequenceFile.java:1883)
        at org.apache.hadoop.hbase.regionserver.wal.SequenceFileLogReader.next(SequenceFileLogReader.java:135)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;+ Made it so if an error, the program returns non-zero exit value.&lt;/p&gt;</comment>
                            <comment id="12907356" author="stack" created="Wed, 8 Sep 2010 18:39:42 +0000"  >&lt;p&gt;I commtted the 2889.txt patch for now to branch and trunk.  There is still tailing of hlogs to add before can close this issue.&lt;/p&gt;</comment>
                            <comment id="12907369" author="kannanm" created="Wed, 8 Sep 2010 19:23:57 +0000"  >&lt;p&gt;Thanks for the update on this Stack.&lt;/p&gt;</comment>
                            <comment id="12907532" author="hammer" created="Thu, 9 Sep 2010 06:31:21 +0000"  >&lt;p&gt;FWIW, if the WAL were serialized as Avro records, tools in many languages would be available for looking at the logs. There may be other drawbacks, of course.&lt;/p&gt;</comment>
                            <comment id="12907829" author="apurtell" created="Thu, 9 Sep 2010 23:54:47 +0000"  >&lt;p&gt;@Jeff: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2055&quot; title=&quot;Serialize WAL as Avro records&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2055&quot;&gt;&lt;del&gt;HBASE-2055&lt;/del&gt;&lt;/a&gt; is open for that. It&apos;s been a while, perhaps we can circle back to it soon.&lt;/p&gt;</comment>
                            <comment id="12914274" author="nspiegelberg" created="Thu, 23 Sep 2010 23:03:31 +0000"  >&lt;p&gt;FYI: the current patch downgrades all derived classes to an IOE.  e.g. any code to detect EOFExceptions will not be triggered.  The general problem we seem to have is that we need to differentiate between a Network IOE and a File Format IOE.&lt;/p&gt;

&lt;p&gt;Network = we need to fail and let another server try to take over&lt;br/&gt;
FileFormat = our file was written or parsed incorrectly.  retrying won&apos;t fix anything.  We need to just open what we have and store the original file away for later analysis.&lt;/p&gt;</comment>
                            <comment id="12914280" author="stack" created="Thu, 23 Sep 2010 23:34:27 +0000"  >&lt;p&gt;@Nicolas You referring to this method: addFileInfoToException?  Should I open issue to fix?&lt;/p&gt;</comment>
                            <comment id="12914309" author="nspiegelberg" created="Fri, 24 Sep 2010 01:21:35 +0000"  >&lt;p&gt;looks like the EOF bug was fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2961&quot; title=&quot;Close zookeeper when done with it (HCM, Master, and RS)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2961&quot;&gt;&lt;del&gt;HBASE-2961&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12914313" author="nspiegelberg" created="Fri, 24 Sep 2010 01:50:07 +0000"  >&lt;p&gt;generalized the fix on trunk, using reflection.  also added a couple variables that I&apos;ve found helpful while dealing with EOF problems.  should be able to apply this against trunk (r1000684)&lt;/p&gt;</comment>
                            <comment id="12914323" author="stack" created="Fri, 24 Sep 2010 04:01:46 +0000"  >&lt;p&gt;@Nicolas Committed your &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2889&quot; title=&quot;Tool to look at HLogs -- parse and tail -f&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2889&quot;&gt;&lt;del&gt;HBASE-2889&lt;/del&gt;&lt;/a&gt;_2.patch.  Thanks for fixing my booboo.&lt;/p&gt;</comment>
                            <comment id="12918286" author="stack" created="Tue, 5 Oct 2010 22:37:35 +0000"  >&lt;p&gt;Moving out.  Don&apos;t need to finish this &apos;feature&apos; for 0.90.&lt;/p&gt;</comment>
                            <comment id="12918325" author="nspiegelberg" created="Tue, 5 Oct 2010 23:40:51 +0000"  >&lt;p&gt;Is this not already committed in 0.90?  We have these patches applied internally and have been running the tool without problem.&lt;/p&gt;</comment>
                            <comment id="12918327" author="stack" created="Tue, 5 Oct 2010 23:44:06 +0000"  >&lt;p&gt;There is another piece to do, the bit Kannan wanted where you could tail a live WAL and see the edits stream by.  Thats the piece that is keeping this issue open and that won&apos;t be done for 0.90 (sorry, this issue got a bit messy with two commits against it).&lt;/p&gt;</comment>
                            <comment id="14064311" author="apurtell" created="Wed, 16 Jul 2014 23:10:13 +0000"  >&lt;p&gt;Resurrect or close?&lt;/p&gt;</comment>
                            <comment id="14064537" author="stack" created="Thu, 17 Jul 2014 03:31:42 +0000"  >&lt;p&gt;Resolving. Old.  When HDFS has a tail, we&apos;ll make an issue to implement tail of WAL&lt;/p&gt;</comment>
                            <comment id="14066135" author="lhofhansl" created="Fri, 18 Jul 2014 07:26:29 +0000"  >&lt;p&gt;We could do the equivalent of what replication is doing.&lt;/p&gt;</comment>
                            <comment id="14066554" author="stack" created="Fri, 18 Jul 2014 17:19:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;We could do the equivalent of what replication is doing.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We could only it is very ugly&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12473292">HBASE-2961</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12465884">HBASE-2643</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12443789">HBASE-2055</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12454134" name="2889.txt" size="6864" author="stack" created="Wed, 8 Sep 2010 18:33:03 +0000"/>
                            <attachment id="12455456" name="HBASE-2889_2.patch" size="2404" author="nspiegelberg" created="Fri, 24 Sep 2010 01:50:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Sep 2010 19:23:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26518</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 22 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02crr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11670</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>