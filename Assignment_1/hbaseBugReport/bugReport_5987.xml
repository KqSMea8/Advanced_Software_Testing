<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:32:47 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5987/HBASE-5987.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5987] HFileBlockIndex improvement</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5987</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Recently we find out a performance problem that it is quite slow when multiple requests are reading the same block of data or index. &lt;/p&gt;

&lt;p&gt;From the profiling, one of the causes is the IdLock contention which has been addressed in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5898&quot; title=&quot;Consider double-checked locking for block cache lock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5898&quot;&gt;&lt;del&gt;HBASE-5898&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;Another issue is that the HFileScanner will keep asking the HFileBlockIndex about the data block location for each target key value during the scan process(reSeekTo), even though the target key value has already been in the current data block. This issue will cause certain index block very HOT, especially when it is a sequential scan.&lt;/p&gt;

&lt;p&gt;To solve this issue, we propose the following solutions:&lt;/p&gt;

&lt;p&gt;First, we propose to lookahead for one more block index so that the HFileScanner would know the start key value of next data block. So if the target key value for the scan(reSeekTo) is &quot;smaller&quot; than that start kv of next data block, it means the target key value has a very high possibility in the current data block (if not in current data block, then the start kv of next data block should be returned. &lt;ins&gt;Indexing on the start key has some defects here&lt;/ins&gt;) and it shall NOT query the HFileBlockIndex in this case. On the contrary, if the target key value is &quot;bigger&quot;, then it shall query the HFileBlockIndex. This improvement shall help to reduce the hotness of HFileBlockIndex and avoid some unnecessary IdLock Contention or Index Block Cache lookup.&lt;/p&gt;

&lt;p&gt;Secondary, we propose to push this idea a little further that the HFileBlockIndex shall index on the last key value of each data block instead of indexing on the start key value. The motivation is to solve the &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4443&quot; title=&quot;optimize/avoid seeking to &amp;quot;previous&amp;quot; block when key you are interested in is the first one of a block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4443&quot;&gt;HBASE-4443&lt;/a&gt; issue (avoid seeking to &quot;previous&quot; block when key you are interested in is the first one of a block) as well as &lt;ins&gt;the defects mentioned above&lt;/ins&gt;.&lt;/p&gt;

&lt;p&gt;For example, if the target key value is &quot;smaller&quot; than the start key value of the data block N. There is no way for sure the target key value is in the data block N or N-1. So it has to seek from data block N-1. However, if the block index is based on the last key value for each data block and the target key value is beween the last key value of data block N-1 and data block N, then the target key value is supposed be data block N for sure. &lt;/p&gt;

&lt;p&gt;As long as HBase only supports the forward scan, the last key value makes more sense to be indexed on than the start key value. &lt;/p&gt;

&lt;p&gt;Thanks Kannan and Mikhail for the insightful discussions and suggestions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12554851">HBASE-5987</key>
            <summary>HFileBlockIndex improvement</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="liyin">Liyin Tang</assignee>
                                    <reporter username="liyin">Liyin Tang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 May 2012 01:20:38 +0000</created>
                <updated>Mon, 23 Sep 2013 18:30:35 +0000</updated>
                            <resolved>Thu, 17 May 2012 17:58:43 +0000</resolved>
                                                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>26</watches>
                                                                <comments>
                            <comment id="13273000" author="tlipcon" created="Fri, 11 May 2012 03:12:02 +0000"  >&lt;p&gt;Nice stuff Liyin. I was looking at scan performance a bit last week as well and came to similar conclusions that the reseeks were pretty expensive for this reason.&lt;/p&gt;

&lt;p&gt;Another thing I noticed is that our CPU cache behavior is pretty bad when the individual KVs are large. When I profiled L2 cache misses in oprofile, I saw a bunch on the call to read the memstoreTS &amp;#8211; assumedly because it fell on a different cache line than the rest of the KV. In my case, the KVs were just over 128 bytes (2 cache lines), including their header fields, lengths etc. So the access pattern looked like:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;hit cacheline 0 for kv0 header&lt;/li&gt;
	&lt;li&gt;hit cacheline 2 for kv0 memstoreTS&lt;/li&gt;
	&lt;li&gt;hit cacheline 0 repeatedly to do KV comparison&lt;/li&gt;
	&lt;li&gt;hit cacheline 2 for kv1&apos;s header&lt;/li&gt;
	&lt;li&gt;hit cacheline 4 for kv1&apos;s memstoreTS&lt;/li&gt;
	&lt;li&gt;hit cacheline 2 for kv1 data comparison&lt;br/&gt;
etc.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;For whatever reason, my CPU wasn&apos;t quite smart enough to kick prefetching in on this access pattern. I tried recompiling JDK7 with the Unsafe.prefetchRead intrinsic, but couldn&apos;t get any noticeable improvement with it. So I think for better performance, we need some better in-memory layout for the HFile blocks, so we can get O(lg n) reseeks instead of O&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_down.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, for example.&lt;/p&gt;

&lt;p&gt;Have you seen the same?&lt;/p&gt;</comment>
                            <comment id="13273031" author="liyin" created="Fri, 11 May 2012 04:31:19 +0000"  >&lt;p&gt;Nice summary! I haven&apos;t profiled the CPU in details and shall try it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;We found out this problem based on the following 2 experiments:&lt;br/&gt;
1) Single HBase client sequentially scans 8G of kvs from one region. Each kv is approximately 50 Byte and all of them are 100% cached in block cache. It takes approximately 4 mins to finish.&lt;br/&gt;
2) 20 HBase clients issue the same scan in parallel against the same set of 8G cached kvs. The finish time varies from 20 min to 50 min.&lt;/p&gt;

&lt;p&gt;In the region server, the network and disk are not busy and cpu usage increased only by 1%. &lt;br/&gt;
And most of IPC threads for the next call waited for the IdLock to read HFileBlockIndex.&lt;/p&gt;</comment>
                            <comment id="13273081" author="liyin" created="Fri, 11 May 2012 06:40:13 +0000"  >&lt;p&gt;A screen shot of sequential scan profiling.&lt;/p&gt;</comment>
                            <comment id="13273088" author="liyin" created="Fri, 11 May 2012 06:54:54 +0000"  >&lt;p&gt;Attached a screen shot of sequential scan profiling here.&lt;/p&gt;

&lt;p&gt;It shows that 82% of seek time is spent on querying block index and 67% of seek time is spent on acquiring IdLock for block index. &lt;br/&gt;
Sounds like it is a big win of avoiding unnecessary querying block index for the scan performance.&lt;/p&gt;</comment>
                            <comment id="13276116" author="phabricator@reviews.facebook.net" created="Tue, 15 May 2012 19:11:12 +0000"  >&lt;p&gt;Liyin requested code review of &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;br/&gt;
Reviewers: Kannan, mbautin&lt;/p&gt;

&lt;p&gt;  Recently we find out a performance problem that it is quite slow when multiple requests are reading the same block of data or index.&lt;/p&gt;

&lt;p&gt;  From the profiling, one of the causes is the IdLock contention which has been addressed in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5898&quot; title=&quot;Consider double-checked locking for block cache lock&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5898&quot;&gt;&lt;del&gt;HBASE-5898&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
  Another issue is that the HFileScanner will keep asking the HFileBlockIndex about the data block location for each target key value during the scan process(reSeekTo), even though the target key value has already been in the current data block. This issue will cause certain index block very HOT, especially when it is a sequential scan.&lt;/p&gt;


&lt;p&gt;  To solve this issue, we propose to lookahead for one more block index so that the HFileScanner would know the start key value of next data block. So if the target key value for the scan(reSeekTo) is &quot;smaller&quot; than that start kv of next data block, it means the target key value has a very high possibility in the current data block (if not in current data block, then the start kv of next data block should be returned. Indexing on the start key has some defects here) and it shall NOT query the HFileBlockIndex in this case. On the contrary, if the target key value is &quot;bigger&quot;, then it shall query the HFileBlockIndex. This improvement shall help to reduce the hotness of HFileBlockIndex and avoid some unnecessary IdLock Contention or Index Block Cache lookup.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  Unit tests&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockInfo.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/7329/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/7329/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd&lt;/p&gt;</comment>
                            <comment id="13276211" author="phabricator@reviews.facebook.net" created="Tue, 15 May 2012 21:07:07 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java:411 &apos;is to keep&apos; -&amp;gt; &apos;keeps&apos;&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java:415 &apos;it means it&apos; -&amp;gt; &apos;it means that&apos;&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:205 Please add javadoc for the last three parameters&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:208 Can this method be named getDataBlockInfo() ?&lt;br/&gt;
  For &apos;seekTo&apos;, I think DataBlock would be the target, not DataBlockInfo.&lt;br/&gt;
  See comment below w.r.t. naming of DataBlockInfo&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:196 &apos;other attributes&apos; -&amp;gt; &apos;additional attributes&apos; ?&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:293 &apos;Only &apos; can be removed.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockInfo.java:2 No year, please.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:306 Can we use builder pattern to fill out nextIndexedKey ?&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockInfo.java:26 Would HFileBlockWithInfo be a better name ?&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java:480 Should this be &apos;&amp;lt; 0&apos; ?&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:2 Please remove year.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:44 Please add test category.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13276352" author="phabricator@reviews.facebook.net" created="Tue, 15 May 2012 23:59:03 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;  Mostly discussed offline with Liyin. Comments are inline.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockInfo.java:26 I would suggest that we reflect the fact that the block is being scanned in the class name. Perhaps BlockWithScanInfo.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:224 Add a space before -&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:435 This description is misleading. i is not really &quot;the ith indexed key&quot;.&lt;/p&gt;

&lt;p&gt;  I would say &quot;the position of the index key to retrieve, starting at 0&quot;.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java:480 Discussed with Liyin offline. &quot;&amp;lt; 1&quot; seems fine, but there should definitely be a comment describing what happens in case compared == 0 (when the key being searched is the same as the first key of the next block). In that case we are relying on loadBlockAndSeekToKey positioning the scanner just before the key we are interested in, and on StoreFileScanner calling HFileScanner.next() to bring us to the first key we are interested in, potentially in the next block.&lt;/p&gt;

&lt;p&gt;  Also, in case nextIndexedKey == NO_NEXT_INDEXED_KEY, we should do the same thing as if compared &amp;lt; 1 (also discussed with Liyin offline). Therefore, the overall condition should be along the lines of:&lt;/p&gt;

&lt;p&gt;    if (this.nextIndexedKey != null &amp;amp;&amp;amp;&lt;br/&gt;
        (this.nextIndexedKey == NO_NEXT_INDEXED_KEY ||&lt;br/&gt;
         reader.getComparator().compare(key, offset, length,&lt;br/&gt;
             nextIndexedKey, 0, nextIndexedKey.length) &amp;lt; 1)) &lt;/p&gt;
{
      ...
    }

&lt;p&gt;  src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java:205 You probably don&apos;t want to enhance the deprecated HBaseTestCase class. Instead, try to add new functionality to HBaseTestingUtility.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:44 @tedyu: we don&apos;t categorize our tests in 89-fb. This diff will be ported to trunk separately.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:45 Please don&apos;t write new tests inheriting from HBaseTestCase. Use HBaseTestingUtility and HTestConst instead.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:82 schemMetricSnapShot -&amp;gt; schemaMetricSnapshot&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:91 Shouldn&apos;t this be the following?&lt;/p&gt;

&lt;p&gt;    while (s.next(results) || !results.isEmpty()) &lt;/p&gt;
{
      results.clear();
    }
&lt;p&gt;  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:103 Why are we assigning the return value of verifyDataAndIndexBlockRead to this variable? It is not used anywhere.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:107 Are we using the return value anywhere?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13276355" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 00:06:03 +0000"  >&lt;p&gt;Liyin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java:480 I missed this NO_NEXT_INDEXED_KEY ! Thanks Mikhail for this insightful comment !&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13276469" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 05:14:03 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;br/&gt;
Reviewers: Kannan, mbautin&lt;/p&gt;

&lt;p&gt;  Address Mikhail and Ted&apos;s comments.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13276513" author="zhihyu@ebaysf.com" created="Wed, 16 May 2012 06:33:57 +0000"  >&lt;p&gt;@Liyin:&lt;br/&gt;
Thanks for the quick turn around.&lt;/p&gt;

&lt;p&gt;Please let us know the performance improvement compared to what you collected on May 11th.&lt;/p&gt;</comment>
                            <comment id="13276941" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 18:01:03 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;  Looks good! A few minor comments inline. Also please submit the diff with lint (using &quot;arc diff --preview&quot; instead of &quot;arc diff --only&quot;)/&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java:545 Please add a comment that the actual value is irrelevant because this is always compared by reference.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java:437-440 This documentation is still confusing. Is i &quot;the ith position&quot;, or is the actual key &quot;the ith position&quot;? I would say i is the &quot;position&quot; and the returned key is the &quot;key at the ith position&quot;.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java:413 Clarify the meaning of &quot;is equal&quot;, i.e. that it must be exactly the same object, not just an equal byte array.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:63 This is unnecessary (we don&apos;t use compression by default).&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:77 It is not &quot;schemMetricSnapshot&quot;, it is &quot;schemaMetricSnapshot&quot; (&quot;schem&quot; is not a word).&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13276998" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 18:39:03 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;br/&gt;
Reviewers: Kannan, mbautin&lt;/p&gt;

&lt;p&gt;  Address Mikhail&apos;s comments&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277001" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 18:41:06 +0000"  >&lt;p&gt;mbautin has accepted the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;  Just one minor comment (please address on commit).&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java:413 HContants -&amp;gt; HConstants (missed an &quot;s&quot;)&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt;-fb&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277017" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 19:03:03 +0000"  >&lt;p&gt;todd has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;  Would be nice to have a simple benchmark - eg load a million rows and time &quot;count &apos;table&apos;, &lt;/p&gt;
{ CACHE =&amp;gt; 1000 }
&lt;p&gt;&quot; from the shell with and without.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java:23 typo: references wrong class name here&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java:28 could do with a short javadoc, eg:&lt;br/&gt;
  /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;The first key in the next block following this one in the HFile.&lt;/li&gt;
	&lt;li&gt;If this key is unknown, this is reference-equal with HConstants.NO_NEXT_INDEXED_KEY&lt;br/&gt;
    */&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java:526 are you guaranteed that firstKey.arrayOffset() == 0 here? I would have assumed firstKey could be an array slice&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt;-fb&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277076" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 20:21:07 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;br/&gt;
Reviewers: Kannan, mbautin&lt;/p&gt;

&lt;p&gt;  Good point, Todd !&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277090" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 20:31:03 +0000"  >&lt;p&gt;todd has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;  Thanks for fixing. I&apos;m surprised the unit tests weren&apos;t failing before. Is that because the ByteBuffer usually does have arrayOffset() == 0, so the bug wasn&apos;t actually causing a problem? Or do we need more test coverage?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt;-fb&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277098" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 20:39:02 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;br/&gt;
Reviewers: Kannan, mbautin&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277131" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 20:49:04 +0000"  >&lt;p&gt;Liyin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;  I think we haven&apos;t done a seekBefore to the previous block with a reSeekTo in this previous block together. I shall create a unit test to cover that.&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt;-fb&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277153" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 21:23:04 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;br/&gt;
Reviewers: Kannan, mbautin&lt;/p&gt;

&lt;p&gt;  Add a unit test to cover the seekBefore + reseekTo.&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277162" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 21:35:04 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;  The new test looks good.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt;-fb&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277165" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 21:37:04 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java:110 This doesn&apos;t seem to match the code on line 111.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt;-fb&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277166" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 21:37:05 +0000"  >&lt;p&gt;Liyin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java:110 should be c and g&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt;-fb&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277218" author="hadoopqa" created="Wed, 16 May 2012 22:40:38 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12527710/D3237.6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12527710/D3237.6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 14 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1902//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1902//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13277224" author="zhihyu@ebaysf.com" created="Wed, 16 May 2012 22:43:09 +0000"  >&lt;p&gt;I forgot the patch needs to be ported to trunk.&lt;/p&gt;</comment>
                            <comment id="13277309" author="phabricator@reviews.facebook.net" created="Thu, 17 May 2012 01:10:07 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:2 No year, please.&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java:41 This class doesn&apos;t extend HBaseTestCase but uses methods from HBaseTestCase.&lt;/p&gt;

&lt;p&gt;  It would be better to not reference HBaseTestCase.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt;-fb&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277477" author="phabricator@reviews.facebook.net" created="Thu, 17 May 2012 01:30:04 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;br/&gt;
Reviewers: Kannan, mbautin&lt;/p&gt;

&lt;p&gt;  Address Kannan&apos;s comments.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/HConnection.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/HTable.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/HTableMultiplexer.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/MultiPut.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/client/MultiplexablePut.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/client/TestHTableMultiplexer.java&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277482" author="phabricator@reviews.facebook.net" created="Thu, 17 May 2012 01:44:06 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;  This patch shouldn&apos;t include HTableMultiplexer changes, right ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5776&quot; title=&quot;HTableMultiplexer &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5776&quot;&gt;&lt;del&gt;HBASE-5776&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277530" author="phabricator@reviews.facebook.net" created="Thu, 17 May 2012 03:42:14 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;br/&gt;
Reviewers: Kannan, mbautin&lt;/p&gt;

&lt;p&gt;  A wrong diff is attached here previous. Sorry for the spam.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13277777" author="phabricator@reviews.facebook.net" created="Thu, 17 May 2012 13:01:03 +0000"  >&lt;p&gt;mbautin has closed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; HFileBlockIndex improvement&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D3237&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D3237&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1339581&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1339581&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: Kannan, mbautin, Liyin&lt;br/&gt;
Cc: JIRA, todd, tedyu&lt;/p&gt;</comment>
                            <comment id="13278026" author="zhihyu@ebaysf.com" created="Thu, 17 May 2012 17:58:43 +0000"  >&lt;p&gt;This has been fixed in 0.89-fb.&lt;/p&gt;</comment>
                            <comment id="13278053" author="liyin" created="Thu, 17 May 2012 18:17:32 +0000"  >&lt;p&gt;Hi Ted, &lt;br/&gt;
I think we shall use the same jira number for the same fix. It is not necessary to create another jira to port it back to apache trunk.&lt;/p&gt;

&lt;p&gt;Actually, we are proposing 2 solutions in this jira and I haven&apos;t finished the second part yet, which is to index the data block based on its (last_key  + 1 ) instead of the start key. So this jira shall not be closed.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

</comment>
                            <comment id="13278059" author="zhihyu@ebaysf.com" created="Thu, 17 May 2012 18:25:17 +0000"  >&lt;p&gt;The second part of the fix is an incompatible change. I would be better to tackle it in another JIRA.&lt;/p&gt;

&lt;p&gt;The code review subject had &apos;&lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt;&apos; in it. So I thought this was targeting 0.89-fb branch.&lt;/p&gt;

&lt;p&gt;Feel free to reopen this issue for backport.&lt;/p&gt;</comment>
                            <comment id="13279044" author="mikhail" created="Fri, 18 May 2012 18:17:11 +0000"  >&lt;p&gt;@Ted: we put &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; in the 89-fb versions of our code reviews for a particular JIRA, and omit them from trunk versions of code reviews for the same JIRA.&lt;/p&gt;</comment>
                            <comment id="13279065" author="zhihyu@ebaysf.com" created="Fri, 18 May 2012 18:39:03 +0000"  >&lt;p&gt;Which branches would the backport be prepared ?&lt;br/&gt;
I wonder if the code introduced so far in this JIRA would be kept when part 2 is implemented.&lt;/p&gt;</comment>
                            <comment id="13284578" author="hudson" created="Mon, 28 May 2012 23:49:14 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2941 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2941/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2941/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6032&quot; title=&quot;Port HFileBlockIndex improvement from HBASE-5987&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6032&quot;&gt;&lt;del&gt;HBASE-6032&lt;/del&gt;&lt;/a&gt; Port HFileBlockIndex improvement from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; (Revision 1343413)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13284582" author="hudson" created="Tue, 29 May 2012 00:00:53 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #30 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/30/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/30/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6032&quot; title=&quot;Port HFileBlockIndex improvement from HBASE-5987&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6032&quot;&gt;&lt;del&gt;HBASE-6032&lt;/del&gt;&lt;/a&gt; Port HFileBlockIndex improvement from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; (Revision 1343413)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/BlockWithScanInfo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestBlocksScanned.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13473317" author="aoxiang" created="Wed, 10 Oct 2012 15:43:59 +0000"  >&lt;p&gt;Should we backport this issue to 0.94-branch?&lt;/p&gt;</comment>
                            <comment id="13478636" author="lhofhansl" created="Thu, 18 Oct 2012 03:58:52 +0000"  >&lt;p&gt;@binlijin: We&apos;re doing the porting in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6032&quot; title=&quot;Port HFileBlockIndex improvement from HBASE-5987&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6032&quot;&gt;&lt;del&gt;HBASE-6032&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13478643" author="aoxiang" created="Thu, 18 Oct 2012 04:13:24 +0000"  >&lt;p&gt;@Lars Hofhansl: Thank you very much.&lt;/p&gt;</comment>
                            <comment id="13478679" author="hudson" created="Thu, 18 Oct 2012 05:16:49 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #539 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/539/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/539/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6032&quot; title=&quot;Port HFileBlockIndex improvement from HBASE-5987&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6032&quot;&gt;&lt;del&gt;HBASE-6032&lt;/del&gt;&lt;/a&gt; Port HFileBlockIndex improvement from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; (Liyin, Ted, Stack) (Revision 1399513)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13490394" author="hudson" created="Mon, 5 Nov 2012 01:35:36 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #9 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/9/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/9/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6032&quot; title=&quot;Port HFileBlockIndex improvement from HBASE-5987&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6032&quot;&gt;&lt;del&gt;HBASE-6032&lt;/del&gt;&lt;/a&gt; Port HFileBlockIndex improvement from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5987&quot; title=&quot;HFileBlockIndex improvement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5987&quot;&gt;&lt;del&gt;HBASE-5987&lt;/del&gt;&lt;/a&gt; (Liyin, Ted, Stack) (Revision 1399513)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileReaderV2.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/HBaseTestCase.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13775031" author="stack" created="Mon, 23 Sep 2013 18:30:35 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12523623">HBASE-4443</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12553264">HBASE-5898</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12556265">HBASE-6032</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12527494" name="ASF.LICENSE.NOT.GRANTED--D3237.1.patch" size="23359" author="phabricator@reviews.facebook.net" created="Tue, 15 May 2012 19:11:13 +0000"/>
                            <attachment id="12527569" name="ASF.LICENSE.NOT.GRANTED--D3237.2.patch" size="26349" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 05:14:09 +0000"/>
                            <attachment id="12527683" name="ASF.LICENSE.NOT.GRANTED--D3237.3.patch" size="26114" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 18:39:04 +0000"/>
                            <attachment id="12527691" name="ASF.LICENSE.NOT.GRANTED--D3237.4.patch" size="27296" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 20:21:08 +0000"/>
                            <attachment id="12527702" name="ASF.LICENSE.NOT.GRANTED--D3237.5.patch" size="26739" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 20:39:04 +0000"/>
                            <attachment id="12527710" name="ASF.LICENSE.NOT.GRANTED--D3237.6.patch" size="31620" author="phabricator@reviews.facebook.net" created="Wed, 16 May 2012 21:23:06 +0000"/>
                            <attachment id="12527753" name="ASF.LICENSE.NOT.GRANTED--D3237.7.patch" size="30832" author="phabricator@reviews.facebook.net" created="Thu, 17 May 2012 01:30:04 +0000"/>
                            <attachment id="12527772" name="ASF.LICENSE.NOT.GRANTED--D3237.8.patch" size="31615" author="phabricator@reviews.facebook.net" created="Thu, 17 May 2012 03:42:16 +0000"/>
                            <attachment id="12526485" name="screen_shot_of_sequential_scan_profiling.png" size="32495" author="liyin" created="Fri, 11 May 2012 06:41:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 11 May 2012 03:12:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>239103</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i016fr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4812</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>