<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:26:27 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11772/HBASE-11772.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11772] Bulk load mvcc and seqId issues with native hfiles</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11772</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;There are mvcc and seqId issues when bulk load native hfiles &amp;#8211; meaning hfiles that are direct file copy-out from hbase, not from HFileOutputFormat job.&lt;/p&gt;

&lt;p&gt;There are differences between these two types of hfiles.&lt;br/&gt;
Native hfiles have possible non-zero MAX_MEMSTORE_TS_KEY value and non-zero mvcc values in cells. &lt;br/&gt;
Native hfiles also have MAX_SEQ_ID_KEY.&lt;br/&gt;
Native hfiles do not have BULKLOAD_TIME_KEY.&lt;/p&gt;

&lt;p&gt;Here are a couple of problems I observed when bulk load native hfiles.&lt;/p&gt;

&lt;p&gt;1.  Cells in newly bulk loaded hfiles can be invisible to scan.&lt;/p&gt;

&lt;p&gt;It is easy to re-create.&lt;br/&gt;
Bulk load a native hfile that has a larger mvcc value in cells, e.g 10&lt;br/&gt;
If the current readpoint when initiating a scan is less than 10, the cells in the new hfile are skipped, thus become invisible.&lt;br/&gt;
We don&apos;t reset the readpoint of a region after bulk load.&lt;/p&gt;

&lt;p&gt;2. The current StoreFile.isBulkLoadResult() is implemented as:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; metadataMap.containsKey(BULKLOAD_TIME_KEY)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which does not detect bulkloaded native hfiles.&lt;/p&gt;

&lt;p&gt;3. Another observed problem is possible data loss during log recovery. &lt;br/&gt;
It is similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10958&quot; title=&quot;[dataloss] Bulk loading with seqids can prevent some log entries from being replayed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10958&quot;&gt;&lt;del&gt;HBASE-10958&lt;/del&gt;&lt;/a&gt; reported by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt;. Borrow the re-create steps from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10958&quot; title=&quot;[dataloss] Bulk loading with seqids can prevent some log entries from being replayed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10958&quot;&gt;&lt;del&gt;HBASE-10958&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;1) Create an empty table&lt;br/&gt;
2) Put one row in it (let&apos;s say it gets seqid 1)&lt;br/&gt;
3) Bulk load one native hfile with large seqId ( e.g. 100). The native hfile can be obtained by copying out from existing table.&lt;br/&gt;
4) Kill the region server that holds the table&apos;s region.&lt;br/&gt;
Scan the table once the region is made available again. The first row, at seqid 1, will be missing since the HFile with seqid 100 makes us believe that everything that came before it was flushed. &lt;/p&gt;

&lt;p&gt;The problem 3 is probably related to 2. We will be ok if we get the appended seqId during bulk load instead of 100 from inside the file.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12734841">HBASE-11772</key>
            <summary>Bulk load mvcc and seqId issues with native hfiles</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jinghe">Jerry He</assignee>
                                    <reporter username="jinghe">Jerry He</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Aug 2014 20:08:23 +0000</created>
                <updated>Sat, 21 Feb 2015 23:34:26 +0000</updated>
                            <resolved>Tue, 9 Sep 2014 00:38:25 +0000</resolved>
                                    <version>0.98.5</version>
                                    <fixVersion>0.99.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>0.98.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>16</watches>
                                                                <comments>
                            <comment id="14101202" author="jinghe" created="Mon, 18 Aug 2014 20:12:47 +0000"  >&lt;p&gt;The issues were observed in the 0.98 stream.&lt;br/&gt;
There are changed in the master branch, e.g. &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8763&quot; title=&quot;Combine MVCC and SeqId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8763&quot;&gt;&lt;del&gt;HBASE-8763&lt;/del&gt;&lt;/a&gt; combine mvcc and seqId.  But I suspect the issues still exist there.&lt;/p&gt;</comment>
                            <comment id="14101214" author="jinghe" created="Mon, 18 Aug 2014 20:20:09 +0000"  >&lt;p&gt;Here is the proposed fix:&lt;/p&gt;

&lt;p&gt;1) Better detection of bulk loaded files.  We can use the loaded file name with &apos;&lt;em&gt;SeqId&lt;/em&gt;&apos; since we already use it as marker to get the load time seqId.&lt;br/&gt;
2)  Regard bulk loaded files always have mvcc 0.  Don&apos;t call StoreFileScanner.skipKVsNewerThanReadpoint() during scan if it is bulk loaded file no matter whether or not it has mvcc in the file.&lt;br/&gt;
3) The problem 3 will probably be fixed by 1).&lt;/p&gt;</comment>
                            <comment id="14101549" author="jinghe" created="Mon, 18 Aug 2014 23:56:49 +0000"  >&lt;p&gt;Attached a patch for 0.98. &lt;br/&gt;
Tested successfully all the described issues after applying the fix on a 0.98.4 cluster.&lt;/p&gt;</comment>
                            <comment id="14101569" author="yuzhihong@gmail.com" created="Tue, 19 Aug 2014 00:07:19 +0000"  >&lt;p&gt;@Jerry:&lt;br/&gt;
Can you see if your fix makes the unit test Ram created for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; (on 0.98) work ?&lt;/p&gt;</comment>
                            <comment id="14101714" author="jinghe" created="Tue, 19 Aug 2014 02:02:12 +0000"  >&lt;p&gt;This is a local 0.98 test run:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] Reactor Summary:
[INFO]
[INFO] HBase ............................................. SUCCESS [1.821s]
[INFO] HBase - Common .................................... SUCCESS [22.919s]
[INFO] HBase - Protocol .................................. SUCCESS [7.192s]
[INFO] HBase - Client .................................... SUCCESS [38.781s]
[INFO] HBase - Hadoop Compatibility ...................... SUCCESS [6.506s]
[INFO] HBase - Hadoop Two Compatibility .................. SUCCESS [1.540s]
[INFO] HBase - Prefix Tree ............................... SUCCESS [3.170s]
[INFO] HBase - Server .................................... SUCCESS [39:10.623s]
[INFO] HBase - Testing Util .............................. SUCCESS [1.776s]
[INFO] HBase - Thrift .................................... SUCCESS [1:42.993s]
[INFO] HBase - Shell ..................................... SUCCESS [1.091s]
[INFO] HBase - Integration Tests ......................... SUCCESS [1.329s]
[INFO] HBase - Examples .................................. SUCCESS [1.468s]
[INFO] HBase - Assembly .................................. SUCCESS [0.930s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 42:22.873s
[INFO] Finished at: Mon Aug 18 18:03:59 PDT 2014
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14101718" author="jinghe" created="Tue, 19 Aug 2014 02:05:34 +0000"  >&lt;p&gt;Hi, Ted&lt;/p&gt;

&lt;p&gt;You mean download the attached TestBulkload.java from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; and run it but not apply the patch from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14101727" author="yuzhihong@gmail.com" created="Tue, 19 Aug 2014 02:13:04 +0000"  >&lt;p&gt;Yes, that is what I meant.&lt;/p&gt;</comment>
                            <comment id="14101842" author="jinghe" created="Tue, 19 Aug 2014 04:48:09 +0000"  >&lt;p&gt;Hi, Ted&lt;/p&gt;

&lt;p&gt;Without any change to the TestBulkload.java and without patch from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; running against the latest 0.98 branch, I got this result:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 8.401 sec &amp;lt;&amp;lt;&amp;lt; FAILURE!
testBulkLoad(org.apache.hadoop.hbase.regionserver.TestBulkload)  Time elapsed: 0.562 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!
junit.framework.ComparisonFailure: expected:&amp;lt;version[2]&amp;gt; but was:&amp;lt;version[0]&amp;gt;
        at junit.framework.Assert.assertEquals(Assert.java:100)
        at junit.framework.Assert.assertEquals(Assert.java:107)
        at org.apache.hadoop.hbase.regionserver.TestBulkload.testBulkLoad(TestBulkload.java:126)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The result is the same with or without the patch from this JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11772&quot; title=&quot;Bulk load mvcc and seqId issues with native hfiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11772&quot;&gt;&lt;del&gt;HBASE-11772&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14101847" author="anoop.hbase" created="Tue, 19 Aug 2014 04:54:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;2) Regard bulk loaded files always have mvcc 0. Don&apos;t call StoreFileScanner.skipKVsNewerThanReadpoint() during scan if it is bulk loaded file no matter whether or not it has mvcc in the file.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why to skip the check?  Instead it should check against the seqId of the file. FYI in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; patch, the seIds of the individual cells (from a bulk loaded) file will be set with the file seqId. This should help?&lt;/p&gt;</comment>
                            <comment id="14101860" author="ram_krish" created="Tue, 19 Aug 2014 05:11:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;Without any change to the TestBulkload.java and without patch from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; running against the latest 0.98 branch,&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I need to check this.  I think I was able to run it successfully in 0.98.  I will verify once again.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;return metadataMap.containsKey(BULKLOAD_TIME_KEY)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is the main problem that I am facing. I am planning to raise a JIRA.  HFileOutputformat2 should be used when we need this.  But if you try to bulk load from a TSV file or when you try using LoadIncrementalHFiles am not sure how to use this output format.  I think we need to revisit this impl and solve this in another JIRA.&lt;/p&gt;</comment>
                            <comment id="14101862" author="ram_krish" created="Tue, 19 Aug 2014 05:15:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;The result is the same with or without the patch from this JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11772&quot; title=&quot;Bulk load mvcc and seqId issues with native hfiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11772&quot;&gt;&lt;del&gt;HBASE-11772&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;May be that is because of the KeyValueScanner comparator.&lt;/p&gt;</comment>
                            <comment id="14101867" author="ram_krish" created="Tue, 19 Aug 2014 05:21:07 +0000"  >&lt;p&gt;Saw this in the patch&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; bulkLoadedHFile = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getPath().getName();
+    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; startPos = fileName.indexOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;_SeqId_&quot;&lt;/span&gt;);
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (startPos != -1) {
+      bulkLoadedHFile = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    }
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; metadataMap.containsKey(BULKLOAD_TIME_KEY) || bulkLoadedHFile;
   }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ya this is fine. But my point is should we make the LoadIncrmentalHFile itself to append this metadata rather than the server checking for the SeqId in the file name?&lt;/p&gt;</comment>
                            <comment id="14101876" author="jinghe" created="Tue, 19 Aug 2014 05:30:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;Why to skip the check? Instead it should check against the seqId of the file. FYI in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; patch, the seIds of the individual cells (from a bulk loaded) file will be set with the file seqId. This should help?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;In trunk, use the appended file seqId for the cell from a bulk load should help.  In the 0.98 stream, the mvcc/writenumber/readnumber are a separate set from seqId.  Right?&lt;/p&gt;</comment>
                            <comment id="14101882" author="jinghe" created="Tue, 19 Aug 2014 05:34:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;Ya this is fine. But my point is should we make the LoadIncrmentalHFile itself to append this metadata rather than the server checking for the SeqId in the file name?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;You mean LoadIncrmentalHFile rewrites to the immutable hfiles?&lt;/p&gt;</comment>
                            <comment id="14101885" author="ram_krish" created="Tue, 19 Aug 2014 05:38:43 +0000"  >&lt;blockquote&gt;&lt;p&gt;You mean LoadIncrmentalHFile rewrites to the immutable hfiles?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes.  We need to ensure use HFileOutPutFormat and that would take care of adding the metadata.  If you TestBulkLoad.java in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; I have added the meta data manually in the test case to make it work with bulk load.&lt;/p&gt;</comment>
                            <comment id="14101900" author="ram_krish" created="Tue, 19 Aug 2014 05:56:43 +0000"  >&lt;blockquote&gt;&lt;p&gt;If the current readpoint when initiating a scan is less than 10, the cells in the new hfile are skipped, thus become invisible.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I have a doubt here.  The new hfile created by bulk load is having a seq id that is greater than 10, correct? So a scanner that got started before the bulk load file was created should not be seeing those KVs. Which is right according to the mvcc logic.  Am I missing something here?&lt;/p&gt;

&lt;p&gt;Any scan that is created after the bulk load is done should be able to see the KV.&lt;/p&gt;</comment>
                            <comment id="14101904" author="ram_krish" created="Tue, 19 Aug 2014 06:00:57 +0000"  >&lt;p&gt;In 0.98 TestBulkLoad should be working fine because &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (kv.getMvccVersion() &amp;lt;= smallestReadPoint) {
          kv.setMvccVersion(0);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We set the kv&apos;s mvcc version to 0 and so the latest kv from the bulk loaded file should be returned back. Let me check once again.&lt;/p&gt;</comment>
                            <comment id="14102226" author="jmspaggi" created="Tue, 19 Aug 2014 14:09:22 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   /**
-   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; storefile was created by HFileOutputFormat
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; storefile was created by bulk load.
    * &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; a bulk load.
    */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You might want to remove the &quot;for a bulk load&quot; line too.&lt;/p&gt;</comment>
                            <comment id="14102519" author="jinghe" created="Tue, 19 Aug 2014 17:42:40 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Will do.&lt;/p&gt;</comment>
                            <comment id="14103008" author="jinghe" created="Tue, 19 Aug 2014 23:00:19 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I have a doubt here. The new hfile created by bulk load is having a seq id that is greater than 10, correct? So a scanner that got started before the bulk load file was created should not be seeing those KVs. Which is right according to the mvcc logic. Am I missing something here?  Any scan that is created after the bulk load is done should be able to see the KV&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This behavior is a possible option and goal in the trunk branch given the combination of mvcc and seqId. &lt;br/&gt;
But it probably does not work as you described yet and need fixes for the described problem.&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt; and  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt; for the input. &lt;br/&gt;
I am looking at &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; to see if anything can be borrowed from there. &lt;/p&gt;</comment>
                            <comment id="14105591" author="jinghe" created="Thu, 21 Aug 2014 17:00:52 +0000"  >&lt;p&gt;The work being done at &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; will be good for this JIRA as well for 0.99+ branches!  I will work on top of that to avoid conflicts.&lt;br/&gt;
For what is being done there please refer to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt;&apos;s latest patches.&lt;/p&gt;</comment>
                            <comment id="14109842" author="apurtell" created="Mon, 25 Aug 2014 22:11:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;The work being done at &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; will be good for this JIRA as well for 0.99+ branches&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Unscheduling this issue then. Should this issue be resolved?&lt;/p&gt;</comment>
                            <comment id="14109939" author="jinghe" created="Mon, 25 Aug 2014 23:07:48 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;&lt;br/&gt;
The work is not finished yet.&lt;/p&gt;

&lt;p&gt;This is the current status update:&lt;br/&gt;
1.  For 0.99+, temporarily waiting for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; to go in ( &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; is only applicable for 0.99+), then provide a patch on top of it.&lt;br/&gt;
2.  For 0.98, the mvcc and seqld is handled differently.  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8763&quot; title=&quot;Combine MVCC and SeqId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8763&quot;&gt;&lt;del&gt;HBASE-8763&lt;/del&gt;&lt;/a&gt;: Combine MVCC and SeqId - did not go into 0.98.  Will need a separate patch.&lt;/p&gt;</comment>
                            <comment id="14110138" author="apurtell" created="Tue, 26 Aug 2014 01:34:19 +0000"  >&lt;p&gt;Thanks Jerry&lt;/p&gt;</comment>
                            <comment id="14111877" author="jinghe" created="Wed, 27 Aug 2014 05:18:50 +0000"  >&lt;p&gt;Attached a patch for master now that  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; has been committed.&lt;/p&gt;</comment>
                            <comment id="14111879" author="jinghe" created="Wed, 27 Aug 2014 05:21:44 +0000"  >&lt;p&gt;The added unit test case in the patch tests out the scenario. &lt;/p&gt;</comment>
                            <comment id="14111890" author="ram_krish" created="Wed, 27 Aug 2014 05:33:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryhe&quot; class=&quot;user-hover&quot; rel=&quot;jerryhe&quot;&gt;Jerry He&lt;/a&gt;&lt;br/&gt;
I just have one concern&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; bulkLoadedHFile = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getPath().getName();
+    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; startPos = fileName.indexOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;SeqId_&quot;&lt;/span&gt;);
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (startPos != -1) {
+      bulkLoadedHFile = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    }
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; bulkLoadedHFile || metadataMap.containsKey(BULKLOAD_TIME_KEY);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So we handle this or the LoadIncrementalHFile itself should try adding this metadata BULKLOAD_TIME_KEY. See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11790&quot; title=&quot;Bulk load should use HFileOutputFormat2 in all cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11790&quot;&gt;&lt;del&gt;HBASE-11790&lt;/del&gt;&lt;/a&gt;.  I have not yet worked on a patch for it. So even in case of bulk loading native files we might have to add this meta data to that new bulk loaded file. Am fine with this change but should we really handle this in the MR layer.&lt;br/&gt;
Rest looks good to me.&lt;/p&gt;</comment>
                            <comment id="14111917" author="anoop.hbase" created="Wed, 27 Aug 2014 06:20:01 +0000"  >&lt;p&gt;In this issue usecase there is no HFileOutputFormat usage at all! FYI&lt;/p&gt;</comment>
                            <comment id="14111938" author="hadoopqa" created="Wed, 27 Aug 2014 06:54:00 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12664563/HBASE-11772-master-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12664563/HBASE-11772-master-v1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12664563&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 10 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestHRegionServerBulkLoad&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10603//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14111940" author="ram_krish" created="Wed, 27 Aug 2014 06:56:19 +0000"  >&lt;blockquote&gt;&lt;p&gt;In this issue usecase there is no HFileOutputFormat usage at all!&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ya.. In fact even in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; also there was no use case of using HfileOutputformat.  That is what is my doubt. How should LoadIncrementalHFiles be used? As I said this patch solves this problem also by changing how to identify if a file is bulk loaded or not by checking if the file name has this seq id in the file name. Should we try to add the meta data some way or this type of check is enough.&lt;/p&gt;</comment>
                            <comment id="14111977" author="ram_krish" created="Wed, 27 Aug 2014 07:30:16 +0000"  >&lt;p&gt;Discussed. We cannot make LoadincrementalHFiles to use HFileoutputformat as here we have an external file already created. +1 on patch then.&lt;/p&gt;</comment>
                            <comment id="14111979" author="ram_krish" created="Wed, 27 Aug 2014 07:31:55 +0000"  >&lt;p&gt;But seems there could be a legitimate failure &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;org.apache.hadoop.hbase.regionserver.TestHRegionServerBulkLoad&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="14111993" author="anoop.hbase" created="Wed, 27 Aug 2014 07:43:49 +0000"  >&lt;p&gt;Patch looks good to me.&lt;/p&gt;</comment>
                            <comment id="14112668" author="jinghe" created="Wed, 27 Aug 2014 19:15:03 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I will look into the TestHRegionServerBulkLoad failure.&lt;/p&gt;</comment>
                            <comment id="14112860" author="yuzhihong@gmail.com" created="Wed, 27 Aug 2014 21:14:01 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; startPos = fileName.indexOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;SeqId_&quot;&lt;/span&gt;);
+      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; startPos = fileName.lastIndexOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;SeqId_&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above change implies that there may be more than one seqId in the filename. Can you give an example ?&lt;/p&gt;</comment>
                            <comment id="14113184" author="anoop.hbase" created="Thu, 28 Aug 2014 01:33:29 +0000"  >&lt;p&gt;Other place where we check with &quot;SeqId_&quot; string is wherer we try extract the SeqNo.  There it is indexOf. Better unify both.&lt;/p&gt;</comment>
                            <comment id="14113285" author="jinghe" created="Thu, 28 Aug 2014 03:26:28 +0000"  >&lt;blockquote&gt;&lt;p&gt;The above change implies that there may be more than one seqId in the filename.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Right, that seems to be possible, but probably rare. &lt;br/&gt;
e.g  a hfile named &apos;abc_SeqId_10_&apos; can exist in HBase and be DistCp out, then later bulk loaded into another HBase instance.&lt;br/&gt;
After the bulk load, it will have another &apos;&lt;em&gt;SeqId&lt;/em&gt;&amp;lt;number&amp;gt;&apos; appended.&lt;/p&gt;</comment>
                            <comment id="14113327" author="jinghe" created="Thu, 28 Aug 2014 04:35:04 +0000"  >&lt;p&gt;Still looking into the TestHRegionServerBulkLoad failure.&lt;/p&gt;

&lt;p&gt;This is how this test work.&lt;br/&gt;
It only has a single test case:  testAtomicBulkLoad&lt;br/&gt;
It creates a separate thread that continuously bulk load hfiles (multiple column families) into minicluster.&lt;br/&gt;
Each iteration of bulk load has the same values for all rows and columns (e.g. all loaded values in iteration 1 is 000001)&lt;br/&gt;
At the same time the test creates multiple threads that continuously creates table scanners to scan the same table.&lt;br/&gt;
The assert is that for each table scanner, the value for all the rows and columns will be uniformly the same.&lt;br/&gt;
The purpose is to test if the bulk load is atomic.&lt;br/&gt;
This makes sense because each scanner will only see the result of a complete bulk load iteration. It should not see half result from another bulk load iteration.&lt;/p&gt;

&lt;p&gt;The atomic is guided by the region write lock in startBulkRegionOperation().  There is no change in that area.&lt;/p&gt;

&lt;p&gt;One thing to notice is that the test does not add BULKLOAD_TIME_KEY to the bulk load hfiles.   isBulkLoadResult() will all be false.&lt;/p&gt;

&lt;p&gt;I tried adding BULKLOAD_TIME_KEY when creating the bulk load files.  Then the test failed, identical to the failure seen after applying this JRIA&apos;s patch.&lt;/p&gt;</comment>
                            <comment id="14113353" author="ram_krish" created="Thu, 28 Aug 2014 05:27:07 +0000"  >&lt;p&gt;&amp;gt;&amp;gt;One thing to notice is that the test does not add BULKLOAD_TIME_KEY to the bulk load hfiles. isBulkLoadResult() will all be false.&lt;br/&gt;
Interesting.  So how was this test working then?  It was just reading the KVs (and you mentioned it is adding the same values for all rows and columns) so we were not checking whether we are reading the correct value? In the sense in terms of the latest value.&lt;/p&gt;</comment>
                            <comment id="14113381" author="jinghe" created="Thu, 28 Aug 2014 05:55:43 +0000"  >&lt;p&gt;It checks if the values from a scan are the same (atomic) across columns. &lt;br/&gt;
For example, if family1:qua = 000000,  then family2:qua should be 000000 too.&lt;/p&gt;</comment>
                            <comment id="14114839" author="jinghe" created="Fri, 29 Aug 2014 04:30:51 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I did a little more testing for TestHRegionServerBulkLoad.  It seems to be related to the changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
Here is what I found out:&lt;/p&gt;

&lt;p&gt;TestHRegionServerBulkLoad does not add BULKLOAD_TIME_KEY to the bulk load hfiles. But currently we use BULKLOAD_TIME_KEY to determine isBulkLoadResult().&lt;/p&gt;

&lt;p&gt;I added BULKLOAD_TIME_KEY to the bulk load hfiles by adding:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
writer.appendFileInfo(StoreFile.BULKLOAD_TIME_KEY, Bytes.toBytes(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis()));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to TestHRegionServerBulkLoad.createHFile().&lt;/p&gt;

&lt;p&gt;Then the test passes without &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt;, but fails with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Narrowing down a little deeper, the changes that cause the failure are in StoreFileScanner.java from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt;&apos;s patch:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (hasMVCCInfo || &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.reader.isBulkLoaded()) {
           skipKVsNewerThanReadpoint();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!hasMVCCInfo &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.reader.isBulkLoaded()) {
+          &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; skipKVsNewerThanReadpoint();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I back-out the above changes related for skipKVsNewerThanReadpoint(), then the test passes fine even with BULKLOAD_TIME_KEY added in the test.&lt;/p&gt;

</comment>
                            <comment id="14117099" author="ram_krish" created="Mon, 1 Sep 2014 07:18:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryhe&quot; class=&quot;user-hover&quot; rel=&quot;jerryhe&quot;&gt;Jerry He&lt;/a&gt;&lt;br/&gt;
Sorry for being late on this.  Was not able to see the code.  The discussion over here would  be interesting. In the case here&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!hasMVCCInfo &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.reader.isBulkLoaded()) {
+          &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; skipKVsNewerThanReadpoint();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;for your case it will have mvccInfo right -  i mean the mvcc of the store file that you are trying to bulk load once again? Can we see that?&lt;/p&gt;</comment>
                            <comment id="14117104" author="ram_krish" created="Mon, 1 Sep 2014 07:20:27 +0000"  >&lt;p&gt;In your case as the native file is already an HFile you expect the mvcc to be applied as per the mvcc attached with the KV in that file right? In that case setting the sequenceId of the bulk loaded file to the KVs in this bulk loaded file itself is not needed for you? Am i right?&lt;/p&gt;</comment>
                            <comment id="14117137" author="jinghe" created="Mon, 1 Sep 2014 07:50:08 +0000"  >&lt;p&gt;In the last few comments,  I was purely talking about the TestHRegionServerBulkLoad test, without and before applying this JIRA.&lt;/p&gt;</comment>
                            <comment id="14117139" author="anoop.hbase" created="Mon, 1 Sep 2014 07:53:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;In that case setting the sequenceId of the bulk loaded file to the KVs in this bulk loaded file itself is not needed for you? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No. When the file is bulk loaded, the KVs in that should get the seqId of the file even if it is having some non-zero seqId&lt;/p&gt;</comment>
                            <comment id="14117163" author="jinghe" created="Mon, 1 Sep 2014 08:15:15 +0000"  >&lt;p&gt;I have a rough idea why TestHRegionServerBulkLoad fails in certain case.  Will need to go through the scenarios more. Will post back shortly.&lt;/p&gt;</comment>
                            <comment id="14117179" author="ram_krish" created="Mon, 1 Sep 2014 08:26:53 +0000"  >&lt;blockquote&gt;&lt;p&gt;Will need to go through the scenarios more&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ya. I can understand the scenario.Pls see the test case testBulkLoadWithParallelScan(). Here when the scan starts if the bulk load is not completed we are not allowing the scan to read that bulk loaded KV.  Previously this was not happening because of the skpKVsNewerThanReadPoint().  Combining mvcc and seq Id is in a way to achieve this right?  What do you think? If so we need to revert the change in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11591&quot; title=&quot;Scanner fails to retrieve KV  from bulk loaded file with highest sequence id than the cell&amp;#39;s mvcc in a non-bulk loaded file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11591&quot;&gt;&lt;del&gt;HBASE-11591&lt;/del&gt;&lt;/a&gt; and allow all KVs to be read from a bulk loaded file. What do you say? &lt;/p&gt;</comment>
                            <comment id="14118496" author="jinghe" created="Tue, 2 Sep 2014 18:38:24 +0000"  >&lt;p&gt;The row level consistency (atomicity) may not be maintained since we added readpoint checks for bulkloaded files.&lt;br/&gt;
Consistency (atomicity) means the loaded values across all stores (column families) need to be visible to scan, or none of values visible to scan.&lt;br/&gt;
We will see inconsistency if there is compaction after bulk load. That is the cause of TestHRegionServerBulkLoad failure.&lt;br/&gt;
For example, a scanner tries to fetch row-1001, cf1 gets the new value from a bulk load, but cf2 does not see this bulkload.&lt;br/&gt;
Since it is not directly related to this JIRA, I will open another JIRA for the problem.&lt;/p&gt;</comment>
                            <comment id="14118571" author="jinghe" created="Tue, 2 Sep 2014 19:17:15 +0000"  >&lt;p&gt;Opened &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11882&quot; title=&quot;Row level consistency may not be maintained with bulk load and compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11882&quot;&gt;&lt;del&gt;HBASE-11882&lt;/del&gt;&lt;/a&gt; to separately track the row level consistency problem.&lt;/p&gt;</comment>
                            <comment id="14122392" author="anoop.hbase" created="Fri, 5 Sep 2014 04:24:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;The above change implies that there may be more than one seqId in the filename. Can you give an example ?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;e.g a hfile named &apos;abc_SeqId_10_&apos; can exist in HBase and be DistCp out, then later bulk loaded into another HBase instance.&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;If such a file is there, it could give a wrong judgement at below place and say the file is bulk loaded!!!!  A matter of worry?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getPath().getName();
+    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; startPos = fileName.indexOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;SeqId_&quot;&lt;/span&gt;);
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (startPos != -1) {
+      bulkLoadedHFile = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14122440" author="jinghe" created="Fri, 5 Sep 2014 05:04:43 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Could you give a case where there is a wrong judgement?&lt;br/&gt;
A hfile name generated by internal means (flush or compact) will never have &apos;SeqId_&apos;, right?&lt;/p&gt;</comment>
                            <comment id="14122520" author="anoop.hbase" created="Fri, 5 Sep 2014 06:51:31 +0000"  >&lt;p&gt;In your eg: you were telling &quot;hfile named &apos;abc_SeqId_10_&apos; can exist in HBase&quot;&lt;br/&gt;
But I got it now.  The file can be already a bulk loaded one and so seqId_ part already in name. Again when u load this to another table, second seqId_ part can come in. So yes, for getting the actual seq_id of the file, go with lastIndexOf() and there is no issue with this check to know whether this is a bulk loaded one or not.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getPath().getName();
+    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; startPos = fileName.indexOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;SeqId_&quot;&lt;/span&gt;);
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (startPos != -1) {
+      bulkLoadedHFile = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    }&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is what ur thinking?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt; was asking why the change to lastIndexOf().&lt;/p&gt;</comment>
                            <comment id="14123058" author="jinghe" created="Fri, 5 Sep 2014 15:39:46 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Yes.  You explained it!&lt;/p&gt;

&lt;p&gt;Re-based with attachment &apos;master-v2&apos;&lt;/p&gt;</comment>
                            <comment id="14123169" author="hadoopqa" created="Fri, 5 Sep 2014 17:09:49 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12666807/HBASE-11772-master-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12666807/HBASE-11772-master-v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12666807&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 10 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10726//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14123186" author="yuzhihong@gmail.com" created="Fri, 5 Sep 2014 17:22:43 +0000"  >&lt;p&gt;lgtm&lt;/p&gt;

&lt;p&gt;nit: in the new test&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    scanner = table.getScanner(scan);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;scanner should be closed at the end.&lt;/p&gt;</comment>
                            <comment id="14123351" author="jinghe" created="Fri, 5 Sep 2014 18:40:05 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Updated as attachment master-v3.&lt;/p&gt;</comment>
                            <comment id="14123494" author="hadoopqa" created="Fri, 5 Sep 2014 20:13:29 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12666847/HBASE-11772-master-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12666847/HBASE-11772-master-v3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12666847&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 10 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10729//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14124533" author="anoop.hbase" created="Sat, 6 Sep 2014 15:34:32 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; startPos = fileName.lastIndexOf(&lt;span class=&quot;code-quote&quot;&gt;&quot;SeqId_&quot;&lt;/span&gt;);
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (startPos != -1) {
+      bulkLoadedHFile = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It doesn&apos;t matter we take lastIndexOf or indexOf as we just check whether it is -1 or not. So indexOf() would be sufficient at this place.  Just a nit. &lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14125191" author="jinghe" created="Mon, 8 Sep 2014 03:53:29 +0000"  >&lt;p&gt;Updated with master-v4. Changed back to use indexOf() in checking only. Also added a little more comments in the code.&lt;/p&gt;</comment>
                            <comment id="14125196" author="jinghe" created="Mon, 8 Sep 2014 03:59:15 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In 0.98 the mvcc and seqId are separate. The bulk load is immediately visible to all.&lt;br/&gt;
What do you think about the fix I tried in 0.98.patch?  Any suggestion, any concern?&lt;/p&gt;</comment>
                            <comment id="14125206" author="ram_krish" created="Mon, 8 Sep 2014 04:27:26 +0000"  >&lt;p&gt;+1 for both the patches.&lt;br/&gt;
In 0.98 anyway for a normal bulk loaded file as there is no mvcc we will any way be making the kvs  in the bulk load visible.&lt;br/&gt;
Here for a native file also we do the same thing just because it is bulk loaded.  I think it is fine.&lt;/p&gt;</comment>
                            <comment id="14125212" author="anoop.hbase" created="Mon, 8 Sep 2014 04:38:47 +0000"  >&lt;p&gt;+1 for both version patches.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;In 0.98 anyway for a normal bulk loaded file as there is no mvcc we will any way be making the kvs  in the bulk load visible.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes same with me too. In 0.98  mvcc enforcing is not there. Nice work &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryhe&quot; class=&quot;user-hover&quot; rel=&quot;jerryhe&quot;&gt;Jerry He&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14125220" author="jinghe" created="Mon, 8 Sep 2014 05:05:14 +0000"  >&lt;p&gt;Hi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;

&lt;p&gt;I will clean up and add some comments to the 0.98.patch and provide a 0.98-v2.&lt;/p&gt;</comment>
                            <comment id="14125256" author="hadoopqa" created="Mon, 8 Sep 2014 06:52:13 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12667126/HBASE-11772-master-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12667126/HBASE-11772-master-v4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12667126&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 10 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestReplicaWithCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestHRegion&lt;br/&gt;
                  org.apache.hadoop.hbase.TestRegionRebalancing&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): 	at org.apache.hadoop.hbase.security.visibility.TestVisibilityLabels.testVisibilityLabelsOnRSRestart(TestVisibilityLabels.java:405)&lt;br/&gt;
	at org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsWithDefaultVisLabelService.testAddVisibilityLabelsOnRSRestart(TestVisibilityLabelsWithDefaultVisLabelService.java:114)&lt;br/&gt;
	at org.apache.hadoop.hbase.security.visibility.TestVisibilityLabels.testVisibilityLabelsOnKillingOfRSContainingLabelsTable(TestVisibilityLabels.java:358)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//artifact/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/10737//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14125640" author="yuzhihong@gmail.com" created="Mon, 8 Sep 2014 14:52:25 +0000"  >&lt;p&gt;Integrated to branch-1 and master.&lt;/p&gt;

&lt;p&gt;Thanks Jerry for the contribution.&lt;/p&gt;

&lt;p&gt;Thanks to Anoop and Ram for reviews.&lt;/p&gt;</comment>
                            <comment id="14125709" author="hudson" created="Mon, 8 Sep 2014 16:18:57 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5477 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5477/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5477/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11772&quot; title=&quot;Bulk load mvcc and seqId issues with native hfiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11772&quot;&gt;&lt;del&gt;HBASE-11772&lt;/del&gt;&lt;/a&gt; Bulk load mvcc and seqId issues with native hfiles (Jerry He) (tedyu: rev f9bea361469eb3ed152f7ed7973f50f309218844)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestScannerWithBulkload.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14125815" author="hudson" created="Mon, 8 Sep 2014 17:49:09 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #161 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/161/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/161/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11772&quot; title=&quot;Bulk load mvcc and seqId issues with native hfiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11772&quot;&gt;&lt;del&gt;HBASE-11772&lt;/del&gt;&lt;/a&gt; Bulk load mvcc and seqId issues with native hfiles (Jerry He) (tedyu: rev fd5b139a6f60970f575499d5dfb0aa762c590696)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestScannerWithBulkload.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14126381" author="jinghe" created="Tue, 9 Sep 2014 00:27:52 +0000"  >&lt;p&gt;Attached 0.98-v2.&lt;br/&gt;
1. Trivial cleanup and comments.&lt;br/&gt;
2. Included TestScannerWithBulkload from the master branch.&lt;/p&gt;</comment>
                            <comment id="14126394" author="yuzhihong@gmail.com" created="Tue, 9 Sep 2014 00:38:25 +0000"  >&lt;p&gt;Ran TestScannerWithBulkload more than once for 0.98 - it passed.&lt;/p&gt;

&lt;p&gt;Integrated to 0.98 branch.&lt;/p&gt;

&lt;p&gt;Thanks Jerry.&lt;/p&gt;</comment>
                            <comment id="14126445" author="hudson" created="Tue, 9 Sep 2014 01:30:57 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #477 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/477/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/477/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11772&quot; title=&quot;Bulk load mvcc and seqId issues with native hfiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11772&quot;&gt;&lt;del&gt;HBASE-11772&lt;/del&gt;&lt;/a&gt; Bulk load mvcc and seqId issues with native hfiles (tedyu: rev 605bc083c22c8450e351341f63c0f97389b3300b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestScannerWithBulkload.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14126516" author="hudson" created="Tue, 9 Sep 2014 03:15:46 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #503 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/503/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/503/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11772&quot; title=&quot;Bulk load mvcc and seqId issues with native hfiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11772&quot;&gt;&lt;del&gt;HBASE-11772&lt;/del&gt;&lt;/a&gt; Bulk load mvcc and seqId issues with native hfiles (tedyu: rev 605bc083c22c8450e351341f63c0f97389b3300b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestScannerWithBulkload.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14331211" author="enis" created="Sat, 21 Feb 2015 23:34:26 +0000"  >&lt;p&gt;Closing this issue after 0.99.0 release. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12729762">HBASE-11591</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12667294" name="HBASE-11772-0.98-v2.patch" size="15753" author="jinghe" created="Tue, 9 Sep 2014 00:18:33 +0000"/>
                            <attachment id="12662633" name="HBASE-11772-0.98.patch" size="2741" author="jinghe" created="Mon, 18 Aug 2014 23:36:12 +0000"/>
                            <attachment id="12664563" name="HBASE-11772-master-v1.patch" size="8487" author="jinghe" created="Wed, 27 Aug 2014 05:16:40 +0000"/>
                            <attachment id="12666807" name="HBASE-11772-master-v2.patch" size="8248" author="jinghe" created="Fri, 5 Sep 2014 15:40:13 +0000"/>
                            <attachment id="12666847" name="HBASE-11772-master-v3.patch" size="8575" author="jinghe" created="Fri, 5 Sep 2014 18:37:44 +0000"/>
                            <attachment id="12667126" name="HBASE-11772-master-v4.patch" size="8852" author="jinghe" created="Mon, 8 Sep 2014 03:53:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 19 Aug 2014 00:07:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>412781</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1z0db:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>412767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>