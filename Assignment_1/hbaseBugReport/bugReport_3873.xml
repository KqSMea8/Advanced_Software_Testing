<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:13:53 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3873/HBASE-3873.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3873] Mavenize Hadoop Snappy JAR/SOs project dependencies</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3873</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;(This JIRA builds on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3691&quot; title=&quot;Add compressor support for &amp;#39;snappy&amp;#39;, google&amp;#39;s compressor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3691&quot;&gt;&lt;del&gt;HBASE-3691&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;I&apos;m working on simplifying how to use Hadoop Snappy from other based maven projects. The idea is that hadoop-snappy JAR and the SOs (snappy and hadoop-snappy) would be picked up from a Maven repository (like any other dependencies). SO files will be picked up based on the architecture where the build is running (32 or 64 bits).&lt;/p&gt;

&lt;p&gt;For Hbase this would remove the need to manually copy snappy JAR and SOs (snappy and hadoop-snappy) into HADOOP_HOME/lib or HBASE_HOME/lib and hadoop-snappy would be handled as a regular maven dependency (with a trick for the SOs file).&lt;/p&gt;

&lt;p&gt;The changes would affect only the pom.xml and the would be in a &apos;snappy&apos; profile, thus requiring &apos;-Dsnappy&apos; option in Maven invocations to trigger the including of snappy JAR and SOs.&lt;/p&gt;

&lt;p&gt;Because hadoop-snappy (JAR and SOs) are not currently avail in public Maven repos, until that happens, Hbase developer would have to checkout and &apos;mvn install&apos; hadoop-snappy. Which is (IMO) simpler than what will have to be done in once &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3691&quot; title=&quot;Add compressor support for &amp;#39;snappy&amp;#39;, google&amp;#39;s compressor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3691&quot;&gt;&lt;del&gt;HBASE-3691&lt;/del&gt;&lt;/a&gt; is committed.&lt;/p&gt;

</description>
                <environment>&lt;p&gt;Linux&lt;/p&gt;</environment>
        <key id="12506738">HBASE-3873</key>
            <summary>Mavenize Hadoop Snappy JAR/SOs project dependencies</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tucu00">Alejandro Abdelnur</assignee>
                                    <reporter username="tucu00">Alejandro Abdelnur</reporter>
                        <labels>
                            <label>build</label>
                    </labels>
                <created>Tue, 10 May 2011 16:29:51 +0000</created>
                <updated>Fri, 20 Nov 2015 12:43:45 +0000</updated>
                            <resolved>Mon, 6 Jun 2011 23:17:13 +0000</resolved>
                                    <version>0.90.2</version>
                                    <fixVersion>0.92.0</fixVersion>
                                    <component>build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13032559" author="nspiegelberg" created="Thu, 12 May 2011 18:14:58 +0000"  >&lt;p&gt;Could we use snappy-java, which has Maven repo support already? &lt;a href=&quot;http://code.google.com/p/snappy-java/#Using_with_Maven&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://code.google.com/p/snappy-java/#Using_with_Maven&lt;/a&gt;  I&apos;m not sure what the maturity of that project is.&lt;/p&gt;</comment>
                            <comment id="13032567" author="tucu00" created="Thu, 12 May 2011 18:31:13 +0000"  >&lt;p&gt;snappy-java only provides snappy IO streams, it does not provide a Hadoop CompressionCodec for Snappy.&lt;/p&gt;

</comment>
                            <comment id="13040374" author="tucu00" created="Fri, 27 May 2011 18:40:06 +0000"  >&lt;p&gt;The attached patch modifies HBase POM to consume hadoop-snappy (JAR &amp;amp; SOs) as a regular maven dependencies (including the hadoop-snappy and snappy SO files).&lt;/p&gt;

&lt;p&gt;By default Hbase builds without including snappy, to enable snappy during for testing/packaging invoke maven with the &apos;-Dsnappy&apos; option.&lt;/p&gt;

&lt;p&gt;The TestCompressionTest testcase will assert SNAPPY compression based on the availability of the Snappy codec class (we should do the same for LZO)&lt;/p&gt;

&lt;p&gt;Regarding building/installing Hadoop-Snappy locally:&lt;/p&gt;

&lt;p&gt;Because hadoop-snappy is not currently available in public Maven repositories, you need to build and install hadoop-snappy in your local Maven cache.  hadoop-snappy build is Mavenized, thus building/installing-locally hadoop-snappy is done with a &apos;mvn install&apos;. To build hadoop-snappy you have to have snappy SO installed in your /usr/local/lib (or in an alternate directory and use -Dsnappy.lib= when building/installing hadoop-snappy)&lt;/p&gt;</comment>
                            <comment id="13042601" author="stack" created="Thu, 2 Jun 2011 04:27:26 +0000"  >&lt;p&gt;@Alejandro&lt;/p&gt;

&lt;p&gt;This looks great.&lt;/p&gt;

&lt;p&gt;I tried it on a fresh machine where I had to setup a build environment.  I installed snappy.  I then moved to hadoop-snappy and tried doing mvn package.  It seems like I have to run the command as root?  Is that so for you?  I then got stuck here:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
tack@sv4borg231:~/hadoop-snappy-read-only$ sudo ~/bin/mvn/bin/mvn &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;
Warning: JAVA_HOME environment variable is not set.
[INFO] Scanning &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; projects...
[INFO] ------------------------------------------------------------------------
[INFO] Building Hadoop Snappy
[INFO]    task-segment: [&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;]
[INFO] ------------------------------------------------------------------------
[INFO] [resources:resources {execution: &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-resources}]
[INFO] Using &apos;UTF-8&apos; encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /home/stack/hadoop-snappy-read-only/src/main/resources
[INFO] [compiler:compile {execution: &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-compile}]
[INFO] Nothing to compile - all classes are up to date
[INFO] [antrun:run {execution: compile}]
[INFO] Executing tasks

main:

checkpreconditions:

compilenative:
     [exec] Can&apos;t exec &lt;span class=&quot;code-quote&quot;&gt;&quot;libtoolize&quot;&lt;/span&gt;: No such file or directory at /usr/bin/autoreconf line 188.
     [exec] Use of uninitialized value $libtoolize in pattern match (m&lt;span class=&quot;code-comment&quot;&gt;//) at /usr/bin/autoreconf line 188.
&lt;/span&gt;     [exec] Can&apos;t exec &lt;span class=&quot;code-quote&quot;&gt;&quot;aclocal&quot;&lt;/span&gt;: No such file or directory at /usr/share/autoconf/Autom4te/FileUtils.pm line 326.
     [exec] autoreconf: failed to run aclocal: No such file or directory
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This seems to be saying that I should have run a configure in here in hadoop-snappy-read-only first?  Or I&apos;m running &apos;mvn package&apos; but i should have done something else first?&lt;/p&gt;

&lt;p&gt;I&apos;m asking because i want to copy your instructions above into our manual here: &lt;a href=&quot;http://hbase.apache.org/book/snappy.compression.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/book/snappy.compression.html&lt;/a&gt; (Maybe you have suggestions on what to add here?)&lt;/p&gt;

&lt;p&gt;Thanks for the nice work Alejandro.&lt;/p&gt;</comment>
                            <comment id="13042853" author="apurtell" created="Thu, 2 Jun 2011 16:33:22 +0000"  >&lt;p&gt;+1 I agree this is nice. From someone who recently integrated snappy and HBase support for it into an internal build, this would have saved that time. Likewise if we do similar for LZO. I might be interested in contributing similar for LZMA, through admittedly it is a specialist case.&lt;/p&gt;</comment>
                            <comment id="13043157" author="tucu00" created="Fri, 3 Jun 2011 00:47:06 +0000"  >&lt;p&gt;Thanks.&lt;/p&gt;

&lt;p&gt;Stack, you need to have autotools installed (autoconf, automake &amp;amp; libtool).&lt;/p&gt;

&lt;p&gt;Andrew, it is possible to do the same for LZO. We&apos;d have to &apos;copy&apos; the Mavenization done in hadoop-snappy to hadoop-lzo. Still, on the HBase side this would have to be done using a profile disabled by default (due to license issues we cannot bundled LZO stuff in HBase distro).&lt;/p&gt;</comment>
                            <comment id="13043202" author="stack" created="Fri, 3 Jun 2011 03:29:19 +0000"  >&lt;p&gt;@Alejandro&lt;/p&gt;

&lt;p&gt;Yeah, I already have them installed &amp;#8211; thats whats odd:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
stack@sv4borg231:~/hadoop-snappy-read-only$ sudo apt-get install autotools-dev
Reading &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; lists... Done
Building dependency tree       
Reading state information... Done
autotools-dev is already the newest version.
0 upgraded, 0 newly installed, 0 to remove and 2 not upgraded.
stack@sv4borg231:~/hadoop-snappy-read-only$ mvn &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;
[INFO] Scanning &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; projects...
[INFO] ------------------------------------------------------------------------
[INFO] Building Hadoop Snappy
[INFO]    task-segment: [&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;]
[INFO] ------------------------------------------------------------------------
[INFO] [resources:resources]
[INFO] Using &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; encoding to copy filtered resources.
[INFO] [compiler:compile]
[INFO] Compiling 4 source files to /home/stack/hadoop-snappy-read-only/target/classes
[INFO] [antrun:run {execution: compile}]
[INFO] Executing tasks

main:

checkpreconditions:

compilenative:
    [mkdir] Created dir: /home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/config
    [mkdir] Created dir: /home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/m4
     [exec] Can&apos;t exec &lt;span class=&quot;code-quote&quot;&gt;&quot;libtoolize&quot;&lt;/span&gt;: No such file or directory at /usr/bin/autoreconf line 188.
     [exec] Use of uninitialized value $libtoolize in pattern match (m&lt;span class=&quot;code-comment&quot;&gt;//) at /usr/bin/autoreconf line 188.
&lt;/span&gt;     [exec] Can&apos;t exec &lt;span class=&quot;code-quote&quot;&gt;&quot;aclocal&quot;&lt;/span&gt;: No such file or directory at /usr/share/autoconf/Autom4te/FileUtils.pm line 326.
     [exec] autoreconf: failed to run aclocal: No such file or directory
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] An Ant BuildException has occured: The following error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; executing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; line:
/home/stack/hadoop-snappy-read-only/maven/build-compilenative.xml:62: exec returned: 1

[INFO] ------------------------------------------------------------------------
[INFO] For more information, run Maven with the -e &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt;
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 6 seconds
[INFO] Finished at: Thu Jun 02 20:11:01 PDT 2011
[INFO] Final Memory: 32M/677M
[INFO] ------------------------------------------------------------------------
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I install libtool I get further....If i reinstall automake I get further still.....&lt;/p&gt;

&lt;p&gt;I have to set JAVA_HOME it seems...&lt;/p&gt;

&lt;p&gt;If I redo the build I run into this issue:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
...
compilenative:
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/src/.svn/format&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/src/.svn/entries&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/src/.svn/text-base/SnappyCompressor.cc.svn-base&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/src/.svn/text-base/org_apache_hadoop_io_compress_snappy_SnappyCompressor.h.svn-base&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/src/.svn/text-base/SnappyDecompressor.cc.svn-base&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/src/.svn/text-base/hadoop_snappy.h.svn-base&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/src/.svn/text-base/org_apache_hadoop_io_compress_snappy_SnappyDecompressor.h.svn-base&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/src/.svn/all-wcprops&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/.svn/format&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/.svn/entries&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/.svn/text-base/configure.ac.svn-base&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/.svn/text-base/packageNativeHadoop.sh.svn-base&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/.svn/text-base/Makefile.am.svn-base&apos;: Permission denied
     [exec] cp: cannot create regular file `/home/stack/hadoop-snappy-read-only/target/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-src/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/.svn/all-wcprops&apos;: Permission denied
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] An Ant BuildException has occured: The following error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; executing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; line:
/home/stack/hadoop-snappy-read-only/maven/build-compilenative.xml:54: exec returned: 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So I have to manually remove the target dir.....&lt;/p&gt;

&lt;p&gt;Now I&apos;m having same as this issue: &lt;a href=&quot;http://code.google.com/p/hadoop-snappy/issues/detail?id=2&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://code.google.com/p/hadoop-snappy/issues/detail?id=2&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     [exec] /usr/bin/ld: cannot find -ljvm
     [exec] collect2: ld returned 1 exit status
     [exec] make: *** [libhadoopsnappy.la] Error 1
     [exec] libtool: link: g++ -shared -nostdlib /usr/lib/gcc/x86_64-linux-gnu/4.3.3/../../../../lib/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.3.3/crtbeginS.o  src/.libs/SnappyCompressor.o src/.libs/SnappyDecompressor.o   -L/usr/local/lib /usr/local/lib/libsnappy.so -ljvm -L/usr/lib/gcc/x86_64-linux-gnu/4.3.3 -L/usr/lib/gcc/x86_64-linux-gnu/4.3.3/../../../../lib -L/lib/../lib -L/usr/lib/../lib -L/usr/lib/gcc/x86_64-linux-gnu/4.3.3/../../.. -lstdc++ -lm -lc -lgcc_s /usr/lib/gcc/x86_64-linux-gnu/4.3.3/crtendS.o /usr/lib/gcc/x86_64-linux-gnu/4.3.3/../../../../lib/crtn.o    -Wl,-soname -Wl,libhadoopsnappy.so.0 -o .libs/libhadoopsnappy.so.0.0.1
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] An Ant BuildException has occured: The following error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; executing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; line:
/home/stack/hadoop-snappy-read-only/maven/build-compilenative.xml:91: exec returned: 2
...

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thought you might be interested in my experience Alejandro.&lt;/p&gt;

&lt;p&gt;Good stuff.&lt;/p&gt;</comment>
                            <comment id="13044021" author="tucu00" created="Fri, 3 Jun 2011 20:31:22 +0000"  >&lt;p&gt;Stack,&lt;/p&gt;

&lt;p&gt;I&apos;ll look into those .svn files under build.&lt;/p&gt;

&lt;p&gt;On your second error, please try updating your hadoop-snappy, this as been fixed yesterday.&lt;/p&gt;

&lt;p&gt;Thxs.&lt;/p&gt;</comment>
                            <comment id="13044135" author="tucu00" created="Fri, 3 Jun 2011 23:47:32 +0000"  >&lt;p&gt;The patch is missing adding the snappy/hadoop-snappy native libs to lib/native/$ARCH/&lt;/p&gt;</comment>
                            <comment id="13044153" author="tucu00" created="Sat, 4 Jun 2011 00:50:06 +0000"  >&lt;p&gt;Stack,&lt;/p&gt;

&lt;p&gt;I don&apos;t know how you ended up with an .svn directory under the hadoop-snappy target directory.&lt;/p&gt;

&lt;p&gt;My steps to build/M2-install hadoop-snappy are:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Download &amp;amp; expand snappy 1.0.2 tar&lt;/li&gt;
	&lt;li&gt;cd to snappy expanded dir (./snappy-1.0.2)&lt;/li&gt;
	&lt;li&gt;Build snappy 1.0.2 (./configure;make install DESTDIR=`pwd`/build) (make sure to use a full path in DESTDIR)&lt;/li&gt;
	&lt;li&gt;svn checkout hadoop-snappy&lt;/li&gt;
	&lt;li&gt;cd to hadoop-snappy dir (./hadoop-snappy-read-only)&lt;/li&gt;
	&lt;li&gt;mvn install -Dsnappy.prefix=$
{SNAPPY_SRC}
&lt;p&gt;/build/usr/local&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13044155" author="tucu00" created="Sat, 4 Jun 2011 00:54:23 +0000"  >&lt;p&gt;The attached patch takes care of including the snappy &amp;amp; hadoop-snappy SO files in the TARBALL if the -Dsnappy option was given to maven. For example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ mvn &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; -Dsnappy
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The SO files are in the lib/native/$&lt;/p&gt;
{ARCH}
&lt;p&gt; directory (the hbase scripts add that dir to the LD_PATH same as Hadoop &lt;del&gt;thanks for the tip Todd&lt;/del&gt;).&lt;/p&gt;

&lt;p&gt;The assembly has been changed to generate an expanded directory instead the TARBALL. And the antrun plugin has been wired to the package phase to create the TARBALL using Unix &lt;tt&gt;tar&lt;/tt&gt; command. &lt;/p&gt;

&lt;p&gt;This change is needed to preserve symlinks (Maven assembly is dumb when it comes to symlinks).&lt;/p&gt;

</comment>
                            <comment id="13044383" author="stack" created="Sat, 4 Jun 2011 20:11:17 +0000"  >&lt;p&gt;Much smoother running.  This is great.  Do you think we should actually ship with snappy binaries, now its so easy to produce them (Your patch has a cdh reference in it but easy fix which I can make on commit)?  Asking because I want to commit a bit of documentation on this new feature at same time.  Thanks A.&lt;/p&gt;

&lt;p&gt;Here is something I ran into that you might be interested in building hadoop-snappy.&lt;/p&gt;

&lt;p&gt;After a clean build, I tried to rerun it and its weird that clean can&apos;t delete the target dir... you know what that is about?  (I can do a rm -rf on the target dir as myself)&lt;/p&gt;

&lt;p&gt;mvn clean install:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] Failed to delete directory: /home/stack/hadoop-snappy-read-only/target. Reason: Unable to delete directory /home/stack/hadoop-snappy-read-only/target/hadoop-snappy-0.0.1-SNAPSHOT-tar/hadoop-snappy-0.0.1-SNAPSHOT/lib/&lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;/Linux-amd64-64
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="13044418" author="tucu00" created="Sun, 5 Jun 2011 00:20:43 +0000"  >&lt;p&gt;Thanks Stack. the cdh reference is a typo, yes please remove it before committing it. About bundling it with HBase distro, yes, it makes sense. And good that you are taking on the the docs.&lt;/p&gt;

&lt;p&gt;I&apos;ll look at that error on Monday.&lt;/p&gt;
</comment>
                            <comment id="13045204" author="stack" created="Mon, 6 Jun 2011 23:17:13 +0000"  >&lt;p&gt;Committed to TRUNK.  Thanks for the patch Alejandro (I updated doc. in book to suit).  Sweet.&lt;/p&gt;</comment>
                            <comment id="13045250" author="hudson" created="Tue, 7 Jun 2011 03:11:49 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #1954 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/1954/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/1954/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3873&quot; title=&quot;Mavenize Hadoop Snappy JAR/SOs project dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3873&quot;&gt;&lt;del&gt;HBASE-3873&lt;/del&gt;&lt;/a&gt; Mavenize Hadoop Snappy JAR/SOs project dependencies&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/util/TestCompressionTest.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/pom.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/docbkx/build.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/assembly/all.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/docbkx/book.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13082609" author="chulk90" created="Wed, 10 Aug 2011 19:40:59 +0000"  >&lt;p&gt;After &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; mvn install -Dsnappy.prefix=(absolute-path to Snappy) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;, I get the following error:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

compilenative:

     ...

     [exec] configure: creating ./config.status
     [exec] config.status: creating Makefile
     [exec] config.status: creating config.h
     [exec] config.status: config.h is unchanged
     [exec] config.status: executing depfiles commands
     [exec] config.status: executing libtool commands
     [exec] /bin/bash ./libtool --tag=CC   --mode=link gcc -g -Wall -fPIC -O2 -m64 -g -O2 -version-info 0:1:0 -L/home/ngc/Char/snap102/snappy-1.0.2/build/usr/local/lib -o libhadoopsnappy.la -rpath /usr/local/lib src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.lo src/org/apache/hadoop/io/compress/snappy/SnappyDecompressor.lo  -ljvm -ldl 
     [exec] libtool: link: gcc -shared  src/org/apache/hadoop/io/compress/snappy/.libs/SnappyCompressor.o src/org/apache/hadoop/io/compress/snappy/.libs/SnappyDecompressor.o   -L/home/ngc/Char/snap102/snappy-1.0.2/build/usr/local/lib -ljvm -ldl  -m64   -Wl,-soname -Wl,libhadoopsnappy.so.0 -o .libs/libhadoopsnappy.so.0.0.1
     [exec] /usr/bin/ld: cannot find -ljvm
     [exec] collect2: ld returned 1 exit status
     [exec] make: *** [libhadoopsnappy.la] Error 1
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 14.624s
[INFO] Finished at: Wed Aug 10 11:51:09 EDT 2011
[INFO] Final Memory: 6M/361M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-antrun-plugin:1.6:run (compile) on project hadoop-snappy: An Ant BuildException has occured: The following error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; executing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; line:
[ERROR] /home/ngc/Char/snap102/snappy-1.0.2/hadoop-snappy-read-only/maven/build-compilenative.xml:75: exec returned: 2
[ERROR] -&amp;gt; [Help 1]

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;&amp;#8211;&lt;/p&gt;

&lt;p&gt;I&apos;m aware that this issue is similar to what Stack experienced (03/Jun/11 03:29), so I&apos;ve tried everything that you and others at p/hadoop-snappy suggested. However, my Hadoop-Snapppy is the latest subversion, and my problem persists ever after I replaced &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt; LDFLAGS=$ldflags_bak &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; with &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt; #LDFLAGS=$ldflags_bak &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;Unlike many experts like you and others in JIRA, I&apos;m an undergraduate who just got into the world of Hadoop and HBase, and therefore does not have extensive knowledge of what goes on in background. I&apos;d really appreciate if you could help me with this issue.&lt;/p&gt;</comment>
                            <comment id="13086015" author="chulk90" created="Tue, 16 Aug 2011 22:11:03 +0000"  >&lt;p&gt;I figured out the problem. &lt;br/&gt;
When you give -Dsnappy.prefix=$SNAPPY_BUILD_DIR option, the builder tries to find libjvm.so in the Snappy directory, not at $JAVA_HOME/jre/lib/{$OS_ARCH}/server.&lt;br/&gt;
Therefore, you need to either fix the source code or simply make a symlink in the $SNAPPY_BUILD_DIR to your libjvm.so&lt;/p&gt;</comment>
                            <comment id="13086018" author="stack" created="Tue, 16 Aug 2011 22:16:54 +0000"  >&lt;p&gt;@Chul  Can you make a new issue with a patch?  I&apos;ll do doc changes...  Thanks.&lt;/p&gt;</comment>
                            <comment id="13230664" author="francisco cruz" created="Thu, 15 Mar 2012 22:47:12 +0000"  >&lt;p&gt;Hi all, I am having the following problem when building the hadoop snappy:&lt;/p&gt;


&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; config.status: executing libtool commands&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; depbase=`echo src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.lo | sed &apos;s|&lt;span class=&quot;error&quot;&gt;&amp;#91;^/&amp;#93;&lt;/span&gt;*$|.deps/&amp;amp;|;s|\.lo$||&apos;`;\&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; 	/bin/bash ./lsrc/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c: In function &apos;Java_org_apache_hadoop_io_compress_snappy_SnappyCompreibtool --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -I/usr/lib/jvm/java-7-oracle/include -I/usr/lib/jvm/java-7-oracle/inclssor_initIDs&apos;:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c:64:49: error: expected expression before &apos;,&apos; token&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c: In function &apos;Java_org_apache_hadoop_io_compress_snappy_SnappyCompressor_compressBytesDirect&apos;:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c:117:3: warning: passing argument 4 of &apos;dlsym_snappy_compress&apos; from incompatible pointer type &lt;span class=&quot;error&quot;&gt;&amp;#91;enabled by default&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c:117:3: note: expected &apos;size_t *&apos; but argument is of type &apos;jint *&apos;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; make: *** &lt;span class=&quot;error&quot;&gt;&amp;#91;src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.lo&amp;#93;&lt;/span&gt; Error 1&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; ude/linux -I/home/gsd/hadoop-snappy-read-only/src/main/native/src -Isrc/org/apache/hadoop/io/compress/snappy -I/usr/local//include -g -Wall -fPIC -O2 -m64 -g -O2 -MT src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.lo -MD -MP -MF $depbase.Tpo -c -o src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.lo src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c &amp;amp;&amp;amp;\&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; 	mv -f $depbase.Tpo $depbase.Plo&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I/usr/lib/jvm/java-7-oracle/include -I/usr/lib/jvm/java-7-oracle/include/linux -I/home/gsd/hadoop-snappy-read-only/src/main/native/src -Isrc/org/apache/hadoop/io/compress/snappy -I/usr/local//include -g -Wall -fPIC -O2 -m64 -g -O2 -MT src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.lo -MD -MP -MF src/org/apache/hadoop/io/compress/snappy/.deps/SnappyCompressor.Tpo -c src/org/apache/hadoop/io/compress/snappy/SnappyCompressor.c  -fPIC -DPIC -o src/org/apache/hadoop/io/compress/snappy/.libs/SnappyCompressor.o&lt;/p&gt;

&lt;p&gt;Does anyone have any idea why is this happening?&lt;br/&gt;
Thanks for your help&lt;/p&gt;</comment>
                            <comment id="15017610" author="lars_francke" created="Fri, 20 Nov 2015 12:43:45 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12502193">HBASE-3691</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12508575">HBASE-3930</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12481424" name="HBASE-3873.patch" size="6409" author="tucu00" created="Sat, 4 Jun 2011 00:54:23 +0000"/>
                            <attachment id="12480684" name="HBASE-3873.patch" size="5193" author="tucu00" created="Fri, 27 May 2011 18:40:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 12 May 2011 18:14:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33246</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05idj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30074</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Add support to hbase for snappy compression.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>