<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:23:45 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11494/HBASE-11494.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11494] RegionServer throws Exception when response is too long</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11494</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Table&#8217;s cell having a large number of versions, it works fine when I read 100K VERSIONS from the cell, but regionServer gives exception when I attempted to read upto 1M VERSIONS. error happens with both hbase shell , and happy base client&lt;/p&gt;

&lt;p&gt;2014-07-10 10:45:30,098 WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;RpcServer.handler=47,port=60020&amp;#93;&lt;/span&gt; ipc.RpcServer: (responseTooLarge): &lt;/p&gt;
{&#8220;processingtimems&#8221;:104,&#8221;call&#8221;:&#8221;Get(org.apache.hadoop.hbase.protobuf.generated.ClientProtos$GetRequest)&#8221;,&#8221;client&#8221;:&#8221;17.203.54.172:56290&#8243;,&#8221;starttimems&#8221;:1405014329979,&#8221;queuetimems&#8221;:0,&#8221;class&#8221;:&#8221;HRegionServer&#8221;,&#8221;responsesize&#8221;:157334052,&#8221;method&#8221;:&#8221;Get&#8221;}
&lt;p&gt;2014-07-10 10:45:30,923 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;RpcServer.reader=6,port=60020&amp;#93;&lt;/span&gt; ipc.RpcServer: RpcServer.listener,port=60020: count of bytes read: 0&lt;br/&gt;
java.io.IOException: Connection reset by peer&lt;br/&gt;
at sun.nio.ch.FileDispatcherImpl.read0(Native Method)&lt;br/&gt;
at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)&lt;br/&gt;
at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)&lt;br/&gt;
at sun.nio.ch.IOUtil.read(IOUtil.java:197)&lt;br/&gt;
at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer.channelRead(RpcServer.java:2224)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer$Connection.readAndProcess(RpcServer.java:1415)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer$Listener.doRead(RpcServer.java:790)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer$Listener$Reader.doRunLoop(RpcServer.java:581)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer$Listener$Reader.run(RpcServer.java:556)&lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br/&gt;
at java.lang.Thread.run(Thread.java:744)&lt;br/&gt;
2014-07-10 10:45:30,923 WARN &lt;span class=&quot;error&quot;&gt;&amp;#91;RpcServer.responder&amp;#93;&lt;/span&gt; ipc.RpcServer: RpcServer.respondercallId: 93 service: ClientService methodName: Get size: 225 connection: 17.203.54.172:56290: output error&lt;br/&gt;
2014-07-10 10:45:30,924 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;RpcServer.responder&amp;#93;&lt;/span&gt; ipc.RpcServer: RpcServer.responder: asyncWrite&lt;br/&gt;
java.io.IOException: Broken pipe&lt;br/&gt;
at sun.nio.ch.FileDispatcherImpl.writev0(Native Method)&lt;br/&gt;
at sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:51)&lt;br/&gt;
at sun.nio.ch.IOUtil.write(IOUtil.java:148)&lt;br/&gt;
at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:524)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.BufferChain.write(BufferChain.java:106)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer.channelWrite(RpcServer.java:2204)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer$Responder.processResponse(RpcServer.java:1004)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer$Responder.doAsyncWrite(RpcServer.java:944)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer$Responder.doRunLoop(RpcServer.java:873)&lt;br/&gt;
at org.apache.hadoop.hbase.ipc.RpcServer$Responder.run(RpcServer.java:849)&lt;/p&gt;</description>
                <environment>&lt;p&gt;HDP 2.1, REHL 6.0&lt;/p&gt;</environment>
        <key id="12726647">HBASE-11494</key>
            <summary>RegionServer throws Exception when response is too long</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hiima">Roger Xu</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Jul 2014 18:28:02 +0000</created>
                <updated>Mon, 14 Jul 2014 21:39:24 +0000</updated>
                            <resolved>Fri, 11 Jul 2014 00:25:46 +0000</resolved>
                                                                    <component>IPC/RPC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14058152" author="enis" created="Fri, 11 Jul 2014 00:25:32 +0000"  >&lt;p&gt;There is no streaming rpc or scanner like streaming for gets with multiple versions. If you are using a lot of versions, you should restrict the number of versions returned and do windowing from client side. &lt;/p&gt;</comment>
                            <comment id="14059806" author="anoop.hbase" created="Sat, 12 Jul 2014 14:39:15 +0000"  >&lt;p&gt;Pls see Scan#setBatch(int)&lt;/p&gt;</comment>
                            <comment id="14061017" author="hiima" created="Mon, 14 Jul 2014 18:48:48 +0000"  >&lt;p&gt;Thanks.&lt;/p&gt;

&lt;p&gt;I found that it was ProtoBuf, CodedInputStream on the client side that has a 64M limit and closes the connection once incoming data crosses the threshold. &lt;br/&gt;
After patching ProtoBuf library to remove the check, everything works great now.&lt;/p&gt;

</comment>
                            <comment id="14061139" author="stack" created="Mon, 14 Jul 2014 20:03:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hiima&quot; class=&quot;user-hover&quot; rel=&quot;hiima&quot;&gt;Roger Xu&lt;/a&gt; Mind posting your pb patch?&lt;/p&gt;</comment>
                            <comment id="14061222" author="hiima" created="Mon, 14 Jul 2014 20:54:22 +0000"  >&lt;p&gt;Ideally Hbase client should provide a way to call CodedInputStream.setSizeLimit() instead of patching Protobuf. To solve my own problem, I just hacked the following line:&lt;/p&gt;

&lt;p&gt;diff CodedInputStream.java /tmp/CodedInputStream.java&lt;br/&gt;
754c754&lt;br/&gt;
&amp;lt;       if ( /*totalBytesRead &amp;gt; sizeLimit || */totalBytesRead &amp;lt; 0) {&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
&amp;gt;       if ( totalBytesRead &amp;gt; sizeLimit || totalBytesRead &amp;lt; 0) {&lt;/p&gt;</comment>
                            <comment id="14061295" author="stack" created="Mon, 14 Jul 2014 21:39:24 +0000"  >&lt;p&gt;Thanks you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hiima&quot; class=&quot;user-hover&quot; rel=&quot;hiima&quot;&gt;Roger Xu&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 11 Jul 2014 00:25:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>404754</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 22 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xnpz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>404792</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>