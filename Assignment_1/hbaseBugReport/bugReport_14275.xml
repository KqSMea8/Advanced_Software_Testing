<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:51:28 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14275/HBASE-14275.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14275] Backport to 0.98 HBASE-10785 Metas own location should be cached</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14275</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We&apos;ve seen similar problem reported on 0.98.&lt;br/&gt;
It is good improvement to have.&lt;br/&gt;
This will cover &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10785&quot; title=&quot;Metas own location should be cached&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10785&quot;&gt;&lt;del&gt;HBASE-10785&lt;/del&gt;&lt;/a&gt; and the a later &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11332&quot; title=&quot;Fix for metas location cache from HBASE-10785 &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11332&quot;&gt;&lt;del&gt;HBASE-11332&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12857640">HBASE-14275</key>
            <summary>Backport to 0.98 HBASE-10785 Metas own location should be cached</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jinghe">Jerry He</assignee>
                                    <reporter username="jinghe">Jerry He</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Aug 2015 20:36:40 +0000</created>
                <updated>Fri, 20 Nov 2015 11:52:41 +0000</updated>
                            <resolved>Fri, 18 Sep 2015 21:32:16 +0000</resolved>
                                                    <fixVersion>0.98.14</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14705722" author="jinghe" created="Thu, 20 Aug 2015 20:43:25 +0000"  >&lt;p&gt;It is not a trivial backport since the HConnectionManager had a major refactoring. But it is still a simple backport.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;, Can you check the correctness of the backport?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;,  Do you think it is ok for 0.98?&lt;/p&gt;</comment>
                            <comment id="14705854" author="enis" created="Thu, 20 Aug 2015 22:05:19 +0000"  >&lt;p&gt;Yes, the addendum I was talking about was indeed &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11332&quot; title=&quot;Fix for metas location cache from HBASE-10785 &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11332&quot;&gt;&lt;del&gt;HBASE-11332&lt;/del&gt;&lt;/a&gt;. &lt;br/&gt;
Patch looks good to me. &lt;/p&gt;</comment>
                            <comment id="14707808" author="jinghe" created="Sat, 22 Aug 2015 03:06:52 +0000"  >&lt;p&gt;Re-attach to trigger QA run.&lt;/p&gt;</comment>
                            <comment id="14710388" author="apurtell" created="Tue, 25 Aug 2015 01:11:38 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14710553" author="hadoopqa" created="Tue, 25 Aug 2015 04:12:11 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12751849/HBASE-14275-0.98.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12751849/HBASE-14275-0.98.patch&lt;/a&gt;&lt;br/&gt;
  against 0.98 branch at commit d0873f5a8cc060adbc5a1ae0ed52b84a8942a868.&lt;br/&gt;
  ATTACHMENT ID: 12751849&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 23 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15232//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14711493" author="jinghe" created="Tue, 25 Aug 2015 15:51:23 +0000"  >&lt;p&gt;I have run YCSB workloads with the patch in hbase client binding. No issues.&lt;br/&gt;
From Enis&apos;s last comment in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10785&quot; title=&quot;Metas own location should be cached&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10785&quot;&gt;&lt;del&gt;HBASE-10785&lt;/del&gt;&lt;/a&gt;, he has had it available in branches including 0.98 internally for a while. &lt;/p&gt;

&lt;p&gt;Will commit shortly. Thanks for the review.&lt;/p&gt;</comment>
                            <comment id="14712086" author="hudson" created="Tue, 25 Aug 2015 22:29:48 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98 #1099 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/1099/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/1099/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14275&quot; title=&quot;Backport to 0.98 HBASE-10785 Metas own location should be cached&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14275&quot;&gt;&lt;del&gt;HBASE-14275&lt;/del&gt;&lt;/a&gt; Backport to 0.98 &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10785&quot; title=&quot;Metas own location should be cached&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10785&quot;&gt;&lt;del&gt;HBASE-10785&lt;/del&gt;&lt;/a&gt; Metas own location should be cached (jerryjch: rev c0abda2e110772c58b5520789ffd53f287b399cf)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14712173" author="hudson" created="Tue, 25 Aug 2015 23:21:30 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #1053 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1053/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/1053/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14275&quot; title=&quot;Backport to 0.98 HBASE-10785 Metas own location should be cached&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14275&quot;&gt;&lt;del&gt;HBASE-14275&lt;/del&gt;&lt;/a&gt; Backport to 0.98 &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10785&quot; title=&quot;Metas own location should be cached&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10785&quot;&gt;&lt;del&gt;HBASE-10785&lt;/del&gt;&lt;/a&gt; Metas own location should be cached (jerryjch: rev c0abda2e110772c58b5520789ffd53f287b399cf)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-client/src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14791432" author="apurtell" created="Thu, 17 Sep 2015 01:47:44 +0000"  >&lt;p&gt;I&apos;m seeing instability in TestAssignmentManagerOnCluster and TestZKLessAMOnCluster and a bisect lead back to this change. Let me repeat the bisect and update shortly.&lt;/p&gt;</comment>
                            <comment id="14804711" author="apurtell" created="Thu, 17 Sep 2015 23:52:08 +0000"  >&lt;p&gt;Bisect brought me here again. &lt;/p&gt;</comment>
                            <comment id="14804912" author="jinghe" created="Fri, 18 Sep 2015 03:28:27 +0000"  >&lt;p&gt;Any interesting finding?&lt;/p&gt;</comment>
                            <comment id="14805157" author="apurtell" created="Fri, 18 Sep 2015 07:48:58 +0000"  >&lt;p&gt;Haven&apos;t had time to look. May just revert from the branch for now. Let me see if I can find some time to debug tomorrow. &lt;/p&gt;</comment>
                            <comment id="14876415" author="apurtell" created="Fri, 18 Sep 2015 21:08:14 +0000"  >&lt;p&gt;Go to this commit in 0.98, run TestAssignmentManagerOnCluster a few times, we will eventually get stuck cleaning up at the end of testSSHWhenDisablingTableRegionsInOpeningOrPendingOpenState.&lt;/p&gt;

&lt;p&gt;The deleteTable at line 1581 of HTU called from line 678 of the test gets stuck. This only happens when above in the test, at line 639, META is moved when colocated with the test table on the victim regionserver. If I add this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;@@ -645,6 +645,8 @@ public class TestAssignmentManagerOnCluster {
             .move(HRegionInfo.FIRST_META_REGIONINFO.getEncodedNameAsBytes(),
               Bytes.toBytes(rs.getServerName().getServerName()));
         am.waitForAssignment(HRegionInfo.FIRST_META_REGIONINFO);
+        // Drop the cached location for META
+        TEST_UTIL.getHBaseAdmin().getConnection().clearCaches(metaServerName);
       }
       
       am.regionOffline(hri);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;then the test passes reliably.&lt;/p&gt;

&lt;p&gt;Looks like when using MetaReader to wait until all regions are deleted, deleteTable won&apos;t attempt to relocate META should its cached location be stale. &lt;/p&gt;</comment>
                            <comment id="14876479" author="apurtell" created="Fri, 18 Sep 2015 21:32:16 +0000"  >&lt;p&gt;Moving to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14453&quot; title=&quot;HBaseAdmin#deleteTable should relocate META when cached location is stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14453&quot;&gt;&lt;del&gt;HBASE-14453&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15015805" author="lars_francke" created="Fri, 20 Nov 2015 11:52:41 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12888681">HBASE-14453</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12751849" name="HBASE-14275-0.98.patch" size="2655" author="jinghe" created="Sat, 22 Aug 2015 03:06:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 20 Aug 2015 22:05:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2j6br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>