<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:44:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13560/HBASE-13560.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13560] Large compaction queue should steal from small compaction queue when idle</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13560</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If you tune compaction threads so that a server is never over commited when large and small compaction threads are busy then it should be possible to have the large compactions steal work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12823946">HBASE-13560</key>
            <summary>Large compaction queue should steal from small compaction queue when idle</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="changgeng">Changgeng Li</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Sat, 25 Apr 2015 00:14:54 +0000</created>
                <updated>Fri, 12 Jun 2015 00:29:52 +0000</updated>
                            <resolved>Thu, 11 Jun 2015 21:42:49 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>1.2.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                    <component>Compaction</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="14565102" author="yuzhihong@gmail.com" created="Fri, 29 May 2015 17:29:18 +0000"  >&lt;p&gt;Add Apache license header to StealJobQueue.java&lt;br/&gt;
Should this class be in util package ? It can be used by other components.&lt;br/&gt;
Add annotation for stability.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
* the take/pool(&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,TimeUnit) methods would also check whether there are jobs in the steal-from queue &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; queue is
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;pool(&apos; : did you mean poll() ?&lt;br/&gt;
Please wrap long line above - limit to 100 characters per line.&lt;/p&gt;</comment>
                            <comment id="14565122" author="changgeng" created="Fri, 29 May 2015 17:42:42 +0000"  >&lt;p&gt;what does &quot;annotation for stability&quot; mean?&lt;/p&gt;</comment>
                            <comment id="14565132" author="changgeng" created="Fri, 29 May 2015 17:49:39 +0000"  >&lt;p&gt;Updated per Ted&apos;s comments.&lt;/p&gt;</comment>
                            <comment id="14565139" author="yuzhihong@gmail.com" created="Fri, 29 May 2015 17:51:26 +0000"  >&lt;p&gt;For TestStealJobQueue.java, please remove author information and add Apache license.&lt;/p&gt;

&lt;p&gt;w.r.t. &quot;annotation for stability&quot; , I suggest the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.classification.InterfaceAudience;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.classification.InterfaceStability
@InterfaceAudience.Public
@InterfaceStability.Evolving
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14565140" author="changgeng" created="Fri, 29 May 2015 17:51:59 +0000"  >&lt;p&gt;minor changes in comments&lt;/p&gt;</comment>
                            <comment id="14565148" author="changgeng" created="Fri, 29 May 2015 17:57:15 +0000"  >&lt;p&gt;author information has been removed and for the stability annotation.&lt;br/&gt;
For the stability annotation I use private for now until somebody requests it as suggested by Elliott.&lt;/p&gt;</comment>
                            <comment id="14565149" author="yuzhihong@gmail.com" created="Fri, 29 May 2015 17:57:16 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
37	@Category({RegionServerTests.class, SmallTests.class})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;After being moved to util package, this is no longer regionserver test, right ?&lt;/p&gt;</comment>
                            <comment id="14565151" author="changgeng" created="Fri, 29 May 2015 17:58:49 +0000"  >&lt;p&gt;good catch!.&lt;/p&gt;</comment>
                            <comment id="14565564" author="hadoopqa" created="Fri, 29 May 2015 22:25:06 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12736199/queuestealwork-v6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12736199/queuestealwork-v6.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit e0cf811b33d19d9aa6cd94298aea13d8ce981b14.&lt;br/&gt;
  ATTACHMENT ID: 12736199&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 3 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestReplicasClient&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestCompaction&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestCompactionWithCoprocessor&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 4 zombie test(s): 	at org.apache.hadoop.hbase.master.snapshot.TestSnapshotFileCache.testSnapshotTempDirReload(TestSnapshotFileCache.java:161)&lt;br/&gt;
	at org.apache.hadoop.hbase.TestAcidGuarantees.testScanAtomicity(TestAcidGuarantees.java:352)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.wal.TestWALReplay.testReplayEditsAfterRegionMovedWithMultiCF(TestWALReplay.java:246)&lt;br/&gt;
	at org.apache.hadoop.hbase.namespace.TestNamespaceAuditor.testStatePreserve(TestNamespaceAuditor.java:584)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14238//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14565695" author="changgeng" created="Sat, 30 May 2015 00:14:13 +0000"  >&lt;p&gt;looking at the unit failure.&lt;/p&gt;</comment>
                            <comment id="14566133" author="changgeng" created="Sat, 30 May 2015 18:42:50 +0000"  >&lt;p&gt;fix the unit test&lt;/p&gt;</comment>
                            <comment id="14566200" author="hadoopqa" created="Sat, 30 May 2015 21:18:43 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12736362/queuestealwork-v7.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12736362/queuestealwork-v7.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit ee30d050dc9112bc74eb02452bd9b3699d278f07.&lt;br/&gt;
  ATTACHMENT ID: 12736362&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14245//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14245//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14245//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14245//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14245//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14245//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14245//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14245//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14566271" author="changgeng" created="Sun, 31 May 2015 00:43:07 +0000"  >&lt;p&gt;The failing test org.apache.hadoop.hbase.master.TestDistributedLogSplitting seems to be flaky for a while.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14245/testReport/junit/TEST-org.apache.hadoop.hbase.master.TestDistributedLogSplitting/xml/_init_/history/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14245/testReport/junit/TEST-org.apache.hadoop.hbase.master.TestDistributedLogSplitting/xml/_init_/history/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14566281" author="yuzhihong@gmail.com" created="Sun, 31 May 2015 01:05:29 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
497	    &lt;span class=&quot;code-comment&quot;&gt;//prevent large compaction thread pool stealing job from small compaction queue.
&lt;/span&gt;498	    cst.shutdownLongCompactions();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can you explain the above change a little more ? In production, large compaction thread pool would always be running (as long as region server is running), right ?&lt;/p&gt;</comment>
                            <comment id="14566284" author="changgeng" created="Sun, 31 May 2015 01:26:28 +0000"  >&lt;p&gt;it should always be running. That&apos;s only for unit test purpose because originally the test was to verify the small compaction queue, and the newly introduced change would make large thread pool steal the jobs and will break this test. So this line is to disable the large compaction thread pool so that it won&apos;t steal jobs.&lt;/p&gt;</comment>
                            <comment id="14566291" author="changgeng" created="Sun, 31 May 2015 01:40:32 +0000"  >&lt;p&gt;I also have to change the below logic to allow a small job be taken by large thread pool.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

-        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.parent != pool) {
+
+        &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt; compaction pool can process small job
&lt;/span&gt;+        &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;Short&lt;/span&gt; compaction pool should not process large job
&lt;/span&gt;+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.parent == shortCompactions &amp;amp;&amp;amp; pool == longCompactions) {

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14566309" author="yuzhihong@gmail.com" created="Sun, 31 May 2015 02:48:04 +0000"  >&lt;p&gt;The test was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8665&quot; title=&quot;bad compaction priority behavior in queue can cause store to be blocked&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8665&quot;&gt;&lt;del&gt;HBASE-8665&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please take a look at that issue.&lt;/p&gt;</comment>
                            <comment id="14566310" author="yuzhihong@gmail.com" created="Sun, 31 May 2015 02:48:06 +0000"  >&lt;p&gt;The test was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8665&quot; title=&quot;bad compaction priority behavior in queue can cause store to be blocked&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8665&quot;&gt;&lt;del&gt;HBASE-8665&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please take a look at that issue.&lt;/p&gt;</comment>
                            <comment id="14566311" author="yuzhihong@gmail.com" created="Sun, 31 May 2015 02:48:09 +0000"  >&lt;p&gt;The test was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8665&quot; title=&quot;bad compaction priority behavior in queue can cause store to be blocked&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8665&quot;&gt;&lt;del&gt;HBASE-8665&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please take a look at that issue.&lt;/p&gt;</comment>
                            <comment id="14566632" author="changgeng" created="Sun, 31 May 2015 18:06:29 +0000"  >&lt;p&gt;I think the test is still valid. We just need to shutdown one of the thread pool after the change introduced by this issue.&lt;/p&gt;</comment>
                            <comment id="14566633" author="changgeng" created="Sun, 31 May 2015 18:06:32 +0000"  >&lt;p&gt;I think the test is still valid. We just need to shutdown one of the thread pool after the change introduced by this issue.&lt;/p&gt;</comment>
                            <comment id="14568225" author="changgeng" created="Mon, 1 Jun 2015 23:38:19 +0000"  >&lt;p&gt;is there anything else I need to work on this patch?&lt;/p&gt;</comment>
                            <comment id="14579741" author="changgeng" created="Tue, 9 Jun 2015 23:22:07 +0000"  >&lt;p&gt;ping. Anything else I need to work on this?&lt;/p&gt;</comment>
                            <comment id="14579801" author="eclark" created="Wed, 10 Jun 2015 00:36:43 +0000"  >&lt;p&gt;Sorry missed this since HadoopQA bot didn&apos;t come around. Let me try and get it to run.&lt;br/&gt;
Other than a clean test run I think this has all that it needs.&lt;/p&gt;</comment>
                            <comment id="14581123" author="eclark" created="Wed, 10 Jun 2015 21:36:47 +0000"  >&lt;p&gt;Kicking hbase&apos;s pre-commit build.&lt;/p&gt;</comment>
                            <comment id="14581190" author="hadoopqa" created="Wed, 10 Jun 2015 22:53:33 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12738925/HBASE-13560.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12738925/HBASE-13560.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 0f93986015122a517e1a0c949e159bf8fb218092.&lt;br/&gt;
  ATTACHMENT ID: 12738925&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestRegionRebalancing&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14372//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14372//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14372//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14372//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14372//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14372//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/14372//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/14372//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14581221" author="eclark" created="Wed, 10 Jun 2015 23:21:07 +0000"  >&lt;p&gt;+1 from me. I&apos;ll commit later unless there are other review comments.&lt;/p&gt;</comment>
                            <comment id="14581239" author="yuzhihong@gmail.com" created="Wed, 10 Jun 2015 23:36:11 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
497	    &lt;span class=&quot;code-comment&quot;&gt;//prevent large compaction thread pool stealing job from small compaction queue.
&lt;/span&gt;498	    cst.shutdownLongCompactions();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should there be a config which disables this feature ?&lt;/p&gt;

&lt;p&gt;In production, large compaction thread pool is always running. Meaning, with this feature on, the invariant testCompactionQueuePriorities() tries to test no longer holds.&lt;/p&gt;</comment>
                            <comment id="14581247" author="changgeng" created="Wed, 10 Jun 2015 23:42:41 +0000"  >&lt;p&gt;The test still pass if we shutdown the short compaction thread pool instead. So the test is really focus about the priority of jobs, not about which pool is processing it. &lt;br/&gt;
This change is similar to make the minimal threads number of short compaction pool  to be 2 which will also break the test without manually blocking one of them.&lt;/p&gt;</comment>
                            <comment id="14582193" author="eclark" created="Thu, 11 Jun 2015 16:32:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should there be a config which disables this feature ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Please no more configs.&lt;/p&gt;</comment>
                            <comment id="14582558" author="eclark" created="Thu, 11 Jun 2015 21:42:49 +0000"  >&lt;p&gt;Thanks for the patch.&lt;/p&gt;</comment>
                            <comment id="14582708" author="hudson" created="Thu, 11 Jun 2015 23:59:27 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.2 #146 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/146/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/146/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13560&quot; title=&quot;Large compaction queue should steal from small compaction queue when idle&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13560&quot;&gt;&lt;del&gt;HBASE-13560&lt;/del&gt;&lt;/a&gt; large compaction thread pool will steal jobs from small compaction pool when idle (eclark: rev abf1aa603cbab69ea5a2cb6628a699899cf2e4ef)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestStealJobQueue.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/util/StealJobQueue.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompaction.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/CompactSplitThread.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14582734" author="hudson" created="Fri, 12 Jun 2015 00:29:52 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6564 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6564/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6564/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13560&quot; title=&quot;Large compaction queue should steal from small compaction queue when idle&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13560&quot;&gt;&lt;del&gt;HBASE-13560&lt;/del&gt;&lt;/a&gt; large compaction thread pool will steal jobs from small compaction pool when idle (eclark: rev 9d3422ed16004da1b0f9a874a98bd140b46b7a6f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/util/StealJobQueue.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompaction.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/CompactSplitThread.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestStealJobQueue.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12738925" name="HBASE-13560.patch" size="16779" author="eclark" created="Wed, 10 Jun 2015 21:36:33 +0000"/>
                            <attachment id="12736178" name="queuestealwork-v1.patch" size="12168" author="changgeng" created="Fri, 29 May 2015 16:41:10 +0000"/>
                            <attachment id="12736197" name="queuestealwork-v4.patch" size="14729" author="changgeng" created="Fri, 29 May 2015 17:51:59 +0000"/>
                            <attachment id="12736198" name="queuestealwork-v5.patch" size="14683" author="changgeng" created="Fri, 29 May 2015 17:53:19 +0000"/>
                            <attachment id="12736199" name="queuestealwork-v6.patch" size="14667" author="changgeng" created="Fri, 29 May 2015 17:59:27 +0000"/>
                            <attachment id="12736362" name="queuestealwork-v7.patch" size="16718" author="changgeng" created="Sat, 30 May 2015 18:42:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 29 May 2015 17:29:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2dr0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>