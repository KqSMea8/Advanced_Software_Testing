<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:13:32 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3834/HBASE-3834.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3834] Store ignores checksum errors when opening files</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3834</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If you corrupt one of the storefiles in a region (eg using vim to muck up some bytes), the region will still open, but that storefile will just be ignored with a log message. We should probably not do this in general - better to keep that region unassigned and force an admin to make a decision to remove the bad storefile.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12505837">HBASE-3834</key>
            <summary>Store ignores checksum errors when opening files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xieliang007">Liang Xie</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Sat, 30 Apr 2011 06:56:11 +0000</created>
                <updated>Wed, 19 Sep 2012 19:49:14 +0000</updated>
                            <resolved>Wed, 19 Sep 2012 19:49:14 +0000</resolved>
                                    <version>0.90.2</version>
                    <version>0.90.3</version>
                    <version>0.90.4</version>
                    <version>0.90.5</version>
                    <version>0.90.6</version>
                                    <fixVersion>0.90.8</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13027336" author="stack" created="Sat, 30 Apr 2011 15:05:58 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13028536" author="jdcryans" created="Wed, 4 May 2011 00:51:37 +0000"  >&lt;p&gt;Do you have time to work on this for 0.90.3 Todd? If not, would it be possible to see the error message that&apos;s being logged and the stack trace?&lt;/p&gt;</comment>
                            <comment id="13028630" author="tlipcon" created="Wed, 4 May 2011 06:17:51 +0000"  >&lt;p&gt;Sorry, not likely I have time to do this (HA taking up my time these days). I don&apos;t have the logs handy, but it&apos;s easy to produce:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Start HBase standalone with default configs (ie rootdir &lt;a href=&quot;file:///tmp/hbase-foo&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:///tmp/hbase-foo&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;Insert some data, flush&lt;/li&gt;
	&lt;li&gt;Shutdown hbase&lt;/li&gt;
	&lt;li&gt;vim /tmp/hbase-foo/path/to/some/hfile. Randomly replace a few characters here and there&lt;/li&gt;
	&lt;li&gt;Start hbase&lt;/li&gt;
	&lt;li&gt;Data gone &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13028859" author="stack" created="Wed, 4 May 2011 17:51:09 +0000"  >&lt;p&gt;I think we should punt on this one.  Its rare.&lt;/p&gt;</comment>
                            <comment id="13028909" author="stack" created="Wed, 4 May 2011 19:30:20 +0000"  >&lt;p&gt;Moving out of 0.90.3.   Arm-wrestle Todd if you want to get it back in.&lt;/p&gt;</comment>
                            <comment id="13064343" author="stack" created="Wed, 13 Jul 2011 04:22:54 +0000"  >&lt;p&gt;Moving out of 0.90.4. Arm-wrestle me Todd if you want to get it back in (Arm-wrestle threat worked for moving it out of 0.90.3).&lt;/p&gt;</comment>
                            <comment id="13064348" author="stack" created="Wed, 13 Jul 2011 04:29:20 +0000"  >&lt;p&gt;Moving into 0.90.5.&lt;/p&gt;

&lt;p&gt;This issue is like &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4078&quot; title=&quot;Silent Data Offlining During HDFS Flakiness&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4078&quot;&gt;&lt;del&gt;HBASE-4078&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13126268" author="yuzhihong@gmail.com" created="Thu, 13 Oct 2011 00:18:26 +0000"  >&lt;p&gt;Moving to 0.92.1 release.&lt;/p&gt;</comment>
                            <comment id="13193628" author="ram_krish" created="Thu, 26 Jan 2012 07:39:32 +0000"  >&lt;p&gt;Moving to 0.90.7&lt;/p&gt;</comment>
                            <comment id="13412353" author="jmhsieh" created="Wed, 11 Jul 2012 23:31:00 +0000"  >&lt;p&gt;No activity, moving to 0.90.8&lt;/p&gt;</comment>
                            <comment id="13412355" author="jmhsieh" created="Wed, 11 Jul 2012 23:31:19 +0000"  >&lt;p&gt;No activity, moving to 0.90.8&lt;/p&gt;</comment>
                            <comment id="13448950" author="lhofhansl" created="Wed, 5 Sep 2012 18:10:23 +0000"  >&lt;p&gt;Should we close this? There appears to be not much interest in it.&lt;/p&gt;</comment>
                            <comment id="13448998" author="tlipcon" created="Wed, 5 Sep 2012 18:52:38 +0000"  >&lt;p&gt;It&apos;s still a somewhat scary bug, if it still exists. It causes data to be silently missing from a table. So I hope someone will take interest in it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13449391" author="xieliang007" created="Thu, 6 Sep 2012 04:03:48 +0000"  >&lt;p&gt;Hi Todd, could you assign it to me please?  it sounds interesting to me somehow&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13449401" author="lhofhansl" created="Thu, 6 Sep 2012 04:19:06 +0000"  >&lt;p&gt;Assigned to Liang by request &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13449406" author="stack" created="Thu, 6 Sep 2012 04:29:32 +0000"  >&lt;p&gt;Lars, you assigned it back to yourself again.  Was that intentional?  I thought you were trying to pass it to Liang?&lt;/p&gt;</comment>
                            <comment id="13449432" author="lhofhansl" created="Thu, 6 Sep 2012 05:32:30 +0000"  >&lt;p&gt;Sorry... Assigned it to me first (by accident), then to Liang.&lt;/p&gt;</comment>
                            <comment id="13455729" author="xieliang007" created="Fri, 14 Sep 2012 11:13:22 +0000"  >&lt;p&gt;Hi all, i ran a manual test today, it turned out this issue should be gone away in latest version, at least for 0.94.0&lt;/p&gt;

&lt;p&gt;Here is my test details:&lt;br/&gt;
0)My env: ubuntu 10.10, hbase-0.94.0 release, standalone mode&lt;br/&gt;
1)start HBase&lt;br/&gt;
2)from hbase shell:&lt;br/&gt;
hbase(main):002:0&amp;gt; status&lt;br/&gt;
1 servers, 0 dead, 2.0000 average load&lt;/p&gt;

&lt;p&gt;hbase(main):003:0&amp;gt; version&lt;br/&gt;
0.94.0, r1332822, Tue May  1 21:43:54 UTC 2012&lt;/p&gt;

&lt;p&gt;hbase(main):004:0&amp;gt; create &apos;test&apos;,&apos;cf&apos;&lt;br/&gt;
0 row(s) in 1.1520 seconds&lt;/p&gt;

&lt;p&gt;hbase(main):005:0&amp;gt; list &apos;test&apos;&lt;br/&gt;
TABLE                                                                                                                                                                                                                                        &lt;br/&gt;
test                                                                                                                                                                                                                                         &lt;br/&gt;
1 row(s) in 0.0230 seconds&lt;/p&gt;

&lt;p&gt;hbase(main):010:0&amp;gt; put &apos;test&apos;,&apos;row1&apos;,&apos;cf:a&apos;,&apos;value1&apos;&lt;br/&gt;
0 row(s) in 0.0160 seconds&lt;/p&gt;

&lt;p&gt;hbase(main):011:0&amp;gt; put &apos;test&apos;,&apos;row2&apos;,&apos;cf:b&apos;,&apos;value2&apos;&lt;br/&gt;
0 row(s) in 0.0070 seconds&lt;/p&gt;

&lt;p&gt;hbase(main):012:0&amp;gt; put &apos;test&apos;,&apos;row3&apos;,&apos;cf:c&apos;,&apos;value3&apos;&lt;br/&gt;
0 row(s) in 0.0070 seconds&lt;/p&gt;

&lt;p&gt;hbase(main):017:0&amp;gt; scan &apos;test&apos;&lt;br/&gt;
ROW                                                          COLUMN+CELL                                                                                                                                                                     &lt;br/&gt;
 row1                                                        column=cf:a, timestamp=1347619555652, value=value1                                                                                                                              &lt;br/&gt;
 row2                                                        column=cf:b, timestamp=1347619562943, value=value2                                                                                                                              &lt;br/&gt;
 row3                                                        column=cf:c, timestamp=1347619576704, value=value3                                                                                                                              &lt;br/&gt;
3 row(s) in 0.0310 seconds&lt;/p&gt;

&lt;p&gt;hbase(main):027:0&amp;gt; flush &apos;test&apos;&lt;br/&gt;
0 row(s) in 0.0770 seconds&lt;/p&gt;

&lt;p&gt;hbase(main):028:0&amp;gt; exit&lt;/p&gt;

&lt;p&gt;3)shutdown hbase,then edit the according files with vim&lt;/p&gt;

&lt;p&gt;4)start hbase again&lt;/p&gt;

&lt;p&gt;5)from log file, we can see:&lt;br/&gt;
2012-09-14 18:54:15,096 INFO org.apache.hadoop.hbase.regionserver.Store: time to purge deletes set to 0ms in store null&lt;br/&gt;
2012-09-14 18:54:15,118 INFO org.apache.hadoop.fs.FSInputChecker: Found checksum error: b&lt;span class=&quot;error&quot;&gt;&amp;#91;0, 286&amp;#93;&lt;/span&gt;=454e010400000012136866696c652e4156475f56414c55455f4c454e0104000000040d6866696c652e4c4153544b455901130004726f77330263666300000139c462db8004a887830f545241424c4b2224000000000000010f00000000000000a600000001000000000000001f0000000000000000000002f600000000000000040000000200000001000000000000000000000000000000006f72672e6170616368652e6861646f6f702e68626173652e4b657956616c7565244b6579436f6d70617261746f7200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000020a&lt;br/&gt;
org.apache.hadoop.fs.ChecksumException: Checksum error: &lt;a href=&quot;file:/tmp/hbase/test/4c9f2cfda63b2e9785815ed2e841d052/cf/269b59832d68465687ebce880026a301&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/tmp/hbase/test/4c9f2cfda63b2e9785815ed2e841d052/cf/269b59832d68465687ebce880026a301&lt;/a&gt; at 512&lt;br/&gt;
        at org.apache.hadoop.fs.FSInputChecker.verifySum(FSInputChecker.java:277)&lt;br/&gt;
        at org.apache.hadoop.fs.FSInputChecker.readChecksumChunk(FSInputChecker.java:241)&lt;br/&gt;
        at org.apache.hadoop.fs.FSInputChecker.fill(FSInputChecker.java:176)&lt;br/&gt;
...&lt;br/&gt;
2012-09-14 18:54:15,123 INFO org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler: Opening of region &lt;/p&gt;
{NAME =&amp;gt; &apos;test,,1347619334483.4c9f2cfda63b2e9785815ed2e841d052.&apos;, STARTKEY =&amp;gt; &apos;&apos;, ENDKEY =&amp;gt; &apos;&apos;, ENCODED =&amp;gt; 4c9f2cfda63b2e9785815ed2e841d052,}
&lt;p&gt; failed, marking as FAILED_OPEN in ZK&lt;br/&gt;
2012-09-14 18:54:15,123 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:48394-0x139c46a10d40001 Attempting to transition node 4c9f2cfda63b2e9785815ed2e841d052 from RS_ZK_REGION_OPENING to RS_ZK_REGION_FAILED_OPEN&lt;br/&gt;
2012-09-14 18:54:15,137 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:48394-0x139c46a10d40001 Successfully transitioned node 4c9f2cfda63b2e9785815ed2e841d052 from RS_ZK_REGION_OPENING to RS_ZK_REGION_FAILED_OPEN&lt;br/&gt;
2012-09-14 18:54:15,138 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=RS_ZK_REGION_FAILED_OPEN, server=xieliang,48394,1347620050131, region=4c9f2cfda63b2e9785815ed2e841d052&lt;br/&gt;
2012-09-14 18:54:15,141 DEBUG org.apache.hadoop.hbase.master.handler.ClosedRegionHandler: Handling CLOSED event for 4c9f2cfda63b2e9785815ed2e841d052&lt;br/&gt;
2012-09-14 18:54:15,141 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Forcing OFFLINE; was=test,,1347619334483.4c9f2cfda63b2e9785815ed2e841d052. state=CLOSED, ts=1347620055124, server=xieliang,48394,1347620050131&lt;br/&gt;
2012-09-14 18:54:15,141 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:41380-0x139c46a10d40000 Creating (or updating) unassigned node for 4c9f2cfda63b2e9785815ed2e841d052 with OFFLINE state&lt;/p&gt;</comment>
                            <comment id="13455731" author="xieliang007" created="Fri, 14 Sep 2012 11:17:25 +0000"  >&lt;p&gt;IMHO, this is up to Todd&apos;s initial expectation.&lt;/p&gt;</comment>
                            <comment id="13456000" author="tlipcon" created="Fri, 14 Sep 2012 18:22:11 +0000"  >&lt;p&gt;Great to see this is fixed in 0.94.&lt;/p&gt;

&lt;p&gt;Does someone have time to try this on the latest 0.90.x, which is still in production a lot of places?&lt;/p&gt;</comment>
                            <comment id="13456262" author="xieliang007" created="Sat, 15 Sep 2012 00:44:43 +0000"  >&lt;p&gt;If nobody have a chance to try, i&apos;ll verify it at 0.90.6 in next monday&lt;/p&gt;</comment>
                            <comment id="13456750" author="xieliang007" created="Mon, 17 Sep 2012 04:18:28 +0000"  >&lt;p&gt;Hi Todd, i tried on 0.90.5&amp;amp;0.90.6, the data was lost silently. But on 0.92.0, the result was just same as the above 0.94.0, so this issue seems exists on 0.90.x(or older) serials only.&lt;/p&gt;</comment>
                            <comment id="13457176" author="tlipcon" created="Mon, 17 Sep 2012 17:34:20 +0000"  >&lt;p&gt;Hi Liang. Thanks so much for testing this out. We really appreciate it!&lt;/p&gt;

&lt;p&gt;So, let&apos;s leave this open to be fixed for an 0.90.x release if we can. Maybe Jon or Ram might be interested in taking it up?&lt;/p&gt;</comment>
                            <comment id="13457184" author="stack" created="Mon, 17 Sep 2012 17:39:40 +0000"  >&lt;p&gt;Thank you Liang for doing the research.&lt;/p&gt;</comment>
                            <comment id="13457648" author="xieliang007" created="Tue, 18 Sep 2012 06:57:57 +0000"  >&lt;p&gt;Hi Todd&amp;amp;Stack, actually, this issue was caused by the CATCH statement in loadStoreFiles().&lt;/p&gt;

&lt;p&gt;After applied the attached patch, i could observe just the same behivor as 0.92&amp;amp;0.94. and i also ensure there&apos;s no CATCH in 0.92&amp;amp;0.94&apos;s loadStoreFiles().&lt;/p&gt;</comment>
                            <comment id="13457650" author="hadoopqa" created="Tue, 18 Sep 2012 07:01:59 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12545531/HBASE-3834.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12545531/HBASE-3834.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2888//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2888//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13459021" author="stack" created="Wed, 19 Sep 2012 19:49:14 +0000"  >&lt;p&gt;Committed to 0.90 branch.  Thanks for digging in Liang.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12513182">HBASE-4078</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12545531" name="HBASE-3834.patch" size="1110" author="xieliang007" created="Tue, 18 Sep 2012 06:57:57 +0000"/>
                            <attachment id="12545134" name="hbase-3834.tar.gz2" size="438821" author="xieliang007" created="Fri, 14 Sep 2012 11:13:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 30 Apr 2011 15:05:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27051</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 13 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ho4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101170</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>