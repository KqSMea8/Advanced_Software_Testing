<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:57:30 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1925/HBASE-1925.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1925] IllegalAccessError: Has not been initialized (getMaxSequenceId)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1925</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   1.
      2009-10-21 08:58:21,003 DEBUG org.apache.hadoop.hbase.master.RegionManager: Doing &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; address: 72.34.249.213:60020, startcode: 1256140228290, load: (requests=0, regions=338, usedHeap=169, maxHeap=3974) nregions: 1 and nRegionsToAssign: 1
   2.
      2009-10-21 08:58:21,003 INFO org.apache.hadoop.hbase.master.RegionManager: Assigning region items,\x00\x00\x00\x00\x12\x96\x40\xC9\x00\x00\x00\x00,1256050226044 to hb3,60020,1256140228290
   3.
      2009-10-21 08:58:21,004 DEBUG org.apache.hadoop.hbase.master.HMaster: Processing todo: RegionAssignmentHistorian from hb3,60020,1256140228290
   4.
      2009-10-21 08:58:24,030 INFO org.apache.hadoop.hbase.master.ServerManager: Processing MSG_REPORT_PROCESS_OPEN: items,\x00\x00\x00\x00\x12\x96\x40\xC9\x00\x00\x00\x00,1256050226044 from hb3,60020,1256140228290; 1 of 1
   5.
      2009-10-21 08:58:27,468 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.rootScanner scanning meta region {server: 72.34.249.218:60020, regionname: -ROOT-,,0, startKey: &amp;lt;&amp;gt;}
   6.
      2009-10-21 08:58:27,470 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.metaScanner scanning meta region {server: 72.34.249.210:60020, regionname: .META.,,1, startKey: &amp;lt;&amp;gt;}
   7.
      2009-10-21 08:58:27,474 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.rootScanner scan of 1 row(s) of meta region {server: 72.34.249.218:60020, regionname: -ROOT-,,0, startKey: &amp;lt;&amp;gt;} complete
   8.
      2009-10-21 08:58:28,777 INFO org.apache.hadoop.hbase.master.BaseScanner: RegionManager.metaScanner scan of 3425 row(s) of meta region {server: 72.34.249.210:60020, regionname: .META.,,1, startKey: &amp;lt;&amp;gt;} complete
   9.
      2009-10-21 08:58:28,777 INFO org.apache.hadoop.hbase.master.BaseScanner: All 1 .META. region(s) scanned
  10.
      2009-10-21 08:58:30,091 INFO org.apache.hadoop.hbase.master.ServerManager: Processing MSG_REPORT_CLOSE: items,\x00\x00\x00\x00\x12\x96\x40\xC9\x00\x00\x00\x00,1256050226044: java.lang.IllegalAccessError: Has not been initialized
  11.
              at org.apache.hadoop.hbase.regionserver.StoreFile.getMaxSequenceId(StoreFile.java:216)
  12.
              at org.apache.hadoop.hbase.regionserver.Store.loadStoreFiles(Store.java:388)
  13.
              at org.apache.hadoop.hbase.regionserver.Store.&amp;lt;init&amp;gt;(Store.java:217)
  14.
              at org.apache.hadoop.hbase.regionserver.HRegion.instantiateHStore(HRegion.java:1507)
  15.
              at org.apache.hadoop.hbase.regionserver.HRegion.initialize(HRegion.java:308)
  16.
              at org.apache.hadoop.hbase.regionserver.HRegionServer.instantiateRegion(HRegionServer.java:1601)
  17.
              at org.apache.hadoop.hbase.regionserver.HRegionServer.openRegion(HRegionServer.java:1570)
  18.
              at org.apache.hadoop.hbase.regionserver.HRegionServer$Worker.run(HRegionServer.java:1485)
  19.
              at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:619)
  20.
       from hb3,60020,1256140228290; 1 of 1
  21.
      2009-10-21 08:58:30,091 DEBUG org.apache.hadoop.hbase.master.HMaster: Processing todo: ProcessRegionClose of items,\x00\x00\x00\x00\x12\x96\x40\xC9\x00\x00\x00\x00,1256050226044, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, reassign: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
  22.
      2009-10-21 08:58:30,091 INFO org.apache.hadoop.hbase.master.RegionServerOperation: region set as unassigned: items,\x00\x00\x00\x00\x12\x96\x40\xC9\x00\x00\x00\x00,1256050226044
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12438720">HBASE-1925</key>
            <summary>IllegalAccessError: Has not been initialized (getMaxSequenceId)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Oct 2009 16:10:13 +0000</created>
                <updated>Fri, 12 Oct 2012 06:13:23 +0000</updated>
                            <resolved>Thu, 22 Oct 2009 16:42:38 +0000</resolved>
                                                    <fixVersion>0.20.2</fixVersion>
                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12768335" author="stack" created="Wed, 21 Oct 2009 17:16:52 +0000"  >&lt;p&gt;Here is code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; getMaxSequenceId() {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.sequenceid == -1) {
      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalAccessError(&lt;span class=&quot;code-quote&quot;&gt;&quot;Has not been initialized&quot;&lt;/span&gt;);
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.sequenceid;
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Up in the open we see:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [] b = map.get(MAX_SEQ_ID_KEY);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (b != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      &lt;span class=&quot;code-comment&quot;&gt;// By convention, &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; halfhfile, top half has a sequence number &amp;gt; bottom
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// half. Thats why we add one in below. Its done &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; the two halves
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// are ever merged back together --rare.  Without it, on open of store,
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// since store files are distingushed by sequence id, the one half would
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// subsume the other.
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.sequenceid = Bytes.toLong(b);
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isReference()) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Reference.isTopFileRegion(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.reference.getFileRegion())) {
          &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.sequenceid += 1;
        }
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can we get a bad storefile?&lt;/p&gt;</comment>
                            <comment id="12768385" author="stack" created="Wed, 21 Oct 2009 19:50:35 +0000"  >&lt;p&gt;Script to open a region.  Reads the  .regioninfo.   Pass it the regiondir.  Needs to be under a directory named for the actual table the region came from.&lt;/p&gt;</comment>
                            <comment id="12768564" author="stack" created="Thu, 22 Oct 2009 04:50:36 +0000"  >&lt;p&gt;So, problem was an exception came up out of HFile.append (from jgray):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
#
2009-10-21 05:35:55,670 FATAL org.apache.hadoop.hbase.regionserver.MemStoreFlusher: Replay of hlog required. Forcing server shutdown
#
org.apache.hadoop.hbase.DroppedSnapshotException: region: items,\x00\x00\x00\x00\x12\x96\x40\xC9\x00\x00\x00\x00,1256050226044
#
        at org.apache.hadoop.hbase.regionserver.HRegion.internalFlushcache(HRegion.java:950)
#
        at org.apache.hadoop.hbase.regionserver.HRegion.flushcache(HRegion.java:843)
#
        at org.apache.hadoop.hbase.regionserver.MemStoreFlusher.flushRegion(MemStoreFlusher.java:241)
#
        at org.apache.hadoop.hbase.regionserver.MemStoreFlusher.run(MemStoreFlusher.java:149)
#
Caused by: java.io.IOException: Key length 125434 &amp;gt; 65536
#
        at org.apache.hadoop.hbase.io.hfile.HFile$Writer.checkKey(HFile.java:511)
#
        at org.apache.hadoop.hbase.io.hfile.HFile$Writer.append(HFile.java:479)
#
        at org.apache.hadoop.hbase.io.hfile.HFile$Writer.append(HFile.java:447)
#
        at org.apache.hadoop.hbase.regionserver.Store.internalFlushCache(Store.java:525)
#
        at org.apache.hadoop.hbase.regionserver.Store.flushCache(Store.java:489)
#
        at org.apache.hadoop.hbase.regionserver.HRegion.internalFlushcache(HRegion.java:935)
#
        ... 3 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The exception tripped the finally clause which did a nice close of the storefile ONLY we wrote it without the sequenceid.&lt;/p&gt;

&lt;p&gt;This patch moves the writing of meta info into the finally block.&lt;/p&gt;

&lt;p&gt;The orignal cause of the issue &amp;#8211; key too long &amp;#8211; has been addressed elsewhere (hbase-1777)&lt;/p&gt;</comment>
                            <comment id="12768751" author="streamy" created="Thu, 22 Oct 2009 16:33:46 +0000"  >&lt;p&gt;Patch looks good stack.  Thanks for the fix!  +1 to commit&lt;/p&gt;</comment>
                            <comment id="12768756" author="stack" created="Thu, 22 Oct 2009 16:42:38 +0000"  >&lt;p&gt;Thanks for review Jon.  Committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12422871" name="1925.patch" size="855" author="stack" created="Thu, 22 Oct 2009 04:50:35 +0000"/>
                            <attachment id="12422841" name="open_region.rb" size="2025" author="stack" created="Wed, 21 Oct 2009 19:50:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 22 Oct 2009 16:33:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26065</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08s67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49164</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>