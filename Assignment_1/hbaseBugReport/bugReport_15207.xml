<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:00:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-15207/HBASE-15207.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-15207] Stuck balancer</title>
                <link>https://issues.apache.org/jira/browse/HBASE-15207</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Balancer seems to have gotten stuck in 1.2.0RC1 soon after Master joins running cluster (previous Master had been killed by chaos monkey). Investigate. At least fix the crazy logging which made me notice the stuck balancer.&lt;/p&gt;

&lt;p&gt;Last night my logs filled with this (10x256MB log files):&lt;/p&gt;

&lt;p&gt;....&lt;br/&gt;
2016-02-01 11:25:26,958 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;B.defaultRpcServer.handler=9,queue=0,port=16000&amp;#93;&lt;/span&gt; balancer.BaseLoadBalancer: Lowest locality region server with non zero regions is ve0542.halxg.cloudera.com with locality 0.0&lt;br/&gt;
2016-02-01 11:25:26,958 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;B.defaultRpcServer.handler=9,queue=0,port=16000&amp;#93;&lt;/span&gt; balancer.BaseLoadBalancer:  Lowest locality region index is 0 and its region server contains 1 regions&lt;br/&gt;
...&lt;/p&gt;


&lt;p&gt;Added by this:&lt;/p&gt;

&lt;p&gt;commit 54028140f4f19a6af81c8c8f29dda0c52491a0c9&lt;br/&gt;
Author: tedyu &amp;lt;yuzhihong@gmail.com&amp;gt;&lt;br/&gt;
Date:   Thu Aug 13 09:11:59 2015 -0700&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13376&quot; title=&quot;Improvements to Stochastic load balancer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13376&quot;&gt;&lt;del&gt;HBASE-13376&lt;/del&gt;&lt;/a&gt; Improvements to Stochastic load balancer (Vandana Ayyalasomayajula)&lt;/p&gt;

&lt;p&gt;Looks like balancer got stuck. Logging at ten lines a millisecond.&lt;/p&gt;

&lt;p&gt;Here is lead up. Nothing in particular jumps out. Rerun doesn&apos;t show this.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2016-01-28 05:56:22,572 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Server ve0526.halxg.cloudera.com had 0 regions.
2016-01-28 05:56:22,572 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Server ve0532.halxg.cloudera.com had 0 regions.
2016-01-28 05:56:22,572 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Server ve0538.halxg.cloudera.com had 0 regions.
2016-01-28 05:56:22,572 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Lowest locality region server with non zero regions is ve0540.halxg.cloudera.com with locality 0.0
2016-01-28 05:56:22,572 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer:  Lowest locality region index is 0 and its region server contains 1 regions
2016-01-28 05:56:22,573 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Server ve0526.halxg.cloudera.com had 0 regions.
2016-01-28 05:56:22,573 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Server ve0532.halxg.cloudera.com had 0 regions.
2016-01-28 05:56:22,573 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Server ve0538.halxg.cloudera.com had 0 regions.
2016-01-28 05:56:22,573 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Lowest locality region server with non zero regions is ve0540.halxg.cloudera.com with locality 0.0
2016-01-28 05:56:22,573 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer:  Lowest locality region index is 0 and its region server contains 1 regions
2016-01-28 05:56:22,573 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Server ve0526.halxg.cloudera.com had 0 regions.
2016-01-28 05:56:22,573 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Server ve0532.halxg.cloudera.com had 0 regions.
2016-01-28 05:56:22,573 DEBUG [ve0524.halxg.cloudera.com,16000,1453988766013_ChoreService_1] balancer.BaseLoadBalancer: Server ve0538.halxg.cloudera.com had 0 regions.
....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nothing else is happening on this master&lt;/p&gt;

&lt;p&gt;Happens just after a Master joins cluster after being killed by a monkey.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12936072">HBASE-15207</key>
            <summary>Stuck balancer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Feb 2016 19:36:52 +0000</created>
                <updated>Fri, 5 Feb 2016 22:38:47 +0000</updated>
                            <resolved>Fri, 5 Feb 2016 22:38:47 +0000</resolved>
                                    <version>1.2.0</version>
                                                    <component>Balancer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                            <comments>
                            <comment id="15128889" author="enis" created="Tue, 2 Feb 2016 19:49:06 +0000"  >&lt;p&gt;Seems like a blocker if balancer got stuck. &lt;/p&gt;</comment>
                            <comment id="15129390" author="busbey" created="Wed, 3 Feb 2016 00:01:47 +0000"  >&lt;p&gt;is this ticket for the balancer getting stuck, or for the logging rate when it is stuck?&lt;/p&gt;</comment>
                            <comment id="15129420" author="stack" created="Wed, 3 Feb 2016 00:14:26 +0000"  >&lt;p&gt;Fixed summary and description. It is about the stuck balancer. Should also fix the crazy logging. Can do that in subtask. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15129423" author="busbey" created="Wed, 3 Feb 2016 00:16:07 +0000"  >&lt;p&gt;I&apos;d say blocker status will depend on if we can determine if the root cause is new in 1.2&lt;/p&gt;</comment>
                            <comment id="15129933" author="stack" created="Wed, 3 Feb 2016 07:09:37 +0000"  >&lt;p&gt;Happened again in new loading. Its hard to make sense of because the logging overwhelms. Let me address that in a patch first. Can then look at hang. In this current case we filled 10 log files of 256MB each... but it looks like we &apos;recovered&apos;. LB reports:&lt;/p&gt;

&lt;p&gt;2016-02-02 17:15:05,123 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ve0524.halxg.cloudera.com,16000,1454461776827_ChoreService_1&amp;#93;&lt;/span&gt; balancer.StochasticLoadBalancer: Finished computing new load balance plan.  Computation took 3761ms to try 217600 different iterations.  Found a solution that moves 31 regions; Going from a computed cost of 341.5035724035313 to a new cost of 47.8518130393211&lt;/p&gt;

&lt;p&gt;And going back over logs, yeah, I get sessions of log spewing.... maybe the load balancer is ok... its just this crazy logging phenomenon&lt;/p&gt;

</comment>
                            <comment id="15135179" author="stack" created="Fri, 5 Feb 2016 22:38:47 +0000"  >&lt;p&gt;Resolving as cannot reproduce. I think balancer is fine, not stuck. It just looked that way because of the log spew caused by the subtask.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12936261">HBASE-15210</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 2 Feb 2016 19:49:06 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            44 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sb8f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>