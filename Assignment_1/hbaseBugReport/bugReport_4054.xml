<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:15:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4054/HBASE-4054.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4054] Usability improvement to HTablePool</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4054</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;To improve the usability of the HTablePool the implementation should not rely on the user returning the connection to the pool but rather do that transparently when user closes the HTableImplementation it got.&lt;/p&gt;

&lt;p&gt;To do that a HTableImplementation proxy implementation should be returned that wraps a HTable object and holds a reference to the pool. When the client close the proxy it will actually automatically return the wrapped HTable back in pool to be reused. In this case the method HTablePool.putTable don&apos;t need to be public&lt;/p&gt;</description>
                <environment></environment>
        <key id="12512478">HBASE-4054</key>
            <summary>Usability improvement to HTablePool</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="diancu">Daniel Iancu</assignee>
                                    <reporter username="diancu">Daniel Iancu</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Jul 2011 15:28:32 +0000</created>
                <updated>Fri, 20 Nov 2015 11:52:53 +0000</updated>
                            <resolved>Tue, 12 Jul 2011 17:05:28 +0000</resolved>
                                    <version>0.90.3</version>
                                    <fixVersion>0.92.0</fixVersion>
                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13058620" author="yuzhihong@gmail.com" created="Fri, 1 Jul 2011 16:20:28 +0000"  >&lt;p&gt;The way PooledHTable.close() is implemented would pose challenge to HTablePool&apos;s management of the size of its tables map, namely when maxSize is not Integer.MAX_VALUE.&lt;br/&gt;
Take a look at the following in HTablePool.putTable():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(tables.size(tableName) &amp;gt;= maxSize) {
      &lt;span class=&quot;code-comment&quot;&gt;// release table instance since we&apos;re not reusing it
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.tableFactory.releaseHTableInterface(table);
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In HTableFactory:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void releaseHTableInterface(HTableInterface table) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    table.close();
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So the intention of cleaning HTable instance ends up putting the instance back to the pool.&lt;/p&gt;

&lt;p&gt;Looks like you need to implement your own HTableInterfaceFactory which would call realClose(), a method to be added to PooledHTable, to really close the instance for the above scenario.&lt;/p&gt;</comment>
                            <comment id="13058636" author="diancu" created="Fri, 1 Jul 2011 16:39:41 +0000"  >&lt;p&gt;I think HTablePool.putTable should be made private and called only from PooledHTable.close. This way you are sure that nobody puts back a HTableImplementation other then then HTable.&lt;/p&gt;

&lt;p&gt;HTablePool usage should be mainly &lt;br/&gt;
{{  &lt;br/&gt;
   table = HTablePool.getTable();&lt;/p&gt;

&lt;p&gt;   //use table&lt;/p&gt;

&lt;p&gt;   table.close(); &lt;br/&gt;
}}&lt;/p&gt;</comment>
                            <comment id="13058638" author="diancu" created="Fri, 1 Jul 2011 16:42:04 +0000"  >&lt;p&gt;correction: This way you are sure that nobody puts back a HTableImplementation other then the one it got from pool&lt;/p&gt;</comment>
                            <comment id="13058643" author="yuzhihong@gmail.com" created="Fri, 1 Jul 2011 16:48:02 +0000"  >&lt;p&gt;Please document the above pattern in your patch.&lt;br/&gt;
It would be difficult to change the way HTablePool operates now.&lt;/p&gt;</comment>
                            <comment id="13058817" author="stack" created="Fri, 1 Jul 2011 21:28:08 +0000"  >&lt;p&gt;@Daniel Can we not push your improvement back into HTablePool rather than make a new class?  The getTable returns an HTableInterface.  Can&apos;t we change it so it gives out your pool+table carrying class instead?  We could add deprecated to putTable with a note that its going private?&lt;/p&gt;</comment>
                            <comment id="13059420" author="diancu" created="Mon, 4 Jul 2011 12:58:52 +0000"  >&lt;p&gt;@Stack, I&apos;ve created a new patch where changes are pushed into HTablePool. I&apos;ve updated the unit test and added some more tests&lt;/p&gt;

&lt;p&gt;@Ted putTable now checks the returned table to be a valid table. tableFactory.releaseHTableInterface(table) will never return the table in pool. I&apos;ve added more comments in the code to describe better how it works&lt;/p&gt;

&lt;p&gt;If any changes are required just let me know&lt;/p&gt;</comment>
                            <comment id="13059447" author="yuzhihong@gmail.com" created="Mon, 4 Jul 2011 14:03:09 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3678&quot; title=&quot;Add Eclipse-based Apache Formatter to HBase Wiki&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3678&quot;&gt;&lt;del&gt;HBASE-3678&lt;/del&gt;&lt;/a&gt; for Eclipse-based Apache Formatter that uses 2 spaces for tab.&lt;br/&gt;
Patch version 2 shows more changes than it should contain.&lt;/p&gt;

&lt;p&gt;Please indicate the line number where your comment w.r.t. tableFactory.releaseHTableInterface() is located.&lt;/p&gt;</comment>
                            <comment id="13059463" author="diancu" created="Mon, 4 Jul 2011 14:51:13 +0000"  >&lt;p&gt;source files formatted with Apache eclipse formatter &lt;/p&gt;</comment>
                            <comment id="13059465" author="diancu" created="Mon, 4 Jul 2011 14:54:24 +0000"  >&lt;p&gt;the putTable method was renamed to returnTable. line is 195. the actual putTable checks it the table passed is a table from pool then delegates to returnTable (line 168) &lt;/p&gt;</comment>
                            <comment id="13059472" author="yuzhihong@gmail.com" created="Mon, 4 Jul 2011 15:08:02 +0000"  >&lt;p&gt;Can you provide a patch that is based off TRUNK ?&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;patching file src/main/java/org/apache/hadoop/hbase/client/HTablePool.java
Hunk #1 FAILED at 19.
Hunk #2 succeeded at 65 with fuzz 1 (offset 1 line).
Hunk #3 FAILED at 79.
Hunk #4 FAILED at 201.
Hunk #5 FAILED at 229.
4 out of 5 hunks FAILED -- saving rejects to file src/main/java/org/apache/hadoop/hbase/client/HTablePool.java.rej
patching file src/test/java/org/apache/hadoop/hbase/client/TestHTablePool.java
Reversed (or previously applied) patch detected!  Assume -R? [n] 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13059476" author="yuzhihong@gmail.com" created="Mon, 4 Jul 2011 15:18:45 +0000"  >&lt;p&gt;@Daniel:&lt;br/&gt;
The comment below is not true considering that it is called by putTable() as well:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    /**
+     * Expose the wrapped HTable only &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; testing purposes
+     *
+     * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; wrapped htable
+     */
+    HTableInterface getWrappedTable() {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13059488" author="diancu" created="Mon, 4 Jul 2011 15:45:33 +0000"  >&lt;p&gt;I meant the wrapped table is not exposed outside package, rather it is used internally or for testing purposes. The putTable can access the wrapped htable even if the method is private but not the tests.&lt;/p&gt;</comment>
                            <comment id="13059493" author="diancu" created="Mon, 4 Jul 2011 15:59:02 +0000"  >&lt;p&gt;Is the patch based on trunk still required ? I saw the trunk version having coprocessors methods introduced so I didn&apos;t know if I can patch it but I can try again.&lt;/p&gt;</comment>
                            <comment id="13059512" author="yuzhihong@gmail.com" created="Mon, 4 Jul 2011 16:39:58 +0000"  >&lt;p&gt;How about the following comment ?&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+    /**
+     * Expose the wrapped HTable to tests in the same package
+     *
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This JIRA is marked Improvement which would only go to TRUNK.&lt;/p&gt;</comment>
                            <comment id="13059705" author="diancu" created="Tue, 5 Jul 2011 07:24:49 +0000"  >&lt;p&gt;@Ted comment is fine. I&apos;m gonna take a look at the trunk version to see how can I patch it&lt;/p&gt;</comment>
                            <comment id="13060670" author="diancu" created="Wed, 6 Jul 2011 16:28:02 +0000"  >&lt;p&gt;@Ted I&apos;ve patched the trunk version also, please have a look&lt;/p&gt;</comment>
                            <comment id="13061617" author="stack" created="Thu, 7 Jul 2011 21:48:05 +0000"  >&lt;p&gt;Patch looks great.  I think this new form better than previous where we added a new class.  I&apos;ll fix the usage doc (talks about put to return the table to the pool... when you want them to call close instead) and then commit.&lt;/p&gt;

&lt;p&gt;For the future Daniel, bulk of your patch are gratuitous changes of the type below:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-   * Get a reference to the specified table from the pool.&amp;lt;p&amp;gt;
-   *
-   * Create a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; one &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; one is not available.
-   * @param tableName table name
+   * Get a reference to the specified table from the pool.
+   * &amp;lt;p&amp;gt;
+   * &amp;lt;p/&amp;gt;
+   * 
+   * @param tableName
+   *          table name
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;i.e. no change of substance, just change in formatting.  Leave these out of your patches going forward I&apos;d say.&lt;/p&gt;
</comment>
                            <comment id="13061668" author="hudson" created="Thu, 7 Jul 2011 23:27:58 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2011 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2011/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2011/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4054&quot; title=&quot;Usability improvement to HTablePool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4054&quot;&gt;&lt;del&gt;HBASE-4054&lt;/del&gt;&lt;/a&gt; Usability improvement to HTablePool&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/HTablePool.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/client/TestHTablePool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13061756" author="yuzhihong@gmail.com" created="Fri, 8 Jul 2011 04:25:13 +0000"  >&lt;p&gt;There were tests broken by this JIRA.&lt;br/&gt;
For TestRemoteTable:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Jul 7, 2011 11:06:01 PM com.sun.jersey.spi.container.ContainerResponse mapMappableContainerException
SEVERE: The RuntimeException could not be mapped to a response, re-throwing to the HTTP container

java.lang.ClassCastException: org.apache.hadoop.hbase.client.HTablePool$PooledHTable cannot be cast to org.apache.hadoop.hbase.client.HTable
	at org.apache.hadoop.hbase.rest.RowResource.update(RowResource.java:162)
	at org.apache.hadoop.hbase.rest.RowResource.put(RowResource.java:289)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And TestTableResource.testTableInfoText():&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    2011-07-07 17:58:45,139 ERROR [318977678@qtp-1052953772-1] log.Slf4jLog(87): /TestTableResource/regions
    java.lang.ClassCastException: org.apache.hadoop.hbase.client.HTablePool$PooledHTable cannot be cast to org.apache.hadoop.hbase.client.HTable
        at org.apache.hadoop.hbase.rest.RegionsResource.getTableRegions(RegionsResource.java:75)
        at org.apache.hadoop.hbase.rest.RegionsResource.get(RegionsResource.java:91)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The attached addendum fixes the above two tests.&lt;/p&gt;</comment>
                            <comment id="13061771" author="stack" created="Fri, 8 Jul 2011 05:19:42 +0000"  >&lt;p&gt;I&apos;ve been working this too.  I have a different fix, one that does not change PooledHTable such that it extends HTable.  Let me upload it to see what you think Ted.&lt;/p&gt;</comment>
                            <comment id="13061774" author="stack" created="Fri, 8 Jul 2011 05:29:16 +0000"  >&lt;p&gt;+1 on your patch Ted (I cannot solve the getRegionInfos failures going my route).  On commit, please add commentary that extending HTable is a hack until we fix HTableInterface to include getRegionInfos (or its equiv since this is now deprecated) and setAutoFlush.&lt;/p&gt;</comment>
                            <comment id="13061776" author="yuzhihong@gmail.com" created="Fri, 8 Jul 2011 05:44:35 +0000"  >&lt;p&gt;Integrated addendum to TRUNK.&lt;/p&gt;

&lt;p&gt;Thanks for the review Stack.&lt;/p&gt;</comment>
                            <comment id="13061797" author="hudson" created="Fri, 8 Jul 2011 06:44:36 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2014 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2014/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2014/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4054&quot; title=&quot;Usability improvement to HTablePool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4054&quot;&gt;&lt;del&gt;HBASE-4054&lt;/del&gt;&lt;/a&gt; extending HTable because HTableInterface does not include&lt;br/&gt;
           getRegionInfos and setAutoFlush&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/HTablePool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13061937" author="diancu" created="Fri, 8 Jul 2011 12:54:22 +0000"  >&lt;p&gt;@Stack sorry for the gratuitous changes, I&apos;ve seen them but I didn&apos;t know how to get rid of them. I set up my  Eclipse as explained in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3678&quot; title=&quot;Add Eclipse-based Apache Formatter to HBase Wiki&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3678&quot;&gt;&lt;del&gt;HBASE-3678&lt;/del&gt;&lt;/a&gt; but still they got through. I&apos;ll do better checks next time.&lt;/p&gt;</comment>
                            <comment id="13062005" author="stack" created="Fri, 8 Jul 2011 15:14:26 +0000"  >&lt;p&gt;No worries Daniel.&lt;/p&gt;</comment>
                            <comment id="13063262" author="diancu" created="Mon, 11 Jul 2011 10:15:34 +0000"  >&lt;p&gt;Included test to check for ClassCastException on returned table &lt;/p&gt;</comment>
                            <comment id="13063723" author="stack" created="Tue, 12 Jul 2011 05:26:29 +0000"  >&lt;p&gt;Your test passes for you Daniel?  Its hanging for me.&lt;/p&gt;</comment>
                            <comment id="13063724" author="stack" created="Tue, 12 Jul 2011 05:26:38 +0000"  >&lt;p&gt;Oh, I tried it on TRUNK.&lt;/p&gt;</comment>
                            <comment id="13063726" author="stack" created="Tue, 12 Jul 2011 05:31:53 +0000"  >&lt;p&gt;umm... it completed finally but testReturnDifferentTable failed with this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-------------------------------------------------------------------------------
Test set: org.apache.hadoop.hbase.client.TestHTablePool
-------------------------------------------------------------------------------
Tests run: 18, Failures: 0, Errors: 2, Skipped: 0, Time elapsed: 457.077 sec &amp;lt;&amp;lt;&amp;lt; FAILURE!
testReturnDifferentTable(org.apache.hadoop.hbase.client.TestHTablePool$TestHTableReusablePool)  Time elapsed: 93.551 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
org.apache.hadoop.hbase.client.RetriesExhaustedException: Failed setting up proxy &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; org.apache.hadoop.hbase.ipc.HRegionInterface to /192.168.1.8:60222 after attempts=1
        at org.apache.hadoop.hbase.ipc.HBaseRPC.waitForProxy(HBaseRPC.java:234)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getHRegionConnection(HConnectionManager.java:1164)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getHRegionConnection(HConnectionManager.java:1126)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getHRegionConnection(HConnectionManager.java:1113)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegionInMeta(HConnectionManager.java:845)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:741)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.relocateRegion(HConnectionManager.java:715)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegionInMeta(HConnectionManager.java:950)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:745)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:709)
        at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:189)
        at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:145)
        at org.apache.hadoop.hbase.client.TestHTablePool$TestHTablePoolType$1.&amp;lt;init&amp;gt;(TestHTablePool.java:165)
        at org.apache.hadoop.hbase.client.TestHTablePool$TestHTablePoolType.testReturnDifferentTable(TestHTablePool.java:165)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at junit.framework.TestCase.runTest(TestCase.java:168)
        at junit.framework.TestCase.runBare(TestCase.java:134)
        at junit.framework.TestResult$1.protect(TestResult.java:110)
        at junit.framework.TestResult.runProtected(TestResult.java:128)
        at junit.framework.TestResult.run(TestResult.java:113)
        at junit.framework.TestCase.run(TestCase.java:124)
        at junit.framework.TestSuite.runTest(TestSuite.java:243)
        at junit.framework.TestSuite.run(TestSuite.java:238)
        at junit.framework.TestSuite.runTest(TestSuite.java:243)
        at junit.framework.TestSuite.run(TestSuite.java:238)
        at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:83)
        at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:62)
        at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.executeTestSet(AbstractDirectoryTestSuite.java:140)
        at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.execute(AbstractDirectoryTestSuite.java:165)
        at org.apache.maven.surefire.Surefire.run(Surefire.java:107)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.maven.surefire.booter.SurefireBooter.runSuitesInProcess(SurefireBooter.java:289)
        at org.apache.maven.surefire.booter.SurefireBooter.main(SurefireBooter.java:1005)
Caused by: java.net.ConnectException: Connection refused
        at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
        at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:567)
        at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
        at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:404)
        at org.apache.hadoop.hbase.ipc.HBaseClient$Connection.setupIOstreams(HBaseClient.java:343)
        at org.apache.hadoop.hbase.ipc.HBaseClient.getConnection(HBaseClient.java:976)
        at org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:828)
        at org.apache.hadoop.hbase.ipc.WritableRpcEngine$Invoker.invoke(WritableRpcEngine.java:141)
        at $Proxy10.getProtocolVersion(Unknown Source)
        at org.apache.hadoop.hbase.ipc.WritableRpcEngine.getProxy(WritableRpcEngine.java:174)
        at org.apache.hadoop.hbase.ipc.HBaseRPC.getProxy(HBaseRPC.java:295)
        at org.apache.hadoop.hbase.ipc.HBaseRPC.getProxy(HBaseRPC.java:272)
        at org.apache.hadoop.hbase.ipc.HBaseRPC.getProxy(HBaseRPC.java:324)
        at org.apache.hadoop.hbase.ipc.HBaseRPC.waitForProxy(HBaseRPC.java:228)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13063777" author="diancu" created="Tue, 12 Jul 2011 08:58:25 +0000"  >&lt;p&gt;yes, I run them again this morning with the latest updates from svn and they all have passed. That test is not different from the others so I suspect an issue with the minicluster?  &lt;/p&gt;</comment>
                            <comment id="13064004" author="stack" created="Tue, 12 Jul 2011 17:05:28 +0000"  >&lt;p&gt;Committed the test to TRUNK (I tried it in a few different locations and it passed).  Thanks for the patch Daniel.&lt;/p&gt;</comment>
                            <comment id="13064058" author="hudson" created="Tue, 12 Jul 2011 18:23:15 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2020 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2020/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2020/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4054&quot; title=&quot;Usability improvement to HTablePool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4054&quot;&gt;&lt;del&gt;HBASE-4054&lt;/del&gt;&lt;/a&gt; Usability improvement to HTablePool&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/client/TestHTablePool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13436160" author="hudson" created="Thu, 16 Aug 2012 17:58:07 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #399 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/399/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/399/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6471&quot; title=&quot;Performance regression caused by HBASE-4054&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6471&quot;&gt;&lt;del&gt;HBASE-6471&lt;/del&gt;&lt;/a&gt; Performance regression caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4054&quot; title=&quot;Usability improvement to HTablePool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4054&quot;&gt;&lt;del&gt;HBASE-4054&lt;/del&gt;&lt;/a&gt; (Revision 1373916)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jxiang : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/HTablePool.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/rest/RegionsResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/client/TestHTablePool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13436436" author="hudson" created="Thu, 16 Aug 2012 23:53:59 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #132 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/132/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/132/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6471&quot; title=&quot;Performance regression caused by HBASE-4054&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6471&quot;&gt;&lt;del&gt;HBASE-6471&lt;/del&gt;&lt;/a&gt; Performance regression caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4054&quot; title=&quot;Usability improvement to HTablePool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4054&quot;&gt;&lt;del&gt;HBASE-4054&lt;/del&gt;&lt;/a&gt; (Revision 1373917)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jxiang : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/client/HTablePool.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/rest/RegionsResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/client/TestHTablePool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13439512" author="hudson" created="Wed, 22 Aug 2012 13:48:09 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #48 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/48/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/48/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6471&quot; title=&quot;Performance regression caused by HBASE-4054&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6471&quot;&gt;&lt;del&gt;HBASE-6471&lt;/del&gt;&lt;/a&gt; Performance regression caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4054&quot; title=&quot;Usability improvement to HTablePool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4054&quot;&gt;&lt;del&gt;HBASE-4054&lt;/del&gt;&lt;/a&gt; (Revision 1373916)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jxiang : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/HTablePool.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/rest/RegionsResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/client/TestHTablePool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13448334" author="hudson" created="Wed, 5 Sep 2012 00:57:16 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #7 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/7/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/7/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6471&quot; title=&quot;Performance regression caused by HBASE-4054&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6471&quot;&gt;&lt;del&gt;HBASE-6471&lt;/del&gt;&lt;/a&gt; Performance regression caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4054&quot; title=&quot;Usability improvement to HTablePool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4054&quot;&gt;&lt;del&gt;HBASE-4054&lt;/del&gt;&lt;/a&gt; (Revision 1373916)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jxiang : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/client/HTablePool.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/rest/RegionsResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/client/TestHTablePool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15015855" author="lars_francke" created="Fri, 20 Nov 2015 11:52:53 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12549744">HBASE-5728</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12485687" name="4054.addendum" size="1134" author="yuzhihong@gmail.com" created="Fri, 8 Jul 2011 04:28:07 +0000"/>
                            <attachment id="12485443" name="HBASE-4054_Usability_improvement_to_HTablePool-trunk.patch" size="32790" author="diancu" created="Wed, 6 Jul 2011 16:28:01 +0000"/>
                            <attachment id="12485154" name="HBASE-4054_Usability_improvement_to_HTablePool.patch" size="22591" author="diancu" created="Mon, 4 Jul 2011 14:51:12 +0000"/>
                            <attachment id="12486043" name="TestHTablePool-trunk.patch" size="5586" author="diancu" created="Mon, 11 Jul 2011 10:33:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 1 Jul 2011 16:20:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hp73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>