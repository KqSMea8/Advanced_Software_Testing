<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:00:07 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2232/HBASE-2232.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2232] Can not create insert more than  half million rows</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2232</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The following code, which attempts to insert certain number of rows into a table. &lt;br/&gt;
This is running with hbase 0.20.3 after downloading without changing config.&lt;br/&gt;
Does not work if there is more than 500K or so rows .&lt;br/&gt;
I can see data being created in $HBASE_HOME/TestTable/xxxx/test_family where xxxx is a number. &lt;br/&gt;
But the data disappear once it get 3  files of size around 16MB.&lt;br/&gt;
I guess it is being compacted or moved to somewhere ? But I see nothing in $HBASE_HOME/TestTable/compaction.dir.&lt;/p&gt;

&lt;p&gt;To create 2Million rows , run it as  java  Test 2000&lt;br/&gt;
To create 10 Millions rows, run it as java Test 10000&lt;/p&gt;


&lt;p&gt;import java.io.*;&lt;br/&gt;
import java.util.*;&lt;br/&gt;
import org.apache.hadoop.hbase.*;&lt;br/&gt;
import org.apache.hadoop.hbase.io.BatchUpdate;&lt;br/&gt;
import org.apache.hadoop.hbase.client.Get;&lt;br/&gt;
import org.apache.hadoop.hbase.client.HBaseAdmin;&lt;br/&gt;
import org.apache.hadoop.hbase.client.HTable;&lt;br/&gt;
import org.apache.hadoop.hbase.client.Put;&lt;br/&gt;
import org.apache.hadoop.hbase.client.Result;&lt;br/&gt;
import org.apache.hadoop.hbase.client.ResultScanner;&lt;br/&gt;
import org.apache.hadoop.hbase.client.Scan;&lt;br/&gt;
import org.apache.hadoop.hbase.util.Bytes;&lt;/p&gt;

&lt;p&gt;public class Test{&lt;/p&gt;

&lt;p&gt;    public static HTable getTable(HBaseConfiguration config, String tableName, String[] columnFamilies)throws IOException&lt;/p&gt;
{
	HBaseAdmin admin  = new HBaseAdmin(config);	
	createTable(admin, tableName, columnFamilies);
	HTable table =  new HTable(config, tableName);	
	table.setAutoFlush(false);
	table.setWriteBufferSize(1024*1024*12);
	return table;
    }

&lt;p&gt;    public static boolean createTable(HBaseAdmin admin, String tableName, String[] columnFamilies)throws IOException{&lt;br/&gt;
	if(admin.tableExists(tableName))return false;&lt;br/&gt;
	HTableDescriptor desc  = new HTableDescriptor(tableName);&lt;br/&gt;
	for(String s : columnFamilies)&lt;/p&gt;
{
	    HColumnDescriptor col = new HColumnDescriptor(s.getBytes());
	    col.setMaxVersions(1);
	    desc.addFamily(col);
	}
&lt;p&gt;	admin.createTable(desc);&lt;br/&gt;
	return true;&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;    public static void test_serial_insert(HTable table, String family, int count)throws IOException{ &lt;br/&gt;
	byte[] bf = Bytes.toBytes(family);&lt;br/&gt;
	for(int i = 0; i &amp;lt; count; i++){&lt;br/&gt;
	    int  id          = i;&lt;br/&gt;
	    byte[] qualifier = Bytes.toBytes&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;; // &quot;i&quot;&lt;br/&gt;
	    byte[] key       = Bytes.toBytes&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;br/&gt;
	    byte[] val       = Bytes.toBytes&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;br/&gt;
	    Put put = new Put(key);&lt;br/&gt;
	    put.setWriteToWAL(false); &lt;br/&gt;
	    put.add(bf, qualifier, 0, val); &lt;br/&gt;
	    table.put(put);&lt;br/&gt;
	    if( (i+1) % 1000000 == 0)&lt;/p&gt;
{System.out.println( (i+1)/1000000 +  &quot;  M&quot;); }
&lt;p&gt;	}&lt;br/&gt;
	table.flushCommits();&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;    public static void count(HTable table)throws IOException{&lt;br/&gt;
	Scan scan = new Scan();&lt;br/&gt;
	ResultScanner scanner = table.getScanner(scan);       &lt;br/&gt;
	Result result = null;&lt;br/&gt;
	int i = 0;&lt;br/&gt;
	while( (result = scanner.next()) != null  )&lt;/p&gt;
{
	    byte[] key  = result.getRow();
	    ++i;
	    if(i % 10000 == 0)System.out.println(i);
	}
&lt;p&gt;	System.out.println(&quot;TOTAL========== &quot;+i);&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;    public static void removeTable(HBaseAdmin admin, String tableName)throws IOException&lt;/p&gt;
{
	if(!admin.tableExists(tableName))return;
	admin.disableTable(tableName);
	admin.deleteTable(tableName);
    }

&lt;p&gt;    public static void main(String[] args)throws Exception{&lt;br/&gt;
	int k = 1000;&lt;br/&gt;
	boolean insert = true;&lt;br/&gt;
	if(args.length &amp;gt; 0)&lt;/p&gt;
{
	    if(&quot;read&quot;.equals(args[0]))insert = false;
	    else k = Integer.parseInt(args[0]);
	}

&lt;p&gt;	HBaseConfiguration config = new HBaseConfiguration();&lt;br/&gt;
	String tableName = &quot;TestTable&quot;;&lt;br/&gt;
	String familyName = &quot;test_family&quot;;&lt;br/&gt;
	HBaseAdmin admin  = new HBaseAdmin(config);&lt;br/&gt;
	removeTable(admin, tableName);&lt;br/&gt;
	HTable table = getTable(config, tableName, new String[]&lt;/p&gt;
{familyName}
&lt;p&gt;);&lt;br/&gt;
	if(insert)test_serial_insert(table, familyName, k*1000);&lt;br/&gt;
	count(table);&lt;br/&gt;
    }&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux&lt;/p&gt;</environment>
        <key id="12456524">HBASE-2232</key>
            <summary>Can not create insert more than  half million rows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mingkeming">mingkeming</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Feb 2010 10:21:19 +0000</created>
                <updated>Fri, 20 Nov 2015 12:40:58 +0000</updated>
                            <resolved>Tue, 23 Feb 2010 08:07:55 +0000</resolved>
                                    <version>0.20.3</version>
                                    <fixVersion>0.90.0</fixVersion>
                                    <component>Client</component>
                    <component>io</component>
                    <component>master</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12834912" author="larsgeorge" created="Wed, 17 Feb 2010 18:26:09 +0000"  >&lt;p&gt;Hey, are you saying that you did this on a local install, i.e. running all on one machine, not on a cluster? If so than there is no wonder it does not work, as local is for prototyping only. Please give us a few more details on your setup.&lt;/p&gt;</comment>
                            <comment id="12837131" author="mingkeming" created="Tue, 23 Feb 2010 08:03:50 +0000"  >&lt;p&gt;Hi, Lars,&lt;br/&gt;
Thanks for the comment. &lt;br/&gt;
I have downloaded the latest from SVN and it now seems to work ok.&lt;br/&gt;
Why should hbase NOT work on local machine ?  That seems to be a bug  to me. &lt;br/&gt;
I am trying to use  hbase on a single machine, basically using it as a giant hashmap. &lt;br/&gt;
Isn&apos;t that hbase intended for, ie, a hashmap? Why should I have at least 2 machines to be able to use it ?  Is there any reason why it is OK for hbase to fail when used on 1 machine ? &lt;/p&gt;

&lt;p&gt;Thanks &lt;/p&gt;</comment>
                            <comment id="12837134" author="mingkeming" created="Tue, 23 Feb 2010 08:07:55 +0000"  >&lt;p&gt;Can not reproduce the problem in the the latest SVN version.&lt;/p&gt;</comment>
                            <comment id="15016847" author="lars_francke" created="Fri, 20 Nov 2015 12:40:58 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 17 Feb 2010 18:26:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26215</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hgv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99994</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>