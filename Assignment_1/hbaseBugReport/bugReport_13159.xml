<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:40:21 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13159/HBASE-13159.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13159] Consider RangeReferenceFiles with transformations</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13159</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Currently we have References used by HalfStoreReaders and HFileLinks.&lt;br/&gt;
For various use cases we have here we have need for a RangeReferences with simple transformation of the keys.&lt;br/&gt;
That would allow us to map HFiles between regions or even tables without copying any data.&lt;/p&gt;

&lt;p&gt;We can probably combine HalfStores, HFileLinks, and RangeReferences into a single concept:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;RangeReference = arbitrary start and stop row, arbitrary key transformation&lt;/li&gt;
	&lt;li&gt;HFileLink = start and stop keys set to the linked file&apos;s start/stop key, transformation = identity&lt;/li&gt;
	&lt;li&gt;(HalfStore) References = start/stop key set according to top or bottom reference, transformation = identity&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Note this is a &lt;b&gt;brainstorming&lt;/b&gt; issue. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
(Could start with just references with arbitrary start/stop keys, and do transformations later)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12779883">HBASE-13159</key>
            <summary>Consider RangeReferenceFiles with transformations</summary>
                <type id="13" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/genericissue.png">Brainstorming</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="lhofhansl">Lars Hofhansl</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Mar 2015 20:29:00 +0000</created>
                <updated>Wed, 15 Jul 2015 17:04:57 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                <comments>
                            <comment id="14349459" author="vrodionov" created="Thu, 5 Mar 2015 21:07:51 +0000"  >&lt;p&gt;What is the purpose of sharing one HFile between different regions? The file will be split during next major compaction anyway and this should happen immediately after region&apos;s split.&lt;/p&gt;</comment>
                            <comment id="14349470" author="vrodionov" created="Thu, 5 Mar 2015 21:12:42 +0000"  >&lt;p&gt;Transformation idea is interesting. I did suggest something similar while ago (do not remember JIRA) to support bulk delete and update efficiently , but on table/cf level - not a hfile level. If this is what I think you are talking about, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14349519" author="lhofhansl" created="Thu, 5 Mar 2015 22:01:17 +0000"  >&lt;p&gt;In our case we&apos;d want to share &lt;b&gt;initial&lt;/b&gt; data between tenants. The next compaction (if the other tenant changes data) would cause the data to be rewritten, that&apos;s how we&apos;d want it. (or maybe we&apos;d want to optionally block these reference files from being compacted).&lt;br/&gt;
Might be very specific to our use case.&lt;/p&gt;

&lt;p&gt;Bulk delete and update by declaring a transformation is also very interesting.&lt;/p&gt;</comment>
                            <comment id="14349785" author="ndimiduk" created="Fri, 6 Mar 2015 02:00:42 +0000"  >&lt;p&gt;Pretty cool idea. Would also allow us to have some efficient implementation of non-materialized views.&lt;/p&gt;</comment>
                            <comment id="14350629" author="lhofhansl" created="Fri, 6 Mar 2015 17:49:08 +0000"  >&lt;p&gt;Exactly. Now the transformation thingy will need a lot of thought. F.e. do filters see the transformed data or are they themselves transformed (I think the former, but would have to think through it). Was also up to this point only thinking about simple key transformations (in our case to switch tenant ids).&lt;/p&gt;</comment>
                            <comment id="14351071" author="enis" created="Fri, 6 Mar 2015 22:47:24 +0000"  >&lt;p&gt;Big +1. Was thinking along the same lines (excluding transformations). HFile link implements soft links, and Reference files implement soft links with top/bottom limit. We can actually benefit from another related concept, where an HFile contains information for multiple regions, and can be referred from multiple regions (with region name + boundary). This is pretty important for distributed log splitting, where we do not need to create so many small files per WAL file (we end up creating regions x WAL files many files). I believe in the original paper, BigTable achieves something like this with softlinks implemented via META (the regions files are what is there in the meta, not what is there in the file system). A range on the reference file will allow the region to be splittable after another split, but before compaction. It also allows the region to be split into more than two pieces. &lt;br/&gt;
For the transformation, I think even local index can make use of it. If we can make persist the index data without the region start key prefix, we can apply an on-demand transformation for adding the prefix to the cells, so that after local index region split, the data does not have to be rewritten. &lt;/p&gt;</comment>
                            <comment id="14351410" author="stack" created="Sat, 7 Mar 2015 04:59:07 +0000"  >&lt;p&gt;Tell us more about use cases. Give us example transforms (other than identity and &apos;drop&apos;... or is that it?) Regards transforms, ain&apos;t that just filter at HFile level?&lt;/p&gt;

&lt;p&gt;How would you get the &apos;view&apos; up to high level when transform is at the HFile level?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;...and can be referred from multiple regions&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Always shied from supporting this. Was afraid of the complexity and dangling pointers.&lt;/p&gt;

&lt;p&gt;I suppose if we had RangeReferenceFiles, could help at log split time. Same count of files so same NN traffic... we&apos;d just be reading from one file. With current small files, you can remove them when done but with RangeReferenceFiles, you&apos;d need to do refcounting... in meta?&lt;/p&gt;

&lt;p&gt;RangeReferenceFiles would not save NN traffic since we have to drop them in the FS but could save i/o not replicating Cells.&lt;/p&gt;

&lt;p&gt;@enis The index would be persisted in HFile or to a separate RangeReferenceFile?  The benefit is smaller indices? Transform would add prefix back? Will that work? (maybe I&apos;m not following)&lt;/p&gt;



</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12845303">HBASE-14090</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 5 Mar 2015 21:07:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i26f1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>