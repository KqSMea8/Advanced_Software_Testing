<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:10:46 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3506/HBASE-3506.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3506] Allow table name expressed in regex in drop, disable, enable operations</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3506</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Ability to disable, drop and enable tables using regex expression is desirable.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12497755">HBASE-3506</key>
            <summary>Allow table name expressed in regex in drop, disable, enable operations</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fwiffo">Joey Echeverria</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Sat, 5 Feb 2011 16:24:01 +0000</created>
                <updated>Tue, 28 Jun 2011 22:42:49 +0000</updated>
                            <resolved>Thu, 23 Jun 2011 01:39:48 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13052607" author="koven2049" created="Tue, 21 Jun 2011 15:05:48 +0000"  >&lt;p&gt;I think it is a very dangerous op. If you want to disable or drop some tables, you can write them in a file and use &quot;hbase shell file&quot;&lt;/p&gt;

&lt;p&gt;e.g:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-actionscript&quot;&gt; 
 []$cat drops
 drop &apos;t1&apos;
 drop &apos;t2&apos;
 drop &apos;t3&apos;
 exit
 []$hbase shell drops
 0 row(s) &lt;span class=&quot;code-keyword&quot;&gt;in&lt;/span&gt; 1.5880 seconds
 0 row(s) &lt;span class=&quot;code-keyword&quot;&gt;in&lt;/span&gt; 1.5880 seconds
 0 row(s) &lt;span class=&quot;code-keyword&quot;&gt;in&lt;/span&gt; 1.5880 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="13052609" author="fwiffo" created="Tue, 21 Jun 2011 15:09:02 +0000"  >&lt;p&gt;You could prompt before each table. At the very least there should be a list that accepts a regex.&lt;/p&gt;</comment>
                            <comment id="13052611" author="eric@apache.org" created="Tue, 21 Jun 2011 15:13:15 +0000"  >&lt;p&gt;Sounds to me dangerous to have it via the same command names, even with prompt.&lt;br/&gt;
What about using disableRegExp, dropRegExp, enableRegExp?&lt;/p&gt;</comment>
                            <comment id="13052673" author="fwiffo" created="Tue, 21 Jun 2011 17:18:14 +0000"  >&lt;p&gt;Unless there are any objections, I&apos;m going to go with Eric&apos;s suggestion and add new commands. I&apos;ll also modify list to accept an optional regex, e.g.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hbase&amp;gt; list &apos;test.*&apos;
TABLE                                                                           
test1                                                                           
test2                                                                           
2 row(s) in 0.0140 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13052830" author="fwiffo" created="Tue, 21 Jun 2011 21:00:38 +0000"  >&lt;p&gt;I went with disable_all, drop_all and enable_all:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hbase(main):001:0&amp;gt; disable_all &apos;test.*&apos;
test1                                                                           
test2                                                                           

Disable the above tables (y/n)?
y
0 row(s) in 4.0600 seconds

hbase(main):002:0&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The list command in the shell already supported regular expressions, but I added methods in HBaseAdmin so that the java support is on par with the shell.&lt;/p&gt;

&lt;p&gt;Please review and let me know what you think.&lt;/p&gt;</comment>
                            <comment id="13052840" author="yuzhihong@gmail.com" created="Tue, 21 Jun 2011 21:16:08 +0000"  >&lt;p&gt;Nice work Joey.&lt;/p&gt;

&lt;p&gt;I think we should catch exception(s) coming out of deleteTable() so that an exception in the middle of the operation doesn&apos;t stop other tables from being dropped:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void deleteTables(Pattern pattern) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
+    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (HTableDescriptor table : listTables(pattern)) {
+      deleteTable(table.getName());
+    }
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Also, it would be nice to change the return type to HTableDescriptor[] which contain the table(s) that might have not been deleted.&lt;/p&gt;

&lt;p&gt;Similar comment applies to disableTables().&lt;/p&gt;</comment>
                            <comment id="13052854" author="fwiffo" created="Tue, 21 Jun 2011 21:31:08 +0000"  >&lt;p&gt;Thanks Ted. Good ideas all around. I&apos;ll work up a new patch.&lt;/p&gt;</comment>
                            <comment id="13052865" author="fwiffo" created="Tue, 21 Jun 2011 21:49:48 +0000"  >&lt;p&gt;Incorporated Ted&apos;s feedback about catching errors and returning tables that couldn&apos;t be disabled/deleted.&lt;/p&gt;</comment>
                            <comment id="13052882" author="yuzhihong@gmail.com" created="Tue, 21 Jun 2011 22:08:23 +0000"  >&lt;p&gt;What I meant was to display the tables not disabled/dropped so that user can perform follow-on action:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    def disable_all(regex)
+      regex = regex.to_s
+      @admin.disableTables(regex)
+    end
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13052907" author="fwiffo" created="Tue, 21 Jun 2011 22:36:12 +0000"  >&lt;p&gt;Good idea, I&apos;ll add that.&lt;/p&gt;</comment>
                            <comment id="13052918" author="fwiffo" created="Tue, 21 Jun 2011 22:47:59 +0000"  >&lt;p&gt;Modified the commands to print a list of tables that couldn&apos;t be disabled/dropped.&lt;/p&gt;</comment>
                            <comment id="13052922" author="yuzhihong@gmail.com" created="Tue, 21 Jun 2011 22:53:56 +0000"  >&lt;p&gt;Good to go if tests pass.&lt;/p&gt;</comment>
                            <comment id="13053024" author="eric@apache.org" created="Wed, 22 Jun 2011 03:44:13 +0000"  >&lt;p&gt;To better inform, the message after the question&lt;br/&gt;
Disable the 12 above tables (y/n)?&lt;br/&gt;
y&lt;/p&gt;

&lt;p&gt;... could be&lt;br/&gt;
9 tables successfully desactivated&lt;br/&gt;
2 tables not desactivated due to exception: Table_E, Table_Y&lt;/p&gt;</comment>
                            <comment id="13053025" author="eric@apache.org" created="Wed, 22 Jun 2011 03:45:36 +0000"  >&lt;p&gt;on my previous post: 9 + 2 != 12, sigh... please read 11 (it&apos;s early here).&lt;/p&gt;</comment>
                            <comment id="13053571" author="fwiffo" created="Thu, 23 Jun 2011 00:45:03 +0000"  >&lt;p&gt;I modified the output per Eric&apos;s suggestion:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hbase(main):007:0&amp;gt; drop_all &apos;test.*&apos;
test1                                                                           
test2                                                                           

Drop the above 2 tables (y/n)?
y
1 tables successfully dropped
1 tables not dropped due to an exception: test1

hbase(main):008:0&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I also added the same kind of exception catching to enable since I suppose it could work on some tables, but not others.&lt;/p&gt;

&lt;p&gt;Lastly I rebased the patch as I saw that some changes got checked into trunk.&lt;/p&gt;</comment>
                            <comment id="13053594" author="yuzhihong@gmail.com" created="Thu, 23 Jun 2011 01:39:25 +0000"  >&lt;p&gt;Committed to TRUNK.&lt;/p&gt;

&lt;p&gt;Thanks for the nice work Joey.&lt;/p&gt;</comment>
                            <comment id="13053602" author="fwiffo" created="Thu, 23 Jun 2011 01:54:20 +0000"  >&lt;p&gt;You&apos;re welcome, happy to help &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13056851" author="hudson" created="Tue, 28 Jun 2011 22:42:49 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #1995 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/1995/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/1995/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12483344" name="HBASE-3506-1.patch" size="15822" author="fwiffo" created="Tue, 21 Jun 2011 21:00:38 +0000"/>
                            <attachment id="12483358" name="HBASE-3506-2.patch" size="16771" author="fwiffo" created="Tue, 21 Jun 2011 21:49:48 +0000"/>
                            <attachment id="12483370" name="HBASE-3506-3.patch" size="17254" author="fwiffo" created="Tue, 21 Jun 2011 22:47:59 +0000"/>
                            <attachment id="12483533" name="HBASE-3506-4.patch" size="17948" author="fwiffo" created="Thu, 23 Jun 2011 00:45:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 21 Jun 2011 15:05:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33058</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 25 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hmjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100916</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>