<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:09:10 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-15982/HBASE-15982.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-15982] Interface ReplicationEndpoint extends Guava&apos;s Service</title>
                <link>https://issues.apache.org/jira/browse/HBASE-15982</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We have Guava&apos;s Service leaking into the LimitedPrivate interface ReplicationEndpoint:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; ReplicationEndpoint &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Service, ReplicationPeerConfigListener
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This required a private patch when I updated Guava for our internal deployments. This is going to be a problem for us for long term maintenance and implenters of pluggable replication endpoints. LP is only less than public by a degree. We shouldn&apos;t leak types from third part code into either Public or LP APIs in my opinion. Let&apos;s fix.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12976611">HBASE-15982</key>
            <summary>Interface ReplicationEndpoint extends Guava&apos;s Service</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Jun 2016 20:29:46 +0000</created>
                <updated>Tue, 4 Oct 2016 23:19:47 +0000</updated>
                                                            <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.4.0</fixVersion>
                    <fixVersion>0.98.24</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="15321492" author="apurtell" created="Wed, 8 Jun 2016 21:38:44 +0000"  >&lt;p&gt;Here&apos;s what happens if you move &lt;tt&gt;guava.version&lt;/tt&gt; up to 14.0.1, for example:&lt;/p&gt;

&lt;p&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/VisibilityReplicationEndpoint.java:42,7 error: VisibilityReplicationEndpoint is not abstract and does not override abstract method addListener(Listener,Executor) in Service&lt;/p&gt;

&lt;p&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/VisibilityReplicationEndpoint.java:42,7 error: VisibilityReplicationEndpoint is not abstract and does not override abstract method failureCause() in Service&lt;/p&gt;

&lt;p&gt;(0.98.20)&lt;/p&gt;

&lt;p&gt;Representative of the problem every replication endpoint plugin will face, repeatedly, as we shift Guava versions around.&lt;/p&gt;</comment>
                            <comment id="15323048" author="enis" created="Thu, 9 Jun 2016 18:28:29 +0000"  >&lt;p&gt;We&apos;ve done the RE as a guava service, because our &lt;tt&gt;Service&lt;/tt&gt; class is half-finished: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// This is a WIP. We have Services throughout hbase. Either have all implement what is here or
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// just remove &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; as an experiment that did not work out.
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// TODO: Move on to guava Service after we update our guava version; later guava has nicer
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// Service implmentation.
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;// TODO: Move all Services on to &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; one Interface.
&lt;/span&gt;@InterfaceAudience.Private
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; Service {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I still want to use Guava as our long term Service interface, because the interface it pretty well defined. However, maybe we can wrap it so that RE is not exposed to it directly. &lt;/p&gt;</comment>
                            <comment id="15323168" author="apurtell" created="Thu, 9 Jun 2016 19:32:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;maybe we can wrap it so that RE is not exposed to it directly.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This would work&lt;/p&gt;</comment>
                            <comment id="15335147" author="apurtell" created="Fri, 17 Jun 2016 01:18:28 +0000"  >&lt;p&gt;How tolerant are we of a one time change in the inheritance hierarchy of LP(coproc) interface ReplicationEndpoint ?&lt;/p&gt;

&lt;p&gt;No problem to commit to branch-1 and master. For 1.3 it&apos;s possible, depends if &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mantonov&quot; class=&quot;user-hover&quot; rel=&quot;mantonov&quot;&gt;Mikhail Antonov&lt;/a&gt; is still accepting latecomers. For 0.98 we can also do it as each 0.98.x is a minor release. Branches 1.2 (&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;) and 1.1 (&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt;) would be out, I presume. &lt;/p&gt;</comment>
                            <comment id="15335377" author="ndimiduk" created="Fri, 17 Jun 2016 04:23:58 +0000"  >&lt;p&gt;Yeah, I would be opposed to such a change on branch-1.1.&lt;/p&gt;</comment>
                            <comment id="15335512" author="mantonov" created="Fri, 17 Jun 2016 06:27:19 +0000"  >&lt;p&gt;At this point I&apos;d say- let&apos;s just not make it on 1.3. &lt;/p&gt;

&lt;p&gt;New good changes come in every day, but just at some point we have to draw the line in the sand and say that from now on - sorry, let&apos;s make no changes before the RC but critical fixes plus patches needed to stabilize the branch (test fixes, broken/flaky tests etc).&lt;/p&gt;

&lt;p&gt;Since it&apos;s only LP interface I suppose it doesn&apos;t justify it to be critical, but please correct me if I&apos;m missing something.&lt;/p&gt;</comment>
                            <comment id="15336457" author="apurtell" created="Fri, 17 Jun 2016 16:55:22 +0000"  >&lt;p&gt;Ok, then the current set of fix versions is good&lt;/p&gt;</comment>
                            <comment id="15420656" author="apurtell" created="Mon, 15 Aug 2016 06:27:22 +0000"  >&lt;p&gt;Here&apos;s a new wrinkle. Now that we&apos;ve banned jsr305, some versions of Guava cannot be used because they cause a compilation failure at ReplicationEndpoint:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[ERROR] .m2/repository/com/google/guava/guava/14.0.1/guava-14.0.1.jar
    (com/google/common/util/concurrent/AbstractService.class): warning:
    Cannot find annotation method &apos;value()&apos; in type &apos;GuardedBy&apos;: class
    file for javax.annotation.concurrent.GuardedBy not found
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15420658" author="apurtell" created="Mon, 15 Aug 2016 06:31:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;I still want to use Guava as our long term Service interface, because the interface it pretty well defined. However, maybe we can wrap it so that RE is not exposed to it directly.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It might be difficult indeed to use Guava as the basis for our Service interface if it embeds a requirement for a Category X dependency.&lt;/p&gt;

&lt;p&gt;We harmonize on Guava 14 for internal builds after finding something that works across HDFS, HBase, Hive, Spark, and others. It&apos;s easy to revert the jsr305-findbugs ban on an internal build but that won&apos;t be a workable solution upstream. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 9 Jun 2016 18:28:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2z48f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>