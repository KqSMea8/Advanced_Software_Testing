<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:29:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-12053/HBASE-12053.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-12053] SecurityBulkLoadEndPoint set 777 permission on input data files </title>
                <link>https://issues.apache.org/jira/browse/HBASE-12053</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We have code in SecureBulkLoadEndpoint#secureBulkLoadHFiles&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
              LOG.trace(&lt;span class=&quot;code-quote&quot;&gt;&quot;Setting permission &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: &quot;&lt;/span&gt; + p);
              fs.setPermission(p, PERM_ALL_ACCESS);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is against the point we use staging folder for secure bulk load. Currently we create a hidden staging folder which has ALL_ACCESS permission and we  use &quot;doAs&quot; to move input files into staging folder. Therefore, we should not set 777 permission on the original input data files but files in staging folder after move. &lt;/p&gt;

&lt;p&gt;This may comprise security setting especially when there is an error &amp;amp; we move the file with 777 permission back. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12743271">HBASE-12053</key>
            <summary>SecurityBulkLoadEndPoint set 777 permission on input data files </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jeffreyz">Jeffrey Zhong</assignee>
                                    <reporter username="jeffreyz">Jeffrey Zhong</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Sep 2014 18:13:24 +0000</created>
                <updated>Sat, 21 Feb 2015 23:45:38 +0000</updated>
                            <resolved>Thu, 27 Nov 2014 00:55:51 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>0.98.9</fixVersion>
                    <fixVersion>0.99.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14143612" author="jeffreyz" created="Mon, 22 Sep 2014 18:46:46 +0000"  >&lt;p&gt;I haven&apos;t tested the patch yet and will test it when I set up a secure env but comments are welcome now. Thanks.&lt;/p&gt;</comment>
                            <comment id="14143987" author="enis" created="Mon, 22 Sep 2014 22:57:53 +0000"  >&lt;p&gt;This looks good to me. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!FSHDFSUtils.isSameHdfs(conf, srcFs, fs)) {
+        &lt;span class=&quot;code-comment&quot;&gt;// files are copied so no need to move them back
&lt;/span&gt;+        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should we also delete the staging files? &lt;/p&gt;

&lt;p&gt;Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=toffer&quot; class=&quot;user-hover&quot; rel=&quot;toffer&quot;&gt;Francis Liu&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="14145617" author="jeffreyz" created="Tue, 23 Sep 2014 23:36:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; Thanks for the review.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Should we also delete the staging files?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;After bulk load is done, they will be cleaned by SecureBulkLoadEndpoint#cleanupBulkLoad. &lt;/p&gt;</comment>
                            <comment id="14168500" author="enis" created="Sun, 12 Oct 2014 03:36:29 +0000"  >&lt;p&gt;I&apos;m +1 for this patch, but would be more comfortable if we can get another review. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.purtell%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;andrew.purtell@gmail.com&quot;&gt;Andrew Purtell&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=toffer&quot; class=&quot;user-hover&quot; rel=&quot;toffer&quot;&gt;Francis Liu&lt;/a&gt;.  &lt;/p&gt;</comment>
                            <comment id="14203693" author="jeffreyz" created="Sun, 9 Nov 2014 00:22:01 +0000"  >&lt;p&gt;I&apos;ve tested the patch in a secure env and worked. If no objection, I&apos;ll commit it later next week. Thanks.&lt;/p&gt;</comment>
                            <comment id="14227072" author="jeffreyz" created="Thu, 27 Nov 2014 00:55:51 +0000"  >&lt;p&gt;Thanks for the comments! I&apos;ve integrated the fix into 0.98,0.99 &amp;amp; master branches.&lt;/p&gt;</comment>
                            <comment id="14227170" author="hudson" created="Thu, 27 Nov 2014 02:36:58 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #5830 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5830/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5830/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12053&quot; title=&quot;SecurityBulkLoadEndPoint set 777 permission on input data files &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12053&quot;&gt;&lt;del&gt;HBASE-12053&lt;/del&gt;&lt;/a&gt;: SecurityBulkLoadEndPoint set 777 permission on input data files (jeffreyz: rev b2cdeacc8cb153eebfa886e5141b6e86590476e9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/SecureBulkLoadEndpoint.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14227180" author="hudson" created="Thu, 27 Nov 2014 02:46:52 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.0 #512 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/512/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/512/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12053&quot; title=&quot;SecurityBulkLoadEndPoint set 777 permission on input data files &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12053&quot;&gt;&lt;del&gt;HBASE-12053&lt;/del&gt;&lt;/a&gt;: SecurityBulkLoadEndPoint set 777 permission on input data files (jeffreyz: rev def45c2185a3c8d042787190d0c4e382269d7571)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/SecureBulkLoadEndpoint.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14227196" author="hudson" created="Thu, 27 Nov 2014 03:02:46 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #704 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/704/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/704/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12053&quot; title=&quot;SecurityBulkLoadEndPoint set 777 permission on input data files &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12053&quot;&gt;&lt;del&gt;HBASE-12053&lt;/del&gt;&lt;/a&gt;: SecurityBulkLoadEndPoint set 777 permission on input data files (jeffreyz: rev c8c8bf21a67dc243334fc9e42c1ef5e599fdf88b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/SecureBulkLoadEndpoint.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14227215" author="hudson" created="Thu, 27 Nov 2014 03:30:55 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #671 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/671/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/671/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12053&quot; title=&quot;SecurityBulkLoadEndPoint set 777 permission on input data files &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12053&quot;&gt;&lt;del&gt;HBASE-12053&lt;/del&gt;&lt;/a&gt;: SecurityBulkLoadEndPoint set 777 permission on input data files (jeffreyz: rev c8c8bf21a67dc243334fc9e42c1ef5e599fdf88b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/security/access/SecureBulkLoadEndpoint.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14331652" author="enis" created="Sat, 21 Feb 2015 23:45:38 +0000"  >&lt;p&gt;Closing this issue after 0.99.2 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12670464" name="HBASE-12053.patch" size="3461" author="jeffreyz" created="Mon, 22 Sep 2014 18:46:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 22 Sep 2014 22:57:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20clj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>