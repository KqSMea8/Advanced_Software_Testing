<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:07:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-9754/HBASE-9754.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-9754] Eliminate threadlocal from MVCC code</title>
                <link>https://issues.apache.org/jira/browse/HBASE-9754</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Brought up by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vrodionov&quot; class=&quot;user-hover&quot; rel=&quot;vrodionov&quot;&gt;Vladimir Rodionov&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yuzhihong%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yuzhihong@gmail.com&quot;&gt;Ted Yu&lt;/a&gt;.&lt;br/&gt;
Currently we use ThreadLocals to communicate the current readpoint between a RegionScanner and the Store{File}Scanner&apos;s down the stack.&lt;br/&gt;
Since ThreadLocals are not cheap we should consider whether it is possible to pass the readpoint through the call stack instead.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12673573">HBASE-9754</key>
            <summary>Eliminate threadlocal from MVCC code</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuzhihong@gmail.com">Ted Yu</assignee>
                                    <reporter username="lhofhansl">Lars Hofhansl</reporter>
                        <labels>
                            <label>Phoenix</label>
                    </labels>
                <created>Sun, 13 Oct 2013 00:18:19 +0000</created>
                <updated>Sat, 21 Feb 2015 23:31:46 +0000</updated>
                            <resolved>Mon, 2 Dec 2013 04:17:44 +0000</resolved>
                                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.99.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>17</watches>
                                                                <comments>
                            <comment id="13793561" author="lhofhansl" created="Sun, 13 Oct 2013 02:24:17 +0000"  >&lt;p&gt;The idea is this:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;In HRegion.RegionScannerImpl.&amp;lt;init&amp;gt; pass the current readpoint to store.getScanner(...)&lt;/li&gt;
	&lt;li&gt;From there pass it to StoreScanner.&amp;lt;init&amp;gt;&lt;/li&gt;
	&lt;li&gt;on to StoreScanner.getScannersNoCompaction(...)&lt;/li&gt;
	&lt;li&gt;to Store.getScanners()&lt;/li&gt;
	&lt;li&gt;and finally memstore.getScanners() and StoreFileScanner&lt;br/&gt;
      .getScannersForStoreFiles(...)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This will need to tedious refactoring of all the StoreScanner constructors to do the right thing in all cases, but in principle it is not difficult.&lt;/p&gt;

&lt;p&gt;That way MVCC.setThreadReadPoint and MVCC.getThreadReadPoint will be unnecessary and we can get rid of MVCC.perThreadReadPoint completely. Should be a nice improvement for performance and readability.&lt;/p&gt;</comment>
                            <comment id="13793562" author="enis" created="Sun, 13 Oct 2013 03:22:55 +0000"  >&lt;p&gt;+1 to the idea. &lt;/p&gt;</comment>
                            <comment id="13794544" author="yuzhihong@gmail.com" created="Mon, 14 Oct 2013 22:13:24 +0000"  >&lt;p&gt;w.r.t. the StoreScanner constructors, there&apos;re two which don&apos;t have Store argument. These two constructors are for testing.&lt;br/&gt;
The other constructors accept Store argument which has reference to HRegion.&lt;/p&gt;</comment>
                            <comment id="13794754" author="yuzhihong@gmail.com" created="Tue, 15 Oct 2013 01:24:04 +0000"  >&lt;p&gt;Initial patch.&lt;/p&gt;

&lt;p&gt;I ran the following unit tests locally and they passed:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 1164  mt2 -Dtest=TestMemStore
 1167  mt2 -Dtest=TestCoprocessorScanPolicy,TestMemStoreChunkPool,TestFSErrorsExposed,TestRegionObserverScannerOpenHook
 1173  mt2 -Dtest=TestHRegion
 1175  mt2 -Dtest=TestJoinedScanners
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;API changes are in classes marked @InterfaceAudience.Private&lt;/p&gt;</comment>
                            <comment id="13794755" author="yuzhihong@gmail.com" created="Tue, 15 Oct 2013 01:24:41 +0000"  >&lt;p&gt;Patch contains patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9753&quot; title=&quot;Excessive readpoint checks in MemstoreScanner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9753&quot;&gt;&lt;del&gt;HBASE-9753&lt;/del&gt;&lt;/a&gt; as well.&lt;/p&gt;</comment>
                            <comment id="13794757" author="yuzhihong@gmail.com" created="Tue, 15 Oct 2013 01:29:54 +0000"  >&lt;p&gt;Here is review request: &lt;a href=&quot;https://reviews.apache.org/r/14642/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/14642/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13794818" author="hadoopqa" created="Tue, 15 Oct 2013 02:54:17 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12608406/9754-rp-0.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12608406/9754-rp-0.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to cause Findbugs (version 1.3.9) to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7540//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7540//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7540//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7540//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13794827" author="yuzhihong@gmail.com" created="Tue, 15 Oct 2013 03:12:30 +0000"  >&lt;p&gt;I saw the same number of findbugs warnings in:&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7538/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7538/console&lt;/a&gt;&lt;br/&gt;
which was for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9748&quot; title=&quot;Address outstanding comments raised for HBASE-9696&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9748&quot;&gt;&lt;del&gt;HBASE-9748&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think the cause was the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] Compiling 44 source files to /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/trunk/hbase-thrift/target/classes
#
# There is insufficient memory &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the Java &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment to &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;.
# Native memory allocation (malloc) failed to allocate 90184 bytes &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Arena::Amalloc
# An error report file with more information is saved as:
# /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/trunk/hs_err_pid8382.log
/home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/trunk/dev-support/test-patch.sh: line 561:  8382 Aborted                 $MVN clean &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; findbugs:findbugs -D${PROJECT_NAME}PatchProcess -DskipTests &amp;lt; /dev/&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13794855" author="lhofhansl" created="Tue, 15 Oct 2013 04:02:07 +0000"  >&lt;p&gt;Did a quick read through. Looks good. Need to look in more detail.&lt;br/&gt;
Using 0 as readPt when unknown is interesting.&lt;/p&gt;

&lt;p&gt;Could we use the readPt to replace the hasMVCC stuff I just added in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9751&quot; title=&quot;Excessive  readpoints checks in StoreFileScanner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9751&quot;&gt;&lt;del&gt;HBASE-9751&lt;/del&gt;&lt;/a&gt;? I.e. pass MAX_LONG as readPt when we would have passed hasMVCC=true, in which case we know we do not need to check the memstoreTs...?&lt;/p&gt;

&lt;p&gt;I&apos;d be in favor of committing &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9753&quot; title=&quot;Excessive readpoint checks in MemstoreScanner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9753&quot;&gt;&lt;del&gt;HBASE-9753&lt;/del&gt;&lt;/a&gt; first as that is simple, and scrutinize this one a bit more.&lt;/p&gt;</comment>
                            <comment id="13794863" author="yuzhihong@gmail.com" created="Tue, 15 Oct 2013 04:12:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;scrutinize this one a bit more.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Take your time.&lt;br/&gt;
Depending on how long the review takes, we can decide which one to commit first. &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9753&quot; title=&quot;Excessive readpoint checks in MemstoreScanner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9753&quot;&gt;&lt;del&gt;HBASE-9753&lt;/del&gt;&lt;/a&gt; is a subset of this.&lt;/p&gt;</comment>
                            <comment id="13794865" author="yuzhihong@gmail.com" created="Tue, 15 Oct 2013 04:17:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;Could we use the readPt to replace the hasMVCC stuff&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Looking at the code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; hasMVCCInfo() {
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; includesMemstoreTS &amp;amp;&amp;amp; decodeMemstoreTS;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think they represent different things.&lt;/p&gt;</comment>
                            <comment id="13794879" author="lhofhansl" created="Tue, 15 Oct 2013 04:44:44 +0000"  >&lt;p&gt;I meant that say that instead of a boolean, we can set if the passed readPt to MAX_LONG when the above condition is true, and then avoid the MVCC check as before when readPt==MAX_LONG. Would safe a parameter and also make sense (IMHO). Not important, though.&lt;/p&gt;</comment>
                            <comment id="13796249" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 00:30:40 +0000"  >&lt;p&gt;In StoreScanner.java, I replaced the initial value with the following and reran test suite:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; readPt = &lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;.MAX_VALUE;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The suite passed - readPt would be assigned correctly in ctor&apos;s so its initial value doesn&apos;t matter.&lt;/p&gt;</comment>
                            <comment id="13796357" author="zjushch" created="Wed, 16 Oct 2013 02:48:34 +0000"  >&lt;p&gt;Patch looks good.&lt;br/&gt;
Agree with eliminating the threadlocals&lt;/p&gt;</comment>
                            <comment id="13796391" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 04:02:19 +0000"  >&lt;p&gt;Rebased patch.&lt;/p&gt;</comment>
                            <comment id="13796445" author="lhofhansl" created="Wed, 16 Oct 2013 05:28:45 +0000"  >&lt;p&gt;I think in the *PolicyObserver.preStoreScannerOpen, we want the current MVCC readpoint, rather than the store smallest readpoint.&lt;br/&gt;
I am also a bit concerned about passing 0 as readPt in some places, as that makes everything visible. And for example it avoids setting the memstoreTs of KV to 0 even when there are no old scanners open that could see that KV.&lt;br/&gt;
(In fact these were the consideration that made me think a correct patch for this is hard)&lt;/p&gt;</comment>
                            <comment id="13796447" author="hadoopqa" created="Wed, 16 Oct 2013 05:36:27 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12608649/9754-rp-0.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12608649/9754-rp-0.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7559//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13796811" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 14:01:29 +0000"  >&lt;p&gt;In ZooKeeperScanPolicyObserver#preCompactScannerOpen(), currently store.getSmallestReadPoint() is passed.&lt;br/&gt;
My change is in accordance with existing code.&lt;/p&gt;</comment>
                            <comment id="13796821" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 14:15:29 +0000"  >&lt;p&gt;RegionObserver is marked &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@InterfaceAudience.LimitedPrivate(HBaseInterfaceAudience.COPROC)
@InterfaceStability.Evolving
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We can add a new method which sets the current MVCC readpoint for the observer. Another method returns MVCC readpoint that would be utilized in constructing StoreScanner.&lt;/p&gt;</comment>
                            <comment id="13796835" author="lhofhansl" created="Wed, 16 Oct 2013 14:36:53 +0000"  >&lt;p&gt;preCompactScannerOpen() is used for compactions where we want the smalledReadPoint. preStoreScannerOpen is used for user scans where current mvcc readpoint is what we need.&lt;/p&gt;</comment>
                            <comment id="13796952" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 16:37:24 +0000"  >&lt;p&gt;New patch that adds readpoint parameter to preStoreScannerOpen().&lt;br/&gt;
The reasoning is that when user overrides preStoreScannerOpen(), the user should know the readpoint which makes store scanner function correctly.&lt;/p&gt;</comment>
                            <comment id="13796963" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 16:44:13 +0000"  >&lt;p&gt;Went through the latest patch one more time.&lt;br/&gt;
Didn&apos;t find where 0 is passed as readpoint.&lt;/p&gt;</comment>
                            <comment id="13797018" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 17:19:32 +0000"  >&lt;p&gt;9754-rp-hregion.txt avoids changing signature of preStoreScannerOpen() by allowing RegionObserver to query underlying region the correct read point.&lt;/p&gt;</comment>
                            <comment id="13797159" author="hadoopqa" created="Wed, 16 Oct 2013 19:21:35 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12608750/9754-rp-hregion.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12608750/9754-rp-hregion.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7568//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13797416" author="enis" created="Wed, 16 Oct 2013 23:21:21 +0000"  >&lt;p&gt;I think we should run TestAcidGuarantees a couple of times for some stress testing before commit. &lt;/p&gt;</comment>
                            <comment id="13797475" author="yuzhihong@gmail.com" created="Thu, 17 Oct 2013 00:32:37 +0000"  >&lt;p&gt;Here is the tail of one run:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-10-16 17:30:29,951 DEBUG [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-55] catalog.CatalogTracker: Stopping catalog tracker org.apache.hadoop.hbase.catalog.CatalogTracker@6e8ef177
2013-10-16 17:30:29,970 INFO  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-55] zookeeper.ZooKeeper: Session: 0x141c373bb9c0035 closed
2013-10-16 17:30:29,970 INFO  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-55-EventThread] zookeeper.ClientCnxn: EventThread shut down
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees: Finished test. Writers:
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 19
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 19
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 19
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 19
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 22
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 19
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 22
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 19
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 18
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 17
2013-10-16 17:31:29,971 INFO  [main] hbase.TestAcidGuarantees:   wrote 19
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 22
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 22
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 19
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 22
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 22
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 20
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 21
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   wrote 19
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees: Readers:
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   read 18
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   read 16
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees: Scanners:
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   scanned 15
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   verified 18 rows
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   scanned 21
2013-10-16 17:31:29,972 INFO  [main] hbase.TestAcidGuarantees:   verified 18 rows
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Will run a few more times.&lt;/p&gt;</comment>
                            <comment id="13797477" author="yuzhihong@gmail.com" created="Thu, 17 Oct 2013 00:36:21 +0000"  >&lt;p&gt;Second run:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-10-16 17:33:16,342 DEBUG [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-55] catalog.CatalogTracker: Stopping catalog tracker org.apache.hadoop.hbase.catalog.CatalogTracker@5e4b2b75
2013-10-16 17:33:16,355 INFO  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-55] zookeeper.ZooKeeper: Session: 0x141c373bb9c0037 closed
2013-10-16 17:33:16,355 INFO  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-55-EventThread] zookeeper.ClientCnxn: EventThread shut down
2013-10-16 17:34:16,355 INFO  [main] hbase.TestAcidGuarantees: Finished test. Writers:
2013-10-16 17:34:16,355 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,355 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,355 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,355 INFO  [main] hbase.TestAcidGuarantees:   wrote 36
2013-10-16 17:34:16,355 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,355 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 40
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 40
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 40
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 35
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 36
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 40
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 36
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 37
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 40
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 41
2013-10-16 17:34:16,356 INFO  [main] hbase.TestAcidGuarantees:   wrote 39
2013-10-16 17:34:16,357 INFO  [main] hbase.TestAcidGuarantees:   wrote 38
2013-10-16 17:34:16,357 INFO  [main] hbase.TestAcidGuarantees: Readers:
2013-10-16 17:34:16,357 INFO  [main] hbase.TestAcidGuarantees:   read 61
2013-10-16 17:34:16,357 INFO  [main] hbase.TestAcidGuarantees:   read 58
2013-10-16 17:34:16,357 INFO  [main] hbase.TestAcidGuarantees: Scanners:
2013-10-16 17:34:16,357 INFO  [main] hbase.TestAcidGuarantees:   scanned 20
2013-10-16 17:34:16,357 INFO  [main] hbase.TestAcidGuarantees:   verified 60 rows
2013-10-16 17:34:16,357 INFO  [main] hbase.TestAcidGuarantees:   scanned 19
2013-10-16 17:34:16,357 INFO  [main] hbase.TestAcidGuarantees:   verified 57 rows
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13797626" author="zjushch" created="Thu, 17 Oct 2013 05:44:57 +0000"  >&lt;p&gt;In Compactor.java&lt;br/&gt;
The &apos;smallestReadPoint&apos; will be calculated in two places now.&lt;br/&gt;
If they have different values, is it safe?&lt;/p&gt;

&lt;p&gt;Others are ok for me&lt;/p&gt;</comment>
                            <comment id="13797973" author="yuzhihong@gmail.com" created="Thu, 17 Oct 2013 15:03:10 +0000"  >&lt;p&gt;Good point, Chunhui.&lt;/p&gt;

&lt;p&gt;In latest patch, I refactored Compactor#createFileScanners() and Compactor#setSmallestReadPoint() which are called by DefaultCompactor#compact().&lt;/p&gt;

&lt;p&gt;Now store.getSmallestReadPoint() is only called once.&lt;/p&gt;</comment>
                            <comment id="13798055" author="hadoopqa" created="Thu, 17 Oct 2013 16:36:49 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12608945/9754-rp-hregion-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12608945/9754-rp-hregion-v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7577//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13798076" author="yuzhihong@gmail.com" created="Thu, 17 Oct 2013 16:48:44 +0000"  >&lt;p&gt;New patch that replaces 0 read point parameter value with proper value.&lt;/p&gt;</comment>
                            <comment id="13798086" author="stack" created="Thu, 17 Oct 2013 16:58:10 +0000"  >&lt;p&gt;What are the implications of this change?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MultiVersionConsistencyControl.resetThreadReadPoint();&lt;br/&gt;
     Scan scan = new Scan(get);&lt;br/&gt;
     InternalScanner scanner = (InternalScanner) store.getScanner(scan,&lt;/li&gt;
	&lt;li&gt;scan.getFamilyMap().get(store.getFamily().getName()));&lt;br/&gt;
+        scan.getFamilyMap().get(store.getFamily().getName()), 0);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We no longer do reset and we pass 0 which means all is readable?  Would think we&apos;d retain at least the first line?&lt;/p&gt;

&lt;p&gt;Does defaulting 0 in all tests change what is being tested (or do you think the reset was setting readpoint to 0 across the board anyways)?&lt;/p&gt;

&lt;p&gt;This should be final now?&lt;/p&gt;

&lt;p&gt;+  private long readPt = 0;&lt;/p&gt;

&lt;p&gt;Is this an odd &apos;public&apos; method to have in HRegion?&lt;/p&gt;

&lt;p&gt;+   /*&lt;br/&gt;
+    * Returns readpoint considering given IsolationLevel&lt;br/&gt;
+    */&lt;br/&gt;
+   public long getReadpoint(IsolationLevel isolationLevel) {&lt;br/&gt;
+     if (isolationLevel == IsolationLevel.READ_UNCOMMITTED) &lt;/p&gt;
{
+       // This scan can read even uncommitted transactions
+       return Long.MAX_VALUE;
+     }
&lt;p&gt;+     return mvcc.memstoreReadPoint();&lt;br/&gt;
+   }&lt;/p&gt;

&lt;p&gt;especially as given just above, we can do a getMVCC so can go &apos;behind-the-scenes&apos;.  Should it be private?&lt;/p&gt;

&lt;p&gt;It is the readPoint for the region?&lt;/p&gt;

&lt;p&gt;Remove&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MultiVersionConsistencyControl.setThreadReadPoint(this.readPt);&lt;br/&gt;
+        // MultiVersionConsistencyControl.setThreadReadPoint(this.readPt);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;ditto&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MultiVersionConsistencyControl.setThreadReadPoint(this.readPt);&lt;br/&gt;
+        // MultiVersionConsistencyControl.setThreadReadPoint(this.readPt);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Undocumented passing of zero (explaining why this is ok) and the sometimes passing of smallestreadpoint instead of readpoint is unsettling.  Explaination on why it is ok in the former case and what smallest means in latter would help the folks who come after understand what is going on.&lt;/p&gt;

&lt;p&gt;Otherwise patch is good.&lt;/p&gt;
</comment>
                            <comment id="13798123" author="yuzhihong@gmail.com" created="Thu, 17 Oct 2013 17:23:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;What are the implications of this change?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;You were referring to the change in HBaseTestingUtility.java, right ?&lt;/p&gt;

&lt;p&gt;Here is what resetThreadReadPoint() does:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void resetThreadReadPoint() {
-    perThreadReadPoint.set(0L);
-  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Meaning, effective readpoint is reset to 0. Hence passing 0 to store.getScanner() is consistent with the existing test.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Would think we&apos;d retain at least the first line?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Is the first line MultiVersionConsistencyControl.resetThreadReadPoint() ? That method has been removed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Does defaulting 0 in all tests change what is being tested&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;There is no change in semantics. 0 is only used when the two StoreScanner ctors, marked for testing, are used.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;This should be final now?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Done.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is this an odd &apos;public&apos; method to have in HRegion?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It is used by NoOpScanPolicyObserver. Compilation passes when I change it to package private. My reasoning was that if user&apos;s RegionObserver overrides preStoreScannerOpen(), this method is needed. User&apos;s code would not be in org.apache.hadoop.hbase.regionserver package.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It is the readPoint for the region?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Readpoint is associated with mvcc for the region.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Undocumented passing of zero (explaining why this is ok)&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Will add doc in next patch.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;and what smallest means in latter&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Would do this too.&lt;/p&gt;</comment>
                            <comment id="13798176" author="yuzhihong@gmail.com" created="Thu, 17 Oct 2013 17:53:16 +0000"  >&lt;p&gt;Updated 9754-rp-hregion-v3.txt with comment on why 0 is passed as readpoint in certain places.&lt;/p&gt;

&lt;p&gt;Also replaced smallestReadPoint in tests.&lt;/p&gt;</comment>
                            <comment id="13798324" author="hadoopqa" created="Thu, 17 Oct 2013 19:41:58 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12608987/9754-rp-hregion-v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12608987/9754-rp-hregion-v3.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7581//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13798719" author="zjushch" created="Fri, 18 Oct 2013 02:07:29 +0000"  >&lt;p&gt;+1 from me for the latest patch&lt;/p&gt;</comment>
                            <comment id="13799513" author="lhofhansl" created="Fri, 18 Oct 2013 21:05:13 +0000"  >&lt;p&gt;Last patch looks good.&lt;br/&gt;
Do you have time to make a 0.94 version &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yuzhihong%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yuzhihong@gmail.com&quot;&gt;Ted Yu&lt;/a&gt;? If so, I could do an apples to apples test in 0.94.&lt;/p&gt;</comment>
                            <comment id="13799519" author="yuzhihong@gmail.com" created="Fri, 18 Oct 2013 21:10:59 +0000"  >&lt;p&gt;Integrated to trunk.&lt;/p&gt;

&lt;p&gt;Thanks for the reviews.&lt;/p&gt;

&lt;p&gt;I can make a patch for 0.94. So API wise you think this is backward compatible, Lars ?&lt;/p&gt;</comment>
                            <comment id="13799574" author="yuzhihong@gmail.com" created="Fri, 18 Oct 2013 22:08:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;:&lt;br/&gt;
Do you want this in 0.96 ?&lt;/p&gt;</comment>
                            <comment id="13799575" author="lhofhansl" created="Fri, 18 Oct 2013 22:09:22 +0000"  >&lt;p&gt;StoreScanner is pretty internal. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=giacomotaylor&quot; class=&quot;user-hover&quot; rel=&quot;giacomotaylor&quot;&gt;James Taylor&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13799589" author="yuzhihong@gmail.com" created="Fri, 18 Oct 2013 22:20:55 +0000"  >&lt;p&gt;Patch for 0.94&lt;/p&gt;

&lt;p&gt;Running test suite now.&lt;/p&gt;</comment>
                            <comment id="13799646" author="lhofhansl" created="Fri, 18 Oct 2013 23:22:22 +0000"  >&lt;p&gt;Please do not commit, yet. I want to check back with Phoenix (as they are on of the use cases that reaches the deepest into the HBase code).&lt;/p&gt;</comment>
                            <comment id="13799668" author="yuzhihong@gmail.com" created="Fri, 18 Oct 2013 23:57:56 +0000"  >&lt;p&gt;For 0.94, there were a few test failures which mostly passed on rerun.&lt;br/&gt;
The following failure was mysterious:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
testDeleteEditUnknownColumnFamilyAndOrTable(org.apache.hadoop.hbase.client.TestAdmin)  Time elapsed: 2.022 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!
java.lang.AssertionError
        at org.junit.Assert.fail(Assert.java:92)
        at org.junit.Assert.assertTrue(Assert.java:43)
        at org.junit.Assert.assertTrue(Assert.java:54)
        at org.apache.hadoop.hbase.client.TestAdmin.testDeleteEditUnknownColumnFamilyAndOrTable(TestAdmin.java:217)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It happened with or without patch.&lt;br/&gt;
I ran the test suite on Linux.&lt;/p&gt;</comment>
                            <comment id="13799674" author="yuzhihong@gmail.com" created="Sat, 19 Oct 2013 00:05:00 +0000"  >&lt;p&gt;I was using JDK 1.7&lt;br/&gt;
Some tests don&apos;t pass when 1.7 is used&lt;/p&gt;</comment>
                            <comment id="13799726" author="yuzhihong@gmail.com" created="Sat, 19 Oct 2013 01:43:39 +0000"  >&lt;p&gt;Using jdk 1.6 all tests passed:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Tests run: 1385, Failures: 0, Errors: 0, Skipped: 13

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1:13:50.479s
[INFO] Finished at: Sat Oct 19 01:22:07 UTC 2013
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13799773" author="hudson" created="Sat, 19 Oct 2013 04:04:32 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #4629 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4629/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4629/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9754&quot; title=&quot;Eliminate threadlocal from MVCC code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9754&quot;&gt;&lt;del&gt;HBASE-9754&lt;/del&gt;&lt;/a&gt; Eliminate threadlocal from MVCC code (Ted Yu) (tedyu: rev 1533633)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-examples/src/main/java/org/apache/hadoop/hbase/coprocessor/example/ZooKeeperScanPolicyObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueHeap.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConsistencyControl.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/Compactor.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/DefaultCompactor.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/handler/ParallelSeekHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestRegionObserverScannerOpenHook.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/HFileReadWriteTest.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/NoOpScanPolicyObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStoreChunkPool.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestCoprocessorScanPolicy.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13799780" author="yuzhihong@gmail.com" created="Sat, 19 Oct 2013 04:35:44 +0000"  >&lt;p&gt;Patch v2 for 0.94 which adds back MVCC#setThreadReadPoint() as no-op.&lt;/p&gt;</comment>
                            <comment id="13799795" author="lhofhansl" created="Sat, 19 Oct 2013 06:00:14 +0000"  >&lt;p&gt;Cool. Above I just meant to say to hold of on the 0.94 check in.&lt;br/&gt;
Is mvcc.setThreadReadPoint public API?&lt;/p&gt;</comment>
                            <comment id="13799796" author="yuzhihong@gmail.com" created="Sat, 19 Oct 2013 06:03:42 +0000"  >&lt;p&gt;It is public API.&lt;/p&gt;</comment>
                            <comment id="13799798" author="yuzhihong@gmail.com" created="Sat, 19 Oct 2013 06:07:53 +0000"  >&lt;p&gt;With 0.94 patch v2, I ran unit tests from tip of Phoenix and found no regression.&lt;br/&gt;
No change in Phoenix code is needed.&lt;/p&gt;</comment>
                            <comment id="13799804" author="hudson" created="Sat, 19 Oct 2013 06:13:01 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #798 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/798/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/798/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9754&quot; title=&quot;Eliminate threadlocal from MVCC code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9754&quot;&gt;&lt;del&gt;HBASE-9754&lt;/del&gt;&lt;/a&gt; Eliminate threadlocal from MVCC code (Ted Yu) (tedyu: rev 1533633)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-examples/src/main/java/org/apache/hadoop/hbase/coprocessor/example/ZooKeeperScanPolicyObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueHeap.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConsistencyControl.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/Compactor.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/DefaultCompactor.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/handler/ParallelSeekHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/HBaseTestingUtility.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/coprocessor/TestRegionObserverScannerOpenHook.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/HFileReadWriteTest.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/NoOpScanPolicyObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStoreChunkPool.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/util/TestCoprocessorScanPolicy.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13800036" author="lhofhansl" created="Sat, 19 Oct 2013 23:35:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jesse_yates&quot; class=&quot;user-hover&quot; rel=&quot;jesse_yates&quot;&gt;Jesse Yates&lt;/a&gt;, you see any problems with some our coprocessors?&lt;/p&gt;</comment>
                            <comment id="13800038" author="lhofhansl" created="Sat, 19 Oct 2013 23:55:35 +0000"  >&lt;p&gt;In my 0.94 tests (where a filter filters all data at the region server) I do not see any performance improvement from this. Maybe that isn&apos;t expected after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9751&quot; title=&quot;Excessive  readpoints checks in StoreFileScanner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9751&quot;&gt;&lt;del&gt;HBASE-9751&lt;/del&gt;&lt;/a&gt; in my case.&lt;br/&gt;
Let&apos;s hold off on the 0.94 commit. I&apos;ll try to isolate a case where this would have an impact and measure that again.&lt;/p&gt;

&lt;p&gt;Still a nice cleanup.&lt;/p&gt;</comment>
                            <comment id="13800084" author="stack" created="Sun, 20 Oct 2013 05:27:16 +0000"  >&lt;p&gt;On 0.96, looks good but are there numbers on the improvement?  If nothing definitive, lets hold off (This is the new &apos;Stack&apos;, the one that only wants bug fixes and definite perf improvement committed to 0.96; let the new stuff happen in the next release, 0.98).&lt;/p&gt;</comment>
                            <comment id="13800318" author="zjushch" created="Mon, 21 Oct 2013 02:32:49 +0000"  >&lt;p&gt;Addendum is ok for me&lt;/p&gt;</comment>
                            <comment id="13800322" author="hadoopqa" created="Mon, 21 Oct 2013 02:56:07 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12609351/9754-addendum.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12609351/9754-addendum.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/7591//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13800328" author="lhofhansl" created="Mon, 21 Oct 2013 03:27:25 +0000"  >&lt;p&gt;How did you figure you need the addendum?&lt;/p&gt;</comment>
                            <comment id="13800332" author="yuzhihong@gmail.com" created="Mon, 21 Oct 2013 03:52:57 +0000"  >&lt;p&gt;I went over the patch again and found that for this particular ctor, we should not use smallestReadPoint as the readpoint.&lt;br/&gt;
Readpoint from the region should be used.&lt;/p&gt;</comment>
                            <comment id="13800371" author="lhofhansl" created="Mon, 21 Oct 2013 05:34:07 +0000"  >&lt;p&gt;would have felt better if a test had caught it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13800437" author="hudson" created="Mon, 21 Oct 2013 07:47:48 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #4633 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4633/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4633/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9754&quot; title=&quot;Eliminate threadlocal from MVCC code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9754&quot;&gt;&lt;del&gt;HBASE-9754&lt;/del&gt;&lt;/a&gt; Addendum passes readpoint to StoreScanner ctor (tedyu: rev 1534019)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13800654" author="hudson" created="Mon, 21 Oct 2013 13:45:07 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #801 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/801/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/801/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9754&quot; title=&quot;Eliminate threadlocal from MVCC code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9754&quot;&gt;&lt;del&gt;HBASE-9754&lt;/del&gt;&lt;/a&gt; Addendum passes readpoint to StoreScanner ctor (tedyu: rev 1534019)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13800925" author="jesse_yates" created="Mon, 21 Oct 2013 18:25:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; not that I know of &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13802446" author="stack" created="Wed, 23 Oct 2013 00:04:03 +0000"  >&lt;p&gt;Can we add a test to catch the issue found reading the code?  Yes, it is troubling not found by test coverage.&lt;/p&gt;</comment>
                            <comment id="13803518" author="yuzhihong@gmail.com" created="Wed, 23 Oct 2013 23:03:28 +0000"  >&lt;p&gt;Looks like TestRegionObserverScannerOpenHook#testRegionObserverCompactionTimeStacking is the test that could have caught the issue.&lt;/p&gt;</comment>
                            <comment id="13808500" author="yuzhihong@gmail.com" created="Tue, 29 Oct 2013 21:48:37 +0000"  >&lt;p&gt;If there is no further action, suggest resolving this JIRA.&lt;/p&gt;</comment>
                            <comment id="13808543" author="stack" created="Tue, 29 Oct 2013 22:25:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;Looks like TestRegionObserverScannerOpenHook#testRegionObserverCompactionTimeStacking is the test that could have caught the issue.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;But it did not, right?&lt;/p&gt;

&lt;p&gt;Was also wondering if &quot;.. looks good but are there numbers on the improvement?&quot;  Is there a micro benchmark that can be done to show improvement?&lt;/p&gt;</comment>
                            <comment id="13836225" author="apurtell" created="Mon, 2 Dec 2013 04:17:44 +0000"  >&lt;p&gt;This has been committed to trunk, resolving. &lt;/p&gt;

&lt;p&gt;Reopen as necessary when committing to other branches.&lt;/p&gt;</comment>
                            <comment id="13931344" author="carp84" created="Wed, 12 Mar 2014 03:12:55 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yuzhihong%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yuzhihong@gmail.com&quot;&gt;Ted Yu&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Just would like to check is it ready now to commit this to 0.94? Or any work left to be done? I&apos;m considering backport &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10191&quot; title=&quot;Move large arena storage off heap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10191&quot;&gt;HBASE-10191&lt;/a&gt;(although still not commit to trunk, but seems will be in a short time) to 0.94 and observing some code gap there w/o this patch. Thanks. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13931380" author="lhofhansl" created="Wed, 12 Mar 2014 04:36:49 +0000"  >&lt;p&gt;I&apos;m a bit skeptical backporting this to 0.94 unless we some hard numbers.&lt;br/&gt;
You want to backport &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10191&quot; title=&quot;Move large arena storage off heap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10191&quot;&gt;HBASE-10191&lt;/a&gt;? If that is the goal you can backport both patches at the same if required.&lt;/p&gt;

&lt;p&gt;Getting large patches like this committed to 0.94 will need some convincing, though. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13931387" author="apurtell" created="Wed, 12 Mar 2014 04:47:22 +0000"  >&lt;p&gt;Pretty sure it&apos;s not &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10191&quot; title=&quot;Move large arena storage off heap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10191&quot;&gt;HBASE-10191&lt;/a&gt; that you are referring to here.&lt;/p&gt;</comment>
                            <comment id="13931710" author="carp84" created="Wed, 12 Mar 2014 12:37:52 +0000"  >&lt;p&gt;Sorry my fault, I meant &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10648&quot; title=&quot;Pluggable Memstore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10648&quot;&gt;&lt;del&gt;HBASE-10648&lt;/del&gt;&lt;/a&gt;...&lt;/p&gt;</comment>
                            <comment id="13974617" author="jeffreyz" created="Fri, 18 Apr 2014 23:14:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt;  Could we back port this JIRA into 0.96 branch? We can leave MVCC#setThreadReadPoint() as no-op. The reason I&apos;m asking is that the change blocks Phoenix 4.0 from working on 0.96 branch. Thanks.&lt;/p&gt;</comment>
                            <comment id="13974620" author="stack" created="Fri, 18 Apr 2014 23:19:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; Will do. Not clean.  Needs some work.  Let me fix.&lt;/p&gt;</comment>
                            <comment id="13974740" author="stack" created="Sat, 19 Apr 2014 05:34:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; Rereading this patch, there is risk adding this to 0.96 but no numbers proving improvement so I am reluctant backporting it.  What you need in particular to make phoenix work?&lt;/p&gt;</comment>
                            <comment id="13974744" author="stack" created="Sat, 19 Apr 2014 05:48:02 +0000"  >&lt;p&gt;Here is a patch that compiles with addendum.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; I&apos;m not a fan of backporting this.  Could we do something narrower to get you what you need?  Thanks.&lt;/p&gt;</comment>
                            <comment id="13974762" author="jeffreyz" created="Sat, 19 Apr 2014 07:09:38 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt; for looking this! You&apos;re so quick. Actually I was just asking the possibility of back porting this JIRA but you already have the patch. &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; I&apos;m not a fan of backporting this. Could we do something narrower to get you what you need&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I agree. At least this is needed when I looked at the issue last time. Let me run some tests early next week with your addendum patch and get back to you. Thanks.&lt;/p&gt;</comment>
                            <comment id="14330869" author="enis" created="Sat, 21 Feb 2015 23:31:46 +0000"  >&lt;p&gt;Closing this issue after 0.99.0 release. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12698100">HBASE-10648</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12609254" name="9754-0.94-v2.txt" size="36427" author="yuzhihong@gmail.com" created="Sat, 19 Oct 2013 04:35:44 +0000"/>
                            <attachment id="12609227" name="9754-0.94.txt" size="36154" author="yuzhihong@gmail.com" created="Fri, 18 Oct 2013 22:20:55 +0000"/>
                            <attachment id="12609351" name="9754-addendum.txt" size="1448" author="yuzhihong@gmail.com" created="Mon, 21 Oct 2013 01:27:56 +0000"/>
                            <attachment id="12608649" name="9754-rp-0.txt" size="35889" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 04:02:19 +0000"/>
                            <attachment id="12608734" name="9754-rp-1.txt" size="41247" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 16:37:24 +0000"/>
                            <attachment id="12608945" name="9754-rp-hregion-v2.txt" size="38069" author="yuzhihong@gmail.com" created="Thu, 17 Oct 2013 15:03:10 +0000"/>
                            <attachment id="12608987" name="9754-rp-hregion-v3.txt" size="42762" author="yuzhihong@gmail.com" created="Thu, 17 Oct 2013 18:06:31 +0000"/>
                            <attachment id="12608750" name="9754-rp-hregion.txt" size="36677" author="yuzhihong@gmail.com" created="Wed, 16 Oct 2013 17:19:32 +0000"/>
                            <attachment id="12640938" name="9754_plus_addendum_096.txt" size="43216" author="stack" created="Sat, 19 Apr 2014 05:48:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 13 Oct 2013 03:22:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353196</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ow6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353483</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>