<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:40:00 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6804/HBASE-6804.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6804] [replication] lower the amount of logging to a more human-readable level</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6804</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We need stop logging every time replication decides to do something. It used to be extremely useful when the code base was younger but now it should be possible to bring it down while keeping it relevant.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12607987">HBASE-6804</key>
            <summary>[replication] lower the amount of logging to a more human-readable level</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdcryans">Jean-Daniel Cryans</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Sep 2012 00:43:30 +0000</created>
                <updated>Mon, 23 Sep 2013 18:30:26 +0000</updated>
                            <resolved>Tue, 4 Dec 2012 00:14:30 +0000</resolved>
                                                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13457515" author="jdcryans" created="Tue, 18 Sep 2012 00:49:04 +0000"  >&lt;p&gt;Attaching a first pass for 0.94 but I&apos;m planning to just commit to 0.96.&lt;/p&gt;

&lt;p&gt;I added a scheduled executor in &lt;tt&gt;Replication&lt;/tt&gt; that prints out all the statistics for both the sources and the sink every 5 minutes by default. I had to add glue methods to get the stats all the way from &lt;tt&gt;ReplicationSource&lt;/tt&gt; to &lt;tt&gt;Replication&lt;/tt&gt; which is not super clean.&lt;/p&gt;

&lt;p&gt;This is what the output looks like for a the sink:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;2012-09-17 17:43:08,418 INFO  &lt;a href=&quot;#0&quot;&gt;Replication Statistics #0&lt;/a&gt; regionserver.Replication$ReplicationStatisticsThread(281): Sink: age in ms of last applied edit: 15644, total replicated edits: 7350&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;And for a source:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;2012-09-17 17:42:19,887 INFO  &lt;a href=&quot;#0&quot;&gt;Replication Statistics #0&lt;/a&gt; regionserver.Replication$ReplicationStatisticsThread(281): Normal source for cluster 2: Total replicated edits: 1473, currently replicating from: hdfs://localhost:53235/user/jdcryans/hbase/.logs/h-25-185.sfo.stumble.net,53250,1347928807372/h-25-185.sfo.stumble.net%2C53250%2C1347928807372.1347928936043 at position: 3347&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think I need to do some more work on the &quot;normal&quot; EOFs that occur when tail&apos;ing a log file.&lt;/p&gt;</comment>
                            <comment id="13459052" author="stack" created="Wed, 19 Sep 2012 20:24:28 +0000"  >&lt;p&gt;Thats a lot of removed DEBUG logging.&lt;/p&gt;

&lt;p&gt;A pool of one thread only seems odd... is it just because you want to do this scheduleAtFixedRate?&lt;/p&gt;

&lt;p&gt;+  private final ScheduledExecutorService scheduleThreadPool =&lt;br/&gt;
+    Executors.newScheduledThreadPool(1,&lt;br/&gt;
+      new ThreadFactoryBuilder()&lt;br/&gt;
+        .setNameFormat(&quot;Replication Statistics #%d&quot;)&lt;br/&gt;
+        .setDaemon(true)&lt;br/&gt;
+        .build());&lt;/p&gt;

&lt;p&gt;Threads usually have their host as prefix; check out other places in server where we name threads.&lt;/p&gt;

&lt;p&gt;Patch seems good.  +1 on commit.&lt;/p&gt;</comment>
                            <comment id="13459056" author="jdcryans" created="Wed, 19 Sep 2012 20:27:03 +0000"  >&lt;blockquote&gt;&lt;p&gt;A pool of one thread only seems odd... is it just because you want to do this scheduleAtFixedRate?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Threads usually have their host as prefix; check out other places in server where we name threads.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Will do.&lt;/p&gt;</comment>
                            <comment id="13469927" author="jdcryans" created="Fri, 5 Oct 2012 00:51:16 +0000"  >&lt;p&gt;Refresh of the patch, it&apos;s currently running on all clusters at StumbleUpon. It addresses Stack&apos;s comment too.&lt;/p&gt;</comment>
                            <comment id="13472774" author="stack" created="Tue, 9 Oct 2012 21:38:44 +0000"  >&lt;p&gt;+1 on commit.  Can this go back into 0.94 too?&lt;/p&gt;</comment>
                            <comment id="13509343" author="jdcryans" created="Mon, 3 Dec 2012 23:52:06 +0000"  >&lt;p&gt;Patch for trunk based on the v2 0.94 patch.&lt;/p&gt;</comment>
                            <comment id="13509346" author="jdcryans" created="Mon, 3 Dec 2012 23:55:03 +0000"  >&lt;p&gt;Oh and the refreshed 0.94 patch.&lt;/p&gt;</comment>
                            <comment id="13509365" author="jdcryans" created="Tue, 4 Dec 2012 00:14:30 +0000"  >&lt;p&gt;Committed to trunk. Since it&apos;s borderline a new feature, I&apos;d rather not put this in 0.94.&lt;/p&gt;</comment>
                            <comment id="13509419" author="hudson" created="Tue, 4 Dec 2012 01:36:46 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3591 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3591/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3591/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6804&quot; title=&quot;[replication] lower the amount of logging to a more human-readable level&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6804&quot;&gt;&lt;del&gt;HBASE-6804&lt;/del&gt;&lt;/a&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;replication&amp;#93;&lt;/span&gt; lower the amount of logging to a more human-readable level (Revision 1416735)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/MetricsSink.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/Replication.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSink.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13511289" author="hudson" created="Thu, 6 Dec 2012 11:51:48 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #285 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/285/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/285/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6804&quot; title=&quot;[replication] lower the amount of logging to a more human-readable level&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6804&quot;&gt;&lt;del&gt;HBASE-6804&lt;/del&gt;&lt;/a&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;replication&amp;#93;&lt;/span&gt; lower the amount of logging to a more human-readable level (Revision 1416735)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
jdcryans : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/MetricsSink.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/Replication.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSink.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceInterface.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/ReplicationSourceDummy.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13774954" author="stack" created="Mon, 23 Sep 2013 18:30:26 +0000"  >&lt;p&gt;Marking closed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12547859" name="HBASE-6804-0.94-v2.patch" size="14436" author="jdcryans" created="Fri, 5 Oct 2012 00:51:16 +0000"/>
                            <attachment id="12555855" name="HBASE-6804-0.94-v3.patch" size="14331" author="jdcryans" created="Mon, 3 Dec 2012 23:55:03 +0000"/>
                            <attachment id="12545505" name="HBASE-6804-0.94.patch" size="10915" author="jdcryans" created="Tue, 18 Sep 2012 00:49:04 +0000"/>
                            <attachment id="12555854" name="HBASE-6804.patch" size="14487" author="jdcryans" created="Mon, 3 Dec 2012 23:52:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 19 Sep 2012 20:24:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241883</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02g5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12219</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Replication will not log a lot less messages than before. There&amp;#39;s no way to &amp;quot;re-active&amp;quot; those old log lines. Configure replication.stats.thread.period.seconds to set how often replication stats are printed in the log, by default it&amp;#39;s 5 minutes.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>