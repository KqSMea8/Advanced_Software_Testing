<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:52:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1367/HBASE-1367.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1367] get rid of thrift exception &apos;NotFound&apos;</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1367</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;as per the discussion in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-794&quot; title=&quot;Language neutral IPC as a first class component of HBase architecture&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-794&quot;&gt;&lt;del&gt;HBASE-794&lt;/del&gt;&lt;/a&gt;, the use of exceptions is not good, since some clients may disconnect.&lt;/p&gt;

&lt;p&gt;Return a structure like:&lt;/p&gt;
{ boolean: found, RowResult: result }

&lt;p&gt;where &apos;result&apos; is optional if found is false.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12424473">HBASE-1367</key>
            <summary>get rid of thrift exception &apos;NotFound&apos;</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12424350">HBASE-1360</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="ryanobjc">ryan rawson</reporter>
                        <labels>
                    </labels>
                <created>Sun, 3 May 2009 07:14:25 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:35 +0000</updated>
                            <resolved>Tue, 5 May 2009 21:45:40 +0000</resolved>
                                                    <fixVersion>0.20.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12705777" author="apurtell" created="Mon, 4 May 2009 21:57:57 +0000"  >&lt;p&gt;Moving into 0.20.&lt;/p&gt;</comment>
                            <comment id="12705791" author="apurtell" created="Mon, 4 May 2009 22:23:04 +0000"  >&lt;p&gt;Rather than use booleans, why not return lists of either Cell or RowResult depending on the API, where if a cell or row is not found, an empty list is returned. I&apos;m working on a patch that does this now. &lt;/p&gt;</comment>
                            <comment id="12705804" author="ryanobjc" created="Mon, 4 May 2009 22:42:19 +0000"  >&lt;p&gt;that also sounds fine to me.&lt;/p&gt;</comment>
                            <comment id="12705827" author="apurtell" created="Mon, 4 May 2009 23:43:01 +0000"  >&lt;p&gt;I can&apos;t find an old enough version of the Thrift compiler to regenerate after updating the IDL, so I&apos;m just going to pull up to today&apos;s Thrift trunk &amp;#8211; r771332 and commit the result and the removal of NotFound as a single change set. &lt;/p&gt;</comment>
                            <comment id="12705881" author="stack" created="Tue, 5 May 2009 03:31:56 +0000"  >&lt;p&gt;Minor:&lt;/p&gt;

&lt;p&gt;Below could be size of the in array rather than 1&lt;/p&gt;

&lt;p&gt;+    List&amp;lt;TCell&amp;gt; list = new ArrayList&amp;lt;TCell&amp;gt;(1); &lt;/p&gt;

&lt;p&gt;Otherwise, patch looks good to me Andrew.&lt;/p&gt;

&lt;p&gt;FYI, Kevin just branched thrift: &lt;a href=&quot;http://svn.apache.org/viewvc/incubator/thrift/branches/0.1.x/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/incubator/thrift/branches/0.1.x/&lt;/a&gt;  if you want to add that instead (Not important &amp;#8211; shouldn&apos;t hold up commit.  Just FYI)&lt;/p&gt;

&lt;p&gt;Discussion provoked by patch:&lt;/p&gt;

&lt;p&gt;On the convertions from Cell and Cell [] to Lists of TCells, I suppose there is no way to avoid this, even in the new stuff where we have lists of KeyValue (though KeyValue is nothing but a byte [] really).  If we could have KeyValue subclass &quot;byte []&quot; then we could pass the list of KeyValues to thrift &amp;#8211; but its not possible subclassing byte [].  I suppose no way to have thrift use KeyValue lists directly &amp;#8211; treat them as containers of byte []?&lt;/p&gt;</comment>
                            <comment id="12705935" author="apurtell" created="Tue, 5 May 2009 07:28:25 +0000"  >&lt;p&gt;Committed with edits suggested by stack. Thrift jar replaced with version from 0.1 branch (r771587). &lt;/p&gt;</comment>
                            <comment id="12706167" author="posix4e" created="Tue, 5 May 2009 19:22:35 +0000"  >&lt;p&gt;So I tried compiling thrift 0.1 off the branch, as I had a patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1286&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-1286&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;I wanted to update to 771587&lt;/p&gt;


&lt;p&gt;Now I get &lt;br/&gt;
2009-05-05 15:13:30,192 ERROR org.apache.thrift.server.TNonblockingServer: Read &lt;br/&gt;
an invalid frame size of -2147418111. Are you using TFramedTransport on the client side? in my thrift server logs&lt;/p&gt;

&lt;p&gt;Thrift: Tue May  5 15:20:50 2009 TSocket::read() recv() &amp;lt;Host: **** Port: 9090&amp;gt;Connection reset by peer&lt;br/&gt;
terminate called after throwing an instance of &apos;apache::thrift::transport::TTransportException&apos;&lt;br/&gt;
  what():  ECONNRESET&lt;/p&gt;

&lt;p&gt;Program received signal SIGABRT, Aborted.&lt;br/&gt;
0x0000003918e30215 in raise () from /lib64/libc.so.6&lt;/p&gt;

&lt;p&gt;#6  0x000000000053d6e4 in apache::thrift::transport::TSocket::read (&lt;br/&gt;
    this=0x7ccf90, buf=0xada35e0 &quot;\2004&#218;\n&quot;, len=&amp;lt;value optimized out&amp;gt;)&lt;br/&gt;
    at src/transport/TSocket.cpp:364&lt;br/&gt;
#7  0x0000000000540434 in apache::thrift::transport::TBufferedTransport::readSlow (this=0xada3580, buf=0x7fff3ce32510 &quot;&quot;, len=4)&lt;br/&gt;
    at src/transport/TBufferTransports.cpp:48&lt;br/&gt;
#8  0x0000000000454bdb in apache::thrift::transport::TTransport::readAll (&lt;br/&gt;
    this=0xada3580, buf=0x7fff3ce32510 &quot;&quot;, len=4)&lt;br/&gt;
    at /home/dev/build/third_party/64-rhel5/thrift/include/transport/TTransport.h:103&lt;br/&gt;
#9  0x000000000053ab0a in apache::thrift::protocol::TBinaryProtocol::readI32 (&lt;br/&gt;
    this=&amp;lt;value optimized out&amp;gt;, i32=@0x7fff3ce32554)&lt;br/&gt;
    at src/protocol/TBinaryProtocol.cpp:325&lt;br/&gt;
#10 0x000000000053b27c in apache::thrift::protocol::TBinaryProtocol::readMessageBegin (this=0x7da7, name=@0x7fff3ce32640, messageType=@0x6, &lt;br/&gt;
    seqid=@0xffffffffffffffff) at src/protocol/TBinaryProtocol.cpp:177&lt;br/&gt;
#11 0x000000000051bb24 in apache::hadoop::hbase::thrift::HbaseClient::recv_scannerOpenWithStop (this=0xada3a70) at src/Hbase.cpp:8889&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;Here was my patch&lt;br/&gt;
&lt;a href=&quot;http://pastebin.com/f1f413fd5&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://pastebin.com/f1f413fd5&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="12706172" author="apurtell" created="Tue, 5 May 2009 19:39:31 +0000"  >&lt;p&gt;The patch changed the server side to use TCompactProtocol, which uses TFramedTransport. Does that stacktrace show the client is using TBinaryProtocol and TBufferedTransport?&lt;/p&gt;</comment>
                            <comment id="12706179" author="posix4e" created="Tue, 5 May 2009 20:04:30 +0000"  >&lt;p&gt;    m_transport.reset(new TBufferedTransport(socket));&lt;br/&gt;
    boost::shared_ptr&amp;lt;TProtocol&amp;gt; protocol(new TBinaryProtocol(m_transport));&lt;/p&gt;
</comment>
                            <comment id="12706182" author="posix4e" created="Tue, 5 May 2009 20:10:08 +0000"  >&lt;p&gt;I switched it over to compact and Framed and I got&lt;br/&gt;
09/05/05 16:09:22 WARN server.TNonblockingServer: Got an IOException in internalRead!&lt;br/&gt;
java.io.IOException: Connection reset by peer&lt;br/&gt;
        at sun.nio.ch.FileDispatcher.read0(Native Method)&lt;br/&gt;
        at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:21)&lt;br/&gt;
        at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:233)&lt;br/&gt;
        at sun.nio.ch.IOUtil.read(IOUtil.java:206)&lt;br/&gt;
        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:236)&lt;br/&gt;
        at org.apache.thrift.transport.TNonblockingSocket.read(TNonblockingSocket.java:154)&lt;br/&gt;
        at org.apache.thrift.server.TNonblockingServer$FrameBuffer.internalRead(TNonblockingServer.java:719)&lt;br/&gt;
        at org.apache.thrift.server.TNonblockingServer$FrameBuffer.read(TNonblockingServer.java:505)&lt;/p&gt;

&lt;p&gt;although that may not be related, as it doesn&apos;t happen everytime I try to do a read.&lt;br/&gt;
#0  0x0000003918e30215 in raise () from /lib64/libc.so.6&lt;br/&gt;
#1  0x0000003918e31cc0 in abort () from /lib64/libc.so.6&lt;br/&gt;
#2  0x000000391aebec44 in _&lt;em&gt;gnu_cxx::&lt;/em&gt;_verbose_terminate_handler ()&lt;br/&gt;
   from /usr/lib64/libstdc++.so.6&lt;br/&gt;
#3  0x000000391aebcdb6 in ?? () from /usr/lib64/libstdc++.so.6&lt;br/&gt;
#4  0x000000391aebcde3 in std::terminate () from /usr/lib64/libstdc++.so.6&lt;br/&gt;
#5  0x000000391aebceca in __cxa_throw () from /usr/lib64/libstdc++.so.6&lt;br/&gt;
#6  0x0000000000552391 in apache::hadoop::hbase::thrift::HbaseClient::recv_scannerOpenWithStop (this=0xc015020) at src/Hbase.cpp:8920&lt;br/&gt;
#7  0x000000000055256b in apache::hadoop::hbase::thrift::HbaseClient::scannerOpenWithStop (this=0xc015020, tableName=@0x7fffc7b9ddd0,&lt;br/&gt;
    startRow=@0x7fffc7b9e220, stopRow=@0x7fffc7b9e228, columns=@0x7fffc7b9dd80)&lt;br/&gt;
    at src/Hbase.cpp:8862&lt;/p&gt;


&lt;p&gt;        at org.apache.thrift.server.TNonblockingServer$SelectThread.handleRead(TNonblockingServer.java:409)&lt;br/&gt;
        at org.apache.thrift.server.TNonblockingServer$SelectThread.select(TNonblockingServer.java:354)&lt;br/&gt;
        at org.apache.thrift.server.TNonblockingServer$SelectThread.run(TNonblockingServer.java:298)&lt;/p&gt;

&lt;p&gt;We also might want to update the example code.&lt;/p&gt;</comment>
                            <comment id="12706186" author="apurtell" created="Tue, 5 May 2009 20:35:32 +0000"  >&lt;p&gt;@Alex: Is compact/framed working for you or should that change be reverted?&lt;/p&gt;</comment>
                            <comment id="12706187" author="posix4e" created="Tue, 5 May 2009 20:37:05 +0000"  >&lt;p&gt;The error above is what I get with compact/framed&lt;/p&gt;</comment>
                            <comment id="12706191" author="euphoria" created="Tue, 5 May 2009 20:50:41 +0000"  >&lt;p&gt;For what it&apos;s worth, compact/framed will not work for me.  I think it should be used for performance testing and for internal use, but using compact/framed effectively limits you to only C++, Java, and Ruby.  This severely limits the utility of using Thrift (for instance, C# and Python are my target languages for HBase).  All of Thrift&apos;s languages support the TBinaryProtocol, only those three support the TCompactProtocol (though more are being worked on, they&apos;re just not there yet).&lt;/p&gt;</comment>
                            <comment id="12706193" author="posix4e" created="Tue, 5 May 2009 20:56:02 +0000"  >&lt;p&gt;Agreed python support is very important to us.&lt;/p&gt;</comment>
                            <comment id="12706204" author="apurtell" created="Tue, 5 May 2009 21:32:33 +0000"  >&lt;p&gt;I will commit a revert back to the handler/processor/server combination from before as soon as svn.apache.org is reachable again. That change to compact/framed was too aggressive. Thanks for the advice. &lt;/p&gt;

&lt;p&gt;Alex Newman tested patch and confirmed it fixed his issues.&lt;/p&gt;</comment>
                            <comment id="12706215" author="apurtell" created="Tue, 5 May 2009 21:45:40 +0000"  >&lt;p&gt;Committed partial revert as r771977&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12401641">HBASE-794</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12407196" name="hbase-1367-1.patch.gz" size="48305" author="apurtell" created="Tue, 5 May 2009 00:04:15 +0000"/>
                            <attachment id="12407282" name="hbase-1367-2.patch" size="1779" author="apurtell" created="Tue, 5 May 2009 21:35:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 4 May 2009 21:57:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32107</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 33 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hctj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99339</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>