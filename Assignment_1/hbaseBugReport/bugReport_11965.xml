<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:28:20 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11965/HBASE-11965.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11965] Optimize locking in HRegion</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11965</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Described in this thread:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/hbase-dev/201409.mbox/%3CCAAg3a2qmWJtQbdAk7PrX%2BW8SZWxsYhNggM5f2RNkGTXUri34YQ%40mail.gmail.com%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/hbase-dev/201409.mbox/%3CCAAg3a2qmWJtQbdAk7PrX%2BW8SZWxsYhNggM5f2RNkGTXUri34YQ%40mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;startRegionOperation&lt;/b&gt; and &lt;b&gt;closeRegionOperation&lt;/b&gt; in HRegion acquires and releases region-wide lock. The locking happens for every mutation, read and scan next. This is a serious bottleneck if we do:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Mutli - get on a same region.&lt;/li&gt;
	&lt;li&gt;Run multiple scanners on same region.&lt;/li&gt;
	&lt;li&gt;Do scan during compaction.&lt;/li&gt;
	&lt;li&gt;Access region simultaneously from different threads (most generic case)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12741142">HBASE-11965</key>
            <summary>Optimize locking in HRegion</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="vrodionov">Vladimir Rodionov</assignee>
                                    <reporter username="vrodionov">Vladimir Rodionov</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Sep 2014 19:07:12 +0000</created>
                <updated>Fri, 12 Sep 2014 23:19:53 +0000</updated>
                                                                            <component>Performance</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="14132227" author="jinghe" created="Fri, 12 Sep 2014 22:29:48 +0000"  >&lt;p&gt;Trying to understand the bottleneck for the cases you mentioned.&lt;br/&gt;
Won&apos;t they only be acquiring region read lock, and concurrent read locks are allowed? &lt;/p&gt;</comment>
                            <comment id="14132269" author="vrodionov" created="Fri, 12 Sep 2014 23:06:43 +0000"  >&lt;p&gt;Yes and no. First of all, this is not the only synchronization point in RegionScannerImpl. It has synchronized block in constructor. Second of all, acquiring/releasing read lock is not free, of course. Third of all, combination of &lt;b&gt;startRegionOperation&lt;/b&gt;/&lt;b&gt;closeRegionOperation&lt;/b&gt; is heavy not only because of locking - there are at least two objects instantiated &lt;b&gt;new RegionOperation()&lt;/b&gt;. Multi-treaded object allocation in Java is still a hot research area.&lt;/p&gt;

&lt;p&gt;And last one... All mutations on a region will be blocked until last read lock released. Bad.  &lt;/p&gt;

</comment>
                            <comment id="14132274" author="vrodionov" created="Fri, 12 Sep 2014 23:10:35 +0000"  >&lt;blockquote&gt;
&lt;p&gt;And last one... All mutations on a region will be blocked until last read lock released. Bad.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Correction - batch mutations. &lt;/p&gt;</comment>
                            <comment id="14132287" author="vrodionov" created="Fri, 12 Sep 2014 23:19:53 +0000"  >&lt;blockquote&gt;
&lt;p&gt; All mutations on a region will be blocked until last read lock released. Bad.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No, that is not true.  Write locks are only acquired during bulkHFileLoad. Anyway, there are still a lot of room for improvement, especially in Gets, Multi gets and scan next op.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Sep 2014 22:29:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 13 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1zzlz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>