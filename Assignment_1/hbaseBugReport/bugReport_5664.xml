<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:29:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5664/HBASE-5664.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5664] CP hooks in Scan flow for fast forward when filter filters out a row</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5664</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In HRegion.nextInternal(int limit, String metric)&lt;br/&gt;
	We have while(true) loop so as to fetch a next result which satisfies filter condition. When Filter filters out the current fetched row we call nextRow(byte [] currentRow) before going with the next row.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (results.isEmpty() || filterRow()) {
            &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; seems like a redundant step - we already consumed the row
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// there&apos;re no left overs.
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// the reasons &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; calling &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; method are:
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// 1. reset the filters.
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// 2. provide a hook to fast forward the row (used by subclasses)
&lt;/span&gt;            nextRow(currentRow);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;// 2. provide a hook to fast forward the row (used by subclasses)&lt;br/&gt;
We can provide same feature of fast forward support for the CP also.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12548489">HBASE-5664</key>
            <summary>CP hooks in Scan flow for fast forward when filter filters out a row</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anoopsamjohn">Anoop Sam John</assignee>
                                    <reporter username="anoopsamjohn">Anoop Sam John</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Mar 2012 13:29:25 +0000</created>
                <updated>Tue, 26 Feb 2013 08:27:10 +0000</updated>
                            <resolved>Sat, 2 Feb 2013 04:47:09 +0000</resolved>
                                    <version>0.92.1</version>
                                    <fixVersion>0.94.5</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                    <component>Coprocessors</component>
                    <component>Filters</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13242047" author="anoopsamjohn" created="Fri, 30 Mar 2012 04:17:17 +0000"  >&lt;p&gt;Previously seeking was not possible on the RegionScanner. Now with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5520&quot; title=&quot;Support reseek() at RegionScanner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5520&quot;&gt;&lt;del&gt;HBASE-5520&lt;/del&gt;&lt;/a&gt; CP can do a fast forward with reseek() on RegionScanner.&lt;br/&gt;
Use case of this new hook&lt;/p&gt;</comment>
                            <comment id="13242048" author="anoopsamjohn" created="Fri, 30 Mar 2012 04:19:00 +0000"  >&lt;p&gt;Previosly there was no use to give CP hook as there were no seek available in RegionScanner. Now with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5520&quot; title=&quot;Support reseek() at RegionScanner&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5520&quot;&gt;&lt;del&gt;HBASE-5520&lt;/del&gt;&lt;/a&gt; reseek() is provided in RegionScanner, which the CP hook can use for fast forward.&lt;/p&gt;</comment>
                            <comment id="13465428" author="anoopsamjohn" created="Fri, 28 Sep 2012 06:42:55 +0000"  >&lt;p&gt;This can be useful when the secondary index implementation is done. &lt;span class=&quot;error&quot;&gt;&amp;#91;HBASE-2038?&amp;#93;&lt;/span&gt;&lt;br/&gt;
Suppose we have 2 conditions on the scan based on 2 columns. Only we have one index on the 1st column. This index can give me some rowkeys. Using a wrapper for the RegionScanner and using reseek() I can seek to correct rows. Now after data fetch the filter needs to be applied on that as the second column condition check also to happen. And here if this check filters out the row we need to make a seek to the next row as found from the index data(which is on the one column)&lt;br/&gt;
In HRegion#nextInternal(int limit) we have&lt;br/&gt;
while (true) {&lt;br/&gt;
....&lt;br/&gt;
if (results.isEmpty() || filterRow()) &lt;/p&gt;
{
            // this seems like a redundant step - we already consumed the row
            // there&apos;re no left overs.
            // the reasons for calling this method are:
            // 1. reset the filters.
            // 2. provide a hook to fast forward the row (used by subclasses)
            boolean moreRows = nextRow(currentRow);
			...
}
&lt;p&gt;My idea is to give a CP hook here so that from that user can make a reseek()&lt;br/&gt;
Otherwise the normal code flow while() loop will take the next row from the table and apply filter and so on and we wont get the advantage of the index data&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.purtell%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;andrew.purtell@gmail.com&quot;&gt;Andrew Purtell&lt;/a&gt; Can you please comment on this?&lt;/p&gt;

&lt;p&gt;We have a patch for this adding the new hook which we have used internally&lt;/p&gt;</comment>
                            <comment id="13465433" author="ram_krish" created="Fri, 28 Sep 2012 06:53:13 +0000"  >&lt;p&gt;@Anoop&lt;br/&gt;
In &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6577&quot; title=&quot;RegionScannerImpl.nextRow() should seek to next row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6577&quot;&gt;&lt;del&gt;HBASE-6577&lt;/del&gt;&lt;/a&gt; see Lars comment&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6577?focusedCommentId=13433898&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13433898&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-6577?focusedCommentId=13433898&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13433898&lt;/a&gt;.  &lt;br/&gt;
Anyway we can try to get this in as we are using the new hook internally in our version based on consent from others.&lt;/p&gt;</comment>
                            <comment id="13465651" author="ram_krish" created="Fri, 28 Sep 2012 15:01:07 +0000"  >&lt;p&gt;@Lars&lt;br/&gt;
Anoop has clearly mentioned the scenario.  When i commented about this in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6577&quot; title=&quot;RegionScannerImpl.nextRow() should seek to next row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6577&quot;&gt;&lt;del&gt;HBASE-6577&lt;/del&gt;&lt;/a&gt; i did not mention the usecase where we are trying to add such hooks.&lt;br/&gt;
Here we are ideally not doing the forwarding that is done by the Scans, whereas it is something we leave it to the CP to decide on what to reseek rather than we reseeking on the kernel like in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6577&quot; title=&quot;RegionScannerImpl.nextRow() should seek to next row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6577&quot;&gt;&lt;del&gt;HBASE-6577&lt;/del&gt;&lt;/a&gt;. This hook is really useful for us.&lt;/p&gt;</comment>
                            <comment id="13540312" author="anoopsamjohn" created="Fri, 28 Dec 2012 05:17:24 +0000"  >&lt;p&gt;This is needed in the Secondary index solution&lt;br/&gt;
The scenario is as below&lt;br/&gt;
Having 2 conditions in FilterList with MUST_PASS_ALL&lt;br/&gt;
One SCVF on column cf1:c1 and another scvf on column cf1:c2&lt;br/&gt;
Suppose there is only one index on column cf1:c1&lt;br/&gt;
Now based on the data got from the index table we will seek to the exact row where cf1:c1=?. But dont know what is the value of cf1:c2 there in that row.&lt;br/&gt;
Now the second filter may filter out this row.&lt;br/&gt;
As per the logic in HRegion.nextInternal() it will start a loop there and taking next row onwards till finding a row satisfying both conditions&lt;/p&gt;

&lt;p&gt;Now as the condition in FL is MUST_PASS_ALL, there is no point in continuing with all the rows. The next row satisfying the condition on column cf1:c1 , we can know from the index data and so we can make a seek to that row directly and check that.&lt;/p&gt;

&lt;p&gt;Now there is no way to do so. It will be good to provide a CP hook for this so that within that hook I can reseek to the exact row key.&lt;/p&gt;</comment>
                            <comment id="13540334" author="lhofhansl" created="Fri, 28 Dec 2012 05:51:03 +0000"  >&lt;p&gt;As long as the reseek is optional it&apos;s fine, I think.&lt;br/&gt;
A (re)seek() is potentially &lt;b&gt;much&lt;/b&gt; slower than just a next(). So when the next row is only a few next()&apos;s away replacing that with (re)seek() can have disastrous performance effects (as seen in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6577&quot; title=&quot;RegionScannerImpl.nextRow() should seek to next row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6577&quot;&gt;&lt;del&gt;HBASE-6577&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="13540351" author="anoopsamjohn" created="Fri, 28 Dec 2012 06:11:45 +0000"  >&lt;p&gt;Yes in core we do not do any seek to the next row(as in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6577&quot; title=&quot;RegionScannerImpl.nextRow() should seek to next row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6577&quot;&gt;&lt;del&gt;HBASE-6577&lt;/del&gt;&lt;/a&gt;)&lt;br/&gt;
This is just a hook so that an implementation like sec index can make use of this.&lt;/p&gt;

&lt;p&gt;// 2. provide a hook to fast forward the row (used by subclasses)&lt;br/&gt;
 nextRow(currentRow);&lt;/p&gt;

&lt;p&gt;The above comment in the code says calling nextRow() can potentially give a way for fast forwarding. But not sure how to make use. The RegionScannerImpl is not a public class and so can not be subclassed. We can only wrap this obj. So I felt new hook is the only way.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.purtell%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;andrew.purtell@gmail.com&quot;&gt;Andrew Purtell&lt;/a&gt; You have some comments/suggestion ?&lt;/p&gt;</comment>
                            <comment id="13541965" author="apurtell" created="Wed, 2 Jan 2013 01:37:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoopsamjohn&quot; class=&quot;user-hover&quot; rel=&quot;anoopsamjohn&quot;&gt;Anoop Sam John&lt;/a&gt; Sounds ok given your reasoning but do you have a patch we can look at?&lt;/p&gt;</comment>
                            <comment id="13542734" author="anoopsamjohn" created="Thu, 3 Jan 2013 05:58:34 +0000"  >&lt;p&gt;I will upload a patch based on the 94 branch soon.. &lt;/p&gt;</comment>
                            <comment id="13543725" author="anoopsamjohn" created="Fri, 4 Jan 2013 09:14:59 +0000"  >&lt;p&gt;Internal patch that we had, ported to the latest 94 branch. Pls give your comments.&lt;/p&gt;</comment>
                            <comment id="13544069" author="yuzhihong@gmail.com" created="Fri, 4 Jan 2013 17:54:56 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        hasMore = ((RegionObserver) env.getInstance()).postScannerFilterRow(ctx, s, currentRow,
+            hasMore);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;What if RegionObserver1 returns false for hasMore and then RegionObserver2 returns true for hasMore ?&lt;/p&gt;</comment>
                            <comment id="13544607" author="anoopsamjohn" created="Sat, 5 Jan 2013 06:49:52 +0000"  >&lt;p&gt;I think in a scenario where there are more than one CP implementation dealing with this hook, better the hook handle what was returned by the previous hook..  That is why I am passing the current value of the hasMore flag to the CP hook itself..  So if a previous one returned hasMore as false, may be the next one do not do any work and just return false ??&lt;/p&gt;</comment>
                            <comment id="13549262" author="apurtell" created="Thu, 10 Jan 2013 01:03:01 +0000"  >&lt;blockquote&gt;&lt;p&gt;Internal patch that we had, ported to the latest 94 branch. Pls give your comments.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It looks plausible to me. The new hook is only called once per row. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;What if RegionObserver1 returns false for hasMore and then RegionObserver2 returns true for hasMore ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This kind of chaining is a typical pattern for CP hooks. CPs and the users who use them have to deal with that in current framework design.&lt;/p&gt;</comment>
                            <comment id="13549342" author="anoopsamjohn" created="Thu, 10 Jan 2013 03:51:10 +0000"  >&lt;p&gt;Andrew I can go with making a patch for trunk? Trunk this area of code had undergone some changes. I will have a look at it. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The new hook is only called once per row.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes dont think we need pre/post thing&lt;/p&gt;</comment>
                            <comment id="13558912" author="anoopsamjohn" created="Mon, 21 Jan 2013 17:05:53 +0000"  >&lt;p&gt;Patch for Trunk. Let me try against HadoopQA&lt;/p&gt;</comment>
                            <comment id="13558937" author="yuzhihong@gmail.com" created="Mon, 21 Jan 2013 17:45:43 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Returns whether more rows are available &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the scanner or not.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Remove &apos;Returns&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    RegionScannerImpl(Scan scan, List&amp;lt;KeyValueScanner&amp;gt; additionalScanners, HRegion region) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Wrap long line above.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * @param s
+   * @param currentRow
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;
+   * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
+   */
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; postScannerFilterRow(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; InternalScanner s, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] currentRow)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please complete javadoc.&lt;/p&gt;

&lt;p&gt;See if the test failures in TestFromClientSideWithCoprocessor and TestFromClientSide are related to this patch.&lt;/p&gt;</comment>
                            <comment id="13558942" author="hadoopqa" created="Mon, 21 Jan 2013 18:06:04 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12565809/HBASE-5664_Trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12565809/HBASE-5664_Trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 1 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces lines longer than 100&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.security.access.TestAccessController&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestFromClientSideWithCoprocessor&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestRowProcessorEndpoint&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestFromClientSide&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestAggregateProtocol&lt;br/&gt;
                  org.apache.hadoop.hbase.TestLocalHBaseCluster&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4109//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13559376" author="anoopsamjohn" created="Tue, 22 Jan 2013 04:03:30 +0000"  >&lt;p&gt;Thanks Ted.&lt;br/&gt;
Let me see the failures&lt;/p&gt;</comment>
                            <comment id="13559418" author="anoopsamjohn" created="Tue, 22 Jan 2013 06:04:25 +0000"  >&lt;p&gt;Oops!  Missed the instanceof check in RegionCoprocessorHost..I will attach both the version patches after correcting this issue.&lt;br/&gt;
Internally we were adding the new hooks to another interface other than RegionObserver. In our code the instance of check was against this new interface. I removed that (While creating the patch) but forgot to add the original instanceof check which is needed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13559803" author="yuzhihong@gmail.com" created="Tue, 22 Jan 2013 17:45:16 +0000"  >&lt;p&gt;Patch v2 looks good.&lt;/p&gt;

&lt;p&gt;Please add release notes.&lt;/p&gt;</comment>
                            <comment id="13559814" author="hadoopqa" created="Tue, 22 Jan 2013 17:59:16 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12565967/HBASE-5664_Trunk_V2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12565967/HBASE-5664_Trunk_V2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to introduce 3 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.TestLocalHBaseCluster&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4125//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13560560" author="anoopsamjohn" created="Wed, 23 Jan 2013 11:04:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt; Comments from your side?&lt;/p&gt;</comment>
                            <comment id="13561170" author="apurtell" created="Wed, 23 Jan 2013 22:26:15 +0000"  >&lt;p&gt;+1 if this is what you need Anoop.&lt;/p&gt;</comment>
                            <comment id="13561203" author="yuzhihong@gmail.com" created="Wed, 23 Jan 2013 23:03:31 +0000"  >&lt;p&gt;Integrated to trunk.&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Anoop.&lt;/p&gt;

&lt;p&gt;Thanks for the review, Andy.&lt;/p&gt;</comment>
                            <comment id="13561249" author="hudson" created="Wed, 23 Jan 2013 23:52:33 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #369 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/369/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/369/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5664&quot; title=&quot;CP hooks in Scan flow for fast forward when filter filters out a row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5664&quot;&gt;&lt;del&gt;HBASE-5664&lt;/del&gt;&lt;/a&gt; CP hooks in Scan flow for fast forward when filter filters out a row (Anoop) (Revision 1437790)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/RegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RegionCoprocessorHost.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13561294" author="hudson" created="Thu, 24 Jan 2013 00:54:44 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3786 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3786/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3786/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5664&quot; title=&quot;CP hooks in Scan flow for fast forward when filter filters out a row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5664&quot;&gt;&lt;del&gt;HBASE-5664&lt;/del&gt;&lt;/a&gt; CP hooks in Scan flow for fast forward when filter filters out a row (Anoop) (Revision 1437790)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/coprocessor/RegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/RegionCoprocessorHost.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13561422" author="anoopsamjohn" created="Thu, 24 Jan 2013 04:55:24 +0000"  >&lt;p&gt;Ted &amp;amp; Lars This is can be added in 0.94 also?&lt;br/&gt;
Once it is finalized can change the fix version (if needed) and close the issue.&lt;/p&gt;</comment>
                            <comment id="13562330" author="anoopsamjohn" created="Fri, 25 Jan 2013 03:30:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; Can we integrate this to 0.94? &lt;br/&gt;
Once it is finalized can change the fix version (if needed) and close the issue.&lt;/p&gt;</comment>
                            <comment id="13562459" author="lhofhansl" created="Fri, 25 Jan 2013 06:18:36 +0000"  >&lt;p&gt;I was trying to play with the patch in 0.94 and do some performance tests, but it doesn&apos;t apply anymore.&lt;/p&gt;</comment>
                            <comment id="13562468" author="anoopsamjohn" created="Fri, 25 Jan 2013 06:48:57 +0000"  >&lt;p&gt;Oh..  I will rebase the patch then.&lt;/p&gt;</comment>
                            <comment id="13563376" author="anoopsamjohn" created="Sat, 26 Jan 2013 05:56:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; Patch rebased. Pls try with this.&lt;/p&gt;</comment>
                            <comment id="13563380" author="hadoopqa" created="Sat, 26 Jan 2013 06:02:03 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12566616/HBASE-5664_94_V3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12566616/HBASE-5664_94_V3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4197//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4197//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13563763" author="lhofhansl" created="Sun, 27 Jan 2013 08:07:50 +0000"  >&lt;p&gt;Thanks Anoop. Will do as soon as I get to it (the next two days or so)&lt;/p&gt;</comment>
                            <comment id="13566214" author="lhofhansl" created="Wed, 30 Jan 2013 06:31:05 +0000"  >&lt;p&gt;So when scanning 10m rows with 1 col each, with scanner caching set to 10000, I can detect a 5-10% slowdown with this patch.&lt;/p&gt;</comment>
                            <comment id="13566216" author="lhofhansl" created="Wed, 30 Jan 2013 06:33:05 +0000"  >&lt;p&gt;With all data in the blockcache as well. So together this should be the worst case scenario for this change.&lt;/p&gt;</comment>
                            <comment id="13566217" author="anoopsamjohn" created="Wed, 30 Jan 2013 06:35:36 +0000"  >&lt;p&gt;Thanks Lars for the test.&lt;br/&gt;
You mean in your test there is filtering happening on rows?&lt;br/&gt;
I am not fully getting ur test case.&lt;/p&gt;</comment>
                            <comment id="13566220" author="lhofhansl" created="Wed, 30 Jan 2013 06:38:26 +0000"  >&lt;p&gt;Just scanning without any filtering. Takes ~20s without this patch and ~22s with this patch.&lt;/p&gt;

&lt;p&gt;A question I had: Why do you need to do this skipping via a coprocessor? Would a filter not work?&lt;/p&gt;</comment>
                            <comment id="13566224" author="anoopsamjohn" created="Wed, 30 Jan 2013 06:47:25 +0000"  >&lt;blockquote&gt;&lt;p&gt;Just scanning without any filtering.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That looks strange Lars. The new code will come into picture only when there is some filtering happens. Otherwise in your test flow of Scan absolutely no addition of code. Am I missing some thing?&lt;/p&gt;</comment>
                            <comment id="13566227" author="lhofhansl" created="Wed, 30 Jan 2013 06:54:13 +0000"  >&lt;p&gt;Nope. It always executes the check for the coprocessor through the coprocessorhost in the next() method, that does make a difference; at least in this extreme scenario.&lt;/p&gt;

&lt;p&gt;Not saying we shouldn&apos;t do it, just saying that it comes with a price in the general scanning code.&lt;/p&gt;

&lt;p&gt;Also, looking at the patch again, we&apos;re not actually filtering rows, but ending the scan, right?&lt;br/&gt;
So the coprocessor hook is misnamed.&lt;/p&gt;</comment>
                            <comment id="13566279" author="anoopsamjohn" created="Wed, 30 Jan 2013 08:15:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;br/&gt;
The new CP call is in nextRow(byte [] currentRow, int offset, short length)&lt;br/&gt;
This method is called only when a row is filtered out.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filterRowKey(currentRow, offset, length)) {
-            nextRow(currentRow, offset, length);
+            &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; moreRows = nextRow(currentRow, offset, length);

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isEmptyRow || filterRow()) {
-            nextRow(currentRow, offset, length);
+            &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; moreRows = nextRow(currentRow, offset, length);

&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (results.isEmpty()) {
-          nextRow(currentRow, offset, length);
+          &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; moreRows = nextRow(currentRow, offset, length);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So in a normal scan how this will affect? Sorry if I am missing some thing. I really not getting..&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Also, looking at the patch again, we&apos;re not actually filtering rows, but ending the scan, right?&lt;br/&gt;
So the coprocessor hook is misnamed.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The hook is for notifying some row is filtered out. This is for the purpose of doing a fast forward rather than a normal go to next row. So by this fast forward some time CP implementation can see no more rows remaining in this region and that is why it returns a boolean to indicate that. If the CP says no more rows, the scan ends there&lt;/p&gt;</comment>
                            <comment id="13567450" author="lhofhansl" created="Thu, 31 Jan 2013 08:10:16 +0000"  >&lt;p&gt;Hmm... Yes. Maybe something else slowed it down. Lemme try again.&lt;/p&gt;</comment>
                            <comment id="13567557" author="anoopsamjohn" created="Thu, 31 Jan 2013 11:24:36 +0000"  >&lt;p&gt;Thanks Lars. Yes the performance degrade in your test looks strange.&lt;br/&gt;
This patch not adding up any extra lines in the normal scan path.&lt;/p&gt;</comment>
                            <comment id="13569424" author="lhofhansl" created="Sat, 2 Feb 2013 04:45:32 +0000"  >&lt;p&gt;OK... Redid the test with exact same versions of HBase (+- the patch).&lt;br/&gt;
No penalty measurable. Going to commit.&lt;/p&gt;</comment>
                            <comment id="13569425" author="lhofhansl" created="Sat, 2 Feb 2013 04:47:09 +0000"  >&lt;p&gt;Thanks for patience Anoop &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13569437" author="anoopsamjohn" created="Sat, 2 Feb 2013 05:49:39 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yuzhihong%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yuzhihong@gmail.com&quot;&gt;Ted Yu&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt; for your reviews and comments&lt;/p&gt;</comment>
                            <comment id="13569469" author="hudson" created="Sat, 2 Feb 2013 08:09:06 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #106 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/106/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/106/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5664&quot; title=&quot;CP hooks in Scan flow for fast forward when filter filters out a row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5664&quot;&gt;&lt;del&gt;HBASE-5664&lt;/del&gt;&lt;/a&gt; CP hooks in Scan flow for fast forward when filter filters out a row (Anoop Sam John) (Revision 1441701)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/RegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/RegionCoprocessorHost.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13570989" author="hudson" created="Tue, 5 Feb 2013 03:58:28 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #11 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/11/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/11/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5664&quot; title=&quot;CP hooks in Scan flow for fast forward when filter filters out a row&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5664&quot;&gt;&lt;del&gt;HBASE-5664&lt;/del&gt;&lt;/a&gt; CP hooks in Scan flow for fast forward when filter filters out a row (Anoop Sam John) (Revision 1441701)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/BaseRegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/coprocessor/RegionObserver.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/RegionCoprocessorHost.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12563267" name="HBASE-5664_94.patch" size="6918" author="anoopsamjohn" created="Fri, 4 Jan 2013 09:14:59 +0000"/>
                            <attachment id="12565965" name="HBASE-5664_94_V2.patch" size="7707" author="anoopsamjohn" created="Tue, 22 Jan 2013 16:51:20 +0000"/>
                            <attachment id="12566616" name="HBASE-5664_94_V3.patch" size="7656" author="anoopsamjohn" created="Sat, 26 Jan 2013 05:56:38 +0000"/>
                            <attachment id="12565809" name="HBASE-5664_Trunk.patch" size="7547" author="anoopsamjohn" created="Mon, 21 Jan 2013 17:05:53 +0000"/>
                            <attachment id="12565967" name="HBASE-5664_Trunk_V2.patch" size="7912" author="anoopsamjohn" created="Tue, 22 Jan 2013 16:53:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 28 Sep 2012 06:53:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233586</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 45 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02err:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11994</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>This adds a new CP hook in RegionObserver , postScannerFilterRow()&lt;br/&gt;
This will be called by the scan flow when the current scanned row is being filtered out by the filter.&lt;br/&gt;
The filter may be filtering out the row via any of the below scenarios&lt;br/&gt;
1. Filter&amp;#39;s filterRowKey(byte [] buffer, int offset, int length) returning true so as to exclude this row&lt;br/&gt;
2. At the end of the row scan filter&amp;#39;s filterRow() returning true&lt;br/&gt;
3. Filter&amp;#39;s filterRow(List&amp;lt;KeyValue&amp;gt; kvs) removing all the kvs from the passed List making the full row to be filtered out&lt;br/&gt;
&lt;br/&gt;
This hook can be used for doing a fast forward in such a case if the user wants to do so. One can use RegionScanner#reseek(byte[] row) for doing this fast forward&lt;br/&gt;
</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>