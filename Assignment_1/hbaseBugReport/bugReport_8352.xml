<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:54:25 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8352/HBASE-8352.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8352] Rename &apos;.snapshot&apos; directory</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8352</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Testing HBase Snapshot on top of Hadoop&apos;s Snapshot branch (&lt;a href=&quot;http://svn.apache.org/viewvc/hadoop/common/branches/HDFS-2802/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/hadoop/common/branches/HDFS-2802/&lt;/a&gt;), we found that both features used &apos;.snapshot&apos; directory to store metadata.&lt;/p&gt;

&lt;p&gt;HDFS (built from &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-2802&quot; title=&quot;Support for RW/RO snapshots in HDFS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-2802&quot;&gt;&lt;del&gt;HDFS-2802&lt;/del&gt;&lt;/a&gt; branch) doesn&apos;t allow paths with .snapshot as a component&lt;/p&gt;

&lt;p&gt;From discussion on dev@hbase.apache.org, (see &lt;a href=&quot;http://search-hadoop.com/m/kY6C3cXMs51&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://search-hadoop.com/m/kY6C3cXMs51&lt;/a&gt;), consensus was to rename &apos;.snapshot&apos; directory in HBase so that both features can co-exist smoothly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12642663">HBASE-8352</key>
            <summary>Rename &apos;.snapshot&apos; directory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuzhihong@gmail.com">Ted Yu</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Apr 2013 06:10:01 +0000</created>
                <updated>Sat, 27 Apr 2013 15:55:21 +0000</updated>
                            <resolved>Wed, 17 Apr 2013 00:14:09 +0000</resolved>
                                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.94.7</fixVersion>
                    <fixVersion>0.95.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                <comments>
                            <comment id="13632613" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 06:13:53 +0000"  >&lt;p&gt;Patch v1 for 0.94 branch.&lt;/p&gt;

&lt;p&gt;Test suite passed.&lt;/p&gt;

&lt;p&gt;Please provide your comments.&lt;/p&gt;</comment>
                            <comment id="13632888" author="lhofhansl" created="Tue, 16 Apr 2013 14:47:55 +0000"  >&lt;p&gt;+1 on this approach and patch.&lt;/p&gt;

&lt;p&gt;(Making this configurable would be overkill, and entail a slew of other changes; it would also raise questions about all the other hardcoded directory names such .logs .oldlogs .archive, etc.&lt;br/&gt;
If we want to tackle those, I&apos;d suggest a different a jira.)&lt;/p&gt;</comment>
                            <comment id="13632895" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 14:52:44 +0000"  >&lt;blockquote&gt;&lt;p&gt;If we want to tackle those, I&apos;d suggest a different a jira.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Will attach trunk patch soon.&lt;/p&gt;</comment>
                            <comment id="13632912" author="mbertozzi" created="Tue, 16 Apr 2013 15:11:13 +0000"  >&lt;p&gt;The release note should highlight that you can&apos;t do rolling upgrade between 0.94.6 and 0.94.7 if you want to use snapshots, or better... if you want take a snapshot  all the RSs and Masters must be aligned to 0.94.7+ version&lt;/p&gt;</comment>
                            <comment id="13632926" author="jmhsieh" created="Tue, 16 Apr 2013 15:26:54 +0000"  >&lt;p&gt;-1 until we get the docs / release notes updated with proper upgrading instructions (with mention of rolling upgrade caveat, how to upgrade).  Alternately, the -1 goes away if a 0.94.7 blocker jira for docs with instructions for is filed.&lt;/p&gt;</comment>
                            <comment id="13632957" author="hadoopqa" created="Tue, 16 Apr 2013 16:16:51 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12578948/8352-trunk.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12578948/8352-trunk.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestFromClientSideWithCoprocessor&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5324//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13632959" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 16:17:13 +0000"  >&lt;p&gt;See if the updated release notes are better.&lt;/p&gt;</comment>
                            <comment id="13632964" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 16:21:38 +0000"  >&lt;p&gt;The test failure was not related to the patch:&lt;/p&gt;

&lt;p&gt;Running org.apache.hadoop.hbase.client.TestFromClientSideWithCoprocessor&lt;br/&gt;
2013-04-16 09:18:19.944 java&lt;span class=&quot;error&quot;&gt;&amp;#91;1050:1203&amp;#93;&lt;/span&gt; Unable to load realm info from SCDynamicStore&lt;br/&gt;
Tests run: 62, Failures: 0, Errors: 0, Skipped: 3, Time elapsed: 151.559 sec&lt;/p&gt;</comment>
                            <comment id="13632973" author="lhofhansl" created="Tue, 16 Apr 2013 16:26:34 +0000"  >&lt;p&gt;Can you draft something &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmhsieh&quot; class=&quot;user-hover&quot; rel=&quot;jmhsieh&quot;&gt;Jonathan Hsieh&lt;/a&gt; (otherwise we might go through unnecessary iterations)? You want doc and release notes? Or is either sufficient?&lt;/p&gt;

&lt;p&gt;Thinking now... Is there any way to make rolling upgrades work? Even making the snapshot dir configurable would not allow for that.&lt;br/&gt;
A possible option would be to allow 0.94.7 to read snapshots from both directories, and only phase out the old directory in 0.94.8... But even then, one couldn&apos;t perform a rolling upgrade from 0.94.6 to 0.94.8. Besides that would be a lot of work.&lt;/p&gt;

&lt;p&gt;It&apos;s a shame that for 99% of all users this will never become an issue (as they won&apos;t deploy 0.94 on top of Hadoop 2.1+). From that angle I can see the usefulness of making this configurable (then we&apos;d have to deal somehow with HBASE_NON_TABLE_DIRS).&lt;/p&gt;

&lt;p&gt;Blah, blah, blah &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ... Sorry, let&apos;s try to do a simple solution here.&lt;/p&gt;</comment>
                            <comment id="13632977" author="lhofhansl" created="Tue, 16 Apr 2013 16:28:44 +0000"  >&lt;p&gt;Hmm... Jon just pointed out on the dev list that HDFS snapshots are slated for 2.0.5.&lt;/p&gt;</comment>
                            <comment id="13632978" author="mbertozzi" created="Tue, 16 Apr 2013 16:29:13 +0000"  >&lt;p&gt;I think the upgrade procedure should be more like this:&lt;br/&gt;
(otherwise you&apos;re implying a stop the whole cluster)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1. make sure all on-going snapshots activities have completed 
2. shutdown all the masters and upgrade them to 0.94.7+ release 
3. rename &lt;span class=&quot;code-quote&quot;&gt;&quot;.snapshot&quot;&lt;/span&gt; under HBase root directory as &lt;span class=&quot;code-quote&quot;&gt;&quot;.hbase-snapshot&quot;&lt;/span&gt; 
(You now can perform clone or restore, but not taking snapshots)
4. upgrade the region servers
(You should not take snapshots until all the regions server are aligned to 0.94.7+ release)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13632983" author="mbertozzi" created="Tue, 16 Apr 2013 16:33:11 +0000"  >&lt;p&gt;forgot to say that if you take a snapshot during the RS upgrades nothing bad happen... you just end up with the .snapshot folder again, and the snapshot will fail since half of the data will be in .hbase-snapshot and the other half in .snapshot&lt;/p&gt;</comment>
                            <comment id="13632984" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 16:34:55 +0000"  >&lt;p&gt;Should order of steps #2 and #3 above be switched ?&lt;/p&gt;</comment>
                            <comment id="13633004" author="mbertozzi" created="Tue, 16 Apr 2013 16:48:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should order of steps #2 and #3 above be switched ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;yeah sort of I&apos;ve missed a start the master step after the rename but maybe is better in this way:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1. make sure all on-going snapshots activities have completed 
2. shutdown All the masters
3. rename &lt;span class=&quot;code-quote&quot;&gt;&quot;.snapshot&quot;&lt;/span&gt; under HBase root directory as &lt;span class=&quot;code-quote&quot;&gt;&quot;.hbase-snapshot&quot;&lt;/span&gt; 
4. upgrade the masters to 0.94.7+ release 
(You now can perform clone or restore, but not taking snapshots)
5. upgrade the region servers to 0.94.7+ release 
(You should not take snapshots until all the regions server are aligned to 0.94.7+ release)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13633019" author="lhofhansl" created="Tue, 16 Apr 2013 17:11:11 +0000"  >&lt;p&gt;Here&apos;s an option to make this configurable and still deal with HBASE_NON_TABLE_DIRS:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;We&apos;ll add a config option: hbase.snapshot.use_newdir, which would default to false in 0.94.&lt;/li&gt;
	&lt;li&gt;If hbase.snapshot.use_newdir is true we use .hbase_snapshot, if false we use .snapshot&lt;/li&gt;
	&lt;li&gt;We&apos;d add both .snapshot and .hbase_snapshot to HBASE_NON_TABLE_DIRS&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thoughts? Too much effort?&lt;/p&gt;</comment>
                            <comment id="13633024" author="jmhsieh" created="Tue, 16 Apr 2013 17:16:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;You want doc and release notes? Or is either sufficient?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good release notes is sufficient.  We&apos;ll get it done here.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is there any way to make rolling upgrades work? Even making the snapshot dir configurable would not allow for that.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I was thinking we need a &quot;version lock&quot; or &quot;upgrade lock&quot; to block certain operations while rolling upgrades or rolling restarts for config changes are happening.  Out of scope here though.&lt;/p&gt;
</comment>
                            <comment id="13633029" author="jmhsieh" created="Tue, 16 Apr 2013 17:20:34 +0000"  >&lt;p&gt;I like Matteo&apos;s latest version.&lt;/p&gt;

&lt;p&gt;Also, can we add some logging code that checks the .snapshot dir for dirs with .snapshotinfo&apos;s in them and warn with upgrade instructions in the logs?  I think it would provide a sufficient breadcrumb for those who don&apos;t read release notes (or a link to the release notes)?&lt;/p&gt;
</comment>
                            <comment id="13633034" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 17:25:02 +0000"  >&lt;blockquote&gt;&lt;p&gt;can we add some logging code that checks the .snapshot dir for dirs with .snapshotinfo&apos;s in them&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If 2.0.5-alpha is the underlying hdfs, I think accessing .snapshot dir would not be allowed.&lt;/p&gt;

&lt;p&gt;Here was sample output from CLI:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[hbase@ip-10-141-186-51 hbase]$ hadoop dfs -ls /apps/hbase/data/.snapshot
ls: Cannot access /apps/hbase/data/.snapshot: No such file or directory.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13633039" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 17:31:09 +0000"  >&lt;p&gt;w.r.t. Lars&apos; suggestion of introducing &apos;hbase.snapshot.use_newdir&apos; config parameter, I think we&apos;d better keep logic simple - considering HBase snapshots usage is in very early stage.&lt;/p&gt;</comment>
                            <comment id="13633043" author="jmhsieh" created="Tue, 16 Apr 2013 17:35:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;If hbase.snapshot.use_newdir is true we use .hbase_snapshot, if false we use .snapshot&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Since HDFS snapshots seems to have an api to enable it, we could query for that instead of introducing a new config.  We could also do a hadoop version check type query (if 1.x use old default, if 2.x use new).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We&apos;d add both .snapshot and .hbase_snapshot to HBASE_NON_TABLE_DIRS&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&amp;#43;1 to this in 0.94&amp;#43;.  Regardless of what fix we choose, preemptively doing this doesn&apos;t hurt.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Thoughts? Too much effort?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think if we put the warnings that show up in logs in, I&apos;ll be satisfied.&lt;/p&gt;</comment>
                            <comment id="13633053" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 17:39:58 +0000"  >&lt;p&gt;Trunk patch v2 adds &quot;.snapshot&quot; to HBASE_NON_TABLE_DIRS&lt;/p&gt;</comment>
                            <comment id="13633071" author="jmhsieh" created="Tue, 16 Apr 2013 17:44:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;If 2.0.5-alpha is the underlying hdfs, I think accessing .snapshot dir would not be allowed.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I thought hdfs snapshots dirs are readable and browseable just like normal dirs.  Only direct write operations would be blocked.  Is this incorrect?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;w.r.t. Lars&apos; suggestion of introducing &apos;hbase.snapshot.use_newdir&apos; config parameter, I think we&apos;d better keep logic simple - considering HBase snapshots usage is in very early stage.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree with keeping it simple, but I have to insist that dealing with compatibility is one of the consequences of backporting new features to stable releases.  Early or not it has been released in a stable apache hbase version.  &lt;/p&gt;</comment>
                            <comment id="13633074" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 17:49:21 +0000"  >&lt;p&gt;See release notes in &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-4666&quot; title=&quot;Disallow users to create file/dir named &amp;quot;.snapshot&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-4666&quot;&gt;&lt;del&gt;HDFS-4666&lt;/del&gt;&lt;/a&gt; for how &quot;.snapshot&quot; is handled by hdfs with snapshot capability.&lt;/p&gt;</comment>
                            <comment id="13633087" author="lhofhansl" created="Tue, 16 Apr 2013 17:57:10 +0000"  >&lt;p&gt;Release notes look good. +1 on v2.&lt;/p&gt;</comment>
                            <comment id="13633091" author="jmhsieh" created="Tue, 16 Apr 2013 17:59:45 +0000"  >&lt;p&gt;I&apos;m suggesting that for future 0.94&apos;s (0.94.7 let say) we print a warning if the original directory is used.  We decide to warn if hbase detects the .snapshot dir is being used to store hbase table snapshot metadata.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;See release notes in &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-4666&quot; title=&quot;Disallow users to create file/dir named &amp;quot;.snapshot&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-4666&quot;&gt;&lt;del&gt;HDFS-4666&lt;/del&gt;&lt;/a&gt; for how &quot;.snapshot&quot; is handled by hdfs with snapshot capability.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The release note doesn&apos;t say anything that would prevent the ls and potential read operations necessary to check and log.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-4666&quot; title=&quot;Disallow users to create file/dir named &amp;quot;.snapshot&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-4666&quot;&gt;&lt;del&gt;HDFS-4666&lt;/del&gt;&lt;/a&gt;&apos;s release note: &quot;This is an INCOMPATIBLE CHANGE: &quot;.snapshot&quot; becomes a reserved inode name so that users cannot create a file/directory with &quot;.snapshot&quot; as the name. If &quot;.snapshot&quot; is used in a previous version of HDFS, it must be renamed before upgrade; otherwise, upgrade will fail.&quot; &lt;/p&gt;

&lt;p&gt;HDFS upgrades failing because of existing .snapshot dirs is great.&lt;/p&gt;

&lt;p&gt;From HDFS snapshot design doc / admin usage:  &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12551474/Snapshots20121030.pdf&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12551474/Snapshots20121030.pdf&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Deleting a snapshot:
&amp;gt; rm -r &amp;lt;snapshottable_dir_path&amp;gt;/.snapshot/snapname
Listing all the snapshots:
&amp;gt; ls &amp;lt;snapshottable_dir_path&amp;gt;/.snapshot/
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can ls the .snapshot dir as if it were a normal dir.&lt;/p&gt;</comment>
                            <comment id="13633116" author="lhofhansl" created="Tue, 16 Apr 2013 18:14:01 +0000"  >&lt;p&gt;So you&apos;re good with the patch, Jon?&lt;/p&gt;</comment>
                            <comment id="13633122" author="jmhsieh" created="Tue, 16 Apr 2013 18:16:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;So you&apos;re good with the patch, Jon?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Let&apos;s add a warning to logs, and then I&apos;m fine with the approach.&lt;/p&gt;</comment>
                            <comment id="13633125" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 18:20:34 +0000"  >&lt;p&gt;Patch v2 has the following in checkSnapshotSupport():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fs.exists(oldSnapshotDir)) {
      LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Snapshots from an earlier release were found under: &quot;&lt;/span&gt; + oldSnapshotDir);
      LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Please rename the directory as &quot;&lt;/span&gt; + HConstants.SNAPSHOT_DIR_NAME);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;What additional warning should be added ?&lt;/p&gt;</comment>
                            <comment id="13633144" author="jmhsieh" created="Tue, 16 Apr 2013 18:33:19 +0000"  >&lt;p&gt;The insertion point in the code is correct but the fs.exists(oldSnapshotDir) check is not sufficient &amp;#8211; if hdfs snapshots is on, there will potentially be a .snapshot dir &quot;exists&quot; but that corresponds to the hdfs snapshot.  We need to go into the .snapshot dir and see if there are any .snapshotinfo files present one directory level deeper.&lt;/p&gt;

&lt;p&gt;See dir structure of a snapshot in &lt;a href=&quot;https://github.com/apache/hbase/blob/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotDescriptionUtils.java#L38&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hbase/blob/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/snapshot/SnapshotDescriptionUtils.java#L38&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13633159" author="enis" created="Tue, 16 Apr 2013 18:39:23 +0000"  >&lt;p&gt;Release notes seems good. There is a upgrade path from 0.94.6 to 0.96, which is not addressed. We can add to the upgrade section in the book about this as well. &lt;/p&gt;</comment>
                            <comment id="13633162" author="szetszwo" created="Tue, 16 Apr 2013 18:39:55 +0000"  >&lt;blockquote&gt;
&lt;p&gt;&amp;gt; If 2.0.5-alpha is the underlying hdfs, I think accessing .snapshot dir would not be allowed.&lt;/p&gt;

&lt;p&gt;I thought hdfs snapshots dirs are readable and browseable just like normal dirs. Only direct write operations would be blocked. Is this incorrect?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Jonathan, you are right that snapshot dirs are readable and browseable.  Let me clarify this:&lt;/p&gt;

&lt;p&gt;With snapshot feature, dirs can be set as &lt;em&gt;snapshottable&lt;/em&gt; and snapshots can only be taken on snapshottable dirs.  Once a dir (say /foo) is snapshottable, &quot;.snapshot&quot; is used for accessing snapshot and the usual API/CLI will work for it, e.g.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;show all snapshots of foo
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;fs -ls /foo/.snapshot   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;list the file in snapshot s0
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;fs -ls /foo/.snapshot/s0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;copy a file inside s0 to /tmp
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;fs -cp /foo/.snapshot/s0/bar.txt /tmp
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;For non-snapshottable dir (say /bar), /bar/.snapshot is an non-existing file.  That&apos;s why Ted got file not found from CLI.&lt;/p&gt;</comment>
                            <comment id="13633168" author="hadoopqa" created="Tue, 16 Apr 2013 18:43:09 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12578966/8352-trunk-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12578966/8352-trunk-v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5325//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13633170" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 18:45:38 +0000"  >&lt;p&gt;See if patch v3 addresses Jon&apos;s comment.&lt;/p&gt;</comment>
                            <comment id="13633204" author="lhofhansl" created="Tue, 16 Apr 2013 19:04:38 +0000"  >&lt;p&gt;This does not seem right:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-comment&quot;&gt;// check &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; an older version of snapshot directory was present
&lt;/span&gt;+    Path oldSnapshotDir = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(mfs.getRootDir(), &lt;span class=&quot;code-quote&quot;&gt;&quot;.snapshot&quot;&lt;/span&gt;);
+    FileSystem fs = mfs.getFileSystem();
+    List&amp;lt;SnapshotDescription&amp;gt; ss = getCompletedSnapshots();
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ss != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !ss.isEmpty()) {
+      LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Snapshots from an earlier release were found under: &quot;&lt;/span&gt; + oldSnapshotDir);
+      LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Please rename the directory as &quot;&lt;/span&gt; + HConstants.SNAPSHOT_DIR_NAME);
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If never used the old snapshot dir for anything and will just return the new snapshots anyway.&lt;/p&gt;</comment>
                            <comment id="13633217" author="hadoopqa" created="Tue, 16 Apr 2013 19:11:47 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12578983/8352-trunk-v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12578983/8352-trunk-v3.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.snapshot.TestSnapshotManager&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5327//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13633246" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 19:42:51 +0000"  >&lt;p&gt;Patch v4 uses oldSnapshotDir in checkSnapshotSupport().&lt;/p&gt;</comment>
                            <comment id="13633294" author="jmhsieh" created="Tue, 16 Apr 2013 20:17:01 +0000"  >&lt;p&gt;nit: Prefer keeping the no argument version &amp;#8211; this extra generally never used arg makes this harder to read.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-      List&amp;lt;SnapshotDescription&amp;gt; snapshots = snapshotManager.getCompletedSnapshots();
+      List&amp;lt;SnapshotDescription&amp;gt; snapshots = snapshotManager.getCompletedSnapshots(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;nit: prefer if you create a private more generic version with the path argument but keep the older no argument version public.  the current way exposes possibilities that don&apos;t need to be.&lt;/p&gt;

&lt;p&gt;So instead of this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   /**
    * Gets the list of all completed snapshots.
+   * @param snapshotDir snapshot directory
    * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; list of SnapshotDescriptions
    * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException File system exception
    */
-  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;SnapshotDescription&amp;gt; getCompletedSnapshots() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;SnapshotDescription&amp;gt; getCompletedSnapshots(Path snapshotDir) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
     List&amp;lt;SnapshotDescription&amp;gt; snapshotDescs = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;SnapshotDescription&amp;gt;();
     &lt;span class=&quot;code-comment&quot;&gt;// first create the snapshot root path and check to see &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; it exists
&lt;/span&gt;-    Path snapshotDir = SnapshotDescriptionUtils.getSnapshotsDir(rootDir);
     FileSystem fs = master.getMasterFileSystem().getFileSystem();
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (snapshotDir == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) snapshotDir = SnapshotDescriptionUtils.getSnapshotsDir(rootDir);
 
     &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; there are no snapshots, &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; an empty list
&lt;/span&gt;     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!fs.exists(snapshotDir)) {
@@ -877,6 +878,15 @@
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;have something more like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;SnapshotDescription&amp;gt; getCompletedSnapshots() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException { 
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; getCompletedSnapshots(SnapshotDescriptionUtils.getSnapshotsDir(rootDir));
  }
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;SnapshotDescription&amp;gt; getCompletedSnapshots(Path snapshotDir) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    ...
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Otherwise, lgtm.&lt;/p&gt;</comment>
                            <comment id="13633301" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 20:25:37 +0000"  >&lt;p&gt;Patch v5 addresses Jon&apos;s comment&lt;/p&gt;</comment>
                            <comment id="13633342" author="jmhsieh" created="Tue, 16 Apr 2013 20:53:20 +0000"  >&lt;p&gt;lgtm +1.&lt;/p&gt;</comment>
                            <comment id="13633343" author="hadoopqa" created="Tue, 16 Apr 2013 20:55:04 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12578998/8352-trunk-v4.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12578998/8352-trunk-v4.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5329//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13633367" author="mbertozzi" created="Tue, 16 Apr 2013 21:09:12 +0000"  >&lt;p&gt;+1 v5 looks good to me&lt;/p&gt;</comment>
                            <comment id="13633371" author="jesse_yates" created="Tue, 16 Apr 2013 21:12:21 +0000"  >&lt;p&gt;+1 lgtm. Thanks Ted!&lt;/p&gt;</comment>
                            <comment id="13633378" author="lhofhansl" created="Tue, 16 Apr 2013 21:20:34 +0000"  >&lt;p&gt;+1 from me as well.&lt;/p&gt;</comment>
                            <comment id="13633396" author="hadoopqa" created="Tue, 16 Apr 2013 21:34:28 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12579005/8352-trunk-v5.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12579005/8352-trunk-v5.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5330//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13633397" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 21:34:39 +0000"  >&lt;p&gt;Patch v3 for 0.94 aligns with patch v5 for trunk.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Running org.apache.hadoop.hbase.client.TestCloneSnapshotFromClient
2013-04-16 14:08:41.240 java[3877:1203] Unable to load realm info from SCDynamicStore
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 120.711 sec
Running org.apache.hadoop.hbase.client.TestRestoreSnapshotFromClient
2013-04-16 14:10:42.576 java[3902:1203] Unable to load realm info from SCDynamicStore
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 142.78 sec
Running org.apache.hadoop.hbase.client.TestSnapshotFromAdmin
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.289 sec
Running org.apache.hadoop.hbase.client.TestSnapshotFromClient
2013-04-16 14:13:10.506 java[3926:1203] Unable to load realm info from SCDynamicStore
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 37.47 sec
Running org.apache.hadoop.hbase.client.TestSnapshotsFromAdmin
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 4.223 sec
Running org.apache.hadoop.hbase.master.cleaner.TestSnapshotFromMaster
2013-04-16 14:13:53.041 java[3944:1203] Unable to load realm info from SCDynamicStore
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 43.12 sec
Running org.apache.hadoop.hbase.master.snapshot.TestSnapshotFileCache
2013-04-16 14:14:36.754 java[3963:1203] Unable to load realm info from SCDynamicStore
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.994 sec
Running org.apache.hadoop.hbase.master.snapshot.TestSnapshotHFileCleaner
2013-04-16 14:15:30.314 java[3974:1203] Unable to load realm info from SCDynamicStore
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.506 sec
Running org.apache.hadoop.hbase.master.snapshot.TestSnapshotLogCleaner
2013-04-16 14:15:31.065 java[3976:1203] Unable to load realm info from SCDynamicStore
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.479 sec
Running org.apache.hadoop.hbase.master.snapshot.TestSnapshotManager
2013-04-16 14:15:31.887 java[3978:1203] Unable to load realm info from SCDynamicStore
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.723 sec
Running org.apache.hadoop.hbase.snapshot.TestExportSnapshot
2013-04-16 14:15:32.888 java[3980:1203] Unable to load realm info from SCDynamicStore
Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 30.427 sec
Running org.apache.hadoop.hbase.snapshot.TestFlushSnapshotFromClient
2013-04-16 14:16:03.943 java[4007:1203] Unable to load realm info from SCDynamicStore
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 45.386 sec
Running org.apache.hadoop.hbase.snapshot.TestRestoreFlushSnapshotFromClient
2013-04-16 14:16:49.908 java[4028:1203] Unable to load realm info from SCDynamicStore
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 108.129 sec
Running org.apache.hadoop.hbase.snapshot.TestRestoreSnapshotHelper
2013-04-16 14:18:38.512 java[4049:1203] Unable to load realm info from SCDynamicStore
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.839 sec
Running org.apache.hadoop.hbase.snapshot.TestSnapshotDescriptionUtils
2013-04-16 14:18:39.561 java[4051:1203] Unable to load realm info from SCDynamicStore
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.474 sec
Running org.apache.hadoop.hbase.snapshot.TestSnapshotLogSplitter
2013-04-16 14:18:40.295 java[4053:1203] Unable to load realm info from SCDynamicStore
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.012 sec
Running org.apache.hadoop.hbase.snapshot.TestSnapshotTask
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.24 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13633422" author="apurtell" created="Tue, 16 Apr 2013 21:48:45 +0000"  >&lt;p&gt;Minor nit on patch v5, can be fixed up on commit, let&apos;s put &quot;.snapshot&quot; on the non-table-dirs list using a constant defined somewhere with javadoc as to why.&lt;/p&gt;</comment>
                            <comment id="13633451" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 22:00:57 +0000"  >&lt;p&gt;I thought about that. getCompletedSnapshots() references &quot;.snapshot&quot; (old name).&lt;br/&gt;
I can expose the following constant and reference it from getCompletedSnapshots():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  /* Name of old snapshot directory. See HBASE-8352 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; details on why it needs to be renamed */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; OLD_SNAPSHOT_DIR_NAME = &lt;span class=&quot;code-quote&quot;&gt;&quot;.snapshot&quot;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13633456" author="apurtell" created="Tue, 16 Apr 2013 22:02:25 +0000"  >&lt;p&gt;OLD_SNAPSHOT_DIR_NAME lgtm&lt;/p&gt;</comment>
                            <comment id="13633474" author="mbertozzi" created="Tue, 16 Apr 2013 22:11:50 +0000"  >&lt;p&gt;if the inital folder name was &quot;.hbase-snapshot&quot; today this constant probably it will be called HDFS_SNAPSHOTS_DIR_NAME, since the idea of reserving it is because that name is taken by hdfs...&lt;/p&gt;

&lt;p&gt;otherwise we&apos;ll end up in .98 to look at the code and say... hey this OLD_SNAPSHOT is no longer used... we can remove it.&lt;/p&gt;</comment>
                            <comment id="13633481" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 22:15:31 +0000"  >&lt;p&gt;@Matteo:&lt;br/&gt;
Were you suggesting modification based on patch v6 ?&lt;/p&gt;</comment>
                            <comment id="13633548" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 23:23:08 +0000"  >&lt;p&gt;Integrated to 0.94, 0.95 and trunk.&lt;/p&gt;

&lt;p&gt;Thanks for the reviews, Jon, Matteo, Lars and Andy.&lt;/p&gt;</comment>
                            <comment id="13633729" author="hudson" created="Wed, 17 Apr 2013 03:55:55 +0000"  >&lt;p&gt;Integrated in hbase-0.95 #150 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95/150/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95/150/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8352&quot; title=&quot;Rename &amp;#39;.snapshot&amp;#39; directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8352&quot;&gt;&lt;del&gt;HBASE-8352&lt;/del&gt;&lt;/a&gt; Rename &apos;.snapshot&apos; directory (Ted Yu) (Revision 1468670)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/test/java/org/apache/hadoop/hbase/client/TestSnapshotFromAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/TestExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/TestSnapshotDescriptionUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13633757" author="hudson" created="Wed, 17 Apr 2013 04:25:34 +0000"  >&lt;p&gt;Integrated in hbase-0.95-on-hadoop2 #71 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.95-on-hadoop2/71/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.95-on-hadoop2/71/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8352&quot; title=&quot;Rename &amp;#39;.snapshot&amp;#39; directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8352&quot;&gt;&lt;del&gt;HBASE-8352&lt;/del&gt;&lt;/a&gt; Rename &apos;.snapshot&apos; directory (Ted Yu) (Revision 1468670)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-client/src/test/java/org/apache/hadoop/hbase/client/TestSnapshotFromAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/TestExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.95/hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/TestSnapshotDescriptionUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13633768" author="hudson" created="Wed, 17 Apr 2013 04:31:01 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #962 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/962/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/962/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8352&quot; title=&quot;Rename &amp;#39;.snapshot&amp;#39; directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8352&quot;&gt;&lt;del&gt;HBASE-8352&lt;/del&gt;&lt;/a&gt; Rename &apos;.snapshot&apos; directory (Ted Yu) (Revision 1468671)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/client/TestSnapshotFromAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/client/TestSnapshotsFromAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/snapshot/TestExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/snapshot/TestSnapshotDescriptionUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13633783" author="hudson" created="Wed, 17 Apr 2013 04:48:06 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #4067 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4067/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4067/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8352&quot; title=&quot;Rename &amp;#39;.snapshot&amp;#39; directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8352&quot;&gt;&lt;del&gt;HBASE-8352&lt;/del&gt;&lt;/a&gt; Rename &apos;.snapshot&apos; directory (Ted Yu) (Revision 1468669)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/test/java/org/apache/hadoop/hbase/client/TestSnapshotFromAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/TestExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/TestSnapshotDescriptionUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13633814" author="hudson" created="Wed, 17 Apr 2013 05:54:44 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #501 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/501/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/501/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8352&quot; title=&quot;Rename &amp;#39;.snapshot&amp;#39; directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8352&quot;&gt;&lt;del&gt;HBASE-8352&lt;/del&gt;&lt;/a&gt; Rename &apos;.snapshot&apos; directory (Ted Yu) (Revision 1468669)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/test/java/org/apache/hadoop/hbase/client/TestSnapshotFromAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/TestExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/snapshot/TestSnapshotDescriptionUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13633852" author="hudson" created="Wed, 17 Apr 2013 07:18:40 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #138 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/138/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/138/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8352&quot; title=&quot;Rename &amp;#39;.snapshot&amp;#39; directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8352&quot;&gt;&lt;del&gt;HBASE-8352&lt;/del&gt;&lt;/a&gt; Rename &apos;.snapshot&apos; directory (Ted Yu) (Revision 1468671)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/snapshot/SnapshotManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/client/TestSnapshotFromAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/client/TestSnapshotsFromAdmin.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/snapshot/TestExportSnapshot.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/snapshot/TestSnapshotDescriptionUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13635675" author="szetszwo" created="Thu, 18 Apr 2013 20:50:42 +0000"  >&lt;p&gt;Thanks for everyone.  You guys have done a great job!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12640621">HDFS-4666</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12578879" name="8352-0.94-v1.txt" size="7348" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 06:13:53 +0000"/>
                            <attachment id="12578977" name="8352-0.94-v2.txt" size="7928" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 18:26:13 +0000"/>
                            <attachment id="12579018" name="8352-0.94-v3.txt" size="10235" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 21:34:39 +0000"/>
                            <attachment id="12579042" name="8352-0.94-v4.txt" size="10439" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 22:29:11 +0000"/>
                            <attachment id="12578966" name="8352-trunk-v2.txt" size="7361" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 17:39:58 +0000"/>
                            <attachment id="12578983" name="8352-trunk-v3.txt" size="7424" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 18:45:38 +0000"/>
                            <attachment id="12578998" name="8352-trunk-v4.txt" size="10302" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 19:42:51 +0000"/>
                            <attachment id="12579005" name="8352-trunk-v5.txt" size="9703" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 20:25:37 +0000"/>
                            <attachment id="12579036" name="8352-trunk-v6.txt" size="9907" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 22:09:15 +0000"/>
                            <attachment id="12578948" name="8352-trunk.txt" size="6781" author="yuzhihong@gmail.com" created="Tue, 16 Apr 2013 15:01:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Apr 2013 14:47:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323077</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 35 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jqpb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323422</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>In order to avoid name collision with hdfs snapshot, &amp;quot;.snapshot&amp;quot; under HBase root directory must be renamed as &amp;quot;.hbase-snapshot&amp;quot; before deployment of 0.94.7 or later release is started.&lt;br/&gt;
&lt;br/&gt;
Don&amp;#39;t do rolling upgrade between 0.94.6.1 and 0.94.7 if there&amp;#39;re on-going snapshots activities.&lt;br/&gt;
Sequence of actions should be:&lt;br/&gt;
&lt;br/&gt;
1. make sure all on-going snapshots activities have completed&lt;br/&gt;
2. shutdown all the masters&lt;br/&gt;
3. rename &amp;quot;.snapshot&amp;quot; under HBase root directory as &amp;quot;.hbase-snapshot&amp;quot;&lt;br/&gt;
4. upgrade the masters to 0.94.7+ release (You now can perform clone or restore, but not taking snapshots)&lt;br/&gt;
5. upgrade the region servers&lt;br/&gt;
(You should not take snapshots until all the regions server are aligned to 0.94.7+ release)&lt;br/&gt;
&lt;br/&gt;
If you take a snapshot during the RS upgrades nothing critical happens. The &amp;quot;.snapshot&amp;quot; folder would appear again and the snapshot will fail since half of the data will be in &amp;quot;.hbase-snapshot&amp;quot; and the other half in &amp;quot;.snapshot&amp;quot;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>