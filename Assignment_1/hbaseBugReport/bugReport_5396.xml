<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:27:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5396/HBASE-5396.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5396] Handle the regions in regionPlans while processing ServerShutdownHandler</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5396</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The regions plan to open on this server while ServerShutdownHandler is handling, just be removed from AM.regionPlans, and only left to TimeoutMonitor handle these regions. This need to optimize.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12542502">HBASE-5396</key>
            <summary>Handle the regions in regionPlans while processing ServerShutdownHandler</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="4">Incomplete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jeason">Jieshan Bean</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Feb 2012 09:39:41 +0000</created>
                <updated>Wed, 22 Apr 2015 00:46:30 +0000</updated>
                            <resolved>Wed, 22 Apr 2015 00:46:30 +0000</resolved>
                                    <version>0.90.6</version>
                                    <fixVersion>0.92.3</fixVersion>
                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13207856" author="zhihyu@ebaysf.com" created="Tue, 14 Feb 2012 17:43:07 +0000"  >&lt;p&gt;@Jieshan:&lt;br/&gt;
Have you tested your patch in a 0.90 cluster ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isRegionOnline(HRegionInfo hri) {
+    HServerInfo hsi = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions.get(hri);
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (hsi != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.isServerOnline(hsi.getServerName())) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If hsi isn&apos;t online, should we remove region to server assignment mapping for hsi ?&lt;/p&gt;

&lt;p&gt;For RegionsWithDeadServer, would DeadServerWithRegions be a better name ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Set&amp;lt;HRegionInfo&amp;gt; regionPlanOnThisServer = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Since the member of the Set isn&apos;t RegionPlan, I suggest renaming the above field to regionsOnServer.&lt;/p&gt;

&lt;p&gt;Also, I think regionsOnServer and regionsInTransition should be initialized with empty HashSet. This would potentially avoid NPE in a few places.&lt;/p&gt;</comment>
                            <comment id="13207860" author="zhihyu@ebaysf.com" created="Tue, 14 Feb 2012 17:47:47 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+                &amp;amp;&amp;amp; regionPlanOnThisServer != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
+                &amp;amp;&amp;amp; !regionPlanOnThisServer.contains(rit.getRegion())) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Did you mean this ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+                &amp;amp;&amp;amp; (regionsOnServer == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
+                || !regionsOnServer.contains(rit.getRegion()))) {

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As I said above, if regionsOnServer was initialized to empty Set, the null check above can be omitted.&lt;/p&gt;</comment>
                            <comment id="13208222" author="jeason" created="Wed, 15 Feb 2012 04:35:33 +0000"  >&lt;p&gt;Thanks, Ted. Only one doubt basing on your comments:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Since the member of the Set isn&apos;t RegionPlan, I suggest renaming the above field to regionsOnServer.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Since the Set came from the regionPlans. So can I keep this name as regionPlanOnThisServer?  I think regionsOnServer will bring some misunderstanding. right?&lt;/p&gt;

&lt;p&gt;I have test this patch in 90 cluster for many times. And it works fine. I will upload the new patch today.&lt;/p&gt;</comment>
                            <comment id="13208223" author="zhihyu@ebaysf.com" created="Wed, 15 Feb 2012 04:41:08 +0000"  >&lt;p&gt;If you agree with renaming RegionsWithDeadServer to DeadServerWithRegions, I think regionsOnServer should be more suitable with DeadServerWithRegions. Basically it means region info&apos;s on the dead server.&lt;/p&gt;</comment>
                            <comment id="13208227" author="jeason" created="Wed, 15 Feb 2012 04:57:47 +0000"  >&lt;p&gt;ok..I rename it as &quot;regionsOnServer&quot;. I will upload the new patch after tests. Thanks, Ted.&lt;/p&gt;</comment>
                            <comment id="13208239" author="stack" created="Wed, 15 Feb 2012 05:36:30 +0000"  >&lt;p&gt;On the below:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isRegionOnline(HRegionInfo hri) {
+    HServerInfo hsi = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions.get(hri);
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (hsi != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.isServerOnline(hsi.getServerName())) {
+      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    }
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Don&apos;t you have to take out a lock on this.regions before you access it?  See the comment in this.servers.&lt;/p&gt;

&lt;p&gt;Also, could write the end of the method so:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; hsi != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.isServerOnline(hsi.getServerName();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Whats a RegionsWithDeadServer?   Is it RegionsOnDeadServers?&lt;/p&gt;

&lt;p&gt;The below is called regionplan but its storing HRegionInfos?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    Set&amp;lt;HRegionInfo&amp;gt; regionPlanOnThisServer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashSet&amp;lt;HRegionInfo&amp;gt;();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then here, we are storing a Set of HRIs but method name talks of RegionPlans.  Its a little hard to follow?&lt;/p&gt;

&lt;p&gt;Ditto here:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Set&amp;lt;HRegionInfo&amp;gt; regionPlanOnThisServer = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and this...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Set&amp;lt;HRegionInfo&amp;gt; getRegionPlanOnThisServer() {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This comment doesn&apos;t seem right?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * &lt;span class=&quot;code-object&quot;&gt;Process&lt;/span&gt; result used by processServerShutdown.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is no processing done in this data structure.&lt;/p&gt;


&lt;p&gt;... and save a few lines?&lt;/p&gt;</comment>
                            <comment id="13208247" author="jeason" created="Wed, 15 Feb 2012 06:01:56 +0000"  >&lt;p&gt;This patch was modified basing on the above comments. I upload it just for review. Plz share your comment again if possible. Then I will start the tests.&lt;br/&gt;
Thanks Stack &amp;amp; Ted.&lt;/p&gt;</comment>
                            <comment id="13208375" author="jeason" created="Wed, 15 Feb 2012 11:17:22 +0000"  >&lt;p&gt;I renamed &quot;regionPlanOnThisServer&quot; to &quot;regionOpeningOnServer&quot;, for emphasizing those regions were being processed when this HRegionServer been killed.&lt;br/&gt;
Since the class name is &quot;RegionsOnDeadServer&quot;, and &quot;regionPlanOnThisServer&quot; can be distinguished from it.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  public RegionsOnDeadServer processServerShutdown(final HServerInfo hsi) {
    RegionsOnDeadServer regionsOnDeadServer = new RegionsOnDeadServer();
    Set&amp;lt;HRegionInfo&amp;gt; regionsOpeningOnServer = new HashSet&amp;lt;HRegionInfo&amp;gt;();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13208378" author="jeason" created="Wed, 15 Feb 2012 11:19:27 +0000"  >&lt;p&gt;All tests passed. And I also tested it in real cluster.&lt;/p&gt;</comment>
                            <comment id="13208384" author="zhihyu@ebaysf.com" created="Wed, 15 Feb 2012 11:31:23 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+          &lt;span class=&quot;code-comment&quot;&gt;// Store the related regions in regionPlans.
&lt;/span&gt;+          regionsOpeningOnServer.add(e.getValue().getRegionInfo());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In order to make field name consistent with the above javadoc, how about naming it regionsFromRegionPlansForServer so that its source is clear ?&lt;/p&gt;

&lt;p&gt;Also, please take a look at TRUNK and be prepared for TRUNK patch after 0.90 fix is finalized.&lt;/p&gt;

&lt;p&gt;Thanks for the hard work.&lt;/p&gt;</comment>
                            <comment id="13209101" author="jeason" created="Thu, 16 Feb 2012 03:38:33 +0000"  >&lt;p&gt;Sometime, it&apos;s really hard to get a good name. &lt;br/&gt;
I&apos;ve changed it in &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5396&quot; title=&quot;Handle the regions in regionPlans while processing ServerShutdownHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5396&quot;&gt;&lt;del&gt;HBASE-5396&lt;/del&gt;&lt;/a&gt;-90-final.patch&quot;. Thanks Ted.&lt;br/&gt;
I will make the patch for TRUNK today.&lt;/p&gt;</comment>
                            <comment id="13209104" author="zhihyu@ebaysf.com" created="Thu, 16 Feb 2012 03:52:02 +0000"  >&lt;p&gt;+1 on patch for 90. Running test suite.&lt;/p&gt;</comment>
                            <comment id="13209124" author="zhihyu@ebaysf.com" created="Thu, 16 Feb 2012 05:37:14 +0000"  >&lt;p&gt;Test result for latest patch is positive.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5396&quot; title=&quot;Handle the regions in regionPlans while processing ServerShutdownHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5396&quot;&gt;&lt;del&gt;HBASE-5396&lt;/del&gt;&lt;/a&gt;-90-final.patch is good to go for 0.90 branch&lt;/p&gt;</comment>
                            <comment id="13209517" author="ram_krish" created="Thu, 16 Feb 2012 17:22:25 +0000"  >&lt;p&gt;Committed to 0.90.  Once Jieshan gives patch for trunk will commit to 0.92 and trunk.&lt;/p&gt;</comment>
                            <comment id="13211917" author="jeason" created="Mon, 20 Feb 2012 15:17:28 +0000"  >&lt;p&gt;I tested the patch for 92 by unit test and also in real cluster. This problem seems not represent in 92 and trunk version. I will give more tests and went through the code to check whether it&apos;s necessary for 92 and trunk. &lt;/p&gt;</comment>
                            <comment id="13212107" author="stack" created="Mon, 20 Feb 2012 21:47:28 +0000"  >&lt;p&gt;@Jieshan Thats interesting.  Thanks for checking it out.  Why do we not have the prob. in 0.92/trunk?  Is code different?&lt;/p&gt;</comment>
                            <comment id="13212349" author="jeason" created="Tue, 21 Feb 2012 04:46:51 +0000"  >&lt;p&gt;That problem is still there in 92 and trunk..but difficult to reproduce..After more tests, I reproduced it and verified the patch for 92. I haven&apos;t tested the patch for trunk.&lt;/p&gt;</comment>
                            <comment id="13212352" author="jeason" created="Tue, 21 Feb 2012 04:51:09 +0000"  >&lt;p&gt;RegionServer Log:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-02-20 23:24:49,432 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:20020-0x3359b077bc90018 Attempting to transition node 897ad476f426e58a36cae77c7302be1d from M_ZK_REGION_OFFLINE to RS_ZK_REGION_OPENING
2012-02-20 23:24:49,447 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:20020-0x3359b077bc90018 Successfully transitioned node 897ad476f426e58a36cae77c7302be1d from M_ZK_REGION_OFFLINE to RS_ZK_REGION_OPENING
2012-02-20 23:24:49,448 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Opening region: {NAME =&amp;gt; &apos;jeason,001477777777,1329747764680.897ad476f426e58a36cae77c7302be1d.&apos;, STARTKEY =&amp;gt; &apos;001477777777&apos;, ENDKEY =&amp;gt; &apos;001488888888&apos;, ENCODED =&amp;gt; 897ad476f426e58a36cae77c7302be1d,}
2012-02-20 23:24:49,448 INFO org.apache.hadoop.hbase.regionserver.HRegion: Setting up tabledescriptor config now ...
2012-02-20 23:24:49,448 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Instantiated jeason,001477777777,1329747764680.897ad476f426e58a36cae77c7302be1d.
2012-02-20 23:24:49,455 INFO org.apache.hadoop.hbase.regionserver.HRegion: Onlined jeason,001477777777,1329747764680.897ad476f426e58a36cae77c7302be1d.; next sequenceid=1
//This regionserver was killed just after the below log.
2012-02-20 23:24:49,455 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:20020-0x3359b077bc90018 Attempting to transition node 897ad476f426e58a36cae77c7302be1d from RS_ZK_REGION_OPENING to RS_ZK_REGION_OPENING
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;HMaster Log:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-02-20 23:25:36,442 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Assigning region jeason,001477777777,1329747764680.897ad476f426e58a36cae77c7302be1d. to C3S32,20020,1329798176762
2012-02-20 23:25:36,442 DEBUG org.apache.hadoop.hbase.master.ServerManager: New connection to C3S32,20020,1329798176762
2012-02-20 23:25:36,462 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=RS_ZK_REGION_OPENED, server=C3S32,20020,1329798176762, region=561e68708199320894bfcfc533cae772
2012-02-20 23:25:36,462 DEBUG org.apache.hadoop.hbase.master.handler.OpenedRegionHandler: Handling OPENED event for jeason,001377777777,1329747764680.561e68708199320894bfcfc533cae772. from C3S32,20020,1329798176762; deleting unassigned node
2012-02-20 23:25:36,462 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:20000-0x2359b0778ec000d Deleting existing unassigned node for 561e68708199320894bfcfc533cae772 that is in expected state RS_ZK_REGION_OPENED
2012-02-20 23:25:36,463 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=RS_ZK_REGION_OPENING, server=C3S32,20020,1329798176762, region=3455f468b76dcf7cfe3881f9e156d0c8
2012-02-20 23:25:36,468 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:20000-0x2359b0778ec000d Successfully deleted unassigned node for region 561e68708199320894bfcfc533cae772 in expected state RS_ZK_REGION_OPENED
2012-02-20 23:25:36,468 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: The znode of region jeason,001377777777,1329747764680.561e68708199320894bfcfc533cae772. has been deleted.
2012-02-20 23:25:36,468 INFO org.apache.hadoop.hbase.master.AssignmentManager: The master has opened the region jeason,001377777777,1329747764680.561e68708199320894bfcfc533cae772. that was online on C3S32,20020,1329798176762
2012-02-20 23:25:36,472 INFO org.apache.hadoop.hbase.master.handler.ServerShutdownHandler: 1 regions which planned to open on C3S31,20020,1329798177361 be re-assigned.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13212357" author="jeason" created="Tue, 21 Feb 2012 05:06:09 +0000"  >&lt;p&gt;I&apos;m running the unit tests for TRUNK.&lt;/p&gt;</comment>
                            <comment id="13212370" author="stack" created="Tue, 21 Feb 2012 05:24:17 +0000"  >&lt;p&gt;If you found it in 0.92, thats good enough &amp;#8211; its in TRUNK I&apos;d say.&lt;/p&gt;

&lt;p&gt;Do you have more of the regionserver log?  Why does it say its aborting?  You don&apos;t have it in your log above (The logs above look &apos;normal&apos;.. we need to bits that show it gone awry... thanks Jieshan).&lt;/p&gt;</comment>
                            <comment id="13212380" author="jeason" created="Tue, 21 Feb 2012 05:32:52 +0000"  >&lt;p&gt;This is the complete logs. I added some logs to track. And add sleeping code in opening to enlarge the proability of this problem.&lt;/p&gt;</comment>
                            <comment id="13213237" author="jeason" created="Wed, 22 Feb 2012 03:20:55 +0000"  >&lt;p&gt;All tests passed for TRUNK.&lt;/p&gt;</comment>
                            <comment id="13213335" author="stack" created="Wed, 22 Feb 2012 05:39:03 +0000"  >&lt;p&gt;The log does not show the regionserver aborting.  Should it?  Or am I misunderstanding (I guess I&apos;m not clear on what I should be looking for in this log.  Please help me Jieshan.  Sorry for being a bit slow).&lt;/p&gt;</comment>
                            <comment id="13213349" author="jeason" created="Wed, 22 Feb 2012 05:50:01 +0000"  >&lt;p&gt;@stack,&lt;br/&gt;
RegionServer process was killed manually. Not aborted itself. This is the steps of my test:&lt;br/&gt;
Suppose there&apos;s 3 nodes in cluster: A, B, C.&lt;br/&gt;
1. Create a table with 1000 regions.&lt;br/&gt;
2. Assign all regions to C.&lt;br/&gt;
3. Kill C. During the ServerShutdownHandler processing, then kill A(At this time, some regions may been openning on this server.)&lt;/p&gt;

&lt;p&gt;See whether all the regions can be opened in time(And also check the regions which in regionPlans).&lt;/p&gt;</comment>
                            <comment id="13213374" author="stack" created="Wed, 22 Feb 2012 06:05:40 +0000"  >&lt;p&gt;So what am I looking to see in the log snippet above (and in the attached log?)  Thanks Jieshan.&lt;/p&gt;</comment>
                            <comment id="13213381" author="jeason" created="Wed, 22 Feb 2012 06:09:56 +0000"  >&lt;p&gt;Only see the below and related logs. It means the region in regionPlans can be reassigned with this patch.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-02-20 23:25:36,472 INFO org.apache.hadoop.hbase.master.handler.ServerShutdownHandler: 1 regions which planned to open on C3S31,20020,1329798177361 be re-assigned.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thanks, Stack.&lt;/p&gt;</comment>
                            <comment id="13257508" author="ram_krish" created="Thu, 19 Apr 2012 14:21:03 +0000"  >&lt;p&gt;BTW,&lt;br/&gt;
do we need to put this into 0.92 and above?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12556729">HBASE-6060</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12514627" name="HBASE-5396-90-V2.patch" size="9817" author="jeason" created="Wed, 15 Feb 2012 11:17:22 +0000"/>
                            <attachment id="12514752" name="HBASE-5396-90-final.patch" size="9992" author="jeason" created="Thu, 16 Feb 2012 03:38:32 +0000"/>
                            <attachment id="12514604" name="HBASE-5396-90-forReview.patch" size="9714" author="jeason" created="Wed, 15 Feb 2012 06:40:43 +0000"/>
                            <attachment id="12514485" name="HBASE-5396-90.patch" size="9168" author="jeason" created="Tue, 14 Feb 2012 12:03:51 +0000"/>
                            <attachment id="12515317" name="HBASE-5396-92.patch" size="8093" author="jeason" created="Tue, 21 Feb 2012 04:46:50 +0000"/>
                            <attachment id="12515318" name="HBASE-5396-trunk.patch" size="7831" author="jeason" created="Tue, 21 Feb 2012 04:46:50 +0000"/>
                            <attachment id="12515323" name="Logs-TestFor92.rar" size="263081" author="jeason" created="Tue, 21 Feb 2012 05:32:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 14 Feb 2012 17:43:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>227788</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 35 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02c27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11555</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>