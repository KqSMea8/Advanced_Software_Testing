<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:36:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-12801/HBASE-12801.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-12801] Failed to truncate a table while maintaing binary region boundaries</title>
                <link>https://issues.apache.org/jira/browse/HBASE-12801</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Binary region boundaries become wrong during &lt;br/&gt;
converting byte array to normal string, and back to byte array in truncate_preserve of admin.rb, which makes the truncation of table failed.&lt;/p&gt;

&lt;p&gt;See: truncate_preserve method in admin.rb&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 splits = h_table.getRegionLocations().keys().map{|i| Bytes.toString(i.getStartKey)}.delete_if{|k| k == &quot;&quot;}.to_java :&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;
 splits = org.apache.hadoop.hbase.util.Bytes.toByteArrays(splits)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;eg:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
\xFA\x00\x00\x00\x00\x00\x00\x00 -&amp;gt;  \xEF\xBF\xBD\x00\x00\x00\x00\x00\x00\x00
\xFC\x00\x00\x00\x00\x00\x00\x00 -&amp;gt; \xEF\xBF\xBD\x00\x00\x00\x00\x00\x00\x00
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Simple patch is using binary string instead of normal string.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12764749">HBASE-12801</key>
            <summary>Failed to truncate a table while maintaing binary region boundaries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="liushaohui">Liu Shaohui</assignee>
                                    <reporter username="liushaohui">Liu Shaohui</reporter>
                        <labels>
                    </labels>
                <created>Sun, 4 Jan 2015 06:01:17 +0000</created>
                <updated>Thu, 19 Mar 2015 06:10:14 +0000</updated>
                            <resolved>Tue, 13 Jan 2015 03:32:03 +0000</resolved>
                                    <version>0.94.11</version>
                                    <fixVersion>1.0.0</fixVersion>
                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>0.98.10</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                    <fixVersion>0.94.27</fixVersion>
                                    <component>shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="14263770" author="liushaohui" created="Sun, 4 Jan 2015 06:49:39 +0000"  >&lt;p&gt;Patch for trunk.&lt;br/&gt;
Test in local cluster with a master without truncateTable api.&lt;/p&gt;

&lt;p&gt;HMaster with truncateTable api did not have this issue.&lt;/p&gt;</comment>
                            <comment id="14263771" author="liushaohui" created="Sun, 4 Jan 2015 06:51:02 +0000"  >&lt;p&gt;Patch for 0.94. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14263774" author="hadoopqa" created="Sun, 4 Jan 2015 07:02:08 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12689962/HBASE-12801-0.94-v1.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12689962/HBASE-12801-0.94-v1.diff&lt;/a&gt;&lt;br/&gt;
  against master branch at commit ac95cc1fbb951bb9db96f2738f621d1d7cd45739.&lt;br/&gt;
  ATTACHMENT ID: 12689962&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12296//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12296//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14264001" author="lhofhansl" created="Sun, 4 Jan 2015 20:49:27 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14266578" author="busbey" created="Tue, 6 Jan 2015 19:09:44 +0000"  >&lt;p&gt;I&apos;m trying to test manually and having some trouble generating a proper binary split point in the first place.&lt;/p&gt;</comment>
                            <comment id="14267264" author="liushaohui" created="Wed, 7 Jan 2015 04:12:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;&lt;br/&gt;
try &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
create &apos;t1&apos;, &apos;f1&apos;, {NUMREGIONS =&amp;gt; 256, SPLITALGO =&amp;gt; &apos;UniformSplit&apos;}
truncate_preserve &apos;t1&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If you test the trunk code, you should test with a Hmaster without truncateTable api.&lt;br/&gt;
See: admin.rb #399&lt;/p&gt;</comment>
                            <comment id="14268219" author="busbey" created="Wed, 7 Jan 2015 21:09:10 +0000"  >&lt;p&gt;+1 looks good. Any chance we can add a meaningful shell test? Not sure if we have a way to force the non-truncate-api path.&lt;/p&gt;</comment>
                            <comment id="14271040" author="liushaohui" created="Fri, 9 Jan 2015 14:03:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;br/&gt;
Could you help to push this issue on 0.94? &lt;/p&gt;</comment>
                            <comment id="14271189" author="busbey" created="Fri, 9 Jan 2015 15:38:06 +0000"  >&lt;p&gt;I checked things on 0.94 as well, and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; already gave a +1 earlier.  I think you&apos;re good to go.&lt;/p&gt;</comment>
                            <comment id="14274553" author="apurtell" created="Tue, 13 Jan 2015 01:22:41 +0000"  >&lt;p&gt;This looks good to go. Committing everywhere shortly unless objection.&lt;/p&gt;</comment>
                            <comment id="14274646" author="apurtell" created="Tue, 13 Jan 2015 03:32:03 +0000"  >&lt;p&gt;Pushed to 0.94 and 0.98+ &lt;/p&gt;</comment>
                            <comment id="14274675" author="hudson" created="Tue, 13 Jan 2015 04:08:27 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6015 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6015/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6015/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12801&quot; title=&quot;Failed to truncate a table while maintaing binary region boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12801&quot;&gt;&lt;del&gt;HBASE-12801&lt;/del&gt;&lt;/a&gt; Failed to truncate a table while maintaing binary region boundaries (Liu Shaohui) (apurtell: rev acc284eec6e708088971b495f2ad4d720ee35a40)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-shell/src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/util/Bytes.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14274702" author="hudson" created="Tue, 13 Jan 2015 04:42:16 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.1 #77 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/77/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/77/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12801&quot; title=&quot;Failed to truncate a table while maintaing binary region boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12801&quot;&gt;&lt;del&gt;HBASE-12801&lt;/del&gt;&lt;/a&gt; Failed to truncate a table while maintaing binary region boundaries (Liu Shaohui) (apurtell: rev 40e9c22ea2800746ad324ec807b6eba136f51a92)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/util/Bytes.java&lt;/li&gt;
	&lt;li&gt;hbase-shell/src/main/ruby/hbase/admin.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14274712" author="hudson" created="Tue, 13 Jan 2015 05:03:07 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.0 #654 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/654/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.0/654/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12801&quot; title=&quot;Failed to truncate a table while maintaing binary region boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12801&quot;&gt;&lt;del&gt;HBASE-12801&lt;/del&gt;&lt;/a&gt; Failed to truncate a table while maintaing binary region boundaries (Liu Shaohui) (apurtell: rev 20e986a3d259da4e142a213a69c033d9cc60a76a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-shell/src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/util/Bytes.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14274716" author="hudson" created="Tue, 13 Jan 2015 05:04:32 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94-security #568 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/568/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/568/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12801&quot; title=&quot;Failed to truncate a table while maintaing binary region boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12801&quot;&gt;&lt;del&gt;HBASE-12801&lt;/del&gt;&lt;/a&gt; Failed to truncate a table while maintaing binary region boundaries (Liu Shaohui) (apurtell: rev eef4ad69a5325cd83b3391bea5a3eb327cb24be5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/hbase/util/Bytes.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14274722" author="hudson" created="Tue, 13 Jan 2015 05:16:36 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94 #1455 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1455/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1455/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12801&quot; title=&quot;Failed to truncate a table while maintaing binary region boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12801&quot;&gt;&lt;del&gt;HBASE-12801&lt;/del&gt;&lt;/a&gt; Failed to truncate a table while maintaing binary region boundaries (Liu Shaohui) (apurtell: rev eef4ad69a5325cd83b3391bea5a3eb327cb24be5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/hbase/util/Bytes.java&lt;/li&gt;
	&lt;li&gt;src/main/ruby/hbase/admin.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14274737" author="hudson" created="Tue, 13 Jan 2015 05:24:51 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94-JDK7 #223 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-JDK7/223/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-JDK7/223/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12801&quot; title=&quot;Failed to truncate a table while maintaing binary region boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12801&quot;&gt;&lt;del&gt;HBASE-12801&lt;/del&gt;&lt;/a&gt; Failed to truncate a table while maintaing binary region boundaries (Liu Shaohui) (apurtell: rev eef4ad69a5325cd83b3391bea5a3eb327cb24be5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;src/main/java/org/apache/hadoop/hbase/util/Bytes.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14274805" author="hudson" created="Tue, 13 Jan 2015 06:42:59 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98-on-Hadoop-1.1 #756 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/756/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/756/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12801&quot; title=&quot;Failed to truncate a table while maintaing binary region boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12801&quot;&gt;&lt;del&gt;HBASE-12801&lt;/del&gt;&lt;/a&gt; Failed to truncate a table while maintaing binary region boundaries (Liu Shaohui) (apurtell: rev 780f6f525e34dd84cbc5490ad3c7178de9b414d6)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/util/Bytes.java&lt;/li&gt;
	&lt;li&gt;hbase-shell/src/main/ruby/hbase/admin.rb&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14274829" author="hudson" created="Tue, 13 Jan 2015 07:19:49 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #792 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/792/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/792/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12801&quot; title=&quot;Failed to truncate a table while maintaing binary region boundaries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12801&quot;&gt;&lt;del&gt;HBASE-12801&lt;/del&gt;&lt;/a&gt; Failed to truncate a table while maintaing binary region boundaries (Liu Shaohui) (apurtell: rev 780f6f525e34dd84cbc5490ad3c7178de9b414d6)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-shell/src/main/ruby/hbase/admin.rb&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/util/Bytes.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14331849" author="enis" created="Sat, 21 Feb 2015 23:49:32 +0000"  >&lt;p&gt;Closing this issue after 1.0.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12689962" name="HBASE-12801-0.94-v1.diff" size="1782" author="liushaohui" created="Sun, 4 Jan 2015 06:51:02 +0000"/>
                            <attachment id="12689961" name="HBASE-12801-trunk-v1.diff" size="1879" author="liushaohui" created="Sun, 4 Jan 2015 06:49:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 4 Jan 2015 07:02:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23xev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>