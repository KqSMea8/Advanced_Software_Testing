<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:02:26 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-9214/HBASE-9214.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-9214] CatalogJanitor delete region info in Meta during Restore snapshot</title>
                <link>https://issues.apache.org/jira/browse/HBASE-9214</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Today I meet a issue during restore snapshot. It can be reproduce in step below:&lt;/p&gt;

&lt;p&gt;1. Table t1 create a Snapshot s1 successfully&lt;br/&gt;
2. region r1 in t1 split &lt;br/&gt;
3. CatalogJanitor Chore begin to work and found daughter  do not have reference , so r1 can be deleted&lt;br/&gt;
4. restore snapshot s1 . RestoreSnapshotHelper add region r1 to meta table&lt;br/&gt;
5.  CatalogJanitor delete r1 region info in meta which RestoreSnapshotHelper just inserted .&lt;br/&gt;
6. restore snapshot finished.&lt;/p&gt;

&lt;p&gt;Then we can found there is a hole in t1 after restore snapshot. Data loss.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12663610">HBASE-9214</key>
            <summary>CatalogJanitor delete region info in Meta during Restore snapshot</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="mbertozzi">Matteo Bertozzi</assignee>
                                    <reporter username="terry_zhang">terry zhang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Aug 2013 10:26:40 +0000</created>
                <updated>Wed, 14 Aug 2013 14:37:06 +0000</updated>
                            <resolved>Wed, 14 Aug 2013 14:37:06 +0000</resolved>
                                    <version>0.94.10</version>
                                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13739503" author="terry_zhang" created="Wed, 14 Aug 2013 10:38:59 +0000"  >&lt;p&gt;Below is some log during testing :&lt;/p&gt;

&lt;p&gt;1. CatalogJanitor decide to delete region&lt;/p&gt;

&lt;p&gt;2013-08-13 16:19:34,268 WARN org.apache.hadoop.hbase.master.CatalogJanitor: Daughter regiondir does not exist: hdfs://dw77.kgb.sqa.c&lt;br/&gt;
m4:9900/hbase-test3-snap/writetest/b95023663816ecf208f7ee3d69d8fb9c&lt;br/&gt;
2013-08-13 16:19:34,268 WARN org.apache.hadoop.hbase.master.CatalogJanitor: Daughter regiondir does not exist: hdfs://dw77.kgb.sqa.c&lt;br/&gt;
m4:9900/hbase-test3-snap/writetest/1c47cf89406349c159f36ae2e0c55582&lt;br/&gt;
2013-08-13 16:19:34,268 DEBUG org.apache.hadoop.hbase.master.CatalogJanitor: Deleting region writetest,P7777777777777777777777777777&lt;br/&gt;
777777777777777777773,1376370447956.bce523f334ca2c78f2c4ad360dc2a6a4. because daughter splits no longer hold references&lt;/p&gt;

&lt;p&gt;2 . RestoreSnapshotHelper  insert region info to META&lt;/p&gt;

&lt;p&gt;2013-08-13 16:19:34,273 DEBUG org.apache.hadoop.hbase.catalog.MetaEditor: Add to META, regions: [&lt;/p&gt;
{NAME =&amp;gt; &apos;writetest,HZZZZZZZZZZZZZZ
ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZX,1376370447956.05a9a252b41e8e41aa3a6a8a797380ab.&apos;, STARTKEY =&amp;gt; &apos;HZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ
ZZZZZZZZZZZZZZZZX&apos;, ENDKEY =&amp;gt; &apos;LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLI&apos;, ENCODED =&amp;gt; 05a9a252b41e8e41aa3a6a8a797380ab,}
&lt;p&gt;, &lt;/p&gt;
{
NAME =&amp;gt; &apos;writetest,3LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL,1376370447956.5689d3dbc9dc97106c28945ab7bb5104.&apos;, STARTKEY =&amp;gt;
&apos;3LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL&apos;, ENDKEY =&amp;gt; &apos;77777777777777777777777777777777777777777777777776&apos;, ENCODED =&amp;gt; 568
9d3dbc9dc97106c28945ab7bb5104,}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;writetest,77777777777777777777777777777777777777777777777776,1376370447956.5b5a7331c26ead
c41ea2944939fd2cee.&apos;, STARTKEY =&amp;gt; &apos;77777777777777777777777777777777777777777777777776&apos;, ENDKEY =&amp;gt; &apos;ASSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
SSSSSSSSSSSSSSSSR&apos;, ENCODED =&amp;gt; 5b5a7331c26eadc41ea2944939fd2cee,}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;writetest,ASSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
SSSSR,1376370447956.60226c1fbedc9d98f1192e37d7d3b6af.&apos;, STARTKEY =&amp;gt; &apos;ASSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSR&apos;, ENDKEY =&amp;gt;
&apos;EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEC&apos;, ENCODED =&amp;gt; 60226c1fbedc9d98f1192e37d7d3b6af,}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;writetest,LLLLLLLLLLL
LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLI,1376370447956.70523ec9e600da52b18caa45cf76cf66.&apos;, STARTKEY =&amp;gt; &apos;LLLLLLLLLLLLLLLLLLLLLLLLLLLLL
LLLLLLLLLLLLLLLLLLLLI&apos;, ENDKEY =&amp;gt; &apos;P7777777777777777777777777777777777777777777777773&apos;, ENCODED =&amp;gt; 70523ec9e600da52b18caa45cf76cf66,
}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;writetest,SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSO,1376370447956.74f9eef1cbb3e4f6627ee39a0996dec8.&apos;, STARTKEY
 =&amp;gt; &apos;SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSO&apos;, ENDKEY =&amp;gt; &apos;WEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE9&apos;, ENCODED =&amp;gt;
 74f9eef1cbb3e4f6627ee39a0996dec8,}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;writetest,WEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE9,1376370447956.82cf586c79
382a89508c3325304904f3.&apos;, STARTKEY =&amp;gt; &apos;WEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE9&apos;, ENDKEY =&amp;gt; &apos;&apos;, ENCODED =&amp;gt; 82cf586c79382a8
9508c3325304904f3,}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;writetest,P7777777777777777777777777777777777777777777777773,1
376370447956.bce523f334ca2c78f2c4ad360d
c2a6a4.&apos;, STARTKEY =&amp;gt; &apos;P7777777777777777777777777777777777777777777777773&apos;, ENDKEY =&amp;gt; &apos;SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS
SSSSO&apos;, ENCODED =&amp;gt; bce523f334ca2c78f2c4ad360dc2a6a4,}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;writetest,,1376370447944.d3eb975033a94730c88bf6696a413e9e.&apos;, STARTK
EY =&amp;gt; &apos;&apos;, ENDKEY =&amp;gt; &apos;3LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL&apos;, ENCODED =&amp;gt; d3eb975033a94730c88bf6696a413e9e,}
&lt;p&gt;, &lt;/p&gt;
{NAME =&amp;gt; &apos;w
ritetest,EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEC,1376370447956.f03a2b6805852c00e4fe029f3a9e7261.&apos;, STARTKEY =&amp;gt; &apos;EEEEEEEEE
EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEC&apos;, ENDKEY =&amp;gt; &apos;HZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZX&apos;, ENCODED =&amp;gt; f03a2b6805852
c00e4fe029f3a9e7261,}
&lt;p&gt;]&lt;/p&gt;

&lt;p&gt;3. region info is delete by CatalogJanitor &lt;/p&gt;

&lt;p&gt;2013-08-13 16:19:34,333 INFO org.apache.hadoop.hbase.catalog.MetaEditor: Deleted region writetest,P777777777777777777777777777777777&lt;br/&gt;
7777777777777773,1376370447956.bce523f334ca2c78f2c4ad360dc2a6a4. from META&lt;/p&gt;</comment>
                            <comment id="13739505" author="terry_zhang" created="Wed, 14 Aug 2013 10:40:18 +0000"  >&lt;p&gt;I wonder if we could change CatalogJanitor not to remove split region info when table is disabled to avoid this issue?&lt;/p&gt;</comment>
                            <comment id="13739720" author="mbertozzi" created="Wed, 14 Aug 2013 14:37:06 +0000"  >&lt;p&gt;Closing as duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8760&quot; title=&quot;possible loss of data in snapshot taken after region split&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8760&quot;&gt;&lt;del&gt;HBASE-8760&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 14 Aug 2013 14:37:06 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343611</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 18 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n99r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343915</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>