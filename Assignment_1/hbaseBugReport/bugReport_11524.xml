<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:24:01 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-11524/HBASE-11524.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-11524] TestReplicaWithCluster#testChangeTable and TestReplicaWithCluster#testCreateDeleteTable fail</title>
                <link>https://issues.apache.org/jira/browse/HBASE-11524</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;&quot;git bisect&quot; points to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11367&quot; title=&quot;Pluggable replication endpoint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11367&quot;&gt;&lt;del&gt;HBASE-11367&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;build server run: (I did not get it in my local test)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;java.lang.Exception: test timed out after 30000 milliseconds&lt;br/&gt;
	at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.HBaseAdmin.createTable(HBaseAdmin.java:539)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.HBaseAdmin.createTable(HBaseAdmin.java:424)&lt;br/&gt;
	at org.apache.hadoop.hbase.HBaseTestingUtility.createTable(HBaseTestingUtility.java:1185)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.TestReplicaWithCluster.testCreateDeleteTable(TestReplicaWithCluster.java:138)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:606)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)&lt;br/&gt;
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)&lt;br/&gt;
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)&lt;br/&gt;
	at org.junit.internal.runners.statements.FailOnTimeout$StatementThread.run(FailOnTimeout.java:74)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;suspected log messages:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;2014-07-15 23:52:09,272 INFO  2014-07-15 23:52:09,263 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;PostOpenDeployTasks:44a7fe2589d83138452640fecb7cae80&amp;#93;&lt;/span&gt; handler.OpenRegionHandler$PostOpenDeployTasksThread(326): Exception running postOpenDeployTasks; region=44a7fe2589d83138452640fecb7cae80&lt;br/&gt;
java.lang.NullPointerException: No connection&lt;br/&gt;
&amp;gt;-at org.apache.hadoop.hbase.MetaTableAccessor.getHTable(MetaTableAccessor.java:180)&lt;br/&gt;
&amp;gt;-at org.apache.hadoop.hbase.MetaTableAccessor.getMetaHTable(MetaTableAccessor.java:193)&lt;br/&gt;
&amp;gt;-at org.apache.hadoop.hbase.MetaTableAccessor.putToMetaTable(MetaTableAccessor.java:941)&lt;br/&gt;
&amp;gt;-at org.apache.hadoop.hbase.MetaTableAccessor.updateLocation(MetaTableAccessor.java:1300)&lt;br/&gt;
&amp;gt;-at org.apache.hadoop.hbase.MetaTableAccessor.updateRegionLocation(MetaTableAccessor.java:1278)&lt;br/&gt;
&amp;gt;-at org.apache.hadoop.hbase.regionserver.HRegionServer.postOpenDeployTasks(HRegionServer.java:1724)&lt;br/&gt;
&amp;gt;-at org.apache.hadoop.hbase.regionserver.handler.OpenRegionHandler$PostOpenDeployTasksThread.run(OpenRegionHandler.java:321)&lt;/p&gt;

&lt;p&gt;coordination.ZkOpenRegionCoordination(231): Opening of region &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {ENCODED =&amp;gt; 44a7fe2589d83138452640fecb7cae80, NAME =&amp;gt; &amp;#39;testCreateDeleteTable,,1405493529036_0001.44a7fe2589d83138452640fecb7cae80.&amp;#39;, STARTKEY =&amp;gt; &amp;#39;&amp;#39;, ENDKEY =&amp;gt; &amp;#39;&amp;#39;, REPLICA_ID =&amp;gt; 1}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; failed, transitioning from OPENING to FAILED_OPEN in ZK, expecting version 1&lt;/p&gt;

&lt;p&gt;2014-07-15 23:52:09,272 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;RS_OPEN_REGION-bdvm101:18352-1&amp;#93;&lt;/span&gt; regionserver.HRegion(1239): Closed testCreateDeleteTable,,1405493529036.8573bc63fc7f328cf926a28f22c0db07.&lt;br/&gt;
2014-07-15 23:52:09,272 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;RS_OPEN_REGION-bdvm101:23828-0&amp;#93;&lt;/span&gt; zookeeper.ZKAssign(805): regionserver:23828-0x1473df0c2ef0002, quorum=localhost:61041, baseZNode=/hbase Transitioning 44a7fe2589d83138452640fecb7cae80 from RS_ZK_REGION_OPENING to RS_ZK_REGION_FAILED_OPEN&lt;/p&gt;
&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12727617">HBASE-11524</key>
            <summary>TestReplicaWithCluster#testChangeTable and TestReplicaWithCluster#testCreateDeleteTable fail</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tianq">Qiang Tian</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Jul 2014 09:00:27 +0000</created>
                <updated>Thu, 17 Jul 2014 02:36:19 +0000</updated>
                            <resolved>Thu, 17 Jul 2014 02:36:19 +0000</resolved>
                                    <version>2.0.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="14063308" author="mantonov" created="Wed, 16 Jul 2014 09:07:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; - does it look related?&lt;/p&gt;</comment>
                            <comment id="14063334" author="tianq" created="Wed, 16 Jul 2014 09:46:54 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mantonov&quot; class=&quot;user-hover&quot; rel=&quot;mantonov&quot;&gt;Mikhail Antonov&lt;/a&gt;! yes, i think so...debug shows the shortCircuitConnection is closed.  &lt;br/&gt;
is &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11517&quot; title=&quot;TestReplicaWithCluster turns zombie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11517&quot;&gt;&lt;del&gt;HBASE-11517&lt;/del&gt;&lt;/a&gt; committed? I cannot see it..&lt;/p&gt;</comment>
                            <comment id="14063335" author="mantonov" created="Wed, 16 Jul 2014 09:50:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tianq&quot; class=&quot;user-hover&quot; rel=&quot;tianq&quot;&gt;Qiang Tian&lt;/a&gt; there was kind of intermediate commit to help get more debug logs. See TestReplicaWithCluster turns zombie &#8211; ADDS TIMEOUTS SO CAN DEBUG ZOMBIE (stack: rev 7175f51f0817e93fe2c46aa39937fdff73e383d6)&lt;/p&gt;

&lt;p&gt;If you got this commit fetched on your environment, you could pick the patch I attached to that jira and just apply it on top of this one. After that this test passes for me. The error seems to be that with recent changes each server holds instance of HConnection, but when we have 2 miniclusters in the same test, calling #shutdown() on any of them closes all connections in JVM, for both miniclusters.&lt;/p&gt;

&lt;p&gt;Let me know if that patch works for you.&lt;/p&gt;</comment>
                            <comment id="14063340" author="tianq" created="Wed, 16 Jul 2014 10:08:43 +0000"  >&lt;p&gt;oops. I already have it..(there are quite a few commits yesterday, I missed it..&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;)&lt;br/&gt;
my test still fails, but compared with my &quot;git bisect&quot; test, it takes much less time:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;HBase - Server .................................... FAILURE &lt;span class=&quot;error&quot;&gt;&amp;#91;01:58 min&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;looks without your change, the test hangs there for about 15 minutes and no TEST-org.apache.hadoop.hbase.client.TestReplicaWithCluster.xml created.&lt;/p&gt;


</comment>
                            <comment id="14063956" author="mantonov" created="Wed, 16 Jul 2014 19:20:57 +0000"  >&lt;p&gt;Just to double check, the patch I referred to (the last one, &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12655995/HBASE-11517_v1-mantonov.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12655995/HBASE-11517_v1-mantonov.patch&lt;/a&gt;) hasn&apos;t been committed, it&apos;s attached to that related jira. Does the test fail with this patch manually applied on top of current master? &lt;/p&gt;

&lt;p&gt;If so, is there more specific logs for me to look at?&lt;/p&gt;</comment>
                            <comment id="14064280" author="mantonov" created="Wed, 16 Jul 2014 22:47:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tianq&quot; class=&quot;user-hover&quot; rel=&quot;tianq&quot;&gt;Qiang Tian&lt;/a&gt; the related jira has been committed and marked fixed. Wondering if that would solve your problem in this jira too.&lt;/p&gt;</comment>
                            <comment id="14064499" author="tianq" created="Thu, 17 Jul 2014 02:35:45 +0000"  >&lt;p&gt;hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mantonov&quot; class=&quot;user-hover&quot; rel=&quot;mantonov&quot;&gt;Mikhail Antonov&lt;/a&gt;, it passes now.&lt;br/&gt;
thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12727254">HBASE-11517</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Jul 2014 09:07:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>405723</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 22 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1xtjj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>405745</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>