<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:26:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5281/HBASE-5281.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5281] Should a failure in creating an unassigned node abort the master?</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5281</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In &lt;tt&gt;AssignmentManager&lt;/tt&gt;&apos;s &lt;tt&gt;CreateUnassignedAsyncCallback&lt;/tt&gt;, we have the following condition:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rc != 0) {
        &lt;span class=&quot;code-comment&quot;&gt;// Thisis resultcode.  If non-zero, need to resubmit.
&lt;/span&gt;        LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;rc != 0 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt; + path + &lt;span class=&quot;code-quote&quot;&gt;&quot; -- retryable connectionloss -- &quot;&lt;/span&gt; +
          &lt;span class=&quot;code-quote&quot;&gt;&quot;FIX see http:&lt;span class=&quot;code-comment&quot;&gt;//wiki.apache.org/hadoop/ZooKeeper/FAQ#A2&quot;&lt;/span&gt;);
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.zkw.abort(&lt;span class=&quot;code-quote&quot;&gt;&quot;Connectionloss writing unassigned at &quot;&lt;/span&gt; + path +
          &lt;span class=&quot;code-quote&quot;&gt;&quot;, rc=&quot;&lt;/span&gt; + rc, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;While a similar structure inside &lt;tt&gt;ExistsUnassignedAsyncCallback&lt;/tt&gt; (which the above is linked to), does not have such a force abort.&lt;/p&gt;

&lt;p&gt;Do we really require the abort statement here, or can we make do without?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12539891">HBASE-5281</key>
            <summary>Should a failure in creating an unassigned node abort the master?</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="qwertymaniac">Harsh J</assignee>
                                    <reporter username="qwertymaniac">Harsh J</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jan 2012 11:52:10 +0000</created>
                <updated>Fri, 16 Nov 2012 20:28:02 +0000</updated>
                            <resolved>Wed, 1 Feb 2012 03:42:49 +0000</resolved>
                                    <version>0.90.5</version>
                                    <fixVersion>0.92.1</fixVersion>
                    <fixVersion>0.94.0</fixVersion>
                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13196004" author="qwertymaniac" created="Mon, 30 Jan 2012 09:41:46 +0000"  >&lt;p&gt;Patch that removes the abort statement, like the other callback has.&lt;/p&gt;</comment>
                            <comment id="13196006" author="qwertymaniac" created="Mon, 30 Jan 2012 09:42:11 +0000"  >&lt;p&gt;Patch should apply both to 0.92 and trunk branches.&lt;/p&gt;</comment>
                            <comment id="13196039" author="hadoopqa" created="Mon, 30 Jan 2012 10:40:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12512395/HBASE-5281.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12512395/HBASE-5281.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -140 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 161 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestSplitLogManager&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/869//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/869//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/869//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/869//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/869//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/869//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13196048" author="qwertymaniac" created="Mon, 30 Jan 2012 10:54:11 +0000"  >&lt;p&gt;Only TestSplitLogManager failure appears related to unassigned nodes. Investigating why it failed.&lt;/p&gt;

&lt;p&gt;Strace is:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;java.lang.AssertionError&lt;br/&gt;
	at org.junit.Assert.fail(Assert.java:92)&lt;br/&gt;
	at org.junit.Assert.assertTrue(Assert.java:43)&lt;br/&gt;
	at org.junit.Assert.assertTrue(Assert.java:54)&lt;br/&gt;
	at org.apache.hadoop.hbase.master.TestSplitLogManager.waitForCounter(TestSplitLogManager.java:148)&lt;br/&gt;
	at org.apache.hadoop.hbase.master.TestSplitLogManager.waitForCounter(TestSplitLogManager.java:128)&lt;br/&gt;
	at org.apache.hadoop.hbase.master.TestSplitLogManager.testUnassignedTimeout(TestSplitLogManager.java:414)&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="13197359" author="stack" created="Tue, 31 Jan 2012 22:59:48 +0000"  >&lt;p&gt;I&apos;m not sure removing the abort only is enough Harsh.  If we can&apos;t write zk, we can&apos;t assign a region so holes in the table.  Thats radical.&lt;/p&gt;

&lt;p&gt;We should be consistent regards our policy when a zk write fails.  We are not currently as you&apos;ve found here.&lt;/p&gt;</comment>
                            <comment id="13197440" author="jxiang" created="Wed, 1 Feb 2012 00:46:53 +0000"  >&lt;p&gt;I think it is safer to retry certain times before abort.&lt;/p&gt;</comment>
                            <comment id="13197445" author="stack" created="Wed, 1 Feb 2012 00:53:04 +0000"  >&lt;p&gt;At least in 0.92.0 (and 0.89fb) we are using recoverablezk.  It will retry &apos;recoverable&apos; zk errors.  Are you suggesting something else Jimmy?  That we wrap all zk ops in a higher-level retry loop?&lt;/p&gt;</comment>
                            <comment id="13197472" author="jxiang" created="Wed, 1 Feb 2012 01:10:10 +0000"  >&lt;p&gt;The issue Harsh reported is from a customer using CDH3u2 which doesn&apos;t have the recoverablezk feature.&lt;/p&gt;

&lt;p&gt;I think the recoverablezk feature in 0.92.0 should have fixed this issue.&lt;/p&gt;</comment>
                            <comment id="13197557" author="qwertymaniac" created="Wed, 1 Feb 2012 03:42:49 +0000"  >&lt;p&gt;Thank you for the analysis, stack and Jimmy! Marking as closed for now.&lt;/p&gt;</comment>
                            <comment id="13499120" author="rjustice" created="Fri, 16 Nov 2012 20:27:11 +0000"  >&lt;p&gt;Harsh, In discussion with Kevin, this issue appears to still be a problem.   The attached code,&lt;br/&gt;
if you run the separate method, will crash the master about 50% of the time.   Ping me if you have&lt;br/&gt;
any questions.&lt;/p&gt;</comment>
                            <comment id="13499122" author="rjustice" created="Fri, 16 Nov 2012 20:28:02 +0000"  >&lt;p&gt;Code that splits table 100+ times after creation.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12475630">HBASE-3065</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12512395" name="HBASE-5281.patch" size="833" author="qwertymaniac" created="Mon, 30 Jan 2012 09:41:46 +0000"/>
                            <attachment id="12553830" name="Tester.java" size="6526" author="rjustice" created="Fri, 16 Nov 2012 20:28:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 30 Jan 2012 10:40:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>225394</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 4 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i069j3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34475</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>