<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:25:38 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5199/HBASE-5199.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5199] Delete out of TTL store files before compaction selection</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5199</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Currently, HBase deletes the out of TTL store files after compaction. We can change the sequence to delete the out of TTL store files before selecting store files for compactions. &lt;br/&gt;
In this way, HBase can keep deleting the old invalid store files without compaction, and also prevent from unnecessary compactions since the out of TTL store files will be deleted before the compaction selection.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12538374">HBASE-5199</key>
            <summary>Delete out of TTL store files before compaction selection</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="liyin">Liyin Tang</assignee>
                                    <reporter username="liyin">Liyin Tang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Jan 2012 23:42:08 +0000</created>
                <updated>Fri, 12 Oct 2012 05:35:02 +0000</updated>
                            <resolved>Sat, 11 Feb 2012 17:11:39 +0000</resolved>
                                                    <fixVersion>0.94.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13186029" author="lhofhansl" created="Sat, 14 Jan 2012 00:41:45 +0000"  >&lt;p&gt;Need to pay some special attention to specific delete-marker TTL that FB added (i.e. a delete marker could outlive the TTL of a store). Can&apos;t find the jira for that right, but it was committed relatively recently.&lt;/p&gt;</comment>
                            <comment id="13186058" author="kannanm" created="Sat, 14 Jan 2012 01:49:17 +0000"  >&lt;p&gt;I think Lars is referring to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4721&quot; title=&quot;Retain Delete Markers after Major Compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4721&quot;&gt;&lt;del&gt;HBASE-4721&lt;/del&gt;&lt;/a&gt; by Prakash. Yes, worth making sure it plays well with that &amp;#8211; though I suspect it should work out just fine.&lt;/p&gt;</comment>
                            <comment id="13186059" author="liyin" created="Sat, 14 Jan 2012 01:51:29 +0000"  >&lt;p&gt;Thanks Lars and Kannan. I will double check this.&lt;/p&gt;</comment>
                            <comment id="13188631" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 19:12:39 +0000"  >&lt;p&gt;Liyin requested code review of &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;br/&gt;
Reviewers: Kannan, JIRA&lt;/p&gt;

&lt;p&gt;  Currently, HBase deletes the out of TTL store files after compaction. We can change the sequence to delete the out of TTL store files before selecting store files for compactions.&lt;br/&gt;
  In this way, HBase can keep deleting the old invalid store files without compaction, and also prevent from unnecessary compactions since the out of TTL store files will be deleted before the compaction selection.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  TestStore&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/p&gt;</comment>
                            <comment id="13188633" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 19:16:39 +0000"  >&lt;p&gt;Kannan has added reviewers to the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;br/&gt;
Added Reviewers: khemani, aaiyer, Karthik&lt;/p&gt;

&lt;p&gt;  adding a few more reviewers in case someone else can get to this earlier.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188681" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 20:32:39 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1053 Should this check be moved to line 1016 ?&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1024 Changing &apos;because&apos; to &apos;where&apos; would make the sentence more readable&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188715" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 21:32:39 +0000"  >&lt;p&gt;Karthik has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;  Havent reviewed the test code yet...&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1039 Do we need this assignment? Can we make the condition:&lt;/p&gt;

&lt;p&gt;  if (nonExpiredFiles.size() &amp;lt; currentStoreFiles.size()) &lt;/p&gt;
{
    //...
  }
&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1017 Should we exclude files contained in filesCompacting? Otherwise we could end up deleting a file which is currently being compacted...&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188738" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 22:08:39 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;br/&gt;
Reviewers: Kannan, JIRA, khemani, aaiyer, Karthik&lt;/p&gt;

&lt;p&gt;  Address Karthik&apos;s comments.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/p&gt;</comment>
                            <comment id="13188746" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 22:16:39 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;br/&gt;
Reviewers: Kannan, JIRA, khemani, aaiyer, Karthik&lt;/p&gt;

&lt;p&gt;  Fix a typo.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/p&gt;</comment>
                            <comment id="13188748" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 22:18:39 +0000"  >&lt;p&gt;Karthik has accepted the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;  LGTM!&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188780" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 22:48:39 +0000"  >&lt;p&gt;khemani has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1040 should Readers be notified via notifyChangeReadersObservers()?&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1016 Can this be done inside a readLock() (for most of the compactions no storefiles will actually get removed)&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188819" author="phabricator@reviews.facebook.net" created="Thu, 19 Jan 2012 00:00:39 +0000"  >&lt;p&gt;Liyin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1016 Since this function is to change &amp;lt;this.storeFiles&amp;gt; by deleting the expired storeFiles, writeLock is needed here.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1040 Good Point ! I will update this.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188823" author="phabricator@reviews.facebook.net" created="Thu, 19 Jan 2012 00:08:39 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1040 Currently notifyChangedReadersObservers() is called outside lock.writeLock().&lt;br/&gt;
  Please add the call after line 1044.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188840" author="phabricator@reviews.facebook.net" created="Thu, 19 Jan 2012 00:34:41 +0000"  >&lt;p&gt;khemani has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1016 find out the set of files to be deleted in a read lock. If that set is non-empty, then acquire the write lock and remove the to-be-deleted set of files (if they still exist) from the storefiles set.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188868" author="phabricator@reviews.facebook.net" created="Thu, 19 Jan 2012 01:40:40 +0000"  >&lt;p&gt;Liyin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;  @khemani: I see your point, which inspire me to a new idea: When holding a read lock for selection compaction candidates, it should also select the expired deletion store file candidates. After when processing completeCompaction logic within the write lock, it will delete the expired store files.&lt;/p&gt;

&lt;p&gt;  So this approach should NOT introduce any potential dead lock risk since there is no read or write lock introduced by this feature at all.&lt;/p&gt;

&lt;p&gt;  @tedyu: Thanks for pointing it out. And no additional notifyChangedReadersObservers() is needed if implementing in this way.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188891" author="zhihyu@ebaysf.com" created="Thu, 19 Jan 2012 02:43:01 +0000"  >&lt;p&gt;This becomes interesting, Liyin.&lt;br/&gt;
Currently we have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
          override = region.getCoprocessorHost().preCompactSelection(
              &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, candidates);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If I understand your idea correctly, a sub-list of candidates would be extracted for deletion.&lt;br/&gt;
Do you think that we should expose selection of expired store files through coprocessor ?&lt;/p&gt;</comment>
                            <comment id="13192350" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 18:40:38 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;br/&gt;
Reviewers: Kannan, JIRA, khemani, aaiyer, Karthik&lt;/p&gt;

&lt;p&gt;  During the minor compaction selection time, if there is any expired store files, these expired store files will be selected to compact directly.&lt;br/&gt;
  Since these files have already expired, there would be no-ops during the compaction time and these files will be deleted after the compaction.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/compactions/CompactSelection.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/p&gt;</comment>
                            <comment id="13192352" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 18:42:40 +0000"  >&lt;p&gt;Liyin has requested a review of the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;  Hi @Karthik,&lt;br/&gt;
  The new diff have changed the logic a little bit. There is no need to get the write lock to do the deletion job for these expired store files. It would be much easier to put these expired store files directly to the compaction, which will do the deletion job for free.&lt;/p&gt;

&lt;p&gt;  Would you mind reviewing it again? Thanks&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13192378" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 19:02:39 +0000"  >&lt;p&gt;Karthik has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java:1118 Could we return a new CompactSelection object instead of modifying the existing one and returning a boolean? We can return null or an empty compact selection if there are no such files...&lt;/p&gt;

&lt;p&gt;  CompactSelection expiredFiles = compactSelection.selectExpiredStoreFiles(...)&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13192400" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 19:20:39 +0000"  >&lt;p&gt;Liyin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;br/&gt;
Reviewers: Kannan, JIRA, khemani, aaiyer, Karthik&lt;/p&gt;

&lt;p&gt;  Address @Karthik&apos;s comments.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/compactions/CompactSelection.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/p&gt;</comment>
                            <comment id="13192414" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 19:26:40 +0000"  >&lt;p&gt;Karthik has accepted the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;  Looks good!&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13192518" author="zhihyu@ebaysf.com" created="Tue, 24 Jan 2012 21:10:04 +0000"  >&lt;p&gt;@Liyin:&lt;br/&gt;
Can you try adding JIRA to the CCs ?&lt;/p&gt;

&lt;p&gt;I have to deal with 6 copies of each review email in my InBox.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13192565" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 21:44:39 +0000"  >&lt;p&gt;Liyin added you to the CC list for the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;br/&gt;
Reviewers: Kannan, JIRA, khemani, aaiyer, Karthik&lt;/p&gt;

&lt;p&gt;  Currently, HBase deletes the out of TTL store files after compaction. We can change the sequence to delete the out of TTL store files before selecting store files for compactions.&lt;br/&gt;
  In this way, HBase can keep deleting the old invalid store files without compaction, and also prevent from unnecessary compactions since the out of TTL store files will be deleted before the compaction selection.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  TestStore&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/compactions/CompactSelection.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/p&gt;</comment>
                            <comment id="13195135" author="hadoopqa" created="Fri, 27 Jan 2012 22:02:33 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12512236/HBASE-5199.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12512236/HBASE-5199.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/860//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/860//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13204926" author="liyin" created="Thu, 9 Feb 2012 21:50:51 +0000"  >&lt;p&gt;Ping committers !&lt;/p&gt;</comment>
                            <comment id="13204934" author="zhihyu@ebaysf.com" created="Thu, 9 Feb 2012 22:03:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt;.patch doesn&apos;t apply cleanly:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
3 out of 6 hunks FAILED -- saving rejects to file src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java.rej
patching file src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java
Reversed (or previously applied) patch detected!  Assume -R? [n] 
Apply anyway? [n] 
Skipping patch.
3 out of 3 hunks ignored -- saving rejects to file src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java.rej
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can you rebase patch ?&lt;/p&gt;</comment>
                            <comment id="13205142" author="liyin" created="Fri, 10 Feb 2012 01:39:42 +0000"  >&lt;p&gt;The new patch is rebased on the latest trunk and all the unit tests are passed.&lt;/p&gt;</comment>
                            <comment id="13205163" author="hadoopqa" created="Fri, 10 Feb 2012 02:24:08 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12514057/hbase-5199.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12514057/hbase-5199.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -136 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 156 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.TestReplicationPeer&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestHFileBlock&lt;br/&gt;
                  org.apache.hadoop.hbase.TestDrainingServer&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/934//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/934//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/934//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/934//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/934//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/934//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13205171" author="phabricator@reviews.facebook.net" created="Fri, 10 Feb 2012 02:31:57 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;  @Liyin: could you please post the rebased version of the patch so I can commit?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13205172" author="phabricator@reviews.facebook.net" created="Fri, 10 Feb 2012 02:31:58 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;  @Liyin: could you please post the rebased version of the patch so I can commit?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13205173" author="phabricator@reviews.facebook.net" created="Fri, 10 Feb 2012 02:31:59 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;  @Liyin: could you please post the rebased version of the patch so I can commit?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13205174" author="phabricator@reviews.facebook.net" created="Fri, 10 Feb 2012 02:32:00 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;  @Liyin: could you please post the rebased version of the patch so I can commit?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13206163" author="zhihyu@ebaysf.com" created="Sat, 11 Feb 2012 16:31:54 +0000"  >&lt;p&gt;The test failures were not related to this patch.&lt;/p&gt;

&lt;p&gt;Integrated to TRUNK.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Liyin.&lt;/p&gt;

&lt;p&gt;Thanks for the review Karthick, Prakash and Mikhail.&lt;/p&gt;</comment>
                            <comment id="13206171" author="hudson" created="Sat, 11 Feb 2012 17:05:16 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2659 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2659/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2659/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Differential revision 1311 Delete out of TTL store files before compaction selection (Liyin)&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/CompactSelection.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13206694" author="hudson" created="Mon, 13 Feb 2012 05:46:03 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #109 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/109/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/109/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Differential revision 1311 Delete out of TTL store files before compaction selection (Liyin) (Revision 1243086)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/compactions/CompactSelection.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13209160" author="phabricator@reviews.facebook.net" created="Thu, 16 Feb 2012 06:53:00 +0000"  >&lt;p&gt;mbautin has committed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13209163" author="phabricator@reviews.facebook.net" created="Thu, 16 Feb 2012 06:53:02 +0000"  >&lt;p&gt;mbautin has committed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13209167" author="phabricator@reviews.facebook.net" created="Thu, 16 Feb 2012 06:53:05 +0000"  >&lt;p&gt;mbautin has committed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13209168" author="phabricator@reviews.facebook.net" created="Thu, 16 Feb 2012 06:53:06 +0000"  >&lt;p&gt;mbautin has committed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13209173" author="phabricator@reviews.facebook.net" created="Thu, 16 Feb 2012 06:53:09 +0000"  >&lt;p&gt;mbautin has committed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5199&quot; title=&quot;Delete out of TTL store files before compaction selection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5199&quot;&gt;&lt;del&gt;HBASE-5199&lt;/del&gt;&lt;/a&gt; Delete out of TTL store files before compaction selection &quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1311&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1239786&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12539693">HBASE-5274</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12529705">HBASE-4717</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12546183">HBASE-5568</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12511024" name="ASF.LICENSE.NOT.GRANTED--D1311.1.patch" size="4892" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 19:12:40 +0000"/>
                            <attachment id="12511044" name="ASF.LICENSE.NOT.GRANTED--D1311.2.patch" size="4987" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 22:08:40 +0000"/>
                            <attachment id="12511045" name="ASF.LICENSE.NOT.GRANTED--D1311.3.patch" size="5376" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 22:16:40 +0000"/>
                            <attachment id="12511701" name="ASF.LICENSE.NOT.GRANTED--D1311.4.patch" size="7607" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 18:40:39 +0000"/>
                            <attachment id="12511737" name="ASF.LICENSE.NOT.GRANTED--D1311.5.patch" size="7772" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 21:44:41 +0000"/>
                            <attachment id="12511708" name="ASF.LICENSE.NOT.GRANTED--D1311.5.patch" size="7772" author="phabricator@reviews.facebook.net" created="Tue, 24 Jan 2012 19:20:40 +0000"/>
                            <attachment id="12514057" name="hbase-5199.patch" size="12063" author="liyin" created="Fri, 10 Feb 2012 01:39:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 14 Jan 2012 00:41:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>223880</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0166v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4772</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>set hbase.store.delete.expired.storefile as true to enable the expired store file deletion</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>