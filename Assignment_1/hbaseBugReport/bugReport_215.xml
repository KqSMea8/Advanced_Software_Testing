<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:42:08 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-215/HBASE-215.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-215] HBaseConfiguration(Configuration c) constructor shouldn&apos;t overwrite passed conf with defaults</title>
                <link>https://issues.apache.org/jira/browse/HBASE-215</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;While testing out mapreduce with hbase, in the map portion of a task, the map would try to connect to an hbase master at localhost/127.0.0.1.  The config passed to the hbaseconfiguration contained the necessary hbase configuration information, but I assume was being overwritten by the defaults in the config files during addResource, as commenting out addHbaseResources in the constructor fixed the symptom.  I would expect the configs to be layered on top of each other, e.g. default, then site, then the config passed as a parameter.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12386028">HBASE-215</key>
            <summary>HBaseConfiguration(Configuration c) constructor shouldn&apos;t overwrite passed conf with defaults</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="thomas536">Thomas Garner</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Jan 2008 07:06:41 +0000</created>
                <updated>Fri, 22 Aug 2008 21:34:55 +0000</updated>
                            <resolved>Mon, 28 Jan 2008 19:49:51 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12558167" author="stack" created="Fri, 11 Jan 2008 23:55:39 +0000"  >&lt;p&gt;Would adding a test that checked that c.getResource(&quot;hbase-default.xml&quot;) and c.getResource(&quot;hbase-site.xml&quot;) were non-null in HBaseConfiguration(Configuration c) work?&lt;/p&gt;</comment>
                            <comment id="12558286" author="thomas536" created="Sat, 12 Jan 2008 20:10:52 +0000"  >&lt;p&gt;I&apos;m not sure I understand your logic.  Are you saying that when hbase is reading hbase-default and hbase-site, that it&apos;s not finding them on disk (they are there and properly configured in /usr/local/hadoop/src/contrib/hbase/conf on both of my mapreduce nodes), and then injecting defaults from somewhere other than the xml files?&lt;/p&gt;

&lt;p&gt;To test this, I edited hbase-default on one node, and I am now seeing the change (hbase.master to default:60000):&lt;/p&gt;

&lt;p&gt;2008-01-12 19:56:59,675 DEBUG org.apache.hadoop.mapred.TaskTracker: Child starting&lt;br/&gt;
2008-01-12 19:57:00,038 INFO org.apache.hadoop.metrics.jvm.JvmMetrics: Initializing JVM Metrics with processName=MAP, sessionId=&lt;br/&gt;
2008-01-12 19:57:00,284 INFO org.apache.hadoop.mapred.MapTask: numReduceTasks: 1&lt;br/&gt;
2008-01-12 19:57:00,353 INFO org.apache.hadoop.conf.Configuration: HBaseConfiguration after super(c): hbase.master: master:60000&lt;br/&gt;
2008-01-12 19:57:00,420 INFO org.apache.hadoop.conf.Configuration: HBaseConfiguration after hbase-default.xml: hbase.master: default:60000&lt;br/&gt;
2008-01-12 19:57:00,420 INFO org.apache.hadoop.conf.Configuration: HBaseConfiguration after hbase-site.xml: hbase.master: default:60000&lt;br/&gt;
2008-01-12 19:57:00,428 DEBUG org.apache.hadoop.hbase.HConnectionManager: DEBUG: HConnection getConnection(): hbase.master: default:60000&lt;br/&gt;
2008-01-12 19:57:00,438 INFO org.apache.hadoop.conf.Configuration: HBaseConfiguration after super(c): hbase.master: default:60000&lt;br/&gt;
2008-01-12 19:57:00,444 DEBUG org.apache.hadoop.hbase.HConnectionManager$TableServers: No servers for wordcount. Doing a find...&lt;br/&gt;
2008-01-12 19:57:10,119 INFO org.apache.hadoop.hbase.HConnectionManager$TableServers: Attempt 0 of 5 failed with . Retrying after sleep of 10000&lt;br/&gt;
2008-01-12 19:57:20,132 INFO org.apache.hadoop.hbase.HConnectionManager$TableServers: Attempt 1 of 5 failed with . Retrying after sleep of 10000&lt;br/&gt;
2008-01-12 19:57:30,144 INFO org.apache.hadoop.hbase.HConnectionManager$TableServers: Attempt 2 of 5 failed with . Retrying after sleep of 10000&lt;br/&gt;
2008-01-12 19:57:40,153 INFO org.apache.hadoop.hbase.HConnectionManager$TableServers: Attempt 3 of 5 failed with . Retrying after sleep of 10000&lt;/p&gt;

&lt;p&gt;Here&apos;s the log from an earlier mr job/task, where you see the original hbase.master value be correct (master:60000), then change to local (as was the value in the hbase-default file):&lt;/p&gt;

&lt;p&gt;2008-01-12 19:16:49,005 INFO org.apache.hadoop.metrics.jvm.JvmMetrics: Initializing JVM Metrics with processName=MAP, sessionId=&lt;br/&gt;
2008-01-12 19:16:49,253 INFO org.apache.hadoop.mapred.MapTask: numReduceTasks: 1&lt;br/&gt;
2008-01-12 19:16:49,333 INFO org.apache.hadoop.conf.Configuration: HBaseConfiguration after super(c): hbase.master: master:60000&lt;br/&gt;
2008-01-12 19:16:49,403 INFO org.apache.hadoop.conf.Configuration: HBaseConfiguration after hbase-default.xml: hbase.master: local&lt;br/&gt;
2008-01-12 19:16:49,404 INFO org.apache.hadoop.conf.Configuration: HBaseConfiguration after hbase-site.xml: hbase.master: local&lt;br/&gt;
2008-01-12 19:16:49,421 INFO org.apache.hadoop.conf.Configuration: HBaseConfiguration after super(c): hbase.master: local&lt;br/&gt;
2008-01-12 19:16:49,453 INFO org.apache.hadoop.ipc.Client: Retrying connect to server: localhost/127.0.0.1:60000. Already tried 1 time(s).&lt;br/&gt;
2008-01-12 19:16:50,458 INFO org.apache.hadoop.ipc.Client: Retrying connect to server: localhost/127.0.0.1:60000. Already tried 2 time(s).&lt;br/&gt;
2008-01-12 19:16:51,462 INFO org.apache.hadoop.ipc.Client: Retrying connect to server: localhost/127.0.0.1:60000. Already tried 3 time(s).&lt;br/&gt;
2008-01-12 19:16:52,466 INFO org.apache.hadoop.ipc.Client: Retrying connect to server: localhost/127.0.0.1:60000. Already tried 4 time(s).&lt;/p&gt;

&lt;p&gt;I don&apos;t have an issue allowing mr nodes to read hbase default and site configs (say for optimizations applicable to all hbase mr jobs that are pushed to disk for every node), so long as config values specific to my job override any default values.&lt;/p&gt;

&lt;p&gt;I&apos;m surprised that there&apos;s no set method in the configuration class that takes a configuration as a parameter, then all you&apos;d have to do is super on the default, then set the site and set the passed config, each overriding any existing parameters.&lt;/p&gt;</comment>
                            <comment id="12558292" author="stack" created="Sat, 12 Jan 2008 20:46:51 +0000"  >&lt;p&gt;Pardon me.  My logic was, if the hbase-*.xml files have not been added to the config. already, then go ahead and add them.  I wasn&apos;t sure if it would work (in fact, thinking on it, the config. by the time it gets out to the map task, resource files will already have been read so my suggested test will likely fail).  I was asking you to try it/give an opinion.&lt;/p&gt;

&lt;p&gt;Do your cluster members have an hbase-site.xml with customizations such as hbase.master=master:60000 out on the cluster available off the CLASSPATH &amp;#8211; i.e. in $HADOOP_HOME/conf, or in $HADOOOP_CLASSPATH or in the job jar &amp;#8211; or were the hbase customizations only present on the master or added when you set up the job?&lt;/p&gt;

&lt;p&gt;This issue has burned a few other folks in the past.  Thanks for help w/ it.  Need to fix it.&lt;/p&gt;

&lt;p&gt;Related, I&apos;ve been trying to keep up a page on MR+hbase here: &lt;a href=&quot;http://wiki.apache.org/lucene-hadoop/Hbase/MapReduce&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/lucene-hadoop/Hbase/MapReduce&lt;/a&gt;.  You might have some edits/additions to make.&lt;/p&gt;


</comment>
                            <comment id="12563263" author="stack" created="Mon, 28 Jan 2008 19:49:51 +0000"  >&lt;p&gt;This issue seems to have died.  Its taken up anew in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-220&quot; title=&quot;Copy Constructor HBaseConfiguration(Configuration) will override hbase configurations if argumant is not an instance of HBaseConfiguration.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-220&quot;&gt;&lt;del&gt;HADOOP-2718&lt;/del&gt;&lt;/a&gt;, a duplicate.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 11 Jan 2008 23:55:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24999</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 47 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h5hz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98153</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>