<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:14:16 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3918/HBASE-3918.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3918] When assigning regions to an address, check the regionserver is actually online first</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3918</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This one came up in the case where the data was copied from one cluster to another.  The first cluster was running 0.89.x.  The second 0.90.x.  On startup of 0.90.x, it wanted to verify .META. was in the location &lt;del&gt;ROOT&lt;/del&gt; said it was at, so it tried connect to the FIRST cluster.  The attempt failed because of mismatched RPCs.  The master then actually aborted.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.hadoop.hbase.ipc.HBaseRPC$VersionMismatch: Protocol org.apache.hadoop.hbase.ipc.HRegionInterface version mismatch. (client = 27, server = 24)
at org.apache.hadoop.hbase.ipc.HBaseRPC.getProxy(HBaseRPC.java:424)
at org.apache.hadoop.hbase.ipc.HBaseRPC.getProxy(HBaseRPC.java:393)
at org.apache.hadoop.hbase.ipc.HBaseRPC.getProxy(HBaseRPC.java:444)
at org.apache.hadoop.hbase.ipc.HBaseRPC.waitForProxy(HBaseRPC.java:349)
at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getHRegionConnection(HConnectionManager.java:965)
at org.apache.hadoop.hbase.catalog.CatalogTracker.getCachedConnection(CatalogTracker.java:386)
at org.apache.hadoop.hbase.catalog.CatalogTracker.getMetaServerConnection(CatalogTracker.java:285)
at org.apache.hadoop.hbase.catalog.CatalogTracker.verifyMetaRegionLocation(CatalogTracker.java:486)
at org.apache.hadoop.hbase.master.HMaster.assignRootAndMeta(HMaster.java:442)
at org.apache.hadoop.hbase.master.HMaster.finishInitialization(HMaster.java:389)
at org.apache.hadoop.hbase.master.HMaster.run(HMaster.java:283)
2011-05-23 22:38:07,720 INFO org.apache.hadoop.hbase.master.HMaster: Aborting
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12508217">HBASE-3918</key>
            <summary>When assigning regions to an address, check the regionserver is actually online first</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 May 2011 16:54:35 +0000</created>
                <updated>Tue, 4 Sep 2012 23:50:56 +0000</updated>
                            <resolved>Tue, 4 Sep 2012 23:50:56 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13038662" author="stack" created="Tue, 24 May 2011 16:56:00 +0000"  >&lt;p&gt;So, the above is .META. but then once we get past this if retain assignments is set, we&apos;ll run into the same issue with all user-space regions as we try to connect to their old locations.  Should check that the referenced regionserver is actually a member of the online set before we resasign.&lt;/p&gt;</comment>
                            <comment id="13068902" author="ram_krish" created="Thu, 21 Jul 2011 11:02:24 +0000"  >&lt;p&gt;@Stack,&lt;br/&gt;
I think this one issue due to rolling restart.&lt;/p&gt;

&lt;p&gt;Is this applicable when the cluster belongs to older version before 0.90(0.89.x) and 0.90.x versions?&lt;br/&gt;
When i had my RS in the 0.90 and my master in 0.91 version then the RS is not even able to read the master address string.  I think there is a change here between 0.90 and 0.91.&lt;/p&gt;

&lt;p&gt;So my query is, is this defect applicable only between 0.89.x and 0.90.x versions?&lt;/p&gt;
</comment>
                            <comment id="13070110" author="stack" created="Sun, 24 Jul 2011 05:31:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;So my query is, is this defect applicable only between 0.89.x and 0.90.x versions?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, the servername format has changed between 0.91 and 0.90 and they will not be able to communicate.  I&apos;m not this issue is specific to 0.89 and 0.90.  Regardless, I&apos;d think that we should check that a server actually belongs to our current cluster before we go to use it don&apos;t you think Ram?&lt;/p&gt;</comment>
                            <comment id="13071781" author="ram_krish" created="Wed, 27 Jul 2011 14:58:25 +0000"  >&lt;p&gt;@Stack.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;This one came up in the case where the data was copied from one cluster to another
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;How was this copying done? Is it through replication?  I have a doubt here&lt;br/&gt;
In this link &apos;http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/replication/package-summary.html#requirements&apos;&lt;br/&gt;
I found a requirement like &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Both clusters should have the same HBase and Hadoop major revision. For example, having 0.90.1 on the master and 0.90.0 on the slave is correct but not 0.90.1 and 0.89.20100725.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So how can i first copy the data from 0.89 version to 0.90.  Sorry if my query is very basic? Am not aware of replication.  &lt;/p&gt;</comment>
                            <comment id="13071935" author="stack" created="Wed, 27 Jul 2011 19:28:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;How was this copying done?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It was hdfs copy I believe (Not replication)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;So how can i first copy the data from 0.89 version to 0.90. Sorry if my query is very basic? Am not aware of replication.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So 0.89 data was copied from one cluster to another using distcp or something and then a 0.90 was started over it.&lt;/p&gt;</comment>
                            <comment id="13448167" author="lhofhansl" created="Tue, 4 Sep 2012 23:16:03 +0000"  >&lt;p&gt;Is this still an issue? Being able to copy an HBase root directory to another cluster and start HBase there seems important.&lt;/p&gt;</comment>
                            <comment id="13448210" author="stack" created="Tue, 4 Sep 2012 23:50:56 +0000"  >&lt;p&gt;Resolving as &apos;not a problem&apos;.  When I look at bulk assigning code that tries to retain assignments, I see that for each region we are to assign, we check that the ServerName is known &amp;#8211; that it is a server that has registered itself on cluster start:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; numRandomAssignments = 0;
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; numRetainedAssigments = 0;
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;HRegionInfo, ServerName&amp;gt; entry : regions.entrySet()) {
      HRegionInfo region = entry.getKey();
      ServerName oldServerName = entry.getValue();
      List&amp;lt;ServerName&amp;gt; localServers = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;ServerName&amp;gt;();
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (oldServerName != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        localServers = serversByHostname.get(oldServerName.getHostname());
      }
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (localServers.isEmpty()) {
        &lt;span class=&quot;code-comment&quot;&gt;// No servers on the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; cluster match up with &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; hostname,
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// assign randomly.
&lt;/span&gt;        ServerName randomServer = servers.get(RANDOM.nextInt(servers.size()));
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We can open new issue if we run into this again.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 21 Jul 2011 11:02:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27091</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hoin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101234</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>