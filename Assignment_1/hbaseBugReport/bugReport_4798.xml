<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:22:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4798/HBASE-4798.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4798] Sleeps and synchronisation improvements for tests</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4798</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Multiple small changes:&lt;/p&gt;

&lt;p&gt;@commiters: Removing some sleeps made visible a bug on JVMClusterUtil#HMaster#waitForServerOnline, so I had to add a synchro point. You may want to review this.&lt;/p&gt;

&lt;p&gt;JVMClusterUtil#HMaster#waitForServerOnline: removed, the condition was never met (test on &quot;!c &amp;amp;&amp;amp; !!c&quot;). Added a new synchronization point.&lt;/p&gt;

&lt;p&gt;AssignementManager#waitForAssignment: add a timeout on the wait =&amp;gt; not stuck if the notification is received before the wait.&lt;/p&gt;

&lt;p&gt;HMaster#loop: use a notification instead of a 1s sleep&lt;/p&gt;

&lt;p&gt;HRegionServer#waitForServerOnline: new method used by JVMClusterUtil#waitForServerOnline() to replace a 1s sleep by a notification&lt;/p&gt;

&lt;p&gt;HRegionServer#getMaster() 1s sleeps replaced by one 0,1s sleep and one 0,2s sleep&lt;/p&gt;

&lt;p&gt;HRegionServer#stop: use a notification on sleeper to lower shutdown by 0,5s&lt;/p&gt;

&lt;p&gt;ZooKeeperNodeTracker#start: replace a recursive call by a loop&lt;/p&gt;

&lt;p&gt;ZooKeeperNodeTracker#blockUntilAvailable: add a timeout on the wait =&amp;gt; not stuck if the notification is received before the wait.&lt;/p&gt;

&lt;p&gt;HBaseTestingUtility#expireSession: use a timeout of 1s instead of 5s&lt;/p&gt;

&lt;p&gt;TestZooKeeper#testClientSessionExpired: use a timeout of 1s instead of 5s, with the change on HBaseTestingUtility we are 60s faster&lt;/p&gt;

&lt;p&gt;TestRegionRebalancing#waitForAllRegionsAssigned: use a sleep of 0,2s instead of 1s&lt;/p&gt;

&lt;p&gt;TestRestartCluster#testClusterRestart: send all the table creation together, then check creation, should be faster&lt;/p&gt;

&lt;p&gt;TestHLog: shutdown the whole cluster instead of DFS only (more standard) &lt;/p&gt;

&lt;p&gt;JVMClusterUtil#startup: lower the sleep from 1s to 0,1s&lt;/p&gt;

&lt;p&gt;HConnectionManager#close: Zookeeper name in debug message from HConnectionManager after connection close was always null because it was set to null in the delete.&lt;/p&gt;</description>
                <environment>&lt;p&gt;all&lt;/p&gt;</environment>
        <key id="12531583">HBASE-4798</key>
            <summary>Sleeps and synchronisation improvements for tests</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nkeywal">Nicolas Liochon</assignee>
                                    <reporter username="nkeywal">Nicolas Liochon</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Nov 2011 08:49:12 +0000</created>
                <updated>Fri, 12 Oct 2012 05:34:57 +0000</updated>
                            <resolved>Tue, 22 Nov 2011 01:05:02 +0000</resolved>
                                    <version>0.94.0</version>
                                    <fixVersion>0.94.0</fixVersion>
                                    <component>master</component>
                    <component>regionserver</component>
                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13151097" author="nkeywal" created="Wed, 16 Nov 2011 08:54:08 +0000"  >&lt;p&gt;let&apos;s see how it behaves on the integration servers&lt;/p&gt;</comment>
                            <comment id="13151131" author="hadoopqa" created="Wed, 16 Nov 2011 10:41:06 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12503854/4798_trunk_all.v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12503854/4798_trunk_all.v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 21 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -163 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 51 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort&lt;br/&gt;
                  org.apache.hadoop.hbase.catalog.TestCatalogTrackerOnCluster&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/263//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/263//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/263//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/263//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/263//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/263//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13151146" author="nkeywal" created="Wed, 16 Nov 2011 11:53:25 +0000"  >&lt;p&gt;@commiters: for catalog.TestCatalogTrackerOnCluster.testBadOriginalRootLocation, the test is&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    ServerName nonsense =
      new ServerName(&quot;example.org&quot;, 1234, System.currentTimeMillis());
    RootLocationEditor.setRootLocation(zookeeper, nonsense);
    // Bring back up the hbase cluster.  See if it can deal with nonsense root
    // location.
    UTIL.startMiniHBaseCluster(1, 1);
    UTIL.shutdownMiniCluster();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It appears that when the root location is invalid, the master cannot be initialized. The exception fails now because I modified the JVMClusterUtil#startup to make sure that the cluster is initialized when we leave the method (with a timeout avec 30s: that what&apos;s going on here). I prefer this, because it&apos;s a well known state (instead of sometimes initialized; sometimes not, depending on the sleeps that took place). It means that I would have to modify this test case to make it accept the exception. Are you ok?&lt;/p&gt;

&lt;p&gt;I also look after the other errors.&lt;/p&gt;</comment>
                            <comment id="13151239" author="nkeywal" created="Wed, 16 Nov 2011 14:47:43 +0000"  >&lt;p&gt;@commiters: For coprocessor.TestRegionServerCoprocessorExceptionWithAbort, it&apos;s a little bit strange. It fails sometimes, but not always. When it succeeds, there are 3 retry, and it stops trying and the test is over. On failure, it tries up to 10 times before being interrupt in the middle of a try by the test timeout (because the waiting time between retries is greater then the timeout). Question: are the retries expected?&lt;br/&gt;
If you increase the timeout enough, it&apos;s the &apos;put&apos; which is marked as failed, but the region does not abort for the failure scenario.&lt;/p&gt;</comment>
                            <comment id="13151613" author="stack" created="Wed, 16 Nov 2011 23:11:28 +0000"  >&lt;blockquote&gt;&lt;p&gt;It appears that when the root location is invalid, the master cannot be initialized.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What happens?  Don&apos;t we just fail to verify the nonsense location and we then assign it elsewhere?  Thats whats supposed to happen IIRC.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It means that I would have to modify this test case to make it accept the exception. Are you ok?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sure, caveat the above.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;For coprocessor.TestRegionServerCoprocessorExceptionWithAbort, it&apos;s a little bit strange.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Let me ask the author (Eugene I believe).&lt;/p&gt;</comment>
                            <comment id="13151622" author="stack" created="Wed, 16 Nov 2011 23:22:06 +0000"  >&lt;p&gt;On the patch, convention is spaces around operators as in &apos;zooKeeper &lt;span class=&quot;error&quot;&gt;Unable to render embedded object: File (= null&amp;#39; rather than &amp;#39;zooKeeper) not found.&lt;/span&gt;=null&apos; or &apos;previousLogTime = System.currentTimeMillis();&apos; rather than &apos;previousLogTime =System.currentTimeMillis();&apos;.  No biggie.  Next time.  &lt;/p&gt;

&lt;p&gt;We don&apos;t want to let these out (What does sleeper.sleep() do?)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+        &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(100);
+      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException ignored) {
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Its looks like you are copying the above from elsewhere in the code; i.e. not yours originally....  but if possible, lets let it out?&lt;/p&gt;

&lt;p&gt;What changed here (white space?):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(ZKUtil.watchAndCheckExists(watcher, node)) {
-        &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [] data = ZKUtil.getDataAndWatch(watcher, node);
-        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(data != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ZKUtil.watchAndCheckExists(watcher, node)) {
+        &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] data = ZKUtil.getDataAndWatch(watcher, node);
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (data != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Patch looks good otherwise.  Would commit if all tests passed.&lt;/p&gt;</comment>
                            <comment id="13151634" author="nkeywal" created="Wed, 16 Nov 2011 23:37:00 +0000"  >&lt;p&gt;I will add the spaces.&lt;/p&gt;

&lt;p&gt;sleeper.sleep() does not sleep &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. It waits and can be interrupted by a notify. As there is notification here, I though it was better to have a raw sleep. As least I need to create a specific sleeper as they don&apos;t share the notification.&lt;/p&gt;

&lt;p&gt;on ZKUtil it must be an error, I will remove it.&lt;/p&gt;

&lt;p&gt;On root location I played with it but can&apos;t make it work or fails properly. With my modif (I will revert them to compare), it cannot be initialized (it can be stopped if you don&apos;t wait for the initialisation). In the code I see that HMaster waits for the region server (waitForRegionServers). This function does finish until there is not at least one region (whatever the timeout you need to have one region or more to continue. The zookeeper check is done later). And it&apos;s only after this function that assignRootAndMeta is called. So if the region are using the wrong data as well the master cannot continue as no region will be registered. Actually&lt;/p&gt;
</comment>
                            <comment id="13151638" author="nkeywal" created="Wed, 16 Nov 2011 23:40:37 +0000"  >&lt;p&gt;(comment continued) actually Ted mentioned me an error he saw while testing another jira, it could be related to this part of code as well.&lt;/p&gt;

&lt;p&gt;At least we should change the test to make clear. In the test case, if I start with rubbish,  the server should them start and then be fully available; I should be able to create a table and put some data in it? Not only stop it as in today&apos;s test implementation?&lt;/p&gt;</comment>
                            <comment id="13151650" author="nkeywal" created="Wed, 16 Nov 2011 23:54:34 +0000"  >&lt;p&gt;This said, when I look at the traces, it seems that it&apos;s something different that&apos;s going on.&lt;br/&gt;
@stack; please just confirm that the cluster should be fully available even if root is corrupted. I will then play with the debugger;&lt;/p&gt;

&lt;p&gt;fyi, here are the logs:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2011-11-16 10:21:19,492 INFO  [main] client.HConnectionManager$HConnectionImplementation(1706): Closed zookeeper sessionid=0x133ad9c76a60003
2011-11-16 10:21:19,494 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): master:58532-0x133ad9c76a60000 Received ZooKeeper Event, type=NodeDeleted, state=SyncConnected, path=/hbase/master
2011-11-16 10:21:19,495 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): hconnection-0x133ad9c76a60003 Received ZooKeeper Event, type=NodeDeleted, state=SyncConnected, path=/hbase/master
2011-11-16 10:21:19,497 INFO  [Master:0;localhost,58532,1321467672954] master.HMaster(336): HMaster main thread exiting
2011-11-16 10:21:19,506 WARN  [main-EventThread] zookeeper.ZKUtil(234): hconnection-0x133ad9c76a60003 Unable to set watcher on znode /hbase/master
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /hbase/master
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:42)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:809)
	at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.exists(RecoverableZooKeeper.java:154)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.watchAndCheckExists(ZKUtil.java:225)
	at org.apache.hadoop.hbase.zookeeper.ZooKeeperNodeTracker.nodeDeleted(ZooKeeperNodeTracker.java:182)
	at org.apache.hadoop.hbase.zookeeper.ZooKeeperWatcher.process(ZooKeeperWatcher.java:262)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:530)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:506)
2011-11-16 10:21:19,506 ERROR [main-EventThread] zookeeper.ZooKeeperWatcher(363): hconnection-0x133ad9c76a60003 Received unexpected KeeperException, re-throwing exception
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /hbase/master
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:42)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:809)
	at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.exists(RecoverableZooKeeper.java:154)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.watchAndCheckExists(ZKUtil.java:225)
	at org.apache.hadoop.hbase.zookeeper.ZooKeeperNodeTracker.nodeDeleted(ZooKeeperNodeTracker.java:182)
	at org.apache.hadoop.hbase.zookeeper.ZooKeeperWatcher.process(ZooKeeperWatcher.java:262)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:530)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:506)
2011-11-16 10:21:19,523 INFO  [main-EventThread] client.HConnectionManager$HConnectionImplementation(1624): This client just lost it&apos;s session with ZooKeeper, trying to reconnect.
2011-11-16 10:21:19,523 INFO  [main-EventThread] client.HConnectionManager$HConnectionImplementation(541): Trying to reconnect to zookeeper
2011-11-16 10:21:19,524 DEBUG [main-EventThread] zookeeper.ZKUtil(95): hconnection opening connection to ZooKeeper with ensemble (localhost:56525)
2011-11-16 10:21:19,526 INFO  [main-EventThread] zookeeper.RecoverableZooKeeper(89): The identifier of this process is 19557@ubuntu
2011-11-16 10:21:19,532 DEBUG [main] zookeeper.ZKUtil(95): Bad Root Location Writer opening connection to ZooKeeper with ensemble (localhost:56525)
2011-11-16 10:21:19,533 INFO  [main] zookeeper.RecoverableZooKeeper(89): The identifier of this process is 19557@ubuntu
2011-11-16 10:21:19,534 INFO  [main] catalog.RootLocationEditor(62): Setting ROOT region location in ZooKeeper as example.org,1234,1321467679534
2011-11-16 10:21:19,536 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): hconnection Received ZooKeeper Event, type=None, state=SyncConnected, path=null
2011-11-16 10:21:19,537 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): Bad Root Location Writer Received ZooKeeper Event, type=None, state=SyncConnected, path=null
2011-11-16 10:21:19,537 DEBUG [main-EventThread] zookeeper.ZKUtil(230): hconnection /hbase/master does not exist. Watcher is set.
2011-11-16 10:21:19,538 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(315): hconnection-0x133ad9c76a60004 connected
2011-11-16 10:21:19,539 ERROR [main] zookeeper.RecoverableZooKeeper(478): Node /hbase/root-region-server already exists and this is not a retry
2011-11-16 10:21:19,539 DEBUG [main-EventThread] zookeeper.ZKUtil(228): hconnection-0x133ad9c76a60004 Set watcher on existing znode /hbase/root-region-server
2011-11-16 10:21:19,540 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(315): Bad Root Location Writer-0x133ad9c76a60005 connected
2011-11-16 10:21:19,540 DEBUG [main] catalog.RootLocationEditor(67): ROOT region location already existed, updated location
2011-11-16 10:21:19,540 DEBUG [main-EventThread] zookeeper.ZKUtil(1034): hconnection-0x133ad9c76a60004 Retrieved 29 byte(s) of data from znode /hbase/root-region-server and set watcher; localhost,44843,1321467673319
2011-11-16 10:21:19,540 INFO  [main-EventThread] client.HConnectionManager$HConnectionImplementation(1627): Reconnected successfully. This disconnect could have been caused by a network partition or a long-running GC pause, either way it&apos;s recommended that you verify your environment.
2011-11-16 10:21:19,542 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): hconnection-0x133ad9c76a60004 Received ZooKeeper Event, type=NodeDataChanged, state=SyncConnected, path=/hbase/root-region-server
2011-11-16 10:21:19,544 DEBUG [main-EventThread] zookeeper.ZKUtil(1034): hconnection-0x133ad9c76a60004 Retrieved 30 byte(s) of data from znode /hbase/root-region-server and set watcher; example.org,1234,1321467679534
2011-11-16 10:21:19,555 DEBUG [main] util.FSUtils(288): Created version file at hdfs://localhost:40123/user/nkeywal set its version at:7
2011-11-16 10:21:19,568 DEBUG [main] client.HConnectionManager(1805): Set serverside HConnection retries=100
2011-11-16 10:21:19,573 INFO  [main] ipc.HBaseRpcMetrics(59): Initializing RPC Metrics with hostName=HMaster, port=50466
2011-11-16 10:21:19,582 DEBUG [main] zookeeper.ZKUtil(95): master:50466 opening connection to ZooKeeper with ensemble (localhost:56525)
2011-11-16 10:21:19,584 INFO  [main] zookeeper.RecoverableZooKeeper(89): The identifier of this process is 19557@ubuntu
2011-11-16 10:21:19,588 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): master:50466 Received ZooKeeper Event, type=None, state=SyncConnected, path=null
2011-11-16 10:21:19,590 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(315): master:50466-0x133ad9c76a60006 connected
2011-11-16 10:21:19,592 INFO  [main] metrics.MetricsMBeanBase(111): new MBeanInfo
2011-11-16 10:21:19,592 INFO  [main] metrics.MasterMetrics(89): Initialized
2011-11-16 10:21:19,613 DEBUG [main] client.HConnectionManager(1805): Set serverside HConnection retries=100
2011-11-16 10:21:19,619 INFO  [main] ipc.HBaseRpcMetrics(59): Initializing RPC Metrics with hostName=MiniHBaseCluster$MiniHBaseClusterRegionServer, port=55575
2011-11-16 10:21:19,625 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): hconnection-0x133ad9c76a60004 Received ZooKeeper Event, type=NodeCreated, state=SyncConnected, path=/hbase/master
2011-11-16 10:21:19,625 INFO  [Master:0;localhost,50466,1321467679574] master.ActiveMasterManager(139): Master=localhost,50466,1321467679574
2011-11-16 10:21:19,626 DEBUG [Master:0;localhost,50466,1321467679574] master.SplitLogManager(159): timeout = 25000
2011-11-16 10:21:19,626 DEBUG [Master:0;localhost,50466,1321467679574] master.SplitLogManager(160): unassigned timeout = 180000
2011-11-16 10:21:19,626 DEBUG [main-EventThread] zookeeper.ZKUtil(1034): hconnection-0x133ad9c76a60004 Retrieved 31 byte(s) of data from znode /hbase/master and set watcher; \x00\x00localhost,50466,13214...
2011-11-16 10:21:19,627 INFO  [Master:0;localhost,50466,1321467679574] master.SplitLogManager(684): found 0 orphan tasks and 0 rescan nodes
2011-11-16 10:21:19,647 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(95): hconnection opening connection to ZooKeeper with ensemble (localhost:56525)
2011-11-16 10:21:19,648 INFO  [Master:0;localhost,50466,1321467679574] zookeeper.RecoverableZooKeeper(89): The identifier of this process is 19557@ubuntu
2011-11-16 10:21:19,653 DEBUG [Master:0;localhost,50466,1321467679574-EventThread] zookeeper.ZooKeeperWatcher(238): hconnection Received ZooKeeper Event, type=None, state=SyncConnected, path=null
2011-11-16 10:21:19,653 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(228): hconnection Set watcher on existing znode /hbase/master
2011-11-16 10:21:19,654 DEBUG [Master:0;localhost,50466,1321467679574-EventThread] zookeeper.ZooKeeperWatcher(315): hconnection-0x133ad9c76a60007 connected
2011-11-16 10:21:19,654 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(1034): hconnection-0x133ad9c76a60007 Retrieved 31 byte(s) of data from znode /hbase/master and set watcher; \x00\x00localhost,50466,13214...
2011-11-16 10:21:19,655 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(228): hconnection-0x133ad9c76a60007 Set watcher on existing znode /hbase/root-region-server
2011-11-16 10:21:19,656 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(1034): hconnection-0x133ad9c76a60007 Retrieved 30 byte(s) of data from znode /hbase/root-region-server and set watcher; example.org,1234,1321467679534
2011-11-16 10:21:19,656 DEBUG [Master:0;localhost,50466,1321467679574] catalog.CatalogTracker(217): Starting catalog tracker org.apache.hadoop.hbase.catalog.CatalogTracker@2e18ff27
2011-11-16 10:21:19,657 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(228): master:50466-0x133ad9c76a60006 Set watcher on existing znode /hbase/root-region-server
2011-11-16 10:21:19,658 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(1034): master:50466-0x133ad9c76a60006 Retrieved 30 byte(s) of data from znode /hbase/root-region-server and set watcher; example.org,1234,1321467679534
2011-11-16 10:21:19,658 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(230): master:50466-0x133ad9c76a60006 /hbase/unassigned/1028785192 does not exist. Watcher is set.
2011-11-16 10:21:19,660 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(230): master:50466-0x133ad9c76a60006 /hbase/shutdown does not exist. Watcher is set.
2011-11-16 10:21:19,663 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): master:50466-0x133ad9c76a60006 Received ZooKeeper Event, type=NodeCreated, state=SyncConnected, path=/hbase/shutdown
2011-11-16 10:21:19,664 INFO  [Master:0;localhost,50466,1321467679574] master.HMaster(387): Server active/primary master; localhost,50466,1321467679574, sessionid=0x133ad9c76a60006, cluster-up flag was=false
2011-11-16 10:21:19,664 DEBUG [Master:0;localhost,50466,1321467679574] executor.ExecutorService(190): Starting executor service name=MASTER_OPEN_REGION-localhost,50466,1321467679574, corePoolSize=5, maxPoolSize=5
2011-11-16 10:21:19,664 DEBUG [Master:0;localhost,50466,1321467679574] executor.ExecutorService(190): Starting executor service name=MASTER_CLOSE_REGION-localhost,50466,1321467679574, corePoolSize=5, maxPoolSize=5
2011-11-16 10:21:19,664 DEBUG [Master:0;localhost,50466,1321467679574] executor.ExecutorService(190): Starting executor service name=MASTER_SERVER_OPERATIONS-localhost,50466,1321467679574, corePoolSize=3, maxPoolSize=3
2011-11-16 10:21:19,664 DEBUG [Master:0;localhost,50466,1321467679574] executor.ExecutorService(190): Starting executor service name=MASTER_META_SERVER_OPERATIONS-localhost,50466,1321467679574, corePoolSize=5, maxPoolSize=5
2011-11-16 10:21:19,665 DEBUG [Master:0;localhost,50466,1321467679574] executor.ExecutorService(190): Starting executor service name=MASTER_TABLE_OPERATIONS-localhost,50466,1321467679574, corePoolSize=1, maxPoolSize=1
2011-11-16 10:21:19,665 DEBUG [Master:0;localhost,50466,1321467679574] master.LogCleaner(115): Add log cleaner in chain: org.apache.hadoop.hbase.master.TimeToLiveLogCleaner
2011-11-16 10:21:19,665 DEBUG [main-EventThread] zookeeper.ZKUtil(1034): master:50466-0x133ad9c76a60006 Retrieved 28 byte(s) of data from znode /hbase/shutdown and set watcher; Wed Nov 16 10:21:19 PST 2011
2011-11-16 10:21:19,666 DEBUG [Master:0;localhost,50466,1321467679574] master.HMaster(703): Started service threads
2011-11-16 10:21:19,723 INFO  [main] regionserver.ShutdownHook(85): Installed shutdown hook thread: Shutdownhook:RegionServer:0;localhost,55575,1321467679622
2011-11-16 10:21:19,726 DEBUG [RegionServer:0;localhost,55575,1321467679622] zookeeper.ZKUtil(95): regionserver:55575 opening connection to ZooKeeper with ensemble (localhost:56525)
2011-11-16 10:21:19,727 INFO  [RegionServer:0;localhost,55575,1321467679622] zookeeper.RecoverableZooKeeper(89): The identifier of this process is 19557@ubuntu
2011-11-16 10:21:19,733 DEBUG [RegionServer:0;localhost,55575,1321467679622-EventThread] zookeeper.ZooKeeperWatcher(238): regionserver:55575 Received ZooKeeper Event, type=None, state=SyncConnected, path=null
2011-11-16 10:21:19,733 DEBUG [RegionServer:0;localhost,55575,1321467679622] zookeeper.ZKUtil(228): regionserver:55575 Set watcher on existing znode /hbase/master
2011-11-16 10:21:19,734 DEBUG [RegionServer:0;localhost,55575,1321467679622] zookeeper.ZKUtil(1034): regionserver:55575 Retrieved 31 byte(s) of data from znode /hbase/master and set watcher; \x00\x00localhost,50466,13214...
2011-11-16 10:21:19,734 DEBUG [RegionServer:0;localhost,55575,1321467679622-EventThread] zookeeper.ZooKeeperWatcher(315): regionserver:55575-0x133ad9c76a60008 connected
2011-11-16 10:21:19,735 DEBUG [RegionServer:0;localhost,55575,1321467679622] zookeeper.ZKUtil(228): regionserver:55575-0x133ad9c76a60008 Set watcher on existing znode /hbase/shutdown
2011-11-16 10:21:19,736 DEBUG [RegionServer:0;localhost,55575,1321467679622] zookeeper.ZKUtil(1034): regionserver:55575-0x133ad9c76a60008 Retrieved 28 byte(s) of data from znode /hbase/shutdown and set watcher; Wed Nov 16 10:21:19 PST 2011
2011-11-16 10:21:19,736 DEBUG [RegionServer:0;localhost,55575,1321467679622] catalog.CatalogTracker(217): Starting catalog tracker org.apache.hadoop.hbase.catalog.CatalogTracker@35d56bbe
2011-11-16 10:21:19,737 DEBUG [RegionServer:0;localhost,55575,1321467679622] zookeeper.ZKUtil(228): regionserver:55575-0x133ad9c76a60008 Set watcher on existing znode /hbase/root-region-server
2011-11-16 10:21:19,738 DEBUG [RegionServer:0;localhost,55575,1321467679622] zookeeper.ZKUtil(1034): regionserver:55575-0x133ad9c76a60008 Retrieved 30 byte(s) of data from znode /hbase/root-region-server and set watcher; example.org,1234,1321467679534
2011-11-16 10:21:19,738 DEBUG [RegionServer:0;localhost,55575,1321467679622] zookeeper.ZKUtil(230): regionserver:55575-0x133ad9c76a60008 /hbase/unassigned/1028785192 does not exist. Watcher is set.
2011-11-16 10:21:19,739 INFO  [RegionServer:0;localhost,55575,1321467679622] regionserver.MemStoreFlusher(114): globalMemStoreLimit=497.8m, globalMemStoreLimitLowMark=435.6m, maxHeap=1.2g
2011-11-16 10:21:19,739 INFO  [RegionServer:0;localhost,55575,1321467679622] regionserver.HRegionServer$CompactionChecker(1158): Runs every 16mins, 40sec
2011-11-16 10:21:19,767 INFO  [Master:0;localhost,50466,1321467679574] master.ServerManager(530): Waiting on regionserver(s) to checkin
2011-11-16 10:21:19,774 INFO  [RegionServer:0;localhost,55575,1321467679622] regionserver.HRegionServer(1737): Attempting connect to Master server at localhost,50466,1321467679574
2011-11-16 10:21:19,779 INFO  [RegionServer:0;localhost,55575,1321467679622] regionserver.HRegionServer(1766): Connected to master at localhost/127.0.0.1:50466
2011-11-16 10:21:19,779 INFO  [RegionServer:0;localhost,55575,1321467679622] regionserver.HRegionServer(1792): Telling master at localhost,50466,1321467679574 that we are up with port=55575, startcode=1321467679622
2011-11-16 10:21:19,780 INFO  [IPC Server handler 2 on 50466] master.ServerManager(239): Registering server=localhost,55575,1321467679622
2011-11-16 10:21:19,781 INFO  [RegionServer:0;localhost,55575,1321467679622] regionserver.HRegionServer(911): Master passed us hostname to use. Was=localhost, Now=localhost
2011-11-16 10:21:19,781 DEBUG [RegionServer:0;localhost,55575,1321467679622] regionserver.HRegionServer(918): Config from master: fs.default.name=hdfs://localhost:40123
2011-11-16 10:21:19,782 DEBUG [RegionServer:0;localhost,55575,1321467679622] regionserver.HRegionServer(918): Config from master: hbase.rootdir=hdfs://localhost:40123/user/nkeywal
2011-11-16 10:21:19,783 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): master:50466-0x133ad9c76a60006 Received ZooKeeper Event, type=NodeChildrenChanged, state=SyncConnected, path=/hbase/rs
2011-11-16 10:21:19,786 DEBUG [main-EventThread] zookeeper.ZKUtil(228): master:50466-0x133ad9c76a60006 Set watcher on existing znode /hbase/rs/localhost,55575,1321467679622
2011-11-16 10:21:19,788 DEBUG [RegionServer:0;localhost,55575,1321467679622] regionserver.HRegionServer(1219): logdir=hdfs://localhost:40123/user/nkeywal/.logs/localhost,55575,1321467679622
2011-11-16 10:21:19,805 INFO  [RegionServer:0;localhost,55575,1321467679622] wal.HLog(417): HLog configuration: blocksize=64 MB, rollsize=60.8 MB, enabled=true, optionallogflushinternal=1000ms
2011-11-16 10:21:19,806 DEBUG [RegionServer:0;localhost,55575,1321467679622] wal.SequenceFileLogWriter(113): new createWriter -- HADOOP-6840 -- not available
2011-11-16 10:21:19,810 DEBUG [RegionServer:0;localhost,55575,1321467679622] wal.SequenceFileLogWriter(136): Path=hdfs://localhost:40123/user/nkeywal/.logs/localhost,55575,1321467679622/localhost%2C55575%2C1321467679622.1321467679806, syncFs=true, hflush=false
2011-11-16 10:21:19,810 INFO  [RegionServer:0;localhost,55575,1321467679622] wal.HLog(614):  for /user/nkeywal/.logs/localhost,55575,1321467679622/localhost%2C55575%2C1321467679622.1321467679806
2011-11-16 10:21:19,810 INFO  [RegionServer:0;localhost,55575,1321467679622] wal.HLog(459): Using getNumCurrentReplicas--HDFS-826
2011-11-16 10:21:19,811 INFO  [RegionServer:0;localhost,55575,1321467679622] metrics.MetricsMBeanBase(111): new MBeanInfo
2011-11-16 10:21:19,811 INFO  [RegionServer:0;localhost,55575,1321467679622] metrics.RegionServerMetrics(248): Initialized
2011-11-16 10:21:19,812 DEBUG [RegionServer:0;localhost,55575,1321467679622] executor.ExecutorService(190): Starting executor service name=RS_OPEN_REGION-localhost,55575,1321467679622, corePoolSize=3, maxPoolSize=3
2011-11-16 10:21:19,812 DEBUG [RegionServer:0;localhost,55575,1321467679622] executor.ExecutorService(190): Starting executor service name=RS_OPEN_ROOT-localhost,55575,1321467679622, corePoolSize=1, maxPoolSize=1
2011-11-16 10:21:19,812 DEBUG [RegionServer:0;localhost,55575,1321467679622] executor.ExecutorService(190): Starting executor service name=RS_OPEN_META-localhost,55575,1321467679622, corePoolSize=1, maxPoolSize=1
2011-11-16 10:21:19,813 DEBUG [RegionServer:0;localhost,55575,1321467679622] executor.ExecutorService(190): Starting executor service name=RS_CLOSE_REGION-localhost,55575,1321467679622, corePoolSize=3, maxPoolSize=3
2011-11-16 10:21:19,813 DEBUG [RegionServer:0;localhost,55575,1321467679622] executor.ExecutorService(190): Starting executor service name=RS_CLOSE_ROOT-localhost,55575,1321467679622, corePoolSize=1, maxPoolSize=1
2011-11-16 10:21:19,813 DEBUG [RegionServer:0;localhost,55575,1321467679622] executor.ExecutorService(190): Starting executor service name=RS_CLOSE_META-localhost,55575,1321467679622, corePoolSize=1, maxPoolSize=1
2011-11-16 10:21:19,860 INFO  [RegionServer:0;localhost,55575,1321467679622] regionserver.HRegionServer(947): Serving as localhost,55575,1321467679622, RPC listening on localhost/127.0.0.1:55575, sessionid=0x133ad9c76a60008
2011-11-16 10:21:19,860 INFO  [SplitLogWorker-localhost,55575,1321467679622] regionserver.SplitLogWorker(140): SplitLogWorker localhost,55575,1321467679622 starting
2011-11-16 10:21:19,868 INFO  [Master:0;localhost,50466,1321467679574] master.ServerManager(530): Waiting on regionserver(s) count to settle; currently=1
2011-11-16 10:21:19,973 INFO  [Master:0;localhost,50466,1321467679574] master.MasterFileSystem(212): Log folder hdfs://localhost:40123/user/nkeywal/.logs/localhost,55575,1321467679622 belongs to an existing region server
2011-11-16 10:21:19,973 INFO  [Master:0;localhost,50466,1321467679574] master.MasterFileSystem(266): No logs to split
2011-11-16 10:21:19,975 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(518): master:50466-0x133ad9c76a60006 Unable to get data of znode /hbase/unassigned/70236052 because node does not exist (not an error)
2011-11-16 10:21:19,978 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(1034): master:50466-0x133ad9c76a60006 Retrieved 30 byte(s) of data from znode /hbase/root-region-server and set watcher; example.org,1234,1321467679534
2011-11-16 10:21:19,981 DEBUG [Master:0;localhost,50466,1321467679574] zookeeper.ZKUtil(1034): hconnection-0x133ad9c76a60007 Retrieved 36 byte(s) of data from znode /hbase/hbaseid; data=03980100-b09a-48c1-9bf2-70f49...
2011-11-16 10:21:24,550 INFO  [Thread-133] catalog.RootLocationEditor(43): Unsetting ROOT region location in ZooKeeper
2011-11-16 10:21:24,575 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): master:50466-0x133ad9c76a60006 Received ZooKeeper Event, type=NodeDeleted, state=SyncConnected, path=/hbase/root-region-server
2011-11-16 10:21:24,575 DEBUG [Master:0;localhost,50466,1321467679574-EventThread] zookeeper.ZooKeeperWatcher(238): hconnection-0x133ad9c76a60007 Received ZooKeeper Event, type=NodeDeleted, state=SyncConnected, path=/hbase/root-region-server
2011-11-16 10:21:24,576 DEBUG [main-EventThread] zookeeper.ZooKeeperWatcher(238): hconnection-0x133ad9c76a60004 Received ZooKeeper Event, type=NodeDeleted, state=SyncConnected, path=/hbase/root-region-server
2011-11-16 10:21:24,580 DEBUG [RegionServer:0;localhost,55575,1321467679622-EventThread] zookeeper.ZooKeeperWatcher(238): regionserver:55575-0x133ad9c76a60008 Received ZooKeeper Event, type=NodeDeleted, state=SyncConnected, path=/hbase/root-region-server
2011-11-16 10:21:24,581 INFO  [Thread-133] catalog.TestCatalogTrackerOnCluster$2(85): RootLocationEditor is now clean.
2011-11-16 10:21:24,581 DEBUG [Master:0;localhost,50466,1321467679574-EventThread] zookeeper.ZKUtil(230): hconnection-0x133ad9c76a60007 /hbase/root-region-server does not exist. Watcher is set.
2011-11-16 10:21:24,584 DEBUG [main-EventThread] zookeeper.ZKUtil(230): hconnection-0x133ad9c76a60004 /hbase/root-region-server does not exist. Watcher is set.
2011-11-16 10:21:24,584 DEBUG [main-EventThread] zookeeper.ZKUtil(230): master:50466-0x133ad9c76a60006 /hbase/root-region-server does not exist. Watcher is set.
2011-11-16 10:21:24,585 DEBUG [RegionServer:0;localhost,55575,1321467679622-EventThread] zookeeper.ZKUtil(230): regionserver:55575-0x133ad9c76a60008 /hbase/root-region-server does not exist. Watcher is set.
2011-11-16 10:21:49,769 ERROR [main] hbase.MiniHBaseCluster(201): Error starting cluster
java.lang.RuntimeException: Master not initialized after 30 seconds
	at org.apache.hadoop.hbase.util.JVMClusterUtil.startup(JVMClusterUtil.java:206)
	at org.apache.hadoop.hbase.LocalHBaseCluster.startup(LocalHBaseCluster.java:418)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13151655" author="ekoontz" created="Wed, 16 Nov 2011 23:58:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4690&quot; title=&quot;Intermittent TestRegionServerCoprocessorExceptionWithAbort#testExceptionFromCoprocessorDuringPut failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4690&quot;&gt;&lt;del&gt;HBASE-4690&lt;/del&gt;&lt;/a&gt;: Ted filed this to fix to fix (possibly related) failures of the same test (TestRegionServerCoprocessorExceptionWithAbort#testExceptionFromCoprocessorDuringPut failure)&lt;/p&gt;</comment>
                            <comment id="13151656" author="stack" created="Thu, 17 Nov 2011 00:01:31 +0000"  >&lt;p&gt;I confirm cluster should be fully available though root is corrupted.  Its supposed to fail validating the root location then move on to unset and reassign root.&lt;/p&gt;</comment>
                            <comment id="13151663" author="stack" created="Thu, 17 Nov 2011 00:07:28 +0000"  >&lt;p&gt;Looking in log, the 30 seconds seems to elapse real fast.  I count 5 seconds in the above elapsed in snippet posted.... and it seems like we&apos;re starting to come around?&lt;/p&gt;</comment>
                            <comment id="13151670" author="ekoontz" created="Thu, 17 Nov 2011 00:18:29 +0000"  >&lt;p&gt;@nkeywal you wrote: &quot;On failure, it tries up to 10 times before being interrupt in the middle of a try by the test timeout (because the waiting time between retries is greater then the timeout)&quot;&lt;/p&gt;

&lt;p&gt;It seems to me (looking at &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/263//testReport/org.apache.hadoop.hbase.coprocessor/TestRegionServerCoprocessorExceptionWithAbort/testExceptionFromCoprocessorDuringPut/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/263//testReport/org.apache.hadoop.hbase.coprocessor/TestRegionServerCoprocessorExceptionWithAbort/testExceptionFromCoprocessorDuringPut/&lt;/a&gt;) that the test fails at line 84 of the test:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;code&amp;#93;&lt;/span&gt;&lt;br/&gt;
table.put(put)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;code&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;That is, not in the for() loop below that. Does that seem right to you?&lt;/p&gt;</comment>
                            <comment id="13151689" author="ekoontz" created="Thu, 17 Nov 2011 00:41:14 +0000"  >&lt;p&gt;I can reproduce the test failure (with this patch) Looking into it more.&lt;/p&gt;</comment>
                            <comment id="13151700" author="nkeywal" created="Thu, 17 Nov 2011 00:57:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;That is, not in the for() loop below that. Does that seem right to you?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, you&apos;re right that&apos;s a different case from the one I had locally. &lt;/p&gt;</comment>
                            <comment id="13151702" author="ekoontz" created="Thu, 17 Nov 2011 01:03:28 +0000"  >&lt;p&gt;@nkeywal, ok cool. I&apos;m looking into it more. I think the test failures relate to the  changes your patch made to waitForServerOnline(). &lt;/p&gt;</comment>
                            <comment id="13151744" author="nkeywal" created="Thu, 17 Nov 2011 02:27:51 +0000"  >&lt;p&gt;Don&apos;t spend too much of your time on it, i will do the debug &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. But you&lt;br/&gt;
confirm that we should see multiple retries?&lt;br/&gt;
Le 17 nov. 2011 02:03, &quot;Eugene Koontz (Commented) (JIRA)&quot; &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="13151953" author="nkeywal" created="Thu, 17 Nov 2011 09:50:00 +0000"  >&lt;p&gt;For TestCatalogTrackerOnCluster I&apos;ve got it working. It was just stupid: when the root location is wrong, it needs more than 30 seconds to start. So I modified the timeout and now it works as before...&lt;/p&gt;

&lt;p&gt;I will work on TestRegionServerCoprocessorExceptionWithAbort now.&lt;/p&gt;</comment>
                            <comment id="13151996" author="nkeywal" created="Thu, 17 Nov 2011 11:21:10 +0000"  >&lt;p&gt;Ok, I&apos;ve got it for TestRegionServerCoprocessorExceptionWithAbort as well.&lt;/p&gt;

&lt;p&gt;It&apos;s because of my change in HRegionServer#stop:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  public void stop(final String msg) {
    this.stopped = true;
    LOG.info(&quot;STOPPED: &quot; + msg);
    // Wakes run() if it is sleeping
    sleeper.skipSleepCycle();   // &amp;lt;================= NEW
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;This is a notification that makes the region server stops &lt;b&gt;immediately&lt;/b&gt; instead of waiting the next sleep ending.&lt;br/&gt;
So immediately that the poor client sees its region server disappearing during its put, and enters its usual retry stuff. This is slow and the test timeout does not let it finish.&lt;/p&gt;

&lt;p&gt;This bug was already there before my change, it&apos;s just less random now. Now you&apos;ve got it 90% of the time, before it was 0,1% &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Note as well that the current implementation of HRegionServer#stop actually intends to stop immediately but fails because it does the notify on the wrong object. But the comment is clear on the intention. So a bug was hiding another bug. Usual stuff &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;


&lt;p&gt;I am not sure on how to fix this cleanly. We could launch a thread that would wait before aborting in handleCoprocessorThrowable, but it&apos;s more a workaround than anything else. @stack, @eugene, what do you think?&lt;/p&gt;



</comment>
                            <comment id="13152510" author="ekoontz@hiro-tan.org" created="Fri, 18 Nov 2011 00:41:25 +0000"  >&lt;p&gt;Hi nkeywal, I think you should make a review for this jira so that we can compare the old and new code. It&apos;s too hard for me to follow otherwise.&lt;/p&gt;</comment>
                            <comment id="13152857" author="nkeywal" created="Fri, 18 Nov 2011 13:27:25 +0000"  >&lt;p&gt;v5 contains everything except HRegionServer#stop: use a notification on sleeper to lower shutdown time by 0,5s.&lt;br/&gt;
I will create a specific Jira for this one as it implies some changes in TestRegionServerCoprocessorExceptionWithAbort.&lt;/p&gt;

&lt;p&gt;@eugene: with a specific jira it will be simpler &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. But my comment from 17/Nov/11 11:21 contains everything related to TestRegionServerCoprocessorExceptionWithAbort. &lt;/p&gt;</comment>
                            <comment id="13152859" author="hadoopqa" created="Fri, 18 Nov 2011 13:33:50 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12504205/4798_trunk_all.v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12504205/4798_trunk_all.v5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/292//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/292//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13152992" author="hadoopqa" created="Fri, 18 Nov 2011 17:40:20 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12504222/4798_trunk_all.v6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12504222/4798_trunk_all.v6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 59 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestAdmin&lt;br/&gt;
                  org.apache.hadoop.hbase.zookeeper.TestZKLeaderManager&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestShell&lt;br/&gt;
                  org.apache.hadoop.hbase.TestFullLogReconstruction&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/293//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/293//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/293//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/293//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/293//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/293//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13153070" author="hadoopqa" created="Fri, 18 Nov 2011 19:31:58 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12504235/4798_trunk_all.v7.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12504235/4798_trunk_all.v7.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 33 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 59 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.TestReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestShell&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestAdmin&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestDistributedLogSplitting&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/295//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/295//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/295//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/295//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/295//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/295//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13153085" author="nkeywal" created="Fri, 18 Nov 2011 19:55:24 +0000"  >&lt;p&gt;These ones are likely to be in the flaky zone, but I found something better to do so there will be a v8 soon.&lt;/p&gt;</comment>
                            <comment id="13153440" author="hadoopqa" created="Sat, 19 Nov 2011 09:46:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12504344/4798_trunk_all.v10.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12504344/4798_trunk_all.v10.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 21 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 59 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestAdmin&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestMasterObserver&lt;br/&gt;
                  org.apache.hadoop.hbase.master.TestDistributedLogSplitting&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestShell&lt;br/&gt;
                  org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildBase&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/309//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/309//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/309//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/309//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/309//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/309//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13153463" author="nkeywal" created="Sat, 19 Nov 2011 11:49:38 +0000"  >&lt;p&gt;same patch try again&lt;/p&gt;</comment>
                            <comment id="13153487" author="hadoopqa" created="Sat, 19 Nov 2011 13:30:26 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12504358/4798_trunk_all.v10.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12504358/4798_trunk_all.v10.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 21 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 59 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestAdmin&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestLogRolling&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestMasterObserver&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestShell&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/310//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/310//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/310//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/310//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/310//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/310//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13153518" author="nkeywal" created="Sat, 19 Nov 2011 15:44:52 +0000"  >&lt;p&gt;Intersection of the two tests and of trunk failures is:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;org.apache.hadoop.hbase.coprocessor.TestMasterObserver.testTableOperations&lt;/li&gt;
	&lt;li&gt;org.apache.hadoop.hbase.coprocessor.TestMasterObserver.testRegionTransitionOperations&lt;/li&gt;
	&lt;li&gt;org.apache.hadoop.hbase.client.TestAdmin.testCheckHBaseAvailableClosesConnection (Caused by: java.io.IOException: Too many open files)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So we&apos;re left with two new errors on coprocessor. Will have a look. &lt;/p&gt;</comment>
                            <comment id="13153766" author="hadoopqa" created="Sun, 20 Nov 2011 11:45:40 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12504426/4798_trunk_all.v10.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12504426/4798_trunk_all.v10.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 21 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -166 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 59 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestAdmin&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/314//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/314//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/314//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/314//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/314//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/314//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13153816" author="nkeywal" created="Sun, 20 Nov 2011 15:13:54 +0000"  >&lt;p&gt;I tend to think that the patch is ok and that the errors we&apos;re seeing are the usual flaky stuff, but let&apos;s try again. &lt;/p&gt;</comment>
                            <comment id="13153831" author="hadoopqa" created="Sun, 20 Nov 2011 17:02:20 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12504430/4798_trunk_all.v10.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12504430/4798_trunk_all.v10.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 21 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -166 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 59 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestAdmin&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestMasterObserver&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestLogRolling&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/315//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/315//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/315//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/315//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/315//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/315//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13154343" author="hadoopqa" created="Mon, 21 Nov 2011 18:23:13 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12504512/4798_trunk_all.v10.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12504512/4798_trunk_all.v10.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 21 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -166 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 59 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.client.TestAdmin&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/319//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/319//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/319//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/319//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/319//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/319//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13154356" author="stack" created="Mon, 21 Nov 2011 18:37:42 +0000"  >&lt;p&gt;The TestAdmin fails because of too many open files.  Let me commit.&lt;/p&gt;</comment>
                            <comment id="13154787" author="stack" created="Tue, 22 Nov 2011 01:05:02 +0000"  >&lt;p&gt;Committed to TRUNK.  Thanks for the patch N.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12529164">HBASE-4690</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12532084">HBASE-4832</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12527439">HBASE-4602</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12504512" name="4798_trunk_all.v10.patch" size="18198" author="nkeywal" created="Mon, 21 Nov 2011 16:28:17 +0000"/>
                            <attachment id="12504430" name="4798_trunk_all.v10.patch" size="18198" author="nkeywal" created="Sun, 20 Nov 2011 15:12:50 +0000"/>
                            <attachment id="12504426" name="4798_trunk_all.v10.patch" size="18198" author="nkeywal" created="Sun, 20 Nov 2011 09:55:57 +0000"/>
                            <attachment id="12504358" name="4798_trunk_all.v10.patch" size="18198" author="nkeywal" created="Sat, 19 Nov 2011 11:48:49 +0000"/>
                            <attachment id="12504344" name="4798_trunk_all.v10.patch" size="18198" author="nkeywal" created="Sat, 19 Nov 2011 07:53:19 +0000"/>
                            <attachment id="12503854" name="4798_trunk_all.v2.patch" size="17804" author="nkeywal" created="Wed, 16 Nov 2011 08:54:08 +0000"/>
                            <attachment id="12504205" name="4798_trunk_all.v5.patch" size="21570" author="nkeywal" created="Fri, 18 Nov 2011 12:42:41 +0000"/>
                            <attachment id="12504222" name="4798_trunk_all.v6.patch" size="21631" author="nkeywal" created="Fri, 18 Nov 2011 15:42:32 +0000"/>
                            <attachment id="12504235" name="4798_trunk_all.v7.patch" size="23856" author="nkeywal" created="Fri, 18 Nov 2011 17:44:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Nov 2011 10:41:06 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>217319</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 4 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08r9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49017</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>last try on the same patch, but I think it&amp;#39;s ok to commit it.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>