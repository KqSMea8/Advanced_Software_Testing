<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:00:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2272/HBASE-2272.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2272] put with timestamp after delete is not stored</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2272</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When I delete a row and afterwards put a value for that row again, I can not get it (so apparently it was not stored), but only, when I put the value with a timestamp.&lt;br/&gt;
A flush of the table between delete and put bypasses the problem.&lt;/p&gt;

&lt;p&gt;I give a hbase-shell log as an example.&lt;br/&gt;
Lets assume, we have a table &apos;foo&apos; with a column-familiy &apos;s:&apos;:&lt;/p&gt;

&lt;p&gt;The Error&lt;/p&gt;

&lt;p&gt;&amp;gt;put &apos;foo&apos;, &apos;123&apos;, &apos;s:bar&apos;, &apos;hello&apos;&lt;br/&gt;
&amp;gt;get &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
COLUMN                       CELL&lt;br/&gt;
 s:bar                       timestamp=..., value=hello&lt;br/&gt;
&amp;gt;deleteall &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
// put WITH timestamp&lt;br/&gt;
&amp;gt;put &apos;foo&apos;, &apos;123&apos;, &apos;s:bar&apos;, &apos;hello&apos;, 1267202287&lt;br/&gt;
&amp;gt; get &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
COLUMN                       CELL&lt;br/&gt;
// nothing, even though a value was saved before&lt;/p&gt;

&lt;p&gt;But This Works&lt;/p&gt;

&lt;p&gt;&amp;gt;put &apos;foo&apos;, &apos;123&apos;, &apos;s:bar&apos;, &apos;hello&apos;&lt;br/&gt;
&amp;gt;get &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
COLUMN                       CELL&lt;br/&gt;
 s:bar                       timestamp=..., value=hello&lt;br/&gt;
&amp;gt;deleteall &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
// put WITHOUT timestamp&lt;br/&gt;
&amp;gt;put &apos;foo&apos;, &apos;123&apos;, &apos;s:bar&apos;, &apos;hello&apos;&lt;br/&gt;
&amp;gt; get &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
COLUMN                       CELL&lt;br/&gt;
 s:bar                       timestamp=..., value=hello&lt;br/&gt;
// value was saved&lt;/p&gt;

&lt;p&gt;And Also&lt;/p&gt;

&lt;p&gt;&amp;gt;put &apos;foo&apos;, &apos;123&apos;, &apos;s:bar&apos;, &apos;hello&apos;&lt;br/&gt;
&amp;gt;get &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
COLUMN                       CELL&lt;br/&gt;
 s:bar                       timestamp=..., value=hello&lt;br/&gt;
&amp;gt;deleteall &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
// flush table&lt;br/&gt;
&amp;gt;flush &apos;foo&apos;&lt;br/&gt;
// put WITH timestamp&lt;br/&gt;
&amp;gt;put &apos;foo&apos;, &apos;123&apos;, &apos;s:bar&apos;, &apos;hello&apos;, 1267202287&lt;br/&gt;
&amp;gt; get &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
COLUMN                       CELL&lt;br/&gt;
 s:bar                       timestamp=..., value=hello&lt;br/&gt;
// value was saved&lt;/p&gt;

&lt;p&gt;The error also occurs with single cells - one does not have to delete whole rows:&lt;/p&gt;

&lt;p&gt;&amp;gt;put &apos;foo&apos;, &apos;123&apos;, &apos;s:bar&apos;, &apos;hello&apos;&lt;br/&gt;
&amp;gt;put &apos;foo&apos;, &apos;123&apos;, &apos;s:baz&apos;, &apos;world&apos;&lt;br/&gt;
&amp;gt;get &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
COLUMN                       CELL&lt;br/&gt;
 s:bar                       timestamp=..., value=hello&lt;br/&gt;
 s:baz                       timestamp=..., value=world&lt;br/&gt;
&amp;gt;delete &apos;foo&apos;, &apos;123&apos;, &apos;s:bar&apos;&lt;br/&gt;
// put WITH timestamp&lt;br/&gt;
&amp;gt;put &apos;foo&apos;, &apos;123&apos;, &apos;s:bar&apos;, &apos;hello&apos;, 1267202287&lt;br/&gt;
&amp;gt;get &apos;foo&apos;, &apos;123&apos;&lt;br/&gt;
COLUMN                       CELL&lt;br/&gt;
 s:baz                       timestamp=..., value=world&lt;br/&gt;
// value for s:baz was not saved&lt;/p&gt;</description>
                <environment></environment>
        <key id="12457588">HBASE-2272</key>
            <summary>put with timestamp after delete is not stored</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="matleh">Matthias Lehmann</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 Feb 2010 17:04:03 +0000</created>
                <updated>Mon, 1 Mar 2010 09:56:22 +0000</updated>
                            <resolved>Fri, 26 Feb 2010 17:11:51 +0000</resolved>
                                    <version>0.20.3</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12838941" author="jdcryans" created="Fri, 26 Feb 2010 17:11:51 +0000"  >&lt;p&gt;Resolving as duplicate, please see &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2256&quot; title=&quot;Delete row, followed quickly to put of the same row will sometimes fail.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2256&quot;&gt;HBASE-2256&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12838966" author="jdcryans" created="Fri, 26 Feb 2010 18:05:35 +0000"  >&lt;p&gt;Looking further into it, the shell output pasted doesn&apos;t show the ts for the first put so my guess is that the second put&apos;s ts is lower than the delete&apos;s ts. This code does basically the thing:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCloseMs() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; [] qualifier = Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;qf1&quot;&lt;/span&gt;);
    Put put = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Put(row1);
    put.add(CONTENTS_FAMILY, qualifier, value);
    table.put(put);
    Get get = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Get(row1);
    table.get(get); &lt;span class=&quot;code-comment&quot;&gt;// just to spend some time
&lt;/span&gt;  
    Delete del = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Delete(row1);
    table.delete(del);
    get = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Get(row1);
    res = table.get(get);
    assertEquals(0, res.raw().length);
  
    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(100);
    put = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Put(row1);
    put.add(CONTENTS_FAMILY, qualifier, &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis(), value);
    table.put(put);
    get = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Get(row1);
    res = table.get(get);
    assertEquals(1, res.raw().length);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add it to TestPut (in branch) to make it work. It passes.&lt;/p&gt;</comment>
                            <comment id="12839625" author="matleh" created="Mon, 1 Mar 2010 09:56:22 +0000"  >&lt;p&gt;I made a terribly stupid mistake: I was used to think of timestamps of seconds since epoch time (python uses floats to express milliseconds) but HBase uses Longs of millisenconds since epoch time. So obviously, my explicit timestamps lay way back in the past, which is why the put with timestamp was shadowed by the delete.&lt;/p&gt;

&lt;p&gt;Sorry that I took so much of you time - larsgeorge and jdcryans.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 26 Feb 2010 17:11:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26234</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 42 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hh07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100017</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>