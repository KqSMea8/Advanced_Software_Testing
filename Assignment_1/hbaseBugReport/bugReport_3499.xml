<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:10:43 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3499/HBASE-3499.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3499] Users upgrading to 0.90.0 need to have their .META. table updated with the right MEMSTORE_SIZE</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3499</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;With Jack Levin, we were able to figure that users that are upgrading from a 0.20.x era cluster have their .META. schema set with a 16KB MEMSTORE_SIZE. This was done in order to minimize lost meta rows when append wasn&apos;t available but even if we changed it in HTD, we also have to make sure all users upgrading to 0.90 have it changed too.&lt;/p&gt;

&lt;p&gt;In Jack&apos;s case, he ended up with 2143 storefiles in .META. during a cold start, slowing everything down. He reported a few times in the past that his .META. was always extremely busy.&lt;/p&gt;

&lt;p&gt;We should be able to do it as a one-off thing in HMaster when opening .META. (an update in place).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12497496">HBASE-3499</key>
            <summary>Users upgrading to 0.90.0 need to have their .META. table updated with the right MEMSTORE_SIZE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Feb 2011 19:40:27 +0000</created>
                <updated>Fri, 20 Nov 2015 12:42:04 +0000</updated>
                            <resolved>Tue, 8 Feb 2011 07:05:46 +0000</resolved>
                                    <version>0.90.0</version>
                                    <fixVersion>0.90.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12989774" author="stack" created="Wed, 2 Feb 2011 20:10:31 +0000"  >&lt;p&gt;I added migration notes for 0.90.x over here: &lt;a href=&quot;http://wiki.apache.org/hadoop/Hbase/HowToMigrate#90&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/Hbase/HowToMigrate#90&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12990764" author="tlipcon" created="Fri, 4 Feb 2011 21:59:44 +0000"  >&lt;p&gt;Should we automatically alter .META. on open as well?&lt;/p&gt;</comment>
                            <comment id="12990776" author="jdcryans" created="Fri, 4 Feb 2011 22:09:25 +0000"  >&lt;p&gt;I thought the master could do it before that in the bootstrap...&lt;/p&gt;</comment>
                            <comment id="12991101" author="stack" created="Sun, 6 Feb 2011 05:36:32 +0000"  >&lt;p&gt;@JD You thinking that we&apos;d open the region if NOT bootstrap and check whats in &lt;del&gt;ROOT&lt;/del&gt;.  If 16M for BLOCKSIZE, edit and write it back out again.  An extra open of the &lt;del&gt;ROOT&lt;/del&gt; by the Master.  Or you thinking something dumber where as soon as &lt;del&gt;ROOT&lt;/del&gt; is deployed, we go a get on .META. schema and if 16M, edit it.&lt;/p&gt;

&lt;p&gt;You think this a blocker JD?&lt;/p&gt;</comment>
                            <comment id="12991109" author="jdcryans" created="Sun, 6 Feb 2011 06:15:58 +0000"  >&lt;p&gt;Yeah bootstrap is an overloaded word, wrong choice.&lt;/p&gt;

&lt;p&gt;What I meant is that when we open &lt;del&gt;ROOT&lt;/del&gt;, check .META.&apos;s HRI and set MEMSTORE_SIZE (not the blocksize like you wrote) and set it back to 64MB.&lt;/p&gt;

&lt;p&gt;I think we could downgrade this if we add in the release notes that the user upgrading from 0.20 needs to fix it himself...  oh I thought I attached the script I made for Jack but it seems I forgot. Doing it right now.&lt;/p&gt;</comment>
                            <comment id="12991111" author="jdcryans" created="Sun, 6 Feb 2011 06:18:11 +0000"  >&lt;p&gt;Here is the script that I wrote for Jack that fixed his issue. It&apos;s totally based on set_meta_block_caching.rb&lt;/p&gt;

&lt;p&gt;In a way I guess we could just add this script, point to it in the documentation and call it a day. It&apos;s just less friendly because you have to run it and restart.&lt;/p&gt;</comment>
                            <comment id="12991216" author="ryanobjc" created="Sun, 6 Feb 2011 21:03:30 +0000"  >&lt;p&gt;If we reset the size of that every time we start, wouldn&apos;t that prevent&lt;br/&gt;
people from customizing that size then?&lt;/p&gt;</comment>
                            <comment id="12991815" author="stack" created="Tue, 8 Feb 2011 07:04:53 +0000"  >&lt;p&gt;Here is new Chapter on Upgrading that I added that makes mention of this issue and the fixup script.&lt;/p&gt;</comment>
                            <comment id="12991816" author="stack" created="Tue, 8 Feb 2011 07:05:46 +0000"  >&lt;p&gt;Committed script and a chapter describing it in a new &apos;Upgrading&apos; chapter.  Added to branch and trunk.&lt;/p&gt;</comment>
                            <comment id="12992298" author="hudson" created="Wed, 9 Feb 2011 02:35:42 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #1739 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/HBase-TRUNK/1739/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/HBase-TRUNK/1739/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="15017149" author="lars_francke" created="Fri, 20 Nov 2015 12:42:04 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12470561" name="Chapter&#160;2.&#160;Upgrading.html" size="5963" author="stack" created="Tue, 8 Feb 2011 07:04:53 +0000"/>
                            <attachment id="12470384" name="set_meta_memstore_size.rb" size="3208" author="jdcryans" created="Sun, 6 Feb 2011 06:18:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 2 Feb 2011 20:10:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26893</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hmin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100910</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>