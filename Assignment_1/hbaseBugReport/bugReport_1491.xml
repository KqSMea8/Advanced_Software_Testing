<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:53:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1491/HBASE-1491.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1491] ZooKeeper errors: &quot;Client has seen zxid 0xe our last zxid is 0xd&quot;</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1491</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We have been seeing a lot of these messages in tests:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 11:57:23,658 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;NIOServerCxn.Factory:21810&amp;#93;&lt;/span&gt; server.NIOServerCnxn(514): Client has seen zxid 0xe our last zxid is 0xd&lt;/p&gt;


&lt;p&gt;They usually repeat in a seemingly endless loop, such as:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 13:27:54,083 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn$SendThread(737): Priming connection to java.nio.channels.SocketChannel&lt;span class=&quot;error&quot;&gt;&amp;#91;connected local=/0:0:0:0:0:0:0:1%0:56511 remote=localhost/0:0:0:0:0:0:0:1:21810&amp;#93;&lt;/span&gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 13:27:54,084 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn$SendThread(889): Server connection successful&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 13:27:54,093 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;NIOServerCxn.Factory:21810&amp;#93;&lt;/span&gt; server.NIOServerCnxn(532): Connected to /0:0:0:0:0:0:0:1%0:56511 lastZxid 16&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 13:27:54,094 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;NIOServerCxn.Factory:21810&amp;#93;&lt;/span&gt; server.NIOServerCnxn(543): Client has seen zxid 0x10 our last zxid is 0x4&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 13:27:54,094 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;NIOServerCxn.Factory:21810&amp;#93;&lt;/span&gt; server.NIOServerCnxn(444): Exception causing close of session 0x0 due to java.io.IOException: Client has seen zxid 0x10 our last zxid is 0x4&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 13:27:54,094 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;NIOServerCxn.Facto777ry:21810&amp;#93;&lt;/span&gt; server.NIOServerCnxn(447): IOException stack trace&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; java.io.IOException: Client has seen zxid 0x10 our last zxid is 0x4&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.zookeeper.server.NIOServerCnxn.readConnectRequest(NIOServerCnxn.java:544)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:331)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.zookeeper.server.NIOServerCnxn$Factory.run(NIOServerCnxn.java:176)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 13:27:54,094 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;NIOServerCxn.Factory:21810&amp;#93;&lt;/span&gt; server.NIOServerCnxn(777): closing session:0x0 NIOServerCnxn: java.nio.channels.SocketChannel&lt;span class=&quot;error&quot;&gt;&amp;#91;connected local=/0:0:0:0:0:0:0:1%0:21810 remote=/0:0:0:0:0:0:0:1%0:56511&amp;#93;&lt;/span&gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 13:27:54,097 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn$SendThread(919): Exception closing session 0x121a2a7c43a0002 to sun.nio.ch.SelectionKeyImpl@2c662b4e&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; java.io.IOException: Read error rc = -1 java.nio.DirectByteBuffer&lt;span class=&quot;error&quot;&gt;&amp;#91;pos=0 lim=4 cap=4&amp;#93;&lt;/span&gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.zookeeper.ClientCnxn$SendThread.doIO(ClientCnxn.java:653)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:897)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2009-06-02 13:27:54,097 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;main-SendThread&amp;#93;&lt;/span&gt; zookeeper.ClientCnxn$SendThread(953): Ignoring exception during shutdown input&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; java.net.SocketException: Socket is not connected&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.nio.ch.SocketChannelImpl.shutdown(Native Method)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.nio.ch.SocketChannelImpl.shutdownInput(SocketChannelImpl.java:640)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.nio.ch.SocketAdaptor.shutdownInput(SocketAdaptor.java:360)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.zookeeper.ClientCnxn$SendThread.cleanup(ClientCnxn.java:951)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:922)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12427262">HBASE-1491</key>
            <summary>ZooKeeper errors: &quot;Client has seen zxid 0xe our last zxid is 0xd&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nitay">Nitay Joffe</assignee>
                                    <reporter username="nitay">Nitay Joffe</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Jun 2009 00:03:09 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:41 +0000</updated>
                            <resolved>Mon, 8 Jun 2009 02:24:24 +0000</resolved>
                                                    <fixVersion>0.20.0</fixVersion>
                                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12716800" author="nitay" created="Sat, 6 Jun 2009 00:05:36 +0000"  >&lt;p&gt;I&apos;ve been talking with ZooKeeper folks about this. Here&apos;s a link to the conversation on zookeeper-user:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/hadoop-zookeeper-user/200906.mbox/%3C82b0992a0906021412p6b840baci1bb4e4d44e12223e@mail.gmail.com%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/hadoop-zookeeper-user/200906.mbox/%3C82b0992a0906021412p6b840baci1bb4e4d44e12223e@mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12716804" author="nitay" created="Sat, 6 Jun 2009 00:11:36 +0000"  >&lt;p&gt;Here is my solution for this. I ran this with TestGetRowVersions and am seeing none of these messages.&lt;/p&gt;

&lt;p&gt;In this patch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Close ZooKeeperWrapper in Master, RegionServer, and TableServers when they&apos;re finishing.&lt;/li&gt;
	&lt;li&gt;Add method to HConnectionManager to delete all connections.&lt;/li&gt;
	&lt;li&gt;On MiniHBaseCluster shutdown, after LocalHBaseCluster has finished shutting down, delete all connections in HConnectionManager.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Is the last item safe to do? I think it should be. Note that without it we get some of these zkid messages.&lt;/p&gt;</comment>
                            <comment id="12716924" author="streamy" created="Sat, 6 Jun 2009 21:58:23 +0000"  >&lt;p&gt;Tried out and all tests I tried still pass.  Have not reviewed the patch yet.&lt;/p&gt;

&lt;p&gt;For some reason I&apos;m having problems finding those zxid messages without the patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  More to follow...&lt;/p&gt;</comment>
                            <comment id="12717116" author="stack" created="Mon, 8 Jun 2009 02:04:38 +0000"  >&lt;p&gt;Why not call resetZooKeeper at lines #53 in HCM rather than duplicate a bit of code (test for null and if not, close).  Otherwise patch looks good.  I was going to commit but maybe JGray wants to play some more?&lt;/p&gt;
</comment>
                            <comment id="12717119" author="stack" created="Mon, 8 Jun 2009 02:09:40 +0000"  >&lt;p&gt;Talked w/ Nitay... and jgray is ok w/ committing.&lt;/p&gt;

&lt;p&gt;Nitay, on commit, call resetZK at lines #53 if it makes sense. &lt;/p&gt;

&lt;p&gt;Good stuff.&lt;/p&gt;</comment>
                            <comment id="12717121" author="nitay" created="Mon, 8 Jun 2009 02:24:24 +0000"  >&lt;p&gt;Committed, with change Stack suggested.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12410044" name="hbase-1491.patch" size="4155" author="nitay" created="Sat, 6 Jun 2009 00:11:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 6 Jun 2009 21:58:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25785</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hdkf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99460</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>