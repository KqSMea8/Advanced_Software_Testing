<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:19:07 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4459/HBASE-4459.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4459] HbaseObjectWritable code is a byte, we will eventually run out of codes</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4459</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;There are about 90 classes/codes in HbaseObjectWritable currently and Byte.MAX_VALUE is 127.  In addition, anyone wanting to add custom classes but not break compatibility might want to leave a gap before using codes and that&apos;s difficult in such limited space.&lt;/p&gt;

&lt;p&gt;Eventually we should get rid of this pattern that makes compatibility difficult (better client/server protocol handshake) but we should probably at least bump this to a short for 0.94.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12524320">HBASE-4459</key>
            <summary>HbaseObjectWritable code is a byte, we will eventually run out of codes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ram_krish">ramkrishna.s.vasudevan</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Sep 2011 18:46:58 +0000</created>
                <updated>Fri, 20 Nov 2015 11:55:50 +0000</updated>
                            <resolved>Thu, 20 Oct 2011 18:23:23 +0000</resolved>
                                                    <fixVersion>0.92.0</fixVersion>
                                    <component>io</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13113136" author="yuzhihong@gmail.com" created="Fri, 23 Sep 2011 03:33:49 +0000"  >&lt;p&gt;+1 on making code of type short.&lt;/p&gt;</comment>
                            <comment id="13113413" author="tlipcon" created="Fri, 23 Sep 2011 13:17:50 +0000"  >&lt;p&gt;We probably have to worry that someone has stored HBaseObjectWritables somewhere persistent, in which case just making the type a short is not backwards-compatible. Perhaps we should make it a varint, which I believe will encode the same for any existing data, but would be multibyte-capable?&lt;/p&gt;</comment>
                            <comment id="13116155" author="dhruba" created="Wed, 28 Sep 2011 05:01:13 +0000"  >&lt;p&gt;@Todd: which &quot;varint&quot; are you referring to here?&lt;/p&gt;</comment>
                            <comment id="13116333" author="tlipcon" created="Wed, 28 Sep 2011 10:48:29 +0000"  >&lt;p&gt;The scheme in WritableUtils.writeVInt looks like it&apos;s backwards-compatible for small positive bytes:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (i &amp;gt;= -112 &amp;amp;&amp;amp; i &amp;lt;= 127) {
      stream.writeByte((&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;)i);
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13126312" author="yuzhihong@gmail.com" created="Thu, 13 Oct 2011 02:49:19 +0000"  >&lt;p&gt;So this means we can replace out.writeByte(code) in HBaseObjectWritable.writeClassCode() with WritableUtils.writeVInt&lt;/p&gt;

&lt;p&gt;Shall we pull this JIRA into 0.92 ?&lt;/p&gt;</comment>
                            <comment id="13126332" author="streamy" created="Thu, 13 Oct 2011 03:56:53 +0000"  >&lt;p&gt;I&apos;m fine with pulling into 0.92 since it doesn&apos;t break any compatibility.&lt;/p&gt;</comment>
                            <comment id="13126696" author="ram_krish" created="Thu, 13 Oct 2011 16:18:55 +0000"  >&lt;p&gt;Pls review the patch.&lt;/p&gt;</comment>
                            <comment id="13126854" author="streamy" created="Thu, 13 Oct 2011 19:42:51 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Why is Queue added within the scope of this JIRA?  Seems unrelated.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Can you remove the unnecessary import re-org at the top?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Can we have a unit test which shows the backwards compatibility of this?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks for working on this Ram.&lt;/p&gt;</comment>
                            <comment id="13126864" author="stack" created="Thu, 13 Oct 2011 19:55:36 +0000"  >&lt;p&gt;What is this about?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Queue.class.isAssignableFrom(declClass)) {
+      Queue queue = (Queue)instanceObj;
+      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; length = queue.size();
+      out.writeInt(length);
+      &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; obj;
+      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; length; i++) {
+        obj = queue.remove();
+        writeObject(out, obj, obj.getClass(), conf);
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is it necessary to this patch?&lt;/p&gt;

&lt;p&gt;And this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Queue.class.isAssignableFrom(declaredClass)) {
+      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; length = in.readInt();
+      instance = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConcurrentLinkedQueue();
+      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; length; i++) {
+        ((Queue)instance).add(readObject(in, conf));
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looks good Ram.  Any chance of a test to prove it works the way it used to?&lt;/p&gt;</comment>
                            <comment id="13127759" author="ram_krish" created="Fri, 14 Oct 2011 18:29:55 +0000"  >&lt;p&gt;Latest patch with testcases.&lt;br/&gt;
Text and byte[] objects is persisted using current HbaseObjectWritable and read back with enhanced HbaseObjectWritable.(new patch)&lt;/p&gt;</comment>
                            <comment id="13131185" author="stack" created="Wed, 19 Oct 2011 23:59:28 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13131870" author="ram_krish" created="Thu, 20 Oct 2011 18:23:03 +0000"  >&lt;p&gt;Commited to trunk and 0.92 branch. Thanks for the review Stack and Jon.&lt;/p&gt;</comment>
                            <comment id="13132114" author="hudson" created="Thu, 20 Oct 2011 22:21:20 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2346 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2346/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2346/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4459&quot; title=&quot;HbaseObjectWritable code is a byte, we will eventually run out of codes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4459&quot;&gt;&lt;del&gt;HBASE-4459&lt;/del&gt;&lt;/a&gt; HbaseObjectWritable code is a byte, we will eventually run out of codes&lt;/p&gt;

&lt;p&gt;ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/io/HbaseObjectWritable.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/TestHbaseObjectWritable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13132564" author="hudson" created="Fri, 21 Oct 2011 10:04:44 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #75 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/75/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/75/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4459&quot; title=&quot;HbaseObjectWritable code is a byte, we will eventually run out of codes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4459&quot;&gt;&lt;del&gt;HBASE-4459&lt;/del&gt;&lt;/a&gt; HbaseObjectWritable code is a byte, we will eventually run out of codes&lt;/p&gt;

&lt;p&gt;ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/io/HbaseObjectWritable.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/io/TestHbaseObjectWritable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15016588" author="lars_francke" created="Fri, 20 Nov 2015 11:55:50 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12499080" name="4459-v2.patch.txt" size="7590" author="ram_krish" created="Fri, 14 Oct 2011 18:29:55 +0000"/>
                            <attachment id="12498897" name="4459.txt" size="8207" author="ram_krish" created="Thu, 13 Oct 2011 16:18:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 23 Sep 2011 03:33:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27306</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hqz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101632</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>