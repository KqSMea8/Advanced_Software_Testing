<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:31:45 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5875/HBASE-5875.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5875] Process RIT and Master restart may remove an online server considering it as a dead server</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5875</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If on master restart it finds the ROOT/META to be in RIT state, master tries to assign the ROOT region through ProcessRIT.&lt;/p&gt;

&lt;p&gt;Master will trigger the assignment and next will try to verify the Root Region Location.&lt;br/&gt;
Root region location verification is done seeing if the RS has the region in its online list.&lt;br/&gt;
If the master triggered assignment has not yet been completed in RS then the verify root region location will fail.&lt;br/&gt;
Because it failed &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
splitLogAndExpireIfOnline(currentRootServer);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;we do split log and also remove the server from online server list. Ideally here there is nothing to do in splitlog as no region server was restarted.&lt;/p&gt;

&lt;p&gt;So master, though the server is online, master just invalidates the region server.&lt;br/&gt;
In a special case, if i have only one RS then my cluster will become non operative.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12552546">HBASE-5875</key>
            <summary>Process RIT and Master restart may remove an online server considering it as a dead server</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ram_krish">ramkrishna.s.vasudevan</assignee>
                                    <reporter username="ram_krish">ramkrishna.s.vasudevan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Apr 2012 11:06:29 +0000</created>
                <updated>Tue, 26 Feb 2013 08:15:57 +0000</updated>
                            <resolved>Mon, 25 Jun 2012 18:10:07 +0000</resolved>
                                    <version>0.92.1</version>
                                    <fixVersion>0.94.1</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>12</watches>
                                                                <comments>
                            <comment id="13261759" author="lhofhansl" created="Wed, 25 Apr 2012 16:07:31 +0000"  >&lt;p&gt;Can we move this to 0.94.1?&lt;/p&gt;</comment>
                            <comment id="13261814" author="ram_krish" created="Wed, 25 Apr 2012 17:12:52 +0000"  >&lt;p&gt;Updated to 0.94.1.  &lt;/p&gt;
{Edit} I will come up with a patch in another couple of days. {Edit}</comment>
                            <comment id="13262658" author="ram_krish" created="Thu, 26 Apr 2012 15:03:27 +0000"  >&lt;p&gt;I would like to get some suggestions in this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; rit = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.
      processRegionInTransitionAndBlockUntilAssigned(HRegionInfo.ROOT_REGIONINFO);
    ServerName currentRootServer = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!catalogTracker.verifyRootRegionLocation(timeout)) {
      currentRootServer = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.catalogTracker.getRootLocation();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Consider the case where my ROOT node is found in RIT.  Hence the processRIT will trigger the assignment.&lt;/p&gt;

&lt;p&gt;It so happened that when i try to verifyRootRegionLocation the root node is created but the OpenRegionHandler has not added the ROOT region in its memory(very very corner case and this happened once while testing).  So the verifyRootRegionLocation returns false and hence the master thinks it an server to be expired.  So we just remove an normal active RS from the master memory thinking it as dead.  So i lose a RS itself from the master&apos;s list of online servers.  How can we handle this scenario?&lt;/p&gt;

&lt;p&gt;Can we retry the verifyRootRegionLocation if it returns false and the boolean variable &apos;rit&apos; is true?&lt;br/&gt;
Or can we update the root region node in the RS side after updating the online server list? Suggestions welcome...&lt;/p&gt;</comment>
                            <comment id="13262698" author="zhihyu@ebaysf.com" created="Thu, 26 Apr 2012 16:09:28 +0000"  >&lt;blockquote&gt;&lt;p&gt;Or can we update the root region node in the RS side after updating the online server list?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Let&apos;s try this approach first.&lt;/p&gt;

&lt;p&gt;The other approach would involve retry count, sleep interval, etc.&lt;/p&gt;</comment>
                            <comment id="13264874" author="jeason" created="Mon, 30 Apr 2012 11:11:14 +0000"  >&lt;p&gt;Look into the method of CatalogTracker#verifyRootRegionLocation:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;public boolean verifyRootRegionLocation(final long timeout)
  throws InterruptedException, IOException {
    AdminProtocol connection = null;
    try {
      connection = waitForRootServerConnection(timeout);
    } catch (NotAllMetaRegionsOnlineException e) {
      // Pass
    } catch (ServerNotRunningYetException e) {
      // Pass -- remote server is not up so can&apos;t be carrying root
    } catch (UnknownHostException e) {
      // Pass -- server name doesn&apos;t resolve so it can&apos;t be assigned anything.
    }
    return (connection == null)? false:
      verifyRegionLocation(connection,
        this.rootRegionTracker.getRootRegionLocation(), ROOT_REGION_NAME);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I&apos;m thinking about an approach which can handle this issue according to different exception. &lt;br/&gt;
e.g. if we got an ServerNotRunningYetException, we can process splitLogAndExpireIfOnline.&lt;br/&gt;
But if we got an NotServingRegionException, we should not do that.&lt;/p&gt;
</comment>
                            <comment id="13264876" author="ram_krish" created="Mon, 30 Apr 2012 11:20:48 +0000"  >&lt;p&gt;@Jieshan&lt;br/&gt;
As Ted also suggested if we go by the exception then we need to add unnecessary retry logic, sleep time and also need to modify the api verifyRootRegionLocation which is used in many places.&lt;/p&gt;</comment>
                            <comment id="13264900" author="ram_krish" created="Mon, 30 Apr 2012 12:39:53 +0000"  >&lt;p&gt;Patch for trunk.  TestCases passed.&lt;/p&gt;</comment>
                            <comment id="13264902" author="ram_krish" created="Mon, 30 Apr 2012 12:41:20 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
Can you take a look at this? This is in relation to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4880&quot; title=&quot;Region is on service before openRegionHandler completes, may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4880&quot;&gt;&lt;del&gt;HBASE-4880&lt;/del&gt;&lt;/a&gt;. Pls provide your thoughts&lt;/p&gt;</comment>
                            <comment id="13264933" author="hadoopqa" created="Mon, 30 Apr 2012 13:37:42 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12525060/HBASE-5875.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12525060/HBASE-5875.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.io.hfile.TestForceCacheImportantBlocks&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1689//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1689//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1689//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1689//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1689//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1689//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13264938" author="ram_krish" created="Mon, 30 Apr 2012 13:47:15 +0000"  >&lt;p&gt;Testcase failure seems unrelated to this fix.&lt;/p&gt;</comment>
                            <comment id="13266377" author="zjushch" created="Wed, 2 May 2012 06:06:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;If the master triggered assignment has not yet been completed in RS then the verify root region location will fail.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Why does it happend?&lt;br/&gt;
In assignRootAndMeta:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; rit = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.
      processRegionInTransitionAndBlockUntilAssigned(HRegionInfo.ROOT_REGIONINFO);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We will block until master completed the assignment.&lt;/p&gt;</comment>
                            <comment id="13266429" author="ram_krish" created="Wed, 2 May 2012 08:29:14 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
Correct but that is still the RIT map is cleared. But the actual assignment is done after the region is added to the online map in the RS side and that is where this problem happened.&lt;br/&gt;
You know that in verifyRootRegionLocation() we mainly check if the region is available on the region server online list.&lt;br/&gt;
So there is still a small time gap for this to happen and this happened in our test cluster. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Thanks for your time.&lt;/p&gt;</comment>
                            <comment id="13266446" author="zjushch" created="Wed, 2 May 2012 08:58:44 +0000"  >&lt;p&gt;@ram&lt;br/&gt;
I&apos;m clear now about the time gap.&lt;/p&gt;

&lt;p&gt;What about do the following check &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (assignmentManager.getRegionServerOfRegion(HRegionInfo.ROOT_REGIONINFO) == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      ServerName currentRootServer = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!catalogTracker.verifyRootRegionLocation(timeout)) {
        currentRootServer = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.catalogTracker.getRootLocation();
        splitLogAndExpireIfOnline(currentRootServer);
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.assignRoot();
        &lt;span class=&quot;code-comment&quot;&gt;// Make sure a -ROOT- location is set.
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isRootLocation())
          &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
        &lt;span class=&quot;code-comment&quot;&gt;// This guarantees that the transition assigning -ROOT- has completed
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.waitForAssignment(HRegionInfo.ROOT_REGIONINFO);
        assigned++;
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        &lt;span class=&quot;code-comment&quot;&gt;// Region already assigned. We didn&apos;t assign it. Add to in-memory state.
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.regionOnline(HRegionInfo.ROOT_REGIONINFO,
            &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.catalogTracker.getRootLocation());
      }
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      &lt;span class=&quot;code-comment&quot;&gt;// Root region has been assigned through processRegionInTransition
&lt;/span&gt;    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13266466" author="ram_krish" created="Wed, 2 May 2012 09:41:08 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
verifyRootRegionLocation() need not be done? What if the RS went down just after processing the znode to OPENED? So only SSH will come and try to assign root?&lt;/p&gt;

&lt;p&gt;I am not sure if accepting that ROOT has been assigned without verifyRootRegionLocation() is ok? But your approach is simple.  &lt;/p&gt;

&lt;p&gt;My idea behind the patch was without ROOT and META the cluster is non operative.  Hence i went with that approach. Appreciate your time. &lt;/p&gt;</comment>
                            <comment id="13266522" author="zjushch" created="Wed, 2 May 2012 12:53:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;What if the RS went down just after processing the znode to OPENED? So only SSH will come and try to assign root?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, SSH will assign root. Also it remind me to the bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5918&quot; title=&quot;Master will block forever at startup if root server dies between assigning root and assigning meta&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5918&quot;&gt;&lt;del&gt;HBASE-5918&lt;/del&gt;&lt;/a&gt;, would you take a see?&lt;/p&gt;

&lt;p&gt;With the current patch, I think there is possibility of data loss mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4880&quot; title=&quot;Region is on service before openRegionHandler completes, may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4880&quot;&gt;&lt;del&gt;HBASE-4880&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;My approach is just a thought, since ROOT region is online in the AssignmentManager when initializing, it must been assigned.&lt;br/&gt;
However, it also has a hole where remove hregioninfo from RIT but not add the region to AssignmentManager.regions in AssignmentManager#regionOnline().&lt;/p&gt;</comment>
                            <comment id="13266539" author="ram_krish" created="Wed, 2 May 2012 13:10:15 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
Yes, i took a look at &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5819&quot; title=&quot;SplitLogs function could leak resources&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5819&quot;&gt;&lt;del&gt;HBASE-5819&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5816&quot; title=&quot;Balancer and ServerShutdownHandler concurrently reassign the same region&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5816&quot;&gt;&lt;del&gt;HBASE-5816&lt;/del&gt;&lt;/a&gt; is also due to the serverShutdownHandlerEnabled variable. I think &apos;serverShutdownHandlerEnabled&apos; usage should be more clear.&lt;/p&gt;

&lt;p&gt;I think that the problem of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4880&quot; title=&quot;Region is on service before openRegionHandler completes, may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4880&quot;&gt;&lt;del&gt;HBASE-4880&lt;/del&gt;&lt;/a&gt; is applicable for the user regions but for root and META the updates are done by the region servers themselves and the problem of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4880&quot; title=&quot;Region is on service before openRegionHandler completes, may cause data loss&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4880&quot;&gt;&lt;del&gt;HBASE-4880&lt;/del&gt;&lt;/a&gt; should not be there. Because if after updating the META entry to ROOT if transitioning to OPENED fails, and even if closing the region also fails, any way till the META is available the system is not going to function. Correct me if am wrong Chunhui.&lt;/p&gt;</comment>
                            <comment id="13267093" author="zjushch" created="Thu, 3 May 2012 01:45:41 +0000"  >&lt;p&gt;@ram&lt;br/&gt;
Thanks for the explaination, I think patch is OK for the issue.&lt;/p&gt;</comment>
                            <comment id="13267168" author="zhihyu@ebaysf.com" created="Thu, 3 May 2012 04:19:38 +0000"  >&lt;p&gt;+1 on patch.&lt;/p&gt;

&lt;p&gt;Before integrating to 0.92 branch, please run test suite.&lt;/p&gt;</comment>
                            <comment id="13267209" author="stack" created="Thu, 3 May 2012 05:46:27 +0000"  >&lt;p&gt;The patch looks dodgy &amp;#8211; saying a region is online, if it is root or meta, seems incorrect.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Consider the case where my ROOT node is found in RIT. Hence the processRIT will trigger the assignment.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What is the above referring to?  Which part of the code?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It so happened that when i try to verifyRootRegionLocation the root node is created but the OpenRegionHandler has not added the ROOT region in its memory(very very corner case and this happened once while testing). So the verifyRootRegionLocation returns false and hence the master thinks it an server to be expired. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Can the master not detect this corner case just by looking at whats in zk?&lt;/p&gt;
</comment>
                            <comment id="13267392" author="ram_krish" created="Thu, 3 May 2012 12:43:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;What is the above referring to? Which part of the code?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In assignRootAndMeta()&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; rit = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.
      processRegionInTransitionAndBlockUntilAssigned(HRegionInfo.ROOT_REGIONINFO);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;blockquote&gt;&lt;p&gt;Can the master not detect this corner case just by looking at whats in zk?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Here zk you mean the RS node or the ROOT region node?&lt;/p&gt;</comment>
                            <comment id="13267521" author="ram_krish" created="Thu, 3 May 2012 15:47:17 +0000"  >&lt;p&gt;I have reproduced the scenario addressing the title of the JIRA with a testcase.&lt;br/&gt;
I have tried follow a approach that Bijieshan had suggested in &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5875?focusedCommentId=13264874&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13264874&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-5875?focusedCommentId=13264874&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13264874&lt;/a&gt;&lt;br/&gt;
to solve the problem. Tomorrow i can upload the testcase.&lt;/p&gt;</comment>
                            <comment id="13268474" author="ram_krish" created="Fri, 4 May 2012 15:54:10 +0000"  >&lt;p&gt;Attached patch is for 0.94.&lt;br/&gt;
Trunk has some protobuf changes so the test case needs to be updated.&lt;br/&gt;
Again just another way of trying to address this problem.  Please provide your feedback.&lt;/p&gt;</comment>
                            <comment id="13268481" author="hadoopqa" created="Fri, 4 May 2012 16:02:20 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12525640/HBASE-5875_0.94.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12525640/HBASE-5875_0.94.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1765//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1765//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13268525" author="zhihyu@ebaysf.com" created="Fri, 4 May 2012 16:47:56 +0000"  >&lt;p&gt;The following change is for debugging, right ? If so, please change log level accordingly:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    }&lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt;(NotServingRegionException nsre){
+      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed verification of &quot;&lt;/span&gt; + Bytes.toStringBinary(regionName) +
+          &lt;span class=&quot;code-quote&quot;&gt;&quot; at address=&quot;&lt;/span&gt; + address + &lt;span class=&quot;code-quote&quot;&gt;&quot;; &quot;&lt;/span&gt; + t);
+      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; nsre;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (NotServingRegionException nsre) {
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(rit == &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;){
+        &lt;span class=&quot;code-comment&quot;&gt;// the root region location is available.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;People unfamiliar with processRegionInTransitionAndBlockUntilAssigned() may get confused by the code above. rit actually means root region has come out of transition. So rit should be named accordingly.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setServerShutdownHandlerEnabled(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; setServerShutDownEnabled) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above method should be made package-private. Append &apos;ForTest&apos; to the end of method name would help clarify its purpose.&lt;/p&gt;</comment>
                            <comment id="13269779" author="ram_krish" created="Mon, 7 May 2012 17:01:46 +0000"  >&lt;p&gt;I have addressed the third comment in the recent patch.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed verification of &quot;&lt;/span&gt; + Bytes.toStringBinary(regionName) +
+          &lt;span class=&quot;code-quote&quot;&gt;&quot; at address=&quot;&lt;/span&gt; + address + &lt;span class=&quot;code-quote&quot;&gt;&quot;; &quot;&lt;/span&gt; + t);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This log is same as the one below it.  It is an existing one.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(rit == &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;){
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here rit means region in transition and it applies to META also if it is in RIT.  So i think changing this name will not make it generic. Again, this is a patch for 0.94&lt;/p&gt;</comment>
                            <comment id="13270137" author="zjushch" created="Tue, 8 May 2012 02:19:57 +0000"  >&lt;p&gt;I think we could change a litter to fix the issue.&lt;/p&gt;

&lt;p&gt;What about checking whether region in regionsInTransitionInRS when call getRegionInfo for verifyReionLocation? If so, it must not in other regionserver, we could wait.&lt;/p&gt;

&lt;p&gt;Another solution:&lt;br/&gt;
We could skip verifyReionLocation if we found it in assignment map if processRegionInTransitionAndBlockUntilAssigned return true, could we ?(To be sure, we should change a little in AssignmentManager#regionOnline)&lt;/p&gt;</comment>
                            <comment id="13270181" author="ram_krish" created="Tue, 8 May 2012 04:11:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think we could change a litter to fix the issue.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Did you mean little? &lt;br/&gt;
Can you come up with your patch based on second solution?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;What about checking whether region in regionsInTransitionInRS when call getRegionInfo for verifyReionLocation? If so, it must not in other regionserver, we could wait.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Here am not sure again how long to wait and how much to retry?&lt;/p&gt;</comment>
                            <comment id="13270299" author="zjushch" created="Tue, 8 May 2012 07:52:18 +0000"  >&lt;p&gt;@ram&lt;br/&gt;
The v2 patch based on second solution, could you take a see.&lt;/p&gt;</comment>
                            <comment id="13270321" author="ram_krish" created="Tue, 8 May 2012 08:51:19 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
Thanks for the patch.  I saw that.  Any race is possible in regionOnline() and processServerShutdown().  Any corner case? I just thought for the scenarios where two OpenedRegionHandler call comes for the same region.  I think it should be ok.&lt;br/&gt;
Are all the testcases running? Good job.&lt;br/&gt;
Let&apos;s see what Stack has to say for this? &lt;/p&gt;</comment>
                            <comment id="13270475" author="hadoopqa" created="Tue, 8 May 2012 14:06:16 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12525969/HBASE-5875v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12525969/HBASE-5875v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop23.  The patch compiles against the hadoop 0.23.x profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1795//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1795//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1795//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1795//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/1795//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/1795//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13270480" author="zhihyu@ebaysf.com" created="Tue, 8 May 2012 14:17:44 +0000"  >&lt;p&gt;Chunhui&apos;s patch looks good.&lt;br/&gt;
Minor comments:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;-ROOT- is already onlined after process RIT&quot;&lt;/span&gt;);
+    }&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;{
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!catalogTracker.verifyRootRegionLocation(timeout)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&apos;process RIT&apos; -&amp;gt; &apos;processing RIT&apos;&lt;br/&gt;
Please insert spaces around else.&lt;br/&gt;
Indentation for the following statements should be increased.&lt;/p&gt;

&lt;p&gt;Similar comments apply to the handling of FIRST_META_REGIONINFO&lt;/p&gt;</comment>
                            <comment id="13270701" author="stack" created="Tue, 8 May 2012 18:46:52 +0000"  >&lt;p&gt;On the patch, what Ted says.&lt;/p&gt;

&lt;p&gt;Plus, I am not sure why we avoid verifying root and meta locations?  If they are online, why not do the verify?&lt;/p&gt;

&lt;p&gt;In AM, why move the sync block?&lt;/p&gt;

&lt;p&gt;I like that this patch is much smaller.  Much easier to reason about (smile).  Thanks lads.&lt;/p&gt;

&lt;p&gt;Oh, where is the test?  Is it possible to make it into a unit test and include it along w/ this patch?&lt;/p&gt;

&lt;p&gt;Good stuff&lt;/p&gt;</comment>
                            <comment id="13398464" author="rajesh23" created="Thu, 21 Jun 2012 14:53:36 +0000"  >&lt;p&gt;Attached patch for trunk. Please review and provide comments/suggestions.&lt;/p&gt;</comment>
                            <comment id="13398481" author="ram_krish" created="Thu, 21 Jun 2012 15:17:39 +0000"  >&lt;p&gt;@Devs&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-comment&quot;&gt;// Make sure a -ROOT- location is set.
&lt;/span&gt;+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isRootLocation()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+      &lt;span class=&quot;code-comment&quot;&gt;// This guarantees that the transition assigning -ROOT- has completed
&lt;/span&gt;+      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.waitForAssignment(HRegionInfo.ROOT_REGIONINFO);
+      assigned++;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-comment&quot;&gt;// Wait until META region added to region server onlineRegions. See HBASE-5875.
&lt;/span&gt;+      enableSSHandWaitForMeta();
+      assigned++;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This will ensure that we wait for ROOT and META.  Now as &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5918&quot; title=&quot;Master will block forever at startup if root server dies between assigning root and assigning meta&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5918&quot;&gt;&lt;del&gt;HBASE-5918&lt;/del&gt;&lt;/a&gt; has gone in, if any RS goes down inbetween root and META assignment SSH will also be triggered.  &lt;br/&gt;
The main intention in this patch is to avoid &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
splitLogAndExpireIfOnline(currentRootServer);
....
splitLogAndExpireIfOnline(currentMetaServer);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;because the above code in case of ROOT and META in rit was removing the current active server thinking it as dead in case the ROOT or META is not yet online on RS.&lt;/p&gt;</comment>
                            <comment id="13398485" author="zhihyu@ebaysf.com" created="Thu, 21 Jun 2012 15:24:43 +0000"  >&lt;p&gt;@Rajesh:&lt;br/&gt;
Hadoop QA is not functioning.&lt;br/&gt;
Please report back test suite result.&lt;/p&gt;</comment>
                            <comment id="13398545" author="rajesh23" created="Thu, 21 Jun 2012 16:30:39 +0000"  >&lt;p&gt;@Ted,&lt;br/&gt;
I will run test suite locally and publish test result.&lt;/p&gt;</comment>
                            <comment id="13398595" author="zhihyu@ebaysf.com" created="Thu, 21 Jun 2012 17:09:17 +0000"  >&lt;p&gt;Patch looks good.&lt;/p&gt;</comment>
                            <comment id="13398734" author="ram_krish" created="Thu, 21 Jun 2012 18:45:33 +0000"  >&lt;p&gt;I will integrate this tomorrow if there are no objections/comments.&lt;/p&gt;</comment>
                            <comment id="13399075" author="rajesh23" created="Fri, 22 Jun 2012 02:07:44 +0000"  >&lt;p&gt;Test suite result :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Results :

Failed tests:   testExceptionFromCoprocessorDuringPut(org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort): The put should have failed, as the coprocessor is buggy
  testDrainingServerOffloading(org.apache.hadoop.hbase.TestDrainingServer): expected:&amp;lt;1&amp;gt; but was:&amp;lt;0&amp;gt;
  testTaskResigned(org.apache.hadoop.hbase.master.TestSplitLogManager): version1=2, version=2
  testNullReturn(org.apache.hadoop.hbase.regionserver.TestServerCustomProtocol): Results should contain region test,bbb,1340328821040.9fe2c292d7f212976859364f8aef27a3. &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; row &apos;bbb&apos;
  testRowMutationMultiThreads(org.apache.hadoop.hbase.regionserver.TestAtomicOperation): expected:&amp;lt;0&amp;gt; but was:&amp;lt;3&amp;gt;
  testPermMask(org.apache.hadoop.hbase.util.TestFSUtils): expected:&amp;lt;rwx------&amp;gt; but was:&amp;lt;rwxrwxrwx&amp;gt;

Tests in error: 
  testWholesomeSplit(org.apache.hadoop.hbase.regionserver.TestSplitTransaction): Failed delete of /mnt/F/hbaseTrunkNew/hbase-server/target/test-data/a9504511-b767-40bb-8c4b-4550baa22da2/org.apache.hadoop.hbase.regionserver.TestSplitTransaction/table/7fcde0d5873845498b313524c3416091
  testRollback(org.apache.hadoop.hbase.regionserver.TestSplitTransaction): Failed delete of /mnt/F/hbaseTrunkNew/hbase-server/target/test-data/74d5334b-a9d3-4213-b568-8315e066df68/org.apache.hadoop.hbase.regionserver.TestSplitTransaction/table/9d8fa21602ce5ba40d1fa704094c8e25
  testOffPeakCompactionRatio(org.apache.hadoop.hbase.regionserver.TestCompactSelection): Target HLog directory already exists: /mnt/F/hbaseTrunkNew/hbase-server/target/test-data/89a77fb2-2048-414c-8f94-6b9a43a51937/TestCompactSelection/logs
  testMultiRowMutationMultiThreads(org.apache.hadoop.hbase.regionserver.TestAtomicOperation): java.io.FileNotFoundException: /mnt/F/hbaseTrunkNew/hbase-server/target/classes/hbase-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.xml (Too many open files)
  testCacheOnWriteInSchema[1](org.apache.hadoop.hbase.regionserver.TestCacheOnWriteInSchema): Target HLog directory already exists: /mnt/F/hbaseTrunkNew/hbase-server/target/test-data/1480ac68-4774-454e-9127-e9bfd20864f6/TestCacheOnWriteInSchema/logs
  testCacheOnWriteInSchema[2](org.apache.hadoop.hbase.regionserver.TestCacheOnWriteInSchema): Target HLog directory already exists: /mnt/F/hbaseTrunkNew/hbase-server/target/test-data/1480ac68-4774-454e-9127-e9bfd20864f6/TestCacheOnWriteInSchema/logs
  loadTest[0](org.apache.hadoop.hbase.util.TestMiniClusterLoadParallel): test timed out after 120000 milliseconds
  loadTest[1](org.apache.hadoop.hbase.util.TestMiniClusterLoadParallel): test timed out after 120000 milliseconds

Tests run: 1577, Failures: 6, Errors: 8, Skipped: 9
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ran failed test cases individually these test cases passes.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Running org.apache.hadoop.hbase.TestDrainingServer
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 38.338 sec

Running org.apache.hadoop.hbase.coprocessor.TestRegionServerCoprocessorExceptionWithAbort
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 31.07 sec

Running org.apache.hadoop.hbase.regionserver.TestServerCustomProtocol
Tests run: 7, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 23.353 sec

Running org.apache.hadoop.hbase.master.TestSplitLogManager
Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 20.243 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;tests in below test cases are failing but these are not related to this issue. I will check these.&lt;/p&gt;

&lt;p&gt;TestMiniClusterLoadParallel,TestAtomicOperation,TestCacheOnWriteInSchema,TestCompactSelection,TestFSUtils&lt;/p&gt;</comment>
                            <comment id="13400169" author="zhihyu@ebaysf.com" created="Sun, 24 Jun 2012 15:45:24 +0000"  >&lt;p&gt;@Rajesh:&lt;br/&gt;
Once Hadoop QA runs through a patch, the attachment itself is marked.&lt;br/&gt;
You need to attach (the same) patch again.&lt;/p&gt;</comment>
                            <comment id="13400175" author="rajesh23" created="Sun, 24 Jun 2012 16:06:40 +0000"  >&lt;p&gt;@Ted,&lt;br/&gt;
Thanks for information.Upload the same patch and submit for Hadoop QA.&lt;/p&gt;</comment>
                            <comment id="13400181" author="hadoopqa" created="Sun, 24 Jun 2012 17:08:33 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12533223/HBASE-5875_trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12533223/HBASE-5875_trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 hadoop2.0.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 11 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2242//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2242//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2242//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2242//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2242//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2242//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2242//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2242//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13400284" author="ram_krish" created="Mon, 25 Jun 2012 05:13:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;TestMiniClusterLoadParallel,TestAtomicOperation,TestCacheOnWriteInSchema,TestCompactSelection,TestFSUtils&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;All these testcases are running fine in the latest precommit build.  &lt;br/&gt;
Is it ok Ted?&lt;/p&gt;</comment>
                            <comment id="13400481" author="zhihyu@ebaysf.com" created="Mon, 25 Jun 2012 13:50:18 +0000"  >&lt;p&gt;I think so.&lt;/p&gt;</comment>
                            <comment id="13400734" author="ram_krish" created="Mon, 25 Jun 2012 18:05:23 +0000"  >&lt;p&gt;PAtch for 0.94 ready for commit.&lt;/p&gt;</comment>
                            <comment id="13400736" author="ram_krish" created="Mon, 25 Jun 2012 18:06:08 +0000"  >&lt;p&gt;Patch for trunk, ready for commit.&lt;/p&gt;</comment>
                            <comment id="13400740" author="ram_krish" created="Mon, 25 Jun 2012 18:10:07 +0000"  >&lt;p&gt;Committed to 0.94.1 and 0.96.&lt;br/&gt;
Thanks to Rajesh for the patch.&lt;br/&gt;
Thanks Ted, Chunhui and Stack for the review.&lt;/p&gt;</comment>
                            <comment id="13400775" author="hudson" created="Mon, 25 Jun 2012 18:56:25 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #280 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/280/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/280/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5875&quot; title=&quot;Process RIT and Master restart may remove an online server considering it as a dead server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5875&quot;&gt;&lt;del&gt;HBASE-5875&lt;/del&gt;&lt;/a&gt; Process RIT and Master restart may remove an online server considering it as a dead server&lt;/p&gt;

&lt;p&gt;Submitted by:Rajesh&lt;br/&gt;
Reviewed by:Ram, Ted, Stack (Revision 1353690)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13400840" author="hudson" created="Mon, 25 Jun 2012 20:01:38 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3070 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3070/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3070/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5875&quot; title=&quot;Process RIT and Master restart may remove an online server considering it as a dead server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5875&quot;&gt;&lt;del&gt;HBASE-5875&lt;/del&gt;&lt;/a&gt; Process RIT and Master restart may remove an online server considering it as a dead server (Rajesh)&lt;/p&gt;

&lt;p&gt;Submitted by:Rajesh	&lt;br/&gt;
Reviewed by:Ram Ted, Stack (Revision 1353688)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13401046" author="hudson" created="Mon, 25 Jun 2012 23:56:12 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #68 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/68/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/68/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5875&quot; title=&quot;Process RIT and Master restart may remove an online server considering it as a dead server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5875&quot;&gt;&lt;del&gt;HBASE-5875&lt;/del&gt;&lt;/a&gt; Process RIT and Master restart may remove an online server considering it as a dead server (Rajesh)&lt;/p&gt;

&lt;p&gt;Submitted by:Rajesh	&lt;br/&gt;
Reviewed by:Ram Ted, Stack (Revision 1353688)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13403273" author="hudson" created="Thu, 28 Jun 2012 17:40:05 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #38 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/38/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/38/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5875&quot; title=&quot;Process RIT and Master restart may remove an online server considering it as a dead server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5875&quot;&gt;&lt;del&gt;HBASE-5875&lt;/del&gt;&lt;/a&gt; Process RIT and Master restart may remove an online server considering it as a dead server&lt;/p&gt;

&lt;p&gt;Submitted by:Rajesh&lt;br/&gt;
Reviewed by:Ram, Ted, Stack (Revision 1353690)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
ramkrishna : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12525060" name="HBASE-5875.patch" size="1763" author="ram_krish" created="Mon, 30 Apr 2012 12:39:28 +0000"/>
                            <attachment id="12525640" name="HBASE-5875_0.94.patch" size="17500" author="ram_krish" created="Fri, 4 May 2012 15:54:10 +0000"/>
                            <attachment id="12525875" name="HBASE-5875_0.94_1.patch" size="17523" author="ram_krish" created="Mon, 7 May 2012 17:00:02 +0000"/>
                            <attachment id="12533347" name="HBASE-5875_0.94_2.patch" size="3801" author="ram_krish" created="Mon, 25 Jun 2012 18:05:23 +0000"/>
                            <attachment id="12533223" name="HBASE-5875_trunk.patch" size="3512" author="rajesh23" created="Sun, 24 Jun 2012 16:16:16 +0000"/>
                            <attachment id="12532879" name="HBASE-5875_trunk.patch" size="3512" author="rajesh23" created="Thu, 21 Jun 2012 14:51:52 +0000"/>
                            <attachment id="12533348" name="HBASE-5875_trunk_1.patch" size="3425" author="ram_krish" created="Mon, 25 Jun 2012 18:06:08 +0000"/>
                            <attachment id="12525969" name="HBASE-5875v2.patch" size="3340" author="zjushch" created="Tue, 8 May 2012 07:52:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 25 Apr 2012 16:07:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236745</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 25 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i068ov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34339</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>