<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:44:44 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-13584/HBASE-13584.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-13584] Disable distributed log replay by default for 1.1</title>
                <link>https://issues.apache.org/jira/browse/HBASE-13584</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12743&quot; title=&quot;[ITBLL] Master fails rejoining cluster stuck splitting logs; Distributed log replay=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12743&quot;&gt;&lt;del&gt;HBASE-12743&lt;/del&gt;&lt;/a&gt; hasn&apos;t a clear owner and our &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=devaraj&quot; class=&quot;user-hover&quot; rel=&quot;devaraj&quot;&gt;Devaraj Das&lt;/a&gt; has been seeing issues around this in internal runs as well. It also seems to be incompatible with rolling upgrade from 0.98, so folks making the upgrade to 1.1 will need to disable it out the gate anyway.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12825602">HBASE-13584</key>
            <summary>Disable distributed log replay by default for 1.1</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ndimiduk">Nick Dimiduk</assignee>
                                    <reporter username="ndimiduk">Nick Dimiduk</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Apr 2015 17:15:26 +0000</created>
                <updated>Wed, 3 Jun 2015 15:28:25 +0000</updated>
                            <resolved>Tue, 28 Apr 2015 23:32:59 +0000</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                                    <component>master</component>
                    <component>MTTR</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="14517461" author="devaraj" created="Tue, 28 Apr 2015 17:21:56 +0000"  >&lt;p&gt;+1 I am not too confident and don&apos;t have cycles to debug this either. The thing acts up once in a while on certain tests and it&apos;s really hard to repro those.&lt;/p&gt;</comment>
                            <comment id="14518057" author="ndimiduk" created="Tue, 28 Apr 2015 21:04:47 +0000"  >&lt;p&gt;Seems our constant default and hbase-defaults.xml did not agree. The only place I see the constant referenced is ZKSplitLogManagerCoordination#isDistributedLogReplay (which sounds like the authority on the matter)...  I guess it would be disabled by default already?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt; any other votes here?&lt;/p&gt;</comment>
                            <comment id="14518062" author="ndimiduk" created="Tue, 28 Apr 2015 21:07:33 +0000"  >&lt;p&gt;There&apos;s a spelling mistake in the xml description. If this is accepted, will &lt;tt&gt;s/Disributed/Distributed/&lt;/tt&gt; on commit.&lt;/p&gt;</comment>
                            <comment id="14518089" author="stack" created="Tue, 28 Apr 2015 21:19:36 +0000"  >&lt;p&gt;I&apos;d be interested in reports on how bad it is. I&apos;ve had good luck with it running three or four 2B ITBLL w/ monkey runs successfully. I&apos;m trying to run ITBLL at a scale I&apos;ve not done before, 10B rows (~4-5hours with chaos monkey) and it is here that I was able to trigger &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13567&quot; title=&quot;[DLR] Region stuck in recovering mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13567&quot;&gt;&lt;del&gt;HBASE-13567&lt;/del&gt;&lt;/a&gt; (it is taking me a while to figure root cause).&lt;/p&gt;</comment>
                            <comment id="14518267" author="hadoopqa" created="Tue, 28 Apr 2015 22:40:15 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12728923/HBASE-13584.00.branch-1.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12728923/HBASE-13584.00.branch-1.1.patch&lt;/a&gt;&lt;br/&gt;
  against branch-1.1 branch at commit ee562faeb3cd0b7a49a1319fdc775f1d43e32341.&lt;br/&gt;
  ATTACHMENT ID: 12728923&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.1 2.5.2 2.6.0)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 2 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): 	at org.apache.hadoop.hbase.http.TestHttpServerLifecycle.testStartedServerIsAlive(TestHttpServerLifecycle.java:69)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/13871//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14518287" author="devaraj" created="Tue, 28 Apr 2015 22:49:40 +0000"  >&lt;p&gt;I have had two instances of issues so far. &lt;br/&gt;
In the first instance, META recovery was involved. AFAICT, for some reason the recovery process ended up not recovering meta correctly. At some point the master restarted, and while reading current region assignments, the master saw the old data in the meta (assignments that were recorded prior to the last recovery), leading to issues in assignments..&lt;/p&gt;

&lt;p&gt;In the second instance, the log replay operation seemed to never complete due to ZK connectivity issue:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2015-04-28 06:00:03,060 INFO  [RS_LOG_REPLAY_OPS-os-h2-amb-r6-1430116828-sec-phoenix-5:16020-0-Writer-0-SendThread(os-h2-
amb-r6-1430116828-sec-phoenix-2.novalocal:2181)] zookeeper.ClientCnxn: Socket connection established to os-h2-amb-r6-1430116828-sec-
phoenix-2.novalocal/192.168.77.213:2181, initiating session
2015-04-28 06:00:03,061 WARN  [RS_LOG_REPLAY_OPS-os-h2-amb-r6-1430116828-sec-phoenix-5:16020-1-Writer-1-SendThread(os-h2-
amb-r6-1430116828-sec-phoenix-2.novalocal:2181)] zookeeper.ClientCnxn: Session 0x0 for server os-h2-amb-r6-1430116828-sec-phoenix-
2.novalocal/192.168.77.213:2181, unexpected error, closing socket connection and attempting reconnect
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:68)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:366)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1081)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above was being spewed constantly.. But the HBase/ZK cluster as such was functional. Not sure what caused this in DLR.&lt;/p&gt;

&lt;p&gt;I have the logs for both the above. Want to take a look &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;? I&apos;ll be happy to be proven wrong on the above.&lt;/p&gt;</comment>
                            <comment id="14518327" author="stack" created="Tue, 28 Apr 2015 23:09:07 +0000"  >&lt;p&gt;Hmm. Yeah, I&apos;d like to look at logs if you have them still &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=devaraj&quot; class=&quot;user-hover&quot; rel=&quot;devaraj&quot;&gt;Devaraj Das&lt;/a&gt; Let me figure &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13567&quot; title=&quot;[DLR] Region stuck in recovering mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13567&quot;&gt;&lt;del&gt;HBASE-13567&lt;/del&gt;&lt;/a&gt; and then cycle back to these issues that you report DD... but I&apos;d doubt I&apos;d do it all before 1.1RC.  Lets punt on DLR then for 1.1.&lt;/p&gt;</comment>
                            <comment id="14518339" author="eclark" created="Tue, 28 Apr 2015 23:22:19 +0000"  >&lt;p&gt;Yeah I would say that if there&apos;s doubt the 1.X releases aren&apos;t the place to take chances, and we should disable distributed log replay.&lt;/p&gt;</comment>
                            <comment id="14518340" author="apurtell" created="Tue, 28 Apr 2015 23:23:27 +0000"  >&lt;p&gt;Punting sounds good. We are DLR curious but haven&apos;t had the bandwidth to do the month or so straight pounding with chaos before I&apos;d try it. (And we&apos;re on 0.98 anyway, where my gut says DLR has issues almost for certain.) At some point we&apos;re going to want to get off 0.98. Maybe 1.2? Could pitch in with DLR there if it&apos;s going to be the default then, maybe.&lt;/p&gt;</comment>
                            <comment id="14518351" author="ndimiduk" created="Tue, 28 Apr 2015 23:32:59 +0000"  >&lt;p&gt;Alright. Pushed to branch-1.1. Thanks for the attention everyone.&lt;/p&gt;</comment>
                            <comment id="14518577" author="hudson" created="Wed, 29 Apr 2015 02:11:20 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.1 #441 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/441/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/441/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13584&quot; title=&quot;Disable distributed log replay by default for 1.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13584&quot;&gt;&lt;del&gt;HBASE-13584&lt;/del&gt;&lt;/a&gt; Disable distributed log replay by default for 1.1 (ndimiduk: rev 76bb8750b41310a9fa7370af741ea1214f544c4b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-common/src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;/li&gt;
	&lt;li&gt;hbase-common/src/main/resources/hbase-default.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14571031" author="ndimiduk" created="Wed, 3 Jun 2015 15:28:25 +0000"  >&lt;p&gt;Closing issues released in 1.1.0.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12711078">HBASE-11094</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12757774">HBASE-12577</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12826588">HBASE-13607</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12728923" name="HBASE-13584.00.branch-1.1.patch" size="2670" author="ndimiduk" created="Tue, 28 Apr 2015 21:04:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 28 Apr 2015 17:21:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2e0un:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>