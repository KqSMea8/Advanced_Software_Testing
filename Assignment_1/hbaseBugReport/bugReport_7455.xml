<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:45:55 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7455/HBASE-7455.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7455] Increase timeouts in TestReplication and TestSplitLogWorker</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7455</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When I measure the times in TestReplication.queueFailover, it takes about 15s on my (reasonably fast) Laptop.&lt;br/&gt;
The timeout in queueFailover currently is 1500*2*15 = 45000ms.&lt;br/&gt;
For setup before each test (which truncates the table and waits for the changes to replicate) it is 1500*15 = 22500ms.&lt;/p&gt;

&lt;p&gt;Interestingly I see queueFailover failures where the wait time is measured as 64260ms and some at 72316ms.&lt;br/&gt;
Since these numbers are not even close to 45000ms, the machine or JVM must have been stuck for 15 or almost 30s (otherwise we&apos;d get a timeout and the total time spent should be close to the timeout).&lt;/p&gt;

&lt;p&gt;So I would suggest that we increase the timeouts further.&lt;br/&gt;
We could set SLEEP_TIME to 2000 and retries to 20. Would lead to 2000*2*20 = 80000ms.&lt;/p&gt;

&lt;p&gt;Any objections?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12625471">HBASE-7455</key>
            <summary>Increase timeouts in TestReplication and TestSplitLogWorker</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lhofhansl">Lars Hofhansl</assignee>
                                    <reporter username="lhofhansl">Lars Hofhansl</reporter>
                        <labels>
                    </labels>
                <created>Sat, 29 Dec 2012 06:07:43 +0000</created>
                <updated>Tue, 26 Feb 2013 16:24:34 +0000</updated>
                            <resolved>Sat, 29 Dec 2012 06:22:36 +0000</resolved>
                                                    <fixVersion>0.94.4</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13540785" author="lhofhansl" created="Sat, 29 Dec 2012 06:13:51 +0000"  >&lt;p&gt;Similarly it seems that &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6528&quot; title=&quot;Raise the wait time for TestSplitLogWorker#testAcquireTaskAtStartup to reduce the failure probability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6528&quot;&gt;&lt;del&gt;HBASE-6528&lt;/del&gt;&lt;/a&gt; should be backported (raises timeout for TestSplitLogWorker#testAcquireTaskAtStartup).&lt;/p&gt;</comment>
                            <comment id="13540786" author="lhofhansl" created="Sat, 29 Dec 2012 06:16:27 +0000"  >&lt;p&gt;Latest 0.94 build just ran into TestSplitLogWorker#testAcquireTaskAtStartup to I think.&lt;/p&gt;</comment>
                            <comment id="13540790" author="lhofhansl" created="Sat, 29 Dec 2012 06:21:14 +0000"  >&lt;p&gt;0.94 and 0.96.&lt;br/&gt;
I think these changes are uncontroversial, I am going to commit.&lt;/p&gt;</comment>
                            <comment id="13540797" author="hudson" created="Sat, 29 Dec 2012 07:17:07 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #682 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/682/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/682/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7455&quot; title=&quot;Increase timeouts in TestReplication and TestSplitLogWorker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7455&quot;&gt;&lt;del&gt;HBASE-7455&lt;/del&gt;&lt;/a&gt; Increase timeouts in TestReplication and TestSplitLogWorker (Revision 1426711)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitLogWorker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13540803" author="hudson" created="Sat, 29 Dec 2012 08:01:18 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3672 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3672/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3672/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7455&quot; title=&quot;Increase timeouts in TestReplication and TestSplitLogWorker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7455&quot;&gt;&lt;del&gt;HBASE-7455&lt;/del&gt;&lt;/a&gt; Increase timeouts in TestReplication and TestSplitLogWorker (Revision 1426710)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13540815" author="hudson" created="Sat, 29 Dec 2012 08:44:57 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #90 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/90/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/90/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7455&quot; title=&quot;Increase timeouts in TestReplication and TestSplitLogWorker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7455&quot;&gt;&lt;del&gt;HBASE-7455&lt;/del&gt;&lt;/a&gt; Increase timeouts in TestReplication and TestSplitLogWorker (Revision 1426711)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitLogWorker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13540878" author="hudson" created="Sat, 29 Dec 2012 11:53:51 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #318 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/318/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/318/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7455&quot; title=&quot;Increase timeouts in TestReplication and TestSplitLogWorker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7455&quot;&gt;&lt;del&gt;HBASE-7455&lt;/del&gt;&lt;/a&gt; Increase timeouts in TestReplication and TestSplitLogWorker (Revision 1426710)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13544066" author="jdcryans" created="Fri, 4 Jan 2013 17:49:45 +0000"  >&lt;p&gt;The problem with raising the timeouts that much is that currently some of the tests (testStartStop, testDisableEnable, testDisableInactivePeer, testAddAndRemoveClusters) always wait the full timeout because they check if something didn&apos;t happen. This makes TestReplication/TestReplicationWithCompression run at least 2 minutes longer than they need to be.&lt;/p&gt;</comment>
                            <comment id="13544128" author="lhofhansl" created="Fri, 4 Jan 2013 19:18:23 +0000"  >&lt;p&gt;I see. Do you want to reduce the TOs again? We can also have different TOs for cases where we wait for something to not happen.&lt;/p&gt;

&lt;p&gt;(Also since the tests run in parallel and the increase of time is mostly spent waiting, it should not impact the overall runtime of the test suite (unless of course TestReplication is the globally longest running test))&lt;/p&gt;</comment>
                            <comment id="13544167" author="jdcryans" created="Fri, 4 Jan 2013 19:39:17 +0000"  >&lt;p&gt;I&apos;m trying to investigate right now what the other problems are with TestReplication, right now I&apos;m getting this weird case that kills a RS:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2013-01-04 10:04:45,500 WARN  [IPC Server handler 8 on 57099] namenode.FSDirectory(422): DIR* FSDirectory.unprotectedRenameTo: failed to rename /user/jdcryans/hbase/test/62c85f8a6e3d0e32b2fb21326537f5a6/.tmp/b938b33268064312abfc250d2eeca61d to /user/jdcryans/hbase/test/62c85f8a6e3d0e32b2fb21326537f5a6/f/b938b33268064312abfc250d2eeca61d because destination&apos;s parent does not exist
2013-01-04 10:04:45,503 WARN  [RegionServer:1;172.21.3.117,57114,1357322589018.cacheFlusher] regionserver.Store(847): Unable to rename hdfs://localhost:57099/user/jdcryans/hbase/test/62c85f8a6e3d0e32b2fb21326537f5a6/.tmp/b938b33268064312abfc250d2eeca61d to hdfs://localhost:57099/user/jdcryans/hbase/test/62c85f8a6e3d0e32b2fb21326537f5a6/f/b938b33268064312abfc250d2eeca61d
2013-01-04 10:04:45,504 WARN  [DataStreamer for file /user/jdcryans/hbase/.logs/172.21.3.117,57113,1357322588994/172.21.3.117%2C57113%2C1357322588994.1357322683769] hdfs.DFSClient$DFSOutputStream$DataStreamer(2873): DataStreamer Exception: org.apache.hadoop.ipc.RemoteException: org.apache.hadoop.hdfs.server.namenode.LeaseExpiredException: No lease on /user/jdcryans/hbase/.logs/172.21.3.117,57113,1357322588994/172.21.3.117%2C57113%2C1357322588994.1357322683769 File does not exist. [Lease.  Holder: DFSClient_hb_rs_172.21.3.117,57113,1357322588994, pendingcreates: 1]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13544184" author="lhofhansl" created="Fri, 4 Jan 2013 19:48:17 +0000"  >&lt;p&gt;Whoa, that&apos;s not good. In trunk? Compaction concurrent with droptable?&lt;/p&gt;</comment>
                            <comment id="13544454" author="hudson" created="Sat, 5 Jan 2013 00:42:37 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #10 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/10/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/10/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7455&quot; title=&quot;Increase timeouts in TestReplication and TestSplitLogWorker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7455&quot;&gt;&lt;del&gt;HBASE-7455&lt;/del&gt;&lt;/a&gt; Increase timeouts in TestReplication and TestSplitLogWorker (Revision 1426711)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestSplitLogWorker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/TestReplication.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12602122">HBASE-6528</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12562648" name="7455-0.94.txt" size="1479" author="lhofhansl" created="Sat, 29 Dec 2012 06:21:14 +0000"/>
                            <attachment id="12562649" name="7455-0.96.txt" size="835" author="lhofhansl" created="Sat, 29 Dec 2012 06:21:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 29 Dec 2012 07:17:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>302013</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16y1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248648</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>