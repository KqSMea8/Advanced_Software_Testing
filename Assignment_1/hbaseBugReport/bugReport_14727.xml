<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:55:52 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14727/HBASE-14727.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14727] Add block cache stats for regions</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14727</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The stats of block cache are calculated at region server level only. So at region level, we could not know about the numbers of blocks cached, the sizes of cached blocks, the numbers of cache hit, etc. I suggest to add the stats of block cache at region level.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12909143">HBASE-14727</key>
            <summary>Add block cache stats for regions</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="10002" iconUrl="https://issues.apache.org/jira/images/icons/statuses/document.png" description="A patch for this issue has been uploaded to JIRA by a contributor.">Patch Available</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Eungsop Yoo">Eungsop Yoo</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Oct 2015 08:38:38 +0000</created>
                <updated>Wed, 6 Jan 2016 06:22:15 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14982271" author="hadoopqa" created="Fri, 30 Oct 2015 10:09:49 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12769719/HBASE-14727.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12769719/HBASE-14727.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 84f4cceb485379d080ec9fb000c9ce5a77638d89.&lt;br/&gt;
  ATTACHMENT ID: 12769719&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 32 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The patch appears to cause mvn compile goal to fail with Hadoop version 2.4.0.&lt;/p&gt;

&lt;p&gt;    Compilation errors resume:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; COMPILATION ERROR : &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/hbase/hbase-external-blockcache/src/main/java/org/apache/hadoop/hbase/io/hfile/MemcachedBlockCache.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;75,41&amp;#93;&lt;/span&gt; no suitable constructor found for CacheStats(java.lang.String)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.2:compile (default-compile) on project hbase-external-blockcache: Compilation failure&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/hbase/hbase-external-blockcache/src/main/java/org/apache/hadoop/hbase/io/hfile/MemcachedBlockCache.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;75,41&amp;#93;&lt;/span&gt; no suitable constructor found for CacheStats(java.lang.String)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; constructor org.apache.hadoop.hbase.io.hfile.CacheStats.CacheStats(org.apache.hadoop.conf.Configuration,java.lang.String,int) is not applicable&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; (actual and formal argument lists differ in length)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; constructor org.apache.hadoop.hbase.io.hfile.CacheStats.CacheStats(org.apache.hadoop.conf.Configuration,java.lang.String) is not applicable&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; (actual and formal argument lists differ in length)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; To see the full stack trace of the errors, re-run Maven with the -e switch.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Re-run Maven using the -X switch to enable full debug logging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; For more information about the errors and possible solutions, please read the following articles:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; After correcting the problems, you can resume the build with the command&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;   mvn &amp;lt;goals&amp;gt; -rf :hbase-external-blockcache&lt;/p&gt;


&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16301//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16301//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14983729" author="eungsop yoo" created="Sat, 31 Oct 2015 01:24:43 +0000"  >&lt;p&gt;fix compilation error&lt;/p&gt;</comment>
                            <comment id="14983858" author="hadoopqa" created="Sat, 31 Oct 2015 05:55:54 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12769909/HBASE-14727-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12769909/HBASE-14727-v1.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 683f84e6a217dfd872e5f1be82c7aa4cdf232ec1.&lt;br/&gt;
  ATTACHMENT ID: 12769909&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 22 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1748 checkstyle errors (more than the master&apos;s current 1730 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +        result = result &amp;amp;&amp;amp; (Float.floatToIntBits(getCacheHitRatio())    == Float.floatToIntBits(other.getCacheHitRatio()));&lt;br/&gt;
+      result = result &amp;amp;&amp;amp; (hasCacheHitRatioLatestNPeriods() == other.hasCacheHitRatioLatestNPeriods());&lt;br/&gt;
+              new java.lang.String[] &lt;/p&gt;
{ &quot;RegionSpecifier&quot;, &quot;Stores&quot;, &quot;Storefiles&quot;, &quot;StoreUncompressedSizeMB&quot;, &quot;StorefileSizeMB&quot;, &quot;MemstoreSizeMB&quot;, &quot;StorefileIndexSizeMB&quot;, &quot;ReadRequestsCount&quot;, &quot;WriteRequestsCount&quot;, &quot;TotalCompactingKVs&quot;, &quot;CurrentCompactedKVs&quot;, &quot;RootIndexSizeKB&quot;, &quot;TotalStaticIndexSizeKB&quot;, &quot;TotalStaticBloomSizeKB&quot;, &quot;CompleteSequenceId&quot;, &quot;DataLocality&quot;, &quot;LastMajorCompactionTs&quot;, &quot;StoreCompleteSequenceId&quot;, &quot;CacheHitCount&quot;, &quot;CacheMissCount&quot;, &quot;CacheEvictedBlockCount&quot;, &quot;CacheSize&quot;, &quot;CacheBlockCount&quot;, &quot;CacheHitRatio&quot;, &quot;CacheHitRatioLatestNPeriods&quot;, }
&lt;p&gt;);&lt;br/&gt;
+      BlockCacheKey cacheKey = new BlockCacheKey(BlockCacheKey.parseRegion(path), name, metaBlockOffset,&lt;br/&gt;
+    BlockCacheKey cacheKey = new BlockCacheKey(BlockCacheKey.parseRegion(path), name, dataBlockOffset,&lt;br/&gt;
+    stats.evicted(block.getCacheKey().getRegion(), block.getCachedTime(), block.getCacheKey().isPrimary());&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16328//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16328//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16328//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16328//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16328//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16328//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16328//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16328//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14984238" author="eungsop yoo" created="Sun, 1 Nov 2015 02:24:14 +0000"  >&lt;p&gt;fix test failure&lt;/p&gt;</comment>
                            <comment id="14984275" author="hadoopqa" created="Sun, 1 Nov 2015 05:44:43 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12769971/HBASE-14727-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12769971/HBASE-14727-v2.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 6cc6d833f2cde47123876e5ca107b522004055ac.&lt;br/&gt;
  ATTACHMENT ID: 12769971&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 22 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1745 checkstyle errors (more than the master&apos;s current 1730 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +        result = result &amp;amp;&amp;amp; (Float.floatToIntBits(getCacheHitRatio())    == Float.floatToIntBits(other.getCacheHitRatio()));&lt;br/&gt;
+      result = result &amp;amp;&amp;amp; (hasCacheHitRatioLatestNPeriods() == other.hasCacheHitRatioLatestNPeriods());&lt;br/&gt;
+              new java.lang.String[] &lt;/p&gt;
{ &quot;RegionSpecifier&quot;, &quot;Stores&quot;, &quot;Storefiles&quot;, &quot;StoreUncompressedSizeMB&quot;, &quot;StorefileSizeMB&quot;, &quot;MemstoreSizeMB&quot;, &quot;StorefileIndexSizeMB&quot;, &quot;ReadRequestsCount&quot;, &quot;WriteRequestsCount&quot;, &quot;TotalCompactingKVs&quot;, &quot;CurrentCompactedKVs&quot;, &quot;RootIndexSizeKB&quot;, &quot;TotalStaticIndexSizeKB&quot;, &quot;TotalStaticBloomSizeKB&quot;, &quot;CompleteSequenceId&quot;, &quot;DataLocality&quot;, &quot;LastMajorCompactionTs&quot;, &quot;StoreCompleteSequenceId&quot;, &quot;CacheHitCount&quot;, &quot;CacheMissCount&quot;, &quot;CacheEvictedBlockCount&quot;, &quot;CacheSize&quot;, &quot;CacheBlockCount&quot;, &quot;CacheHitRatio&quot;, &quot;CacheHitRatioLatestNPeriods&quot;, }
&lt;p&gt;);&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16335//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16335//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16335//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16335//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16335//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16335//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16335//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16335//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15009565" author="apurtell" created="Tue, 17 Nov 2015 21:33:19 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  /**
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the cache hit ratio of latest N periods &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region.
+   */
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getCacheHitRatioLatestNPeriods() {
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; regionLoadPB.getCacheHitRatioLatestNPeriods();
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  /** the cache hit ratio of latest N peroids &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region */
+  optional string cache_hit_ratio_latest_N_periods = 25;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Do we need this? Operators can collect the caching metrics we periodically export and trend this information however they like using their preferred metrics store and tooling. Would remove a fair amount of new code from this patch. &lt;/p&gt;</comment>
                            <comment id="15080694" author="eungsop yoo" created="Mon, 4 Jan 2016 04:50:09 +0000"  >&lt;p&gt;I&apos;m sorry. I missed your comment.&lt;br/&gt;
I&apos;ll do it.&lt;/p&gt;</comment>
                            <comment id="15080695" author="eungsop yoo" created="Mon, 4 Jan 2016 04:50:12 +0000"  >&lt;p&gt;I&apos;m sorry. I missed your comment.&lt;br/&gt;
I&apos;ll do it.&lt;/p&gt;</comment>
                            <comment id="15080844" author="eungsop yoo" created="Mon, 4 Jan 2016 08:52:34 +0000"  >&lt;p&gt;I removed unnecessary codes.&lt;/p&gt;</comment>
                            <comment id="15081084" author="hadoopqa" created="Mon, 4 Jan 2016 12:22:36 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12780282/HBASE-14727-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12780282/HBASE-14727-v3.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 9589a7d8be4d29bffcb0c711e5bd6573e8df712c.&lt;br/&gt;
  ATTACHMENT ID: 12780282&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 36 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated new checkstyle errors. Check build console for list of new errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +        result = result &amp;amp;&amp;amp; (Float.floatToIntBits(getCacheHitRatio())    == Float.floatToIntBits(other.getCacheHitRatio()));&lt;br/&gt;
+              new java.lang.String[] &lt;/p&gt;
{ &quot;RegionSpecifier&quot;, &quot;Stores&quot;, &quot;Storefiles&quot;, &quot;StoreUncompressedSizeMB&quot;, &quot;StorefileSizeMB&quot;, &quot;MemstoreSizeMB&quot;, &quot;StorefileIndexSizeMB&quot;, &quot;ReadRequestsCount&quot;, &quot;WriteRequestsCount&quot;, &quot;TotalCompactingKVs&quot;, &quot;CurrentCompactedKVs&quot;, &quot;RootIndexSizeKB&quot;, &quot;TotalStaticIndexSizeKB&quot;, &quot;TotalStaticBloomSizeKB&quot;, &quot;CompleteSequenceId&quot;, &quot;DataLocality&quot;, &quot;LastMajorCompactionTs&quot;, &quot;StoreCompleteSequenceId&quot;, &quot;CacheHitCount&quot;, &quot;CacheMissCount&quot;, &quot;CacheEvictedBlockCount&quot;, &quot;CacheSize&quot;, &quot;CacheBlockCount&quot;, &quot;CacheHitRatio&quot;, }
&lt;p&gt;);&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 zombies&lt;/font&gt;. No zombie tests found running at the end of the build.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17106//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17106//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17106//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17106//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17106//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17106//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17106//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17106//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15082698" author="eungsop yoo" created="Tue, 5 Jan 2016 09:23:47 +0000"  >&lt;p&gt;I removed unnecessary codes more.&lt;/p&gt;</comment>
                            <comment id="15082956" author="hadoopqa" created="Tue, 5 Jan 2016 12:21:30 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12780501/HBASE-14727-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12780501/HBASE-14727-v4.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 9997e4ee52136a681faa825dea46bd1162d71eca.&lt;br/&gt;
  ATTACHMENT ID: 12780501&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 20 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated new checkstyle errors. Check build console for list of new errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 lineLengths&lt;/font&gt;.  The patch introduces the following lines longer than 100:&lt;br/&gt;
    +        result = result &amp;amp;&amp;amp; (Float.floatToIntBits(getCacheHitRatio())    == Float.floatToIntBits(other.getCacheHitRatio()));&lt;br/&gt;
+              new java.lang.String[] &lt;/p&gt;
{ &quot;RegionSpecifier&quot;, &quot;Stores&quot;, &quot;Storefiles&quot;, &quot;StoreUncompressedSizeMB&quot;, &quot;StorefileSizeMB&quot;, &quot;MemstoreSizeMB&quot;, &quot;StorefileIndexSizeMB&quot;, &quot;ReadRequestsCount&quot;, &quot;WriteRequestsCount&quot;, &quot;TotalCompactingKVs&quot;, &quot;CurrentCompactedKVs&quot;, &quot;RootIndexSizeKB&quot;, &quot;TotalStaticIndexSizeKB&quot;, &quot;TotalStaticBloomSizeKB&quot;, &quot;CompleteSequenceId&quot;, &quot;DataLocality&quot;, &quot;LastMajorCompactionTs&quot;, &quot;StoreCompleteSequenceId&quot;, &quot;CacheHitCount&quot;, &quot;CacheMissCount&quot;, &quot;CacheEvictedBlockCount&quot;, &quot;CacheSize&quot;, &quot;CacheBlockCount&quot;, &quot;CacheHitRatio&quot;, }
&lt;p&gt;);&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn post-site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 zombies&lt;/font&gt;. No zombie tests found running at the end of the build.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17127//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17127//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17127//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17127//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17127//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17127//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/17127//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/17127//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15083777" author="stack" created="Tue, 5 Jan 2016 21:02:19 +0000"  >&lt;p&gt;Thanks for the patch. More metrics is generally better. We just have to be parsimonious when we add them making sure no overlap else we can confuse. Metrics also need good explaination on what the metric is about. Here&apos;s some questions (thanks for adding comments in pb.. .helps):&lt;/p&gt;

&lt;p&gt;149	  /** the size of cache for the region */&lt;br/&gt;
150	  optional uint64 cache_size = 22;&lt;/p&gt;

&lt;p&gt;What is a region cache size? We usually do the cache by regionserver, not by region. Is this the amount of the cache occupied by the region summing the size of all the cached blocks for a region? Is so, tighten the comment/description I&apos;d say.&lt;/p&gt;

&lt;p&gt;Do we need this:&lt;/p&gt;

&lt;p&gt;143	  /** the number of cache miss count for the region */&lt;br/&gt;
144	  optional uint64 cache_miss_count = 20;&lt;/p&gt;

&lt;p&gt;We have the cache hit number and elsewhere we have overall hits so miss would be the difference? Do we need to send this one over?&lt;/p&gt;

&lt;p&gt;I think we do this elsewhere but that doesn&apos;t mean it a good idea (smile):&lt;/p&gt;

&lt;p&gt;155	  /** the current cache hit ratio for the region */&lt;br/&gt;
156	  optional float cache_hit_ratio = 24;&lt;/p&gt;

&lt;p&gt;The above can be calculated from cache hit rate or overall hit rate&lt;/p&gt;

&lt;p&gt;... but this latter might be ok.&lt;/p&gt;

&lt;p&gt;Adding the above numbers to UI is great. Thanks.&lt;/p&gt;

&lt;p&gt;When you add region to BlockCacheKey, is it the name or the id that you use? It looks like the name given you are parsing the file path. The file path will not always have the region id in it (it won&apos;t in hbase 2.0.0). Do you have to get it from the filepath?&lt;/p&gt;

&lt;p&gt;What does the CacheStatsChore do? Why we need it now?&lt;/p&gt;

&lt;p&gt;Thanks. This is a welcome patch. Just a few items above.&lt;/p&gt;

</comment>
                            <comment id="15085040" author="eungsop yoo" created="Wed, 6 Jan 2016 06:22:15 +0000"  >&lt;blockquote&gt;
&lt;p&gt;149 /** the size of cache for the region */&lt;br/&gt;
150 optional uint64 cache_size = 22;&lt;br/&gt;
What is a region cache size? We usually do the cache by regionserver, not by region. Is this the amount of the cache occupied by the region summing the size of all the cached blocks for a region? Is so, tighten the comment/description I&apos;d say.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, I&apos;ll update it.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Do we need this:&lt;br/&gt;
143 /** the number of cache miss count for the region */&lt;br/&gt;
144 optional uint64 cache_miss_count = 20;&lt;br/&gt;
We have the cache hit number and elsewhere we have overall hits so miss would be the difference? Do we need to send this one over?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Instead of adding request(hit + miss) count, I added this to PB. It is used to calculate cache hit ratio.(It is mentioned later some more.)&lt;br/&gt;
The new fields are added to PB to expose new metrics to clients out of region servers. So now clients can query the metrics related to block cache for regions by calling Admin.getClusterStatus().getLoad() like other metrics such as read request count, write request count, etc.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I think we do this elsewhere but that doesn&apos;t mean it a good idea (smile):&lt;br/&gt;
155 /** the current cache hit ratio for the region */&lt;br/&gt;
156 optional float cache_hit_ratio = 24;&lt;br/&gt;
The above can be calculated from cache hit rate or overall hit rate&lt;br/&gt;
... but this latter might be ok.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This can be calculated at client side with hit and miss count for a region. So this can be removed from PB.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;When you add region to BlockCacheKey, is it the name or the id that you use? It looks like the name given you are parsing the file path. The file path will not always have the region id in it (it won&apos;t in hbase 2.0.0). Do you have to get it from the filepath?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I used the the encoded region name parsed form the file path. Do you mean that parsing the encoded region name from the file path is impossible in HBase 2.0.0?&lt;br/&gt;
If it is impossible, I need to find another way. &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;What does the CacheStatsChore do? Why we need it now?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Block cache metrics for regions are implemented in CacheStats class. The instance of CacheStats belongs to BlockCache and the instance of BlockCache is a singleton. I need to update the metrics when regions are moved or split. But I could not update the block cache metrics for regions as the region metrics belong to HRegion. So I made the chore to clean up the stat entries related to regions that are not online. Is there any suggestion?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12769909" name="HBASE-14727-v1.patch" size="137322" author="Eungsop Yoo" created="Sat, 31 Oct 2015 01:24:43 +0000"/>
                            <attachment id="12769971" name="HBASE-14727-v2.patch" size="137494" author="Eungsop Yoo" created="Sun, 1 Nov 2015 02:24:14 +0000"/>
                            <attachment id="12780282" name="HBASE-14727-v3.patch" size="130176" author="Eungsop Yoo" created="Mon, 4 Jan 2016 08:50:38 +0000"/>
                            <attachment id="12780501" name="HBASE-14727-v4.patch" size="92589" author="Eungsop Yoo" created="Tue, 5 Jan 2016 09:23:47 +0000"/>
                            <attachment id="12769719" name="HBASE-14727.patch" size="138639" author="Eungsop Yoo" created="Fri, 30 Oct 2015 08:39:26 +0000"/>
                            <attachment id="12780281" name="rs-web-ui-v2.png" size="154240" author="Eungsop Yoo" created="Mon, 4 Jan 2016 08:50:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 30 Oct 2015 10:09:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            49 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2nqcv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>