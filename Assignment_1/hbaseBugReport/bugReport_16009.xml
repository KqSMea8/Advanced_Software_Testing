<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:09:25 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-16009/HBASE-16009.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-16009] Restoring an incremental backup should not require -overwrite</title>
                <link>https://issues.apache.org/jira/browse/HBASE-16009</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When I tried to restore an incremental backup,&lt;/p&gt;

&lt;p&gt;hbase restore hdfs://hbase-test-rc-rerun-6:8020/user/hbase backup_1465575766499 t1 t2&lt;/p&gt;

&lt;p&gt;I got:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2016-06-10 19:53:11,317 ERROR [main] impl.RestoreClientImpl: ERROR: restore failed with error: Existing table found in target &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; no &lt;span class=&quot;code-quote&quot;&gt;&quot;-overwrite&quot;&lt;/span&gt; option found
java.io.IOException: Existing table found in target &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; no &lt;span class=&quot;code-quote&quot;&gt;&quot;-overwrite&quot;&lt;/span&gt; option found
	at org.apache.hadoop.hbase.backup.impl.RestoreClientImpl.checkTargetTables(RestoreClientImpl.java:186)
	at org.apache.hadoop.hbase.backup.impl.RestoreClientImpl.restore(RestoreClientImpl.java:108)
	at org.apache.hadoop.hbase.backup.RestoreDriver.parseAndRun(RestoreDriver.java:169)
	at org.apache.hadoop.hbase.backup.RestoreDriver.doWork(RestoreDriver.java:198)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above check should only be performed for restoring full backup.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12977750">HBASE-16009</key>
            <summary>Restoring an incremental backup should not require -overwrite</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="vrodionov">Vladimir Rodionov</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                            <label>backup</label>
                    </labels>
                <created>Fri, 10 Jun 2016 20:41:12 +0000</created>
                <updated>Mon, 27 Jun 2016 17:15:59 +0000</updated>
                            <resolved>Mon, 27 Jun 2016 17:15:58 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="15325412" author="vrodionov" created="Fri, 10 Jun 2016 22:33:19 +0000"  >&lt;p&gt;Why it should not require -overwrite, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;? All must be consistent, if we require overwrite for restore from full backup, we must require the same for incremental.&lt;/p&gt;</comment>
                            <comment id="15325420" author="yuzhihong@gmail.com" created="Fri, 10 Jun 2016 22:36:41 +0000"  >&lt;p&gt;In my experiment, backup_1465575766499 was an incremental backup.&lt;br/&gt;
I first restored full backup (backup Id was different).&lt;/p&gt;

&lt;p&gt;Restoring incremental backup should not require -overwrite.&lt;br/&gt;
Otherwise user cannot obtain the data from both backup&apos;s.&lt;/p&gt;</comment>
                            <comment id="15325444" author="vrodionov" created="Fri, 10 Jun 2016 22:48:19 +0000"  >&lt;p&gt;That is the case for autoRestore = false. Let me check the code.&lt;/p&gt;</comment>
                            <comment id="15325551" author="vrodionov" created="Sat, 11 Jun 2016 00:24:54 +0000"  >&lt;p&gt;Ok, I did  a small patch, running tests right now. For your use case: restore first incremental after full restore you do not have to specify both -automatic and -overwrite. If you specify -automatic, then you will need -overwrite if table exists, otherwise all data will be messed up in the table. &lt;/p&gt;</comment>
                            <comment id="15325586" author="vrodionov" created="Sat, 11 Jun 2016 01:05:57 +0000"  >&lt;p&gt;I had to reassign it to myself to attach the patch, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;. Can you take a look at it?&lt;/p&gt;
</comment>
                            <comment id="15325601" author="yuzhihong@gmail.com" created="Sat, 11 Jun 2016 01:20:03 +0000"  >&lt;p&gt;Shouldn&apos;t the check involve whether the backup being restored is incremental or not ?&lt;/p&gt;</comment>
                            <comment id="15325870" author="yuzhihong@gmail.com" created="Sat, 11 Jun 2016 14:13:10 +0000"  >&lt;p&gt;The condition should be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isOverwrite &amp;amp;&amp;amp; (autorestore || !isIncrBackup)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15325996" author="vrodionov" created="Sat, 11 Jun 2016 18:22:18 +0000"  >&lt;p&gt;Let me think about automatic + overwrite config options, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;. I think it is not necessary to have both. I will post my thoughts in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15862&quot; title=&quot;Backup - Delete- Restore does not restore deleted data&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15862&quot;&gt;&lt;del&gt;HBASE-15862&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12809568" name="16009.v1.txt" size="6025" author="yuzhihong@gmail.com" created="Fri, 10 Jun 2016 22:14:07 +0000"/>
                            <attachment id="12809597" name="HBASE-16009-v2.patch" size="3198" author="vrodionov" created="Sat, 11 Jun 2016 01:05:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 10 Jun 2016 22:33:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2zb93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>