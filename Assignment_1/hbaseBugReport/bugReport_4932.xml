<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:23:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4932/HBASE-4932.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4932] Block cache can be mistakenly instantiated by tools</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4932</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Map Reduce tasks that create a writer to write HFiles inadvertently end up creating block cache.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12533572">HBASE-4932</key>
            <summary>Block cache can be mistakenly instantiated by tools</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="khemani">Prakash Khemani</assignee>
                                    <reporter username="khemani">Prakash Khemani</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Dec 2011 06:35:44 +0000</created>
                <updated>Tue, 26 Feb 2013 08:12:30 +0000</updated>
                            <resolved>Thu, 22 Mar 2012 16:46:55 +0000</resolved>
                                                    <fixVersion>0.94.0</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13161450" author="stack" created="Fri, 2 Dec 2011 06:42:59 +0000"  >&lt;p&gt;Yeah.  This is actually a pain.   Master splitting WALs used to be creating blockcaches until ugly-hacked it not too.&lt;/p&gt;</comment>
                            <comment id="13163149" author="nspiegelberg" created="Mon, 5 Dec 2011 23:09:35 +0000"  >&lt;p&gt;Phabricator is being a little buggy.  Working with Marek to diagnose the problem.  See &lt;a href=&quot;https://reviews.facebook.net/D573&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D573&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13163152" author="nspiegelberg" created="Mon, 5 Dec 2011 23:12:47 +0000"  >&lt;p&gt;looks good for now. sounds like we need to clean up the caching semantics for a writer in trunk :\ Save that for another JIRA&lt;/p&gt;</comment>
                            <comment id="13163165" author="hadoopqa" created="Mon, 5 Dec 2011 23:24:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12506185/HBASE-4932.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12506185/HBASE-4932.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/449//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/449//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13163175" author="stack" created="Mon, 5 Dec 2011 23:36:54 +0000"  >&lt;p&gt;I was going to say this is probably really expensive but its just cloning of in memory Arrays and Properties so probably not too bad:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; WriterFactory getWriterFactory(Configuration conf) {
-    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; HFile.getWriterFactory(conf, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CacheConfig(conf));
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; WriterFactory getWriterFactoryNoCache(Configuration
+       conf) {
+    Configuration tempConf = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Configuration(conf);
+    tempConf.setFloat(CacheConfig.HFILE_BLOCK_CACHE_SIZE_KEY, 0.0f);
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; HFile.getWriterFactory(conf, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CacheConfig(tempConf));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;+1 on patch.&lt;/p&gt;
</comment>
                            <comment id="13163232" author="hudson" created="Tue, 6 Dec 2011 00:59:36 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2519 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2519/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2519/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4932&quot; title=&quot;Block cache can be mistakenly instantiated by tools&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4932&quot;&gt;&lt;del&gt;HBASE-4932&lt;/del&gt;&lt;/a&gt; Block cache can be mistakenly instantiated by tools&lt;/p&gt;

&lt;p&gt;Summary: disable block cache for HFile writers created for tools&lt;/p&gt;

&lt;p&gt;Test Plan:&lt;br/&gt;
ran the following tests that call getWriterFactory&lt;/p&gt;

&lt;p&gt;test/java/org/apache/hadoop/hbase/io/hfile/TestHFile.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestHFilePerformance.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestHFileSeek.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/TestHalfStoreFileReader.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFiles.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/regionserver/TestHRegionServerBulkLoad.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/p&gt;

&lt;p&gt;Reviewers: dhruba, jgray, nspiegelberg, JIRA, mbautin&lt;/p&gt;

&lt;p&gt;Reviewed By: nspiegelberg&lt;/p&gt;

&lt;p&gt;CC: HBase Diffs Facebook Group, mbautin, khemani, nspiegelberg&lt;/p&gt;

&lt;p&gt;Differential Revision: 573&lt;/p&gt;

&lt;p&gt;nspiegelberg : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/HFileOutputFormat.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/util/CompressionTest.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HFilePerformanceEvaluation.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFilePerformance.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileSeek.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13163371" author="hudson" created="Tue, 6 Dec 2011 05:53:45 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #23 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/23/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/23/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4932&quot; title=&quot;Block cache can be mistakenly instantiated by tools&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4932&quot;&gt;&lt;del&gt;HBASE-4932&lt;/del&gt;&lt;/a&gt; Block cache can be mistakenly instantiated by tools&lt;/p&gt;

&lt;p&gt;Summary: disable block cache for HFile writers created for tools&lt;/p&gt;

&lt;p&gt;Test Plan:&lt;br/&gt;
ran the following tests that call getWriterFactory&lt;/p&gt;

&lt;p&gt;test/java/org/apache/hadoop/hbase/io/hfile/TestHFile.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestHFilePerformance.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestHFileSeek.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestReseekTo.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/io/TestHalfStoreFileReader.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/mapreduce/TestLoadIncrementalHFiles.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/regionserver/TestHRegionServerBulkLoad.java&lt;br/&gt;
test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/p&gt;

&lt;p&gt;Reviewers: dhruba, jgray, nspiegelberg, JIRA, mbautin&lt;/p&gt;

&lt;p&gt;Reviewed By: nspiegelberg&lt;/p&gt;

&lt;p&gt;CC: HBase Diffs Facebook Group, mbautin, khemani, nspiegelberg&lt;/p&gt;

&lt;p&gt;Differential Revision: 573&lt;/p&gt;

&lt;p&gt;nspiegelberg : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/HFileOutputFormat.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/util/CompressionTest.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/HFilePerformanceEvaluation.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFilePerformance.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileSeek.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestSeekTo.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestWALReplay.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13169815" author="hadoopqa" created="Wed, 14 Dec 2011 23:42:53 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12506185/HBASE-4932.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12506185/HBASE-4932.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 25 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/511//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/511//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13215864" author="mikhail" created="Fri, 24 Feb 2012 20:02:09 +0000"  >&lt;p&gt;@Prakash: I&apos;ve noticed that this is not there in 89-fb. Do we need this patch there as well?&lt;/p&gt;</comment>
                            <comment id="13215947" author="khemani" created="Fri, 24 Feb 2012 21:45:46 +0000"  >&lt;p&gt;Yes ... It is a good to have patch. Thanks.&lt;/p&gt;

&lt;p&gt;On 2/24/12 12:03 PM, &quot;Mikhail Bautin (Commented) (JIRA)&quot; &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;

</comment>
                            <comment id="13234578" author="lhofhansl" created="Wed, 21 Mar 2012 17:43:42 +0000"  >&lt;p&gt;Is this ready for commit to 0.94?&lt;/p&gt;</comment>
                            <comment id="13235703" author="lhofhansl" created="Thu, 22 Mar 2012 16:46:55 +0000"  >&lt;p&gt;Ah, NM, was already committed, just not marked fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12506185" name="HBASE-4932.patch" size="7662" author="nspiegelberg" created="Mon, 5 Dec 2011 23:11:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 2 Dec 2011 06:42:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>219300</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i06a4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34573</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>