<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:27:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5423/HBASE-5423.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5423] Regionserver may block forever on waitOnAllRegionsToClose when aborting</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5423</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If closeRegion throws any exception (It would be caused by FS ) when RS is aborting, &lt;br/&gt;
RS will block forever on waitOnAllRegionsToClose().&lt;/p&gt;</description>
                <environment></environment>
        <key id="12542992">HBASE-5423</key>
            <summary>Regionserver may block forever on waitOnAllRegionsToClose when aborting</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zjushch">chunhui shen</assignee>
                                    <reporter username="zjushch">chunhui shen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Feb 2012 05:50:13 +0000</created>
                <updated>Fri, 12 Oct 2012 05:34:52 +0000</updated>
                            <resolved>Thu, 23 Feb 2012 05:05:53 +0000</resolved>
                                                    <fixVersion>0.94.0</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13210079" author="zjushch" created="Fri, 17 Feb 2012 05:53:55 +0000"  >&lt;p&gt;We needn&apos;t wait failedClose regions to close.&lt;/p&gt;</comment>
                            <comment id="13210466" author="stack" created="Fri, 17 Feb 2012 19:31:05 +0000"  >&lt;p&gt;Patch looks good Chunhui.&lt;/p&gt;

&lt;p&gt;Change name of Set from addedRegionsToCallClose to closed.&lt;/p&gt;

&lt;p&gt;Why do we have this Set?  Are we calling close multiple times on same region?&lt;/p&gt;

&lt;p&gt;So, we&apos;d break even though online regions is not yet empty?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regionsInTransitionInRS.isEmpty()) {
+        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="13210760" author="zjushch" created="Sat, 18 Feb 2012 02:15:08 +0000"  >&lt;p&gt;If we failed closing one region, we will remove it from RIT , so it maybe calling close multiple times on same region.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CloseRegionHandler#process(){
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;{
...
region.close(abort)
...
}&lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt;{
 &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.rsServices.getRegionsInTransitionInRS().
          remove(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regionInfo.getEncodedNameAsBytes());
}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Therefore, if we can&apos;t close some regions because of some exception, we should break even though online regions is not yet empty, otherwise, it may block forever on waitOnAllRegionsToClose&lt;/p&gt;</comment>
                            <comment id="13210835" author="ram_krish" created="Sat, 18 Feb 2012 06:15:25 +0000"  >&lt;p&gt;@Chunhui&lt;br/&gt;
Patch makes sense.  Using a set is also fine with me.&lt;br/&gt;
+1 on patch except if there is any name change for the name suggested by Stack.&lt;/p&gt;</comment>
                            <comment id="13211060" author="stack" created="Sat, 18 Feb 2012 20:25:20 +0000"  >&lt;p&gt;@Chunhui Sounds good.  Want me to change the name on commit or do you want to put up a new patch?  I&apos;d add a log that we were exiting though online regions too....   Good stuff.&lt;/p&gt;</comment>
                            <comment id="13211175" author="zjushch" created="Sun, 19 Feb 2012 01:16:45 +0000"  >&lt;p&gt;@Stack&lt;br/&gt;
It&apos;s better change the name on commit.&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="13214266" author="zjushch" created="Thu, 23 Feb 2012 03:33:26 +0000"  >&lt;p&gt;Change the set name and add a log if online regions are not empty.&lt;/p&gt;</comment>
                            <comment id="13214312" author="stack" created="Thu, 23 Feb 2012 05:05:53 +0000"  >&lt;p&gt;Committed to TRUNK.  Thanks for the patch Chunhui.&lt;/p&gt;</comment>
                            <comment id="13214348" author="hudson" created="Thu, 23 Feb 2012 06:06:18 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2667 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2667/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2667/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5423&quot; title=&quot;Regionserver may block forever on waitOnAllRegionsToClose when aborting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5423&quot;&gt;&lt;del&gt;HBASE-5423&lt;/del&gt;&lt;/a&gt; Regionserver may block forever on waitOnAllRegionsToClose when aborting (Revision 1292647)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13214865" author="zhihyu@ebaysf.com" created="Thu, 23 Feb 2012 17:20:11 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regionsInTransitionInRS.isEmpty()) {
+         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isOnlineRegionsEmpty()) {
+           LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;We were exiting though online regions are not empty, because some regions failed closing&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think regionsInTransitionOnRS is better name for the new Map.&lt;br/&gt;
The log line above exceeds 80 chars.&lt;/p&gt;</comment>
                            <comment id="13215413" author="hudson" created="Fri, 24 Feb 2012 05:55:08 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #121 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/121/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/121/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5423&quot; title=&quot;Regionserver may block forever on waitOnAllRegionsToClose when aborting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5423&quot;&gt;&lt;del&gt;HBASE-5423&lt;/del&gt;&lt;/a&gt; Regionserver may block forever on waitOnAllRegionsToClose when aborting (Revision 1292647)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12514955" name="hbase-5423.patch" size="2468" author="zjushch" created="Fri, 17 Feb 2012 05:53:55 +0000"/>
                            <attachment id="12515688" name="hbase-5423v2.patch" size="2604" author="zjushch" created="Thu, 23 Feb 2012 03:33:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Feb 2012 19:31:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228278</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 43 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i069br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34442</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>