<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:55:33 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14699/HBASE-14699.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14699] Replication crashes regionservers when hbase.wal.provider is set to multiwal</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14699</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When the hbase.wal.provider is set to multiwal and replication is enabled, the regionservers start crashing with the following exception:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;hostname&amp;gt;,16020,1445495411258: Failed to write replication wal position (filename=&amp;lt;hostname&amp;gt;%2C16020%2C1445495411258.null0.1445495898373, position=1322399)
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase/replication/rs/&amp;lt;hostname&amp;gt;,16020,1445495411258/1/&amp;lt;hostname&amp;gt;%2C16020%2C1445495411258.null0.1445495898373
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:111)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)
	at org.apache.zookeeper.ZooKeeper.setData(ZooKeeper.java:1270)
	at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.setData(RecoverableZooKeeper.java:429)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.setData(ZKUtil.java:940)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.setData(ZKUtil.java:990)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.setData(ZKUtil.java:984)
	at org.apache.hadoop.hbase.replication.ReplicationQueuesZKImpl.setLogPosition(ReplicationQueuesZKImpl.java:129)
	at org.apache.hadoop.hbase.replication.regionserver.ReplicationSourceManager.logPositionAndCleanOldLogs(ReplicationSourceManager.java:177)
	at org.apache.hadoop.hbase.replication.regionserver.ReplicationSource.run(ReplicationSource.java:388)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12908031">HBASE-14699</key>
            <summary>Replication crashes regionservers when hbase.wal.provider is set to multiwal</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="ashu210890">Ashu Pachauri</assignee>
                                    <reporter username="ashu210890">Ashu Pachauri</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Oct 2015 21:11:42 +0000</created>
                <updated>Thu, 29 Oct 2015 06:27:54 +0000</updated>
                            <resolved>Thu, 29 Oct 2015 06:27:54 +0000</resolved>
                                    <version>1.2.0</version>
                    <version>1.2.1</version>
                                                    <component>Replication</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="14975096" author="yuzhihong@gmail.com" created="Mon, 26 Oct 2015 21:16:36 +0000"  >&lt;p&gt;Which branch did you use ?&lt;/p&gt;

&lt;p&gt;Note: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6617&quot; title=&quot;ReplicationSourceManager should be able to track multiple WAL paths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6617&quot;&gt;&lt;del&gt;HBASE-6617&lt;/del&gt;&lt;/a&gt; didn&apos;t go into branch-1.2&lt;/p&gt;</comment>
                            <comment id="14975133" author="eclark" created="Mon, 26 Oct 2015 21:32:52 +0000"  >&lt;p&gt;This on branch-1.2 latest commit ( before &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; turned of balancer ).&lt;/p&gt;</comment>
                            <comment id="14977425" author="ashu210890" created="Wed, 28 Oct 2015 00:01:25 +0000"  >&lt;p&gt;Here is an extract from the logs (I added some extra logging to debug, you wont find it in the code): &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
15/10/27 15:21:20 INFO wal.FSHLog: Rolled WAL /&amp;lt;wal_root&amp;gt;/&amp;lt;hostname&amp;gt;,16020,1445984296081/&amp;lt;hostname&amp;gt;%2C16020%2C1445984296081.null2.1445984298092 with entries=15, filesize=13.96 KB; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; WAL /&amp;lt;wal_root&amp;gt;/&amp;lt;hostname&amp;gt;,16020,1445984296081/&amp;lt;hostname&amp;gt;%2C16020%2C1445984296081.null2.1445984480906
15/10/27 15:21:21 INFO regionserver.ReplicationSourceManager: Given key: &amp;lt;hostname&amp;gt;%2C16020%2C1445984296081.null2.1445984480906, Deleting log: &amp;lt;hostname&amp;gt;%2C16020%2C1445984296081.null0.1445984481007
15/10/27 15:21:21 INFO zookeeper.RecoverableZooKeeper: Deleting znode: /hbase/replication/rs/&amp;lt;hostname&amp;gt;,16020,1445984296081/1/&amp;lt;hostname&amp;gt;%2C16020%2C1445984296081.null0.1445984481007, version: -1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ReplicationSourceManager#cleanOldLogs cleans up logs older than a given key (log name) by just sorting the names. It works for defaultwalprovider. However, for multiwal, it breaks because log0.newtimestamp (after rolling) would be  deleted on the basis of being older than log2.oldtimestamp. The cleanup process should also take into account the timestamps of individual logs and not just the sorted order of their names.&lt;/p&gt;</comment>
                            <comment id="14977852" author="carp84" created="Wed, 28 Oct 2015 06:34:44 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashu210890&quot; class=&quot;user-hover&quot; rel=&quot;ashu210890&quot;&gt;Ashu Pachauri&lt;/a&gt;,&lt;br/&gt;
The issue of ReplicationManager#cleanOldLogs is already found and addressed by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6617&quot; title=&quot;ReplicationSourceManager should be able to track multiple WAL paths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6617&quot;&gt;&lt;del&gt;HBASE-6617&lt;/del&gt;&lt;/a&gt; (refer to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6617?focusedCommentId=14708924&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14708924&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;this comment&lt;/a&gt;). &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6617&quot; title=&quot;ReplicationSourceManager should be able to track multiple WAL paths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6617&quot;&gt;&lt;del&gt;HBASE-6617&lt;/del&gt;&lt;/a&gt; is already integrated into branch-1 and master, but not branch-1.2. I believe branch-1 won&apos;t have such issue, you could give it a try if possible.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;, feel free to let me know if would like to take &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6617&quot; title=&quot;ReplicationSourceManager should be able to track multiple WAL paths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6617&quot;&gt;&lt;del&gt;HBASE-6617&lt;/del&gt;&lt;/a&gt; into branch-1.2, I could make a quick patch although there may be some rebase work &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14977871" author="ashu210890" created="Wed, 28 Oct 2015 07:04:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=carp84&quot; class=&quot;user-hover&quot; rel=&quot;carp84&quot;&gt;Yu Li&lt;/a&gt; I encountered the issue on branch-1.2. As you already mentioned and I also tried the same on master and branch-1. The issue has been fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6617&quot; title=&quot;ReplicationSourceManager should be able to track multiple WAL paths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6617&quot;&gt;&lt;del&gt;HBASE-6617&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14977895" author="carp84" created="Wed, 28 Oct 2015 07:26:04 +0000"  >&lt;p&gt;Good to know, and thanks for the quick confirmation &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashu210890&quot; class=&quot;user-hover&quot; rel=&quot;ashu210890&quot;&gt;Ashu Pachauri&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14979818" author="carp84" created="Thu, 29 Oct 2015 05:02:50 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; for help integrating &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6617&quot; title=&quot;ReplicationSourceManager should be able to track multiple WAL paths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6617&quot;&gt;&lt;del&gt;HBASE-6617&lt;/del&gt;&lt;/a&gt; into branch-1.2, it seems we could close this JIRA now?&lt;/p&gt;</comment>
                            <comment id="14979853" author="eclark" created="Thu, 29 Oct 2015 05:36:24 +0000"  >&lt;p&gt;Yep, closing this should be fine now.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12604086">HBASE-6617</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 26 Oct 2015 21:16:36 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 7 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2njjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>