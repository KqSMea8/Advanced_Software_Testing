<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:47:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7621/HBASE-7621.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7621] REST client (RemoteHTable) doesn&apos;t support binary row keys</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7621</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The REST server doesn&apos;t seem to support using binary (MD5 for example) row keys. I believe the root cause of this is the use of Bytes.toBytes() in the RowSpec.parseRowKeys() method. Based on the use of Bytes.toStringBinary() within RemoteHTable.buildRowSpec(), I believe the converse function Bytes.toBytesBinary() should be used for row key parsing in RowSpec.parseRowKeys().&lt;/p&gt;

&lt;p&gt;I also noticed that the RemoteHTable.buildRowSpec() method isn&apos;t URL encoding the row key, which is a mismatch to the logic in RowSpec.parseRowKeys() which performs URL decoding for both the start and stop row keys.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12628233">HBASE-7621</key>
            <summary>REST client (RemoteHTable) doesn&apos;t support binary row keys</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kdwinkler">Keith David Winkler</assignee>
                                    <reporter username="cmuchinsky@initiatesystems.com">Craig Muchinsky</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Jan 2013 16:28:29 +0000</created>
                <updated>Fri, 19 Aug 2016 21:41:43 +0000</updated>
                            <resolved>Fri, 19 Aug 2016 19:30:57 +0000</resolved>
                                    <version>0.94.0</version>
                    <version>0.95.2</version>
                    <version>0.98.4</version>
                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.4.0</fixVersion>
                                    <component>REST</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13557567" author="apurtell" created="Fri, 18 Jan 2013 20:25:59 +0000"  >&lt;p&gt;Thanks for pointing out these mismatched idioms. RemoteHTable was contributed primarily to aid unit tests. We should fix these issues with it and/or move it into the tests package. &lt;/p&gt;

&lt;p&gt;We should choose one of toStringBinary hex escapes or URL encoding. The latter seems less likely to surprise.&lt;/p&gt;</comment>
                            <comment id="13557589" author="cmuchinsky@initiatesystems.com" created="Fri, 18 Jan 2013 20:47:34 +0000"  >&lt;p&gt;I like the idea of using either hex escaping or URL encoding for simplicity, however based on my testing the hex escaping by itself isn&apos;t URL friendly, so it had to be URL encoded. I haven&apos;t tried just using URL encoding by itself. One argument for keeping both would be consistency with the shell, which already supports hex notation.&lt;/p&gt;</comment>
                            <comment id="13557591" author="apurtell" created="Fri, 18 Jan 2013 20:50:32 +0000"  >&lt;p&gt;This is all out of cache for me, but:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;One argument for keeping both would be consistency with the shell, which already supports hex notation.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think this was the idea...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;however based on my testing the hex escaping by itself isn&apos;t URL friendly, so it had to be URL encoded&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;... but this is the issue.&lt;/p&gt;</comment>
                            <comment id="14639511" author="rkellogg" created="Thu, 23 Jul 2015 21:13:55 +0000"  >&lt;p&gt;On a related issue, I spent most of the day today tracking down a problem with text keys (part1*part2*part3) with embedded asterisks.  When I converted them to underscores all the problems went away.&lt;/p&gt;

&lt;p&gt;Believe the fundamental issue is within the org.apache.hadoop.hbase.util.Bytes.toStringBinary method.  It attempts to do some sort of encoding which I believe is not URL friendly.&lt;/p&gt;

&lt;p&gt;There are no unit tests related to punctuation characters in the KeyValueTestUtil class.&lt;/p&gt;</comment>
                            <comment id="14639523" author="rkellogg" created="Thu, 23 Jul 2015 21:20:03 +0000"  >&lt;p&gt;Verified problem exists with 0.98.4.2.2.4.2-2-hadoop2&lt;/p&gt;</comment>
                            <comment id="14639575" author="rkellogg" created="Thu, 23 Jul 2015 21:52:55 +0000"  >&lt;p&gt;Per the Stargate Wiki, the use of an asterisk &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; is considered a wildcard for Globbing purposes on a Cell or Row Query.  See &lt;a href=&quot;http://wiki.apache.org/hadoop/Hbase/Stargate&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/Hbase/Stargate&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Therefore it is invalid to create a row key with an embedded asterisk unless changes are made to support escaping or wildcard logic.&lt;/p&gt;</comment>
                            <comment id="15421936" author="kdwinkler" created="Tue, 16 Aug 2016 00:16:16 +0000"  >&lt;p&gt;A more concise and complete description of the problem I hope: &lt;/p&gt;

&lt;p&gt;org.apache.hadoop.hbase.util.Bytes.toStringBinary does not work for encoding row keys in URLs for two reasons.&lt;/p&gt;

&lt;p&gt;(1) It escapes characters with a backslash x instead of % (\x02 instead of %02) and backslash is NOT a valid URL character.&lt;br/&gt;
(2) It escapes a SUBSET of the characters which must be escaped.  For example it does not escape &quot;|&quot;, which is not a valid URL character and must be escaped.&lt;/p&gt;

&lt;p&gt;This problem makes RemoteHTable unusable for tables with arbitrary binary keys.  Users cannot do the URI escape before calling RemoteHTable methods in all cases because, in the put methods, for example, the passed row key (pre-escaped) is also added to the request body, where it should NOT be escaped.  &lt;/p&gt;

&lt;p&gt;Note the annotations on RemoteHTable:&lt;/p&gt;

&lt;p&gt;@InterfaceAudience.Public&lt;br/&gt;
@InterfaceStability.Stable&lt;br/&gt;
public class RemoteHTable implements Table {&lt;/p&gt;</comment>
                            <comment id="15421975" author="apurtell" created="Tue, 16 Aug 2016 00:55:11 +0000"  >&lt;p&gt;Repeating my above comment&lt;/p&gt;

&lt;p&gt;RemoteHTable was contributed primarily to aid unit tests. We should fix these issues with it and/or move it into the tests package. I vote for moving it under src/test/. There are many HTTP client libraries of far fuller functionality than we would accomplish, not being in the business of writing HTTP clients... &lt;/p&gt;</comment>
                            <comment id="15423735" author="kdwinkler" created="Wed, 17 Aug 2016 01:39:55 +0000"  >&lt;p&gt;Thanks Andrew, that makes sense.  There are probably many folks like me that use RemoteHTable as a (valuable) tool in their own tests/tools for java codebases. And likely there some projects out there that use RemoteHTable in production.   The fix for this issue is straightforward, I&apos;ll work on a patch.&lt;/p&gt;</comment>
                            <comment id="15424643" author="kdwinkler" created="Wed, 17 Aug 2016 14:49:07 +0000"  >&lt;p&gt;I don&apos;t seem to have permission to attach a patch, though I have done so in the past.  I have placed the patch here (maybe someone else can attach):&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://redshiftsoft.com/patches/HBASE-7621.master.001.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://redshiftsoft.com/patches/HBASE-7621.master.001.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This patch properly escapes all usages of row keys, columns, and qualifiers in RemoteHTable.  It is not necessary to escape table names as Hbase itself requires they contain only characters which are already valid in URLs.   In TestRemoteHTable I updated the row keys, columns, and qualifiers to contain invalid URL characters.  This caused all tests in the class to fail before my fix is applied.&lt;/p&gt;</comment>
                            <comment id="15425098" author="apurtell" created="Wed, 17 Aug 2016 18:19:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kdwinkler&quot; class=&quot;user-hover&quot; rel=&quot;kdwinkler&quot;&gt;Keith David Winkler&lt;/a&gt; The ASF JIRA instance suffered some spam attacks that required tightening of permissions. I&apos;ve added you to the contributor role on the project and assigned this issue to you. You will be able to attach files and trigger the patch submission workflow now. &lt;/p&gt;</comment>
                            <comment id="15426703" author="kdwinkler" created="Thu, 18 Aug 2016 16:05:14 +0000"  >&lt;p&gt;Attached patch described in comments.&lt;/p&gt;</comment>
                            <comment id="15426711" author="hadoopqa" created="Thu, 18 Aug 2016 16:09:10 +0000"  >&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Vote &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Runtime &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Comment &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt;0&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt; reexec &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt; 0m 0s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt; Docker mode activated. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; docker &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; 0m 4s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; Docker failed to build yetus/hbase:date2016-08-18. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Report/Notes &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Patch URL &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12824395/HBASE-7621.master.001.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12824395/HBASE-7621.master.001.patch&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Issue &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7621&quot; title=&quot;REST client (RemoteHTable) doesn&amp;#39;t support binary row keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7621&quot;&gt;&lt;del&gt;HBASE-7621&lt;/del&gt;&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Console output &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/3148/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/3148/console&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Powered by &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Apache Yetus 0.3.0   &lt;a href=&quot;http://yetus.apache.org&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://yetus.apache.org&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;



&lt;p&gt;This message was automatically generated.&lt;/p&gt;
</comment>
                            <comment id="15426714" author="kdwinkler" created="Thu, 18 Aug 2016 16:09:25 +0000"  >&lt;p&gt;Updated jira title to reflect that the problem was in the REST client (RemoteHTable) and not the server.&lt;/p&gt;</comment>
                            <comment id="15428545" author="apurtell" created="Fri, 19 Aug 2016 17:57:14 +0000"  >&lt;p&gt;This change looks fine to commit only to master and branch-1 branches, as it&apos;s a behavioral change but also a protocol correctness fix. I&apos;d like us to consider moving RemoteHTable out of src/main/ to src/test/ but it has some users clearly so for now let&apos;s support it as we normally would. &lt;/p&gt;

&lt;p&gt;+1, will commit shortly&lt;/p&gt;</comment>
                            <comment id="15428747" author="hudson" created="Fri, 19 Aug 2016 20:06:53 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build HBase-1.4 #356 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.4/356/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.4/356/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7621&quot; title=&quot;REST client (RemoteHTable) doesn&amp;#39;t support binary row keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7621&quot;&gt;&lt;del&gt;HBASE-7621&lt;/del&gt;&lt;/a&gt; REST client (RemoteHTable) doesn&apos;t support binary row keys (apurtell: rev b3ca9a9b2f91ce5d43c30113cbfbbbaf8cade9c0)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hbase-rest/src/main/java/org/apache/hadoop/hbase/rest/client/RemoteHTable.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-rest/src/test/java/org/apache/hadoop/hbase/rest/client/TestRemoteTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15428892" author="hudson" created="Fri, 19 Aug 2016 21:41:43 +0000"  >&lt;p&gt;FAILURE: Integrated in Jenkins build HBase-Trunk_matrix #1445 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/1445/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/1445/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7621&quot; title=&quot;REST client (RemoteHTable) doesn&amp;#39;t support binary row keys&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7621&quot;&gt;&lt;del&gt;HBASE-7621&lt;/del&gt;&lt;/a&gt; REST client (RemoteHTable) doesn&apos;t support binary row keys (apurtell: rev 7145e46b7afd6d76df1ef001557c7b60bfc6055b)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) hbase-rest/src/main/java/org/apache/hadoop/hbase/rest/client/RemoteHTable.java&lt;/li&gt;
	&lt;li&gt;(edit) hbase-rest/src/test/java/org/apache/hadoop/hbase/rest/client/TestRemoteTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12824395" name="HBASE-7621.master.001.patch" size="11079" author="kdwinkler" created="Thu, 18 Aug 2016 16:05:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 18 Jan 2013 20:25:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>305359</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i18bvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>256726</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>RemoteHTable now supports binary row keys with any character or byte by properly encoding request URLs. This is a both a behavioral change from earlier versions and an important fix for protocol correctness.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>