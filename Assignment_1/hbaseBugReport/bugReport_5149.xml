<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:25:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5149/HBASE-5149.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5149] getConfiguration() implementation is misleading</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5149</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The following code will not return the cluster configuration but the local one which is somewhat misleading.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
conn = (HConnection) HConnectionManager.getConnection(m_hbConfig); &lt;span class=&quot;code-comment&quot;&gt;//here the configuration is local
&lt;/span&gt;Configuration conf = conn.getConfiguration()
conf.getString(&lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.hregion.majorcompaction&quot;&lt;/span&gt;); &lt;span class=&quot;code-comment&quot;&gt;// will &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the parameter from the local config instead of the cluster the connection is connected to.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It is suggested that once a connection has been acquired the configuration object should be the one of the cluster.&lt;/p&gt;

&lt;p&gt;As a general observation it is not possible to retrieve the used configuration on the cluster&lt;br/&gt;
It is suggested to add API at &lt;tt&gt;HRegionServerInterface&lt;/tt&gt;, &lt;tt&gt;HMasterInterface&lt;/tt&gt; to get the configuration used by the component appropriately (note in 0.90.4 the getConfiguration exist on the Server interface implemented by HRegionServer and HMaster classes) but this interface is not visible/extended by HRegionServerInterface/HMasterInterface, therefore not accessible from client code.&lt;/p&gt;

&lt;p&gt;Also an API like &lt;tt&gt;HashMap&amp;lt;HserverInfo,Configuration&amp;gt; getClusterConfigurations()&lt;/tt&gt; can be added on the HConnection object.&lt;/p&gt;


&lt;p&gt;Additional notes:&lt;br/&gt;
Since servers can have different properties values (like disk, tmp dir,...) it can be acceptable that the configuration object returned by the connection returns special value to indicate - conflict between value or that multiple values exist.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12537696">HBASE-5149</key>
            <summary>getConfiguration() implementation is misleading</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mikaels">Mikael Sitruk</reporter>
                        <labels>
                    </labels>
                <created>Sun, 8 Jan 2012 22:58:57 +0000</created>
                <updated>Wed, 24 Dec 2014 20:11:28 +0000</updated>
                            <resolved>Wed, 24 Dec 2014 20:11:28 +0000</resolved>
                                    <version>0.90.1</version>
                    <version>0.90.2</version>
                    <version>0.90.4</version>
                                                    <component>master</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13185969" author="stack" created="Fri, 13 Jan 2012 23:12:16 +0000"  >&lt;p&gt;Seems fine to me... could just make the Server/HRI getConfiguration public.  There is no &apos;cluster&apos; configuration; each server has its own local version of Configuration (downside is that they could be out of sync.  upside is that they can be out of sync so can try different config on one regionserver independent of the others on cluster)&lt;/p&gt;</comment>
                            <comment id="13186009" author="mikaels" created="Sat, 14 Jan 2012 00:08:57 +0000"  >&lt;p&gt;+1 for making the method public.&lt;br/&gt;
regarding the need for cluster conf, i also understand your point nevertheless having out of sync config may cause problem and more are the servers more time it will take to find a problem. &lt;br/&gt;
Aren&apos;t some property be the same for all configurations? like hbase.root.dir? or hbase.zookeeper.quorum? &lt;/p&gt;

&lt;p&gt;I suggest anyway to add a comment in javadoc to clarify what you get when you call getConfiguration() from an &quot;object, something like &quot;getConfiguration()&quot; will return the local configuration object not a &apos;cluster&apos; wise configuration.&lt;/p&gt;</comment>
                            <comment id="13186016" author="tlipcon" created="Sat, 14 Jan 2012 00:26:33 +0000"  >&lt;p&gt;Making the HRI call public seems like a messy idea to me - it seems non-obvious that calling &lt;tt&gt;getConfiguration&lt;/tt&gt; would incur an RPC to another machine... I expect &lt;tt&gt;get*&lt;/tt&gt; calls to be fast and local.&lt;/p&gt;</comment>
                            <comment id="13186023" author="zhihyu@ebaysf.com" created="Sat, 14 Jan 2012 00:31:07 +0000"  >&lt;p&gt;One scenario for region servers to have non-uniform configuration values is where some region servers run along side task trackers but some other region servers don&apos;t.&lt;/p&gt;</comment>
                            <comment id="13186038" author="stack" created="Sat, 14 Jan 2012 00:49:05 +0000"  >&lt;p&gt;@Mikhael&lt;/p&gt;

&lt;p&gt;When regionserver checks in, its passed some config to use such as hbase.rootdir.  Regards cluster properties, one idea thats been kicked around is putting config up in zk.   Yes, we should mod the getConfiguration client code to say its local config. (and add a call to HBaseAdmin for asking a server its config &amp;#8211; w/ doc to say its doing an RPC to ameliorate Todds concern.  On the other hand, in hadoops in excess of 1.0.0, there is a configuration servlet that will serve up a server&apos;s configuration that we can reveal at no cost in hbase).&lt;/p&gt;</comment>
                            <comment id="13186045" author="lhofhansl" created="Sat, 14 Jan 2012 01:12:41 +0000"  >&lt;p&gt;It think it is implied that HConnection.getConfiguration is the local configuration of that connection, as HConnection is client side object.&lt;/p&gt;

&lt;p&gt;+1 on adding a server config method to HBaseAdmin (but not to HConnection). Something like HBaseAdmin.getServerConfig(ServerName)?&lt;/p&gt;</comment>
                            <comment id="13186353" author="mikaels" created="Sat, 14 Jan 2012 22:04:43 +0000"  >&lt;p&gt;HbaseAdmin.getServerConfig(ServerName) is also fine from my point of view.&lt;br/&gt;
As far as I understand the concern Todd concern perhaps the problem is that the HRegionServer should have a method for local config, and HRegionInterface have the method for the remote call.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;HRegionInterface is the interface used by client to interact with the server side, it is logic that method are remote call&lt;/li&gt;
	&lt;li&gt;HRegionServer is the implementation used by server side, so it is expected to work locally.&lt;br/&gt;
So perhaps all the point should be to refactor HRegionServer.getConnection() --&amp;gt; HRegionServer.getLocalConnection(), and to add on HRegionInterface the getConnection() throws IOException&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;but this are my two cents.&lt;/p&gt;
</comment>
                            <comment id="13186356" author="lhofhansl" created="Sat, 14 Jan 2012 22:31:17 +0000"  >&lt;p&gt;I think Todd was concerned changing HConnection.getConfiguration to make an RPC is unexpected. I share that concern and would add that this would lead to many other places in the client that would need to be changed.&lt;br/&gt;
Adding a similar method to HBaseAdmin is better, because RPCs are expected here, especially if we indicate this in the method name.&lt;/p&gt;</comment>
                            <comment id="13186367" author="mikaels" created="Sat, 14 Jan 2012 23:16:45 +0000"  >&lt;p&gt;Regarding HConnection.getConfiguration() i already agreed, sorry if this was not clear, as a user i don&apos;t like libraries that break API (adding the IOException), so this is understood.&lt;/p&gt;

&lt;p&gt;Regarding Todd comment, I think he was referring on the HRegionInterface with the concern of local/remote call. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 13 Jan 2012 23:12:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>223202</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 48 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02f6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12060</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>