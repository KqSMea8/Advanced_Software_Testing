<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:17:54 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4326/HBASE-4326.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4326] Tests that use HBaseTestingUtility.startMiniCluster(n) should shutdown with HBaseTestingUtility.shutdownMiniCluster.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4326</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Most tests that use mini clusters use this pattern&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; HBaseTestingUtility UTIL = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HBaseTestingUtility();

  @BeforeClass
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void beforeClass() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    UTIL.startMiniCluster(1);
  }

  @AfterClass
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void afterClass() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    UTIL.shutdownMiniCluster();
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Some tests (like hbase-4269)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  @BeforeClass
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void beforeClass() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    UTIL.startMiniCluster(1);
  }

  @AfterClass
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void afterClass() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    UTIL.getMiniCluster().shutdown();
    &lt;span class=&quot;code-comment&quot;&gt;// or UTIL.shutdownMiniHBaseCluster();
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// and likely others.
&lt;/span&gt;  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is a difference between the two shutdown &amp;#8211; the former deletes files created during the tests while the latter does not.  This funny state persisting (zk or hbase/mr data) may be the cause of strange inter-testcase problems when full suites are run.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12521136">HBASE-4326</key>
            <summary>Tests that use HBaseTestingUtility.startMiniCluster(n) should shutdown with HBaseTestingUtility.shutdownMiniCluster.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nkeywal">Nicolas Liochon</assignee>
                                    <reporter username="jmhsieh">Jonathan Hsieh</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Sep 2011 02:19:48 +0000</created>
                <updated>Fri, 12 Oct 2012 05:34:50 +0000</updated>
                            <resolved>Tue, 15 Nov 2011 14:31:30 +0000</resolved>
                                    <version>0.90.4</version>
                                    <fixVersion>0.94.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13095727" author="jmhsieh" created="Fri, 2 Sep 2011 02:38:48 +0000"  >&lt;p&gt;Tests on 0.90 branch that use the wrong convention:&lt;/p&gt;

&lt;p&gt;TestMultiParallel (UTIL.getMiniHBaseCluster().shutdown()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
TestRestartCluster (starts but doesn&apos;t close on some tests)&lt;br/&gt;
TestHLog (starts but doesn&apos;t cleanup)&lt;br/&gt;
TestMasterRestartAfterDisablingTable (start but no cleanup)&lt;br/&gt;
TestHBaseTestingUtility.testMiniCluster() (doesn&apos;t cleanup after itself)&lt;br/&gt;
TestImportTsv&lt;/p&gt;</comment>
                            <comment id="13095742" author="jmhsieh" created="Fri, 2 Sep 2011 03:22:04 +0000"  >&lt;p&gt;Its seems to generate a random dir unless a test.build.data system property is set.  If it is set the entire suite of tests may clash.&lt;/p&gt;

&lt;p&gt;How does one get the properties set before the build/test suites are run? &lt;/p&gt;</comment>
                            <comment id="13095782" author="stack" created="Fri, 2 Sep 2011 05:48:30 +0000"  >&lt;p&gt;We&apos;d have to add something to dump them out.  Do you want to do it for every test that is run Jon?  I took a quick look at surefire-tests goal and there doesn&apos;t seem to be a pre-test goal that we could add something to (nor did I see a system properties dump config &amp;#8211; there is a way to add system properties to the test context so we could set a flag that HBaseTestingUtility read and dumped all props if set?).&lt;/p&gt;</comment>
                            <comment id="13097013" author="jmhsieh" created="Mon, 5 Sep 2011 05:40:15 +0000"  >&lt;p&gt;Actually, if the HBaseTestingUtility calls dump the root dir they are using for temp hdfs storage to logs/console, we don&apos;t need the system properties.  It would be helpful to know where potential leftover files on runs are stored and to know where if and where temp files are being left behind.   &lt;/p&gt;
</comment>
                            <comment id="13097022" author="jmhsieh" created="Mon, 5 Sep 2011 05:59:48 +0000"  >&lt;p&gt;Hm.. looks like this actually done, but apache jenkins truncates the data so that it is not available from the build&apos;s logs.  I&apos;ve noticed some similar flaky test failures on my side and will do some runs to try to duplicate failures and  that keeps the full stdout/logs so we can debug.&lt;/p&gt;</comment>
                            <comment id="13114892" author="jmhsieh" created="Mon, 26 Sep 2011 20:28:17 +0000"  >&lt;p&gt;Adding @AfterClass shutdown to TestHLog seems to make the testLogCleaning tests hang when it attempts to shutdown.&lt;/p&gt;</comment>
                            <comment id="13150518" author="nkeywal" created="Tue, 15 Nov 2011 14:30:07 +0000"  >&lt;p&gt;I checked the status for the tests mentionned:&lt;br/&gt;
TestMultiParallel (UTIL.getMiniHBaseCluster().shutdown()  ==&amp;gt; ok&lt;br/&gt;
TestRestartCluster (starts but doesn&apos;t close on some tests)  ==&amp;gt; shutdown in tearDown ==&amp;gt; ok&lt;br/&gt;
TestHLog (starts but doesn&apos;t cleanup)  ==&amp;gt; shutdown the minidfs cluster, should be ok, I will anyway shutdown the whole cluster (will do that as a part of a bigger jira in progress)&lt;br/&gt;
TestMasterRestartAfterDisablingTable (start but no cleanup) ==&amp;gt; ok&lt;br/&gt;
TestHBaseTestingUtility.testMiniCluster() (doesn&apos;t cleanup after itself)   ==&amp;gt; ok&lt;br/&gt;
TestImportTsv ==&amp;gt; ok&lt;/p&gt;

&lt;p&gt;Note that the cleanup is not done if the directory is not empty. I think it makes sense to add a shutdown hook to do a full cleanup.&lt;/p&gt;</comment>
                            <comment id="13150520" author="nkeywal" created="Tue, 15 Nov 2011 14:30:51 +0000"  >&lt;p&gt;note: check done on trunk, not .90&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12527439">HBASE-4602</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 2 Sep 2011 05:48:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>719</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 5 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08rn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49078</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>