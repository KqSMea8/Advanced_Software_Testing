<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:29:21 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5614/HBASE-5614.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5614] createTableAsync gets blocked and it is not an asynchronous operation</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5614</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I have created table A using &lt;tt&gt;HBaseAdmin.createTableAsync()&lt;/tt&gt; with 2000 pre-split regions, the expectation was client RPC call does not get blocked and i had only used 5 minutes as RPC socket timeout value.&lt;/p&gt;

&lt;p&gt;It appears from logs/code that clients gets blocked (honoring the &lt;tt&gt;hbase.rpc.timeout&lt;/tt&gt; value), times out after 5 minutes, master nio channel gets closed (related to client which invoked the createAsyncTable operation), put region entries in inconsistent state in META, meaning &lt;tt&gt;info:server&lt;/tt&gt; is marked as null and AssignmentManager gets null server value (which causes NPE) and causes to table creation fail, i could not succeed until changing the &lt;tt&gt;hbase.rpc.timeout&lt;/tt&gt; value to 15 minutes and created tables one at a time (each table has more than 2K pre-split regions in it)&lt;/p&gt;

&lt;p&gt;Please refer the logs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12547467">HBASE-5614</key>
            <summary>createTableAsync gets blocked and it is not an asynchronous operation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mubarakseyed">Mubarak Seyed</reporter>
                        <labels>
                            <label>beginner</label>
                    </labels>
                <created>Wed, 21 Mar 2012 22:21:28 +0000</created>
                <updated>Tue, 5 Aug 2014 20:06:07 +0000</updated>
                                            <version>0.90.4</version>
                                                    <component>master</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13235115" author="mubarakseyed" created="Wed, 21 Mar 2012 22:41:47 +0000"  >&lt;p&gt;&lt;tt&gt;HBaseAdmin.createAsyncTable&lt;/tt&gt; call from client to Master:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
12/03/21 18:00:26 WARN zookeeper.ZKTable: Moving table table_A state to enabled but was already enabled
12/03/21 18:00:26 INFO wal.HLog: HLog configuration: blocksize=128 MB, rollsize=121.6 MB, enabled=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, optionallogflushinternal=1000ms
12/03/21 18:00:26 INFO wal.SequenceFileLogWriter: Using syncFs -- HDFS-200
12/03/21 18:00:26 INFO wal.HLog: New hlog /hbase/root/table_A/6d3fe8aa7eae1c13b4ce5b54a13af1e0/.logs/hlog.1332352826075
12/03/21 18:00:26 INFO wal.HLog: Using getNumCurrentReplicas--HDFS-826
12/03/21 18:00:26 INFO regionserver.HRegion: Onlined table_A,,1332352825867.6d3fe8aa7eae1c13b4ce5b54a13af1e0.; next sequenceid=1
12/03/21 18:00:26 INFO catalog.MetaEditor: Added 1 regions to META
12/03/21 18:00:26 INFO regionserver.HRegion: Closed table_A,,1332352825867.6d3fe8aa7eae1c13b4ce5b54a13af1e0.
12/03/21 18:00:26 INFO regionserver.HRegion: Onlined table_A,0015d867,1332352825873.ecf7c1e64eae49c396577e3156bc6555.; next sequenceid=1
12/03/21 18:00:26 INFO regionserver.HRegion: Closed table_A,0015d867,1332352825873.ecf7c1e64eae49c396577e3156bc6555.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After 5 minutes &lt;tt&gt;hbase.rpc.timeout&lt;/tt&gt; value, master client channel gets ClosedChannelException&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
12/03/21 18:05:28 WARN ipc.HBaseServer: IPC Server Responder, call createTable({NAME =&amp;gt; &apos;table_A&apos;, FAMILIES =&amp;gt; [{NAME =&amp;gt; &apos;CF1s&apos;, BLOOMFILTER =&amp;gt; &apos;ROW&apos;, REPLICATION_SCOPE =&amp;gt; &apos;0&apos;, VERSIONS =&amp;gt; &apos;1&apos;, COMPRESSION =&amp;gt; &apos;LZO&apos;, TTL =&amp;gt; &apos;298700000&apos;, BLOCKSIZE =&amp;gt; &apos;65536&apos;, IN_MEMORY =&amp;gt; &apos;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&apos;, BLOCKCACHE =&amp;gt; &apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;}]}, [[B@25a0504a) from 1.1.1.1:34981: output error
12/03/21 18:05:28 WARN ipc.HBaseServer: IPC Server handler 73 on 60000 caught: java.nio.channels.ClosedChannelException
        at sun.nio.ch.SocketChannelImpl.ensureWriteOpen(SocketChannelImpl.java:133)
        at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:324)
        at org.apache.hadoop.hbase.ipc.HBaseServer.channelWrite(HBaseServer.java:1341)
        at org.apache.hadoop.hbase.ipc.HBaseServer$Responder.processResponse(HBaseServer.java:727)
        at org.apache.hadoop.hbase.ipc.HBaseServer$Responder.doRespond(HBaseServer.java:792)
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1083)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;tt&gt;AssignmentManager&lt;/tt&gt; gets &lt;tt&gt;null&lt;/tt&gt; value as server location&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
12/03/21 18:35:13 INFO master.AssignmentManager: Server &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; returned java.lang.NullPointerException: Passed server is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; 6d3fe8aa7eae1c13b4ce5b54a13af1e0
12/03/21 18:35:13 INFO master.AssignmentManager: Server &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; returned java.lang.NullPointerException: Passed server is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; a47815dfcdf24f49e40f50b6fdd65dd9
12/03/21 18:35:13 INFO master.AssignmentManager: Server &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; returned java.lang.NullPointerException: Passed server is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ecf7c1e64eae49c396577e3156bc6555
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From master log, bulk assignment happens (100 regions at a time), i can increase the value to 200 (or higher) but &lt;tt&gt;createTableAsync&lt;/tt&gt; shouldn&apos;t get blocked.&lt;/p&gt;</comment>
                            <comment id="13235199" author="gchanan" created="Wed, 21 Mar 2012 23:33:00 +0000"  >&lt;p&gt;Are you going to look into fixing this Mubarak?  If not, I&apos;ll take a look.&lt;/p&gt;</comment>
                            <comment id="13235202" author="mubarakseyed" created="Wed, 21 Mar 2012 23:37:55 +0000"  >&lt;p&gt;@Gregory&lt;br/&gt;
I am working on it. Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 21 Mar 2012 23:33:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>232625</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02by7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11537</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>