<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:47:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-823/HBASE-823.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-823] Concurrent &quot;open mapfile reader&quot; limit</title>
                <link>https://issues.apache.org/jira/browse/HBASE-823</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-745&quot; title=&quot;scaling of one regionserver, improving memory and cpu usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-745&quot;&gt;&lt;del&gt;HBASE-745&lt;/del&gt;&lt;/a&gt;, Luo Ning profiling found that the number of open Readers has direct impact on memory used.  This issue is about putting an upper bound on the number of open Readers doing something like a bounded pool w/ a LRU eviction policy.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12402250">HBASE-823</key>
            <summary>Concurrent &quot;open mapfile reader&quot; limit</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Aug 2008 21:32:45 +0000</created>
                <updated>Mon, 5 Apr 2010 16:59:30 +0000</updated>
                            <resolved>Mon, 5 Apr 2010 16:59:30 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12622027" author="stack" created="Tue, 12 Aug 2008 23:33:41 +0000"  >&lt;p&gt;Could we solve this issue with Bryans&apos; suggestion from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-513&quot; title=&quot;Store Mapfile indexes in soft references&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-513&quot;&gt;&lt;del&gt;HBASE-513&lt;/del&gt;&lt;/a&gt;, &apos;Store Mapfile indexes in soft references&apos;&lt;/p&gt;</comment>
                            <comment id="12657985" author="stack" created="Fri, 19 Dec 2008 02:36:59 +0000"  >&lt;p&gt;Need new file format to be able to do stuff like limit indices or to store them in soft references.&lt;/p&gt;</comment>
                            <comment id="12671562" author="ln@webcate.net" created="Sun, 8 Feb 2009 06:16:59 +0000"  >&lt;p&gt;i think we need archiving 2 goals for the &apos;open reader limit&apos;:&lt;br/&gt;
1. fit xceiverCount limitation of hadoop, see &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-24&quot; title=&quot;Scaling: Too many open file handles to datanodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-24&quot;&gt;&lt;del&gt;HBASE-24&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
2. control memory usage of mapfile indexes.&lt;/p&gt;

&lt;p&gt;we may got 2 by control &apos;concurrent open readers&apos;, but it is not efficient. because mapfile index size is very different. for regionserver stable, we should make sure &apos;open file limit&apos; * &apos;max  mapfile index size&apos; &amp;lt; &apos;memory limit of regionserver&apos;. this mean set the &apos;open file limit&apos; low enough.&lt;/p&gt;

&lt;p&gt;so besides &apos;open reader limit&apos;, there should a &apos;max index size limit&apos; for concurrent mapfile reader controlling. the eviction policy need considering these 2 limitation together. &lt;/p&gt;

</comment>
                            <comment id="12671677" author="stack" created="Sun, 8 Feb 2009 21:10:51 +0000"  >&lt;p&gt;Luo: On 1., there is also the &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-223&quot; title=&quot;Asynchronous IO Handling in Hadoop and HDFS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-223&quot;&gt;HADOOP-3856&lt;/a&gt; tactic that Andrew Purtell is working on to get over the xceiver limit and work in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-61&quot; title=&quot;[hbase] Create an HBase-specific MapFile implementation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-61&quot;&gt;&lt;del&gt;HBASE-61&lt;/del&gt;&lt;/a&gt; should shrink index size in heap dramatically but even then your point stands, that we need to be counting the indices and capping their size.   Your &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-24&quot; title=&quot;Scaling: Too many open file handles to datanodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-24&quot;&gt;&lt;del&gt;HBASE-24&lt;/del&gt;&lt;/a&gt; patch where we limit number of open store files is probably only avenue open to us until &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-223&quot; title=&quot;Asynchronous IO Handling in Hadoop and HDFS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-223&quot;&gt;HADOOP-3856&lt;/a&gt; is done (Its a blocker on 0.20.0 hbase).&lt;/p&gt;</comment>
                            <comment id="12701775" author="stack" created="Thu, 23 Apr 2009 01:00:09 +0000"  >&lt;p&gt;Moving out of 0.20.0 &amp;#8211; we won&apos;t get to it I&apos;m thinking.&lt;/p&gt;</comment>
                            <comment id="12702609" author="stack" created="Fri, 24 Apr 2009 22:56:31 +0000"  >&lt;p&gt;Actually move this out.&lt;/p&gt;</comment>
                            <comment id="12746340" author="stack" created="Fri, 21 Aug 2009 23:03:33 +0000"  >&lt;p&gt;Knocking down from blocker status.  Number of Readers is less of an issue since hfile/single-file-used-by-both-scans-and-gets&lt;/p&gt;</comment>
                            <comment id="12853440" author="stack" created="Mon, 5 Apr 2010 16:59:30 +0000"  >&lt;p&gt;This issue has gone stale.  We no longerr use MapFiles and while we should probably bound the set of HFiles open in the regionserver, the number of concurrent open resources has come down a good bit since this issue was opened and we&apos;ll likely go other routes to conserve datanode resource usage (nio) before we put back an upper limit on hfiles open.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12390976">HBASE-513</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 8 Feb 2009 06:16:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31867</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h9nr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98827</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>