<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:54:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8318/HBASE-8318.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8318] TableOutputFormat.TableRecordWriter should accept Increments</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8318</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;TableOutputFormat.TableRecordWriter can take Puts and Deletes but it should also accept Increments.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12641834">HBASE-8318</key>
            <summary>TableOutputFormat.TableRecordWriter should accept Increments</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="7">Later</resolution>
                                        <assignee username="jmspaggi">Jean-Marc Spaggiari</assignee>
                                    <reporter username="jmspaggi">Jean-Marc Spaggiari</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Apr 2013 13:03:54 +0000</created>
                <updated>Mon, 12 Jan 2015 18:55:13 +0000</updated>
                            <resolved>Mon, 12 Jan 2015 16:54:57 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13627765" author="jmspaggi" created="Wed, 10 Apr 2013 13:07:53 +0000"  >&lt;p&gt;Small patch attached.&lt;/p&gt;</comment>
                            <comment id="13628501" author="ndimiduk" created="Thu, 11 Apr 2013 00:36:21 +0000"  >&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;       else if (value instanceof Delete) this.table.delete(new Delete((Delete)value));
+      else if (value instanceof Increment) this.table.increment(new Increment((Increment)value));
       else throw new IOException(&quot;Pass a Delete or a Put&quot;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;please update the exception text as well.&lt;/p&gt;

&lt;p&gt;I&apos;d ask you to add support to mapred.TableOutputFormat as well, but it appears to have suffered significant drift from the other namespace.&lt;/p&gt;

&lt;p&gt;+1.&lt;/p&gt;</comment>
                            <comment id="13629025" author="jmspaggi" created="Thu, 11 Apr 2013 15:42:30 +0000"  >&lt;p&gt;Thanks for the review. I changed the text in 0.95 but forgot for the trunk.&lt;/p&gt;

&lt;p&gt;Just attached the updated version.&lt;/p&gt;</comment>
                            <comment id="13629037" author="hadoopqa" created="Thu, 11 Apr 2013 15:53:40 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12578230/HBASE-8318-v1-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12578230/HBASE-8318-v1-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 hadoop2.0&lt;/font&gt;.  The patch failed to compile against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5264//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5264//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13629046" author="jmspaggi" created="Thu, 11 Apr 2013 15:59:38 +0000"  >&lt;p&gt;Forgot TestFromClientSide...&lt;/p&gt;</comment>
                            <comment id="13629049" author="hadoopqa" created="Thu, 11 Apr 2013 16:03:32 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12578233/HBASE-8318-v1-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12578233/HBASE-8318-v1-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 hadoop2.0&lt;/font&gt;.  The patch failed to compile against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5265//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5265//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13629084" author="jmspaggi" created="Thu, 11 Apr 2013 16:33:28 +0000"  >&lt;p&gt;Fixed on issue withing Increment constructor. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tedyu@apache.org&quot;&gt;Ted Yu&lt;/a&gt; for pointing me to the issue.&lt;/p&gt;</comment>
                            <comment id="13629163" author="hadoopqa" created="Thu, 11 Apr 2013 17:48:45 +0000"  >&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12578238/HBASE-8318-v2-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12578238/HBASE-8318-v2-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop2.0&lt;/font&gt;.  The patch compiles against the hadoop 2.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop1-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/5266//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13629206" author="yuzhihong@gmail.com" created="Thu, 11 Apr 2013 18:34:41 +0000"  >&lt;p&gt;Looks good to me.&lt;/p&gt;</comment>
                            <comment id="13630448" author="jdcryans" created="Fri, 12 Apr 2013 18:31:56 +0000"  >&lt;p&gt;Generally, using ICV in MR jobs is a bad idea because of speculative execution which is enabled by default, and even if it&apos;s disabled your tasks can just fail and then they get restarted somewhere else and you never know how many times you incremented some cells.&lt;/p&gt;

&lt;p&gt;So, what&apos;s a valid use case for this jira?&lt;/p&gt;</comment>
                            <comment id="13630596" author="jmspaggi" created="Fri, 12 Apr 2013 20:32:05 +0000"  >&lt;p&gt;I totally understand your point. &lt;/p&gt;

&lt;p&gt;In my usecase, accuracy is not required. I have 2 tables. One with 21 millions lines and another one with about 500 millions lines. Both of them are read over a MR job to generate a 300-600 line table. At the end, if I miss some lines from the input, or if some are double counted, it&apos;s not really an issue.&lt;/p&gt;

&lt;p&gt;In total, I have about 400 tasks. So if 1 is failling, I can expect a maximum of 0.25% errors. Which is totally accceptable (again, for this specific usecase).&lt;/p&gt;

&lt;p&gt;We have almost the same issue with the Puts where we will loose some of the versions if we have to re-launch some tasks. &lt;/p&gt;

&lt;p&gt;So as long as the user is aware of the risks I think this JIRA is acceptable.&lt;/p&gt;</comment>
                            <comment id="13632269" author="jdcryans" created="Mon, 15 Apr 2013 22:04:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;In total, I have about 400 tasks. So if 1 is failling, I can expect a maximum of 0.25% errors. Which is totally accceptable (again, for this specific usecase).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;FWIW if you have a machine failure then you&apos;ll usually retry as many maps as map slots are available on your TT.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We have almost the same issue with the Puts where we will loose some of the versions if we have to re-launch some tasks.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Writing from MR should always be idempotent, because you don&apos;t know exactly how many times you&apos;ll write each row. If a task fails midway, then the rows already written will be later overwritten and that&apos;s fine. So I don&apos;t see how we have &quot;almost the same issue&quot;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;So as long as the user is aware of the risks I think this JIRA is acceptable.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;How would that be communicated to the user? It seems to me that just leaving a comment in the javadoc is insufficient considering that speculative exec is turned on by default, meaning that double/triple counting would not just be an edge case but the default case.&lt;/p&gt;</comment>
                            <comment id="13632472" author="jmspaggi" created="Tue, 16 Apr 2013 01:35:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;So I don&apos;t see how we have &quot;almost the same issue&quot;.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Let&apos;s take an example. You have billions of lines representing users actions. Each night, you have a MR job which is doing some statistics for those users, per user (one line per user). In your table you have 30 versions. So you can have a monthly stat by retreiving all the versions for a specific user. You know the date, so you can display the result by date starting from today, to d-30.&lt;/p&gt;

&lt;p&gt;Now, if your task is failing, it might still have put some data in the table. So for some users, the 30 versions are no more representing the same dates as for some other users, since some jobs are going to be re-run, which will do another Put, will push the versions by one, and will corrupt your results.&lt;/p&gt;

&lt;p&gt;You will end with something like that:&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;-----+&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  Key  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Ver0 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Ver1 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Ver2 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Ver3 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Ver4 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Ver5 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Ver6 &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;-----+&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; User1 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t0  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t2  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t3  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t4  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t5  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t6  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &amp;lt;= Everything went well for this user.&lt;br/&gt;
&lt;ins&gt;------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;-----+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; User2 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t0  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t0  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t2  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t3  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t4  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t5  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &amp;lt;= Task failed for this one but data was already writtent into the table. So task wrote the value t0 twice.&lt;br/&gt;
&lt;ins&gt;------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;-----+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; User3 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t0  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t1  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t2  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t3  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t4  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t5  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  t6  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &amp;lt;= Everything went well for this user.&lt;br/&gt;
&lt;ins&gt;------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;-----+&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;Data at v0 is correct, but for User2, other version are not more alligned as expected.&lt;/p&gt;

&lt;p&gt;So there is still some usecases where Puts can generate some corrupted results too.&lt;/p&gt;

&lt;p&gt;Regarding the way to communicate that to the user, I agree that javadoc might be a bit light since users will probably use the JARs and not really look at the code. Maybe we can add something about Increments and Puts into the online documentation too? Some debug warnings logs might be useful to? Or do you have any other recommandation?&lt;/p&gt;</comment>
                            <comment id="13633192" author="jdcryans" created="Tue, 16 Apr 2013 19:00:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;Data at v0 is correct, but for User2, other version are not more alligned as expected.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Your use case is pretty edgy, and even then I think HBase still does the right thing as long as you use the same timestamps for all your versions. In your example, User2 will only have one version of t0 if both t0 are equal, meaning that t6 will not get discarded (the older t0 would). If not, your use case would be broken by any write to a RS that dies, if the write was committed but the call failed to return properly (the client would then retry and write elsewhere).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Or do you have any other recommandation?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not let people use ICVs in MR &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;But talking to the other boys here (mostly Jon, Elliott and Jimmy), they think it would still be useful. We agreed that:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;We should accept both Append and Increment by default.&lt;/li&gt;
	&lt;li&gt;We should print a fat WARN if speculative execution is turned on (map or reduce), warning the user of what might happen for any operation (so not just CAS operations).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We could still warn the user if spec exec is turned off when they use Append/Increment but we would need to keep a boolean around and warn only after the first use. What I&apos;m thinking here is that people usually don&apos;t use multiple versions as a default use case, but CAS operations will always have the potential to be &quot;broken&quot; when tasks die and are retried.&lt;/p&gt;

&lt;p&gt;What do you think JM?&lt;/p&gt;</comment>
                            <comment id="14269133" author="clehene" created="Thu, 8 Jan 2015 10:16:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt; did this one fell through the cracks? &lt;/p&gt;</comment>
                            <comment id="14269134" author="clehene" created="Thu, 8 Jan 2015 10:17:05 +0000"  >&lt;ul&gt;
	&lt;li&gt;fall &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14269144" author="hadoopqa" created="Thu, 8 Jan 2015 10:22:04 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12578238/HBASE-8318-v2-trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12578238/HBASE-8318-v2-trunk.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 645fbd7d87450b31b67b1e535cdb9c1cf50ffd16.&lt;br/&gt;
  ATTACHMENT ID: 12578238&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/12360//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/12360//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14273760" author="jdcryans" created="Mon, 12 Jan 2015 16:45:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=clehene&quot; class=&quot;user-hover&quot; rel=&quot;clehene&quot;&gt;Cosmin Lehene&lt;/a&gt; hey, so re-reading what I wrote, my opinion remains the same. Fact that nobody else picked this up seems to imply that it isn&apos;t a common use case either. I&apos;m fine closing this.&lt;/p&gt;</comment>
                            <comment id="14273772" author="clehene" created="Mon, 12 Jan 2015 16:54:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmspaggi&quot; class=&quot;user-hover&quot; rel=&quot;jmspaggi&quot;&gt;Jean-Marc Spaggiari&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt; closing this as later. &lt;/p&gt;

&lt;p&gt;Non-idempotent MR jobs are always a pain. I&apos;d be curious if this is still needed.&lt;/p&gt;

&lt;p&gt;Generally the incremental MR problem can be solved without non-idempotent operations too.&lt;/p&gt;

&lt;p&gt;Let&apos;s re-open if really needed. &lt;/p&gt;</comment>
                            <comment id="14273775" author="clehene" created="Mon, 12 Jan 2015 16:56:00 +0000"  >&lt;p&gt;In case this gets reopened: I think it should be disabled by default with some configuration override.&lt;/p&gt;</comment>
                            <comment id="14273950" author="ndimiduk" created="Mon, 12 Jan 2015 18:55:13 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think it should be disabled by default with some configuration override.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Excellent idea &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=clehene&quot; class=&quot;user-hover&quot; rel=&quot;clehene&quot;&gt;Cosmin Lehene&lt;/a&gt;. I think it&apos;s not our place to tell a user &quot;no, you cannot do this&quot;. HBase is a project that is full of both rules and exceptions.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12578001" name="HBASE-8318-v0-trunk.patch" size="2602" author="jmspaggi" created="Wed, 10 Apr 2013 13:07:36 +0000"/>
                            <attachment id="12578233" name="HBASE-8318-v1-trunk.patch" size="2679" author="jmspaggi" created="Thu, 11 Apr 2013 15:59:28 +0000"/>
                            <attachment id="12578238" name="HBASE-8318-v2-trunk.patch" size="2721" author="jmspaggi" created="Thu, 11 Apr 2013 16:32:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 11 Apr 2013 00:36:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322249</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1jllj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322594</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>