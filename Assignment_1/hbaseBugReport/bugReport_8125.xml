<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:52:15 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8125/HBASE-8125.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8125] HBASE-7435 breaks BuiltInGzipDecompressor on Hadoop &lt; 1.0.x</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8125</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;From some friends of ours at dropbox:&lt;/p&gt;

&lt;p&gt;Index: src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java&lt;br/&gt;
===================================================================&lt;br/&gt;
&amp;#8212; src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java	(revision 1425723)&lt;br/&gt;
+++ src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java	(working copy)&lt;br/&gt;
@@ -33,6 +33,7 @@&lt;br/&gt;
 import org.apache.hadoop.io.compress.CompressionOutputStream;&lt;br/&gt;
 import org.apache.hadoop.io.compress.Compressor;&lt;br/&gt;
 import org.apache.hadoop.io.compress.Decompressor;&lt;br/&gt;
+import org.apache.hadoop.io.compress.DoNotPool;&lt;br/&gt;
 import org.apache.hadoop.io.compress.GzipCodec;&lt;br/&gt;
 import org.apache.hadoop.io.compress.DefaultCodec;&lt;br/&gt;
 import org.apache.hadoop.util.ReflectionUtils;&lt;br/&gt;
@@ -308,6 +309,9 @@&lt;br/&gt;
     public void returnDecompressor(Decompressor decompressor) {&lt;br/&gt;
       if (decompressor != null) {&lt;br/&gt;
         CodecPool.returnDecompressor(decompressor);&lt;br/&gt;
+        if (decompressor.getClass().isAnnotationPresent(DoNotPool.class)) &lt;/p&gt;
{
+          decompressor.end();
+        }
&lt;p&gt;       }&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;breaks compatibility with hadoop-0.20.2-cdh3u2. &lt;br/&gt;
+import org.apache.hadoop.io.compress.DoNotPool;&lt;br/&gt;
does not exist in that version of hadoop.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12637300">HBASE-8125</key>
            <summary>HBASE-7435 breaks BuiltInGzipDecompressor on Hadoop &lt; 1.0.x</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuzhihong@gmail.com">Ted Yu</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Mar 2013 23:44:01 +0000</created>
                <updated>Sat, 27 Apr 2013 15:55:23 +0000</updated>
                            <resolved>Tue, 19 Mar 2013 18:08:26 +0000</resolved>
                                                    <fixVersion>0.94.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13604033" author="yuzhihong@gmail.com" created="Sat, 16 Mar 2013 00:23:16 +0000"  >&lt;p&gt;One solution is to call decompressor.getClass().getAnnotations() instead of calling isAnnotationPresent().&lt;br/&gt;
We can iterate through the Annotations returned and see if DoNotPool is present.&lt;/p&gt;

&lt;p&gt;I can put up a patch if the above approach is accepted.&lt;/p&gt;</comment>
                            <comment id="13604453" author="yuzhihong@gmail.com" created="Sat, 16 Mar 2013 23:38:33 +0000"  >&lt;p&gt;Patch using the described approach.&lt;/p&gt;</comment>
                            <comment id="13604471" author="lhofhansl" created="Sun, 17 Mar 2013 01:06:34 +0000"  >&lt;p&gt;+1&lt;br/&gt;
So this breaks 0.94 on Hadoop 0.20.x. Should I sink the RC, again?&lt;/p&gt;</comment>
                            <comment id="13604473" author="yuzhihong@gmail.com" created="Sun, 17 Mar 2013 01:21:22 +0000"  >&lt;p&gt;This happened at the release of 0.94.4&lt;/p&gt;

&lt;p&gt;I don&apos;t think we should sink RC2.&lt;/p&gt;

&lt;p&gt;Will report back with test suite result.&lt;/p&gt;</comment>
                            <comment id="13604478" author="jmspaggi" created="Sun, 17 Mar 2013 02:13:21 +0000"  >&lt;p&gt;I agree with Ted.&lt;/p&gt;

&lt;p&gt;If it was already failing in previous releases, I don&apos;t think this should sunk this current RC.&lt;/p&gt;</comment>
                            <comment id="13604500" author="yuzhihong@gmail.com" created="Sun, 17 Mar 2013 04:08:06 +0000"  >&lt;p&gt;Tests run: 1326, Failures: 0, Errors: 0, Skipped: 13&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; BUILD SUCCESS&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; ------------------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Total time: 1:04:23.845s&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Finished at: Sun Mar 17 02:34:38 UTC 2013&lt;/p&gt;</comment>
                            <comment id="13604502" author="yuzhihong@gmail.com" created="Sun, 17 Mar 2013 04:12:01 +0000"  >&lt;p&gt;Integrated to 0.94&lt;/p&gt;

&lt;p&gt;Thanks for the review, Lars.&lt;/p&gt;

&lt;p&gt;This is not needed for 0.95 or higher version.&lt;/p&gt;</comment>
                            <comment id="13604505" author="lhofhansl" created="Sun, 17 Mar 2013 04:22:10 +0000"  >&lt;p&gt;Thanks Ted.&lt;/p&gt;</comment>
                            <comment id="13604512" author="hudson" created="Sun, 17 Mar 2013 05:47:28 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #907 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/907/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/907/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8125&quot; title=&quot;HBASE-7435 breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8125&quot;&gt;&lt;del&gt;HBASE-8125&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7435&quot; title=&quot;BuiltInGzipDecompressor is only released during full GC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7435&quot;&gt;&lt;del&gt;HBASE-7435&lt;/del&gt;&lt;/a&gt; breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x (Ted Yu) (Revision 1457370)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13606165" author="hudson" created="Tue, 19 Mar 2013 08:24:54 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #127 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/127/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/127/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8125&quot; title=&quot;HBASE-7435 breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8125&quot;&gt;&lt;del&gt;HBASE-8125&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7435&quot; title=&quot;BuiltInGzipDecompressor is only released during full GC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7435&quot;&gt;&lt;del&gt;HBASE-7435&lt;/del&gt;&lt;/a&gt; breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x (Ted Yu) (Revision 1457370)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13606529" author="lhofhansl" created="Tue, 19 Mar 2013 17:13:44 +0000"  >&lt;p&gt;It looks like the issue I was fixing resurfaced (i.e. this fix did not work).&lt;/p&gt;</comment>
                            <comment id="13606539" author="lhofhansl" created="Tue, 19 Mar 2013 17:19:45 +0000"  >&lt;p&gt;With this patch TestHFileBlock takes up to 2.2g of resident heap, whereas without this patch it takes only 700mb.&lt;/p&gt;</comment>
                            <comment id="13606570" author="yuzhihong@gmail.com" created="Tue, 19 Mar 2013 17:39:48 +0000"  >&lt;p&gt;My knowledge about Annotation was not good enough.&lt;/p&gt;

&lt;p&gt;The addendum fixes the problem.&lt;/p&gt;</comment>
                            <comment id="13606593" author="lhofhansl" created="Tue, 19 Mar 2013 17:54:29 +0000"  >&lt;p&gt;I just came up with the same patch. Except for using getDeclaredAnnotations(), I do not think that is necessary.&lt;/p&gt;</comment>
                            <comment id="13606599" author="yuzhihong@gmail.com" created="Tue, 19 Mar 2013 17:58:57 +0000"  >&lt;p&gt;How about this addendum ?&lt;/p&gt;</comment>
                            <comment id="13606607" author="lhofhansl" created="Tue, 19 Mar 2013 18:03:50 +0000"  >&lt;p&gt;+1&lt;br/&gt;
Also verified that it works.&lt;/p&gt;</comment>
                            <comment id="13606609" author="yuzhihong@gmail.com" created="Tue, 19 Mar 2013 18:07:15 +0000"  >&lt;p&gt;Integrated addendum to 0.94&lt;/p&gt;

&lt;p&gt;Thanks for spotting the problem, Lars.&lt;/p&gt;</comment>
                            <comment id="13606611" author="lhofhansl" created="Tue, 19 Mar 2013 18:08:26 +0000"  >&lt;p&gt;Thanks Ted.&lt;/p&gt;</comment>
                            <comment id="13606801" author="hudson" created="Tue, 19 Mar 2013 21:01:13 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #915 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/915/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/915/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8125&quot; title=&quot;HBASE-7435 breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8125&quot;&gt;&lt;del&gt;HBASE-8125&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7435&quot; title=&quot;BuiltInGzipDecompressor is only released during full GC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7435&quot;&gt;&lt;del&gt;HBASE-7435&lt;/del&gt;&lt;/a&gt; breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x, real fix (Ted Yu) (Revision 1458439)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13606997" author="hudson" created="Tue, 19 Mar 2013 23:11:03 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #128 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/128/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/128/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8125&quot; title=&quot;HBASE-7435 breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8125&quot;&gt;&lt;del&gt;HBASE-8125&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7435&quot; title=&quot;BuiltInGzipDecompressor is only released during full GC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7435&quot;&gt;&lt;del&gt;HBASE-7435&lt;/del&gt;&lt;/a&gt; breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x, real fix (Ted Yu) (Revision 1458439)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13623194" author="hudson" created="Fri, 5 Apr 2013 01:00:57 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #13 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/13/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/13/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8125&quot; title=&quot;HBASE-7435 breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8125&quot;&gt;&lt;del&gt;HBASE-8125&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7435&quot; title=&quot;BuiltInGzipDecompressor is only released during full GC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7435&quot;&gt;&lt;del&gt;HBASE-7435&lt;/del&gt;&lt;/a&gt; breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x, real fix (Ted Yu) (Revision 1458439)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8125&quot; title=&quot;HBASE-7435 breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8125&quot;&gt;&lt;del&gt;HBASE-8125&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7435&quot; title=&quot;BuiltInGzipDecompressor is only released during full GC&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7435&quot;&gt;&lt;del&gt;HBASE-7435&lt;/del&gt;&lt;/a&gt; breaks BuiltInGzipDecompressor on Hadoop &amp;lt; 1.0.x (Ted Yu) (Revision 1457370)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12625207">HBASE-7435</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12574026" name="8125-0.94.txt" size="1559" author="yuzhihong@gmail.com" created="Sat, 16 Mar 2013 23:38:33 +0000"/>
                            <attachment id="12574373" name="8125.addendum" size="778" author="yuzhihong@gmail.com" created="Tue, 19 Mar 2013 17:58:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 16 Mar 2013 00:23:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>317792</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 37 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1iu2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>318133</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>