<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:58:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8770/HBASE-8770.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8770] deletes and puts with the same ts should be resolved according to mvcc/seqNum</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8770</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This came up during &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8721&quot; title=&quot;Deletes can mask puts that happen after the delete&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8721&quot;&gt;&lt;del&gt;HBASE-8721&lt;/del&gt;&lt;/a&gt;. Puts with the same ts are resolved by seqNum. It&apos;s not clear why deletes with the same ts as a put should always mask the put, rather than also being resolve by seqNum.&lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12653776">HBASE-8770</key>
            <summary>deletes and puts with the same ts should be resolved according to mvcc/seqNum</summary>
                <type id="13" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/genericissue.png">Brainstorming</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sershe">Sergey Shelukhin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Jun 2013 18:11:43 +0000</created>
                <updated>Mon, 6 Jun 2016 12:51:46 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>13</watches>
                                                                <comments>
                            <comment id="13688624" author="stack" created="Wed, 19 Jun 2013 23:20:38 +0000"  >&lt;p&gt;You raise a valid point.&lt;/p&gt;

&lt;p&gt;Our current implementation factors in kv type when comparing.  It shouldn&apos;t really.  To fix, we&apos;d have to have sequenceid in the kv.&lt;/p&gt;</comment>
                            <comment id="13688630" author="sershe" created="Wed, 19 Jun 2013 23:24:47 +0000"  >&lt;p&gt;Not really, we can compare them the same way as we do now, using file seqNum&lt;/p&gt;</comment>
                            <comment id="13815195" author="stack" created="Wed, 6 Nov 2013 19:34:38 +0000"  >&lt;p&gt;I believe that the Delete always sorting before the Put was an arbitrary choice way-back-when.  Yes, type should not be a factor and rather it should be sequenceid.  But then we&apos;d need to have a sequenceid in the key so that everywhere order was respected?&lt;/p&gt;</comment>
                            <comment id="13815214" author="sershe" created="Wed, 6 Nov 2013 19:53:23 +0000"  >&lt;p&gt;Between-file conflicts can be resolved using file seqids.&lt;br/&gt;
When we write one file (flush/compaction), we can write seqids only for conflicting keys (row+cf+q+ts). Should be relatively small load. We already have space for mvcc in KV and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; purports to merge mvcc and seqId. Or we can store it in tags.&lt;/p&gt;</comment>
                            <comment id="13815369" author="enis" created="Wed, 6 Nov 2013 22:17:12 +0000"  >&lt;p&gt;Linking &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9905&quot; title=&quot;Enable using seqId as timestamp &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9905&quot;&gt;HBASE-9905&lt;/a&gt;. We might as well do that instead of this. &lt;/p&gt;</comment>
                            <comment id="13815380" author="sershe" created="Wed, 6 Nov 2013 22:25:56 +0000"  >&lt;p&gt;There was another issue today where user does use equal TS (put ts 100m, put ts 200, del-version ts 200, then later put ts 200). &lt;br/&gt;
This would solve both problems... I think &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9905&quot; title=&quot;Enable using seqId as timestamp &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9905&quot;&gt;HBASE-9905&lt;/a&gt; we can also do&lt;/p&gt;</comment>
                            <comment id="13816224" author="stack" created="Thu, 7 Nov 2013 18:41:15 +0000"  >&lt;p&gt;Lets do this.&lt;/p&gt;</comment>
                            <comment id="13816227" author="stack" created="Thu, 7 Nov 2013 18:41:49 +0000"  >&lt;p&gt;It would be a change in behavior so should go in in a major version.&lt;/p&gt;</comment>
                            <comment id="13834317" author="apurtell" created="Wed, 27 Nov 2013 23:19:54 +0000"  >&lt;p&gt;No patch, unscheduling.&lt;/p&gt;</comment>
                            <comment id="14000525" author="lhofhansl" created="Fri, 16 May 2014 23:57:28 +0000"  >&lt;p&gt;This comes up about once/year &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Idempotent operations are an important feature of HBase. This would break this, so I am -0 on this approach.&lt;/p&gt;</comment>
                            <comment id="14000605" author="sershe" created="Sat, 17 May 2014 02:01:57 +0000"  >&lt;p&gt;What would it break?&lt;/p&gt;</comment>
                            <comment id="14000607" author="sershe" created="Sat, 17 May 2014 02:03:05 +0000"  >&lt;p&gt;...that is not already broken, I mean. retries can still create multiple records with different ts&lt;/p&gt;</comment>
                            <comment id="14001964" author="stack" created="Mon, 19 May 2014 16:40:47 +0000"  >&lt;p&gt;Fixing this makes sense to me.  Especially after unification of MVCC and seqid and if seqid lives on into hfiles &amp;#8211; if not per key, at least keep around a seqid on the file.  As is, the behavior &apos;surprises&apos;.  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-9905&quot; title=&quot;Enable using seqId as timestamp &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-9905&quot;&gt;HBASE-9905&lt;/a&gt; is something else.&lt;/p&gt;

&lt;p&gt;Fix seems &apos;simple&apos; enough, changing the order at which we evaluate Cell/KV elements in the comparator;  we&apos;d swap (or remove type consideration) with sequence id in the order in which we run the compare.&lt;/p&gt;</comment>
                            <comment id="14002685" author="enis" created="Tue, 20 May 2014 01:27:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;Fix seems &apos;simple&apos; enough, changing the order at which we evaluate Cell/KV elements in the comparator; we&apos;d swap (or remove type consideration) with sequence id in the order in which we run the compare.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;+1 to what Stack says. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12677877">HBASE-9905</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12976049">HBASE-15968</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12651914">HBASE-8721</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12653582">HBASE-8763</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 19 Jun 2013 23:20:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>334053</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 30 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1lmiv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>334379</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>