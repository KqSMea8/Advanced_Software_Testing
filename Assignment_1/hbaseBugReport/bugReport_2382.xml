<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:01:24 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2382/HBASE-2382.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2382] Don&apos;t rely on fs.getDefaultReplication() to roll HLogs</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2382</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;As I was commenting in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2234&quot; title=&quot;Roll Hlog if any datanode in the write pipeline dies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2234&quot;&gt;&lt;del&gt;HBASE-2234&lt;/del&gt;&lt;/a&gt;, using fs.getDefaultReplication() to roll HLogs if they lose replicas isn&apos;t reliable since that value is client-side and unless HBase is configured with it or has Hadoop&apos;s configurations on its classpath, it will do the wrong thing.&lt;/p&gt;

&lt;p&gt;Dhruba added:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can we use &amp;lt;hlogpath&amp;gt;.getFiletatus().getReplication() instead of fs.getDefaltReplication()? This will will ensure that we look at the repl factor of the precise file we are interested in, rather than what the system-wide default value is.&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12460377">HBASE-2382</key>
            <summary>Don&apos;t rely on fs.getDefaultReplication() to roll HLogs</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nspiegelberg">Nicolas Spiegelberg</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 Mar 2010 17:31:45 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:46 +0000</updated>
                            <resolved>Mon, 17 May 2010 21:17:26 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12850379" author="nspiegelberg" created="Fri, 26 Mar 2010 22:24:22 +0000"  >&lt;p&gt;Quick fix.  Ran &apos;ant -Dtestcase=TestLogRolling test&apos;, but I haven&apos;t setup a single instance cluster here.  I can set this up or you can verify it in your cluster.  I set the value for each writer so unit tests won&apos;t repeatedly roll when you have a 3-node cluster, you stop one datanode, and now your inital HLog replication is 2.&lt;/p&gt;</comment>
                            <comment id="12850396" author="jdcryans" created="Fri, 26 Mar 2010 23:07:53 +0000"  >&lt;p&gt;Looks like I was confused a bit by how replication is decided. So I tried the patch and it didn&apos;t work, but that&apos;s because HBase doesn&apos;t know what the configured default replication factor is on that HDFS cluster so it creates all the files with the default 3.&lt;/p&gt;

&lt;p&gt;@Dhruba, is there any way to interrogate HDFS for it&apos;s default replication factor?&lt;/p&gt;</comment>
                            <comment id="12851052" author="nspiegelberg" created="Mon, 29 Mar 2010 19:08:40 +0000"  >&lt;p&gt;After talking with Dhuba offline, we think the best strategy is to keep the replication responsibility on the client and add &apos;dfs.replication&apos; to the hbase config (or add a dfs-client config to hbase/conf) when needed.  In the general use case, multiple client programs could use the same HDFS cluster, and each client will usually have different replication requirements.  It&apos;s kinda na&#239;ve for an HDFS client to not be aware of it&apos;s cluster setup.  As a suggestion for clarity, maybe rename fs to fsClient so it&apos;s clear that we&apos;re directly communicating with our local client app and not the FS itself.&lt;/p&gt;</comment>
                            <comment id="12851128" author="dhruba" created="Mon, 29 Mar 2010 21:56:31 +0000"  >&lt;p&gt;+1 on the fix provided by Nicolas. JD: does it address your problem?&lt;/p&gt;</comment>
                            <comment id="12851147" author="jdcryans" created="Mon, 29 Mar 2010 22:55:16 +0000"  >&lt;p&gt;I understand that well configured HBase clusters will normally be aware of the configured HDFS replication factor. What I&apos;m afraid of is that new users don&apos;t understand that they must configure that on top of everything else and will complain about abysmal write speed since the HLog will be rolled for every edit until they figure that part of the configuration. &lt;/p&gt;

&lt;p&gt;My best case scenario would be that we handle it for the user.&lt;/p&gt;

&lt;p&gt;Else, an acceptable solution would be to ship HBase like Nicolas describes with dfs.replication (already set to 1?) then we need to be very explicit in the documentation about how to set this up for fully distributed operations. So, to close this jira, I think we need to add more documentation in src/java/overview.html along with the new configuration file.&lt;/p&gt;</comment>
                            <comment id="12851202" author="nspiegelberg" created="Tue, 30 Mar 2010 01:32:45 +0000"  >&lt;p&gt;Modified documentation to recommend setting dfs.replication when running Hbase in psuedo-distributed mode.  Feel free to reword as you see  fit.&lt;/p&gt;</comment>
                            <comment id="12851242" author="stack" created="Tue, 30 Mar 2010 04:28:56 +0000"  >&lt;p&gt;I committed Nicolas&apos;s patches to the branch w/ some extra commentary on what pseudo-distributed is and some cast at an explication of why one replica only when pseudo-distributed.  Thanks for the patch Nicolas.&lt;/p&gt;

&lt;p&gt;The attached file is Nicolas&apos;s work forward-ported only it can&apos;t be applied until we add in support for hdfs-862 to TRUNK too.  So, I&apos;ll edit this issue to only be for 0.21 going forward.  It can&apos;t go in until hbase-2306 goes in.&lt;/p&gt;</comment>
                            <comment id="12851243" author="stack" created="Tue, 30 Mar 2010 04:29:48 +0000"  >&lt;p&gt;Marking as dependent on hbase-2306&lt;/p&gt;</comment>
                            <comment id="12868409" author="stack" created="Mon, 17 May 2010 21:17:26 +0000"  >&lt;p&gt;HBase-2306 went in when we did this -&amp;gt; &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2544&quot; title=&quot;Forward port branch 0.20 WAL to TRUNK&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2544&quot;&gt;&lt;del&gt;HBASE-2544&lt;/del&gt;&lt;/a&gt;  Forward port branch 0.20 WAL to TRUNK&quot;.  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2544&quot; title=&quot;Forward port branch 0.20 WAL to TRUNK&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2544&quot;&gt;&lt;del&gt;HBASE-2544&lt;/del&gt;&lt;/a&gt; also added the bulk of this issue.  I then applied 2382-v5-TRUNK.patch which was edits to overview.html changes.  Resolving.&lt;/p&gt;</comment>
                            <comment id="12899481" author="jdcryans" created="Tue, 17 Aug 2010 17:24:31 +0000"  >&lt;p&gt;For the record, the situation I described happened this morning to some new-ish users. They ended up with a region server that had 133k HLogs, because they forgot to set dfs.replication=1. We need to come up with something friendlier,&lt;/p&gt;</comment>
                            <comment id="15017069" author="lars_francke" created="Fri, 20 Nov 2015 12:41:46 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12458672">HBASE-2306</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12440176" name="2382-v5-TRUNK.patch" size="5093" author="stack" created="Tue, 30 Mar 2010 04:28:56 +0000"/>
                            <attachment id="12439925" name="HBASE-2382-20.4.patch" size="1855" author="nspiegelberg" created="Fri, 26 Mar 2010 22:24:22 +0000"/>
                            <attachment id="12440164" name="HBASE-2382-documentation.patch" size="1774" author="nspiegelberg" created="Tue, 30 Mar 2010 01:32:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 26 Mar 2010 22:24:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32551</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hhi7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100098</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>