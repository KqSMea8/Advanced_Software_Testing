<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:53:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14442/HBASE-14442.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14442] MultiTableInputFormatBase.getSplits dosenot build split for a scan whose startRow=stopRow=(startRow of a region)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14442</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I created a Scan whose startRow and stopRow are the same with a region&apos;s startRow, then I found no map was built. &lt;br/&gt;
The following is the source code of this condtion:&lt;br/&gt;
(startRow.length == 0 || keys.getSecond()&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;.length == 0 ||&lt;br/&gt;
                    Bytes.compareTo(startRow, keys.getSecond()&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;) &amp;lt; 0) &amp;amp;&amp;amp;&lt;br/&gt;
                    (stopRow.length == 0 || Bytes.compareTo(stopRow,&lt;br/&gt;
                            keys.getFirst()&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;) &amp;gt; 0)&lt;/p&gt;

&lt;p&gt;I think  a &quot;=&quot; should be added.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12864464">HBASE-14442</key>
            <summary>MultiTableInputFormatBase.getSplits dosenot build split for a scan whose startRow=stopRow=(startRow of a region)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10004">Not A Bug</resolution>
                                        <assignee username="zhwy103">Nathan</assignee>
                                    <reporter username="zhwy103">Nathan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Sep 2015 06:28:02 +0000</created>
                <updated>Sat, 2 Jul 2016 06:26:28 +0000</updated>
                            <resolved>Sat, 2 Jul 2016 06:26:28 +0000</resolved>
                                    <version>1.1.2</version>
                                                    <component>mapreduce</component>
                        <due>Wed, 16 Sep 2015 00:00:00 +0000</due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <timeoriginalestimate seconds="1800">0.5h</timeoriginalestimate>
                            <timeestimate seconds="1800">0.5h</timeestimate>
                                        <comments>
                            <comment id="14790833" author="ndimiduk" created="Wed, 16 Sep 2015 18:09:08 +0000"  >&lt;p&gt;Hi Nathan, can you provide a unit test that demonstrates this bug? See &lt;a href=&quot;https://github.com/apache/hbase/blob/master/hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestMultiTableInputFormat.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hbase/blob/master/hbase-server/src/test/java/org/apache/hadoop/hbase/mapreduce/TestMultiTableInputFormat.java&lt;/a&gt; for existing tests.&lt;/p&gt;</comment>
                            <comment id="14875705" author="zhwy103" created="Fri, 18 Sep 2015 14:40:29 +0000"  >&lt;p&gt;Fine, I will learn and do that next week.&lt;/p&gt;</comment>
                            <comment id="14900513" author="zhwy103" created="Mon, 21 Sep 2015 11:14:39 +0000"  >&lt;p&gt;Can I just add a unit test in the TestMultiTableInputFormat.java for getSplit without start a MR job, like this:&lt;/p&gt;

&lt;p&gt;    @Test&lt;br/&gt;
    public void testScanA5ToA5Splits() throws IOException, InterruptedException, ClassNotFoundException {&lt;br/&gt;
        String start = &quot;aaaaa&quot;;&lt;br/&gt;
        String stop = &quot;aaaaa&quot;;&lt;br/&gt;
        String jobName = &quot;ScanA5ToA5Splits&quot;;&lt;br/&gt;
        Configuration c = new Configuration(TEST_UTIL.getConfiguration());&lt;/p&gt;

&lt;p&gt;        List&amp;lt;Scan&amp;gt; scans = new ArrayList&amp;lt;Scan&amp;gt;();&lt;br/&gt;
        for (String tableName : TABLES) {&lt;br/&gt;
            Scan scan = new Scan();&lt;/p&gt;

&lt;p&gt;            scan.addFamily(INPUT_FAMILY);&lt;br/&gt;
            scan.setAttribute(Scan.SCAN_ATTRIBUTES_TABLE_NAME, Bytes.toBytes(tableName));&lt;/p&gt;

&lt;p&gt;            if (start != null) &lt;/p&gt;
{
                scan.setStartRow(Bytes.toBytes(start));
            }
&lt;p&gt;            if (stop != null) &lt;/p&gt;
{
                scan.setStopRow(Bytes.toBytes(stop));
            }
&lt;p&gt;            scans.add(scan);&lt;/p&gt;

&lt;p&gt;            LOG.info(&quot;scan before: &quot; + scan);&lt;br/&gt;
        }&lt;br/&gt;
        Job job = new Job(c, jobName);&lt;/p&gt;

&lt;p&gt;        initJob(scans, job);&lt;br/&gt;
        job.setReducerClass(ScanReducer.class);&lt;br/&gt;
        job.setNumReduceTasks(1); // one to get final &quot;first&quot; and &quot;last&quot; key&lt;br/&gt;
        FileOutputFormat.setOutputPath(job, new Path(job.getJobName()));&lt;br/&gt;
        initJob(scans, job);&lt;br/&gt;
        MultiTableInputFormat format = new MultiTableInputFormat();&lt;/p&gt;

&lt;p&gt;        //as the startRow is equals stopRow (in the same region), the splits&apos; size should equal the scanList size&lt;br/&gt;
        Assert.assertEquals(format.getSplits(job).size(), scans.size());&lt;br/&gt;
    }&lt;/p&gt;</comment>
                            <comment id="14900940" author="ndimiduk" created="Mon, 21 Sep 2015 16:34:09 +0000"  >&lt;p&gt;It&apos;s good to test the result of getSplits, but probably an end-to-end test, something that verifies all the expected data is returned will help us maintain correctness in the long run.&lt;/p&gt;</comment>
                            <comment id="14904123" author="zhwy103" created="Wed, 23 Sep 2015 08:01:57 +0000"  >&lt;p&gt;Thanks Nick Dimiduk , I added a new pull request which includes a unit test, see &lt;a href=&quot;https://github.com/apache/hbase/pull/22&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hbase/pull/22&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14939855" author="ndimiduk" created="Thu, 1 Oct 2015 13:56:31 +0000"  >&lt;p&gt;Can you explain what you&apos;re trying to accomplish here? From the javadoc, &lt;tt&gt;setStartRow&lt;/tt&gt; is inclusive while &lt;tt&gt;setStopRow&lt;/tt&gt; is exclusive. If you want to read only one row, use a &lt;tt&gt;Get&lt;/tt&gt; or, as the doc says, append a &lt;tt&gt;0&lt;/tt&gt; to the stop row.&lt;/p&gt;

&lt;p&gt;Sorry to have made you do the work previously &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhwy103&quot; class=&quot;user-hover&quot; rel=&quot;zhwy103&quot;&gt;Nathan&lt;/a&gt;, but I think we should close this ticket as invalid.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Scan.html#setStartRow(byte[&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Scan.html#setStartRow(byte[&lt;/a&gt;])&lt;br/&gt;
&lt;a href=&quot;http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Scan.html#setStopRow(byte[&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Scan.html#setStopRow(byte[&lt;/a&gt;])&lt;/p&gt;</comment>
                            <comment id="14947997" author="zhwy103" created="Thu, 8 Oct 2015 02:56:30 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ndimiduk&quot; class=&quot;user-hover&quot; rel=&quot;ndimiduk&quot;&gt;Nick Dimiduk&lt;/a&gt;, I just thought  I cloud build  a scan with the same &lt;sup&gt;stopRow&lt;/sup&gt; and &lt;sup&gt;startRow&lt;/sup&gt;, as the &lt;b&gt;TableMapReduceUtil&lt;/b&gt; doesn&apos;t provide any interface for &lt;sup&gt;Get&lt;/sup&gt; or &lt;sup&gt;GetList&lt;/sup&gt;, then the &lt;sup&gt;Scan&lt;/sup&gt; API  provides a  constructor &lt;sup&gt;Scan(Get get)&lt;/sup&gt;, a method  &lt;sup&gt;isGetScan()&lt;/sup&gt;, also I find some description  in the sources &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Create a Scan operation for the range of rows specified.&lt;/li&gt;
	&lt;li&gt;@param startRow row to start scanner at or after (inclusive)&lt;/li&gt;
	&lt;li&gt;@param stopRow row to stop scanner before (exclusive)&lt;br/&gt;
   */&lt;br/&gt;
  public Scan(byte [] startRow, byte [] stopRow) {{&lt;br/&gt;
    this.startRow = startRow;&lt;br/&gt;
    this.stopRow = stopRow;&lt;br/&gt;
    //if the startRow and stopRow both are empty, it is not a Get&lt;br/&gt;
   &lt;b&gt;this.getScan = isStartRowAndEqualsStopRow();&lt;/b&gt;&lt;br/&gt;
  }}&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Scan.html#Scan(Get&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Scan.html#Scan(Get&lt;/a&gt; get)&lt;br/&gt;
&lt;a href=&quot;http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Scan.html#isGetScan&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Scan.html#isGetScan&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks, maybe appending a &lt;sup&gt;0&lt;/sup&gt; to the &lt;sup&gt;stopRow&lt;/sup&gt; can solve my problem.&lt;/p&gt;</comment>
                            <comment id="14950814" author="ndimiduk" created="Fri, 9 Oct 2015 17:24:26 +0000"  >&lt;p&gt;So you&apos;re able to use the &lt;tt&gt;Scan(Get)&lt;/tt&gt; constructor? That&apos;s working for you? How can we make this more clear? Any docs you&apos;d like to see worded differently? Let me know, we&apos;ll get a docs patch in.&lt;/p&gt;</comment>
                            <comment id="14951543" author="zhwy103" created="Sat, 10 Oct 2015 03:03:42 +0000"  >&lt;p&gt;Before, I want to explain that we can use a &lt;sup&gt;Scan&lt;/sup&gt; to read only one row as a special case, docs are all right. Both contructors &lt;sup&gt;Scan(Get)&lt;/sup&gt; and &lt;sup&gt;Scan(byte[], byte[])&lt;/sup&gt; can be used to read read only row as a &lt;sup&gt;GetScan&lt;/sup&gt;, it&#8216;s working.&lt;br/&gt;
I mean that &lt;b&gt;MultiTableInputFormatBase.getSplits&lt;/b&gt; does not contain this case yet.&lt;br/&gt;
The problem is: &lt;b&gt;if the only row that we read by &lt;sup&gt;Scan&lt;/sup&gt; equals a region&apos;s edge row of &lt;sup&gt;HTable&lt;/sup&gt;, we use TableMapReduceUtil.initTableMapperJob(List&amp;lt;Scan&amp;gt; scans......) to  run a job, no &lt;sup&gt;Split&lt;/sup&gt; (so no &lt;sup&gt;Map&lt;/sup&gt;) is built for this &lt;sup&gt;Scan&lt;/sup&gt;.&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="15065972" author="busbey" created="Mon, 21 Dec 2015 01:30:07 +0000"  >&lt;p&gt;is this still an issue?&lt;/p&gt;</comment>
                            <comment id="15203700" author="busbey" created="Mon, 21 Mar 2016 04:45:20 +0000"  >&lt;p&gt;is this still active? if not, I&apos;d like to close it as stale.&lt;/p&gt;</comment>
                            <comment id="15251466" author="zhwy103" created="Thu, 21 Apr 2016 07:24:45 +0000"  >&lt;p&gt;It is not a problem any more, please close it as stale, thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Sep 2015 18:09:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            34 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2k8hr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>