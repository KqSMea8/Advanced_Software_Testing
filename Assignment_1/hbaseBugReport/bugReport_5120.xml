<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:24:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5120/HBASE-5120.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5120] Timeout monitor races with table disable handler</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5120</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Here is what J-D described here:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5119?focusedCommentId=13179176&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13179176&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-5119?focusedCommentId=13179176&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13179176&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think I will retract from my statement that it &quot;used to be extremely racy and caused more troubles than it fixed&quot;, on my first test I got a stuck region in transition instead of being able to recover. The timeout was set to 2 minutes to be sure I hit it.&lt;/p&gt;

&lt;p&gt;First the region gets closed&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;2012-01-04 00:16:25,811 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Sent CLOSE to sv4r5s38,62023,1325635980913 for region test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;2 minutes later it times out:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2012-01-04 00:18:30,026 INFO org.apache.hadoop.hbase.master.AssignmentManager: Regions in transition timed out:  test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791. state=PENDING_CLOSE, ts=1325636185810, server=null&lt;br/&gt;
2012-01-04 00:18:30,026 INFO org.apache.hadoop.hbase.master.AssignmentManager: Region has been PENDING_CLOSE for too long, running forced unassign again on region=test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791.&lt;br/&gt;
2012-01-04 00:18:30,027 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791. (offlining)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;100ms later the master finally gets the event:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2012-01-04 00:18:30,129 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=RS_ZK_REGION_CLOSED, server=sv4r5s38,62023,1325635980913, region=1a4b111bcc228043e89f59c4c3f6a791, which is more than 15 seconds late&lt;br/&gt;
2012-01-04 00:18:30,129 DEBUG org.apache.hadoop.hbase.master.handler.ClosedRegionHandler: Handling CLOSED event for 1a4b111bcc228043e89f59c4c3f6a791&lt;br/&gt;
2012-01-04 00:18:30,129 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Table being disabled so deleting ZK node and removing from regions in transition, skipping assignment of region test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791.&lt;br/&gt;
2012-01-04 00:18:30,129 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db03587 Deleting existing unassigned node for 1a4b111bcc228043e89f59c4c3f6a791 that is in expected state RS_ZK_REGION_CLOSED&lt;br/&gt;
2012-01-04 00:18:30,166 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db03587 Successfully deleted unassigned node for region 1a4b111bcc228043e89f59c4c3f6a791 in expected state RS_ZK_REGION_CLOSED&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;At this point everything is fine, the region was processed as closed. But wait, remember that line where it said it was going to force an unassign?&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2012-01-04 00:18:30,322 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db03587 Creating unassigned node for 1a4b111bcc228043e89f59c4c3f6a791 in a CLOSING state&lt;br/&gt;
2012-01-04 00:18:30,328 INFO org.apache.hadoop.hbase.master.AssignmentManager: Server null returned java.lang.NullPointerException: Passed server is null for 1a4b111bcc228043e89f59c4c3f6a791&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Now the master is confused, it recreated the RIT znode but the region doesn&apos;t even exist anymore. It even tries to shut it down but is blocked by NPEs. Now this is what&apos;s going on.&lt;/p&gt;

&lt;p&gt;The late ZK notification that the znode was deleted (but it got recreated after):&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2012-01-04 00:19:33,285 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: The znode of region test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791. has been deleted.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Then it prints this, and much later tries to unassign it again:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2012-01-04 00:19:46,607 DEBUG org.apache.hadoop.hbase.master.handler.DeleteTableHandler: Waiting on  region to clear regions in transition; test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791. state=PENDING_CLOSE, ts=1325636310328, server=null&lt;br/&gt;
...&lt;br/&gt;
2012-01-04 00:20:39,623 DEBUG org.apache.hadoop.hbase.master.handler.DeleteTableHandler: Waiting on  region to clear regions in transition; test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791. state=PENDING_CLOSE, ts=1325636310328, server=null&lt;br/&gt;
2012-01-04 00:20:39,864 INFO org.apache.hadoop.hbase.master.AssignmentManager: Regions in transition timed out:  test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791. state=PENDING_CLOSE, ts=1325636310328, server=null&lt;br/&gt;
2012-01-04 00:20:39,864 INFO org.apache.hadoop.hbase.master.AssignmentManager: Region has been PENDING_CLOSE for too long, running forced unassign again on region=test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791.&lt;br/&gt;
2012-01-04 00:20:39,865 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791. (offlining)&lt;br/&gt;
2012-01-04 00:20:39,865 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Attempted to unassign region test1,089cd0c9,1325635015491.1a4b111bcc228043e89f59c4c3f6a791. but it is not currently assigned anywhere&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;And this is still ongoing.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12537133">HBASE-5120</key>
            <summary>Timeout monitor races with table disable handler</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ram_krish">ramkrishna.s.vasudevan</assignee>
                                    <reporter username="zhihyu@ebaysf.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Jan 2012 02:45:33 +0000</created>
                <updated>Fri, 12 Oct 2012 05:34:53 +0000</updated>
                            <resolved>Tue, 28 Feb 2012 17:39:52 +0000</resolved>
                                    <version>0.92.0</version>
                                    <fixVersion>0.94.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13179243" author="zhihyu@ebaysf.com" created="Wed, 4 Jan 2012 02:55:57 +0000"  >&lt;p&gt;J-D ended up issuing &apos;kill -9&apos; to the master.&lt;/p&gt;</comment>
                            <comment id="13179263" author="lhofhansl" created="Wed, 4 Jan 2012 04:19:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5119&quot; title=&quot;Set the TimeoutMonitor&amp;#39;s timeout back down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5119&quot;&gt;&lt;del&gt;HBASE-5119&lt;/del&gt;&lt;/a&gt; is almost identical.&lt;/p&gt;</comment>
                            <comment id="13179265" author="zhihyu@ebaysf.com" created="Wed, 4 Jan 2012 04:33:16 +0000"  >&lt;p&gt;I followed J-D&apos;s suggestion of keeping the original description for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5119&quot; title=&quot;Set the TimeoutMonitor&amp;#39;s timeout back down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5119&quot;&gt;&lt;del&gt;HBASE-5119&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
The plan is once this bug is fixed, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5119&quot; title=&quot;Set the TimeoutMonitor&amp;#39;s timeout back down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5119&quot;&gt;&lt;del&gt;HBASE-5119&lt;/del&gt;&lt;/a&gt; would lower default timeout.&lt;/p&gt;</comment>
                            <comment id="13179278" author="ram_krish" created="Wed, 4 Jan 2012 05:19:11 +0000"  >&lt;p&gt;I will take a look at this issue.  &lt;/p&gt;</comment>
                            <comment id="13179321" author="lhofhansl" created="Wed, 4 Jan 2012 07:03:36 +0000"  >&lt;p&gt;I see, thanks Ted.&lt;br/&gt;
Ram, you&apos;re are becoming the assignment/split/race-condition expert... &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13179633" author="ram_krish" created="Wed, 4 Jan 2012 16:53:43 +0000"  >&lt;p&gt;Attaching the patch so that i can access it at home.  First cut versiion and not fully tested.&lt;/p&gt;</comment>
                            <comment id="13179660" author="lhofhansl" created="Wed, 4 Jan 2012 17:16:40 +0000"  >&lt;p&gt;Hey Ram, I know you said this is not done, yet...&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (t &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; NullPointerException) {
  removeRegionInTransition(region);
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Could we instead add a null check at the relevant point and deal with it there (or maybe throw another exception)? (Dealing with this after the NPE occurred leaves a bad taste... What if we introduce another bug later that also causes an NPE? That would go unnoticed for a while.)&lt;/p&gt;</comment>
                            <comment id="13179662" author="zhihyu@ebaysf.com" created="Wed, 4 Jan 2012 17:19:36 +0000"  >&lt;p&gt;Thanks for the quick turnaround.&lt;/p&gt;

&lt;p&gt;The patch depends on NullPointerException to detect problematic region.&lt;br/&gt;
I think we should use more protective measure as Lars commented.&lt;br/&gt;
The patch specifies M_ZK_REGION_CLOSING for ZKAssign.deleteNode(). This narrows the applicability of the NPE handling.&lt;/p&gt;</comment>
                            <comment id="13179725" author="ram_krish" created="Wed, 4 Jan 2012 18:26:08 +0000"  >&lt;p&gt;@Lars and @Ted&lt;br/&gt;
Thanks for your reviews.&lt;br/&gt;
I was also not convinced in adding the instanceof check for NPE.  It does not look good.&lt;br/&gt;
I was trying at other option of not calling sendRegionClose if the server is null.&lt;br/&gt;
Also remove the RIT if anything has been added.  But need to verify some more scenarios. Not sure if i can dedicate time tomorrow as we have some internal workshop.  I will work on this and give my patch sooner. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13179938" author="stack" created="Wed, 4 Jan 2012 22:22:13 +0000"  >&lt;p&gt;When would it ever make sense that TimeoutMonitor ask a regionserver RE-close a region?  It implies that somehow the regionserver &apos;forgot&apos; to do the close or that it dropped the message.  If either happened, we have bigger problems and having the TM do a new close will only make it worse (If a RS &apos;forgot&apos; or &apos;failed&apos; a close, its probably on its way out and its ephemeral node is about to vanish and master shutdown handler will do the close fixups; if it does not work this way, we should make it so?).&lt;/p&gt;

&lt;p&gt;TM might make some sense for region openings but even here, I&apos;d think the above applies; i.e. if a RS can&apos;t open a region, it should kill itself. If the region is bad, its unlikely any RS will open it unless the error transient.  For this latter case the TM running every 30 minutes, while conservative, is probably fine for a default.&lt;/p&gt;

&lt;p&gt;I think we should leave the TM at its current 30 minute timeout and undo this issue as critical against 0.92.&lt;/p&gt;

&lt;p&gt;There are outstanding race conditions in hbase around shutdown handler and master operations that deserve more attention that this IMO.&lt;/p&gt;</comment>
                            <comment id="13179940" author="stack" created="Wed, 4 Jan 2012 22:26:04 +0000"  >&lt;p&gt;On the patch, Ram, should we even try unassign if server in this.regions is null; i.e. we should fail way earlier?&lt;/p&gt;

&lt;p&gt;IMO, this AM needs a rewrite if only to make its various transitions testable.  There are also too many methods doing similar things with lots of overlap; its really hard to figure whats going on.&lt;/p&gt;</comment>
                            <comment id="13180231" author="ram_krish" created="Thu, 5 Jan 2012 07:08:59 +0000"  >&lt;p&gt;@Stack&lt;br/&gt;
Yes if the server in this.regions is null we should not go with unassign at all.  &lt;br/&gt;
But there is one more condition where the RIT was getting a null server destination.&lt;br/&gt;
That is what i wanted to address.  This patch is not final as i wanted to test some conditions with this. &lt;/p&gt;

&lt;p&gt;About rewrite AM is also what we thought after TimeoutMonitor refactor as adding testcase was difficult.&lt;/p&gt;</comment>
                            <comment id="13180560" author="stack" created="Thu, 5 Jan 2012 17:23:27 +0000"  >&lt;p&gt;@Ram Is odd that server is null; this should be &apos;impossible&apos;, right?&lt;/p&gt;</comment>
                            <comment id="13180622" author="ram_krish" created="Thu, 5 Jan 2012 17:50:28 +0000"  >&lt;p&gt;@Stack&lt;br/&gt;
Yes Stack it is impossible.  But still we need to remove the region from RIT and also delete the node CLOSING node if one was created.&lt;br/&gt;
By tomorrow i can submit the patch after testing.&lt;br/&gt;
If you have some idea you can suggest. Also correct me if am wrong.&lt;/p&gt;
</comment>
                            <comment id="13182560" author="ram_krish" created="Mon, 9 Jan 2012 15:33:00 +0000"  >&lt;p&gt;Patch addresses the issue.  But does not make the code cleaner as Stack wanted it to be. &lt;br/&gt;
@Stack &lt;br/&gt;
We may need to make the TM and unassign flow lighter. This patch addresses the problem in this JIRA.&lt;/p&gt;</comment>
                            <comment id="13182609" author="hadoopqa" created="Mon, 9 Jan 2012 16:32:19 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12509921/HBASE-5120_1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12509921/HBASE-5120_1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -151 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 80 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/708//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/708//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/708//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/708//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/708//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/708//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13182673" author="zhihyu@ebaysf.com" created="Mon, 9 Jan 2012 18:04:50 +0000"  >&lt;p&gt;I see different exception handling w.r.t. KeeperException in the changes.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (KeeperException e) {
+        LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;CLOSING node &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region &quot;&lt;/span&gt; + region.getEncodedName()
+            + &lt;span class=&quot;code-quote&quot;&gt;&quot; already deleted&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can you explain why ?&lt;/p&gt;

&lt;p&gt;For the new method, deleteClosingOrClosedNode(), I think it should utilize return value from ZKAssign.deleteNode()&lt;br/&gt;
Meaning, deleteClosingOrClosedNode() should return a boolean.&lt;/p&gt;</comment>
                            <comment id="13182968" author="stack" created="Tue, 10 Jan 2012 00:56:08 +0000"  >&lt;p&gt;Convention is to flip this so server == null rather than null == server:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; == server) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ditto further down in the code.&lt;/p&gt;

&lt;p&gt;Regards server == null, how would this arise?  I&apos;m not clear on how we&apos;d have a null server and still have a region in this.regions.  If there is a legit circumstance, then this patch I can see going in &amp;#8211; though it does not address the core issue of our not working properly when concurrent actors, in this case the TM and a disable (I still think TM should be turned way down or off altogether).&lt;/p&gt;</comment>
                            <comment id="13183073" author="ram_krish" created="Tue, 10 Jan 2012 04:47:18 +0000"  >&lt;blockquote&gt;&lt;p&gt;Regards server == null, how would this arise?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This will come when the ClosedRegionHandler does &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
assignmentManager.offlineDisabledRegion(regionInfo);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 
&lt;p&gt;inside which we do &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
regionOffline(regionInfo);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setOffline(HRegionInfo regionInfo) {
    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions) {
      ServerName sn = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions.remove(regionInfo);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is where we get a null Servername.&lt;br/&gt;
Now coming to the case where the server is null but we have an entry in RIT. When the closedRegionHandler is not yet done, by the time TM kicks in and starts another unassign then there is a condition where the RIT is made null by the ClosedRegionHandler and by the time the forceful unassign again adds the RIT in pending_close&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (regionsInTransition) {
      state = regionsInTransition.get(encodedName);
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (state == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
.....
        state = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RegionState(region, RegionState.State.PENDING_CLOSE);
        regionsInTransition.put(encodedName, state);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;One more condition is when balancer happens and a region about to get assigned by ClosedRegionHandler&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    assignmentManager.setOffline(regionInfo);
    assignmentManager.removeClosedRegion(regionInfo);
    assignmentManager.assign(regionInfo, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In this case the this.regions can have a null server but as per the patch we dont remove from the RIT because we check for PENDING_CLOSE or CLOSING state. In case of balancer the state of RIT is CLOSED.&lt;/p&gt;

&lt;p&gt;This patch addresses the scenario where TM and closedRegionHandler coming thro Disable flow and also balancer flow. Pls provide your comments.&lt;/p&gt;</comment>
                            <comment id="13183074" author="ram_krish" created="Tue, 10 Jan 2012 04:51:10 +0000"  >&lt;p&gt;@Ted&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (KeeperException e) {

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;On getting KeeperException we need to abort but not on NoNodeException. I missed this in the recent patch. But i don&apos;t find the use of the return value in this case.  That is why it was not used. May be if we get a false we can only log the message. But ideally as per the analysis the node can be in CLOSING state or CLOSED state only.&lt;/p&gt;</comment>
                            <comment id="13183080" author="zhihyu@ebaysf.com" created="Tue, 10 Jan 2012 05:08:35 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        ZKAssign.deleteNode(master.getZooKeeper(), region.getEncodedName(),
+            EventHandler.EventType.RS_ZK_REGION_CLOSED);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If the above call returns false (without exception), I think we should abort.&lt;/p&gt;</comment>
                            <comment id="13183206" author="ram_krish" created="Tue, 10 Jan 2012 12:04:23 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
I feel abort is not needed. I cannot see a place where the znode can be in another state.  Also if we do that if the znode is changed in the assign flow we still go with the deletion and will abort the master if deletion fails.&lt;/p&gt;

&lt;p&gt;Just my thought. &lt;/p&gt;</comment>
                            <comment id="13183214" author="hadoopqa" created="Tue, 10 Jan 2012 12:35:40 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12510034/HBASE-5120_2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12510034/HBASE-5120_2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -151 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 80 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/716//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/716//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/716//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/716//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/716//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/716//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13183319" author="zhihyu@ebaysf.com" created="Tue, 10 Jan 2012 15:13:24 +0000"  >&lt;p&gt;I think deleteClosingOrClosedNode() should catch KeeperException and abort, considering that code appears twice in the patch.&lt;/p&gt;

&lt;p&gt;There is no checking in deleteClosingOrClosedNode() on the return value for the second call to ZKAssign.deleteNode(). At least we should log the return value.&lt;br/&gt;
There might be more corner cases that we discover in the future.&lt;/p&gt;

&lt;p&gt;Good job.&lt;/p&gt;</comment>
                            <comment id="13183337" author="ram_krish" created="Tue, 10 Jan 2012 15:35:37 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
Thanks for your review. I have updated the patch.&lt;/p&gt;</comment>
                            <comment id="13183355" author="hadoopqa" created="Tue, 10 Jan 2012 16:17:01 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12510054/HBASE-5120_3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12510054/HBASE-5120_3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -151 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 80 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.wal.TestLogRolling&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/718//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/718//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/718//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/718//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/718//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/718//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13183380" author="zhihyu@ebaysf.com" created="Tue, 10 Jan 2012 17:06:39 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;The deletion of the CLOSED node returned &quot;&lt;/span&gt; + deleteNode);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think the above should be at ERROR level. Also, please log the region name.&lt;/p&gt;</comment>
                            <comment id="13183434" author="ram_krish" created="Tue, 10 Jan 2012 18:06:09 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
Ok.  I will make a patch.  Before making the next patch will wait for others comments.&lt;br/&gt;
@Stack&lt;br/&gt;
Any Comments ?&lt;/p&gt;</comment>
                            <comment id="13183989" author="hadoopqa" created="Wed, 11 Jan 2012 10:56:31 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12510165/HBASE-5120_4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12510165/HBASE-5120_4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -147 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 79 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestLruBlockCache&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/726//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/726//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/726//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/726//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/726//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/726//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13184203" author="ram_krish" created="Wed, 11 Jan 2012 17:12:48 +0000"  >&lt;p&gt;Latest patch available.. &lt;/p&gt;</comment>
                            <comment id="13184205" author="zhihyu@ebaysf.com" created="Wed, 11 Jan 2012 17:17:10 +0000"  >&lt;p&gt;Can you change LOG.debug() to LOG.error() in deleteClosingOrClosedNode() ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;The deletion of the CLOSED node &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region &quot;&lt;/span&gt;
+            + region.getEncodedName() + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + deleteNode);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13184225" author="ram_krish" created="Wed, 11 Jan 2012 17:44:19 +0000"  >&lt;p&gt;Changed debug to error.&lt;/p&gt;</comment>
                            <comment id="13184251" author="zhihyu@ebaysf.com" created="Wed, 11 Jan 2012 18:16:54 +0000"  >&lt;p&gt;+1 on patch v5.&lt;/p&gt;</comment>
                            <comment id="13184258" author="hadoopqa" created="Wed, 11 Jan 2012 18:27:30 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12510211/HBASE-5120_5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12510211/HBASE-5120_5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -147 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 79 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapreduce.TestImportTsv&lt;br/&gt;
                  org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/731//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/731//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/731//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/731//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/731//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/731//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13185140" author="lhofhansl" created="Thu, 12 Jan 2012 18:55:57 +0000"  >&lt;p&gt;+1 on v5&lt;/p&gt;

&lt;p&gt;Nit: this is a bit weird&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!ZKAssign.deleteNode(master.getZooKeeper(), region.getEncodedName(),
+          EventHandler.EventType.M_ZK_REGION_CLOSING)) {
+        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; deleteNode = ZKAssign.deleteNode(master.getZooKeeper(), region
+            .getEncodedName(), EventHandler.EventType.RS_ZK_REGION_CLOSED);
+        &lt;span class=&quot;code-comment&quot;&gt;// TODO : We don&apos;t abort &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the delete node returns &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;. Is there any
&lt;/span&gt;+        &lt;span class=&quot;code-comment&quot;&gt;// such corner &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;?
&lt;/span&gt;+        LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;The deletion of the CLOSED node &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region &quot;&lt;/span&gt;
+            + region.getEncodedName() + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + deleteNode);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;why not&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; deleteNode = ZKAssign.deleteNode(master.getZooKeeper(), region
+            .getEncodedName(), EventHandler.EventType.RS_ZK_REGION_CLOSED);
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!deleteNode) {
+        &lt;span class=&quot;code-comment&quot;&gt;// TODO : We don&apos;t abort &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the delete node returns &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;. Is there any
&lt;/span&gt;+        &lt;span class=&quot;code-comment&quot;&gt;// such corner &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;?
&lt;/span&gt;+        LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;The deletion of the CLOSED node &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region &quot;&lt;/span&gt;
+            + region.getEncodedName() + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + deleteNode);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13185369" author="jdcryans" created="Fri, 13 Jan 2012 01:16:43 +0000"  >&lt;p&gt;Testing the patch with a low timeout, I can answer the question in the code that asks &quot;We don&apos;t abort if the delete node returns false. Is there any such corner case?&quot; and yes here it is:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-01-13 00:53:39,053 INFO org.apache.hadoop.hbase.master.AssignmentManager: Regions in transition timed out:  TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a. state=PENDING_CLOSE, ts=1326415997208, server=null
2012-01-13 00:53:39,053 INFO org.apache.hadoop.hbase.master.AssignmentManager: Region has been PENDING_CLOSE for too long, running forced unassign again on region=TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a.
2012-01-13 00:53:39,053 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a. (offlining)
2012-01-13 00:53:39,254 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Attempting to unassign region TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a. which is already PENDING_CLOSE but forcing to send a CLOSE RPC again 
2012-01-13 00:53:39,255 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: update TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a. state=PENDING_CLOSE, ts=1326416019254, server=null the timestamp.
2012-01-13 00:53:39,256 INFO org.apache.hadoop.hbase.master.AssignmentManager: Server sv4r12s38,62023,1326415651391 returned org.apache.hadoop.hbase.regionserver.RegionAlreadyInTransitionException: org.apache.hadoop.hbase.regionserver.RegionAlreadyInTransitionException: Received:CLOSE for the region:TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a. ,which we are already trying to CLOSE. for 0784c045e00205949461cb21b8f4cd6a
2012-01-13 00:54:09,051 INFO org.apache.hadoop.hbase.master.AssignmentManager: Regions in transition timed out:  TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a. state=PENDING_CLOSE, ts=1326416019256, server=null
2012-01-13 00:54:09,051 INFO org.apache.hadoop.hbase.master.AssignmentManager: Region has been PENDING_CLOSE for too long, running forced unassign again on region=TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a.
2012-01-13 00:54:09,051 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a. (offlining)
2012-01-13 00:54:09,126 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Attempting to unassign region TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a. which is already PENDING_CLOSE but forcing to send a CLOSE RPC again 
2012-01-13 00:54:09,127 INFO org.apache.hadoop.hbase.master.AssignmentManager: While trying to recover the table TestTable to DISABLED state the region {NAME =&amp;gt; &apos;TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a.&apos;, STARTKEY =&amp;gt; &apos;0006605550&apos;, ENDKEY =&amp;gt; &apos;0006616035&apos;, ENCODED =&amp;gt; 0784c045e00205949461cb21b8f4cd6a,} was offlined but the table was in DISABLING state
2012-01-13 00:54:09,127 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db06d62 Deleting existing unassigned node for 0784c045e00205949461cb21b8f4cd6a that is in expected state M_ZK_REGION_CLOSING
2012-01-13 00:54:09,128 WARN org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db06d62 Attempting to delete unassigned node 0784c045e00205949461cb21b8f4cd6a in M_ZK_REGION_CLOSING state but node is in RS_ZK_REGION_CLOSED state
2012-01-13 00:54:09,128 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db06d62 Deleting existing unassigned node for 0784c045e00205949461cb21b8f4cd6a that is in expected state RS_ZK_REGION_CLOSED
2012-01-13 00:54:09,140 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=RS_ZK_REGION_CLOSED, server=sv4r12s38,62023,1326415651391, region=0784c045e00205949461cb21b8f4cd6a
2012-01-13 00:54:09,140 WARN org.apache.hadoop.hbase.master.AssignmentManager: Received CLOSED for region 0784c045e00205949461cb21b8f4cd6a from server sv4r12s38,62023,1326415651391 but region was in  the state null and not in expected PENDING_CLOSE or CLOSING states
2012-01-13 00:54:09,148 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db06d62 Successfully deleted unassigned node for region 0784c045e00205949461cb21b8f4cd6a in expected state RS_ZK_REGION_CLOSED
2012-01-13 00:54:09,148 ERROR org.apache.hadoop.hbase.master.AssignmentManager: The deletion of the CLOSED node for the region 0784c045e00205949461cb21b8f4cd6a returned true
2012-01-13 00:54:09,148 INFO org.apache.hadoop.hbase.master.AssignmentManager: Server sv4r12s38,62023,1326415651391 returned org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Received close for TestTable,0006605550,1326415764458.0784c045e00205949461cb21b8f4cd6a. but we are not serving it for 0784c045e00205949461cb21b8f4cd6a
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I turned out ok even if I had 7 regions that did that.&lt;/p&gt;

&lt;p&gt;I also got the &quot;CLOSING/CLOSED node for the region x already deleted&quot; message, here&apos;s the context:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-01-13 00:53:39,144 INFO org.apache.hadoop.hbase.master.AssignmentManager: Regions in transition timed out:  TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48. state=PENDING_CLOSE, ts=1326415995575, server=null
2012-01-13 00:53:39,144 INFO org.apache.hadoop.hbase.master.AssignmentManager: Region has been PENDING_CLOSE for too long, running forced unassign again on region=TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48.
2012-01-13 00:53:39,145 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48. (offlining)
2012-01-13 00:53:39,152 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Attempting to unassign region TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48. which is already PENDING_CLOSE but forcing to send a CLOSE RPC again 
2012-01-13 00:53:39,169 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: update TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48. state=PENDING_CLOSE, ts=1326416019152, server=null the timestamp.
2012-01-13 00:53:39,172 INFO org.apache.hadoop.hbase.master.AssignmentManager: Server sv4r27s44,62023,1326415651133 returned org.apache.hadoop.hbase.regionserver.RegionAlreadyInTransitionException: org.apache.hadoop.hbase.regionserver.RegionAlreadyInTransitionException: Received:CLOSE for the region:TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48. ,which we are already trying to CLOSE. for f6c862f9c16b15b9227c2ed46865fb48
2012-01-13 00:54:09,070 INFO org.apache.hadoop.hbase.master.AssignmentManager: Regions in transition timed out:  TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48. state=PENDING_CLOSE, ts=1326416019172, server=null
2012-01-13 00:54:09,070 INFO org.apache.hadoop.hbase.master.AssignmentManager: Region has been PENDING_CLOSE for too long, running forced unassign again on region=TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48.
2012-01-13 00:54:09,070 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48. (offlining)
2012-01-13 00:54:09,076 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Attempting to unassign region TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48. which is already PENDING_CLOSE but forcing to send a CLOSE RPC again 
2012-01-13 00:54:09,091 INFO org.apache.hadoop.hbase.master.AssignmentManager: While trying to recover the table TestTable to DISABLED state the region {NAME =&amp;gt; &apos;TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48.&apos;, STARTKEY =&amp;gt; &apos;0004613400&apos;, ENDKEY =&amp;gt; &apos;0004623885&apos;, ENCODED =&amp;gt; f6c862f9c16b15b9227c2ed46865fb48,} was offlined but the table was in DISABLING state
2012-01-13 00:54:09,106 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Handling transition=RS_ZK_REGION_CLOSED, server=sv4r27s44,62023,1326415651133, region=f6c862f9c16b15b9227c2ed46865fb48
2012-01-13 00:54:09,106 DEBUG org.apache.hadoop.hbase.master.handler.ClosedRegionHandler: Handling CLOSED event for f6c862f9c16b15b9227c2ed46865fb48
2012-01-13 00:54:09,106 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Table being disabled so deleting ZK node and removing from regions in transition, skipping assignment of region TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48.
2012-01-13 00:54:09,106 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db06d62 Deleting existing unassigned node for f6c862f9c16b15b9227c2ed46865fb48 that is in expected state RS_ZK_REGION_CLOSED
2012-01-13 00:54:09,115 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db06d62 Successfully deleted unassigned node for region f6c862f9c16b15b9227c2ed46865fb48 in expected state RS_ZK_REGION_CLOSED
2012-01-13 00:54:09,127 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: master:62003-0x134589d3db06d62 Deleting existing unassigned node for f6c862f9c16b15b9227c2ed46865fb48 that is in expected state M_ZK_REGION_CLOSING
2012-01-13 00:54:09,128 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: CLOSING/CLOSED node for the region f6c862f9c16b15b9227c2ed46865fb48 already deleted
2012-01-13 00:54:09,128 INFO org.apache.hadoop.hbase.master.AssignmentManager: Server sv4r27s44,62023,1326415651133 returned org.apache.hadoop.hbase.NotServingRegionException: org.apache.hadoop.hbase.NotServingRegionException: Received close for TestTable,0004613400,1326415764450.f6c862f9c16b15b9227c2ed46865fb48. but we are not serving it for f6c862f9c16b15b9227c2ed46865fb48
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Again it turned out fine.&lt;/p&gt;

&lt;p&gt;I&apos;m +1 after fixing the comment about the corner case.&lt;/p&gt;</comment>
                            <comment id="13185424" author="ram_krish" created="Fri, 13 Jan 2012 04:16:51 +0000"  >&lt;p&gt;@J-D&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; deleteNode = ZKAssign.deleteNode(master.getZooKeeper(), region
            .getEncodedName(), EventHandler.EventType.RS_ZK_REGION_CLOSED);
        &lt;span class=&quot;code-comment&quot;&gt;// TODO : We don&apos;t abort &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the delete node returns &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;. Is there any
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// such corner &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;?
&lt;/span&gt;        LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;The deletion of the CLOSED node &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region &quot;&lt;/span&gt;
            + region.getEncodedName() + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + deleteNode);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This piece of code should have been &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!deleteNode) {
          LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;The deletion of the CLOSED node &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the region &quot;&lt;/span&gt;
              + region.getEncodedName() + &lt;span class=&quot;code-quote&quot;&gt;&quot; returned &quot;&lt;/span&gt; + deleteNode);
        }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because as per the first set of logs the node in the expected CLOSED state only.. That is why it is returning true and also deleting the node.  &lt;br/&gt;
If we add an &apos;if&apos; check before the log it won&apos;t log an error.&lt;/p&gt;

</comment>
                            <comment id="13185502" author="ram_krish" created="Fri, 13 Jan 2012 08:58:23 +0000"  >&lt;p&gt;@J-D and @Lars&lt;br/&gt;
Latest patch uploaded. Sorry for uploading with the same name.&lt;br/&gt;
Hope this patch addresses your concern.?&lt;/p&gt;</comment>
                            <comment id="13185519" author="hadoopqa" created="Fri, 13 Jan 2012 09:34:59 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12510473/HBASE-5120_5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12510473/HBASE-5120_5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -147 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 81 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.replication.TestReplication&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/753//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/753//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/753//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/753//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/753//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/753//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13187081" author="ram_krish" created="Mon, 16 Jan 2012 18:56:16 +0000"  >&lt;p&gt;Just was browsing thro &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4015&quot; title=&quot;Refactor the TimeoutMonitor to make it less racy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4015&quot;&gt;&lt;del&gt;HBASE-4015&lt;/del&gt;&lt;/a&gt; where Timeout monitor was refactored.&lt;br/&gt;
With 5 secs as timeout period it was tested by balancing, killing and bringing up RS. Things came out fine.&lt;br/&gt;
But this disable scenario was missed out.&lt;br/&gt;
Another change that i could see is when &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4015&quot; title=&quot;Refactor the TimeoutMonitor to make it less racy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4015&quot;&gt;&lt;del&gt;HBASE-4015&lt;/del&gt;&lt;/a&gt; was done for forceful unassign() we check if the node is present in CLOSING state then we did not proceed with it.&lt;br/&gt;
Now in recent code the check is removed.  May be that exposed the problem.&lt;br/&gt;
Thanks to JD for pointing this out. As per JD if after reducing the timeout period if we don&apos;t run to such type of issues then we can say TM is really fixed.&lt;/p&gt;</comment>
                            <comment id="13194962" author="ram_krish" created="Fri, 27 Jan 2012 18:03:17 +0000"  >&lt;p&gt;@Stack&lt;br/&gt;
Can we commit this now to trunk?&lt;/p&gt;</comment>
                            <comment id="13195163" author="stack" created="Fri, 27 Jan 2012 22:29:42 +0000"  >&lt;p&gt;So, setting down the TM period from 30 minutes to 2 minutes and doing a bunch of online enable/disable works?  If so, I&apos;m +1 on this patch (We&apos;d actually set the timeout down from 30minutes to 5minutes over in hbase-5119?)&lt;/p&gt;</comment>
                            <comment id="13195417" author="ram_krish" created="Sat, 28 Jan 2012 04:55:41 +0000"  >&lt;p&gt;@Stack&lt;br/&gt;
Ok.  Thats sound good.  But currently our clusters are running with 0.90.x.&lt;br/&gt;
May be it may take some more time for me to bring out the results.  By the time if some one volunteers to check this, I would be thankful to them.&lt;br/&gt;
Any way i would also try to check this out. Thanks Stack.&lt;/p&gt;</comment>
                            <comment id="13210491" author="stack" created="Fri, 17 Feb 2012 20:04:46 +0000"  >&lt;p&gt;I committed to trunk.  Will not commit to 0.92.  Not important enough of a bug I&apos;d say.&lt;/p&gt;</comment>
                            <comment id="13210492" author="stack" created="Fri, 17 Feb 2012 20:05:07 +0000"  >&lt;p&gt;I did not commit to 0.90 either.&lt;/p&gt;</comment>
                            <comment id="13210822" author="hudson" created="Sat, 18 Feb 2012 05:51:52 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #114 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/114/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/114/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5120&quot; title=&quot;Timeout monitor races with table disable handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5120&quot;&gt;&lt;del&gt;HBASE-5120&lt;/del&gt;&lt;/a&gt; Timeout monitor races with table disable handler (Revision 1245731)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13211138" author="hudson" created="Sat, 18 Feb 2012 22:11:59 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2665 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2665/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2665/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5120&quot; title=&quot;Timeout monitor races with table disable handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5120&quot;&gt;&lt;del&gt;HBASE-5120&lt;/del&gt;&lt;/a&gt; Timeout monitor races with table disable handler (Revision 1245731)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13217967" author="lhofhansl" created="Tue, 28 Feb 2012 07:02:25 +0000"  >&lt;p&gt;Can we close this issue?&lt;/p&gt;</comment>
                            <comment id="13218387" author="stack" created="Tue, 28 Feb 2012 17:39:52 +0000"  >&lt;p&gt;Closed.  Reopen if I have it wrong Ram.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12509425" name="HBASE-5120.patch" size="4498" author="ram_krish" created="Wed, 4 Jan 2012 16:53:43 +0000"/>
                            <attachment id="12509921" name="HBASE-5120_1.patch" size="4108" author="ram_krish" created="Mon, 9 Jan 2012 15:33:00 +0000"/>
                            <attachment id="12510034" name="HBASE-5120_2.patch" size="4335" author="ram_krish" created="Tue, 10 Jan 2012 11:57:26 +0000"/>
                            <attachment id="12510054" name="HBASE-5120_3.patch" size="4196" author="ram_krish" created="Tue, 10 Jan 2012 15:35:06 +0000"/>
                            <attachment id="12510165" name="HBASE-5120_4.patch" size="4256" author="ram_krish" created="Wed, 11 Jan 2012 08:28:44 +0000"/>
                            <attachment id="12510473" name="HBASE-5120_5.patch" size="4299" author="ram_krish" created="Fri, 13 Jan 2012 08:57:08 +0000"/>
                            <attachment id="12510211" name="HBASE-5120_5.patch" size="4256" author="ram_krish" created="Wed, 11 Jan 2012 17:44:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 4 Jan 2012 04:19:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>222643</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 42 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i069s7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34516</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>