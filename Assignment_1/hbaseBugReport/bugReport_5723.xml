<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:30:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5723/HBASE-5723.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5723] Simple Design of Secondary Index</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5723</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Use coprocessor to create index. And primary tables&apos; compaction to purge the stale data. &lt;br/&gt;
Attach file is the Design of the Seconday Index.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12549659">HBASE-5723</key>
            <summary>Simple Design of Secondary Index</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="xingshi">ShiXing</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Apr 2012 10:05:46 +0000</created>
                <updated>Sat, 11 Apr 2015 01:25:42 +0000</updated>
                            <resolved>Sat, 11 Apr 2015 01:25:42 +0000</resolved>
                                                                    <component>Coprocessors</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>19</watches>
                                                                <comments>
                            <comment id="13247127" author="xingshi" created="Thu, 5 Apr 2012 10:25:52 +0000"  >&lt;p&gt;Difficulty and risk&lt;br/&gt;
1. During primary table compact, the StoreScanner just read&lt;br/&gt;
family.getMaxVersions() versions&apos; data, the old data will be skiped, but the&lt;br/&gt;
old data&apos;s indices should be deleted, So we must read all version data for&lt;br/&gt;
indices&apos; delete, and family.getMaxVersions() version for store&apos;s compaction.&lt;/p&gt;

&lt;p&gt;Also the timestamp of columns that we want to delete the indices should also have not TimeRange, now it is System.CurrentTimeMillis() - ttl;&lt;/p&gt;</comment>
                            <comment id="13247438" author="tlipcon" created="Thu, 5 Apr 2012 17:57:40 +0000"  >&lt;p&gt;The design doc doesn&apos;t make any reference to consistency. How do you ensure consistency of the index? To do proper indexes you really need cross-table transactions, or at least a mechanism for eventual consistency if that&apos;s all you plan on providing.&lt;/p&gt;</comment>
                            <comment id="13248021" author="shixing" created="Fri, 6 Apr 2012 04:08:06 +0000"  >&lt;p&gt;Todd, &lt;br/&gt;
    you mean the consistency of index table? Because the index table is also a HBase table, so it will use the mvcc to ensure the consistency of the index table. &lt;/p&gt;

&lt;p&gt;Mainly there are 2 steps when do put.&lt;br/&gt;
Step1 : It will insert data into index table.&lt;br/&gt;
Step2 : It will insert data into primary table.&lt;/p&gt;

&lt;p&gt;After step1, the client can read the index, but may be the step2 has not done. So client will find there is no data are associated with the index, and it will read the old version index. Here it is weak consistency, and at last the index and data will be eventual consistency except as follows:.&lt;/p&gt;

&lt;p&gt;If the step2 failed, we will not delete the new index&#65292; the index is not correct(there is no row in the primary table associated with this index by the rowkey, the value, and the same timestamp) ant it is Weak consistency.&lt;/p&gt;

&lt;p&gt;For these stale indices, we will not delete it forever(may be we can delete them by period job to detect the not correct indice).&lt;/p&gt;</comment>
                            <comment id="13248024" author="tlipcon" created="Fri, 6 Apr 2012 04:13:33 +0000"  >&lt;p&gt;If this implementation isn&apos;t giving you any consistency, then why is it any better than just having the client do two puts?&lt;/p&gt;

&lt;p&gt;I think for us to consider adding an indexing library to HBase proper, it needs to have stronger semantics. The idea that an index may be incorrect in the case of failures does not seem like something we should ship.&lt;/p&gt;</comment>
                            <comment id="13248426" author="jesse_yates" created="Fri, 6 Apr 2012 15:54:54 +0000"  >&lt;p&gt;There is a lot of work that the Lily guys have done along the lines of ensuring consistency, but basically revolves around using a WAL for making sure the edits get back in. Personally, I find their approach a bit heavy handed (esp with the coprocessor framework &lt;em&gt;now&lt;/em&gt; available, though it makes sense before CPs). They also have done a lot of work (open source!) for indexing different data types, integration with Solr, etc. Either way, worth taking a dive into their stuff, if only for inspiration and seeing what people who have thought a lot about this problem have some up with.&lt;/p&gt;</comment>
                            <comment id="13249907" author="zhihyu@ebaysf.com" created="Mon, 9 Apr 2012 16:11:10 +0000"  >&lt;p&gt;@Todd:&lt;br/&gt;
Do you think the attached proposal belongs to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3340&quot; title=&quot;Eventually Consistent Secondary Indexing via Coprocessors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3340&quot;&gt;HBASE-3340&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="13249927" author="tlipcon" created="Mon, 9 Apr 2012 16:34:52 +0000"  >&lt;p&gt;This seems to give even fewer guarantees than &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3340&quot; title=&quot;Eventually Consistent Secondary Indexing via Coprocessors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3340&quot;&gt;HBASE-3340&lt;/a&gt; (which as I understood it used the WAL to ensure reasonably timely consistency of the index table). I&apos;m still of the opinion that these things should start as separate projects, rather than inside HBase core, and only if we see a high demand for them and good maintenance, we should pull it in. I don&apos;t think there is much demand for non-consistent indexes.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12493110">HBASE-3340</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12521480" name="Simple Design of HBase SecondaryIndex.pdf" size="208923" author="xingshi" created="Thu, 5 Apr 2012 10:06:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 5 Apr 2012 17:57:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>234650</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 36 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0htz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>102118</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>