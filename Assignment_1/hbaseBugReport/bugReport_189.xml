<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:41:52 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-189/HBASE-189.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-189] [hbase] when the master times out a region server&apos;s lease, it is too aggressive in reclaiming the server&apos;s log</title>
                <link>https://issues.apache.org/jira/browse/HBASE-189</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When a region server&apos;s lease times out, the master immediately begins trying to split the server&apos;s log file. There have been cases where a region server was just a little late reporting to the master and the master had already started trying to reclaim the server&apos;s log, even though the server was still writing to it. &lt;/p&gt;

&lt;p&gt;There needs to be some kind of &quot;grace period&quot; in which, if the region server reports in, the master re-instates the server. If the &quot;grace period&quot; expires, then the master should start processing the server&apos;s log.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12378952">HBASE-189</key>
            <summary>[hbase] when the master times out a region server&apos;s lease, it is too aggressive in reclaiming the server&apos;s log</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jimk">Jim Kellerman</reporter>
                        <labels>
                    </labels>
                <created>Sun, 23 Sep 2007 20:28:21 +0000</created>
                <updated>Mon, 4 Feb 2008 18:41:03 +0000</updated>
                            <resolved>Fri, 5 Oct 2007 09:51:54 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12529977" author="jimk" created="Mon, 24 Sep 2007 21:01:42 +0000"  >&lt;p&gt;Implementation strategy:&lt;/p&gt;

&lt;p&gt;When a server&apos;s lease expires, remove the server from serversToServerInfo, put the serverInfo into a new Map, serversInJeopardy and put a PendingServerShutdown into a DelayQueue with an expiration of 1/2 of a server lease timeout.&lt;/p&gt;

&lt;p&gt;If the server reports in in that period, the PendingServerShutdown is removed from the DelayQueue and the server is &quot;reinstated&quot; by removing it from the serversInJeopardy Map and putting it back in the serversToServerInfo map.&lt;/p&gt;

&lt;p&gt;If the server does not report in, it is removed from the serversInJeopardy Map and the PendingServerShutdown is processed.&lt;/p&gt;</comment>
                            <comment id="12531933" author="jimk" created="Tue, 2 Oct 2007 22:23:53 +0000"  >&lt;p&gt;Revised strategy:&lt;/p&gt;

&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-329&quot; title=&quot;[hbase] If a region server cannot talk to the master after several attempts, it should shut itself down&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-329&quot;&gt;&lt;del&gt;HADOOP-1960&lt;/del&gt;&lt;/a&gt;, if the region server cannot talk to the master&lt;br/&gt;
before its lease expires it shuts itself down. Thus the likelihood of&lt;br/&gt;
a region server checking in after its lease has expired is low. In the&lt;br/&gt;
event this does happen, however, the master will tell the region&lt;br/&gt;
server to restart; that is close all open regions and flush its log.&lt;/p&gt;

&lt;p&gt;However, the master should defer processing the server&apos;s log and&lt;br/&gt;
reassigning its regions as the server may still be in the process of&lt;br/&gt;
shutting down. Consequently, all PendingServerShutdowns will be placed&lt;br/&gt;
in a delay queue for 1/2 a lease period to ensure the region server&lt;br/&gt;
has shut down.&lt;/p&gt;

&lt;p&gt;Finally, we will add the server start code to the log file name, so&lt;br/&gt;
that if the region server restarts before the master processes the old&lt;br/&gt;
log file, the new log file will not be included.&lt;/p&gt;</comment>
                            <comment id="12532568" author="jimk" created="Fri, 5 Oct 2007 04:26:59 +0000"  >&lt;p&gt;HRegionServer&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Fix restart&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;HMaster&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Introduce DelayQueue for processing dead region servers&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12532575" author="hadoopqa" created="Fri, 5 Oct 2007 05:44:22 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12367125/patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12367125/patch.txt&lt;/a&gt;&lt;br/&gt;
against trunk revision r582066.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    javadoc +1.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    javac +1.  The applied patch does not generate any new compiler warnings.&lt;/p&gt;

&lt;p&gt;    findbugs +1.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    core tests +1.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    contrib tests +1.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/891/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/891/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/891/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/891/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/891/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/891/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/891/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/891/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12532612" author="jimk" created="Fri, 5 Oct 2007 09:51:54 +0000"  >&lt;p&gt;This issue is one for which it is nearly impossible to build a regression test (it is very similar to TestDFSAbort in this regard). Consequently no regression test has been included with this patch. It has been tested extensively in the development environment, however and introduces no new regressions in the other tests. Committed.&lt;/p&gt;</comment>
                            <comment id="12532624" author="hudson" created="Fri, 5 Oct 2007 11:33:15 +0000"  >&lt;p&gt;Integrated in Hadoop-Nightly #261 (See &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/261/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/261/&lt;/a&gt;)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12367125" name="patch.txt" size="10707" author="jimk" created="Fri, 5 Oct 2007 04:26:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Oct 2007 05:44:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24973</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h59j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98115</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>