<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:17:57 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-16800/HBASE-16800.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-16800] Support for smart querying of our published jmx per server over http+json</title>
                <link>https://issues.apache.org/jira/browse/HBASE-16800</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We currently expose our jmx metrics via a json dump in a servlet at /jmx. You get all or nothing (You can add a &apos;?description=true&apos; to get a description for each metric published but that is it).&lt;/p&gt;

&lt;p&gt;A means of being able to query by metric or by a set of metrics would make graphing easier to do, especially over http dumping json. In particular, our &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=appy&quot; class=&quot;user-hover&quot; rel=&quot;appy&quot;&gt;Appy&lt;/a&gt; is trying to put up pages that give insight into current state of replication.&lt;/p&gt;

&lt;p&gt;Related, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-11747&quot; title=&quot;ClusterStatus is too bulky &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-11747&quot;&gt;HBASE-11747&lt;/a&gt; ClusterStatus is too bulky, is about how whenever we need a metric &apos;exposed&apos;, our only means is by bulking out the heartbeat adding payload on each message we send the server (In the issue, w/ 1M regions, each RS is sending 100MB of &apos;status&apos; every second). We need to undo metrics collection from clusterstatus function&lt;/p&gt;

&lt;p&gt;Bonus if able to compress/cache payloads, security, etc.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13011117">HBASE-16800</key>
            <summary>Support for smart querying of our published jmx per server over http+json</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Mon, 10 Oct 2016 17:22:45 +0000</created>
                <updated>Tue, 11 Oct 2016 02:48:23 +0000</updated>
                                                                            <component>metrics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="15562899" author="stack" created="Mon, 10 Oct 2016 17:28:29 +0000"  >&lt;p&gt;Here is a patch that adds a &lt;a href=&quot;https://jolokia.org/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://jolokia.org/&lt;/a&gt; servlet at /j per server.  Protocol described here: &lt;a href=&quot;https://jolokia.org/reference/html/protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://jolokia.org/reference/html/protocol.html&lt;/a&gt; Includes search, bulk, list, and  more. Let me see if I can repro our current /jmx servlet dump using this tool. If so, can replace current servlet w/ a more functional alternative.&lt;/p&gt;</comment>
                            <comment id="15563046" author="stack" created="Mon, 10 Oct 2016 18:18:59 +0000"  >&lt;p&gt;For completeness, I notice you can query a single bean in our current /jmx server:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://kalashnikov.att.net:16010/jmx?qry=Hadoop:service=HBase,name=Master,sub=Balancer&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://kalashnikov.att.net:16010/jmx?qry=Hadoop:service=HBase,name=Master,sub=Balancer&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Could add querying single attributes...  Would be easy enough.&lt;/p&gt;</comment>
                            <comment id="15563522" author="appy" created="Mon, 10 Oct 2016 21:12:31 +0000"  >&lt;p&gt;To give more idea about numbers:&lt;br/&gt;
RS /jmx response is ~350kb (~200-300ms). Without server-side filtering, collecting metrics for dashboard for a 1000node cluster will be 350M. Won&apos;t be possible to refresh dashboard every 30sec.&lt;/p&gt;

&lt;p&gt;With filtering (?qry=Hadoop:service=HBase,name=RegionServer,sub=Replication), it&apos;s just ~1kb which totally makes it possible to have a dashboard which can be refreshed with a good cadence.&lt;br/&gt;
Thank &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; for figuring this out.&lt;/p&gt;</comment>
                            <comment id="15564241" author="stack" created="Tue, 11 Oct 2016 02:48:23 +0000"  >&lt;p&gt;From a server @appy put up w/ replication running:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;beans&quot;&lt;/span&gt; : [ {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;Hadoop:service=HBase,name=RegionServer,sub=Replication&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;modelerType&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;RegionServer,sub=Replication&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;tag.Context&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;regionserver&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;tag.Hostname&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;ve0206.halxg.cloudera.com&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.1.shippedOps&quot;&lt;/span&gt; : 3,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.shippedKBs&quot;&lt;/span&gt; : 0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.1.shippedBatches&quot;&lt;/span&gt; : 3,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.sizeOfLogQueue&quot;&lt;/span&gt; : 3,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.logEditsFiltered&quot;&lt;/span&gt; : 2,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.1.shippedKBs&quot;&lt;/span&gt; : 0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.1.ageOfLastShippedOp&quot;&lt;/span&gt; : 1657226,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.1.logReadInBytes&quot;&lt;/span&gt; : 969,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.logReadInBytes&quot;&lt;/span&gt; : 969,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.1.logEditsRead&quot;&lt;/span&gt; : 6,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;sink.appliedOps&quot;&lt;/span&gt; : 0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.1.sizeOfLogQueue&quot;&lt;/span&gt; : 3,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.shippedOps&quot;&lt;/span&gt; : 3,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.logEditsRead&quot;&lt;/span&gt; : 6,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.shippedBatches&quot;&lt;/span&gt; : 3,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;sink.ageOfLastAppliedOp&quot;&lt;/span&gt; : 0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.ageOfLastShippedOp&quot;&lt;/span&gt; : 1657226,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;source.1.logEditsFiltered&quot;&lt;/span&gt; : 2,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;sink.appliedBatches&quot;&lt;/span&gt; : 0
  } ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Seems like we want the whole bean to tell the replication story so in this case the qry by mbean as @appy says is good enough.&lt;/p&gt;

&lt;p&gt;If we need more fine-grained querying, searching, listing, compression, batch, etc., then we can come back here to this patch that adds jolokai. Meantime I&apos;ve made the issue minor.&lt;/p&gt;

&lt;p&gt;Also, we were going to bring in jolokai &amp;#8211; another dependency &amp;#8211; it&apos;d be good to replace our current jmx servlet with it instead.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12832504" name="HBASE-16800.master.001.patch" size="3270" author="stack" created="Mon, 10 Oct 2016 17:23:51 +0000"/>
                            <attachment id="12832505" name="HBASE-16800.master.002.patch" size="3270" author="stack" created="Mon, 10 Oct 2016 17:24:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 10 Oct 2016 21:12:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34op3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>