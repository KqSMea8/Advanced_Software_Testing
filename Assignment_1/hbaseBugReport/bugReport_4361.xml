<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:18:14 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4361/HBASE-4361.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4361] Certain filter expressions fail in the shell</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4361</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Running the following in the shell hangs and then fails:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t1&apos;, { FILTER =&amp;gt; &quot;SingleColumnValueFilter(&quot;&amp;gt;&quot;, &apos;1&apos;, &apos;f1&apos;, &apos;col_a&apos;)&quot; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The error seems to be: org.jruby.exceptions.RaiseException: (NoMethodError) undefined method `write&apos; for true:TrueClass&lt;/p&gt;</description>
                <environment></environment>
        <key id="12522483">HBASE-4361</key>
            <summary>Certain filter expressions fail in the shell</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                            <label>beginner</label>
                    </labels>
                <created>Fri, 9 Sep 2011 22:14:06 +0000</created>
                <updated>Wed, 16 Nov 2016 20:55:27 +0000</updated>
                                            <version>2.0.0</version>
                                                    <component>Filters</component>
                    <component>shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13101604" author="tlipcon" created="Fri, 9 Sep 2011 22:18:45 +0000"  >&lt;p&gt;After hacking HBase to show a full stack trace:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.jruby.exceptions.RaiseException: (NoMethodError) undefined method `write&apos; for true:TrueClassorg.jruby.exceptions.RaiseException: (NoMethodError) undefined method `write&apos; for true:TrueClass
        at Hbase::Table.scan(/home/todd/git/hbase/bin/../bin/../src/main/ruby/hbase/table.rb:255)
        at Shell::Commands::Scan.command(/home/todd/git/hbase/bin/../bin/../src/main/ruby/shell/commands/scan.rb:61)
        at Shell::Commands::Scan.command_safe(/home/todd/git/hbase/bin/../bin/../src/main/ruby/shell/commands.rb:31)
        at Shell::Commands::Command.translate_hbase_exceptions(/home/todd/git/hbase/bin/../bin/../src/main/ruby/shell/commands.rb:70)
        at Shell::Commands::Command.command_safe(/home/todd/git/hbase/bin/../bin/../src/main/ruby/shell/commands.rb:31)
        at Shell::Shell.command(/home/todd/git/hbase/bin/../bin/../src/main/ruby/shell.rb:106)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13101613" author="tlipcon" created="Fri, 9 Sep 2011 22:44:50 +0000"  >&lt;p&gt;Several problems here:&lt;br/&gt;
1) I was using double-quotes twice, so it was passing &quot;true&quot; as the filter value. JRuby and its lovely lack of type checking then passed that through to the point where it tried to write true to the wire as a Writable, and failed.&lt;br/&gt;
2) The documentation for SingleColumnValueFilter has the incorrect order of arguments.&lt;br/&gt;
3) The errors given back by the filter parsing code are inscrutable.&lt;/p&gt;</comment>
                            <comment id="13101618" author="tlipcon" created="Fri, 9 Sep 2011 22:48:34 +0000"  >&lt;p&gt;For reference, the correct way to specify this is:&lt;br/&gt;
scan &apos;t1&apos;, &lt;/p&gt;
{ FILTER =&amp;gt; &quot;SingleColumnValueFilter(&apos;f1&apos;, &apos;col_a&apos;, &amp;gt;, &apos;binary:1&apos;)&quot; }

&lt;p&gt;But I had to read the code for 30 minutes to figure it out. We need lots of docs updates on the filter language.&lt;/p&gt;</comment>
                            <comment id="13101635" author="tlipcon" created="Fri, 9 Sep 2011 23:11:54 +0000"  >&lt;p&gt;here are a few improvements. Still need to fix the docs, etc, to be correct. Ideally IMO the filter parsing would be done by javacc or antlr so we&apos;d have a real grammar.&lt;/p&gt;</comment>
                            <comment id="13102107" author="anirudhtodi" created="Sat, 10 Sep 2011 18:45:52 +0000"  >&lt;p&gt;Thanks Stack for pinging me about the Filter Language!&lt;/p&gt;

&lt;p&gt;1. Todd, I think your test failed because the way I wrote my code, the arguments needed to be enclosed in single quotes. I know it is in the documentation I sent out, however, it may not have been highlighted. I don&apos;t see how I would parse the filterString if the entire filterString is enclosed in double quotes and some of the arguments are enclosed in double quotes too?&lt;/p&gt;

&lt;p&gt;2. Regarding the incorrect order of arguments specified in the documentation for SingleColumnValueFilter, I apologize about that - the filter language went through several iterations and I may have overlooked updating the documentation in one place. I can take a look at it over the weekend and check the documentation again&lt;/p&gt;

&lt;p&gt;3. Better error messages? - I can try and improve this. Are there any specific points I can address to improve what is already there?&lt;/p&gt;

&lt;p&gt;4. Writing the filter parsing using antlr or javacc, I doubt I will have time to do that during the school semester. It&apos;s something I could potentially look into during the winter break. However, I leave this to your discretion.&lt;/p&gt;

&lt;p&gt;Hope the Filter Language is benefiting the community!&lt;/p&gt;</comment>
                            <comment id="13102418" author="anirudhtodi" created="Mon, 12 Sep 2011 04:36:42 +0000"  >&lt;p&gt;Updated the Filter Language document to include the error Todd caught. &lt;/p&gt;

&lt;p&gt;Also updated some of the examples.&lt;/p&gt;

&lt;p&gt;However, I didn&apos;t notice any other error. &lt;/p&gt;</comment>
                            <comment id="13102840" author="tlipcon" created="Mon, 12 Sep 2011 17:42:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t see how I would parse the filterString if the entire filterString is enclosed in double quotes and some of the arguments are enclosed in double quotes too?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yep, that was my mistake &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; But the shell didn&apos;t do a good job of showing me my error. Dynamic typing FTL &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; My patch here at least changes the shell to say: &quot;Invalid filter: false&quot; instead of the strange exception I got before.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Better error messages? - I can try and improve this. Are there any specific points I can address to improve what is already there&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In general, all of the exceptions thrown should tell you which text caused them to throw. For example, &quot;Invalid quoted string&quot; is useless, but &quot;Invalid quoted string: foo&quot; is useful. &quot;Mismatched parenthesis&quot; should include the offset in the string at which it was found. &quot;Incorrect Filter String&quot; if the stack is non-empty at the end of parseFilterString should probably say something like &quot;Incorrect filter string: unmatched LPAREN at offset &amp;lt;n&amp;gt;&quot;. Pretty much all of the places where IllegalArgumentException are thrown in ParseFilter could be improved to have (a) the offset at which the error occurred, and (b) details about what was incorrect.&lt;/p&gt;


&lt;p&gt;All of the above aside, it&apos;s a nice feature once you get it to work &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Thanks for the hard work implementing it.&lt;/p&gt;</comment>
                            <comment id="13129152" author="yuzhihong@gmail.com" created="Mon, 17 Oct 2011 20:36:17 +0000"  >&lt;p&gt;Moving the remaining work to 0.94&lt;/p&gt;</comment>
                            <comment id="13234516" author="lhofhansl" created="Wed, 21 Mar 2012 17:08:44 +0000"  >&lt;p&gt;Shuffling it on to 0.96.&lt;/p&gt;</comment>
                            <comment id="13549193" author="yuzhihong@gmail.com" created="Wed, 9 Jan 2013 23:40:20 +0000"  >&lt;p&gt;No assignee.&lt;/p&gt;</comment>
                            <comment id="13737203" author="stack" created="Mon, 12 Aug 2013 18:43:15 +0000"  >&lt;p&gt;Not being worked on.   Moving out.&lt;/p&gt;</comment>
                            <comment id="15671599" author="stack" created="Wed, 16 Nov 2016 20:55:27 +0000"  >&lt;p&gt;Still finish-up work to be done here or as sub-issues. Leaving open. Marking beginner.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12493983" name="Filter Language.docx" size="137550" author="anirudhtodi" created="Mon, 12 Sep 2011 04:36:42 +0000"/>
                            <attachment id="12493867" name="small-improvements.txt" size="1946" author="tlipcon" created="Fri, 9 Sep 2011 23:11:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 10 Sep 2011 18:45:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27273</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02bo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11492</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>