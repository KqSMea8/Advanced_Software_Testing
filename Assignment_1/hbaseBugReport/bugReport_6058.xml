<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:33:25 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6058/HBASE-6058.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6058] Use ZK 3.4 API &apos;multi&apos; in bulk assignment</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6058</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We use async API today. This is already much much faster than the sync API. Still, it makes sense to use the &apos;multi&apos; function: this will decrease the network &amp;amp; zookeeper load at startup/rolling restart.&lt;/p&gt;

&lt;p&gt;On a 500 nodes cluster, we see 3 that 3 seconds are spent on updating ZK per bulk assignment. This should cut it in half (+ the benefits on the network/zk load).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12556513">HBASE-6058</key>
            <summary>Use ZK 3.4 API &apos;multi&apos; in bulk assignment</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="nkeywal">Nicolas Liochon</assignee>
                                    <reporter username="nkeywal">Nicolas Liochon</reporter>
                        <labels>
                    </labels>
                <created>Sat, 19 May 2012 08:45:47 +0000</created>
                <updated>Tue, 15 Oct 2013 09:05:05 +0000</updated>
                            <resolved>Tue, 15 Oct 2013 09:05:05 +0000</resolved>
                                    <version>0.95.2</version>
                                                    <component>master</component>
                    <component>Zookeeper</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13279559" author="zhihyu@ebaysf.com" created="Sat, 19 May 2012 14:46:15 +0000"  >&lt;p&gt;There hasn&apos;t been consensus as to which HBase version would require zk 3.4 as the minimum supported version.&lt;/p&gt;</comment>
                            <comment id="13397917" author="jesse_yates" created="Wed, 20 Jun 2012 21:55:20 +0000"  >&lt;p&gt;I think the consensus is that we don&apos;t move until 3.4 is considered stable. I&apos;ve got a couple other patches up for other various zkutil things, for when we do move. Hopefully this happens around 0.96, especially since Patrick Hunt was saying that there haven&apos;t been any major issues around 3.4 (particularly around the multi stuff).&lt;/p&gt;</comment>
                            <comment id="13397923" author="apurtell" created="Wed, 20 Jun 2012 21:59:32 +0000"  >&lt;p&gt;We run 3.4 in production and have had no issues.&lt;/p&gt;

&lt;p&gt;Multi has not had much use though, relative to the remainder of the ZK API. IMO, 0.96 is a good target for use of it, and we should get such usage in soon enough so we can have plenty of experience with it before cutting a release that uses it.&lt;/p&gt;</comment>
                            <comment id="13398282" author="nkeywal" created="Thu, 21 Jun 2012 08:21:55 +0000"  >&lt;p&gt;All the tests I made with multi were successful. But they were only tests &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;br/&gt;
Note it&apos;s not totally trivial to use it in bulk assignment, because we have two levels of asynchronous calls (the callback calls another asynchronous function). So supporting both ZK version (with &amp;amp; without multi) would be looking for issue imho.&lt;br/&gt;
And fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1381&quot; title=&quot;Add a method to get the zookeeper server version from the client&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1381&quot;&gt;ZOOKEEPER-1381&lt;/a&gt; would help on deployment, today we hang if we call multi on a 3.3 ZK server...&lt;br/&gt;
Anyway, I will redo some perfo tests to see where we are now with the current implementation.&lt;/p&gt;</comment>
                            <comment id="13398549" author="jesse_yates" created="Thu, 21 Jun 2012 16:31:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;supporting both ZK version (with &amp;amp; without multi) would be looking for issue imho&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Totally agree.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Anyway, I will redo some perfo tests to see where we are now with the current implementation&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Great! I&apos;d love to see how big of a difference it makes. &lt;/p&gt;</comment>
                            <comment id="13508963" author="nkeywal" created="Mon, 3 Dec 2012 19:28:24 +0000"  >&lt;p&gt;I&apos;ve tested ZK#multi on assignment in master: no real improvement actually because we&#8217;re actually spending our time in the region server. We lower the load on ZK, but it would be visible only on a large cluster. As using multi would require to use ZK 3.4, it&#8217;s not compelling enough to do the move.&lt;/p&gt;

&lt;p&gt;Note that&apos;s because:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the master part I&apos;ve changed is doing asynchronous writes, faster than synchronous writes&lt;/li&gt;
	&lt;li&gt;ZooKeeper does nothing else. On a large cluster, it would be more interesting.&lt;/li&gt;
	&lt;li&gt;there is no real bulk assign in the region server (i.e. a regionserver receives 20 regions simultaneously). So we don&apos;t need multi there today.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12540439">ZOOKEEPER-1381</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12551766">HBASE-5843</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 19 May 2012 14:46:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241866</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02f87:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12068</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>