<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:09:11 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3315/HBASE-3315.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3315] Add debug output for when balancer makes bad balance</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3315</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Balancer had assertions at end of the balanceCluster method.  These assertions trigger on occasion &amp;#8211; just did for me and did previously for j-d &amp;#8211; only there&apos;s no data to analyze when it fails.  Add logging data on balancer input and summary.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12492560">HBASE-3315</key>
            <summary>Add debug output for when balancer makes bad balance</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Dec 2010 00:00:11 +0000</created>
                <updated>Fri, 20 Nov 2015 12:43:36 +0000</updated>
                            <resolved>Tue, 7 Dec 2010 00:59:03 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12968524" author="stack" created="Tue, 7 Dec 2010 00:57:28 +0000"  >&lt;p&gt;Here is what I&apos;m committing..... (after testing on cluster).&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
===================================================================
--- src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java      (revision 1042857)
+++ src/main/java/org/apache/hadoop/hbase/master/LoadBalancer.java      (working copy)
@@ -293,11 +293,20 @@

     &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; endTime = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();

-    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(regionidx == regionsToMove.size()): &lt;span class=&quot;code-quote&quot;&gt;&quot;clusterState=&quot;&lt;/span&gt; + clusterState +
-      &lt;span class=&quot;code-quote&quot;&gt;&quot;, regionidx=&quot;&lt;/span&gt; + regionidx + &lt;span class=&quot;code-quote&quot;&gt;&quot;, regionsToMove=&quot;&lt;/span&gt; + regionsToMove +
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (regionidx != regionsToMove.size() || neededRegions != 0) {
+      &lt;span class=&quot;code-comment&quot;&gt;// Emit data so can diagnose how balancer went astray.
&lt;/span&gt;+      LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;regionidx=&quot;&lt;/span&gt; + regionidx + &lt;span class=&quot;code-quote&quot;&gt;&quot;, regionsToMove=&quot;&lt;/span&gt; + regionsToMove.size() +
       &lt;span class=&quot;code-quote&quot;&gt;&quot;, numServers=&quot;&lt;/span&gt; + numServers + &lt;span class=&quot;code-quote&quot;&gt;&quot;, serversOverloaded=&quot;&lt;/span&gt; + serversOverloaded +
-      &lt;span class=&quot;code-quote&quot;&gt;&quot;, serversUnderloaded=&quot;&lt;/span&gt; + serversUnderloaded;
-    &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(neededRegions == 0);
+      &lt;span class=&quot;code-quote&quot;&gt;&quot;, serversUnderloaded=&quot;&lt;/span&gt; + serversUnderloaded);
+      StringBuilder sb = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringBuilder();
+      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;HServerInfo, List&amp;lt;HRegionInfo&amp;gt;&amp;gt; e: clusterState.entrySet()) {
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (sb.length() &amp;gt; 0) sb.append(&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;);
+        sb.append(e.getKey().getServerName());
+        sb.append(&lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt;);
+        sb.append(e.getValue().size());
+      }
+      LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Input &quot;&lt;/span&gt; + sb.toString());
+    }

     &lt;span class=&quot;code-comment&quot;&gt;// All done!
&lt;/span&gt;     LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Calculated a load balance in &quot;&lt;/span&gt; + (endTime-startTime) + &lt;span class=&quot;code-quote&quot;&gt;&quot;ms. &quot;&lt;/span&gt; +
@@ -636,7 +645,7 @@
     &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() {
       &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;hri=&quot;&lt;/span&gt; + &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.hri.getRegionNameAsString() + &lt;span class=&quot;code-quote&quot;&gt;&quot;, src=&quot;&lt;/span&gt; +
         (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.source == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;? &quot;&quot;: &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.source.getServerName()) +
-        &lt;span class=&quot;code-quote&quot;&gt;&quot;, dest=&quot;&lt;/span&gt; + &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.dest.getServerName();
+        &lt;span class=&quot;code-quote&quot;&gt;&quot;, dest=&quot;&lt;/span&gt; + (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.dest == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;? &quot;&quot;: &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.dest.getServerName());
     }
   }
 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12968525" author="stack" created="Tue, 7 Dec 2010 00:59:03 +0000"  >&lt;p&gt;Committed logging to branch and trunk.  Will  have to open new issue to fix bad balancer calc when we trip over one.&lt;/p&gt;</comment>
                            <comment id="12968526" author="stack" created="Tue, 7 Dec 2010 01:00:02 +0000"  >&lt;p&gt;Here&apos;s a bad balance Jon: &lt;br/&gt;
2010-12-07 00:49:26,047 WARN org.apache.hadoop.hbase.master.LoadBalancer: Input sv2borg187,60020,1291682134874 1538, sv2borg183,60020,1291682134478 1392, sv2borg181,60020,1291682134477 1561, sv2borg189,60020,1291682134476 1557, sv2borg182,60020,1291682134474 1535, sv2borg185,60020,1291682134481 1553, sv2borg188,60020,1291682134874 1385, sv2borg186,60020,1291682134480 1542, sv2borg184,60020,1291682134480 1619&lt;/p&gt;</comment>
                            <comment id="15017566" author="lars_francke" created="Fri, 20 Nov 2015 12:43:36 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Nov 2015 12:43:36 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26779</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hlpr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100780</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>