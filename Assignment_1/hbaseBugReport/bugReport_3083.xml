<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:07:13 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3083/HBASE-3083.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3083] Major compaction check should use new timestamp meta information in HFiles (rather than dfs timestamp) along with TTL to allow major even if single file</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3083</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Periodic major compactions have a separate set of checks prior to submitting the compaction request.&lt;/p&gt;

&lt;p&gt;Currently, if there is a single file, and it is the result of a major compaction, then it is skipped.  However, there is a check that will still allow it if the timestamp of the file is older than the TTL of that Store.&lt;/p&gt;

&lt;p&gt;This is not ideal because the timestamp of the file is the latest timestamp in the file rather than the oldest.  Meta information was introduced to HFiles that stores the max/min timestamp of KVs in the file.  We should use the min timestamp from that meta info rather than the file stamp itself.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12475893">HBASE-3083</key>
            <summary>Major compaction check should use new timestamp meta information in HFiles (rather than dfs timestamp) along with TTL to allow major even if single file</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="streamy">Jonathan Gray</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Oct 2010 21:03:20 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:59 +0000</updated>
                            <resolved>Mon, 8 Nov 2010 17:52:20 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12918186" author="streamy" created="Tue, 5 Oct 2010 21:04:20 +0000"  >&lt;p&gt;Assigning to Prakash for now.  I will work with him on this.  Plan is to get this done this week.&lt;/p&gt;</comment>
                            <comment id="12923233" author="stack" created="Wed, 20 Oct 2010 23:36:52 +0000"  >&lt;p&gt;@Prakash, this same as &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2990?&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-2990?&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12923236" author="streamy" created="Wed, 20 Oct 2010 23:41:12 +0000"  >&lt;p&gt;Nope.  That jira is about the first check (was the last major compaction &amp;gt; the configured period).&lt;/p&gt;

&lt;p&gt;This jira is about the second check.  Once we determine we want to do a major, we do another check.  If there is only one file, and that file is a major compaction, we generally want to skip the major.  &lt;em&gt;Except&lt;/em&gt; when there is expired data in that file.&lt;/p&gt;

&lt;p&gt;This check is in there but is currently using the hdfs timestamp of this single file which is not the right timestamp to use.  We want to use the minimum timestamp from the TimestampRange we&apos;re now tracking in hfile metadata to accurately know whether there is expired data in there or not (and thus should go ahead with major compaction).&lt;/p&gt;</comment>
                            <comment id="12929639" author="streamy" created="Mon, 8 Nov 2010 17:39:34 +0000"  >&lt;p&gt;I&apos;m still mulling over the right solution for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2990&quot; title=&quot;It&amp;#39;s possible for regions to not be major compacted for more than hbase.hregion.majorcompaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2990&quot;&gt;&lt;del&gt;HBASE-2990&lt;/del&gt;&lt;/a&gt;.  I&apos;ve had patches up on RB that fix that jira as well as this one.  Let&apos;s just fix this one now since it&apos;s a trivial fix and will get 2990 in when I figure out the least-hacky way to do it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12929641" author="streamy" created="Mon, 8 Nov 2010 17:39:49 +0000"  >&lt;p&gt;please review&lt;/p&gt;</comment>
                            <comment id="12929643" author="stack" created="Mon, 8 Nov 2010 17:48:57 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;A tidy &apos;fix&apos;.&lt;/p&gt;</comment>
                            <comment id="12929644" author="streamy" created="Mon, 8 Nov 2010 17:52:20 +0000"  >&lt;p&gt;Committed.  Thanks for review stack.&lt;/p&gt;</comment>
                            <comment id="15017128" author="lars_francke" created="Fri, 20 Nov 2015 12:41:59 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12459069" name="HBASE-3083.patch" size="1826" author="streamy" created="Mon, 8 Nov 2010 17:39:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 20 Oct 2010 23:36:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32896</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hknj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100608</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>