<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:06:13 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2961/HBASE-2961.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2961] Close zookeeper when done with it (HCM, Master, and RS)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2961</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We&apos;re not closing down zk properly, mostly in HCM.  Makes for spew in zk logs and it also causes shutdown to run longer.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12473292">HBASE-2961</key>
            <summary>Close zookeeper when done with it (HCM, Master, and RS)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Sep 2010 23:30:30 +0000</created>
                <updated>Fri, 20 Nov 2015 12:42:27 +0000</updated>
                            <resolved>Fri, 10 Sep 2010 00:07:08 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12906173" author="stack" created="Fri, 3 Sep 2010 23:32:15 +0000"  >&lt;p&gt;Here is a mix of debug and patch... Still trying to figure why zk decides to bang its head and try and reconnect to ensemble though the sessionid thats complaining seems to have been &apos;closed&apos; properly.&lt;/p&gt;</comment>
                            <comment id="12907032" author="stack" created="Tue, 7 Sep 2010 23:52:54 +0000"  >&lt;p&gt;This gets rid of noise from zk in standalone mode (shutdown runs faster).  It breaks tests though because fix is making a Configuration per server..... and so, new HConnections need to each get root location (Previous, they all shared single connection and the single root location).   Need to make the HCM use new RootRegionTracker.  Cleaner.&lt;/p&gt;</comment>
                            <comment id="12907488" author="stack" created="Wed, 8 Sep 2010 23:50:17 +0000"  >&lt;p&gt;This patch moves HCM to use RootRegionTracker rather than do that weird setRootLocation thing we used do &amp;#8211; there is no need for it when HCM has a ZooKeeperWatcher inside in it.&lt;/p&gt;

&lt;p&gt;(This patch also removes ServerConnection, and ServerConnectionManager! interfaces and replaces them with HConnection... renames TableServers as HConnectionImplementation... hopefully now noobies won&apos;t have to spend a month of sundays trying to disentangle the flow in an hbase client).&lt;/p&gt;

&lt;p&gt;Not all tests pass yet.&lt;/p&gt;</comment>
                            <comment id="12907833" author="stack" created="Fri, 10 Sep 2010 00:02:39 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Make it so zk shutdown is clean.  Did it by making each server have
its own Configuration and hence its own HConnection instance, then
in each server (and client) added HCM.deleteConnection on way out. This
runs clean up of the HConnection.. Added to HConnection#close the shutdown
of zk.

Did other refactor &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; in here; removed crazy ServerConnection and
ServerConnectionManager stuff substituting &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RootRegionTracker in its
place.

Tried to fix outstanding tests.  One still failing.

M src/test/java/org/apache/hadoop/hbase/TestMultiParallel.java
  Up retries &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; now to make tests pass.  Needs rewrite.
M src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java
  Make a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Configuration so the setting of less tries has an effect
  and we don&apos;t retry &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; ever and fail the test.
M src/test/java/org/apache/hadoop/hbase/catalog/TestMetaReaderEditor.java
  Minor formatting.
M src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java
  Reuse predefined variable.
M src/test/java/org/apache/hadoop/hbase/client/TestHCM.java
  Renamed of TableServers to HCI
M src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
  Removed ServerConnection.  Use HConnection.
  Use RootRegionTracker to keep tabs on root location.
  Add logging of zk sessionid to help w/ debug
M src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java
  Minor formatting.
M src/main/java/org/apache/hadoop/hbase/regionserver/wal/SequenceFileLogReader.java
  Need to preserve EOF &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; thats what we got.
M src/main/java/org/apache/hadoop/hbase/LocalHBaseCluster.java
  Minor reformatting.
M src/main/java/org/apache/hadoop/hbase/master/ServerManager.java
M src/main/java/org/apache/hadoop/hbase/master/HMaster.java
M src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java
  ServerConnection is gone.  Use HConnection instead.
M src/main/java/org/apache/hadoop/hbase/client/HConnectionManager.java
  Renamed TableServers as HConnectionImplementation
  Use RootRegionTracker &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; figuring root location. Made it so could get
  rid of some locateRegion code.
  Added clearRegionCache(tableName) override.
M src/main/java/org/apache/hadoop/hbase/client/HConnection.java
  Added clearRegionCache(tableName)
M src/main/java/org/apache/hadoop/hbase/client/ServerConnection.java
M src/main/java/org/apache/hadoop/hbase/client/ServerConnectionManager.java
  Deleted crazy stuff.
M src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java
  On delete of table, don&apos;t delete connection; connection is more than 
  just a connection to an individual table.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12907836" author="stack" created="Fri, 10 Sep 2010 00:07:08 +0000"  >&lt;p&gt;Committed  w/o review though a fairly substantial patch; lots touched but its mostly just fixing failing tests and remove of SC and SCM.&lt;/p&gt;</comment>
                            <comment id="15017253" author="lars_francke" created="Fri, 20 Nov 2015 12:42:27 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12470400">HBASE-2889</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12454171" name="2961-v2.txt" size="34628" author="stack" created="Wed, 8 Sep 2010 23:50:16 +0000"/>
                            <attachment id="12454257" name="2961-v3.txt" size="46326" author="stack" created="Fri, 10 Sep 2010 00:02:39 +0000"/>
                            <attachment id="12454058" name="2961.txt" size="20749" author="stack" created="Tue, 7 Sep 2010 23:52:54 +0000"/>
                            <attachment id="12453842" name="debug.txt" size="6021" author="stack" created="Fri, 3 Sep 2010 23:32:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Nov 2015 12:42:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26557</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hk1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100510</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>