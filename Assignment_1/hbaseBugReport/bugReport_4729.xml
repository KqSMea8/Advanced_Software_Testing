<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:21:31 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4729/HBASE-4729.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4729] Clash between region unassign and splitting kills the master</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4729</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I was running an online alter while regions were splitting, and suddenly the master died and left my table half-altered (haven&apos;t restarted the master yet).&lt;/p&gt;

&lt;p&gt;What killed the master:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2011-11-02 17:06:44,428 FATAL org.apache.hadoop.hbase.master.HMaster: Unexpected ZK exception creating node CLOSING&lt;br/&gt;
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /hbase/unassigned/f7e1783e65ea8d621a4bc96ad310f101&lt;br/&gt;
        at org.apache.zookeeper.KeeperException.create(KeeperException.java:110)&lt;br/&gt;
        at org.apache.zookeeper.KeeperException.create(KeeperException.java:42)&lt;br/&gt;
        at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:637)&lt;br/&gt;
        at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.createNonSequential(RecoverableZooKeeper.java:459)&lt;br/&gt;
        at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.create(RecoverableZooKeeper.java:441)&lt;br/&gt;
        at org.apache.hadoop.hbase.zookeeper.ZKUtil.createAndWatch(ZKUtil.java:769)&lt;br/&gt;
        at org.apache.hadoop.hbase.zookeeper.ZKAssign.createNodeClosing(ZKAssign.java:568)&lt;br/&gt;
        at org.apache.hadoop.hbase.master.AssignmentManager.unassign(AssignmentManager.java:1722)&lt;br/&gt;
        at org.apache.hadoop.hbase.master.AssignmentManager.unassign(AssignmentManager.java:1661)&lt;br/&gt;
        at org.apache.hadoop.hbase.master.BulkReOpen$1.run(BulkReOpen.java:69)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;A znode was created because the region server was splitting the region 4 seconds before:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2011-11-02 17:06:40,704 INFO org.apache.hadoop.hbase.regionserver.SplitTransaction: Starting split of region TestTable,0012469153,1320253135043.f7e1783e65ea8d621a4bc96ad310f101.&lt;br/&gt;
2011-11-02 17:06:40,704 DEBUG org.apache.hadoop.hbase.regionserver.SplitTransaction: regionserver:62023-0x132f043bbde0710 Creating ephemeral node for f7e1783e65ea8d621a4bc96ad310f101 in SPLITTING state&lt;br/&gt;
2011-11-02 17:06:40,751 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:62023-0x132f043bbde0710 Attempting to transition node f7e1783e65ea8d621a4bc96ad310f101 from RS_ZK_REGION_SPLITTING to RS_ZK_REGION_SPLITTING&lt;br/&gt;
...&lt;br/&gt;
2011-11-02 17:06:44,061 DEBUG org.apache.hadoop.hbase.zookeeper.ZKAssign: regionserver:62023-0x132f043bbde0710 Successfully transitioned node f7e1783e65ea8d621a4bc96ad310f101 from RS_ZK_REGION_SPLITTING to RS_ZK_REGION_SPLIT&lt;br/&gt;
2011-11-02 17:06:44,061 INFO org.apache.hadoop.hbase.regionserver.SplitTransaction: Still waiting on the master to process the split for f7e1783e65ea8d621a4bc96ad310f101&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Now that the master is dead the region server is spewing those last two lines like mad.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12529908">HBASE-4729</key>
            <summary>Clash between region unassign and splitting kills the master</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Nov 2011 17:35:58 +0000</created>
                <updated>Fri, 12 Oct 2012 05:35:07 +0000</updated>
                            <resolved>Tue, 29 Nov 2011 18:54:15 +0000</resolved>
                                    <version>0.92.0</version>
                                    <fixVersion>0.92.0</fixVersion>
                    <fixVersion>0.94.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13142378" author="jdcryans" created="Wed, 2 Nov 2011 18:20:45 +0000"  >&lt;p&gt;After the master got restarted the split was processed correctly but the table is still half-altered (need to see if this is going to work).&lt;/p&gt;</comment>
                            <comment id="13148276" author="ram_krish" created="Fri, 11 Nov 2011 05:36:19 +0000"  >&lt;p&gt;Before we create the closing node if creating fails because of node already exists check if it is REGION_SPLIT node, if so wait for some specified time for split to get completed?&lt;br/&gt;
If not can we trigger manually to process the split? Pls suggest.&lt;/p&gt;</comment>
                            <comment id="13148596" author="stack" created="Fri, 11 Nov 2011 17:36:19 +0000"  >&lt;p&gt;It seems like CLOSING (and OFFLINE) should be prepared to find an exising znode in SPLITTING mode and fail (w/o shutting down master).  Is that possible?  Just fail the open or the close.  If offlining a table, we&apos;ll have failed the offlining of this region.  Can the region offlining retry until it can successfully get the close in?  Is there code already in the master-side handlers where if a table is disabling, we&apos;ll send out a close when split comes in?&lt;/p&gt;

&lt;p&gt;We should fix this too: &apos;Now that the master is dead the region server is spewing those last two lines like mad.&apos;.&lt;/p&gt;</comment>
                            <comment id="13150521" author="ram_krish" created="Tue, 15 Nov 2011 14:31:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;It seems like CLOSING (and OFFLINE) should be prepared to find an exising znode in SPLITTING mode and fail (w/o shutting down master). Is that possible? ust fail the open or the close.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is possible.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is there code already in the master-side handlers where if a table is disabling, we&apos;ll send out a close when split comes in?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Currently alter table issues unassign in a different thread and split goes seperately.&lt;/p&gt;</comment>
                            <comment id="13150644" author="yuzhihong@gmail.com" created="Tue, 15 Nov 2011 18:07:47 +0000"  >&lt;p&gt;Patch handles zk node in RS_ZK_REGION_SPLIT or RS_ZK_REGION_SPLITTING state.&lt;/p&gt;</comment>
                            <comment id="13150689" author="stack" created="Tue, 15 Nov 2011 19:17:10 +0000"  >&lt;p&gt;This is something that could do w/ a test (patch looks fine otherwise).&lt;/p&gt;</comment>
                            <comment id="13150697" author="yuzhihong@gmail.com" created="Tue, 15 Nov 2011 19:24:06 +0000"  >&lt;p&gt;I am not sure how to make zk node transition to RS_ZK_REGION_SPLITTING at the time of unassign() execution.&lt;/p&gt;</comment>
                            <comment id="13150705" author="stack" created="Tue, 15 Nov 2011 19:37:05 +0000"  >&lt;p&gt;Yeah. It&apos;d be tough to do.  Let me see if can make it happen.&lt;br/&gt;
St.Ack&lt;/p&gt;</comment>
                            <comment id="13150722" author="hadoopqa" created="Tue, 15 Nov 2011 19:54:46 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12503776/4729.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12503776/4729.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -163 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 51 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.master.TestDistributedLogSplitting&lt;br/&gt;
                  org.apache.hadoop.hbase.replication.TestReplication&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestHFileBlock&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/256//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/256//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/256//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/256//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/256//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/256//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13150780" author="stack" created="Tue, 15 Nov 2011 21:06:18 +0000"  >&lt;p&gt;The above test fails don&apos;t look related (TDLS is probably too many files, THFB is about to be fixed, and TR just failed w/o this patch on TRUNK).&lt;/p&gt;</comment>
                            <comment id="13150924" author="jdcryans" created="Wed, 16 Nov 2011 00:30:41 +0000"  >&lt;p&gt;I tested out the patch and I saw it working. Would be nice to have a unit test.&lt;/p&gt;</comment>
                            <comment id="13151126" author="ram_krish" created="Wed, 16 Nov 2011 10:32:57 +0000"  >&lt;p&gt;I think this patch will not solve the problem.  It will only allow the master from aborting.&lt;br/&gt;
But the alter table will not be completed fully.&lt;/p&gt;

&lt;p&gt;There is one more thing here which i found in the same place&lt;br/&gt;
In assignmentManager.unassign() &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (regionsInTransition) {
      state = regionsInTransition.get(encodedName);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If we find a state already existing we just return with out unassigning.&lt;br/&gt;
This also when races with Splitting of region will not allow alter table to be completed.&lt;br/&gt;
Same will be the case if we just try to handle the NodeAlreadyExistsException.  &lt;br/&gt;
I would like to get your suggestion.  Can we invoke manually to split?&lt;/p&gt;</comment>
                            <comment id="13151150" author="yuzhihong@gmail.com" created="Wed, 16 Nov 2011 11:59:49 +0000"  >&lt;p&gt;If a region is in transition, it may be splitting. &lt;br/&gt;
Why do we need to manually split?&lt;br/&gt;
I think we should add check for the state of zk node and decide whether to continue or not. &lt;/p&gt;</comment>
                            <comment id="13151235" author="ram_krish" created="Wed, 16 Nov 2011 14:37:54 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
What i meant is the alter table does not happen even in this scenario where the region is in RIT with SPLITTING state. Correct me if am wrong Ted.&lt;/p&gt;</comment>
                            <comment id="13151243" author="yuzhihong@gmail.com" created="Wed, 16 Nov 2011 14:52:18 +0000"  >&lt;p&gt;Wouldn&apos;t the daughter regions pick up new table definition from .tableinfo which is stored on hdfs ?&lt;/p&gt;

&lt;p&gt;Please take a look at TestInstantSchemaChange#testConcurrentInstantSchemaChangeAndSplit in &lt;a href=&quot;https://reviews.apache.org/r/1786/diff/#index_header&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/1786/diff/#index_header&lt;/a&gt; to see if that test covers our scenario.&lt;/p&gt;

&lt;p&gt;@J-D:&lt;br/&gt;
Can you provide more details for your comment @ 16/Nov/11 00:30 ?&lt;br/&gt;
Maybe you can address Ramkrishna&apos;s question.&lt;/p&gt;</comment>
                            <comment id="13152088" author="ram_krish" created="Thu, 17 Nov 2011 15:01:36 +0000"  >&lt;p&gt;@Ted&lt;/p&gt;

&lt;p&gt;I think the best way to stop splitting from happening when alter table goes on.&lt;br/&gt;
Or stop alter table when splitting goes on.  &lt;br/&gt;
If split gets completed the region that we are trying to unassign itself gets changed and so&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions) {
      &lt;span class=&quot;code-comment&quot;&gt;// Check &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; region is currently assigned
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!regions.containsKey(region)) {
        debugLog(region, &lt;span class=&quot;code-quote&quot;&gt;&quot;Attempted to unassign region &quot;&lt;/span&gt; +
          region.getRegionNameAsString() + &lt;span class=&quot;code-quote&quot;&gt;&quot; but it is not &quot;&lt;/span&gt; +
          &lt;span class=&quot;code-quote&quot;&gt;&quot;currently assigned anywhere&quot;&lt;/span&gt;);
         &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;unassign merely returns without proceeding.  I tried to introduce a logic of Retry in BulkReopen but because the region gets changed still unassign does not complete successfully.  Pls suggest...&lt;/p&gt;</comment>
                            <comment id="13152141" author="yuzhihong@gmail.com" created="Thu, 17 Nov 2011 17:07:58 +0000"  >&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4213&quot; title=&quot;Support for fault tolerant, instant schema updates with out master&amp;#39;s intervention (i.e with out enable/disable and bulk assign/unassign) through ZK.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4213&quot;&gt;&lt;del&gt;HBASE-4213&lt;/del&gt;&lt;/a&gt;, the following change is made to CompactSplitThread.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; requestSplit(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HRegion r) {
+    waitForInflightSchemaChange(r.getRegionInfo().getTableNameAsString());
...
+  /**
+   * Wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mid-flight schema alter requests. (&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; any). We don&apos;t want to execute a split
+   * when a schema alter is in progress as we end up in an inconsistent state.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think we should define the scope of what problem this JIRA solves.&lt;/p&gt;</comment>
                            <comment id="13152495" author="jdcryans" created="Fri, 18 Nov 2011 00:21:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;Wouldn&apos;t the daughter regions pick up new table definition from .tableinfo which is stored on hdfs ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It seems that if the parent was already splitting when the alter happens, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4814&quot; title=&quot;Starting an online alter when regions are splitting can leave their daughters unaltered&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4814&quot;&gt;&lt;del&gt;HBASE-4814&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think the best way to stop splitting from happening when alter table goes on.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Almost impossible. Regions splits on their own.&lt;/p&gt;</comment>
                            <comment id="13157540" author="stack" created="Sat, 26 Nov 2011 16:38:10 +0000"  >&lt;p&gt;Critical.  Too easy to make happen.&lt;/p&gt;</comment>
                            <comment id="13157544" author="ram_krish" created="Sat, 26 Nov 2011 16:54:05 +0000"  >&lt;p&gt;Split and region related movements should be atomic.  Doing this will have some effect on online altering also because as part of online altering we unassign regions.&lt;/p&gt;</comment>
                            <comment id="13157546" author="stack" created="Sat, 26 Nov 2011 17:04:18 +0000"  >&lt;p&gt;Looking at patch again:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
+              }
+            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (KeeperException ke) {
+            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can we not bury the &apos;return&apos; down here in the catch block?  Its going to be responsible for someone losing hours trying to follow whats going on in here (they&apos;ll miss this return for sure).&lt;/p&gt;

&lt;p&gt;We should also log the exception above if it happens at the least.&lt;/p&gt;

&lt;p&gt;I agree w/ what Ted says that fixing alter is a bigger problem than this jira, that we should do that elsewhere.  This issue stops master at least exiting both for alter table + splitting scenario and for balancer + concurrent splitting.&lt;/p&gt;

&lt;p&gt;I made this issue critical for 0.92.  Let me try and work up a test.&lt;/p&gt;</comment>
                            <comment id="13157547" author="yuzhihong@gmail.com" created="Sat, 26 Nov 2011 17:05:40 +0000"  >&lt;p&gt;As I commented @17/Nov/11 17:07, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4213&quot; title=&quot;Support for fault tolerant, instant schema updates with out master&amp;#39;s intervention (i.e with out enable/disable and bulk assign/unassign) through ZK.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4213&quot;&gt;&lt;del&gt;HBASE-4213&lt;/del&gt;&lt;/a&gt; would be long term solution for this problem.&lt;br/&gt;
See TestInstantSchemaChange#testConcurrentInstantSchemaChangeAndLoadBalancerRun in trunk.&lt;/p&gt;</comment>
                            <comment id="13157549" author="ram_krish" created="Sat, 26 Nov 2011 17:12:39 +0000"  >&lt;p&gt;I agree with you Ted. &lt;/p&gt;</comment>
                            <comment id="13159098" author="stack" created="Tue, 29 Nov 2011 05:42:56 +0000"  >&lt;p&gt;This is Ram&apos;s patch with a Test&lt;/p&gt;

&lt;p&gt;M src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;br/&gt;
  Remove debugLog method.  Seems odd to me that the message log level would&lt;br/&gt;
  vary by the region.&lt;br/&gt;
  (regionOnline): Changed from public to package private.&lt;br/&gt;
  (unassign): Allow that a region may be SPLITTING or in SPLIT state when&lt;br/&gt;
  we go to put up the CLOSING state; just fail with a log warn message.&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;br/&gt;
  Minor javadoc fix.&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/zookeeper/ZKTable.java&lt;br/&gt;
  Allow that enable/disable dir may not exist (fine for test context).&lt;br/&gt;
A src/test/java/org/apache/hadoop/hbase/master/TestAssignmentManager.java&lt;br/&gt;
  Added.&lt;/p&gt;</comment>
                            <comment id="13159099" author="stack" created="Tue, 29 Nov 2011 05:43:14 +0000"  >&lt;p&gt;May I have some review please?&lt;/p&gt;</comment>
                            <comment id="13159101" author="stack" created="Tue, 29 Nov 2011 05:48:09 +0000"  >&lt;p&gt;Add some more assertion about internal state of AssignmentManager after unassign while SPLITTING in place.&lt;/p&gt;</comment>
                            <comment id="13159105" author="hadoopqa" created="Tue, 29 Nov 2011 05:56:06 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505452/4729-v3.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505452/4729-v3.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/401//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/401//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/401//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/401//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/401//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/401//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13159113" author="yuzhihong@gmail.com" created="Tue, 29 Nov 2011 06:08:42 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * Updates the RegionState and sends the CLOSE RPC unless regions is being
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above should read &apos;... region is being&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * of existence). TODO: What to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; split fails and is rolled back and
+   * parent is revivified?
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above would be handled in another JIRA. How about introducing a new state, such as RS_ZK_PARENT_REGION_CLOSE_THRU_SPLIT, so that rolling back failed split can decide what to do ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (KeeperException ke) {
+              LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Presuming failed getData on &quot;&lt;/span&gt; + path + &lt;span class=&quot;code-quote&quot;&gt;&quot;; presuming &quot;&lt;/span&gt; +
+                &lt;span class=&quot;code-quote&quot;&gt;&quot;split and that the region to unassign, &quot;&lt;/span&gt; + encodedName +
+                &lt;span class=&quot;code-quote&quot;&gt;&quot;, no longer exists -- confirm&quot;&lt;/span&gt;, ke);
+              &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
+            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;We should verify the above assumption by checking that ke is NoNodeException. If ke is not NoNodeException, we should abort.&lt;/p&gt;</comment>
                            <comment id="13159137" author="stack" created="Tue, 29 Nov 2011 07:26:23 +0000"  >&lt;p&gt;Address Ted comments (I like the one where we need to verify NoNodeException).&lt;/p&gt;</comment>
                            <comment id="13159138" author="stack" created="Tue, 29 Nov 2011 07:28:15 +0000"  >&lt;p&gt;I&apos;ll make new JIRA for TODO on commit and for discussing &apos;How about introducing a new state, such as RS_ZK_PARENT_REGION_CLOSE_THRU_SPLIT, so that rolling back failed split can decide what to do ?&apos;&lt;/p&gt;

&lt;p&gt;I think this the last issue for 0.92 &amp;#8211; or at least, once this goes in I&apos;m going to RC now I can do a build w/o tests failing.&lt;/p&gt;</comment>
                            <comment id="13159143" author="hadoopqa" created="Tue, 29 Nov 2011 07:36:07 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505460/4729-v4.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505460/4729-v4.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 67 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/402//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/402//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/402//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/402//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/402//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/402//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13159180" author="yuzhihong@gmail.com" created="Tue, 29 Nov 2011 10:03:09 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (KeeperException ke) {
+              LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unexpected zk state&quot;&lt;/span&gt;, ke);
+            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;For KeeperException.SessionExpiredException, we may optionally follow example of tryRecoveringExpiredZKSession() in HMaster.&lt;/p&gt;

&lt;p&gt;For unexpected zk exception, we should abort the master instead of logging error.&lt;/p&gt;

&lt;p&gt;TestAssignmentManager is missing test category.&lt;/p&gt;</comment>
                            <comment id="13159311" author="stack" created="Tue, 29 Nov 2011 15:21:23 +0000"  >&lt;blockquote&gt;&lt;p&gt;For unexpected zk exception, we should abort the master instead of logging error.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It does.  It falls through to the abort call.&lt;/p&gt;

&lt;p&gt;I&apos;ll make issue for SessionExpiredException.&lt;/p&gt;

&lt;p&gt;I&apos;ll fix missing test category on commit.&lt;/p&gt;

&lt;p&gt;But thinking more on this patch, it works for the altering case but I don&apos;t think it will work for the issue I reported where we are unassigning because region is being moved by balancer.   The unassign looks like it moved so we&apos;ll go ahead and try open region in new location.  The splitting code may fix it up but need to check.&lt;/p&gt;</comment>
                            <comment id="13159398" author="stack" created="Tue, 29 Nov 2011 17:50:02 +0000"  >&lt;p&gt;Added missing annotation.  Otherwise, its pretty much v4.&lt;/p&gt;</comment>
                            <comment id="13159406" author="hadoopqa" created="Tue, 29 Nov 2011 17:56:38 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505507/4729-v5.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505507/4729-v5.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 68 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/404//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/404//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/404//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/404//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/404//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/404//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13159410" author="yuzhihong@gmail.com" created="Tue, 29 Nov 2011 18:03:01 +0000"  >&lt;p&gt;Since TestAssignmentManager would be run in a shared JVM under TRUNK in the near future, I think it should be a medium test.&lt;/p&gt;

&lt;p&gt;From N:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Small tests are executed in a shared JVM. We put in this category all the&lt;br/&gt;
tests that can be executed quickly (the maximum execution time for a test&lt;br/&gt;
is 15 seconds, and they do not use a cluster) in a shared jvm.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13159416" author="stack" created="Tue, 29 Nov 2011 18:10:43 +0000"  >&lt;p&gt;Now I think we should commit this.&lt;/p&gt;

&lt;p&gt;My concern about a failed unassign as part of a balance is unfounded.  Balances work by running unassign and then in the ClosedRegionHandler we&apos;ll do the assign elsewhere.  The latter assign will not happen if the unassign/close doesn&apos;t complete because of a concurrent SPLITTING/SPLIT.&lt;/p&gt;

&lt;p&gt;Regards the TODO on what to do on rollback of a failed split, again, we should be ok in the balancing case; the cluster will be out-of-balance if parent comes back on line after our failed unassign attempt but so what.  It&apos;ll be fixed next time the balancer runs. &lt;/p&gt;

&lt;p&gt;On SessionExpiredException handling, that should be done in one place only rather than spread about the codebase (We need to refactor RecoverableZooKeeper so that it will create new ZooKeeper to retry on SessionExpiredException).&lt;/p&gt;

&lt;p&gt;Chatting with J-D, I should rename this issue since the focus has become balance+concurrent split; the alter case is less critical since we do not have online alter enabled by default (this patch will help some but more work to do &amp;#8211; I&apos;ll open new issue).&lt;/p&gt;</comment>
                            <comment id="13159417" author="stack" created="Tue, 29 Nov 2011 18:11:32 +0000"  >&lt;p&gt;Updated the subject&lt;/p&gt;</comment>
                            <comment id="13159420" author="stack" created="Tue, 29 Nov 2011 18:16:17 +0000"  >&lt;p&gt;J-D didn&apos;t like my last attempt at at title.  Making him happy.&lt;/p&gt;</comment>
                            <comment id="13159421" author="stack" created="Tue, 29 Nov 2011 18:21:46 +0000"  >&lt;p&gt;@Ted I will change the category on commit. May I have a +1?&lt;/p&gt;</comment>
                            <comment id="13159425" author="jdcryans" created="Tue, 29 Nov 2011 18:27:30 +0000"  >&lt;p&gt;+1 on v5, some comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I would have preferred to see the debugLog changes in another patch, makes it harder to review (but I agree with that change). Same for the other added javadocs and whatnot.&lt;/li&gt;
	&lt;li&gt;Minor nit, there&apos;s a white space missing before the path:&lt;/li&gt;
&lt;/ul&gt;


&lt;blockquote&gt;&lt;p&gt;LOG.warn(&quot;Failed getData on SPLITTING/SPLIT at&quot; + path +&lt;/p&gt;&lt;/blockquote&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;In the same log message, I&apos;m not sure what a user would be supposed to do with the following:&lt;/li&gt;
&lt;/ul&gt;


&lt;blockquote&gt;&lt;p&gt;encodedName + &quot;, no longer exists &amp;#8211; confirm&quot;, ke);&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="13159426" author="yuzhihong@gmail.com" created="Tue, 29 Nov 2011 18:27:36 +0000"  >&lt;p&gt;+1 on patch v5.&lt;/p&gt;</comment>
                            <comment id="13159432" author="stack" created="Tue, 29 Nov 2011 18:35:18 +0000"  >&lt;p&gt;@J-D Will fix on commit.  On log message, its intentionally irritating.  I want to leave it so until the presumption made here is verified (This should be very rare &amp;#8211; if not, there is a problem we  need to revisit).&lt;/p&gt;

&lt;p&gt;@Ted Thanks for reviews.&lt;/p&gt;</comment>
                            <comment id="13159436" author="stack" created="Tue, 29 Nov 2011 18:40:07 +0000"  >&lt;p&gt;What I applied trunk.&lt;/p&gt;</comment>
                            <comment id="13159443" author="hadoopqa" created="Tue, 29 Nov 2011 18:46:53 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12505515/4729-v6-trunk.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12505515/4729-v6-trunk.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -162 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 68 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/405//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/405//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/405//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/405//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/405//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/405//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13159451" author="stack" created="Tue, 29 Nov 2011 18:53:45 +0000"  >&lt;p&gt;What I applied to 092 branch (There is no categorization of tests in 0.92).&lt;/p&gt;</comment>
                            <comment id="13159452" author="stack" created="Tue, 29 Nov 2011 18:54:15 +0000"  >&lt;p&gt;Committed trunk and branch (thanks for reviews lads).&lt;/p&gt;</comment>
                            <comment id="13159728" author="ram_krish" created="Wed, 30 Nov 2011 01:25:04 +0000"  >&lt;p&gt;Assigning to your name Stack.&lt;/p&gt;</comment>
                            <comment id="13163896" author="stack" created="Tue, 6 Dec 2011 22:03:55 +0000"  >&lt;p&gt;Actually commit the patches (Above I say I do but just noticed that I had not &amp;#8211; my schizophrenia is showing through again... pardon me).&lt;/p&gt;</comment>
                            <comment id="13164014" author="hudson" created="Wed, 7 Dec 2011 00:47:27 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2522 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2522/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2522/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4729&quot; title=&quot;Clash between region unassign and splitting kills the master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4729&quot;&gt;&lt;del&gt;HBASE-4729&lt;/del&gt;&lt;/a&gt; Clash between region unassign and splitting kills the master&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKTable.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/master/TestAssignmentManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13164085" author="hudson" created="Wed, 7 Dec 2011 02:36:16 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #173 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/173/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/173/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4729&quot; title=&quot;Clash between region unassign and splitting kills the master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4729&quot;&gt;&lt;del&gt;HBASE-4729&lt;/del&gt;&lt;/a&gt; Clash between region unassign and splitting kills the master&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13164259" author="hudson" created="Wed, 7 Dec 2011 09:54:53 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #32 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/32/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/32/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4729&quot; title=&quot;Clash between region unassign and splitting kills the master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4729&quot;&gt;&lt;del&gt;HBASE-4729&lt;/del&gt;&lt;/a&gt; Clash between region unassign and splitting kills the master&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKTable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13164280" author="hudson" created="Wed, 7 Dec 2011 11:10:51 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #24 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/24/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/24/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4729&quot; title=&quot;Clash between region unassign and splitting kills the master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4729&quot;&gt;&lt;del&gt;HBASE-4729&lt;/del&gt;&lt;/a&gt; Clash between region unassign and splitting kills the master&lt;/p&gt;

&lt;p&gt;stack : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/SplitTransaction.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/zookeeper/ZKTable.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/master/TestAssignmentManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13164658" author="yuzhihong@gmail.com" created="Wed, 7 Dec 2011 20:00:22 +0000"  >&lt;p&gt;The HadoopQA report @ &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/405//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/405//testReport/&lt;/a&gt; showed basically no tests were run.&lt;/p&gt;

&lt;p&gt;A manual test suite execution should have been performed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12431925">HBASE-1730</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12505451" name="4729-v2.txt" size="22549" author="stack" created="Tue, 29 Nov 2011 05:42:56 +0000"/>
                            <attachment id="12505452" name="4729-v3.txt" size="22589" author="stack" created="Tue, 29 Nov 2011 05:48:09 +0000"/>
                            <attachment id="12505460" name="4729-v4.txt" size="22985" author="stack" created="Tue, 29 Nov 2011 07:26:23 +0000"/>
                            <attachment id="12505507" name="4729-v5.txt" size="24738" author="stack" created="Tue, 29 Nov 2011 17:50:01 +0000"/>
                            <attachment id="12505519" name="4729-v6-092.txt" size="15368" author="stack" created="Tue, 29 Nov 2011 18:53:45 +0000"/>
                            <attachment id="12505515" name="4729-v6-trunk.txt" size="23312" author="stack" created="Tue, 29 Nov 2011 18:40:07 +0000"/>
                            <attachment id="12503776" name="4729.txt" size="1732" author="yuzhihong@gmail.com" created="Tue, 15 Nov 2011 18:07:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 11 Nov 2011 05:36:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>215767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 2 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08qrr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48937</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>