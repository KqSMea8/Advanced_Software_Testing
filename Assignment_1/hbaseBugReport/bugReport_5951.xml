<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:32:26 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5951/HBASE-5951.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5951] Combining ColumnPrefixFilters using filterlist.</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5951</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;FilterList listOfFilters = new FilterList (FilterList.Operator.MUST_PASS_ALL);&lt;br/&gt;
FilterList listOfFilters1 = new FilterList (FilterList.Operator.MUST_PASS_ALL);&lt;br/&gt;
FilterList listOfFilters2 = new FilterList (FilterList.Operator.MUST_PASS_ALL);&lt;/p&gt;

&lt;p&gt;SingleColumnValueFilter SingleFilter1 = new&lt;br/&gt;
SingleColumnValueFilter(Bytes.toBytes(&quot;cf&quot;),&lt;br/&gt;
Bytes.toBytes(&quot;country&quot;), CompareOp.EQUAL,&lt;br/&gt;
Bytes.toBytes(&quot;USA&quot;));&lt;br/&gt;
listOfFilters.addFilter(SingleFilter1);&lt;/p&gt;

&lt;p&gt;ValueFilter VF1= new ValueFilter (CompareOp.EQUAL, &lt;br/&gt;
new SubstringComparator(&quot;ABC&quot;));&lt;br/&gt;
ColumnPrefixFilter CF1= new ColumnPrefixFilter(Bytes.toBytes(&quot;name&quot;));&lt;br/&gt;
listOfFilters1.addFilter(CF1);&lt;br/&gt;
listOfFilters1.addFilter(VF1);&lt;br/&gt;
listOfFilters.addFilter(listOfFilters1);&lt;/p&gt;

&lt;p&gt;ValueFilter VF2= new ValueFilter (CompareOp.EQUAL, &lt;br/&gt;
new SubstringComparator(&quot;ED&quot;));&lt;br/&gt;
ColumnPrefixFilter CF2= new ColumnPrefixFilter (Bytes.toBytes(&quot;CRS&quot;));&lt;br/&gt;
listOfFilters2.addFilter(CF2);&lt;br/&gt;
listOfFilters2.addFilter(VF2);&lt;br/&gt;
listOfFilters.addFilter(listOfFilters2);&lt;/p&gt;

&lt;p&gt;When i do a combibation of SingleFilter1 and listOfFilters1&lt;br/&gt;
 the result is correct, same way the combination of &lt;br/&gt;
SingleFilter1 and listOfFilters2 is returing correct result.&lt;br/&gt;
But when all the three is combined im not getting any result..&lt;/p&gt;

&lt;p&gt;Is it the problem with multiple ColumnPrefixFilter??? &lt;br/&gt;
Value &quot;ABC&quot; exist in name.0 and value &quot;ED&quot; exist in CRS.0 and it is in&lt;br/&gt;
the same row under same Column Family.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Combining multiple ColumnPrefixFilters using filterlist does not return exact result.&lt;/p&gt;</environment>
        <key id="12554176">HBASE-5951</key>
            <summary>Combining ColumnPrefixFilters using filterlist.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="davisabraham">Davis Abraham</reporter>
                        <labels>
                    </labels>
                <created>Mon, 7 May 2012 14:26:32 +0000</created>
                <updated>Fri, 11 May 2012 03:58:07 +0000</updated>
                            <resolved>Fri, 11 May 2012 03:58:07 +0000</resolved>
                                    <version>0.92.1</version>
                                                    <component>Filters</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13270169" author="anoopsamjohn" created="Tue, 8 May 2012 03:53:28 +0000"  >&lt;p&gt;@Davis&lt;br/&gt;
It would be better if you describe your schema and the query what you are trying to generate.&lt;/p&gt;

&lt;p&gt;The case which you describe as not working involve 2 ColumnPrefixFilter with AND condition.&lt;br/&gt;
ColumnPrefixFilter CF1= new ColumnPrefixFilter(Bytes.toBytes(&quot;name&quot;));- This will filter out all KVs with qualifier name other than nameXXXX&lt;br/&gt;
The othe one, ColumnPrefixFilter CF2= new ColumnPrefixFilter (Bytes.toBytes(&quot;CRS&quot;));- will filter out all KVs with qualifier name other than CRSXXXX&lt;/p&gt;

&lt;p&gt;So all KVs getting filtered out?&lt;/p&gt;

&lt;p&gt;If you tell your query need, we can discuss how the same can be created using Filter.&lt;/p&gt;</comment>
                            <comment id="13270300" author="davisabraham" created="Tue, 8 May 2012 07:52:31 +0000"  >&lt;p&gt;I&apos;m trying to execute a query which should work like ColumnPrefixValueFilter (Which is not available). To attain this i combined ColumnPrefixFilter with valueFilter to search for a particular value in a set of columns.&lt;/p&gt;

&lt;p&gt;Following is a SQL equivalent query even though it wont work in sql.&lt;/p&gt;

&lt;p&gt;(Select * from namexxx where value like &apos;ABC%&apos;) AND (Select * from CRSxxx where value like &apos;ED%&apos;)&lt;/p&gt;

&lt;p&gt;The result i expect is the set of rows where both the above conditions are satisfied.&lt;br/&gt;
I tried with some sample tables where ColumnFamily is same for all columns in all rows. &lt;/p&gt;

&lt;p&gt;From Hbase documentations and blogs i understood the following hierarchy can be achieved using FilterList.&lt;br/&gt;
Filterlist1 = ColumnPrefixFilter1 + valueFilter1; (This alone will return result)&lt;br/&gt;
Filterlist2 = ColumnPrefixFilter2 + valueFilter2; (This alone will also return result)&lt;br/&gt;
Filterlist = Filterlist1 + Filterlist2; (Result is null when combined)&lt;/p&gt;

&lt;p&gt;The result set is always null when Filterlist1 and Filterlist2 are applied together.&lt;/p&gt;</comment>
                            <comment id="13270325" author="anoopsamjohn" created="Tue, 8 May 2012 08:58:03 +0000"  >&lt;p&gt;I think I somewhat got the usecase of yours. But for this you can not use the filters and the filter list as you have used in the pasted sample&lt;/p&gt;

&lt;p&gt;Filterlist1 = ColumnPrefixFilter1 (namexxx) + valueFilter1; &lt;br/&gt;
Filterlist2 = ColumnPrefixFilter2 (CRSxxx) + valueFilter2; &lt;/p&gt;

&lt;p&gt;Filterlist = Filterlist1 + Filterlist2; // AND condition&lt;/p&gt;

&lt;p&gt;Here Filterlist1 will remove all the KVs (columns) other than the namexxx named column for a given row. So only that column(s) will be there in the result which is having a qualifier name starts with &quot;name&quot;.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;This will even remove the KVs corresponding to CRSxxx column also&amp;#93;&lt;/span&gt;&lt;br/&gt;
Same way Filterlist2 will allow only columns with name CRSxxx to come out. This will filter out namexxxx columns also. So in the next step of filtering as per the final Filterlist , even the namexxx columns(KVs) also gone! So that is why ultimately you will not get any thing in the output..&lt;/p&gt;

&lt;p&gt;For your need you need to write your own Filter implementation (like the one u said ColumnPrefixValueFilter) ...  U can not use the SingleColumnValueFilter also as it expects a column ( qualifier ) name but for you that name is also like not fixed. It is like CRSxxxx.....&lt;/p&gt;</comment>
                            <comment id="13270354" author="davisabraham" created="Tue, 8 May 2012 10:29:32 +0000"  >&lt;p&gt;Thanks Anoop for the reply. &lt;br/&gt;
I&apos;m trying implementing custom filters... Is there any link where i can get samples on how to create and use a Custom Filter...&lt;/p&gt;</comment>
                            <comment id="13270358" author="anoopsamjohn" created="Tue, 8 May 2012 10:40:33 +0000"  >&lt;p&gt;I think better you can follow the code in SingleColumnValueFilter. You need change in filterKeyValue(KeyValue keyValue) where it checks for the column name&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!keyValue.matchingColumn(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.columnFamily, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.columnQualifier)) {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; ReturnCode.INCLUDE;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here you need to do check like ColumnPrefixFilter to know whether the KV coming is of a column of user interest, CRSxxxx&lt;/p&gt;</comment>
                            <comment id="13270359" author="davisabraham" created="Tue, 8 May 2012 10:47:41 +0000"  >&lt;p&gt;Thank you....&lt;/p&gt;</comment>
                            <comment id="13270508" author="ram_krish" created="Tue, 8 May 2012 14:58:20 +0000"  >&lt;p&gt;@Davis&lt;br/&gt;
I have a question. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
(Select * from namexxx where value like &apos;ABC%&apos;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can we have a query where the column name itself can be prefix type in normal SQL? Columnprefix filters help you to select columns that are with the needed prefix rather than how singlecolumnvaluefilters(works on Kvs) work.&lt;/p&gt;</comment>
                            <comment id="13271097" author="davisabraham" created="Wed, 9 May 2012 04:54:41 +0000"  >&lt;p&gt;Its not possible in normal SQL... While posting the SQL query i had mentioned that it wont work in SQl...&lt;/p&gt;</comment>
                            <comment id="13271137" author="ram_krish" created="Wed, 9 May 2012 06:10:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;even though it wont work in sql.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sorry i missed it.&lt;/p&gt;</comment>
                            <comment id="13271508" author="anoopsamjohn" created="Wed, 9 May 2012 15:59:48 +0000"  >&lt;p&gt;Davis , this bug can be closed now?&lt;/p&gt;</comment>
                            <comment id="13272081" author="davisabraham" created="Thu, 10 May 2012 04:53:16 +0000"  >&lt;p&gt;We can close the bug by concluding that Hbase cannot support multiple ColumnPrefixFilters using filterlist...&lt;br/&gt;
It would have been better if Hbase could support multiple ColumnPrefixValueFilter(Yet to achieve)....&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13273020" author="anoopsamjohn" created="Fri, 11 May 2012 03:58:07 +0000"  >&lt;p&gt;This is not a defect.. 2 ColumnPrefixFilters were used with AND condition and that is why all the KVs were getting filtered out. For the usage scenario custom filter needs to be written.&lt;br/&gt;
Closing after the agreement from Davis&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 May 2012 03:53:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>238404</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i068kf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34319</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>