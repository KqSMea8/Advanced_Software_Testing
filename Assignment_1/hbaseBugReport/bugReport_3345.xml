<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:09:26 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3345/HBASE-3345.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3345] Master crash with NPE during table disable</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3345</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Running on a config that triggers lots of splits, I attempted to disable a table while it was getting a lot of load and injected failures. Got the following NPE in master, followed by an abort:&lt;/p&gt;

&lt;p&gt;2010-12-13 12:52:27,323 DEBUG org.apache.hadoop.hbase.master.AssignmentManager: Starting unassignment of region usertable,user1182862181,1292273503885.d223f1dc4d9003508f2db7566518b05d. (offlining)&lt;br/&gt;
2010-12-13 12:52:27,323 FATAL org.apache.hadoop.hbase.master.HMaster: Remote unexpected exception&lt;br/&gt;
java.lang.NullPointerException: Passed server is null&lt;br/&gt;
        at org.apache.hadoop.hbase.master.ServerManager.sendRegionClose(ServerManager.java:581)&lt;br/&gt;
        at org.apache.hadoop.hbase.master.AssignmentManager.unassign(AssignmentManager.java:1085)&lt;br/&gt;
        at org.apache.hadoop.hbase.master.AssignmentManager.unassign(AssignmentManager.java:1032)&lt;br/&gt;
        at org.apache.hadoop.hbase.master.handler.DisableTableHandler$BulkDisabler$1.run(DisableTableHandler.java:132)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12493118">HBASE-3345</key>
            <summary>Master crash with NPE during table disable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tlipcon">Todd Lipcon</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Dec 2010 20:56:18 +0000</created>
                <updated>Mon, 8 Aug 2011 23:57:58 +0000</updated>
                            <resolved>Mon, 8 Aug 2011 23:57:58 +0000</resolved>
                                    <version>0.90.0</version>
                                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12971980" author="stack" created="Thu, 16 Dec 2010 06:51:22 +0000"  >&lt;p&gt;I should have gotten context from you Todd when I was sitting beside you.  We could make a change like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java b/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java
index ea064f2..1df65e7 100644
--- a/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java
+++ b/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java
@@ -1079,6 +1079,12 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class AssignmentManager &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; ZooKeeperListener {
     HServerInfo server = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
     &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.regions) {
       server = regions.get(region);
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (server == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+        LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Can&apos;t unassign region &quot;&lt;/span&gt; + region.getRegionNameAsString() +
+          &lt;span class=&quot;code-quote&quot;&gt;&quot; from a &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; server; removing from regions!&quot;&lt;/span&gt;);
+        regions.remove(region);
+        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
+      }
     }
     &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
       &lt;span class=&quot;code-comment&quot;&gt;// TODO: We should consider making &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; look more like it does &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... so we flag the problem earlier but just keep going.  I wonder how server got to be null at all.  Thats what I&apos;d look in logs for.&lt;/p&gt;</comment>
                            <comment id="13015651" author="posix4e" created="Mon, 4 Apr 2011 22:06:30 +0000"  >&lt;p&gt;Most likely it wasn&apos;t that it was null but that the key didn&apos;t exist.&lt;/p&gt;</comment>
                            <comment id="13019703" author="stack" created="Thu, 14 Apr 2011 06:07:17 +0000"  >&lt;p&gt;We haven&apos;t seen this in a while.  I think we&apos;ve taken care of it and we should close this issue.&lt;/p&gt;</comment>
                            <comment id="13081297" author="posix4e" created="Mon, 8 Aug 2011 23:43:41 +0000"  >&lt;p&gt;agreed&lt;/p&gt;</comment>
                            <comment id="13081309" author="stack" created="Mon, 8 Aug 2011 23:57:58 +0000"  >&lt;p&gt;Resolving.  Think this is fixed.  Will open new issue if see it again.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 16 Dec 2010 06:51:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26794</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 19 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hluv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100803</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>