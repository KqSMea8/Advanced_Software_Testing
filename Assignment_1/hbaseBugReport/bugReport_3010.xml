<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:06:35 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3010/HBASE-3010.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3010] Can&apos;t start/stop/start... cluster using new master</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3010</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Currently you might start a small cluster the first time on TRUNK &amp;#8211; i.e. new master &amp;#8211; but second time you do the startup you run into a couple of interesting issues:&lt;/p&gt;

&lt;p&gt;+ The old root-region-location is still in place. It gets cleaned later but for a while on startup it does not have the &apos;right&apos; address.&lt;br/&gt;
+ Regionserver (or a client) on startup creates a catalogtracker, a class that notices changes in meta tables keeping up catalog table locations.  Starting the catalogtracker results in a check for current catalog locations.  As part of this process, since root-region-location &quot;exists&quot;, catalogtracker tries to verify root&apos;s location by doing a noop against root host, only, to do this it needs to do the initial rpc proxy setup.  It can so happen that the old root address was that of the current regionserver trying to initialize so we&apos;ll be trying to connect to ourself to verify root location ONLY, we&apos;re doing this before we&apos;ve setup the rpcserver and handlers &amp;#8211; so we block, and as it happens there is no timeout on proxy setup (Todd ran into this yesterday, I ran into it today &amp;#8211; its easy to manufacture).&lt;br/&gt;
+ So regionserver can&apos;t progress.  Meantime the master can&apos;t progress because there are no regionservers checking in.  And you can&apos;t shut it down because we&apos;re not looking at the right &apos;stop&apos; flag&lt;/p&gt;</description>
                <environment></environment>
        <key id="12474362">HBASE-3010</key>
            <summary>Can&apos;t start/stop/start... cluster using new master</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Sep 2010 08:06:47 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:07 +0000</updated>
                            <resolved>Sat, 18 Sep 2010 00:51:32 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12910509" author="hbasereviewboard" created="Fri, 17 Sep 2010 08:43:37 +0000"  >&lt;p&gt;Message from: stack@duboce.net&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/873/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/873/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Patch changes catalogtracker to not connect to root on start.  Instead, wait on kick from zk before going after root or meta.  This change doesn&apos;t address the case where a RS can get stuck on itself trying to connect to an RPC that is not yet running.  Rather it sidesteps (We should come back and do something about non-timeout when setting up proxy since its possible. I&apos;ll file an issue on it).  Patch includes other fixups, not all cosmetic.&lt;/p&gt;

&lt;p&gt;M src/test/java/org/apache/hadoop/hbase/master/TestActiveMasterManager.java&lt;br/&gt;
  Add a test for case where master comes up and up in zk the&lt;br/&gt;
  master znode contains our address&lt;br/&gt;
D src/test/java/org/apache/hadoop/hbase/master/TestMinimumServerCount.java&lt;br/&gt;
  Removed test of something we no longer do; wait on an explicit number&lt;br/&gt;
  of regions to come in before we&apos;ll go ahead w/ master startup.&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
  Swapped order in which we do some of the startup (Cosmetic)&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;br/&gt;
  Javadoc&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;br/&gt;
  Removed minimumServerCount.  Seems bad predicating master startup&lt;br/&gt;
  on N RS&apos;s coming in.&lt;br/&gt;
  Renamed method numServers as countOfRegionServers and made it protected.&lt;br/&gt;
  Removed other unused methods.&lt;br/&gt;
  Redid waitForMinServers as waitForRegionServers... where we just&lt;br/&gt;
  hang around until count of regionservers stabilizes.  TODO: improve&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/master/ActiveMasterManager.java&lt;br/&gt;
  Handle case where the current master znode has our address; in this&lt;br/&gt;
  case we can hurry up the expiration by deleting the znode.&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;br/&gt;
  Minor formatting&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
  Renamed clusterStarter as freshClusterStartup.  Predicate this boolean&lt;br/&gt;
  off the count of regionservers.  If 0, then fresh cluster start.  Else&lt;br/&gt;
  do special handling (TODO).&lt;br/&gt;
  Edit on HMaster constructor comments.&lt;br/&gt;
  Moved some code out of Master constructor into stackIfBackupMaster method&lt;br/&gt;
  If aborting set stop flag.&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java&lt;br/&gt;
  Removed unused imports.&lt;br/&gt;
M src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;br/&gt;
  Make catalogtracker lazy about getting metalocation....don&apos;t do it&lt;br/&gt;
  on start.&lt;/p&gt;


&lt;p&gt;This addresses bug hbase-3010.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/hbase-3010&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/hbase-3010&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java 2bcd5d0 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/ActiveMasterManager.java 87fe9cd &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java 690f78c &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMaster.java c1b80eb &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/HMasterCommandLine.java c675db9 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java 498650f &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/master/ServerManager.java 528bb9d &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1ec7f4e &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestActiveMasterManager.java 030bc12 &lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/master/TestMinimumServerCount.java d6f2c02 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/873/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/873/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Can now start/stop cluster repeatedly.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;stack&lt;/p&gt;

</comment>
                            <comment id="12910855" author="hbasereviewboard" created="Fri, 17 Sep 2010 23:47:20 +0000"  >&lt;p&gt;Message from: &quot;Todd Lipcon&quot; &amp;lt;todd@cloudera.com&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/873/#review1267&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/873/#review1267&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Ship it!&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/ActiveMasterManager.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/873/#comment4312&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/873/#comment4312&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    hrm, I guess that&apos;s a good idea, but something seems a little strange about this &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/873/#comment4313&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/873/#comment4313&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    this should probably move down until after we&apos;re the active master&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Todd&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12910878" author="stack" created="Sat, 18 Sep 2010 00:51:32 +0000"  >&lt;p&gt;Thanks for review Todd.  Committed.&lt;/p&gt;</comment>
                            <comment id="12910884" author="hbasereviewboard" created="Sat, 18 Sep 2010 01:06:47 +0000"  >&lt;p&gt;Message from: stack@duboce.net&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-09-17 16:25:15, Todd Lipcon wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/master/ActiveMasterManager.java, line 142&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/873/diff/1/?file=11929#file11929line142&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/873/diff/1/?file=11929#file11929line142&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     hrm, I guess that&apos;s a good idea, but something seems a little strange about this &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, this is a little &apos;bold&apos; but trying to think around it, i couldn&apos;t see issue w/ it, whereas not doing it is going to frustrate as restart will have this minute or so stall while we waiting on the znode expire.  I&apos;d say its good for now and I suppose we&apos;ll see later if it becomes a prop.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-09-17 16:25:15, Todd Lipcon wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/master/HMaster.java, line 222&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/873/diff/1/?file=11931#file11931line222&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/873/diff/1/?file=11931#file11931line222&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     this should probably move down until after we&apos;re the active master&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;sure... will do on commit.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;stack&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/873/#review1267&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/873/#review1267&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="15016889" author="lars_francke" created="Fri, 20 Nov 2015 12:41:07 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Sep 2010 08:43:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26588</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hkb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100552</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>