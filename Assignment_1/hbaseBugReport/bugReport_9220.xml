<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:02:29 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-9220/HBASE-9220.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-9220] An API(and shell command) to list tables replicated TO the current cluster </title>
                <link>https://issues.apache.org/jira/browse/HBASE-9220</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This JIRA to track the continuous discussion following &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8663&quot; title=&quot;a HBase Shell command to list the tables replicated from current cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8663&quot;&gt;&lt;del&gt;HBASE-8663&lt;/del&gt;&lt;/a&gt;, and hopefully surface a better way to handle the use case: &lt;/p&gt;

&lt;p&gt;an administrator or developer,  who has &apos;list table&apos; access to a cluster, would like to know which tables/families are replicated to the cluster(i.e slave). so that he/she won&apos;t mess things up.&lt;/p&gt;

&lt;p&gt;While &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8663&quot; title=&quot;a HBase Shell command to list the tables replicated from current cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8663&quot;&gt;&lt;del&gt;HBASE-8663&lt;/del&gt;&lt;/a&gt; covered the API to get the list of tables and families from current cluster(i.e Master). There is no conclusion on how to do the same for replicated tables TO the current cluster(i.e slave). Several ideas have been entertained during &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8663&quot; title=&quot;a HBase Shell command to list the tables replicated from current cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8663&quot;&gt;&lt;del&gt;HBASE-8663&lt;/del&gt;&lt;/a&gt;&apos;s discussion, and summarized here: &lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;b&gt;Idea 1&lt;/b&gt;: on Slave cluster, use a new String attribute REPLICATION_MASTER to HColumnDescriptor to indicate this column is replicated from it. A check can be added to ensure the value of REPLICATION_MASTER is valid at the same of set.
	&lt;ul&gt;
		&lt;li&gt;problem 1) a slave can have more than one master(a minor one);&lt;/li&gt;
		&lt;li&gt;problem 2) the consistency is broken if the Master cluster &apos;remove_peer&apos;(a major problem which request a synchronous call to the remote master/peer cluster)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;b&gt;Idea 2&lt;/b&gt;: reuse REPLICATION_SCOPE, and give a new meaning for value &apos;-1&apos;. If a table is replicated to this cluster, its REPLICATION_SCOPE must be set to -1 before a replication can occur
	&lt;ul&gt;
		&lt;li&gt;problem 1) incompatible change. Currently the slave side table will look just like normal tables, the new change will request use to explicitly flag REPLICATION_SCOPE = -1&lt;/li&gt;
		&lt;li&gt;problem 2) incompatible change. Currently any none-zero value of REPLICATION_SCOPE will be treated as if its value of 1(global replication). the change will impact the existing tables&lt;/li&gt;
		&lt;li&gt;problem 3) value &apos;-1&apos; only tell user that the table is replicated to current cluster, won&apos;t be able to indicate the source/Master cluster&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;b&gt;Idea 3&lt;/b&gt;:  invent a new HColumnDescriptor attribute &apos;replication_peers&apos;, an array of ID. We can use positive ID for target-cluster, and negative ID for source-cluster, for example
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hbase(main):004:0&amp;gt; list_peers
 PEER_ID CLUSTER_KEY STATE
 1 Slave_A.hbase.com:2181:/hbase ENABLED
 2 Slave_B.hbase.com:2181:/hbase ENABLED
 3 Slave_Master_C.hbase.com:2181:/hbase ENABLED
-1 Master_A.hbase.com:2181:/hbase ENABLED
-2 Master_B.hbase.com:2181:/hbase ENABLED
-3 Slave_Master_C.hbase.com:2181:/hbase ENABLED
&amp;gt;describe table
&apos;t1_dn&apos;, {NAME =&amp;gt; &apos;cf1&apos;, REPLICATION_PEERS =&amp;gt; &apos;1,2,3&apos;, ..}
&apos;t2_dn&apos;, {NAME =&amp;gt; &apos;cf1&apos;, REPLICATION_PEERS =&amp;gt; &apos;-1,-2&apos;,..}
&apos;t3_dn&apos;, {NAME =&amp;gt; &apos;cf1&apos;, REPLICATION_PEERS =&amp;gt; &apos;3,-3&apos;,..}

t1_dn#cf1 is replicated from &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; cluster, and its slave clusters are Slave_A,Slave_B and Slave_Master_C
t2_dn#cf1 is replicated to &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; cluster, and its master clusters are Master_A and Master_B
t3_dn#cf1 is setup as Master_Slave replication, with Slave_Master_C.hbase.com(&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; don&apos;t have to be the same cluster) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
	&lt;ul&gt;
		&lt;li&gt;problem: similar as idea 1, and an improved version. A synchronous call can be implemented through the peer ID&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;b&gt;Idea 4&lt;/b&gt;: Replication central controller that resides outside of all the clusters. The controller will communicate with all clusters and keep info consistent, which can be a very good operational manager for users who have 10+ clusters to oversee, and other features(such as backup/restore) can leverage the framework
	&lt;ul&gt;
		&lt;li&gt;problem: well, not really a problem per se, except the effort for the whole solution is pretty large and need some clean up work. For example, currently &apos;add_peer&apos; doesn&apos;t check the value, and we need to fix that first; and replication setup rely on manually create table on peer slave, we may like to ensure the same schema and do it automatically from Master cluster.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;clusters setup as Master and Slave for replication of tables&lt;/p&gt;</environment>
        <key id="12663735">HBASE-9220</key>
            <summary>An API(and shell command) to list tables replicated TO the current cluster </summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nidmhbase">Demai Ni</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Aug 2013 21:28:35 +0000</created>
                <updated>Wed, 14 Aug 2013 21:28:35 +0000</updated>
                                                                            <component>Replication</component>
                    <component>shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343736</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 18 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1na13:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>344038</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>replication</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>