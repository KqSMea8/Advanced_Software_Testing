<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:07:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3082/HBASE-3082.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3082] For ICV gets, first look in MemStore before reading StoreFiles</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3082</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;For incrementColumnValue operations, it is possible to check MemStore for the column being incremented without sacrificing correctness.  If the column is not found in MemStore, we would then have to do a normal Get that opens/checks all StoreFiles for the given Store.&lt;/p&gt;

&lt;p&gt;In practice, this makes increment operations significantly faster for recently/frequently incremented columns.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12475882">HBASE-3082</key>
            <summary>For ICV gets, first look in MemStore before reading StoreFiles</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="khemani">Prakash Khemani</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Oct 2010 19:26:36 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:41 +0000</updated>
                            <resolved>Sun, 24 Oct 2010 22:37:45 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12918128" author="ryanobjc" created="Tue, 5 Oct 2010 19:29:56 +0000"  >&lt;p&gt;with mixed puts and ICVs this gets tricky.&lt;/p&gt;

&lt;p&gt;how to do w/o a different read path piece of code?&lt;/p&gt;</comment>
                            <comment id="12918132" author="streamy" created="Tue, 5 Oct 2010 19:35:34 +0000"  >&lt;p&gt;The easy was is to add a flag to get which will first only open the scanner against the memstore/snapshot, and then if not found, open the scanner again across everything.&lt;/p&gt;

&lt;p&gt;The harder way would be to reintroduce the Get code we ripped out (hoping not to do this).&lt;/p&gt;

&lt;p&gt;The first way has been implemented by Prakash and we saw big gains from it.&lt;/p&gt;

&lt;p&gt;Can you explain more what you mean by mixed puts/ICVs?  Would those be mixed on the same column?&lt;/p&gt;</comment>
                            <comment id="12923086" author="hbasereviewboard" created="Wed, 20 Oct 2010 18:48:17 +0000"  >&lt;p&gt;Message from: thekhemani@facebook.com&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1053/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase and Jonathan Gray.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Ensure that during incrementColumnValue() the scan triggered by the get() does an early exit if it finds the KV in the memstore.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3082&quot; title=&quot;For ICV gets, first look in MemStore before reading StoreFiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3082&quot;&gt;&lt;del&gt;HBASE-3082&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3082&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3082&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/regionserver/ControlledScan.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 0e3940c &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java 4775fc8 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/1053/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I have been testing it on my cluster. No unit testing yet.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;khemani&lt;/p&gt;

</comment>
                            <comment id="12923097" author="hbasereviewboard" created="Wed, 20 Oct 2010 19:00:41 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1053/#review1585&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#review1585&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/ControlledScan.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5382&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5382&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Need to add apache licenses&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/ControlledScan.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5383&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5383&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Maybe a little more description here.  Like, why do we need this.&lt;/p&gt;

&lt;p&gt;    Also, is ControlledScan the best name for this class?  Not clear to me that this is &quot;controlled&quot; and thus the other scans are &quot;uncontrolled&quot;?&lt;/p&gt;

&lt;p&gt;    If this was to be used for more later and even for this use, it&apos;s really additional configuration/options for Scans.  So is an InternalScan or ModifiedScan?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/ControlledScan.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5385&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5385&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Rather than these two public booleans, we should have getters/setters.&lt;/p&gt;

&lt;p&gt;    And even rather than just straight set/get on each boolean, these two booleans are usually one or the other, right?  So I think it would be better to hide implementation detail and instead expose methods like setMemStoreOnly() and setFilesOnly() which would deal with the two booleans appropriately.  Then you&apos;d have get methods like checkMemStore() and checkFiles() or something like that.&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/ControlledScan.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5384&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5384&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Whitespace&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5386&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5386&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Need to cleanup whitespace here.&lt;/p&gt;

&lt;p&gt;    Maybe a little bit of javadoc for get_last_increment which describes what this does (and why it&apos;s still &quot;correct&quot; for increments)&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jonathan&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12923132" author="hbasereviewboard" created="Wed, 20 Oct 2010 19:54:17 +0000"  >&lt;p&gt;Message from: &quot;Benoit Sigoure&quot; &amp;lt;tsunanet@gmail.com&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1053/#review1586&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#review1586&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Just some minor comments.&lt;/p&gt;


&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/ControlledScan.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5387&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5387&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This class doesn&apos;t need to be public, make it package-private.&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5389&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5389&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    The style used in HBase mandates that this method be named getLastIncrement.&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5388&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5388&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    A `//&apos;-style comment would be better here&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5390&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5390&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    use if (!results.isEmpty())&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5391&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5391&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Instead of two nested `if&apos;, you could combine both conditions with `&amp;amp;&amp;amp;&apos;&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Benoit&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12923314" author="hbasereviewboard" created="Thu, 21 Oct 2010 04:32:10 +0000"  >&lt;p&gt;Message from: thekhemani@facebook.com&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1053/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-10-20 21:31:17.831889)&lt;/p&gt;


&lt;p&gt;Review request for hbase and Jonathan Gray.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I think I have taken care of all the review feedback&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Ensure that during incrementColumnValue() the scan triggered by the get() does an early exit if it finds the KV in the memstore.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3082&quot; title=&quot;For ICV gets, first look in MemStore before reading StoreFiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3082&quot;&gt;&lt;del&gt;HBASE-3082&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3082&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3082&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 0e3940c &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/InternalScan.java PRE-CREATION &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java 4775fc8 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/1053/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;I have been testing it on my cluster. No unit testing yet.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;khemani&lt;/p&gt;

</comment>
                            <comment id="12923317" author="hbasereviewboard" created="Thu, 21 Oct 2010 04:42:10 +0000"  >&lt;p&gt;Message from: &quot;Ryan Rawson&quot; &amp;lt;ryanobjc@gmail.com&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1053/#review1596&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#review1596&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/InternalScan.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5396&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5396&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why not put these into the base class?  Why create an entirely new class just to hold these?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/#comment5397&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#comment5397&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Would this code be cleaner if we didnt have to use instanceof?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ryan&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12923319" author="hbasereviewboard" created="Thu, 21 Oct 2010 04:52:15 +0000"  >&lt;p&gt;Message from: thekhemani@facebook.com&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-20 21:41:23, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/regionserver/InternalScan.java, line 45&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/diff/2/?file=15062#file15062line45&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/diff/2/?file=15062#file15062line45&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Why not put these into the base class?  Why create an entirely new class just to hold these?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It is not added to the base class so as not to alter the public Scan API.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-20 21:41:23, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java, line 155&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/diff/2/?file=15063#file15063line155&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/diff/2/?file=15063#file15063line155&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Would this code be cleaner if we didnt have to use instanceof?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;yes, i agree it will be cleaner w/o instanceof. But in that case we will have to pass the flags all the way from HRegion to StoreScanner. A number of signatures will have to change.&lt;/p&gt;

&lt;p&gt;Another approach could be to only instantiate InternalScan in the server side. But again that is quite a bit of code change.&lt;/p&gt;

&lt;p&gt;Having an internal-scan should be useful. After all, a scan touches a lot of data and certain other tasks can potentially be piggybacked on a scan.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;khemani&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1053/#review1596&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#review1596&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="12924069" author="hbasereviewboard" created="Fri, 22 Oct 2010 22:45:05 +0000"  >&lt;p&gt;Message from: &quot;Ryan Rawson&quot; &amp;lt;ryanobjc@gmail.com&amp;gt;&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-20 21:41:23, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java, line 155&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1053/diff/2/?file=15063#file15063line155&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/diff/2/?file=15063#file15063line155&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Would this code be cleaner if we didnt have to use instanceof?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;khemani wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;yes, i agree it will be cleaner w/o instanceof. But in that case we will have to pass the flags all the way from HRegion to StoreScanner. A number of signatures will have to change.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Another approach could be to only instantiate InternalScan in the server side. But again that is quite a bit of code change.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Having an internal-scan should be useful. After all, a scan touches a lot of data and certain other tasks can potentially be piggybacked on a scan.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;ok that makes sense. let&apos;s go with it then.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ryan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1053/#review1596&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#review1596&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="12924073" author="hbasereviewboard" created="Fri, 22 Oct 2010 23:11:14 +0000"  >&lt;p&gt;Message from: &quot;Ryan Rawson&quot; &amp;lt;ryanobjc@gmail.com&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1053/#review1626&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1053/#review1626&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Ship it!&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ryan&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12924074" author="streamy" created="Fri, 22 Oct 2010 23:12:02 +0000"  >&lt;p&gt;I will commit this in a bit, got a little bit of cleanup on the comments.&lt;/p&gt;</comment>
                            <comment id="12924392" author="streamy" created="Sun, 24 Oct 2010 22:30:00 +0000"  >&lt;p&gt;Patch being committed.  This patch is from Prakash and reviewed/approved by Ryan.&lt;/p&gt;

&lt;p&gt;I cleaned up some of the comments and lines &amp;gt;80 and also one minor change from patch up on RB.  I&apos;m also working on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2946&quot; title=&quot;Increment multiple columns in a row at once&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2946&quot;&gt;&lt;del&gt;HBASE-2946&lt;/del&gt;&lt;/a&gt; right now and changed the getLastIncrement() method to support multiple columns rather than just one.&lt;/p&gt;</comment>
                            <comment id="12924394" author="streamy" created="Sun, 24 Oct 2010 22:37:45 +0000"  >&lt;p&gt;Extra change to pom.xml in the patch but was not committed.&lt;/p&gt;

&lt;p&gt;This has been committed to trunk.  Thanks Prakash, great work!&lt;/p&gt;</comment>
                            <comment id="13252712" author="hudson" created="Thu, 12 Apr 2012 18:40:37 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2746 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2746/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2746/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3443&quot; title=&quot;ICV optimization to look in memstore first and then store files (HBASE-3082) does not work when deletes are in the mix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3443&quot;&gt;&lt;del&gt;HBASE-3443&lt;/del&gt;&lt;/a&gt; ICV optimization to look in memstore first and then store files (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3082&quot; title=&quot;For ICV gets, first look in MemStore before reading StoreFiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3082&quot;&gt;&lt;del&gt;HBASE-3082&lt;/del&gt;&lt;/a&gt;) does not work when deletes are in the mix (Revision 1325406)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13252814" author="hudson" created="Thu, 12 Apr 2012 20:46:06 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #107 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/107/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/107/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3443&quot; title=&quot;ICV optimization to look in memstore first and then store files (HBASE-3082) does not work when deletes are in the mix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3443&quot;&gt;&lt;del&gt;HBASE-3443&lt;/del&gt;&lt;/a&gt; ICV optimization to look in memstore first and then store files (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3082&quot; title=&quot;For ICV gets, first look in MemStore before reading StoreFiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3082&quot;&gt;&lt;del&gt;HBASE-3082&lt;/del&gt;&lt;/a&gt;) does not work when deletes are in the mix (Revision 1325453)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13253145" author="hudson" created="Fri, 13 Apr 2012 05:54:54 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #169 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/169/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/169/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3443&quot; title=&quot;ICV optimization to look in memstore first and then store files (HBASE-3082) does not work when deletes are in the mix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3443&quot;&gt;&lt;del&gt;HBASE-3443&lt;/del&gt;&lt;/a&gt; ICV optimization to look in memstore first and then store files (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3082&quot; title=&quot;For ICV gets, first look in MemStore before reading StoreFiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3082&quot;&gt;&lt;del&gt;HBASE-3082&lt;/del&gt;&lt;/a&gt;) does not work when deletes are in the mix (Revision 1325406)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13253632" author="hudson" created="Fri, 13 Apr 2012 18:32:53 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #9 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/9/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/9/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3443&quot; title=&quot;ICV optimization to look in memstore first and then store files (HBASE-3082) does not work when deletes are in the mix&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3443&quot;&gt;&lt;del&gt;HBASE-3443&lt;/del&gt;&lt;/a&gt; ICV optimization to look in memstore first and then store files (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3082&quot; title=&quot;For ICV gets, first look in MemStore before reading StoreFiles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3082&quot;&gt;&lt;del&gt;HBASE-3082&lt;/del&gt;&lt;/a&gt;) does not work when deletes are in the mix (Revision 1325453)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/client/TestFromClientSide.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15017043" author="lars_francke" created="Fri, 20 Nov 2015 12:41:41 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12473267">HBASE-2959</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12495555">HBASE-3443</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12457943" name="HBASE-3082-FINAL.patch" size="9210" author="streamy" created="Sun, 24 Oct 2010 22:30:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 5 Oct 2010 19:29:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32895</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hknb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100607</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>