<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:06:53 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-9712/HBASE-9712.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-9712] TestSplitLogManager still fails on occasion</title>
                <link>https://issues.apache.org/jira/browse/HBASE-9712</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Opening this issue to keep account of failures.  It failed for me locally just now.&lt;/p&gt;

&lt;p&gt;Failed tests:   testTaskResigned(org.apache.hadoop.hbase.master.TestSplitLogManager): version1=2, version=2&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
durruti:hbase stack$ more hbase-server/target/surefire-reports/org.apache.hadoop.hbase.master.TestSplitLogManager.txt
-------------------------------------------------------------------------------
Test set: org.apache.hadoop.hbase.master.TestSplitLogManager
-------------------------------------------------------------------------------
Tests run: 14, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 86.697 sec &amp;lt;&amp;lt;&amp;lt; FAILURE!
testTaskResigned(org.apache.hadoop.hbase.master.TestSplitLogManager)  Time elapsed: 0.004 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!
java.lang.AssertionError: version1=2, version=2
        at org.junit.Assert.fail(Assert.java:88)
        at org.junit.Assert.assertTrue(Assert.java:41)
        at org.apache.hadoop.hbase.master.TestSplitLogManager.testTaskResigned(TestSplitLogManager.java:387)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
        at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
        at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
        at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
        at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
        at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
        at org.junit.runners.Suite.runChild(Suite.java:127)
        at org.junit.runners.Suite.runChild(Suite.java:26)
        at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:680)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let me attach the log&lt;/p&gt;</description>
                <environment></environment>
        <key id="12672418">HBASE-9712</key>
            <summary>TestSplitLogManager still fails on occasion</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Oct 2013 22:06:52 +0000</created>
                <updated>Wed, 29 Oct 2014 21:30:40 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13787464" author="stack" created="Sun, 6 Oct 2013 03:21:51 +0000"  >&lt;p&gt;Log of failed test&lt;/p&gt;</comment>
                            <comment id="14188966" author="dimaspivak" created="Wed, 29 Oct 2014 20:44:32 +0000"  >&lt;p&gt;This is hitting a lot of builds on &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/lastSuccessfulBuild/testReport/org.apache.hadoop.hbase.master/TestSplitLogManager/history/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;HBase-0.98&lt;/a&gt; but not &lt;a href=&quot;https://builds.apache.org/job/HBase-1.0/lastSuccessfulBuild/testReport/org.apache.hadoop.hbase.master/TestSplitLogManager/history/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;HBase-1.0&lt;/a&gt; or &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/lastSuccessfulBuild/testReport/org.apache.hadoop.hbase.master/TestSplitLogManager/history/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;HBase-TRUNK&lt;/a&gt;. Mind if I pick this one up, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14189035" author="dimaspivak" created="Wed, 29 Oct 2014 21:30:40 +0000"  >&lt;p&gt;Some more debugging: all recent failures are caused by testLogFilesAreArchived (compare failure history of &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/lastSuccessfulBuild/testReport/junit/org.apache.hadoop.hbase.master/TestSplitLogManager/testLogFilesAreArchived/history/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;testLogFilesAreArchived&lt;/a&gt; and &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/lastSuccessfulBuild/testReport/org.apache.hadoop.hbase.master/TestSplitLogManager/history/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;TestSplitLogManager itself&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Test output from a failed run suggests this may be legit. &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/635/artifact/hbase-server/target/surefire-reports/org.apache.hadoop.hbase.master.TestSplitLogManager-output.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Some output from a failed run&lt;/a&gt; suggests that things start going south after WAL splitting begins:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-10-29 02:45:30,670 DEBUG [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-27] master.SplitLogManager(323): Scheduling batch of logs to split
2014-10-29 02:45:30,670 INFO  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-27] master.SplitLogManager(325): started splitting 1 logs in [/home/jenkins/jenkins-slave/workspace/HBase-0.98/hbase-server/target/test-data/5d71199c-6df9-4aa6-800f-9634b546ecef/testLogFilesAreArchived/595bcd1c-d510-464c-8207-33e8580aee96]
2014-10-29 02:45:30,672 WARN  [&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-31] master.TestSplitLogManager$5(527): org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /hbase/splitWAL/595bcd1c-d510-464c-8207-33e8580aee96%2Ffoo%2C1%2C1
2014-10-29 02:45:30,672 DEBUG [pool-1-thread-1-EventThread] master.SplitLogManager(703): put up splitlog task at znode /hbase/splitWAL/595bcd1c-d510-464c-8207-33e8580aee96%2Ffoo%2C1%2C1
2014-10-29 02:45:30,674 DEBUG [pool-1-thread-1-EventThread] master.SplitLogManager(745): task not yet acquired /hbase/splitWAL/595bcd1c-d510-464c-8207-33e8580aee96%2Ffoo%2C1%2C1 ver = 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For splits that occur successfully, the task is acquired quickly and completed within a few tens of milliseconds. For unsuccessful runs, the unassigned task looks to be resubmitted repeatedly by splitLogManagerTimeoutMonitor, but while tasks like /hbase/splitWAL/RESCAN0000000001 enter into a DONE state, the splitlog one never does and times out after 60 s. Can someone more familiar with the SplitLogManager is doing here chime in?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12607048" name="org.apache.hadoop.hbase.master.TestSplitLogManager-output (1).txt" size="171544" author="stack" created="Sun, 6 Oct 2013 03:21:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 29 Oct 2014 20:44:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>352045</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 7 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1op3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>352333</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>