<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:16:35 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4177/HBASE-4177.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4177] Handling read failures during recovery&#8207; - when HMaster calls Namenode recovery, recovery may be a failure leading to read failure while splitting logs</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4177</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;As per the mailing thread with the heading&lt;br/&gt;
&apos;Handling read failures during recovery&#8207;&apos; we found this problem.&lt;br/&gt;
As part of split Logs the HMaster calls Namenode recovery.  The recovery is an asynchronous process. &lt;br/&gt;
In HDFS&lt;br/&gt;
=======&lt;br/&gt;
Even though client is getting the updated block info from Namenode on first&lt;br/&gt;
read failure, client is discarding the new info and using the old info only&lt;br/&gt;
to retrieve the data from datanode. So, all the read&lt;br/&gt;
retries are failing. [Method parameter reassignment - Not reflected in&lt;br/&gt;
caller]. &lt;br/&gt;
In HBASE&lt;br/&gt;
=======&lt;br/&gt;
In HMaster code we tend to wait for  1sec.  But if the recovery had some failure then split log may not happen and may lead to dataloss.&lt;br/&gt;
So may be we need to decide upon the actual delay that needs to be introduced once Hmaster calls NN recovery.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12518226">HBASE-4177</key>
            <summary>Handling read failures during recovery&#8207; - when HMaster calls Namenode recovery, recovery may be a failure leading to read failure while splitting logs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ram_krish">ramkrishna.s.vasudevan</assignee>
                                    <reporter username="ram_krish">ramkrishna.s.vasudevan</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Aug 2011 17:49:33 +0000</created>
                <updated>Mon, 23 Sep 2013 19:08:20 +0000</updated>
                            <resolved>Tue, 25 Jun 2013 10:52:51 +0000</resolved>
                                                    <fixVersion>0.95.1</fixVersion>
                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13081098" author="yuzhihong@gmail.com" created="Mon, 8 Aug 2011 18:14:16 +0000"  >&lt;p&gt;Looking at FSUtils.recoverFileLease(), we check the type of fs inside while loop. This is unnecessary.&lt;/p&gt;

&lt;p&gt;w.r.t. soft limit for the lease, we have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (waitedFor &amp;gt; FSConstants.LEASE_SOFTLIMIT_PERIOD) {
            LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Waited &quot;&lt;/span&gt; + waitedFor + &lt;span class=&quot;code-quote&quot;&gt;&quot;ms &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; lease recovery on &quot;&lt;/span&gt; + p +
              &lt;span class=&quot;code-quote&quot;&gt;&quot;:&quot;&lt;/span&gt; + e.getMessage());
          }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think we should wait for the remainder of soft limit (which is 60 seconds).&lt;/p&gt;</comment>
                            <comment id="13092981" author="stack" created="Mon, 29 Aug 2011 17:16:30 +0000"  >&lt;p&gt;I created &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-2296&quot; title=&quot;If read error while lease is being recovered, client reverts to stale view on block info&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-2296&quot;&gt;HDFS-2296&lt;/a&gt; at Hairong&apos;s suggestion.&lt;/p&gt;</comment>
                            <comment id="13093003" author="ram_krish" created="Mon, 29 Aug 2011 17:46:29 +0000"  >&lt;p&gt;@Stack&lt;br/&gt;
Thanks for tracking this and raising an issue for the same in HDFS.&lt;/p&gt;</comment>
                            <comment id="13199033" author="ram_krish" created="Thu, 2 Feb 2012 17:59:23 +0000"  >&lt;p&gt;Any suggestions on this.  We tend to run into this problem every now and then.&lt;/p&gt;</comment>
                            <comment id="13440578" author="lhofhansl" created="Thu, 23 Aug 2012 19:26:18 +0000"  >&lt;p&gt;That is superseded by all of N&apos;s work, correct?&lt;/p&gt;</comment>
                            <comment id="13440652" author="nkeywal" created="Thu, 23 Aug 2012 20:56:50 +0000"  >&lt;p&gt;hum, it&apos;s really closed to what I&apos;ve done, but this problem may still be there. Ram, what do you think? If you don&apos;t have the time, I can give it a try.&lt;/p&gt;</comment>
                            <comment id="13440919" author="ram_krish" created="Fri, 24 Aug 2012 03:48:33 +0000"  >&lt;p&gt;@N&lt;br/&gt;
I too think the problem is still there.  But internally here also we have not started working on this yet.  At that time we had discussions that HDFS side also we need some changes and Stack has already raised the same in HDFS JIRA.  Surely you can take a stab at it N.&lt;/p&gt;</comment>
                            <comment id="13692928" author="nkeywal" created="Tue, 25 Jun 2013 10:52:51 +0000"  >&lt;p&gt;To me, this was fixed when we made the recoverLease synchronous. Please reopen if I&apos;m wrong.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12551766">HBASE-5843</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Aug 2011 18:14:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27205</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 25 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02bv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11523</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>