<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:23:57 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5010/HBASE-5010.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5010] Filter HFiles based on TTL</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5010</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In ScanWildcardColumnTracker we have&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 
  &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.oldestStamp = EnvironmentEdgeManager.currentTimeMillis() - ttl;

  ...

  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isExpired(&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; timestamp) {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; timestamp &amp;lt; oldestStamp;
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but this time range filtering does not participate in HFile selection. In one real case this caused next() calls to time out because all KVs in a table got expired, but next() had to iterate over the whole table to find that out. We should be able to filter out those HFiles right away. I think a reasonable approach is to add a &quot;default timerange filter&quot; to every scan for a CF with a finite TTL and utilize existing filtering in StoreFile.Reader.passesTimerangeFilter.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12534821">HBASE-5010</key>
            <summary>Filter HFiles based on TTL</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikhail">Mikhail Bautin</assignee>
                                    <reporter username="mikhail">Mikhail Bautin</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Dec 2011 19:09:06 +0000</created>
                <updated>Fri, 12 Oct 2012 05:34:49 +0000</updated>
                            <resolved>Fri, 27 Jan 2012 02:07:06 +0000</resolved>
                                                    <fixVersion>0.94.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13171737" author="phabricator@reviews.facebook.net" created="Sun, 18 Dec 2011 01:19:30 +0000"  >&lt;p&gt;mbautin requested code review of &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, JIRA&lt;/p&gt;

&lt;p&gt;  Modifying scanner selection in StoreScanner to take TTL into account, so that we don&apos;t scan StoreFiles that only contain expired keys.&lt;/p&gt;

&lt;p&gt;  This diff is for 89-fb, but there will be a very similar diff for trunk.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  Unit tests (existing ones and a new one).&lt;br/&gt;
  Deploy to cluster and scan an existing table that only contains expired keys. Verify that next() calls don&apos;t time out. Previously, the scanner would try to go through the whole table in an attempt to find a non-expired key.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Threads.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestSelectScannersUsingTTL.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/1911/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/1911/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13174574" author="phabricator@reviews.facebook.net" created="Thu, 22 Dec 2011 02:27:30 +0000"  >&lt;p&gt;Kannan has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  Mikhail: Nice work, and unit test. Compaction related comment inline.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:133 pre-existing issue: this constructor is no longer just for major compactions. Minor compactions also use this.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:154 If we do a similar check in this constructor, we would get the same optimization for compactions also.&lt;/p&gt;

&lt;p&gt;  As we talked about offline, if the entire file has expired data, then we can avoid adding the scanner to  the KeyValueHeap below. So for CFs which have routinely expiring data due to TTL, compactions would have to read a lot less data too or could essentially turn into feather-weight ops which just delete unnecessary/old files.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13174973" author="phabricator@reviews.facebook.net" created="Thu, 22 Dec 2011 19:03:30 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  Nice work.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java:80 oldestUnexpiredTS is missing after @param&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:149 This change makes the line over 80 chars.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:169 Line too long.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13175244" author="phabricator@reviews.facebook.net" created="Fri, 23 Dec 2011 02:59:30 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, JIRA&lt;/p&gt;

&lt;p&gt;  Addressing Kannan&apos;s and Ted&apos;s comments.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Threads.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestSelectScannersUsingTTL.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;/p&gt;</comment>
                            <comment id="13175575" author="phabricator@reviews.facebook.net" created="Fri, 23 Dec 2011 20:42:30 +0000"  >&lt;p&gt;lhofhansl has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  lgtm&lt;br/&gt;
  See minor comment inline.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java:832 Rather than making this public, should locate the TestClass in same package and this &quot;package private&quot;. That would reduce the change of anybody accidentally using it.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13175857" author="phabricator@reviews.facebook.net" created="Sun, 25 Dec 2011 23:36:30 +0000"  >&lt;p&gt;mbautin requested code review of &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, tedyu, JIRA&lt;/p&gt;

&lt;p&gt;  This is the trunk version of D909. The main difference is that there is a minVersions CF setting in trunk, and when minVersions is not zero, we can&apos;t exclude StoreFiles based on TTL, because we might have to retrieve KVs with expired timestamps to comply with the minVersions requirement.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  Unit tests (including a new one).&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1017&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1017&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ExplicitColumnTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanWildcardColumnTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompaction.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestExplicitColumnTracker.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMinVersions.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanWildcardColumnTracker.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestSelectScannersUsingTTL.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreScanner.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/2127/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/2127/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13175859" author="phabricator@reviews.facebook.net" created="Sun, 25 Dec 2011 23:48:30 +0000"  >&lt;p&gt;tedyu has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  Looks good.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java:1207 Should we mention oldestUnexpiredTS here ?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1017&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1017&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13175860" author="hadoopqa" created="Sun, 25 Dec 2011 23:51:51 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12508613/D1017.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12508613/D1017.1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 29 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/598//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/598//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13175861" author="lhofhansl" created="Sun, 25 Dec 2011 23:54:30 +0000"  >&lt;p&gt;MinVersions is my doing. I&apos;ll take a look as soon as I get a chance. &lt;/p&gt;

</comment>
                            <comment id="13175883" author="phabricator@reviews.facebook.net" created="Mon, 26 Dec 2011 04:14:30 +0000"  >&lt;p&gt;lhofhansl has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  Looks pretty good. See minor comments inline.&lt;br/&gt;
  minVersions handling looks correct to me.&lt;/p&gt;

&lt;p&gt;  I think we should call out somewhere that this optimization cannot be used with MIN_VERSIONS enabled, along with some guess for the typical performance penalty.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java:737 As said in my 0.90 review, this is better package private with the test class in the same package.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ExplicitColumnTracker.java:74 Javadoc for oldestUnexpiredTS is missing.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java:134 Javadoc for oldestUnexpiredTS&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1017&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1017&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13175929" author="phabricator@reviews.facebook.net" created="Mon, 26 Dec 2011 11:58:30 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, tedyu, JIRA&lt;/p&gt;

&lt;p&gt;  Addressing Ted&apos;s comment and getting rid of unused ttl parameters in a couple of places.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1017&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1017&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ExplicitColumnTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanWildcardColumnTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompaction.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestExplicitColumnTracker.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMinVersions.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestScanWildcardColumnTracker.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestSelectScannersUsingTTL.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreScanner.java&lt;/p&gt;</comment>
                            <comment id="13175955" author="zhihyu@ebaysf.com" created="Mon, 26 Dec 2011 16:03:17 +0000"  >&lt;p&gt;Moved the new test to src/test/java/org/apache/hadoop/hbase/io/hfile/TestScannerSelectionUsingTTL.java&lt;/p&gt;

&lt;p&gt;Added javadoc for oldestUnexpiredTS&lt;/p&gt;

&lt;p&gt;Added test category for TestScannerSelectionUsingTTL&lt;/p&gt;</comment>
                            <comment id="13175961" author="hadoopqa" created="Mon, 26 Dec 2011 16:15:57 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12508628/5010.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12508628/5010.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 30 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -151 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 77 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/600//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/600//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/600//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/600//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/600//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/600//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13175964" author="zhihyu@ebaysf.com" created="Mon, 26 Dec 2011 16:20:11 +0000"  >&lt;p&gt;Fix compilation error in TestScannerSelectionUsingTTL&lt;/p&gt;</comment>
                            <comment id="13175986" author="hadoopqa" created="Mon, 26 Dec 2011 18:20:51 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12508631/5010.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12508631/5010.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 30 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -151 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 77 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;     -1 core tests.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.mapred.TestTableMapReduce&lt;br/&gt;
                  org.apache.hadoop.hbase.mapreduce.TestHFileOutputFormat&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/601//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/601//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/601//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/601//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/601//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/601//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13176001" author="zhihyu@ebaysf.com" created="Mon, 26 Dec 2011 19:37:45 +0000"  >&lt;p&gt;Test failures reported by Hadoop QA were due to NumberFormatException&lt;/p&gt;

&lt;p&gt;Patch integrated to TRUNK.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Mikhail.&lt;/p&gt;

&lt;p&gt;Thanks for the review Lars.&lt;/p&gt;

&lt;p&gt;I tried applying 5010.patch to 0.92 but got some rejected changes.&lt;/p&gt;</comment>
                            <comment id="13176023" author="hudson" created="Mon, 26 Dec 2011 21:45:45 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2579 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2579/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2579/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL - add TestScannerSelectionUsingTTL&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL (Mikhail)&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestScannerSelectionUsingTTL.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/ExplicitColumnTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/ScanWildcardColumnTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompaction.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestExplicitColumnTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestMinVersions.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestScanWildcardColumnTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreScanner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13176024" author="mikhail" created="Mon, 26 Dec 2011 21:47:01 +0000"  >&lt;p&gt;@Ted: thanks for taking care of the patch! A couple of questions:&lt;br/&gt;
(1) Do you know why these spurious NumberFormatExceptions occur? Has this happened before?&lt;br/&gt;
(2) Do you think we need this optimization in 0.92?&lt;/p&gt;

&lt;p&gt;@Lars: thanks for the review!&lt;/p&gt;</comment>
                            <comment id="13176029" author="lhofhansl" created="Mon, 26 Dec 2011 22:06:32 +0000"  >&lt;p&gt;We have a bunch of other optimizations in 0.94 only. I think this should be 0.94 only as well.&lt;/p&gt;</comment>
                            <comment id="13176031" author="zhihyu@ebaysf.com" created="Mon, 26 Dec 2011 22:09:42 +0000"  >&lt;p&gt;The exception was Due to mapreduce-3583&lt;/p&gt;</comment>
                            <comment id="13176033" author="phabricator@reviews.facebook.net" created="Mon, 26 Dec 2011 22:12:30 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  Lars: replying to your comments inline. I started addressing them but Ted addressed some of them and committed the patch first &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Not sure if anything was done about emphasizing the incompatibility of this fix with MIN_VERSIONS, though. At least, this fix does not make things worse if MIN_VERSIONS is nonzero. A performance penalty could only be incurred when there are entire HFiles consisting of expired entries and MIN_VERSIONS is nonzero.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java:737 Done.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ExplicitColumnTracker.java:74 Done.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java:134 Done.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1017&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1017&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13176035" author="phabricator@reviews.facebook.net" created="Mon, 26 Dec 2011 22:20:30 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, JIRA&lt;/p&gt;

&lt;p&gt;  Addressing Lars&apos;s comment.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Threads.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestScannerSelectionUsingTTL.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;/p&gt;</comment>
                            <comment id="13176039" author="hadoopqa" created="Mon, 26 Dec 2011 22:37:23 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12508643/D909.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12508643/D909.3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 17 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/603//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/603//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13176043" author="phabricator@reviews.facebook.net" created="Mon, 26 Dec 2011 23:00:30 +0000"  >&lt;p&gt;mbautin has abandoned the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  This was committed into trunk by @tedyu, closing the revision.&lt;/p&gt;

&lt;p&gt;  @tedyu: could you please include a line of the form &quot;Differential Revision: D1017&quot; in commit messages in the future? That way the revision could be automatically marked as &quot;committed&quot; in Phabricator.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1017&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1017&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13176072" author="phabricator@reviews.facebook.net" created="Tue, 27 Dec 2011 03:20:31 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  See some replies to comments inline.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:133 Removed the line about major compactions.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:149 Fixed.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java:80 Fixed.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13176105" author="hudson" created="Tue, 27 Dec 2011 07:17:16 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #49 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/49/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/49/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL - add TestScannerSelectionUsingTTL&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Filter HFiles based on TTL (Mikhail)&lt;/p&gt;

&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/io/hfile/TestScannerSelectionUsingTTL.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/ExplicitColumnTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/ScanWildcardColumnTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompaction.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestExplicitColumnTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestMinVersions.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestScanWildcardColumnTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreScanner.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13176907" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 00:25:31 +0000"  >&lt;p&gt;Kannan has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  The compaction code path doesn&apos;t yet get the benefit of this optimization. Spoke with Mikhail offline, and he&apos;ll update the diff to handle this case.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13176941" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 01:57:30 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, JIRA&lt;/p&gt;

&lt;p&gt;  Addressing Kannan&apos;s comment about doing the same optimization during compactions. Adding a compaction test to the unit test, and verifying that we don&apos;t read expired files using per-CF metrics.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/metrics/SchemaMetrics.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Threads.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestScannerSelectionUsingTTL.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;/p&gt;</comment>
                            <comment id="13176942" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 01:59:30 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:219 Assuming that a default scan will go through all KVs. Please let me know if this is incorrect.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13176943" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 01:59:31 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:154 This is addressed in the most recent version of the diff.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13176944" author="hadoopqa" created="Thu, 29 Dec 2011 02:01:54 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12508811/D909.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12508811/D909.4.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 17 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/619//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/619//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13176964" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 03:18:31 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, JIRA&lt;/p&gt;

&lt;p&gt;  Actually, this is where I addressed Kannan&apos;s comment about compactions:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://reviews.facebook.net/D909?vs=2679&amp;amp;id=3015&amp;amp;whitespace=ignore-all&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909?vs=2679&amp;amp;id=3015&amp;amp;whitespace=ignore-all&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  (see the new line 154 in StoreScanner.java:&lt;/p&gt;

&lt;p&gt;      scanners = selectScannersFrom(scanners);&lt;/p&gt;

&lt;p&gt;  )&lt;/p&gt;

&lt;p&gt;  I have spent quite a bit of time making sure that the unit test is testing the optimization during compactions. I am now invoking compactions in two different ways, for a total of 6 parameterized instances of the test, but it is still really quick. All of our compaction codepaths go through StoreScanner constructors, so we should have the optimization in all of them.&lt;/p&gt;

&lt;p&gt;  All unit tests pass.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/metrics/SchemaMetrics.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Threads.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestScannerSelectionUsingTTL.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompaction.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;/p&gt;</comment>
                            <comment id="13176966" author="hadoopqa" created="Thu, 29 Dec 2011 03:21:48 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12508817/D909.5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12508817/D909.5.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 20 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/620//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/620//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13176967" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 03:22:31 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:155 This is why we filter out expired StoreFiles on compactions.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13176975" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 03:52:30 +0000"  >&lt;p&gt;Kannan has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:209 scan &amp;amp; columns arguments no longer used?&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:224 and we are using this.scan &amp;amp; this.columns here?&lt;/p&gt;


&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13177335" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 19:19:30 +0000"  >&lt;p&gt;mbautin has commented on the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;INLINE COMMENTS&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:209 Yes, that&apos;s correct.&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java:224 Yes, this is the way it was in the original fix (89-fb version).&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13177358" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 19:54:30 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, JIRA&lt;/p&gt;

&lt;p&gt;  Addressing the issue that Kannan pointed out: getScanner does not use its arguments. It turned out that getScanner was called with this.scan and this.columns in all callsites, so I have removed those arguments.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/io/hfile/LruBlockCache.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/KeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/MemStore.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/NonLazyKeyValueScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/ScanQueryMatcher.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/Store.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFile.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/StoreScanner.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/TimeRangeTracker.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/metrics/SchemaMetrics.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/util/Threads.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/io/hfile/TestScannerSelectionUsingTTL.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompaction.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestCompoundBloomFilter.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestMemStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestQueryMatcher.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStore.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/regionserver/TestStoreFile.java&lt;/p&gt;</comment>
                            <comment id="13177361" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 19:58:30 +0000"  >&lt;p&gt;Kannan has accepted the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;  awesome optimization and nice work!&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13177445" author="hadoopqa" created="Thu, 29 Dec 2011 22:53:27 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12508883/D909.6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12508883/D909.6.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 20 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/633//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/633//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13185983" author="stack" created="Fri, 13 Jan 2012 23:33:04 +0000"  >&lt;p&gt;Can we close this?  Its been applied to trunk.  Its not in fb-0.89?&lt;/p&gt;</comment>
                            <comment id="13186090" author="lhofhansl" created="Sat, 14 Jan 2012 04:51:00 +0000"  >&lt;p&gt;Actually... Does this work together with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4721&quot; title=&quot;Retain Delete Markers after Major Compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4721&quot;&gt;&lt;del&gt;HBASE-4721&lt;/del&gt;&lt;/a&gt; correctly?&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4721&quot; title=&quot;Retain Delete Markers after Major Compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4721&quot;&gt;&lt;del&gt;HBASE-4721&lt;/del&gt;&lt;/a&gt; allows keeping delete markers longer than the TTL set for the store.&lt;/p&gt;</comment>
                            <comment id="13188238" author="phabricator@reviews.facebook.net" created="Wed, 18 Jan 2012 03:13:40 +0000"  >&lt;p&gt;nspiegelberg has committed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Filter HFiles based on TTL&quot;.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D909&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D909&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1232732&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1232732&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188812" author="mikhail" created="Wed, 18 Jan 2012 23:46:59 +0000"  >&lt;p&gt;@Stack: there a small item pending here. The 89-fb patch contains more testing for the compaction case, which has to be ported to trunk.&lt;/p&gt;

&lt;p&gt;@Lars: I will work with Prakash to ensure this does not break &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4721&quot; title=&quot;Retain Delete Markers after Major Compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4721&quot;&gt;&lt;del&gt;HBASE-4721&lt;/del&gt;&lt;/a&gt;. I believe &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4721&quot; title=&quot;Retain Delete Markers after Major Compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4721&quot;&gt;&lt;del&gt;HBASE-4721&lt;/del&gt;&lt;/a&gt; is only used for a replication approach that is still in development.&lt;/p&gt;

&lt;p&gt;I think we&apos;ll keep this JIRA open until the two above items are resolved, unless anyone objects.&lt;/p&gt;</comment>
                            <comment id="13194361" author="mikhail" created="Fri, 27 Jan 2012 02:07:07 +0000"  >&lt;p&gt;A follow-up fix was submitted as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5274&quot; title=&quot;Filter out the expired store file scanner during the compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5274&quot;&gt;&lt;del&gt;HBASE-5274&lt;/del&gt;&lt;/a&gt; to bring the trunk fix for this issue to parity with the 89-fb fix. Resolving.&lt;/p&gt;</comment>
                            <comment id="13194454" author="khemani" created="Fri, 27 Jan 2012 04:53:38 +0000"  >&lt;p&gt;This change is doesn&apos;t break &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4721&quot; title=&quot;Retain Delete Markers after Major Compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4721&quot;&gt;&lt;del&gt;HBASE-4721&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4721&quot; title=&quot;Retain Delete Markers after Major Compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4721&quot;&gt;&lt;del&gt;HBASE-4721&lt;/del&gt;&lt;/a&gt; introduced another parameter called hbase.hstore.time.to.purge.deletes to keep deletes even after major compactions. But hbase.hstore.time.to.purge.deletes doesn&apos;t override the TTL of the store.&lt;/p&gt;

&lt;p&gt;Pasting the comment from code which hopefully makes it clear that this diff works with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4721&quot; title=&quot;Retain Delete Markers after Major Compaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4721&quot;&gt;&lt;del&gt;HBASE-4721&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  // By default, when hbase.hstore.time.to.purge.deletes is 0ms, a delete&lt;br/&gt;
  // marker is always removed during a major compaction. If set to non-zero&lt;br/&gt;
  // value then major compaction will try to keep a delete marker around for&lt;br/&gt;
  // the given number of milliseconds. We want to keep the delete markers&lt;br/&gt;
  // around a bit longer because old puts might appear out-of-order. For&lt;br/&gt;
  // example, during log replication between two clusters.&lt;br/&gt;
  //&lt;br/&gt;
  // If the delete marker has lived longer than its column-family&apos;s TTL then&lt;br/&gt;
  // the delete marker will be removed even if time.to.purge.deletes has not&lt;br/&gt;
  // passed. This is because all the Puts that this delete marker can influence&lt;br/&gt;
  // would have also expired. (Removing of delete markers on col family TTL will&lt;br/&gt;
  // not happen if min-versions is set to non-zero)&lt;br/&gt;
  //&lt;/p&gt;</comment>
                            <comment id="13194455" author="lhofhansl" created="Fri, 27 Jan 2012 04:56:02 +0000"  >&lt;p&gt;Thanks for clarifying Prakash.&lt;/p&gt;</comment>
                            <comment id="13223114" author="ramkrishna.vasudevan@huawei.com" created="Tue, 6 Mar 2012 09:04:56 +0000"  >&lt;p&gt;Why &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5510&quot; title=&quot;Pass region info in LoadBalancer.randomAssignment(List&amp;lt;ServerName&amp;gt; servers)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5510&quot;&gt;&lt;del&gt;HBASE-5510&lt;/del&gt;&lt;/a&gt; updates coming in this JIRA?&lt;/p&gt;

&lt;p&gt;Regards&lt;br/&gt;
Ram&lt;/p&gt;
</comment>
                            <comment id="13223490" author="mikhail" created="Tue, 6 Mar 2012 18:11:11 +0000"  >&lt;p&gt;@Ram: I don&apos;t see any mentions of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5510&quot; title=&quot;Pass region info in LoadBalancer.randomAssignment(List&amp;lt;ServerName&amp;gt; servers)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5510&quot;&gt;&lt;del&gt;HBASE-5510&lt;/del&gt;&lt;/a&gt; in this JIRA, except for your comment. What updates are you referring to?&lt;/p&gt;</comment>
                            <comment id="13223492" author="ram_krish" created="Tue, 6 Mar 2012 18:13:27 +0000"  >&lt;p&gt;@Mikhail&lt;br/&gt;
The commit related updates that usually comes up once a commit is done was appearing in this JIRA.  But it was for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5510&quot; title=&quot;Pass region info in LoadBalancer.randomAssignment(List&amp;lt;ServerName&amp;gt; servers)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5510&quot;&gt;&lt;del&gt;HBASE-5510&lt;/del&gt;&lt;/a&gt;.  Ted removed them as it was not related to this JIRA.  May be that deleted part you are not able to view now.  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Sorry if the above comment had confused you.&lt;/p&gt;</comment>
                            <comment id="13223499" author="mikhail" created="Tue, 6 Mar 2012 18:17:28 +0000"  >&lt;p&gt;Actually here is the reason for those confusing updates. Ted seems to have specified &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; instead of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5510&quot; title=&quot;Pass region info in LoadBalancer.randomAssignment(List&amp;lt;ServerName&amp;gt; servers)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5510&quot;&gt;&lt;del&gt;HBASE-5510&lt;/del&gt;&lt;/a&gt; in the commit message.&lt;/p&gt;

&lt;p&gt;commit 5d773d9fa176cb056b993fdff8a2853f75315ec8&lt;br/&gt;
Author: tedyu &amp;lt;tedyu@13f79535-47bb-0310-9956-ffa450edef68&amp;gt;&lt;br/&gt;
Date:   Mon Mar 5 10:41:03 2012&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5010&quot; title=&quot;Filter HFiles based on TTL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5010&quot;&gt;&lt;del&gt;HBASE-5010&lt;/del&gt;&lt;/a&gt; Pass region info in LoadBalancer.randomAssignment(List&amp;lt;ServerName&amp;gt; servers) (Anoop Sam &lt;/p&gt;

&lt;p&gt;    git-svn-id: &lt;a href=&quot;http://svn.apache.org/repos/asf/hbase/trunk@1297155&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hbase/trunk@1297155&lt;/a&gt; 13f79535-47bb-0310-9956-ffa450edef68&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12539693">HBASE-5274</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12508631" name="5010.patch" size="44912" author="zhihyu@ebaysf.com" created="Mon, 26 Dec 2011 16:20:10 +0000"/>
                            <attachment id="12508613" name="ASF.LICENSE.NOT.GRANTED--D1017.1.patch" size="43339" author="phabricator@reviews.facebook.net" created="Sun, 25 Dec 2011 23:36:31 +0000"/>
                            <attachment id="12508625" name="ASF.LICENSE.NOT.GRANTED--D1017.2.patch" size="43416" author="phabricator@reviews.facebook.net" created="Mon, 26 Dec 2011 11:58:31 +0000"/>
                            <attachment id="12507820" name="ASF.LICENSE.NOT.GRANTED--D909.1.patch" size="31683" author="phabricator@reviews.facebook.net" created="Sun, 18 Dec 2011 01:19:31 +0000"/>
                            <attachment id="12508482" name="ASF.LICENSE.NOT.GRANTED--D909.2.patch" size="33017" author="phabricator@reviews.facebook.net" created="Fri, 23 Dec 2011 02:59:31 +0000"/>
                            <attachment id="12508643" name="ASF.LICENSE.NOT.GRANTED--D909.3.patch" size="33180" author="phabricator@reviews.facebook.net" created="Mon, 26 Dec 2011 22:20:31 +0000"/>
                            <attachment id="12508811" name="ASF.LICENSE.NOT.GRANTED--D909.4.patch" size="36076" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 01:57:31 +0000"/>
                            <attachment id="12508817" name="ASF.LICENSE.NOT.GRANTED--D909.5.patch" size="37667" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 03:18:32 +0000"/>
                            <attachment id="12508883" name="ASF.LICENSE.NOT.GRANTED--D909.6.patch" size="40731" author="phabricator@reviews.facebook.net" created="Thu, 29 Dec 2011 19:54:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 18 Dec 2011 01:19:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>220505</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 41 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i015z3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4737</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>