<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:10:08 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3432/HBASE-3432.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3432] [hbck] Add &quot;remove table&quot; switch</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3432</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This happened before and I am not sure how the new Master improves on it (this stuff is only available between the lines are buried in some peoples heads - one other thing I wish was for a better place to communicate what each path improves). Just so we do not miss it, there is an issue that sometimes disabling large tables simply times out and the table gets stuck in limbo. &lt;/p&gt;

&lt;p&gt;From the CDH User list:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;On Fri, Jan 7, 2011 at 1:57 PM, Sean Sechrist &amp;lt;ssechrist@gmail.com&amp;gt; wrote:&lt;br/&gt;
To get them out of META, you can just scan &apos;.META.&apos; for that table name, and delete those rows. We had to do that a few months ago.&lt;/p&gt;

&lt;p&gt;-Sean&lt;/p&gt;


&lt;p&gt;That did it.  For the benefit of others, here&apos;s code.  Beware the literal table names, run at your own peril.&lt;/p&gt;&lt;/blockquote&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.conf.Configuration;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.HBaseConfiguration;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.HTable;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.Delete;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.Result;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.MetaScanner;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.util.Bytes;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class CleanFromMeta {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; class Cleaner &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; MetaScanner.MetaScannerVisitor {
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; HTable meta = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Cleaner(Configuration conf) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
            meta = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HTable(conf, &lt;span class=&quot;code-quote&quot;&gt;&quot;.META.&quot;&lt;/span&gt;);
        }

        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; processRow(Result rowResult) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; r = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;(rowResult.getRow());
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (r.startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;webtable,&quot;&lt;/span&gt;)) {
                meta.delete(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Delete(rowResult.getRow()));
                &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Deleting row &quot;&lt;/span&gt; + rowResult);
            }
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        }
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tname = &lt;span class=&quot;code-quote&quot;&gt;&quot;.META.&quot;&lt;/span&gt;;
        Configuration conf = HBaseConfiguration.create();
        MetaScanner.metaScan(conf, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Cleaner(conf), 
             Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;webtable&quot;&lt;/span&gt;));
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I suggest to move this into HBaseFsck. I do not like personally to have these JRuby scripts floating around that may or may not help. This should be available if a user gets stuck and knows what he is doing (they can delete from .META. anyways). Maybe a &quot;&amp;#45;&amp;#45;disable-table &amp;lt;tablename&amp;gt; &amp;#45;&amp;#45;force&quot; or so? But since disable is already in the shell we could add an &quot;&amp;#45;&amp;#45;force&quot; there? Or add a &quot;&amp;#45;&amp;#45;delete-table &amp;lt;tablename&amp;gt;&quot; to the hbck?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12495028">HBASE-3432</key>
            <summary>[hbck] Add &quot;remove table&quot; switch</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="larsgeorge">Lars George</reporter>
                        <labels>
                    </labels>
                <created>Sat, 8 Jan 2011 14:14:43 +0000</created>
                <updated>Wed, 16 Nov 2016 20:01:35 +0000</updated>
                            <resolved>Wed, 16 Nov 2016 20:01:35 +0000</resolved>
                                    <version>0.89.20100924</version>
                                                    <component>util</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="12979797" author="stack" created="Mon, 10 Jan 2011 22:08:01 +0000"  >&lt;p&gt;Sounds good Lars.  Should send close out to any HRegions it finds still open.&lt;/p&gt;</comment>
                            <comment id="13047695" author="stack" created="Fri, 10 Jun 2011 22:58:22 +0000"  >&lt;p&gt;Moving out of 0.92.  Move it back in if you think differently.&lt;/p&gt;</comment>
                            <comment id="13047708" author="stack" created="Fri, 10 Jun 2011 22:58:24 +0000"  >&lt;p&gt;Moving out of 0.92.  Move it back in if you think differently.&lt;/p&gt;</comment>
                            <comment id="13071625" author="vams" created="Wed, 27 Jul 2011 09:42:52 +0000"  >&lt;p&gt;Hi Lars, i have small doubt regarding Root and .META. Actually where the Root and .META. are stored in the HBase cluster? Are they stored in two different special machines in which no other regions stored? &lt;br/&gt;
One more thing is, is Root and  .META. distributed or they are fully present in a single system?&lt;br/&gt;
please give me a clarity on it.&lt;/p&gt;</comment>
                            <comment id="13417890" author="juneng603" created="Thu, 19 Jul 2012 00:21:34 +0000"  >&lt;p&gt;I also got this problem when I am using CDH4(hbase 0.92.1). &lt;br/&gt;
I resolved this problem by removing /hbase/unassigned directory from a zookeeper.&lt;/p&gt;

&lt;p&gt;In this directory, there are lots of unassigned region information. &lt;/p&gt;

&lt;p&gt;so, I am curious there is some relations between zk&apos;s /hbase/unassigned directory and .META.&lt;/p&gt;</comment>
                            <comment id="13418790" author="jmhsieh" created="Thu, 19 Jul 2012 23:28:52 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;~vamshi&amp;#93;&lt;/span&gt; root and meta are special regions but regions nonetheless. They get assigned to arbitrary (possibly different) region servers, and are hit on every new client&apos;s read and write path.  &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=juneng603&quot; class=&quot;user-hover&quot; rel=&quot;juneng603&quot;&gt;juneng603&lt;/a&gt; /hbase/uassigned is where Regions-in-transitions informatin is kept.  These are modified as regions are being assigned to particular region servers.  They coordinate the state between the master assigning and then RS assignee.&lt;/p&gt;</comment>
                            <comment id="13418792" author="jmhsieh" created="Thu, 19 Jul 2012 23:29:57 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;juneng603&amp;#93;&lt;/span&gt; eventually, after region assignments are completed and the region is opened on the target RS, information is updated in the META table so that other clients can go to the proper RS.&lt;/p&gt;</comment>
                            <comment id="15671452" author="esteban" created="Wed, 16 Nov 2016 20:01:35 +0000"  >&lt;p&gt;closing as stale. Not seen in a long time.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 10 Jan 2011 22:08:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33021</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hm9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100869</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>