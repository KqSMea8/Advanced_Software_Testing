<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:12:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10291/HBASE-10291.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10291] Schema aware L2 BucketCache metrics</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10291</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This patch adds per-column family L2 cache metrics. In order to make this happen the following needed to change:&lt;/p&gt;

&lt;p&gt;The L2 cache deals with raw block data. However, in order to keep the size metrics for different CF&apos;s and block types valid the cache needs to know about the block type. In the BlockCache this is achieved by making the HFileBlock implement SchemaAware and augment the HFileBlock with the appropriate data before adding it to the cache. In order to do the same for the L2 cache RawHFileBlock were added, and the BucketEntry was made to implement SchemaAware.&lt;/p&gt;

&lt;p&gt;This led to an interesting problem, as the L2 cache is possibly used by readers and writers who do not have the SchemaAware data. In order to work around this a lightweight facade wrapping CacheConfig and the L2 cache can be instantiated and passed down instead of the actual L2 cache object. This L2CacheAgent is SchemaAware and can add the schema data to the RawHFileBlock&apos;s before handing them over to the cache. I feel the L2CacheAgent is still a work in progress as it could potentially centralize the cache policy and allow all cache decisions to be removed from HFile- and block readers and writers.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12687737">HBASE-10291</key>
            <summary>Schema aware L2 BucketCache metrics</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arjenroodselaar">Arjen Roodselaar</assignee>
                                    <reporter username="arjenroodselaar">Arjen Roodselaar</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Jan 2014 21:22:39 +0000</created>
                <updated>Wed, 21 May 2014 22:39:29 +0000</updated>
                            <resolved>Wed, 21 May 2014 22:39:29 +0000</resolved>
                                    <version>0.89-fb</version>
                                    <fixVersion>0.89-fb</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13864716" author="hadoopqa" created="Tue, 7 Jan 2014 21:38:03 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12621859/per-cf-L2-stats.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12621859/per-cf-L2-stats.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12621859&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8358//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8358//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14005337" author="stack" created="Wed, 21 May 2014 22:39:29 +0000"  >&lt;p&gt;This was committed to 0.89-fb a while back.  Not pertinent to trunk. Resolving.&lt;/p&gt;

&lt;p&gt;------------------------------------------------------------------------&lt;br/&gt;
r1556609 | liyin | 2014-01-08 11:18:24 -0800 (Wed, 08 Jan 2014) | 24 lines&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0.89-fb&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10291&quot; title=&quot;Schema aware L2 BucketCache metrics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10291&quot;&gt;&lt;del&gt;HBASE-10291&lt;/del&gt;&lt;/a&gt; Per-column family L2 cache metrics&lt;/p&gt;

&lt;p&gt;Author: arjen&lt;/p&gt;

&lt;p&gt;Summary:&lt;br/&gt;
This diff adds per-column family L2 cache metrics. In order to make this happen the following needed to change:&lt;/p&gt;

&lt;p&gt;The L2 cache deals with raw block data. However, in order to keep the size metrics for different CF&apos;s and block types valid the cache needs to know about the block type. In the BlockCache this is achieved by making the HFileBlock implement SchemaAware and augment the HFileBlock with the appropriate data before adding it to the cache. In order to do the same with the L2 cache RawHFileBlocks were added, and the BucketEntry was made to implement SchemaAware.&lt;/p&gt;

&lt;p&gt;This led to an interesting problem, as the L2 cache is possibly used by readers and writers who do not have the SchemaAware data. In order to work around this a lightweight facade wrapping CacheConfig and the L2 cache can be instantiated and passed down instead of the actual L2 cahce. This L2CacheAgent is SchemaAware and can add the schema data to the RawHFileBlock&apos;s before handing them over to the cache. I feel the L2CacheAgent is still a work in progress as it could potentially centralize the cache policy and allow all cache decisions to be removed from HFile- and block readers and writers.&lt;/p&gt;

&lt;p&gt;Depends on D1112436&lt;/p&gt;

&lt;p&gt;Test Plan: Added and ran the unit tests, deployed a jar to one of the shadow clusters and observed the stats for a while.&lt;/p&gt;

&lt;p&gt;Reviewers: liyintang, aaiyer, manukranthk&lt;/p&gt;

&lt;p&gt;Reviewed By: liyintang&lt;/p&gt;

&lt;p&gt;CC: hbase-eng@&lt;/p&gt;

&lt;p&gt;Differential Revision: &lt;a href=&quot;https://phabricator.fb.com/D1112816&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://phabricator.fb.com/D1112816&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12621859" name="per-cf-L2-stats.patch" size="77911" author="arjenroodselaar" created="Tue, 7 Jan 2014 21:28:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 7 Jan 2014 21:38:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>366737</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 30 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1r7rr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>367048</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>