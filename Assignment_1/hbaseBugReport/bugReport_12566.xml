<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:34:15 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-12566/HBASE-12566.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-12566] HRegion should have an InterfaceAudience of LimitedPrivate(PHOENIX)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-12566</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I&apos;ve discovered after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12550&quot; title=&quot;Check all storefiles are referenced before splitting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12550&quot;&gt;&lt;del&gt;HBASE-12550&lt;/del&gt;&lt;/a&gt; that Phoenix has a class that was broken by a change to a package scoped method in HRegion:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/reg
index 39a9fdc..3377e6b 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java
@@ -4628,11 +4628,12 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class HRegion &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; HeapSize { &lt;span class=&quot;code-comment&quot;&gt;// , Writable{
&lt;/span&gt;   /**
    * Create a daughter region from given a temp directory with the region data.
    * @param hri Spec. &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; daughter region to open.
+   * @param expectedReferenceFileCount
    * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    */
-  HRegion createDaughterRegionFromSplits(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HRegionInfo hri) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
+  HRegion createDaughterRegionFromSplits(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; HRegionInfo hri, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; expectedReferenceFileCount) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
     &lt;span class=&quot;code-comment&quot;&gt;// Move the files from the temporary .splits to the &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; /table/region directory
&lt;/span&gt;-    fs.commitDaughterRegion(hri);
+    fs.commitDaughterRegion(hri, expectedReferenceFileCount);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should change the HRegion InterfaceAudience to LimitedPrivate(COPROC, PHOENIX).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12757548">HBASE-12566</key>
            <summary>HRegion should have an InterfaceAudience of LimitedPrivate(PHOENIX)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                            <label>Phoenix</label>
                    </labels>
                <created>Mon, 24 Nov 2014 22:42:50 +0000</created>
                <updated>Wed, 4 Feb 2015 21:05:45 +0000</updated>
                            <resolved>Mon, 1 Dec 2014 21:48:12 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="14223732" author="eclark" created="Mon, 24 Nov 2014 23:10:46 +0000"  >&lt;p&gt;If HRegion isn&apos;t private I don&apos;t really see anything being private.&lt;br/&gt;
This is a pretty slippery slope to allow other code to reach so far in. Creating splits is something that requires coordination with other parts of the system and can cause severe corruption if not handled correctly.&lt;br/&gt;
HBase is on the hook for making sure that things are stored correctly. We shouldn&apos;t expose anything that can cause us to lose data.&lt;/p&gt;

&lt;p&gt;Additionally code that ignore the annotations telling who can access what do so at their own risk; not with the knowledge that we&apos;ll open everything up at the first asking. That&apos;s a sure road to making everything public and making it so nothing can be changed.&lt;/p&gt;</comment>
                            <comment id="14223737" author="eclark" created="Mon, 24 Nov 2014 23:15:43 +0000"  >&lt;p&gt;Additionally this is a package private that&apos;s being used by an external project. Something is majorly wrong here&lt;/p&gt;</comment>
                            <comment id="14223740" author="busbey" created="Mon, 24 Nov 2014 23:16:52 +0000"  >&lt;p&gt;HRegion is pretty internal and I&apos;m not sure we should be opening it up more, even to LimitedPrivate. According to our soon-to-be compat guide, doing this would mean we wouldn&apos;t change it within a minor version, which is a big limitation. I get that through the CoprocessorEnvironment coprocessors can get some internal objects that we list as IA.Private. I&apos;ve always taken the explicit scoping of those internals (like HRegoin and WAL) to mean that implementers were in hairy territory and should take care.&lt;/p&gt;

&lt;p&gt;Additionally, IA.LimitedPrivate notation wouldn&apos;t have stopped &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12550&quot; title=&quot;Check all storefiles are referenced before splitting&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12550&quot;&gt;&lt;del&gt;HBASE-12550&lt;/del&gt;&lt;/a&gt; from breaking Phoenix since that change was to a package-scoped method.&lt;/p&gt;

&lt;p&gt;Could we instead modify an already LimitedPrivate(PHOENIX) api somewhere else?&lt;/p&gt;</comment>
                            <comment id="14223749" author="busbey" created="Mon, 24 Nov 2014 23:21:04 +0000"  >&lt;p&gt;As an example that isn&apos;t Phoenix, the HBase Lily Indexer is going to get broken pretty hard by the recent WAL refactoring. Along with nearly every part of a WAL (HLogKey, WALEdit, etc), they were referencing HLogUtil. Should we have expanded LP annotations to cover their use?&lt;/p&gt;</comment>
                            <comment id="14223760" author="apurtell" created="Mon, 24 Nov 2014 23:28:36 +0000"  >&lt;p&gt;See my comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/PHOENIX-1479&quot; title=&quot;IndexSplitTransaction won&amp;#39;t compile after HBASE-12550&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PHOENIX-1479&quot;&gt;&lt;del&gt;PHOENIX-1479&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14230519" author="apurtell" created="Mon, 1 Dec 2014 21:48:13 +0000"  >&lt;p&gt;Resolving as Not a Problem by consensus.&lt;/p&gt;</comment>
                            <comment id="14250320" author="jamestaylor" created="Wed, 17 Dec 2014 19:01:10 +0000"  >&lt;p&gt;Would it be possible to reopen this and/or a new issue so that we can come to a workable solution, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;? Phoenix users are relying on local indexing as an important feature. &lt;/p&gt;</comment>
                            <comment id="14250371" author="apurtell" created="Wed, 17 Dec 2014 19:31:08 +0000"  >&lt;p&gt;If HBase makes HRegion and SplitTransaction LimitedPrivate, this promotes all low level functions they are concerned with: all low level aspects of regions (HRegion), filesystem layouts, particulars on how assignments are reported to the master, particulars on how meta table entries are encoded. This is tantamount to importing the Phoenix code into HBase proper. (I suppose that&apos;s an option.)&lt;/p&gt;

&lt;p&gt;I think Phoenix-ers and HBasers need to meet and hash out a supportable LimitedPrivate interface for what local indexes need. &lt;/p&gt;</comment>
                            <comment id="14250410" author="stack" created="Wed, 17 Dec 2014 19:52:32 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think Phoenix-ers and HBasers need to meet and hash out a supportable LimitedPrivate interface for what local indexes need.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agreed. Phoenix can&apos;t have free access to HRegion APIs.  What does Phoenix need? (And I&apos;d argue that the answer cannot be a means of forcing HBase to go against its nature; e.g. forcing colocation of regions, etc.)&lt;/p&gt;</comment>
                            <comment id="14250418" author="jamestaylor" created="Wed, 17 Dec 2014 20:00:19 +0000"  >&lt;p&gt;+1. Let&apos;s figure it out.&lt;/p&gt;</comment>
                            <comment id="14252171" author="jamestaylor" created="Thu, 18 Dec 2014 20:12:28 +0000"  >&lt;p&gt;What does it mean if an interface is marked as @InterfaceAudience.Private? An example is RegionScanner which is returned from the doPostScannerOpen RegionObserver coprocessors method. Phoenix uses this interface to provide a different scanner that does aggregation from a coprocessor hook. Is this forbidden as well?&lt;/p&gt;</comment>
                            <comment id="14252207" author="apurtell" created="Thu, 18 Dec 2014 20:41:16 +0000"  >&lt;p&gt;Yes, but in that case this type is used by the coprocessor API so we need to change the annotation or provide a replacement copacetic type in 1.0. &lt;/p&gt;</comment>
                            <comment id="14252227" author="jamestaylor" created="Thu, 18 Dec 2014 20:55:20 +0000"  >&lt;p&gt;I think the meta question is: Have you checked the transitive closure from existing/supported API (including coprocessor hooks)? What does it mean when a &quot;limited private&quot; API exposes a &quot;private&quot; API?&lt;/p&gt;</comment>
                            <comment id="14252240" author="busbey" created="Thu, 18 Dec 2014 21:00:29 +0000"  >&lt;p&gt;Right, I think that&apos;s the important question. We have previously asserted that Limited Private api doesn&apos;t imply anything about the transitive closure. For example, both HRegion and HLog / WAL touch parts of the coprocessor apis.&lt;/p&gt;</comment>
                            <comment id="14252248" author="apurtell" created="Thu, 18 Dec 2014 21:06:38 +0000"  >&lt;p&gt;What Sean said. I think we want types &lt;em&gt;returned&lt;/em&gt; by coprocessor APIs to be at least LimitedPrivate. It&apos;s going to be an ongoing project to clean this area up and provide coprocessor applications supportable extensibity points where negotiated. &lt;/p&gt;</comment>
                            <comment id="14254421" author="apurtell" created="Sat, 20 Dec 2014 01:21:40 +0000"  >&lt;blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;I think Phoenix-ers and HBasers need to meet and hash out a supportable LimitedPrivate interface for what local indexes need.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Agreed. Phoenix can&apos;t have free access to HRegion APIs. What does Phoenix need?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We have a meetup at AppDynamics upcoming on January 15: &lt;a href=&quot;http://www.meetup.com/hbaseusergroup/events/218744798/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.meetup.com/hbaseusergroup/events/218744798/&lt;/a&gt; . How about finding an afternoon around that time to chew on this issue for a few hours, same day or before or after? At Salesforce HQ? &lt;/p&gt;</comment>
                            <comment id="14254550" author="busbey" created="Sat, 20 Dec 2014 06:49:33 +0000"  >&lt;blockquote&gt;
&lt;p&gt;We have a meetup at AppDynamics upcoming on January 15: &lt;a href=&quot;http://www.meetup.com/hbaseusergroup/events/218744798/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.meetup.com/hbaseusergroup/events/218744798/&lt;/a&gt; . How about finding an afternoon around that time to chew on this issue for a few hours, same day or before or after? At Salesforce HQ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Provided we coordinate with an email to both dev@ lists, that sounds good. Is this open to just PMCs, just committers, or the general community? I ask because I&apos;m already scheduled in the bay area that week.&lt;/p&gt;</comment>
                            <comment id="14254563" author="lhofhansl" created="Sat, 20 Dec 2014 07:19:46 +0000"  >&lt;p&gt;Maybe we can have a &lt;tt&gt;Region&lt;/tt&gt; interface that is to &lt;tt&gt;HRegion&lt;/tt&gt; is what &lt;tt&gt;Store&lt;/tt&gt; is to &lt;tt&gt;HStore&lt;/tt&gt;.&lt;br/&gt;
&lt;tt&gt;Store&lt;/tt&gt; marked with &lt;tt&gt;@InterfaceAudience.Private&lt;/tt&gt; but used in some coprocessor hooks.&lt;/p&gt;

&lt;p&gt;Pretty sure we will never make &lt;tt&gt;HRegion&lt;/tt&gt; itself public. Might as well say &quot;we&apos;ll never change HBase and all go home&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
We might well be able to expose a &lt;tt&gt;Region&lt;/tt&gt; interface with a subset of the methods.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12772489">PHOENIX-1638</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12772482">PHOENIX-1636</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12772483">PHOENIX-1637</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12772493">HBASE-12972</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12759488">PHOENIX-1501</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12757541">PHOENIX-1479</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12756848">HBASE-12550</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12762720">HBASE-12724</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 24 Nov 2014 23:10:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 51 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i22qmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>