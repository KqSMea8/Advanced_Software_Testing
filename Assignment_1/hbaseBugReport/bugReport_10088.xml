<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:10:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10088/HBASE-10088.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10088] SecureClient will hang when access secure-disabled cluster</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10088</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When I misuse a secure hbase client to access a secure-disabled hbase server, I found the client will hang. The reason is that client will firstly invoke rpc method &quot;getProtocolVersion&quot;, and the response from a secure-disabled server won&apos;t contain necessary fields processed by SecureClient. SecureClient will process the response as follows : (from SecureClient.receiveResponse()):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (state == Status.SUCCESS.state) {
          Writable value = ReflectionUtils.newInstance(valueClass, conf);
          value.readFields(in);                 &lt;span class=&quot;code-comment&quot;&gt;// read value
&lt;/span&gt;          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
            LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;call #&quot;&lt;/span&gt;+id+&lt;span class=&quot;code-quote&quot;&gt;&quot;, response is:\n&quot;&lt;/span&gt;+value.toString());
          }
          &lt;span class=&quot;code-comment&quot;&gt;// it&apos;s possible that &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; call may have been cleaned up due to a RPC
&lt;/span&gt;          &lt;span class=&quot;code-comment&quot;&gt;// timeout, so check &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; it still exists before setting the value.
&lt;/span&gt;          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (call != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            call.setValue(value);
          }
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (state == Status.ERROR.state) {
          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (call != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            call.setException(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RemoteException(WritableUtils.readString(in), WritableUtils
                .readString(in)));
          }
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (state == Status.FATAL.state) {
          RemoteException exception = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RemoteException(WritableUtils.readString(in),
              WritableUtils.readString(in));
          &lt;span class=&quot;code-comment&quot;&gt;// the call will be removed from call map, we must set Exception here to notify
&lt;/span&gt;          &lt;span class=&quot;code-comment&quot;&gt;// the thread waited on the call
&lt;/span&gt;          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (call != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            call.setException(exception);
          }
          &lt;span class=&quot;code-comment&quot;&gt;// Close the connection
&lt;/span&gt;          markClosed(exception);
        }
        calls.remove(id);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As the above code, SecureClient need to read &apos;state&apos; field from response. If the response is from a secure-disabled server, there will no &apos;state&apos; field in response and SecureClient will get an illegal &apos;state&apos;, then the call will be removed from cached calls without notifying waiting thread. This will make the invoker waiting all the time. Although we should not use secure client to access secure-disabled server, users might encounter this situation because of misusing or error configuration. If the client will hang in this situation, users might not know the error quickly. Maybe, it is better to report an error in this situation so that users will know what happens quickly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12682888">HBASE-10088</key>
            <summary>SecureClient will hang when access secure-disabled cluster</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="10002" iconUrl="https://issues.apache.org/jira/images/icons/statuses/document.png" description="A patch for this issue has been uploaded to JIRA by a contributor.">Patch Available</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="cuijianwei">Jianwei Cui</assignee>
                                    <reporter username="cuijianwei">Jianwei Cui</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Dec 2013 12:27:42 +0000</created>
                <updated>Fri, 28 Feb 2014 01:16:55 +0000</updated>
                                            <version>0.94.14</version>
                                                    <component>Client</component>
                    <component>security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13840050" author="cuijianwei" created="Thu, 5 Dec 2013 12:30:32 +0000"  >&lt;p&gt;The path will make SecureClient notify waiting threads with an RemoteException when receiving illegal &apos;state&apos;, then user will know the error quickly.&lt;/p&gt;</comment>
                            <comment id="13840104" author="apurtell" created="Thu, 5 Dec 2013 14:25:38 +0000"  >&lt;p&gt;Patch looks ok &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cuijianwei&quot; class=&quot;user-hover&quot; rel=&quot;cuijianwei&quot;&gt;Jianwei Cui&lt;/a&gt; except let&apos;s not invent new exception names, there is no exception in the Hadoop or HBase hierarchy named UnknownServerResponseStateException, and &quot;unknow&quot; should be &quot;unknown&quot;.&lt;/p&gt;

&lt;p&gt;Edit: How about just setException(new IOException(...))&lt;/p&gt;</comment>
                            <comment id="13840816" author="cuijianwei" created="Fri, 6 Dec 2013 01:55:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andrew.purtell%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;andrew.purtell@gmail.com&quot;&gt;Andrew Purtell&lt;/a&gt; Thanks for your comment. I agree that using IOException is enough to show the error to the user. I polish the patch using IOException.&lt;/p&gt;</comment>
                            <comment id="13840867" author="apurtell" created="Fri, 6 Dec 2013 02:38:16 +0000"  >&lt;p&gt;+1 on v2 modulo a minor spelling nit we can fix on commit. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; what do you think?&lt;/p&gt;</comment>
                            <comment id="13840874" author="apurtell" created="Fri, 6 Dec 2013 02:42:08 +0000"  >&lt;p&gt;Attached an update for the v2 patch with the spelling fix.&lt;/p&gt;</comment>
                            <comment id="13914464" author="xieliang007" created="Thu, 27 Feb 2014 12:48:44 +0000"  >&lt;p&gt;Kick off QA robot&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13914465" author="xieliang007" created="Thu, 27 Feb 2014 12:49:47 +0000"  >&lt;p&gt;Oh, mind uploading a trunk patch if possible, jianwei ? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13914470" author="hadoopqa" created="Thu, 27 Feb 2014 12:52:48 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12617318/HBASE-10088-0.94-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12617318/HBASE-10088-0.94-v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12617318&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8834//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8834//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13915321" author="cuijianwei" created="Fri, 28 Feb 2014 01:16:55 +0000"  >&lt;p&gt;The security implementation of trunk branch changes a lot from 0.94. I go through the trunk code, it seems the trunk code won&apos;t suffer from this bug?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12617157" name="HBASE-10088-0.94-v1.patch" size="877" author="cuijianwei" created="Thu, 5 Dec 2013 12:30:32 +0000"/>
                            <attachment id="12617318" name="HBASE-10088-0.94-v2.patch" size="844" author="apurtell" created="Fri, 6 Dec 2013 02:41:48 +0000"/>
                            <attachment id="12617297" name="HBASE-10088-0.94-v2.patch" size="832" author="cuijianwei" created="Fri, 6 Dec 2013 01:55:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 5 Dec 2013 14:25:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362145</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 42 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qfbj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362440</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>