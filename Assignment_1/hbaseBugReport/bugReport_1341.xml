<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:52:43 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1341/HBASE-1341.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1341] Create HTable Pooler</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1341</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;A client class that takes care of properly pooling HTable references for use in multi-threaded, low-latency Java clients.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12423602">HBASE-1341</key>
            <summary>Create HTable Pooler</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Apr 2009 16:59:43 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:33 +0000</updated>
                            <resolved>Tue, 5 May 2009 09:13:40 +0000</resolved>
                                                    <fixVersion>0.20.0</fixVersion>
                                    <component>Client</component>
                    <component>io</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12705254" author="apurtell" created="Sat, 2 May 2009 10:49:53 +0000"  >&lt;p&gt;Something like the attached?&lt;/p&gt;</comment>
                            <comment id="12705283" author="apurtell" created="Sat, 2 May 2009 13:46:19 +0000"  >&lt;p&gt;Patch -2, a different direction.&lt;/p&gt;</comment>
                            <comment id="12705340" author="stack" created="Sat, 2 May 2009 22:58:55 +0000"  >&lt;p&gt;Patch looks good to me though I&apos;d just synchronize put and get so following sections of code were executed by one thread at a time:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      table = pool.remove();
+      currentSize--;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      pool.add(table);
+      currentSize++;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12705341" author="stack" created="Sat, 2 May 2009 23:02:43 +0000"  >&lt;p&gt;That said, synchronizing undoes benefit of using ConcurrentLinkedQueue in first place &amp;#8211; but I don&apos;t see an alternative.  Do you Andrew?&lt;/p&gt;</comment>
                            <comment id="12705348" author="apurtell" created="Sun, 3 May 2009 00:03:16 +0000"  >&lt;p&gt;The patch could call size() on the CLQ instead, that would be no problem. &quot;currentSize&quot; was an attempt to avoid the overhead of that, which is llinear not constant time according to Sun&apos;s javadoc. A race would mean occasional extra pooled instances, some small factor. &quot;currentSize&quot; is declared as volatile, which would keep that window small, right? &lt;/p&gt;</comment>
                            <comment id="12705349" author="stack" created="Sun, 3 May 2009 00:12:51 +0000"  >&lt;p&gt;A bit of fuzzyness on upper bounds should be fine I&apos;d think.  +1 (I would suggest you javadoc this on commit so no surprises when someone figures they have 12 HTables when they asked for 10 in the pool).&lt;/p&gt;</comment>
                            <comment id="12705456" author="streamy" created="Sun, 3 May 2009 21:47:06 +0000"  >&lt;p&gt;Sorry was not following the issue.&lt;/p&gt;

&lt;p&gt;Looks good, Andrew.  Very straightforward.&lt;/p&gt;

&lt;p&gt;We have a much more complex class we use called HBaseRef.  It pools HTables for all your tables, so you just pass a single object around in your code rather than one per table.  Besides that it behaves very similarly.&lt;/p&gt;

&lt;p&gt;One thing I used in a recent modification to HBaseRef was differentiating read/write HTable instances (in benchmarking, no performance hit sharing a single HTable for reads but there is for concurrent writes).  Just returned the same one for reads but a growing list for writers.  Not sure if this is necessary but it was good to have in some cases.&lt;/p&gt;

&lt;p&gt;Is there a way to note in the javadoc what the default is if you don&apos;t set maxSize?&lt;/p&gt;

&lt;p&gt;Regarding the locks, I&apos;d prefer to synchronize the object and ensure correctness.  If not, advertise the fact that there can be indeterminate behavior.  I just don&apos;t like an optimization like that not done by or known by the user.  A bunch of threads using the HTablePool at the same moment is probably the most common use case.&lt;/p&gt;</comment>
                            <comment id="12705745" author="apurtell" created="Mon, 4 May 2009 21:07:21 +0000"  >&lt;p&gt;Patch -3 incorporates suggestions from comments.&lt;/p&gt;</comment>
                            <comment id="12705756" author="streamy" created="Mon, 4 May 2009 21:21:45 +0000"  >&lt;p&gt;Looks great, Andrew.  Patch looks good but did not test.&lt;/p&gt;</comment>
                            <comment id="12705772" author="stack" created="Mon, 4 May 2009 21:49:53 +0000"  >&lt;p&gt;Minor, perhaps change when you commit:&lt;/p&gt;

&lt;p&gt;Why not have getPool(byte []) call getPool(byte[], int)?&lt;/p&gt;

&lt;p&gt;Otherwise, looks great.&lt;/p&gt;</comment>
                            <comment id="12705966" author="apurtell" created="Tue, 5 May 2009 09:13:40 +0000"  >&lt;p&gt;Incorporated feedback and committed. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12407085" name="hbase-1341-2.patch" size="2645" author="apurtell" created="Sat, 2 May 2009 13:46:19 +0000"/>
                            <attachment id="12407180" name="hbase-1341-3.patch" size="4281" author="apurtell" created="Mon, 4 May 2009 21:07:21 +0000"/>
                            <attachment id="12407079" name="hbase-1341.patch" size="3261" author="apurtell" created="Sat, 2 May 2009 10:49:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 2 May 2009 10:49:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32093</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 33 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hcov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99318</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>