<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:41:07 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6930/HBASE-6930.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6930] [89-fb] Avoid acquiring the same row lock repeatedly</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6930</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When processing the multiPut, multiMutations or multiDelete operations, each IPC handler thread tries to acquire a lock for each row key in these batches. If there are duplicated row keys in these batches, previously the IPC handler thread will repeatedly acquire the same row key again and again.&lt;/p&gt;

&lt;p&gt;So the optimization is to sort each batch operation based on the row key in the client side, and skip acquiring the same row lock repeatedly in the server side.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12610018">HBASE-6930</key>
            <summary>[89-fb] Avoid acquiring the same row lock repeatedly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="manukranthk">Manukranth Kolloju</assignee>
                                    <reporter username="liyin">Liyin Tang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Oct 2012 01:14:24 +0000</created>
                <updated>Tue, 23 Sep 2014 23:25:08 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13468917" author="phabricator@reviews.facebook.net" created="Wed, 3 Oct 2012 22:18:07 +0000"  >&lt;p&gt;mbautin requested code review of &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6930&quot; title=&quot;[89-fb] Avoid acquiring the same row lock repeatedly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6930&quot;&gt;HBASE-6930&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Fix TestThriftServerLegacy: notifyAll should be inside synchronized block&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, Karthik, JIRA&lt;/p&gt;

&lt;p&gt;  There were a couple of reasons why TestThriftServerLegacy has been failing recently in the HBase 89-fb branch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;rHBASEEIGHTNINEFBBRANCH1393468 was calling notifyAll outside a synchronized block&lt;/li&gt;
	&lt;li&gt;rHBASEEIGHTNINEFBBRANCH1391219 changed the meaning of a null expected value passed to checkAndMutate but that was not reflected in the Thrift handler&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;TEST PLAN&lt;br/&gt;
  Run TestThriftServerLegacy&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5841&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5841&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/13833/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/13833/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: Kannan, Liyin, Karthik, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13468918" author="phabricator@reviews.facebook.net" created="Wed, 3 Oct 2012 22:18:07 +0000"  >&lt;p&gt;mbautin updated the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6930&quot; title=&quot;[89-fb] Avoid acquiring the same row lock repeatedly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6930&quot;&gt;HBASE-6930&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Fix TestThriftServerLegacy: notifyAll should be inside synchronized block, and a null checkAndMutate expected value should be handled correctly&quot;.&lt;br/&gt;
Reviewers: Kannan, Liyin, Karthik, JIRA&lt;/p&gt;

&lt;p&gt;  Adding ThriftServerRunner fixes&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5841&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5841&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/thrift/ThriftServerRunner.java&lt;br/&gt;
  src/test/java/org/apache/hadoop/hbase/thrift/TestThriftServerLegacy.java&lt;/p&gt;

&lt;p&gt;To: Kannan, Liyin, Karthik, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13468929" author="phabricator@reviews.facebook.net" created="Wed, 3 Oct 2012 22:30:07 +0000"  >&lt;p&gt;Liyin has accepted the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6930&quot; title=&quot;[89-fb] Avoid acquiring the same row lock repeatedly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6930&quot;&gt;HBASE-6930&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Fix TestThriftServerLegacy: notifyAll should be inside synchronized block, and a null checkAndMutate expected value should be handled correctly&quot;.&lt;/p&gt;

&lt;p&gt;  Thanks Mikhail !&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5841&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5841&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  fix_locked_rows_v2&lt;/p&gt;

&lt;p&gt;To: Kannan, Liyin, Karthik, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13469004" author="phabricator@reviews.facebook.net" created="Thu, 4 Oct 2012 00:05:07 +0000"  >&lt;p&gt;mbautin has closed the revision &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6930&quot; title=&quot;[89-fb] Avoid acquiring the same row lock repeatedly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6930&quot;&gt;HBASE-6930&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;89-fb&amp;#93;&lt;/span&gt; Fix TestThriftServerLegacy: notifyAll should be inside synchronized block, and a null checkAndMutate expected value should be handled correctly&quot;.&lt;/p&gt;

&lt;p&gt;CHANGED PRIOR TO COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5841?vs=19251&amp;amp;id=19293#differential-review-toc&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5841?vs=19251&amp;amp;id=19293#differential-review-toc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D5841&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D5841&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;COMMIT&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1393839&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/rHBASEEIGHTNINEFBBRANCH1393839&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To: Kannan, Liyin, Karthik, JIRA, mbautin&lt;/p&gt;</comment>
                            <comment id="13481168" author="xieliang007" created="Mon, 22 Oct 2012 04:09:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=liyin&quot; class=&quot;user-hover&quot; rel=&quot;liyin&quot;&gt;Liyin Tang&lt;/a&gt;, seems we need to open an issue for trunk as well, right?  I compared &quot;Revision: 1393468&quot; in fb-89 branch and current trunk code in roughly&#65292; it looks trunk code need to have the similar optimization as well.&lt;/p&gt;</comment>
                            <comment id="13481171" author="lhofhansl" created="Mon, 22 Oct 2012 04:40:17 +0000"  >&lt;p&gt;The title/description here and the patch (and review) do not seem to mingle...&lt;/p&gt;</comment>
                            <comment id="13694681" author="davelatham" created="Thu, 27 Jun 2013 12:50:21 +0000"  >&lt;p&gt;Definitely confused here, along with Lars.  Did the change describe (avoid acquiring the same row lock) happen somewhere else?  Discussing something similar in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8806&quot; title=&quot;Row locks are acquired repeatedly in HRegion.doMiniBatchMutation for duplicate rows.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8806&quot;&gt;&lt;del&gt;HBASE-8806&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13694916" author="liyin" created="Thu, 27 Jun 2013 17:51:11 +0000"  >&lt;p&gt;The patch here seems to be attached to a wrong jira. Sorry about the confusion.&lt;br/&gt;
I have re-attached the path here.&lt;/p&gt;</comment>
                            <comment id="14145605" author="manukranthk" created="Tue, 23 Sep 2014 23:25:00 +0000"  >&lt;p&gt;I was reviewing the changes from 0.89-fb that didn&apos;t go to open source trunk. This seems to be one of them. At first glance on the diff, this doesn&apos;t seem to be present in master. Earlier reviewers, any thoughts on this one ?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12589942" name="HBASE-6930.diff" size="5135" author="liyin" created="Thu, 27 Jun 2013 17:51:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Oct 2012 22:18:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240646</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 12 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0148n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4456</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>