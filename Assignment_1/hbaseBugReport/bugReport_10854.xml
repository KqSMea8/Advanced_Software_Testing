<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:17:49 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10854/HBASE-10854.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10854] [VisibilityController] Apply MAX_VERSIONS from schema or request when scanning</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10854</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If we update the row multiple times with different visibility labels&lt;br/&gt;
we are able to get the &quot;old version&quot; of the row until is flushed&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ sudo -u hbase hbase shell
hbase&amp;gt; add_labels &apos;A&apos;
hbase&amp;gt; add_labels &apos;B&apos;
hbase&amp;gt; create &apos;tb&apos;, &apos;f1&apos;
hbase&amp;gt; put &apos;tb&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1&apos;, {VISIBILITY=&amp;gt;&apos;A&apos;}
hbase&amp;gt; put &apos;tb&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1all&apos;
hbase&amp;gt; put &apos;tb&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1aOrB&apos;, {VISIBILITY=&amp;gt;&apos;A|B&apos;}
hbase&amp;gt; put &apos;tb&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1aAndB&apos;, {VISIBILITY=&amp;gt;&apos;A&amp;amp;B&apos;}
hbase&amp;gt; scan &apos;tb&apos;
row column=f1:q, timestamp=1395948168154, value=v1aAndB
1 row

$ sudo -u testuser hbase shell
hbase&amp;gt; scan &apos;tb&apos;
row column=f1:q, timestamp=1395948168102, value=v1all
1 row
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When we flush the memstore we get a single row (the last one inserted)&lt;br/&gt;
so the testuser get 0 rows now.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ sudo -u hbase hbase shell
hbase&amp;gt; flush &apos;tb&apos;
hbase&amp;gt; scan &apos;tb&apos;
row column=f1:q, timestamp=1395948168154, value=v1aAndB
1 row

$ sudo -u testuser hbase shell
hbase&amp;gt; scan &apos;tb&apos;
0 row
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12704092">HBASE-10854</key>
            <summary>[VisibilityController] Apply MAX_VERSIONS from schema or request when scanning</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anoop.hbase">Anoop Sam John</assignee>
                                    <reporter username="mbertozzi">Matteo Bertozzi</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Mar 2014 20:39:43 +0000</created>
                <updated>Sat, 21 Feb 2015 23:28:46 +0000</updated>
                            <resolved>Thu, 3 Apr 2014 09:32:48 +0000</resolved>
                                    <version>0.98.0</version>
                                    <fixVersion>0.99.0</fixVersion>
                    <fixVersion>0.98.2</fixVersion>
                                    <component>security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13949967" author="apurtell" created="Thu, 27 Mar 2014 21:36:46 +0000"  >&lt;p&gt;I think there are two issues here. First, the behavior for multiple versions with multiple visibility expressions should be consistent between memstore and store scanning. Second, we should agree on what is the correct behavior for schemas supporting multiple versions, with multiple cell versions with differing visibility expressions among the versions. &lt;/p&gt;</comment>
                            <comment id="13950663" author="anoop.hbase" created="Fri, 28 Mar 2014 13:03:18 +0000"  >&lt;p&gt;This is not the case with MemStore items alone.  Consider the case of having a cell (with label) being written. After this a flush is happened. So one cell in that HFile.  A diff version of the same cell is being written again (diff label) and this is being flushed. Now there are 2 cells in 2 HFiles and make sure no compaction is happening. Similar scenario described here can happen now.  After a compaction the behaviour will change.&lt;br/&gt;
By default the max version for a CF is 1. And so flushes and compactions will make sure to write only 1 cell version in these cases.&lt;br/&gt;
During scan, even if we specify some maxversion count in scan what we take is the min of both these versions number and which will come as 1 here. &lt;br/&gt;
The visibility based evaluation and cell filtering will happen in Filter level while on a top layer (after this filtering) the filtering based on the number of max versions will happen. (In SQM)&lt;br/&gt;
So to fix this problem, we have to consider the min version number used in SQM at lower layers also.. (Readers)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Second, we should agree on what is the correct behavior for schemas supporting multiple versions, with multiple cell versions with differing visibility expressions among the versions&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;IMO in this case we have to consider all cells and which version&apos;s visibility support viewing by the user, we have to return.&lt;/p&gt;
</comment>
                            <comment id="13950665" author="anoop.hbase" created="Fri, 28 Mar 2014 13:05:56 +0000"  >&lt;p&gt;Similar case of inconsistency can come with a SCVF. Set the latestVersionOnly as false.  Based on the value of the older versions we might get back a row in cases when the older versions are in memstore.  Or in diff HFiles (No compaction)&lt;/p&gt;

&lt;p&gt;Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13950977" author="ram_krish" created="Fri, 28 Mar 2014 16:26:56 +0000"  >&lt;p&gt;Filtering happens and later versions are checked by SQM using the column trackers. Similar issues were raised some time back.  Don&apos;t remember that one. &lt;br/&gt;
I missed this issue during my day time here.&lt;/p&gt;</comment>
                            <comment id="13956550" author="anoop.hbase" created="Tue, 1 Apr 2014 14:23:01 +0000"  >&lt;p&gt;How we go with this issue?  Ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbertozzi&quot; class=&quot;user-hover&quot; rel=&quot;mbertozzi&quot;&gt;Matteo Bertozzi&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13957356" author="apurtell" created="Wed, 2 Apr 2014 05:23:04 +0000"  >&lt;p&gt;For the common use case where multiple data sets with different visiblity labels are combined into a single large table, the user will use a schema with MAX_VERSIONS &amp;gt; 1. Then users with differing authorizations will read from the table and for some the latest version(s) will be what we are supposed to return, and for others &quot;older&quot; version(s) are what we are supposed to return. &quot;Inconsistent&quot; views over the multiple versions, depending on user authorizations, is the desired behavior.&lt;/p&gt;

&lt;p&gt;As Anoop says:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The visibility based evaluation and cell filtering will happen in Filter level while on a top layer (after this filtering) the filtering based on the number of max versions will happen. (In SQM)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;HBase internal handling of multiple cell versions can produce surprising behavior when using visibility labels. The code is functioning correctly, as long as multiple versions with different labels are accessible to the scanner, then the scanner will filter out what is not visible and return what is. &lt;/p&gt;

&lt;p&gt;If I can suggest a way to proceed, it would be:&lt;br/&gt;
1. Try out the visibility labels feature.&lt;br/&gt;
2. Where you find the behavior surprising to you in some way, describe your observations on this issue or others&lt;br/&gt;
3. In some cases we can document the behavior you are observing in the online manual as expected, with some advice&lt;br/&gt;
4. In other cases, we can look at changing how HBase internally handles multiple versions of cells to avoid surprising behavior we think by consensus should be considered incorrect or ugly&lt;/p&gt;</comment>
                            <comment id="13957361" author="anoop.hbase" created="Wed, 2 Apr 2014 05:31:54 +0000"  >&lt;p&gt;I can see in SCVF there is latestVersionOnly which defaults to true.&lt;br/&gt;
Ideally for a table CF with MAX_VERSIONS as 1, any Filter acting on the Cells in that CF must act on latest version only. Pls correct me if my point is wrong. Once a major compaction is happened and no data in Memstore there will be only one version and then doing a scan will act on that single version cell. So we have to make sure same way is happening for other cases also.&lt;/p&gt;</comment>
                            <comment id="13957378" author="ram_krish" created="Wed, 2 Apr 2014 05:59:07 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testMultipleVersions() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    TableName tableName = TableName.valueOf(TEST_NAME.getMethodName());
    HColumnDescriptor col = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HColumnDescriptor(fam);
    col.setMaxVersions(1);
    HTableDescriptor desc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HTableDescriptor(tableName);
    desc.addFamily(col);
    TEST_UTIL.getHBaseAdmin().createTable(desc);
    List&amp;lt;Put&amp;gt; puts = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;Put&amp;gt;();
    Put put = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Put(Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;row1&quot;&lt;/span&gt;));
    put.add(fam, qual, 3l, Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;100&quot;&lt;/span&gt;));
    put.setCellVisibility(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CellVisibility(SECRET));
    puts.add(put);
    put = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Put(Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;row1&quot;&lt;/span&gt;));
    put.add(fam, qual, 4l, Bytes.toBytes(&lt;span class=&quot;code-quote&quot;&gt;&quot;101&quot;&lt;/span&gt;));
    put.setCellVisibility(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CellVisibility(PRIVATE));
    puts.add(put);
    HTable table = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HTable(TEST_UTIL.getConfiguration(), tableName);
    table.put(puts);
    &lt;span class=&quot;code-comment&quot;&gt;//TEST_UTIL.getHBaseAdmin().flush(tableName.getNameAsString());
&lt;/span&gt;    Scan s = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Scan();
    s.setMaxVersions(1);
    s.setAuthorizations(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Authorizations(SECRET));
    ResultScanner scanner = table.getScanner(s);
    Result[] next = scanner.next(4);
    assertEquals(1, next.length);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now uncommenting the flush line will give you no result.  If for a CF max version is 1 can we have a behaviour in Visibility Filter like SCVF to always return only latest version unless and other wise specified otherwise by the user and carry that parameter to the Visibility filter?&lt;br/&gt;
That would make things atleast inline with the SCVF behaviour? &lt;br/&gt;
And agree with Andy that we could document this behaviour as generally filters with versions is always a debatable point.  But considering Visibility is related to security this understanding makes it even more important.&lt;/p&gt;</comment>
                            <comment id="13957380" author="anoop.hbase" created="Wed, 2 Apr 2014 06:06:16 +0000"  >&lt;p&gt;Let me try out some thing Ram. Will try to come up with a patch&lt;/p&gt;</comment>
                            <comment id="13957405" author="anoop.hbase" created="Wed, 2 Apr 2014 06:56:26 +0000"  >&lt;p&gt;What I am trying to do is take into account the MAX_VERSIONS specified for a cf in the table descriptor. When this is 1 (default is 1 only) we will consider the latest version version cell&apos;s label in the VisibilityLabelFilter.&lt;/p&gt;</comment>
                            <comment id="13958549" author="anoop.hbase" created="Thu, 3 Apr 2014 06:15:12 +0000"  >&lt;p&gt;Considering the max versions for every CF.  The change make sure that we are not evaluating the visibility label on the old gone versions.&lt;/p&gt;</comment>
                            <comment id="13958567" author="ram_krish" created="Thu, 3 Apr 2014 06:43:29 +0000"  >&lt;p&gt;I already saw the patch internally.  this is what we had in mind.  +1. Will update my patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10899&quot; title=&quot;[AccessController] Apply MAX_VERSIONS from schema or request when scanning&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10899&quot;&gt;&lt;del&gt;HBASE-10899&lt;/del&gt;&lt;/a&gt; based on this.&lt;br/&gt;
NEXT_COL is not called here because we don&apos;t know how many versions may be there. ( and that may inturn lead to reseek()).&lt;/p&gt;</comment>
                            <comment id="13958584" author="apurtell" created="Thu, 3 Apr 2014 07:05:28 +0000"  >&lt;p&gt;Patch seems reasonable to me. Please try out the below scenarios with the patch applied. The shell commands aren&apos;t real, just illustrations.&lt;/p&gt;

&lt;p&gt;Table &apos;t1&apos; has MAX_VERSIONS=10 &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hbase&amp;gt; put &apos;t1&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1all&apos;
hbase&amp;gt; put &apos;t1&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1aOrB&apos;, {VISIBILITY=&amp;gt;&apos;A|B&apos;}
hbase&amp;gt; put &apos;t1&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1aAndB&apos;, {VISIBILITY=&amp;gt;&apos;A&amp;amp;B&apos;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t1&apos;, &apos;row&apos;, &apos;f1:q&apos;, { MAX_VERSIONS =&amp;gt; 1, AUTHORIZATIONS =&amp;gt; &apos;A&apos; }
-&amp;gt; [ &apos;v1aOrB&apos; ]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t1&apos;, &apos;row&apos;, &apos;f1:q&apos;, { MAX_VERSIONS =&amp;gt; 10, AUTHORIZATIONS =&amp;gt; &apos;A&apos; }
-&amp;gt; [ &apos;v1aOrB&apos;, &apos;v1all&apos; ]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t1&apos;, &apos;row&apos;, &apos;f1:q&apos;, { MAX_VERSIONS =&amp;gt; 1, AUTHORIZATIONS =&amp;gt; &apos;B&apos; }
-&amp;gt; [ &apos;v1aOrB&apos; ]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t1&apos;, &apos;row&apos;, &apos;f1:q&apos;, { MAX_VERSIONS =&amp;gt; 10, AUTHORIZATIONS =&amp;gt; &apos;B&apos; }
-&amp;gt; [ &apos;v1aOrB&apos;, &apos;v1all&apos; ]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t1&apos;, &apos;row&apos;, &apos;f1:q&apos;, { MAX_VERSIONS =&amp;gt; 1, AUTHORIZATIONS =&amp;gt; [&apos;A&apos;, &apos;B&apos;] }
-&amp;gt;  [ &apos;v1aAndB&apos; ]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t1&apos;, &apos;row&apos;, &apos;f1:q&apos;, { MAX_VERSIONS =&amp;gt; 10, AUTHORIZATIONS =&amp;gt; [&apos;A&apos;, &apos;B&apos;] }
-&amp;gt; [ &apos;v1aAndB&apos;, &apos;v1aOrB&apos;, &apos;v1all&apos; ]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Table &apos;t2&apos; has MAX_VERSIONS=1&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hbase&amp;gt; put &apos;t2&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1all&apos;
hbase&amp;gt; put &apos;t2&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1aOrB&apos;, {VISIBILITY=&amp;gt;&apos;A|B&apos;}
hbase&amp;gt; put &apos;t2&apos;, &apos;row&apos;, &apos;f1:q&apos;, &apos;v1aAndB&apos;, {VISIBILITY=&amp;gt;&apos;A&amp;amp;B&apos;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t2&apos;, &apos;row&apos;, &apos;f1:q&apos;, { AUTHORIZATIONS =&amp;gt; &apos;A&apos; }
-&amp;gt; []
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t2&apos;, &apos;row&apos;, &apos;f1:q&apos;, { AUTHORIZATIONS =&amp;gt; &apos;B&apos; }
-&amp;gt;  []
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;scan &apos;t2&apos;, &apos;row&apos;, &apos;f1:q&apos;, { AUTHORIZATIONS =&amp;gt; [&apos;A&apos;, &apos;B&apos;] }
-&amp;gt; [ &apos;v1aAndB&apos; ]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yes? Then I am +1&lt;/p&gt;

&lt;p&gt;Everyone else find the behavior illustrated by the above shell commands reasonable?&lt;/p&gt;</comment>
                            <comment id="13958600" author="anoop.hbase" created="Thu, 3 Apr 2014 07:28:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;&lt;br/&gt;
Tested all the above cases and the results are as expected.&lt;/p&gt;</comment>
                            <comment id="13958611" author="hadoopqa" created="Thu, 3 Apr 2014 08:05:43 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12638429/HBASE-10854.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12638429/HBASE-10854.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12638429&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.snapshot.TestSecureExportSnapshot&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 1 zombie test(s): 	at org.apache.hadoop.hbase.mapreduce.TestImportExport.testImport94Table(TestImportExport.java:230)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/9185//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13958623" author="ram_krish" created="Thu, 3 Apr 2014 08:27:41 +0000"  >&lt;p&gt;Just a small nit, may be we can make the new code to work only if maxVersions &amp;gt;1.  If it is 1, then we need not do those comparisons etc.&lt;/p&gt;</comment>
                            <comment id="13958632" author="apurtell" created="Thu, 3 Apr 2014 08:39:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;Tested all the above cases and the results are as expected.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Great, +1 for commit&lt;/p&gt;</comment>
                            <comment id="13958634" author="ram_krish" created="Thu, 3 Apr 2014 08:43:28 +0000"  >&lt;p&gt;Ignore my previous comment.  we do this for maxversions ==1 but memstore has more versions for a kv.&lt;/p&gt;</comment>
                            <comment id="13958635" author="ram_krish" created="Thu, 3 Apr 2014 08:43:44 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13958637" author="apurtell" created="Thu, 3 Apr 2014 08:45:20 +0000"  >&lt;p&gt;I updated the jira title.&lt;/p&gt;</comment>
                            <comment id="13958662" author="anoop.hbase" created="Thu, 3 Apr 2014 09:32:13 +0000"  >&lt;p&gt;Committed to trunk and 98.  Thanks for the reviews Ram and Andy.&lt;br/&gt;
Thanks for reporting the issue Matteo.&lt;/p&gt;</comment>
                            <comment id="13958774" author="hudson" created="Thu, 3 Apr 2014 12:44:50 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #5060 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/5060/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/5060/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10854&quot; title=&quot;[VisibilityController] Apply MAX_VERSIONS from schema or request when scanning&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10854&quot;&gt;&lt;del&gt;HBASE-10854&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;VisibilityController&amp;#93;&lt;/span&gt; Apply MAX_VERSIONS from schema or request when scanning. (Anoop) (anoopsamjohn: rev 1584327)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/VisibilityController.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/VisibilityLabelFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/security/visibility/TestVisibilityLabels.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13958796" author="hudson" created="Thu, 3 Apr 2014 13:16:32 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98 #262 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/262/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/262/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10854&quot; title=&quot;[VisibilityController] Apply MAX_VERSIONS from schema or request when scanning&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10854&quot;&gt;&lt;del&gt;HBASE-10854&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;VisibilityController&amp;#93;&lt;/span&gt; Apply MAX_VERSIONS from schema or request when scanning. (Anoop) (anoopsamjohn: rev 1584328)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/VisibilityController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/VisibilityLabelFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/test/java/org/apache/hadoop/hbase/security/visibility/TestVisibilityLabels.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13958828" author="hudson" created="Thu, 3 Apr 2014 13:52:02 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98-on-Hadoop-1.1 #246 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/246/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/246/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10854&quot; title=&quot;[VisibilityController] Apply MAX_VERSIONS from schema or request when scanning&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10854&quot;&gt;&lt;del&gt;HBASE-10854&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;VisibilityController&amp;#93;&lt;/span&gt; Apply MAX_VERSIONS from schema or request when scanning. (Anoop) (anoopsamjohn: rev 1584328)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/VisibilityController.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/security/visibility/VisibilityLabelFilter.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/test/java/org/apache/hadoop/hbase/security/visibility/TestVisibilityLabels.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14330476" author="enis" created="Sat, 21 Feb 2015 23:28:46 +0000"  >&lt;p&gt;Closing this issue after 0.99.0 release. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12638429" name="HBASE-10854.patch" size="11811" author="anoop.hbase" created="Thu, 3 Apr 2014 06:15:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Mar 2014 21:36:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>382426</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1tvwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>382695</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>