<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:12:18 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3693/HBASE-3693.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3693] isMajorCompaction() check triggers lots of listStatus DFS RPC calls from HBase</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3693</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;We noticed that there are lots of listStatus calls on the ColumnFamily directories within each region, coming from this codepath:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
compactionSelection()
 --&amp;gt; isMajorCompaction 
    --&amp;gt; getLowestTimestamp()
       --&amp;gt;  FileStatus[] stats = fs.listStatus(p);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So on every compactionSelection() we&apos;re taking this hit. While not immediately an issue, just from log inspection, this accounts for quite a large number of RPCs to namenode at the moment and seems like an unnecessary load to be sending to the namenode.&lt;/p&gt;

&lt;p&gt;Seems like it would be easy to cache the timestamp for each opened/created StoreFile, in memory, in the region server, and avoid going to DFS each time for this information.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12502209">HBASE-3693</key>
            <summary>isMajorCompaction() check triggers lots of listStatus DFS RPC calls from HBase</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="liyin">Liyin Tang</assignee>
                                    <reporter username="kannanm">Kannan Muthukkaruppan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Mar 2011 17:37:18 +0000</created>
                <updated>Fri, 25 Mar 2011 21:04:38 +0000</updated>
                            <resolved>Fri, 25 Mar 2011 21:04:37 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13010250" author="jdcryans" created="Wed, 23 Mar 2011 17:42:03 +0000"  >&lt;p&gt;Wow good on your for finding this! +1&lt;/p&gt;</comment>
                            <comment id="13010252" author="streamy" created="Wed, 23 Mar 2011 17:42:32 +0000"  >&lt;p&gt;+1 on caching this.  Good stuff!&lt;/p&gt;</comment>
                            <comment id="13010321" author="kzk" created="Wed, 23 Mar 2011 19:54:49 +0000"  >&lt;p&gt;+1 on good catch!&lt;/p&gt;

&lt;p&gt;Would be better to have FileSystem access statistics by ganglia metrics. Maybe by modifying hadoop-hdfs or FileSystem wrapper?&lt;/p&gt;</comment>
                            <comment id="13011039" author="liyin" created="Fri, 25 Mar 2011 00:24:00 +0000"  >&lt;p&gt;Cache the modification time in the StoreFile. So no need to keep checking modification time. &lt;/p&gt;</comment>
                            <comment id="13011088" author="stack" created="Fri, 25 Mar 2011 04:04:44 +0000"  >&lt;p&gt;I like your patch Liyin.  Can I commit it? (I&apos;m nervous about committing your stuff &amp;#8211; I seem to be jumping the gun).&lt;/p&gt;

&lt;p&gt;I&apos;d fix this misspelling: stroeFileNum &lt;/p&gt;

&lt;p&gt;Also, why a setModificationTimeStamp?  Seems odd being able to set this?  It comes from the fs?&lt;/p&gt;

&lt;p&gt;I&apos;d like to get this into 0.90.2.&lt;/p&gt;</comment>
                            <comment id="13011092" author="liyin" created="Fri, 25 Mar 2011 04:18:11 +0000"  >&lt;p&gt;Thanks Stack&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I remove the set function and correct the typo. &lt;/p&gt;

&lt;p&gt;This patch should be fine&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13011419" author="stack" created="Fri, 25 Mar 2011 21:04:38 +0000"  >&lt;p&gt;Committed to TRUNK (not to branch since only an &apos;improvement&apos;).  Nice patch Liyin.  Thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12474591" name="Hbase-3693[r1085248]_2.patch" size="5580" author="liyin" created="Fri, 25 Mar 2011 04:18:11 +0000"/>
                            <attachment id="12474573" name="Hbase-3693[r1085306].patch" size="5714" author="liyin" created="Fri, 25 Mar 2011 00:24:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 23 Mar 2011 17:42:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33152</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 38 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hnen:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101054</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>