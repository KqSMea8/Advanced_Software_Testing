<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:02:32 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2514/HBASE-2514.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2514] RegionServer should refuse to be assigned a region that use LZO when LZO isn&apos;t available</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2514</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If a RegionServer is assigned a region that uses LZO but the required libraries aren&apos;t installed on that RegionServer, the server will fail unexpectedly after throwing a &lt;tt&gt;java.lang.ClassNotFoundException: com.hadoop.compression.lzo.LzoCodec&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

2010-05-04 16:57:27,258 FATAL org.apache.hadoop.hbase.regionserver.MemStoreFlusher: Replay of hlog required. Forcing server shutdown
org.apache.hadoop.hbase.DroppedSnapshotException: region: tsdb,,1273011287339
        at org.apache.hadoop.hbase.regionserver.HRegion.internalFlushcache(HRegion.java:994)
        at org.apache.hadoop.hbase.regionserver.HRegion.flushcache(HRegion.java:887)
        at org.apache.hadoop.hbase.regionserver.MemStoreFlusher.flushRegion(MemStoreFlusher.java:255)
        at org.apache.hadoop.hbase.regionserver.MemStoreFlusher.run(MemStoreFlusher.java:142)
Caused by: java.lang.RuntimeException: java.lang.ClassNotFoundException: com.hadoop.compression.lzo.LzoCodec
        at org.apache.hadoop.hbase.io.hfile.Compression$Algorithm$1.getCodec(Compression.java:91)
        at org.apache.hadoop.hbase.io.hfile.Compression$Algorithm.getCompressor(Compression.java:196)
        at org.apache.hadoop.hbase.io.hfile.HFile$Writer.getCompressingStream(HFile.java:388)
        at org.apache.hadoop.hbase.io.hfile.HFile$Writer.newBlock(HFile.java:374)
        at org.apache.hadoop.hbase.io.hfile.HFile$Writer.checkBlockBoundary(HFile.java:345)
        at org.apache.hadoop.hbase.io.hfile.HFile$Writer.append(HFile.java:517)
        at org.apache.hadoop.hbase.io.hfile.HFile$Writer.append(HFile.java:482)
        at org.apache.hadoop.hbase.regionserver.Store.internalFlushCache(Store.java:558)
        at org.apache.hadoop.hbase.regionserver.Store.flushCache(Store.java:522)
        at org.apache.hadoop.hbase.regionserver.HRegion.internalFlushcache(HRegion.java:979)
        ... 3 more
Caused by: java.lang.ClassNotFoundException: com.hadoop.compression.lzo.LzoCodec
        at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:315)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:330)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:250)
        at org.apache.hadoop.hbase.io.hfile.Compression$Algorithm$1.getCodec(Compression.java:87)
        ... 12 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12463722">HBASE-2514</key>
            <summary>RegionServer should refuse to be assigned a region that use LZO when LZO isn&apos;t available</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ryanobjc">ryan rawson</assignee>
                                    <reporter username="tsuna">Benoit Sigoure</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 May 2010 00:06:55 +0000</created>
                <updated>Fri, 20 Nov 2015 12:43:44 +0000</updated>
                            <resolved>Sat, 23 Oct 2010 00:40:32 +0000</resolved>
                                    <version>0.20.1</version>
                    <version>0.20.2</version>
                    <version>0.20.3</version>
                    <version>0.20.4</version>
                    <version>0.20.5</version>
                    <version>0.20.6</version>
                    <version>0.89.20100621</version>
                                    <fixVersion>0.90.0</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12881252" author="deinspanjer" created="Tue, 22 Jun 2010 17:12:28 +0000"  >&lt;p&gt;I ran into this when upgrading to 0.20.5-rc5.  I forgot to copy the hadoop-gpl-compression jar.  The RS didn&apos;t shut down though, it just kept spewing those exceptions.&lt;/p&gt;</comment>
                            <comment id="12891924" author="stack" created="Sat, 24 Jul 2010 03:59:54 +0000"  >&lt;p&gt;Relating to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2681&quot; title=&quot;Graceful fallback to NONE when the native compression algo is not found&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2681&quot;&gt;&lt;del&gt;HBASE-2681&lt;/del&gt;&lt;/a&gt;.  &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2681&quot; title=&quot;Graceful fallback to NONE when the native compression algo is not found&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2681&quot;&gt;&lt;del&gt;HBASE-2681&lt;/del&gt;&lt;/a&gt; says to fall back to NONE if lib is not available.  It even has a patch.  I don&apos;t think that right after thinking on it.  I think refusing to open it is way to go.  Ryan brings up point over in the other issue that while the CF might say LZO, the store files may have be written with something else, some other compression that we need a lib for.  So, on open, its not good enough to look at the CF config. only.  We need to as part of storefile open &amp;#8211; which happens as part of region deploy anyways &amp;#8211; at this time verify that we have the codecs we need to deploy region.&lt;/p&gt;</comment>
                            <comment id="12891926" author="stack" created="Sat, 24 Jul 2010 04:02:48 +0000"  >&lt;p&gt;Making this critical and bringing into 0.90.0.  I think this of import given we want to talk up use of lzo.&lt;/p&gt;</comment>
                            <comment id="12895188" author="tsuna" created="Wed, 4 Aug 2010 08:47:46 +0000"  >&lt;p&gt;We hit that problem today on some of our prod machines at StumbleUpon.  &lt;tt&gt;!cool&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="12902584" author="hbasereviewboard" created="Wed, 25 Aug 2010 19:09:27 +0000"  >&lt;p&gt;Message from: &quot;Jean-Daniel Cryans&quot; &amp;lt;jdcryans@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/719/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/719/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Trying to make some progress on this issue, here&apos;s an untested patch that adds testing of codecs when the region server starts, then uses that to check the schema of regions it tries to open. That&apos;s basically what this jira&apos;s scope is about.&lt;/p&gt;

&lt;p&gt;Some things I don&apos;t like the way I did it:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;For all the users that don&apos;t do LZO, they will have a WARN every time a RS starts (in its log)&lt;/li&gt;
	&lt;li&gt;Does not cover cases where the files are LZOed, but the schema is NONE or GZ&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Finally, there&apos;s no way to let user know about the errors unless he checks the logs, but a least we won&apos;t throw ugly exceptions.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2514&quot; title=&quot;RegionServer should refuse to be assigned a region that use LZO when LZO isn&amp;#39;t available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2514&quot;&gt;&lt;del&gt;HBASE-2514&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-2514&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-2514&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  /trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 989204 &lt;br/&gt;
  /trunk/src/main/java/org/apache/hadoop/hbase/util/CompressionTest.java 989204 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/719/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/719/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jean-Daniel&lt;/p&gt;

</comment>
                            <comment id="12922346" author="ryanobjc" created="Mon, 18 Oct 2010 23:12:38 +0000"  >&lt;p&gt;im thinking we might want to do a different approach, since checking the schema isnt comprehensive enough as JD pointed out above.  Instead if we had a list of &quot;required codecs&quot; we could abort the regionserver during startup.  This would allow the admin to take action to correct the deployment.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure there is a good reason to have only part of your RS being able to open LZO regions and others passing and having the master bounce regions around until they stick.&lt;/p&gt;</comment>
                            <comment id="12924086" author="hbasereviewboard" created="Fri, 22 Oct 2010 23:39:14 +0000"  >&lt;p&gt;Message from: &quot;Ryan Rawson&quot; &amp;lt;ryanobjc@gmail.com&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1046/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1046/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-10-22 16:38:10.455573)&lt;/p&gt;


&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;RegionServer should refuse to be assigned a region that use LZO when LZO isn&apos;t available&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;instead of checking regions during open, i do a check and throw during the construction of the RS that is is able to instantiate the listed codecs.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2514&quot; title=&quot;RegionServer should refuse to be assigned a region that use LZO when LZO isn&amp;#39;t available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2514&quot;&gt;&lt;del&gt;HBASE-2514&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-2514&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-2514&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/CHANGES.txt 1024074 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/io/hfile/Compression.java 1024073 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java 1024073 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java 1024073 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1024074 &lt;br/&gt;
  trunk/src/main/java/org/apache/hadoop/hbase/util/CompressionTest.java 1024073 &lt;br/&gt;
  trunk/src/test/java/org/apache/hadoop/hbase/util/TestCompressionTest.java PRE-CREATION &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/1046/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1046/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Ryan&lt;/p&gt;

</comment>
                            <comment id="12924100" author="ryanobjc" created="Sat, 23 Oct 2010 00:40:32 +0000"  >&lt;p&gt;committed, with extra feature which needs documentation: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3146&quot; title=&quot;document feature &amp;quot;hbase.regionserver.codecs&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3146&quot;&gt;&lt;del&gt;HBASE-3146&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15017607" author="lars_francke" created="Fri, 20 Nov 2015 12:43:44 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12466367">HBASE-2681</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12466367">HBASE-2681</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 22 Jun 2010 17:12:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0d493:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>74465</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>