<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:11:58 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10249/HBASE-10249.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10249] TestReplicationSyncUpTool fails because failover takes too long</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10249</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;New issue to keep track of this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12686554">HBASE-10249</key>
            <summary>TestReplicationSyncUpTool fails because failover takes too long</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdcryans">Jean-Daniel Cryans</assignee>
                                    <reporter username="lhofhansl">Lars Hofhansl</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Dec 2013 19:06:32 +0000</created>
                <updated>Wed, 26 Feb 2014 04:45:40 +0000</updated>
                            <resolved>Tue, 21 Jan 2014 21:32:45 +0000</resolved>
                                                    <fixVersion>0.98.0</fixVersion>
                    <fixVersion>0.96.2</fixVersion>
                    <fixVersion>0.99.0</fixVersion>
                    <fixVersion>0.94.17</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13857701" author="nidmhbase" created="Fri, 27 Dec 2013 20:23:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;, thanks. I am just back and will work on it. &lt;/p&gt;</comment>
                            <comment id="13859097" author="nidmhbase" created="Mon, 30 Dec 2013 21:28:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;, I still couldn&apos;t recreate the problem locally. the Patch added a loop to run syncup a few times, with the hope the timing issue will be avoided by multiple run. If still fails, a debug info is added to check the source.&lt;/p&gt;</comment>
                            <comment id="13859104" author="lhofhansl" created="Mon, 30 Dec 2013 21:35:53 +0000"  >&lt;p&gt;Looks reasonable to me. Will commit soon.&lt;/p&gt;</comment>
                            <comment id="13859158" author="hadoopqa" created="Mon, 30 Dec 2013 23:01:20 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12620874/HBASE-10249-trunk-v0.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12620874/HBASE-10249-trunk-v0.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12620874&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.1&lt;/font&gt;.  The patch compiles against the hadoop 1.1 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8306//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13859194" author="nidmhbase" created="Tue, 31 Dec 2013 00:06:54 +0000"  >&lt;p&gt;Lars, thanks. Hopefully, it works this time.... Demai&lt;/p&gt;</comment>
                            <comment id="13859337" author="yuzhihong@gmail.com" created="Tue, 31 Dec 2013 05:10:17 +0000"  >&lt;p&gt;Integrated to trunk.&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Demai.&lt;/p&gt;

&lt;p&gt;Let&apos;s see how the test goes in the next builds.&lt;/p&gt;</comment>
                            <comment id="13859410" author="hudson" created="Tue, 31 Dec 2013 08:57:09 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #4772 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4772/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4772/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; Intermittent TestReplicationSyncUpTool failure (tedyu: rev 1554367)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationSyncUpTool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13859459" author="hudson" created="Tue, 31 Dec 2013 11:58:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK-on-Hadoop-1.1 #30 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-1.1/30/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-1.1/30/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; Intermittent TestReplicationSyncUpTool failure (tedyu: rev 1554367)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationSyncUpTool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13859942" author="yuzhihong@gmail.com" created="Wed, 1 Jan 2014 21:18:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apurtell&quot; class=&quot;user-hover&quot; rel=&quot;apurtell&quot;&gt;Andrew Purtell&lt;/a&gt;:&lt;br/&gt;
TestReplicationSyncUpTool has been passing lately on HBase-TRUNK-on-Hadoop-1.1 and HBase-TRUNK.&lt;/p&gt;

&lt;p&gt;Do you want this in 0.98 ?&lt;/p&gt;</comment>
                            <comment id="13859949" author="lhofhansl" created="Wed, 1 Jan 2014 22:05:45 +0000"  >&lt;p&gt;This is a test fix, I&apos;ll commit this to 0.94 in any case.&lt;/p&gt;</comment>
                            <comment id="13859968" author="nidmhbase" created="Wed, 1 Jan 2014 23:47:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;,&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yuzhihong%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yuzhihong@gmail.com&quot;&gt;Ted Yu&lt;/a&gt;, Thanks a lot, and happy New Year! &#8230; Demai&lt;/p&gt;</comment>
                            <comment id="13860435" author="apurtell" created="Thu, 2 Jan 2014 18:09:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do you want this in 0.98 ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13860456" author="apurtell" created="Thu, 2 Jan 2014 18:12:32 +0000"  >&lt;p&gt;Committed to 0.98 as r1554867.&lt;/p&gt;</comment>
                            <comment id="13860735" author="hudson" created="Thu, 2 Jan 2014 20:34:37 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98-on-Hadoop-1.1 #46 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/46/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/46/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt;. Intermittent TestReplicationSyncUpTool failure (Demai Ni) (apurtell: rev 1554867)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationSyncUpTool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13860774" author="hudson" created="Thu, 2 Jan 2014 21:19:24 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #49 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/49/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/49/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt;. Intermittent TestReplicationSyncUpTool failure (Demai Ni) (apurtell: rev 1554867)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationSyncUpTool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13860839" author="lhofhansl" created="Thu, 2 Jan 2014 21:57:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;, I assume you want this in 0.96? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13860844" author="lhofhansl" created="Thu, 2 Jan 2014 22:00:31 +0000"  >&lt;p&gt;Committed to 0.94.&lt;/p&gt;</comment>
                            <comment id="13860849" author="stack" created="Thu, 2 Jan 2014 22:04:14 +0000"  >&lt;p&gt;+1 for 0.96.  Thanks Lars.&lt;/p&gt;</comment>
                            <comment id="13860925" author="hudson" created="Thu, 2 Jan 2014 23:17:17 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94-security #377 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/377/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/377/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; Intermittent TestReplicationSyncUpTool failure (Demai Ni) (larsh: rev 1554937)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationSyncUpTool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13860937" author="lhofhansl" created="Thu, 2 Jan 2014 23:28:07 +0000"  >&lt;p&gt;Cool. Committed to 0.96 as well.&lt;/p&gt;</comment>
                            <comment id="13860973" author="hudson" created="Thu, 2 Jan 2014 23:56:33 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-JDK7 #7 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-JDK7/7/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-JDK7/7/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; Intermittent TestReplicationSyncUpTool failure (Demai Ni) (larsh: rev 1554937)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationSyncUpTool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13861003" author="hudson" created="Fri, 3 Jan 2014 00:23:47 +0000"  >&lt;p&gt;FAILURE: Integrated in hbase-0.96 #248 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.96/248/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.96/248/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; Intermittent TestReplicationSyncUpTool failure (Demai Ni) (larsh: rev 1554964)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationSyncUpTool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13861057" author="hudson" created="Fri, 3 Jan 2014 01:11:35 +0000"  >&lt;p&gt;ABORTED: Integrated in HBase-0.94 #1245 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1245/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1245/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; Intermittent TestReplicationSyncUpTool failure (Demai Ni) (larsh: rev 1554937)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationSyncUpTool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13861076" author="hudson" created="Fri, 3 Jan 2014 01:31:37 +0000"  >&lt;p&gt;FAILURE: Integrated in hbase-0.96-hadoop2 #168 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.96-hadoop2/168/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.96-hadoop2/168/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; Intermittent TestReplicationSyncUpTool failure (Demai Ni) (larsh: rev 1554964)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-server/src/test/java/org/apache/hadoop/hbase/replication/TestReplicationSyncUpTool.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13861980" author="yuzhihong@gmail.com" created="Fri, 3 Jan 2014 22:52:17 +0000"  >&lt;p&gt;Oops, it failed again:&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/50/testReport/junit/org.apache.hadoop.hbase.replication/TestReplicationSyncUpTool/testSyncUpTool/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/50/testReport/junit/org.apache.hadoop.hbase.replication/TestReplicationSyncUpTool/testSyncUpTool/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13862012" author="nidmhbase" created="Fri, 3 Jan 2014 23:12:56 +0000"  >&lt;p&gt;too bad.... this is a tough one. The debug info shows that the data at source is correct. I need to re-exam the logic of both the testcase and the syncup Tool. &lt;/p&gt;

&lt;p&gt;sorry about all the troubles. &lt;/p&gt;</comment>
                            <comment id="13862020" author="apurtell" created="Fri, 3 Jan 2014 23:21:08 +0000"  >&lt;p&gt;Let&apos;s reopen the issue.&lt;/p&gt;</comment>
                            <comment id="13862082" author="lhofhansl" created="Sat, 4 Jan 2014 00:36:06 +0000"  >&lt;blockquote&gt;&lt;p&gt;sorry about all the troubles&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s what the tests are for &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Replication is in principle asynchronous, it might still just be an issue with the test.&lt;/p&gt;</comment>
                            <comment id="13873906" author="jmhsieh" created="Thu, 16 Jan 2014 20:41:41 +0000"  >&lt;p&gt;FWIW, I found it fails consistently if we turn zk multi on.  &lt;/p&gt;

&lt;p&gt;In hbaes-default.xml/site.xml&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &amp;lt;/property&amp;gt;
   &amp;lt;property&amp;gt;
     &amp;lt;name&amp;gt;hbase.zookeeper.useMulti&amp;lt;/name&amp;gt;
-    &amp;lt;value&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;lt;/value&amp;gt;
+    &amp;lt;value&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/value&amp;gt;
     &amp;lt;description&amp;gt;Instructs HBase to make use of ZooKeeper&apos;s multi-update functionality.
     This allows certain ZooKeeper operations to complete more quickly and prevents some issues
     with rare ZooKeeper failure scenarios (see the release note of HBASE-6710 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; an example).
     IMPORTANT: only set &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; to &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; all ZooKeeper servers in the cluster are on version 3.4+
     and will not be downgraded.  ZooKeeper versions before 3.4 &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not support multi-update and will
     not fail gracefully &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; multi-update is invoked (see ZOOKEEPER-1495).
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13873916" author="nidmhbase" created="Thu, 16 Jan 2014 20:51:23 +0000"  >&lt;p&gt;Jonathan,&lt;/p&gt;

&lt;p&gt;Thank you so much. I actually ran out of ideas on this one and I never was able to reproduce the error. Now it is a clue I can follow instead of shooting into dark. Appreciate it&lt;/p&gt;

&lt;p&gt;Demai on the run&lt;/p&gt;

</comment>
                            <comment id="13874042" author="jdcryans" created="Thu, 16 Jan 2014 22:14:32 +0000"  >&lt;p&gt;Two things I&apos;ve noticed that I&apos;m fixing in the attached patch for 0.94:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The multi path doesn&apos;t check if the znode that we&apos;re moving is ours, so we end up deleting our own queue (!!!).&lt;/li&gt;
	&lt;li&gt;Looking at the link for the latest failure, we do check that in the non-multi path but when we do it it takes a few hundreds of milliseconds. It seems that they all end up counting towards the 10 seconds limit that we have in order to clear all the queues. I moved the checking of the path before the sleeping in NodeFailoverWorker.run so that we don&apos;t waste time on ourselves.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Regardless, this code is racy:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    int numberOfOldSource = 1; // default wait once
      while (numberOfOldSource &amp;gt; 0) {
        Thread.sleep(SLEEP_TIME);
        numberOfOldSource = manager.getOldSources().size();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We basically say &quot;let&apos;s wait 10 seconds and see if we can transfer &lt;em&gt;all&lt;/em&gt; the queues during that time&quot;. If some queues are still being transferred, and the others we did transfer are already done, they won&apos;t count as an oldSource, and so we can miss them. The most extreme case is moving 1 queue with enough znodes that it takes more than 10 seconds to move (I&apos;ve seen that), in which case the sync tool will stop even though there might be many more queues to transfer.&lt;/p&gt;</comment>
                            <comment id="13874057" author="jdcryans" created="Thu, 16 Jan 2014 22:27:41 +0000"  >&lt;p&gt;Actually the last patch&apos;s new method wasn&apos;t named correctly, new patch includes this cosmetic change.&lt;/p&gt;</comment>
                            <comment id="13874124" author="jmhsieh" created="Thu, 16 Jan 2014 23:13:41 +0000"  >&lt;p&gt;Is the patch relevent to and does it apply to trunk/0.98/0.96 as well?&lt;/p&gt;</comment>
                            <comment id="13874152" author="jdcryans" created="Thu, 16 Jan 2014 23:35:49 +0000"  >&lt;p&gt;In trunk, 0.98, and 0.96 the check is in place but it&apos;s done after we sleep so hitting the race is what makes it fail.&lt;/p&gt;</comment>
                            <comment id="13874173" author="jdcryans" created="Thu, 16 Jan 2014 23:50:02 +0000"  >&lt;p&gt;Patch for trunk, kind of the same thing. Doing it I also saw that I missed something the isThisOurZnode in the v1 0.94 patch, shouldn&apos;t talk about parents (not a functional change though).&lt;/p&gt;</comment>
                            <comment id="13874202" author="apurtell" created="Fri, 17 Jan 2014 00:20:02 +0000"  >&lt;p&gt;I skimmed the trunk patch, +1 for 0.98&lt;/p&gt;</comment>
                            <comment id="13874313" author="hadoopqa" created="Fri, 17 Jan 2014 02:00:46 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12623538/HBASE-10249-trunk-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12623538/HBASE-10249-trunk-v1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;br/&gt;
  ATTACHMENT ID: 12623538&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.0&lt;/font&gt;.  The patch compiles against the hadoop 1.0 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop1.1&lt;/font&gt;.  The patch compiles against the hadoop 1.1 profile.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn site goal to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop2-compat.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-prefix-tree.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-client.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-common.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-protocol.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-server.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-examples.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-thrift.html&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//artifact/trunk/patchprocess/newPatchFindbugsWarningshbase-hadoop-compat.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/8451//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13874410" author="nidmhbase" created="Fri, 17 Jan 2014 04:10:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt;,&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmhsieh&quot; class=&quot;user-hover&quot; rel=&quot;jmhsieh&quot;&gt;Jonathan Hsieh&lt;/a&gt;, many thanks to both of you. You guys are great and fast. I was occupied by my &apos;day-time&apos; job, just come back to this and found out the patch is there and testing is done. Appreciate it. &lt;/p&gt;</comment>
                            <comment id="13874412" author="nidmhbase" created="Fri, 17 Jan 2014 04:12:58 +0000"  >&lt;p&gt;assigned to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt; who fixed the bug and deserves the credit, where I ran out of idea. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="13874424" author="jdcryans" created="Fri, 17 Jan 2014 04:30:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nidmhbase&quot; class=&quot;user-hover&quot; rel=&quot;nidmhbase&quot;&gt;Demai Ni&lt;/a&gt; No problem, credits to Jon for asking me to look at it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; you good with this for 0.94 sir?&lt;/p&gt;</comment>
                            <comment id="13874932" author="lhofhansl" created="Fri, 17 Jan 2014 16:43:45 +0000"  >&lt;p&gt;Yeah, scary stuff, especially since we have multi enabled here. +1&lt;/p&gt;

&lt;p&gt;Should change the title to something more descriptive since this in an actual bug in the replication code.&lt;/p&gt;

&lt;p&gt;The condition here is always false, so removing has no effect, right?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (parent.equals(rsServerNameZnode)) {
        LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Won&apos;t lock because &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is us, we&apos;re dead!&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13875217" author="lhofhansl" created="Fri, 17 Jan 2014 20:10:15 +0000"  >&lt;p&gt;you gonna commit &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13875554" author="stack" created="Sat, 18 Jan 2014 05:39:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt;, as per usual, is off in &apos;exotic locations&apos; till Tuesday at least: Cancun this time.&lt;/p&gt;</comment>
                            <comment id="13875555" author="lhofhansl" created="Sat, 18 Jan 2014 05:42:21 +0000"  >&lt;p&gt;He&apos;s living the life.&lt;br/&gt;
Alright. Looks good to me, I&apos;ll do some more test and commit if all looks good.&lt;/p&gt;</comment>
                            <comment id="13877701" author="jdcryans" created="Tue, 21 Jan 2014 18:31:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;He&apos;s living the life.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Are you not? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Should change the title to something more descriptive since this in an actual bug in the replication code.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Well the tool is racy. It can still fail, but it&apos;s much much less likely. Agree the title needs to be changed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The condition here is always false, so removing has no effect, right?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The check just happens sooner now.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Looks good to me, I&apos;ll do some more test and commit if all looks good.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Since I&apos;m back from $exotic_location, you mind if I commit? Your testing came back ok?&lt;/p&gt;</comment>
                            <comment id="13877763" author="lhofhansl" created="Tue, 21 Jan 2014 19:19:58 +0000"  >&lt;p&gt;Didn&apos;t get to test this. But it looks good. +1 on commit.&lt;/p&gt;</comment>
                            <comment id="13877882" author="jdcryans" created="Tue, 21 Jan 2014 21:32:45 +0000"  >&lt;p&gt;Committed everywhere, thanks for the reviews guys and sorry I was off drinking tequila for a few days.&lt;/p&gt;</comment>
                            <comment id="13877928" author="hudson" created="Tue, 21 Jan 2014 22:22:47 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-on-Hadoop-2 #2 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-on-Hadoop-2/2/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-on-Hadoop-2/2/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560198)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13877930" author="hudson" created="Tue, 21 Jan 2014 22:24:40 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-security #391 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/391/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/391/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560198)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13878012" author="hudson" created="Tue, 21 Jan 2014 23:33:31 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94-JDK7 #31 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-JDK7/31/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-JDK7/31/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560198)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13878021" author="hudson" created="Tue, 21 Jan 2014 23:44:24 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #4844 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4844/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4844/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560201)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueues.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueuesZKImpl.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13878041" author="hudson" created="Wed, 22 Jan 2014 00:00:57 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.94 #1264 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1264/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1264/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560198)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/ReplicationZookeeper.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13878046" author="hudson" created="Wed, 22 Jan 2014 00:04:10 +0000"  >&lt;p&gt;FAILURE: Integrated in hbase-0.96 #266 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.96/266/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.96/266/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560199)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueues.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueuesZKImpl.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13878075" author="hudson" created="Wed, 22 Jan 2014 00:39:00 +0000"  >&lt;p&gt;FAILURE: Integrated in hbase-0.96-hadoop2 #183 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.96-hadoop2/183/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.96-hadoop2/183/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560199)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueues.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueuesZKImpl.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13878097" author="hudson" created="Wed, 22 Jan 2014 01:03:06 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.98 #100 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/100/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/100/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560200)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueues.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueuesZKImpl.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13878125" author="hudson" created="Wed, 22 Jan 2014 01:32:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK-on-Hadoop-1.1 #61 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-1.1/61/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-1.1/61/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560201)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueues.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueuesZKImpl.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13878129" author="hudson" created="Wed, 22 Jan 2014 01:34:19 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98-on-Hadoop-1.1 #94 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/94/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/94/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10249&quot; title=&quot;TestReplicationSyncUpTool fails because failover takes too long&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10249&quot;&gt;&lt;del&gt;HBASE-10249&lt;/del&gt;&lt;/a&gt; TestReplicationSyncUpTool fails because failover takes too long (jdcryans: rev 1560200)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueues.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-client/src/main/java/org/apache/hadoop/hbase/replication/ReplicationQueuesZKImpl.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/replication/regionserver/ReplicationSourceManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13893981" author="yuzhihong@gmail.com" created="Thu, 6 Feb 2014 23:37:57 +0000"  >&lt;p&gt;Pardon me, it failed lately:&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4895/testReport/junit/org.apache.hadoop.hbase.replication/TestReplicationSyncUpTool/testSyncUpTool/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4895/testReport/junit/org.apache.hadoop.hbase.replication/TestReplicationSyncUpTool/testSyncUpTool/&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12660124">HBASE-9047</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12623496" name="HBASE-10249-0.94-v0.patch" size="2259" author="jdcryans" created="Thu, 16 Jan 2014 22:14:32 +0000"/>
                            <attachment id="12623502" name="HBASE-10249-0.94-v1.patch" size="2257" author="jdcryans" created="Thu, 16 Jan 2014 22:27:41 +0000"/>
                            <attachment id="12620874" name="HBASE-10249-trunk-v0.patch" size="5444" author="nidmhbase" created="Mon, 30 Dec 2013 21:26:17 +0000"/>
                            <attachment id="12623538" name="HBASE-10249-trunk-v1.patch" size="2601" author="jdcryans" created="Thu, 16 Jan 2014 23:50:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 27 Dec 2013 20:23:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365545</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 45 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1r0en:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365853</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>This change also fixes a potential data loss issue when using ZK multi actions because region servers could try to failover themselves (the replication sync up tool acts as a RS too)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>