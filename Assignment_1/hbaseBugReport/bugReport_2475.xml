<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:02:14 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2475/HBASE-2475.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2475] [stargate] Required ordering of JSON name/value pairs when performing Insert/Update</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2475</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;From Tyler Coffin up on hbase-user@&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I am using the Stargate REST interface to HBase for inserting data. When using JSON to transmit the query content, I have found that specific ordering of key/value pairs within the JSON string is required in order for the query to succeed (otherwise a response of &apos;HTTP/1.1 500 Row key is invalid&apos; error is thrown if &quot;key&quot; and &quot;Cell&quot; are reversed).&lt;/p&gt;

&lt;p&gt;Example:&lt;br/&gt;
This string receives the above error:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{&quot;Row&quot;:[{&quot;Cell&quot;:[{&quot;column&quot;:&quot;bWVzc2FnZTptc2c=&quot;,&quot;$&quot;:&quot;Zm9vYmFy&quot;}],&quot;key&quot;:&quot;MTIzNAo=&quot;}]}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is the valid equivalent string:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{&quot;Row&quot;:[{&quot;key&quot;:&quot;MTIzNAo=&quot;,&quot;Cell&quot;:[{&quot;column&quot;:&quot;bWVzc2FnZTptc2c=&quot;,&quot;$&quot;:&quot;Zm9vYmFy&quot;}]}]}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see the only difference between these two instances is that the &quot;key&quot; and &quot;Cell&quot; name/value pairs have their order reversed.&lt;/p&gt;

&lt;p&gt;In the equivalent XML notation, the ordering is specifically required per the schema. However with JSON Objects (i.e. name/value pairs) order is not required (JSON Arrays are ordered, but not Objects). Some JSON libraries will preserve ordering of Objects but not all  which is how I discovered this problem in the first place because I was using the Perl JSON library which does not guarantee order). &lt;br/&gt;
I&apos;m unsure if this is a bug in the REST implementation or an inconvenient ambiguity in the JSON specification. Regardless I thought I&apos;d share this discovery with the community for feedback (or at the very least to document this for users&apos; future reference).&lt;/p&gt;

&lt;p&gt;For reference this is the table schema for the above query:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{NAME =&amp;gt; &apos;reftrack&apos;, FAMILIES =&amp;gt; [{NAME =&amp;gt; &apos;message&apos;, COMPRESSION =&amp;gt;
&apos;NONE&apos;, VERSIONS =&amp;gt; &apos;1&apos;, TTL =&amp;gt; &apos;2147483647&apos;, BLOCKSIZE =&amp;gt; &apos;65536&apos;,
IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;true&apos;}]}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12462586">HBASE-2475</key>
            <summary>[stargate] Required ordering of JSON name/value pairs when performing Insert/Update</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                            <label>moved_from_0_20_5</label>
                    </labels>
                <created>Tue, 20 Apr 2010 22:08:05 +0000</created>
                <updated>Sun, 11 May 2014 11:05:13 +0000</updated>
                            <resolved>Sun, 11 May 2014 11:05:13 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12859094" author="apurtell" created="Tue, 20 Apr 2010 22:10:59 +0000"  >&lt;p&gt;Thanks for the report, very helpful.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;In the equivalent XML notation, the ordering is specifically required per the schema. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;... and Jersey adds a marshaller and unmarshaller to the JAXB framework to produce JSON. This is an artifact of jersey-json or something dumb we did when hooking up JAXB.  I&apos;ll write up some unit tests and look at this soon.&lt;/p&gt;</comment>
                            <comment id="12866791" author="stack" created="Wed, 12 May 2010 23:48:02 +0000"  >&lt;p&gt;Bulk move of 0.20.5 issues into 0.21.0 after vote that we merge branch into TRUNK up on list.&lt;/p&gt;</comment>
                            <comment id="12869031" author="apurtell" created="Wed, 19 May 2010 07:08:06 +0000"  >&lt;p&gt;Removed ordering directives on some bindings as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2542&quot; title=&quot;Fold Stargate into core&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2542&quot;&gt;&lt;del&gt;HBASE-2542&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2567&quot; title=&quot;[stargate] minimize differences between 0.20 branch and trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2567&quot;&gt;&lt;del&gt;HBASE-2567&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13288137" author="apurtell" created="Sun, 3 Jun 2012 10:29:24 +0000"  >&lt;p&gt;Some JSON field ordering issues remain according to reports. These may be an artifact of how JSON is hooked up to JAXB. The weird &apos;$&apos; special field for specifying a value is due to how the bindings work, for example. Reopening for more investigation and at least a documentation update. &lt;/p&gt;</comment>
                            <comment id="13288259" author="apurtell" created="Sun, 3 Jun 2012 21:07:36 +0000"  >&lt;p&gt;If the &quot;$&quot; value field does not come last in a CellModel, Jersey won&apos;t deserialize the model correctly. We can&lt;/p&gt;

&lt;p&gt;1. Document this clearly and also add a troubleshooting section entry.&lt;/p&gt;

&lt;p&gt;2. As an alternative, elsewhere we use Jackson as a JSON serializer/deserializer. Jackson seems widely considered to be better behaved. JacksonJsonProvider in jackson-jaxrs is a drop in replacement for Jersey&apos;s JSON binding for JAX-RS. However, the JSON representation of HBase REST may change as a consequence. This would depend on how configurable JacksonJsonProvider is, and if all backwards compatible behaviors can be specified. Digging around Jackson javadoc for a while was inconclusive. &lt;/p&gt;</comment>
                            <comment id="13288265" author="apurtell" created="Sun, 3 Jun 2012 21:51:14 +0000"  >&lt;p&gt;For option 2 I tried the quick hack attached and:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2012-06-03 23:43:16,085 WARN  [1224001988@qtp-1382067420-0] log.Slf4jLog(76): /users/TheRealMT/info:password: org.codehaus.jackson.map.exc.UnrecognizedPropertyException: Unrecognized field &quot;Row&quot; (Class org.apache.hadoop.hbase.rest.model.CellSetModel), not marked as ignorable
 at [Source: org.mortbay.jetty.HttpParser$Input@264d107e; line: 1, column: 9] (through reference chain: org.apache.hadoop.hbase.rest.model.CellSetModel[&quot;Row&quot;])
2012-06-03 23:43:16,097 DEBUG [main] client.Client(148): PUT http://localhost:46871/users/TheRealMT/info:password 500 Unrecognized field &quot;Row&quot; (Class org.apache.hadoop.hbase.rest.model.CellSetModel), not marked as ignorable  at [Source: org.mortbay.jetty.HttpParser$Input@264d107e; line: 1, column: 9] (through reference chain: org.apache.hadoop.hbase.rest.model.CellSetModel[&quot;Row&quot;]) in 1520 ms
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So we can certainly pursue an alternate implementation with Jackson but the JSON representation and all related documentation will change.&lt;/p&gt;

&lt;p&gt;I will note that the error messages provided by Jackson are much better than Jersey in contrast silently accepting input it thinks is broken.&lt;/p&gt;</comment>
                            <comment id="13994521" author="apurtell" created="Sun, 11 May 2014 11:05:13 +0000"  >&lt;p&gt;Resolved by new JSON serializer in newer versions&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12464843">HBASE-2567</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12530709" name="HBASE-2475.patch" size="7580" author="apurtell" created="Sun, 3 Jun 2012 21:51:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 12 May 2010 23:48:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26321</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02d2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11718</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>