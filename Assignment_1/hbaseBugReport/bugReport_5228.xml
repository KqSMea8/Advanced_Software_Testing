<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:25:54 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5228/HBASE-5228.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5228] [REST] Rip out &quot;transform&quot; feature</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5228</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The &apos;transform&apos; feature, where REST can be instructed, via a table attribute, to apply a transformation (e.g. base64 encoding or decoding) to a (sub)set of column values before serving them up to a client or storing them into HBase, was added some time ago at the request of Jack Levin. I have since come to regret it, it was not a well thought out feature:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;This is really an application concern.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;It adds significant overhead to request processing: Periodically a HBaseAdmin is used to retrieve the table descriptor, in order to scan through table attributes for transformation directives.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think it is best to rip it out, its a real problem area, and REST should be no more concerned about data formats than the Java API. &lt;/p&gt;

&lt;p&gt;I doubt anyone uses this, not even Jack. Will need to follow up with him to confirm.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12538882">HBASE-5228</key>
            <summary>[REST] Rip out &quot;transform&quot; feature</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Jan 2012 22:18:26 +0000</created>
                <updated>Fri, 12 Oct 2012 05:34:52 +0000</updated>
                            <resolved>Fri, 20 Jan 2012 18:07:36 +0000</resolved>
                                    <version>0.90.5</version>
                    <version>0.92.0</version>
                    <version>0.94.0</version>
                                    <fixVersion>0.90.6</fixVersion>
                    <fixVersion>0.92.1</fixVersion>
                    <fixVersion>0.94.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13188832" author="apurtell" created="Thu, 19 Jan 2012 00:27:10 +0000"  >&lt;p&gt;Jack confirmed in private correspondence that this can come out. I&apos;d like to do it ASAP as part of 0.92 (and any further 0.90 release) so we don&apos;t pick up a user of this misfeature.&lt;/p&gt;</comment>
                            <comment id="13188842" author="stack" created="Thu, 19 Jan 2012 00:40:32 +0000"  >&lt;p&gt;Can this be in 0.92.1 Andrew?   I&apos;d start a 0.92.1 candidate immediately after 0.92.0 release?&lt;/p&gt;</comment>
                            <comment id="13188845" author="zhihyu@ebaysf.com" created="Thu, 19 Jan 2012 00:45:11 +0000"  >&lt;p&gt;@Andy:&lt;br/&gt;
Do you want Hadoop QA to run the patch through tests ?&lt;/p&gt;</comment>
                            <comment id="13188848" author="zhihyu@ebaysf.com" created="Thu, 19 Jan 2012 00:48:48 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     HBaseAdmin admin = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HBaseAdmin(servlet.getConfiguration());
-    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; admin.tableExists(table);
+    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; result = admin.tableExists(table);
+    admin.close();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Looks like admin.close() should be enclosed in finally block.&lt;/p&gt;</comment>
                            <comment id="13188854" author="apurtell" created="Thu, 19 Jan 2012 00:53:38 +0000"  >&lt;p&gt;@Stack: Ok&lt;/p&gt;

&lt;p&gt;@Ted: Thanks for the patch review, will fix on commit if you think this is good to go in otherwise.&lt;/p&gt;</comment>
                            <comment id="13188856" author="zhihyu@ebaysf.com" created="Thu, 19 Jan 2012 00:58:34 +0000"  >&lt;p&gt;+1 if tests pass.&lt;/p&gt;

&lt;p&gt;The current patch wouldn&apos;t apply cleanly on TRUNK, FYI&lt;/p&gt;</comment>
                            <comment id="13188860" author="lhofhansl" created="Thu, 19 Jan 2012 01:05:08 +0000"  >&lt;p&gt;+1 on idea and patch.&lt;/p&gt;</comment>
                            <comment id="13188955" author="apurtell" created="Thu, 19 Jan 2012 06:46:01 +0000"  >&lt;p&gt;Test results for 0.92:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Tests in error: 
  testMasterFailoverWithMockedRIT(org.apache.hadoop.hbase.master.TestMasterFailover): test timed out after 180000 milliseconds
  testRetrying(org.apache.hadoop.hbase.catalog.TestMetaReaderEditor): test timed out after 180000 milliseconds
  testGetRegionsCatalogTables(org.apache.hadoop.hbase.catalog.TestMetaReaderEditor): Failed after attempts=10, exceptions:
  testTableExists(org.apache.hadoop.hbase.catalog.TestMetaReaderEditor): Connection refused
  testGetRegion(org.apache.hadoop.hbase.catalog.TestMetaReaderEditor): Connection refused
  testScanMetaForTable(org.apache.hadoop.hbase.catalog.TestMetaReaderEditor): Failed after attempts=10, exceptions:
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Tests run: 1076, Failures: 0, Errors: 1, Skipped: 8&lt;/p&gt;


&lt;p&gt;Test results for trunk:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Results :

Tests run: 533, Failures: 0, Errors: 0, Skipped: 2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test failures for 0.92 are worrisome, but not related to this patch.&lt;/p&gt;</comment>
                            <comment id="13188967" author="stack" created="Thu, 19 Jan 2012 07:17:37 +0000"  >&lt;p&gt;You can apply to 0.92 branch Andrew if you want given I&apos;ve tagged the RC.&lt;/p&gt;</comment>
                            <comment id="13189220" author="xodarap" created="Thu, 19 Jan 2012 17:27:33 +0000"  >&lt;p&gt;Thanks Andrew for this patch.&lt;/p&gt;

&lt;p&gt;For others who might run into this: running a jstack on our REST server revealed that virtually every thread was hung waiting on a table descriptor:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (on object monitor)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:485)
	at org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:885)
	- locked &amp;lt;0x000000070218e7d0&amp;gt; (a org.apache.hadoop.hbase.ipc.HBaseClient$Call)
	at org.apache.hadoop.hbase.ipc.WritableRpcEngine$Invoker.invoke(WritableRpcEngine.java:150)
	at $Proxy61.getHTableDescriptors(Unknown Source)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.getHTableDescriptor(HConnectionManager.java:1871)
	at org.apache.hadoop.hbase.client.HTable.getTableDescriptor(HTable.java:404)
	at org.apache.hadoop.hbase.client.HTablePool$PooledHTable.getTableDescriptor(HTablePool.java:344)
	at org.apache.hadoop.hbase.&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;.RowResultGenerator.&amp;lt;init&amp;gt;(RowResultGenerator.java:64)
	at org.apache.hadoop.hbase.&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;.ResultGenerator.fromRowSpec(ResultGenerator.java:35)
	at org.apache.hadoop.hbase.&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;.RowResource.get(RowResource.java:86)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So if your REST server is running slowly on an affected version, I guess try running a jstack and see if you see this behavior.&lt;/p&gt;</comment>
                            <comment id="13189222" author="zhihyu@ebaysf.com" created="Thu, 19 Jan 2012 17:31:36 +0000"  >&lt;p&gt;@Ben:&lt;br/&gt;
The above strace was captured without Andy&apos;s patch, right ?&lt;/p&gt;

&lt;p&gt;Do you want to try out his patch and see if REST server gets faster ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13189256" author="apurtell" created="Thu, 19 Jan 2012 18:15:35 +0000"  >&lt;p&gt;@Ted: I observed the blocking on this code path eliminated in runs under jprofiler after the patch was applied.&lt;/p&gt;

&lt;p&gt;@Ben: It would be good to confirm this on your side.&lt;/p&gt;</comment>
                            <comment id="13189267" author="xodarap" created="Thu, 19 Jan 2012 18:31:25 +0000"  >&lt;p&gt;@Zhihong, Andrew: yes, that stack trace was prior to Andrew&apos;s patch. Installing the patch now, will update with results.&lt;/p&gt;</comment>
                            <comment id="13189461" author="xodarap" created="Thu, 19 Jan 2012 22:51:41 +0000"  >&lt;p&gt;@Andrew, Zhihong: Confirmed that I&apos;m no longer seeing all those threads blocked on the HTableDescriptor call. &lt;/p&gt;

&lt;p&gt;I&apos;m not seeing a huge performance improvement, but I switched boxes in between tests (and am having trouble reverting to 0.90.4), so if it&apos;s faster for you guys I&apos;ll believe that&apos;s the cause.&lt;/p&gt;</comment>
                            <comment id="13189556" author="apurtell@yahoo.com" created="Fri, 20 Jan 2012 01:07:39 +0000"  >&lt;p&gt;There could be more going on, but let&apos;s get this problem settled and keep digging. I&apos;ll commit to trunk, 0.92, and 0.90 tonight after the meetup. &lt;/p&gt;</comment>
                            <comment id="13190093" author="hudson" created="Fri, 20 Jan 2012 20:53:15 +0000"  >&lt;p&gt;Integrated in HBase-0.92 #253 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92/253/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92/253/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5228&quot; title=&quot;[REST] Rip out &amp;quot;transform&amp;quot; feature&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5228&quot;&gt;&lt;del&gt;HBASE-5228&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;REST&amp;#93;&lt;/span&gt; Rip out transform feature&lt;/p&gt;

&lt;p&gt;apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/rest/MultiRowResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/rest/RowResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/rest/TableResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/rest/transform&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/rest/TestTransform.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13190128" author="hudson" created="Fri, 20 Jan 2012 21:24:11 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2641 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2641/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2641/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5228&quot; title=&quot;[REST] Rip out &amp;quot;transform&amp;quot; feature&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5228&quot;&gt;&lt;del&gt;HBASE-5228&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;REST&amp;#93;&lt;/span&gt; Rip out transform feature&lt;/p&gt;

&lt;p&gt;apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/rest/MultiRowResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/rest/RowResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/rest/TableResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/rest/transform&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/rest/TestTransform.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13190313" author="hudson" created="Sat, 21 Jan 2012 05:42:22 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #83 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/83/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/83/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5228&quot; title=&quot;[REST] Rip out &amp;quot;transform&amp;quot; feature&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5228&quot;&gt;&lt;del&gt;HBASE-5228&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;REST&amp;#93;&lt;/span&gt; Rip out transform feature&lt;/p&gt;

&lt;p&gt;apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/rest/MultiRowResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/rest/RowResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/rest/TableResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/rest/transform&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/rest/TestTransform.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13190341" author="hudson" created="Sat, 21 Jan 2012 07:49:53 +0000"  >&lt;p&gt;Integrated in HBase-0.92-security #86 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.92-security/86/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.92-security/86/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5228&quot; title=&quot;[REST] Rip out &amp;quot;transform&amp;quot; feature&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5228&quot;&gt;&lt;del&gt;HBASE-5228&lt;/del&gt;&lt;/a&gt;. &lt;span class=&quot;error&quot;&gt;&amp;#91;REST&amp;#93;&lt;/span&gt; Rip out transform feature&lt;/p&gt;

&lt;p&gt;apurtell : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.92/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/rest/MultiRowResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/rest/RowResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/rest/TableResource.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/main/java/org/apache/hadoop/hbase/rest/transform&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.92/src/test/java/org/apache/hadoop/hbase/rest/TestTransform.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12511097" name="HBASE-5228-0.92.patch" size="23809" author="apurtell" created="Thu, 19 Jan 2012 06:44:16 +0000"/>
                            <attachment id="12511096" name="HBASE-5228-trunk.patch" size="23920" author="apurtell" created="Thu, 19 Jan 2012 06:44:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 19 Jan 2012 00:40:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>224385</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 47 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i069lj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34486</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>