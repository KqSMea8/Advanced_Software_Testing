<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:07:30 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3119/HBASE-3119.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3119] [rest] publish endpoint and statistics into ZooKeeper</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3119</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This change allows the REST interface to publish its endpoint and metrics, currently only requests/sec, into ZooKeeper. By default a permanent znode tree is created as needed at &lt;tt&gt;/hbase/rest/status&lt;/tt&gt; and Stargate instances create ephemeral children of this with names in the format &lt;tt&gt;&amp;lt;host&amp;gt;:&amp;lt;port&amp;gt;&lt;/tt&gt;. The ephemeral znodes contain JSON serialized information about the instance, e.g.&lt;/p&gt;

&lt;p&gt;    {{{&quot;connector&quot;:&lt;/p&gt;
{&quot;host&quot;:&quot;restserver.example.com&quot;,&quot;port&quot;:&quot;8080&quot;}
&lt;p&gt;,&quot;statistics&quot;:{&quot;requests&quot;:&quot;13&quot;}}}}&lt;/p&gt;

&lt;p&gt;The function of Stargate itself is not affected, except for one significant change: now if the ZooKeeper service is lost, the Stargate instances will abort along with the rest of HBase. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12477669">HBASE-3119</key>
            <summary>[rest] publish endpoint and statistics into ZooKeeper</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Oct 2010 21:42:22 +0000</created>
                <updated>Sun, 11 May 2014 11:06:28 +0000</updated>
                                                                            <component>REST</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12922287" author="hbasereviewboard" created="Mon, 18 Oct 2010 21:48:20 +0000"  >&lt;p&gt;Message from: &quot;Andrew Purtell&quot; &amp;lt;apurtell@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1039/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;This change allows the REST interface to publish its endpoint and metrics, currently only requests/sec, into ZooKeeper. By default a permanent znode tree is created as needed at /hbase/rest/status and Stargate instances create ephemeral children of this with names in the format &amp;lt;host&amp;gt;:&amp;lt;port&amp;gt;. The ephemeral znodes contain JSON serialized information about the instance, e.g.&lt;/p&gt;

&lt;p&gt;  {&quot;connector&quot;:&lt;/p&gt;
{&quot;host&quot;:&quot;restserver.example.com&quot;,&quot;port&quot;:&quot;8080&quot;}
&lt;p&gt;,&quot;statistics&quot;:{&quot;requests&quot;:&quot;13&quot;}}&lt;/p&gt;

&lt;p&gt;The function of Stargate itself is not affected, except for one significant change: now if the ZooKeeper service is lost, the Stargate instances will abort along with the rest of HBase.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3119&quot; title=&quot;[rest] publish endpoint and statistics into ZooKeeper&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3119&quot;&gt;HBASE-3119&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-3119&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-3119&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  src/main/java/org/apache/hadoop/hbase/HConstants.java 71c3e7b &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/rest/Main.java 368b4b4 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java ed92857 &lt;br/&gt;
  src/main/java/org/apache/hadoop/hbase/rest/metrics/RESTMetrics.java 284bbc5 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/1039/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Andrew&lt;/p&gt;

</comment>
                            <comment id="12922333" author="hbasereviewboard" created="Mon, 18 Oct 2010 22:35:26 +0000"  >&lt;p&gt;Message from: &quot;Ryan Rawson&quot; &amp;lt;ryanobjc@gmail.com&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1039/#review1560&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#review1560&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/HConstants.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/#comment5259&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#comment5259&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    do we want to migrate class-specific static config to those classes?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/rest/Main.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/#comment5260&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#comment5260&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    where did DEFAULT_LISTEN_PORT go to? i am not seeing it removed?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/#comment5262&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#comment5262&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    this looks clever, is it more generically useful to other parts of hbase?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/#comment5261&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#comment5261&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    redundant assignment?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/#comment5263&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#comment5263&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    ditto on this one. i wonder if there might be an elegant way to retry or redo zk operations, but there might not be.&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/#comment5264&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#comment5264&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    is this better called startZooKeeperClient?&lt;/p&gt;



&lt;p&gt;src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/#comment5265&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#comment5265&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    does this mean that stats are only updated every minute by default?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ryan&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12922339" author="hbasereviewboard" created="Mon, 18 Oct 2010 22:49:23 +0000"  >&lt;p&gt;Message from: &quot;Andrew Purtell&quot; &amp;lt;apurtell@apache.org&amp;gt;&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-18 15:34:45, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/HConstants.java, line 139&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/diff/1/?file=14872#file14872line139&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff/1/?file=14872#file14872line139&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     do we want to migrate class-specific static config to those classes?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;There are statics for other daemon ports nearby. I was following this convention.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-18 15:34:45, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java, line 217&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     this looks clever, is it more generically useful to other parts of hbase?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Other parts of HBase use ZKW methods to do this. I brought this in here to do the same without pulling in all of the behavior of ZKW I didn&apos;t want. &lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-18 15:34:45, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java, line 226&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line226&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line226&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     redundant assignment?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-18 15:34:45, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java, line 362&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line362&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line362&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     is this better called startZooKeeperClient?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ok, can do on commit.&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-18 15:34:45, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java, line 381&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line381&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line381&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     does this mean that stats are only updated every minute by default?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Andrew&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1039/#review1560&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#review1560&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="12922340" author="hbasereviewboard" created="Mon, 18 Oct 2010 22:51:23 +0000"  >&lt;p&gt;Message from: &quot;Ryan Rawson&quot; &amp;lt;ryanobjc@gmail.com&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1039/#review1565&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#review1565&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Ship it!&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ryan&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12922345" author="apurtell" created="Mon, 18 Oct 2010 23:05:27 +0000"  >&lt;p&gt;For &amp;gt; 0.90.&lt;/p&gt;</comment>
                            <comment id="12922352" author="hbasereviewboard" created="Mon, 18 Oct 2010 23:29:26 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-18 15:34:45, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java, line 217&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     this looks clever, is it more generically useful to other parts of hbase?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Andrew Purtell wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Other parts of HBase use ZKW methods to do this. I brought this in here to do the same without pulling in all of the behavior of ZKW I didn&apos;t want.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Which behaviors of ZKW are you referring to?  Hopefully this component is generally reusable (the new ZooKeeperWatcher) and could be used even in limited contexts.  Using it as the primary watcher and registering with it also helps when writing unit test.  You&apos;d then use ZKUtil methods for this kind of stuff and inherit work done there.&lt;/p&gt;

&lt;p&gt;We are going to need one more level underneath ZKUtil or underlying ZKUtil that manages retry policies and such.  I&apos;m going to target that for 0.92.  And if all our code uses these APIs then it will be easier to be consistent.&lt;/p&gt;

&lt;p&gt;The patch looks fine to me though so we can work at unifying later and not blocking you on this.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jonathan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1039/#review1560&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#review1560&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="12922360" author="hbasereviewboard" created="Mon, 18 Oct 2010 23:48:26 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-18 15:34:45, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java, line 217&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     this looks clever, is it more generically useful to other parts of hbase?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Andrew Purtell wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Other parts of HBase use ZKW methods to do this. I brought this in here to do the same without pulling in all of the behavior of ZKW I didn&apos;t want.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan Gray wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Which behaviors of ZKW are you referring to?  Hopefully this component is generally reusable (the new ZooKeeperWatcher) and could be used even in limited contexts.  Using it as the primary watcher and registering with it also helps when writing unit test.  You&apos;d then use ZKUtil methods for this kind of stuff and inherit work done there.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;We are going to need one more level underneath ZKUtil or underlying ZKUtil that manages retry policies and such.  I&apos;m going to target that for 0.92.  And if all our code uses these APIs then it will be easier to be consistent.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;The patch looks fine to me though so we can work at unifying later and not blocking you on this.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It also forces u into good behavior, for example, by needing to pass it an Abortable on construction.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jonathan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1039/#review1560&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#review1560&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="12922364" author="hbasereviewboard" created="Mon, 18 Oct 2010 23:52:20 +0000"  >&lt;p&gt;Message from: &quot;Andrew Purtell&quot; &amp;lt;apurtell@apache.org&amp;gt;&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-18 15:34:45, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java, line 217&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     this looks clever, is it more generically useful to other parts of hbase?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Andrew Purtell wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Other parts of HBase use ZKW methods to do this. I brought this in here to do the same without pulling in all of the behavior of ZKW I didn&apos;t want.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan Gray wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Which behaviors of ZKW are you referring to?  Hopefully this component is generally reusable (the new ZooKeeperWatcher) and could be used even in limited contexts.  Using it as the primary watcher and registering with it also helps when writing unit test.  You&apos;d then use ZKUtil methods for this kind of stuff and inherit work done there.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;We are going to need one more level underneath ZKUtil or underlying ZKUtil that manages retry policies and such.  I&apos;m going to target that for 0.92.  And if all our code uses these APIs then it will be easier to be consistent.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;The patch looks fine to me though so we can work at unifying later and not blocking you on this.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan Gray wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;It also forces u into good behavior, for example, by needing to pass it an Abortable on construction.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;One issue is the constructor creates or checks znodes that the REST interface should not care about. (I&apos;m thinking ahead to when ZK ACLs are in use a bit maybe.) Also I wanted automatic retry behavior for setData but that is something for which a wrapper around ZKUtil method calls would work. &lt;/p&gt;

&lt;p&gt;Unifying later should not be a big deal.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Andrew&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1039/#review1560&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#review1560&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="12922372" author="hbasereviewboard" created="Tue, 19 Oct 2010 00:04:21 +0000"  >&lt;p&gt;Message from: &quot;Jonathan Gray&quot; &amp;lt;jgray@apache.org&amp;gt;&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-10-18 15:34:45, Ryan Rawson wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; src/main/java/org/apache/hadoop/hbase/rest/RESTServlet.java, line 217&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/diff/1/?file=14874#file14874line217&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     this looks clever, is it more generically useful to other parts of hbase?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Andrew Purtell wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Other parts of HBase use ZKW methods to do this. I brought this in here to do the same without pulling in all of the behavior of ZKW I didn&apos;t want.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan Gray wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Which behaviors of ZKW are you referring to?  Hopefully this component is generally reusable (the new ZooKeeperWatcher) and could be used even in limited contexts.  Using it as the primary watcher and registering with it also helps when writing unit test.  You&apos;d then use ZKUtil methods for this kind of stuff and inherit work done there.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;We are going to need one more level underneath ZKUtil or underlying ZKUtil that manages retry policies and such.  I&apos;m going to target that for 0.92.  And if all our code uses these APIs then it will be easier to be consistent.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;The patch looks fine to me though so we can work at unifying later and not blocking you on this.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Jonathan Gray wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;It also forces u into good behavior, for example, by needing to pass it an Abortable on construction.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Andrew Purtell wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;One issue is the constructor creates or checks znodes that the REST interface should not care about. (I&apos;m thinking ahead to when ZK ACLs are in use a bit maybe.) Also I wanted automatic retry behavior for setData but that is something for which a wrapper around ZKUtil method calls would work. &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Unifying later should not be a big deal.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Good point, totally agree.  That definitely does not belong in the ZKW constructor.  The first master should do it and that&apos;s it.  Filed &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3123&quot; title=&quot;ZKW constructor should not always create nodes and should be more amenable to general usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3123&quot;&gt;&lt;del&gt;HBASE-3123&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jonathan&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/1039/#review1560&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/1039/#review1560&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="13047680" author="stack" created="Fri, 10 Jun 2011 22:58:19 +0000"  >&lt;p&gt;Moving out of 0.92.  Move it back in if you think differently.&lt;/p&gt;</comment>
                            <comment id="13047694" author="stack" created="Fri, 10 Jun 2011 22:58:21 +0000"  >&lt;p&gt;Moving out of 0.92.  Move it back in if you think differently.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12457485" name="HBASE-3119.patch" size="13726" author="apurtell" created="Mon, 18 Oct 2010 21:42:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 18 Oct 2010 21:48:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32909</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 27 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02ftz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12166</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>