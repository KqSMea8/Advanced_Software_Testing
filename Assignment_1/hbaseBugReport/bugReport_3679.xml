<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:12:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-3679/HBASE-3679.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-3679] Provide cost information associated with moving region(s)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-3679</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In order for load balancer to make better decision, we need to establish cost model for moving region(s).&lt;br/&gt;
One factor would be the number of active scanners on a particular region.&lt;br/&gt;
This count is easy to maintain at HRegion level. instantiateInternalScanner() can increment the counter and RegionScanner.close() would decrement the count.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12501996">HBASE-3679</key>
            <summary>Provide cost information associated with moving region(s)</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10">Implemented</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Mar 2011 23:12:46 +0000</created>
                <updated>Sun, 26 Jan 2014 22:45:09 +0000</updated>
                            <resolved>Sun, 26 Jan 2014 22:45:09 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>15</watches>
                                                                <comments>
                            <comment id="13009469" author="yuzhihong@gmail.com" created="Mon, 21 Mar 2011 23:26:17 +0000"  >&lt;p&gt;From Jonathan:&lt;br/&gt;
One of the hardest parts of load balancing based on request count and other dynamic/transient measures is that you can get some pretty pathological conditions where you are always moving stuff around.&lt;/p&gt;

&lt;p&gt;To guard against it, I think we&apos;ll need to move to more of a cost-based algorithm that is taking not just the difference in request counts into account but also a baseline &quot;cost&quot; of moving a region.  The cost difference in load between two unbalanced servers would have to outweigh the cost associated with moving a region.  As you say, looking at the number of live operations to a given region could contribute to the cost of moving that region, but the best measure for that is probably just looking at request count (it&apos;s all requests that incur a cost, not just active scanners).&lt;/p&gt;</comment>
                            <comment id="13009470" author="yuzhihong@gmail.com" created="Mon, 21 Mar 2011 23:34:36 +0000"  >&lt;p&gt;From Ryan:&lt;br/&gt;
it would make sense to avoid moving regions, so therefore the more&lt;br/&gt;
recently a region was moved, the less likely we should move it.&lt;/p&gt;

&lt;p&gt;you could imagine a hypothetical perfect &apos;region move cost&apos; function&lt;br/&gt;
that might look like:&lt;/p&gt;

&lt;p&gt;F(r) = timeSinceMoved(r) + size(r) + loadAvg(r)&lt;/p&gt;

&lt;p&gt;The functions should probably be normalized to &lt;span class=&quot;error&quot;&gt;&amp;#91;0,1&amp;#93;&lt;/span&gt;, so the range of&lt;br/&gt;
F would be &lt;span class=&quot;error&quot;&gt;&amp;#91;0,3&amp;#93;&lt;/span&gt; with 3 == &apos;dont move&apos; and 0 == &apos;move first&apos;.&lt;/p&gt;

&lt;p&gt;The goal is to minimize all the F(r&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;) in the moves.&lt;/p&gt;
</comment>
                            <comment id="13009495" author="dhruba" created="Tue, 22 Mar 2011 00:42:42 +0000"  >&lt;p&gt;What would we do in the following case:&lt;/p&gt;

&lt;p&gt;We have two region servers A and B in the cluster, A is doing 20K ops/sec while B is doing 5K ops/second. A client is encountering 10 ms latency per call from A while it sees a 30 ms latency per call from B.&lt;/p&gt;

&lt;p&gt;Are we going to move load from A to B or vice-versa?&lt;/p&gt;</comment>
                            <comment id="13009498" author="yuzhihong@gmail.com" created="Tue, 22 Mar 2011 00:50:34 +0000"  >&lt;p&gt;What would be a good way to measure (aggregately) latency incurred on client side ?&lt;/p&gt;</comment>
                            <comment id="13016227" author="yuzhihong@gmail.com" created="Wed, 6 Apr 2011 03:26:08 +0000"  >&lt;p&gt;From gaojinchao@huawei.com:&lt;br/&gt;
a short time hot spot can&apos;t move Region&lt;/p&gt;

&lt;p&gt;scan request number is larger than writer. do you take into it ?&lt;/p&gt;</comment>
                            <comment id="13022327" author="yuzhihong@gmail.com" created="Wed, 20 Apr 2011 19:33:23 +0000"  >&lt;p&gt;From Stack:&lt;/p&gt;

&lt;p&gt;I think the next step would be adding more smarts to balancer so it&lt;br/&gt;
could make calls on how loaded a regionserver was and so it had an&lt;br/&gt;
idea of how long a region had been open on a particular regionserver.&lt;br/&gt;
Anything that was open &amp;lt; 5 minutes or so would not be moved.&lt;br/&gt;
Something like that.  If a regionserver is taking lots of load, move a&lt;br/&gt;
selection of regions to the least loaded.&lt;/p&gt;

&lt;p&gt;Stack&apos;s comment from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-3799&quot; title=&quot;Provide more accurate check for super underloaded region server in load balancer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-3799&quot;&gt;&lt;del&gt;HBASE-3799&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
A general comment on balancing (that probably fits better elsewhere than as a comment on this issue) is that we need &apos;smoothing&apos; of region move.... Yesterday we brought a regionserver back online into a smallish cluster that was under load and the balance run unloaded a bunch of regions all in the one go which put a dent in the throughput;  it&apos;d be sweet if the balancer ran at an appropriate &apos;rate&apos;.  When under load, it should move regions &apos;gently&apos; rather than all as a big bang (the decommission script will move a region at a time, verifying it deployed in its new location before moving another... this can take ages to complete but its proven minimally disruptive to loadings)&lt;/p&gt;</comment>
                            <comment id="13041954" author="yuzhihong@gmail.com" created="Wed, 1 Jun 2011 03:01:19 +0000"  >&lt;p&gt;From Anty Rao:&lt;br/&gt;
When doing balance, Can we take into account the compaction status of regions.&lt;br/&gt;
Currently, even the region is doing compaction, it can also be interrupted&lt;br/&gt;
to response to reassign.&lt;/p&gt;</comment>
                            <comment id="13882469" author="stack" created="Sun, 26 Jan 2014 22:45:09 +0000"  >&lt;p&gt;See StochasticBalancer.  Resolving as implemented.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12504899">HBASE-3811</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12503142">HBASE-3724</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12508992">HBASE-3943</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 22 Mar 2011 00:42:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33143</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 46 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hncf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101044</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>