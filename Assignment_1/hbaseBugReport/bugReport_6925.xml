<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:41:04 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6925/HBASE-6925.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6925] Change socket write size from 8K to 64K for HBaseServer</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6925</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Creating a JIRA for this, but the change is trivial: change NIO_BUFFER_LIMIT from 8K to 64K in HBaseServer. This seems to increase scan throughput.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12609977">HBASE-6925</key>
            <summary>Change socket write size from 8K to 64K for HBaseServer</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12609956">HBASE-6922</parent>
                                    <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="karthik.ranga">Karthik Ranganathan</assignee>
                                    <reporter username="karthik.ranga">Karthik Ranganathan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Oct 2012 20:27:01 +0000</created>
                <updated>Wed, 18 Sep 2013 21:21:57 +0000</updated>
                            <resolved>Thu, 1 Nov 2012 21:42:01 +0000</resolved>
                                                    <fixVersion>0.94.3</fixVersion>
                    <fixVersion>0.95.0</fixVersion>
                                    <component>IPC/RPC</component>
                    <component>Performance</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13479664" author="xieliang007" created="Fri, 19 Oct 2012 06:46:04 +0000"  >&lt;p&gt;Revision1393467  shows the change has committed into 0.89-fb branch already&lt;/p&gt;</comment>
                            <comment id="13480344" author="karthik.ranga" created="Fri, 19 Oct 2012 20:14:13 +0000"  >&lt;p&gt;Yes, this is committed into 0.89.fb already, its a super-trivial change but does improve perf quite a bit.&lt;/p&gt;</comment>
                            <comment id="13480380" author="stack" created="Fri, 19 Oct 2012 20:57:15 +0000"  >&lt;p&gt;Bringing into 0.96.0.  We might want to put it in 0.94 too.  Change looks innocuous.  Would be nice to have some  numbers on how it improves Scan (thanks Karthik).&lt;/p&gt;</comment>
                            <comment id="13488454" author="lhofhansl" created="Thu, 1 Nov 2012 04:38:21 +0000"  >&lt;p&gt;I agree. This should go into 0.94 as well.&lt;/p&gt;</comment>
                            <comment id="13488455" author="lhofhansl" created="Thu, 1 Nov 2012 04:39:08 +0000"  >&lt;p&gt;+1 on committing to 0.94 and 0.96.&lt;/p&gt;</comment>
                            <comment id="13488459" author="karthik.ranga" created="Thu, 1 Nov 2012 04:50:52 +0000"  >&lt;p&gt;Missed Stack&apos;s question - this complex change alone gave a 25% best case improvement in scan throughput.&lt;/p&gt;</comment>
                            <comment id="13488466" author="lhofhansl" created="Thu, 1 Nov 2012 05:02:43 +0000"  >&lt;p&gt;Going to commit to 0.94 and 0.96 tomorrow.&lt;/p&gt;</comment>
                            <comment id="13488475" author="stack" created="Thu, 1 Nov 2012 05:22:03 +0000"  >&lt;p&gt;+1 on brother Karthiks&apos; word.&lt;/p&gt;</comment>
                            <comment id="13488476" author="lhofhansl" created="Thu, 1 Nov 2012 05:24:47 +0000"  >&lt;p&gt;Is this at all related to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4956&quot; title=&quot;Control direct memory buffer consumption by HBaseClient&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4956&quot;&gt;&lt;del&gt;HBASE-4956&lt;/del&gt;&lt;/a&gt;?&lt;br/&gt;
Do these two need to be coordinated?&lt;/p&gt;</comment>
                            <comment id="13488482" author="stack" created="Thu, 1 Nov 2012 05:36:41 +0000"  >&lt;p&gt;Good blast from the past Lars.  Would the chunking at 8k undo some of the benefit of 64k &apos;ing it?&lt;/p&gt;</comment>
                            <comment id="13488683" author="karthik.ranga" created="Thu, 1 Nov 2012 13:21:30 +0000"  >&lt;p&gt;Where is the chunking (that JIRA had a lot of stuff to parse)? Right now, in 89-fb, the client&apos;s nio send buffers are at 128K, and the input stream that reads from the nio buffer is only 8K. This change is on the server side. I would hypothesize that scan (which return a lot of data) will benefit from this.&lt;/p&gt;</comment>
                            <comment id="13488687" author="karthik.ranga" created="Thu, 1 Nov 2012 13:26:08 +0000"  >&lt;p&gt;Also, I was able to get the throughput of a single-threaded scan from a client of a block in the block-cache break 100MB/s (on whatever SKU I am using) - started around the 20MB/s. Will write a blog post about the various changes in detail if interested. I think there is scope to do even better. Prefetching is huge of-course - helps even more in case the block has to be read from disk.&lt;/p&gt;</comment>
                            <comment id="13488928" author="lhofhansl" created="Thu, 1 Nov 2012 18:55:18 +0000"  >&lt;p&gt;I&apos;d definitely be interested in the various changes that went into this.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4956&quot; title=&quot;Control direct memory buffer consumption by HBaseClient&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4956&quot;&gt;&lt;del&gt;HBASE-4956&lt;/del&gt;&lt;/a&gt; just fixes Result.readFields to read the resultbuffer in 8k chunks?&lt;br/&gt;
Would that defeat the purpose of this change?&lt;/p&gt;

&lt;p&gt;I can do some quick test on a single host, but that won&apos;t be very representative.&lt;/p&gt;</comment>
                            <comment id="13488973" author="lhofhansl" created="Thu, 1 Nov 2012 19:49:41 +0000"  >&lt;p&gt;I tried a local test (distributed HBase, but only a single RegionServer and Datanode all located on the same machine)... I could not discern any change in performance (as maybe expected from local-only test). I also changed the buffer size in Result.java, but again no difference.&lt;/p&gt;</comment>
                            <comment id="13488991" author="karthik.ranga" created="Thu, 1 Nov 2012 20:12:37 +0000"  >&lt;p&gt;No, I dont think that would matter, this is more about the socket transfer size into an underlying buffer.&lt;/p&gt;</comment>
                            <comment id="13488995" author="lhofhansl" created="Thu, 1 Nov 2012 20:22:46 +0000"  >&lt;p&gt;Thanks Karthik, I&apos;m going to commit, unless you want to &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13488997" author="stack" created="Thu, 1 Nov 2012 20:25:25 +0000"  >&lt;p&gt;Looks like HBaseClient in 89fb and in trunk or 0.94 are very different.  That might explain it Lars (Looking at the 89fb client, I can see how brother Karthik&apos;s change could make such a big difference).&lt;/p&gt;</comment>
                            <comment id="13489042" author="karthik.ranga" created="Thu, 1 Nov 2012 21:16:56 +0000"  >&lt;p&gt;Go for the commit Lars!&lt;/p&gt;</comment>
                            <comment id="13489056" author="lhofhansl" created="Thu, 1 Nov 2012 21:42:01 +0000"  >&lt;p&gt;Committed to 0.94 and 0.96.&lt;/p&gt;

&lt;p&gt;Thanks Karthik.&lt;/p&gt;</comment>
                            <comment id="13489148" author="hudson" created="Thu, 1 Nov 2012 23:35:36 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #3507 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/3507/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/3507/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6925&quot; title=&quot;Change socket write size from 8K to 64K for HBaseServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6925&quot;&gt;&lt;del&gt;HBASE-6925&lt;/del&gt;&lt;/a&gt; Change socket write size from 8K to 64K for HBaseServer (Karthik) (Revision 1404777)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/HBaseServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13489200" author="hudson" created="Fri, 2 Nov 2012 02:02:30 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #566 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/566/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/566/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6925&quot; title=&quot;Change socket write size from 8K to 64K for HBaseServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6925&quot;&gt;&lt;del&gt;HBASE-6925&lt;/del&gt;&lt;/a&gt; Change socket write size from 8K to 64K for HBaseServer (Karthik) (Revision 1404776)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/ipc/HBaseServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13489244" author="hudson" created="Fri, 2 Nov 2012 04:18:54 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-on-Hadoop-2.0.0 #247 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/247/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-2.0.0/247/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6925&quot; title=&quot;Change socket write size from 8K to 64K for HBaseServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6925&quot;&gt;&lt;del&gt;HBASE-6925&lt;/del&gt;&lt;/a&gt; Change socket write size from 8K to 64K for HBaseServer (Karthik) (Revision 1404777)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/ipc/HBaseServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13490399" author="hudson" created="Mon, 5 Nov 2012 01:35:36 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #9 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/9/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/9/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6925&quot; title=&quot;Change socket write size from 8K to 64K for HBaseServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6925&quot;&gt;&lt;del&gt;HBASE-6925&lt;/del&gt;&lt;/a&gt; Change socket write size from 8K to 64K for HBaseServer (Karthik) (Revision 1404776)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/ipc/HBaseServer.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12549815" name="HBASE-6925.patch" size="735" author="xieliang007" created="Fri, 19 Oct 2012 06:46:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 19 Oct 2012 06:46:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240886</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i016rb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4864</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Up RPC base buffer size from 8k to 64k.  Improves scanner throughput.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>