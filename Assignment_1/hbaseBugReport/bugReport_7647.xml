<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:47:43 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7647/HBASE-7647.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7647] 0.94 hfiles v2.1 are not backwards compatible with HFilev2.0</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7647</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When doing a rolling re-start from 0.92.x to 0.94.x any hfiles written by 0.94 are incompatibile with any of the 0.92 region servers.  This is caused by the checksums being put into 0.94.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;a minor version was added&lt;/li&gt;
	&lt;li&gt;checksums were put into the block&lt;/li&gt;
	&lt;li&gt;checksum meta data was added to block headers.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I propose that since these changes are only needed if using hbase.regionserver.checksum.verify, they should be turned off if that option is turned off.  Doing so will allow rolling upgrades to go smoother.&lt;/p&gt;

&lt;p&gt;If a user wants to go from a 0.92 cluster to a 0.94 cluster with hbase.regionserver.checksum.verify they can:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Roll out 0.94&lt;/li&gt;
	&lt;li&gt;Change hbase-site.xml&lt;/li&gt;
	&lt;li&gt;roll restart the region servers.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12628815">HBASE-7647</key>
            <summary>0.94 hfiles v2.1 are not backwards compatible with HFilev2.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eclark">Elliott Clark</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 Jan 2013 22:54:46 +0000</created>
                <updated>Sat, 16 Feb 2013 04:14:33 +0000</updated>
                            <resolved>Thu, 24 Jan 2013 20:48:57 +0000</resolved>
                                    <version>0.94.4</version>
                                    <fixVersion>0.94.5</fixVersion>
                                    <component>HFile</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13560197" author="yuzhihong@gmail.com" created="Tue, 22 Jan 2013 23:51:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;I propose that since these changes are only needed if using hbase.regionserver.checksum.verify, they should be turned off if that option is turned off.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13560282" author="eclark" created="Wed, 23 Jan 2013 01:20:38 +0000"  >&lt;p&gt;Here&apos;s first cut at this.  There are tests and all tests are geen locally.  I&apos;m doing a full test run now.&lt;/p&gt;</comment>
                            <comment id="13561278" author="jdcryans" created="Thu, 24 Jan 2013 00:35:15 +0000"  >&lt;p&gt;+1, looks good. I assume you tested running a cluster with checksums enabled in HBase then disabled them to see how it fared.&lt;/p&gt;</comment>
                            <comment id="13561284" author="hadoopqa" created="Thu, 24 Jan 2013 00:42:06 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12566065/HBASE-7647-1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12566065/HBASE-7647-1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4154//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4154//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13561285" author="mbertozzi" created="Thu, 24 Jan 2013 00:42:57 +0000"  >&lt;p&gt;What about the Delete bloom filter? &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4532&quot; title=&quot;Avoid top row seek by dedicated bloom filter for delete family bloom filter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4532&quot;&gt;&lt;del&gt;HBASE-4532&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Is that compatible?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/** Delete Family Bloom filter metadata, version 2 */
DELETE_FAMILY_BLOOM_META(&lt;span class=&quot;code-quote&quot;&gt;&quot;DFBLMET2&quot;&lt;/span&gt;, BlockCategory.BLOOM)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13561950" author="eclark" created="Thu, 24 Jan 2013 20:25:16 +0000"  >&lt;p&gt;Changed some formatting and spacing.&lt;/p&gt;

&lt;p&gt;I tested all the things that JD wanted and they all worked.&lt;/p&gt;

&lt;p&gt;The delete family bloom filter is a different issue and does appear that it will cause errors.&lt;/p&gt;</comment>
                            <comment id="13561958" author="hadoopqa" created="Thu, 24 Jan 2013 20:32:08 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12566367/HBASE-7647-2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12566367/HBASE-7647-2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 27 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/4164//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/4164//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13561968" author="eclark" created="Thu, 24 Jan 2013 20:48:57 +0000"  >&lt;p&gt;Committed revision 1438175.&lt;/p&gt;</comment>
                            <comment id="13562065" author="hudson" created="Thu, 24 Jan 2013 22:31:28 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #767 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/767/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/767/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7647&quot; title=&quot;0.94 hfiles v2.1 are not backwards compatible with HFilev2.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7647&quot;&gt;&lt;del&gt;HBASE-7647&lt;/del&gt;&lt;/a&gt; 0.94 hfiles v2.1 are not backwards compatible with HFilev2.0 (Revision 1438175)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
eclark : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileWriterV2.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/resources/hbase-default.xml&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/CacheTestUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestChecksum.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlock.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockCompatibility.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileDataBlockEncoder.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileWriterV2.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13562128" author="lhofhansl" created="Thu, 24 Jan 2013 23:26:11 +0000"  >&lt;p&gt;Good catch. Post mortem +1&lt;/p&gt;</comment>
                            <comment id="13562158" author="eclark" created="Fri, 25 Jan 2013 00:00:10 +0000"  >&lt;p&gt;TestMasterObserver passed 10x locally on my box.&lt;/p&gt;</comment>
                            <comment id="13562193" author="lhofhansl" created="Fri, 25 Jan 2013 00:25:31 +0000"  >&lt;p&gt;Yeah, I ran it too. I think that one is unrelated.&lt;/p&gt;</comment>
                            <comment id="13562490" author="hudson" created="Fri, 25 Jan 2013 07:21:05 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #97 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/97/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/97/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7647&quot; title=&quot;0.94 hfiles v2.1 are not backwards compatible with HFilev2.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7647&quot;&gt;&lt;del&gt;HBASE-7647&lt;/del&gt;&lt;/a&gt; 0.94 hfiles v2.1 are not backwards compatible with HFilev2.0 (Revision 1438175)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
eclark : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileWriterV2.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/resources/hbase-default.xml&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/CacheTestUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestChecksum.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlock.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockCompatibility.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileDataBlockEncoder.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileWriterV2.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13570996" author="hudson" created="Tue, 5 Feb 2013 03:58:30 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #11 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/11/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/11/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7647&quot; title=&quot;0.94 hfiles v2.1 are not backwards compatible with HFilev2.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7647&quot;&gt;&lt;del&gt;HBASE-7647&lt;/del&gt;&lt;/a&gt; 0.94 hfiles v2.1 are not backwards compatible with HFilev2.0 (Revision 1438175)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
eclark : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileBlock.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/io/hfile/HFileWriterV2.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/resources/hbase-default.xml&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/CacheTestUtils.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestChecksum.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlock.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockCompatibility.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileBlockIndex.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileDataBlockEncoder.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/io/hfile/TestHFileWriterV2.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12566367" name="HBASE-7647-2.patch" size="39831" author="eclark" created="Thu, 24 Jan 2013 20:25:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 22 Jan 2013 23:51:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>308293</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 45 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1b1jz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>272550</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>HFile v2.1 is not readable by RegionServers on 0.92 so default to writing older minor version unless checksums are needed.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>