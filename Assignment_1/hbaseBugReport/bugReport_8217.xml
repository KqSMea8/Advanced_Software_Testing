<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:53:08 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-8217/HBASE-8217.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-8217] Port online region merge (HBASE-7403) to 0.94</title>
                <link>https://issues.apache.org/jira/browse/HBASE-8217</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7403&quot; title=&quot;Online Merge&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7403&quot;&gt;&lt;del&gt;HBASE-7403&lt;/del&gt;&lt;/a&gt; added online region merge, and there was some discussion about whether we can port this to 0.94. &lt;/p&gt;

&lt;p&gt;In this issue, we can discuss feasibility and decide one what way or the other. I actually have a patch on top of backported &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7721&quot; title=&quot;Atomic multi-row mutations in META&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7721&quot;&gt;&lt;del&gt;HBASE-7721&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12639671">HBASE-8217</key>
            <summary>Port online region merge (HBASE-7403) to 0.94</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="enis">Enis Soztutar</assignee>
                                    <reporter username="enis">Enis Soztutar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Mar 2013 20:08:40 +0000</created>
                <updated>Mon, 1 Apr 2013 17:02:22 +0000</updated>
                            <resolved>Fri, 29 Mar 2013 07:58:15 +0000</resolved>
                                                                    <component>master</component>
                    <component>Region Assignment</component>
                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13616920" author="eclark" created="Fri, 29 Mar 2013 00:52:43 +0000"  >&lt;p&gt;I&apos;m -1 on backporting this.&lt;/p&gt;

&lt;p&gt;Reasons:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;In my opinion 0.94 is feature complete at this time.
	&lt;ul&gt;
		&lt;li&gt;I feel very strongly that it&apos;s incorrect to add new non bug fix code to 0.94.&lt;/li&gt;
		&lt;li&gt;0.94.x has been our stable release for quite a while. We shouldn&apos;t destabilize that.&lt;/li&gt;
		&lt;li&gt;Databases should not add features to point releases.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;This is experimental in trunk.&lt;/li&gt;
	&lt;li&gt;This relies on very new code that hasn&apos;t been proven yet.&lt;/li&gt;
	&lt;li&gt;Doesn&apos;t have integration tests.&lt;/li&gt;
	&lt;li&gt;There a lot of edge cases.
	&lt;ul&gt;
		&lt;li&gt;Mixed version clusters&lt;/li&gt;
		&lt;li&gt;Rolling upgrades while merging&lt;/li&gt;
		&lt;li&gt;Reference files&lt;/li&gt;
		&lt;li&gt;Merging daughter regions&lt;/li&gt;
		&lt;li&gt;multiple merges with reference files&lt;/li&gt;
		&lt;li&gt;merging while disabling&lt;/li&gt;
		&lt;li&gt;merging while schema edits&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Users have gotten by without this for a long time; for me this really suggests that the need for this in an old version is pretty low.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13616936" author="enis" created="Fri, 29 Mar 2013 01:11:41 +0000"  >&lt;p&gt;Attaching backported patch. This depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8196&quot; title=&quot;Port HBASE-7721 Atomic multi-row mutations in META to 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8196&quot;&gt;&lt;del&gt;HBASE-8196&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;A couple of changes from the original patch: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;RPC changes (obviously)&lt;/li&gt;
	&lt;li&gt;AM.processRegionsInTransition() handles SPLITTING/SPLIT and MERGING/MERGE cases, while 0.94 AM does not handle SPLITTING/SPLIT states. I did not add the corresponding MERGE changes. Shall we open another issue for adding the SPLIT changes?&lt;/li&gt;
	&lt;li&gt;CatalogJanitor is not exposed in 0.94 through RPC. Added some reflection code in test.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Rolling upgrades should work. I did not see a case which might cause a problem. However, obviously, you should not try to merge unless cluster is fully upgraded. &lt;/p&gt;



&lt;p&gt;Unit tests seem good. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Results :

Tests run: 1333, Failures: 0, Errors: 0, Skipped: 13

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13616960" author="enis" created="Fri, 29 Mar 2013 01:35:00 +0000"  >&lt;p&gt;Thanks Elliot for the comments. All valid converns. Let me try to show my view: &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I feel very strongly that it&apos;s incorrect to add new non bug fix code to 0.94.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This has been discussed a couple of times previously. The argument boils down to: 0.96 was targeted for fall last year, but having the next 0.96 GA will take another 2-3 months it seems. As in snapshots, and other issues, it depends on whether people really care about this feature or not. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;This is experimental in trunk.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We will mark this as experimental as well. But this will allow us to test it better and get it rock solid. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;There a lot of edge cases.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;These cases are hopefully covered by the patch. Obviously, doing merge while doing rolling upgrades won&apos;t work, but that is expected. You cannot merge regions having ref files. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;merging while schema edits&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Same problem with splits. That is why online schema alter is disabled by default.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Users have gotten by without this for a long time; for me this really suggests that the need for this in an old version is pretty low.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Not sure about it. It looks like, since we did not support it, users had to work around it.&lt;/p&gt;

&lt;p&gt;Again, these are valid concerns and if we cannot get enough interest, I&apos;ll close this as won&apos;t fix. I still think that there is merit to having this in. &lt;/p&gt;</comment>
                            <comment id="13616977" author="zjushch" created="Fri, 29 Mar 2013 01:52:25 +0000"  >&lt;p&gt;1.&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8196&quot; title=&quot;Port HBASE-7721 Atomic multi-row mutations in META to 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8196&quot;&gt;&lt;del&gt;HBASE-8196&lt;/del&gt;&lt;/a&gt; Atomic multi-row mutations in META requires a clean cluster update&lt;/p&gt;

&lt;p&gt;2.Online merge doesn&apos;t touch core code, the edge cases should be OK as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; answered&lt;/p&gt;


&lt;p&gt;I think whether it is worth having this in depending on the first point.&lt;/p&gt;</comment>
                            <comment id="13616990" author="jmhsieh" created="Fri, 29 Mar 2013 02:08:18 +0000"  >&lt;blockquote&gt;&lt;p&gt;This has been discussed a couple of times previously. The argument boils down to: 0.96 was targeted for fall last year, but having the next 0.96 GA will take another 2-3 months it seems. As in snapshots, and other issues, it depends on whether people really care about this feature or not.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I feel that the continued effort backporting is detracting from the ability to get a 0.95 out or a 0.96 out and continues a negative cycle of further delaying it.  &lt;/p&gt;

&lt;p&gt;We basically agreed that the decision is done case-by-case.  For me the bar for backporting features to a stable release is much higher than adding a feature to trunk or early releases (an x.0 or x.1).  &lt;/p&gt;

&lt;p&gt;In the case of snapshots, I was against backporting but the justification was that there were multiple plans backport in distros, and that the feature had major system/integration/fault-injection testing done to it before it was even considered merging to trunk let alone 0.94.6.  We missed a few minor edge cases, but I believe we caught all the major ones that a user could easily trigger, and constantly testied for weeks (in a branch) before merging.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We will mark this as experimental as well. But this will allow us to test it better and get it rock solid.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I really don&apos;t like adding more experimental features to a stable release.  Moreover, the caveat on snapshots to 0.94 was that it wasn&apos;t going to be ported unless it was already solid. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;These cases are hopefully covered by the patch.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The &lt;b&gt;hopefully&lt;/b&gt; part concerns me.  If we have some evidence that it is robust in the face of these cases (a script or integration test that others can run for a while to test stability), then I&apos;m a lot easier.  I haven&apos;t done much research into this but I feel the burden should be on the folks wanting to backport to make it convincing.&lt;/p&gt;</comment>
                            <comment id="13617017" author="enis" created="Fri, 29 Mar 2013 02:52:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;We basically agreed that the decision is done case-by-case. For me the bar for backporting features to a stable release is much higher than adding a feature to trunk or early releases (an x.0 or x.1).&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, and this issue is for discussing this case. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The hopefully part concerns me. If we have some evidence that it is robust in the face of these cases (a script or integration test that others can run for a while to test stability), then I&apos;m a lot easier&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, getting merges tested properly is already in my radar we have to do it no matter the backport. &lt;/p&gt;</comment>
                            <comment id="13617046" author="lhofhansl" created="Fri, 29 Mar 2013 04:10:59 +0000"  >&lt;p&gt;Folks, we have been through this before. I am getting a bit tired of this.&lt;/p&gt;

&lt;p&gt;We have no policy against backporting changes into 0.94.&lt;br/&gt;
0.94 is feature complete exactly when nobody wants to add features to it. It makes no sense to declare it such. (It did happen naturally for 0.92 and 0.90, and it will happen organically for 0.94)&lt;/p&gt;

&lt;p&gt;Further whether backporting detracts from 0.95 or later is an entirely besides the point (IMHO). This is an open source project, everybody is free to provide a patch, and we ought to look at any provided patch and decide on its merit on a case-by-case basis.&lt;/p&gt;

&lt;p&gt;Now, with that out of the way... Whether the code is stable or not is separate discussion.&lt;br/&gt;
On the count of the code being new and experimental in trunk I do agree with Jon and Elliot that we should not backport this at this time (even though I might have said otherwise before).&lt;/p&gt;</comment>
                            <comment id="13617047" author="lhofhansl" created="Fri, 29 Mar 2013 04:14:52 +0000"  >&lt;p&gt;The problem is that we&apos;re not using semantic versioning. If we had this that then any user can choose between the bleeding egde, new features, and less change. And now I&apos;ll shut up about this &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13617049" author="yuzhihong@gmail.com" created="Fri, 29 Mar 2013 04:15:59 +0000"  >&lt;p&gt;I think Lars made some good points above.&lt;/p&gt;

&lt;p&gt;Providing a patch here would allow more participants to evaluate this feature so that it is refined more quickly.&lt;/p&gt;</comment>
                            <comment id="13617111" author="eclark" created="Fri, 29 Mar 2013 05:54:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;Folks, we have been through this before. I am getting a bit tired of this.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I&apos;m sorry you disagree.  I&apos;ve used my -1 vote with lots of technical details as required by Apache.  I am not trying to re-hash old discussions.  I am just voting as Apache by laws specify for code modifications (including adding features into 0.94 branch).&lt;/p&gt;</comment>
                            <comment id="13617130" author="lhofhansl" created="Fri, 29 Mar 2013 06:22:29 +0000"  >&lt;p&gt;Hey, on technical grounds I was agreeing. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  And it is fine to -1 a feature or a patch.&lt;/p&gt;

&lt;p&gt;What I am objecting to is preemptively -1&apos;ing without seeing a patch and without disagreeing with the feature as such.&lt;br/&gt;
I was also objecting to declaring 0.94 &quot;feature complete&quot;. As long as folks want patches backported (and provide the patch) it is not. Same thing with making the argument that porting patches to 0.94 will somehow slow down 0.95.&lt;/p&gt;

&lt;p&gt;There are folks with data in 0.92 and 0.94 who can&apos;t or won&apos;t upgrade to 0.96. And herein lies the difference, you can go to any point released of 0.94 and back 0.92 if you so choose, but you cannot do that with 0.96.&lt;/p&gt;

&lt;p&gt;I want 0.96 out too, if we (Salesforce) could jump on 0.96 right away, it would save us a lot of headaches in the future.&lt;/p&gt;

&lt;p&gt;Anyway, let&apos;s just close this as &quot;won&apos;t fix&quot;.&lt;/p&gt;</comment>
                            <comment id="13617171" author="enis" created="Fri, 29 Mar 2013 07:58:15 +0000"  >&lt;p&gt;Thanks Lars, nice summary. &lt;/p&gt;

&lt;p&gt;As I said, backporting a feature should be on the ground of whether people are interested in supporting it or not based on enough interest. As always, there is risk to bringing new code, and we have to asses risk vs gain. This is business as usual. &lt;/p&gt;

&lt;p&gt;Resolving this as won&apos;t fix. Feel free to reopen, or use the attached patch if you need it. &lt;/p&gt;</comment>
                            <comment id="13617284" author="jmspaggi" created="Fri, 29 Mar 2013 12:22:01 +0000"  >&lt;p&gt;I just found we have been a bit to fast to open and then closed this JIRA. If 0.96 is coming only at the end of the year, it might have been good to give it a chance.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;, will the attached patch work even without &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8196&quot; title=&quot;Port HBASE-7721 Atomic multi-row mutations in META to 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8196&quot;&gt;&lt;del&gt;HBASE-8196&lt;/del&gt;&lt;/a&gt;?  Or is the patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8196&quot; title=&quot;Port HBASE-7721 Atomic multi-row mutations in META to 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8196&quot;&gt;&lt;del&gt;HBASE-8196&lt;/del&gt;&lt;/a&gt; good enought to be tested too with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8217&quot; title=&quot;Port online region merge (HBASE-7403) to 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8217&quot;&gt;&lt;del&gt;HBASE-8217&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13617369" author="yuzhihong@gmail.com" created="Fri, 29 Mar 2013 14:18:27 +0000"  >&lt;p&gt;@Jean-Marc:&lt;br/&gt;
See the first sentence here:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8217?focusedCommentId=13616936&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13616936&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-8217?focusedCommentId=13616936&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13616936&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13618923" author="apurtell" created="Mon, 1 Apr 2013 17:02:22 +0000"  >&lt;p&gt;Late to the discussion, sorry.&lt;/p&gt;

&lt;p&gt;+1 (or rather -1) to closing this wontfix on account of the risk assessment.&lt;/p&gt;

&lt;p&gt;-1 on the notion of anyone unilaterally declaring 0.94 &quot;feature complete&quot;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12575996" name="hbase-8217_v2.patch" size="185474" author="enis" created="Fri, 29 Mar 2013 01:11:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 29 Mar 2013 00:52:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320140</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 37 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j8kf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>