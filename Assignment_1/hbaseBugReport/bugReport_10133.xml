<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:10:46 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10133/HBASE-10133.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10133] ReplicationSource currentNbOperations overflows </title>
                <link>https://issues.apache.org/jira/browse/HBASE-10133</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Noticed in the logs we had lines like this: &lt;/p&gt;

&lt;p&gt;2013-12-11 00:02:00,343 DEBUG org.apache.hadoop.hbase.replication.regionserver.ReplicationSource: currentNbOperations:-1341767084 and seenEntries:0 and size: 0&lt;/p&gt;

&lt;p&gt;Maybe this value should be reset after we ship our edits this value should get adjusted.  Either that or convert from an int to a long.  &lt;/p&gt;

&lt;p&gt;As this is a jmx metric I feel its important to get this correct.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12684111">HBASE-10133</key>
            <summary>ReplicationSource currentNbOperations overflows </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="churromorales">churro morales</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Dec 2013 21:31:17 +0000</created>
                <updated>Thu, 12 Dec 2013 21:07:02 +0000</updated>
                            <resolved>Thu, 12 Dec 2013 19:17:59 +0000</resolved>
                                    <version>0.95.0</version>
                    <version>0.96.0</version>
                    <version>0.94.14</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13845753" author="jmspaggi" created="Wed, 11 Dec 2013 21:43:19 +0000"  >&lt;p&gt;This value represent &quot;Current number of operations (Put/Delete) that we need to replicate&quot;. That mean that you went over 2,147,483,647 operations in the queue??? I&apos;m not sure to get how this can overflow. Can you please provide more details on the situation?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="13846525" author="lhofhansl" created="Thu, 12 Dec 2013 18:10:07 +0000"  >&lt;p&gt;Huh... It is reset in run() loop.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      currentNbOperations = 0;
      List&amp;lt;HLog.Entry&amp;gt; entries = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;HLog.Entry&amp;gt;(1);
      currentSize = 0;
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (readAllEntriesToReplicateOrNextFile(currentWALisBeingWrittenTo, entries)) {
   ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It is only updated in readAllEntriesToReplicateOrNextFile, which is only called from the snippet above.&lt;br/&gt;
So it must have had &amp;gt; 2^31 entries to ship, which seems impossible.&lt;/p&gt;

&lt;p&gt;Further because we break out of the loop in readAllEntriesToReplicateOrNextFile after a certain size this must have come from a single WALEdit.&lt;/p&gt;

&lt;p&gt;Corrupt WAL, maybe?&lt;/p&gt;</comment>
                            <comment id="13846620" author="churromorales" created="Thu, 12 Dec 2013 19:17:49 +0000"  >&lt;p&gt;Lars, &lt;/p&gt;

&lt;p&gt;It did turn out to be a corrupt WAL.  You called it, I will close the issue. &lt;/p&gt;

&lt;p&gt;thanks &lt;br/&gt;
rahul&lt;/p&gt;</comment>
                            <comment id="13846739" author="lhofhansl" created="Thu, 12 Dec 2013 21:07:02 +0000"  >&lt;p&gt;I don&apos;t think it&apos;s &quot;Invalid&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Did you see any bad behavior from this? Did the RS OOM or do anything else bad?&lt;br/&gt;
We might want to detect this and handle it gracefully if it causes issues (at least print a WARN).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 11 Dec 2013 21:43:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>363183</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 1 week ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qlqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>363489</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>