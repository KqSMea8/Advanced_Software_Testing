<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:14:53 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10546/HBASE-10546.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10546] Two scanner objects are open for each hbase map task but only one scanner object is closed</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10546</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Map reduce framework calls createRecordReader of the TableInputFormat/MultiTableInputFormat to get the record reader instance. In this method, we are initializing the TableRecordReaderImpl (restart method). This initializes the scanner object. After this, map reduce framework calls initialize on the RecordReader. In our case, this calls restart of the TableRecordReaderImpl again. Here, it doesn&apos;t close the first scanner. At the end of the task, only the second scanner object is closed. Because of this, the smallest read point of HRegion is affected.&lt;/p&gt;

&lt;p&gt;We don&apos;t need to initialize the RecordReader in the createRecordReader method and we need to close the scanner object in the restart method. (incase if the restart method is called because of exceptions in the nextKeyValue method)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12695329">HBASE-10546</key>
            <summary>Two scanner objects are open for each hbase map task but only one scanner object is closed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vmariyala">Vasu Mariyala</assignee>
                                    <reporter username="vasu.mariyala@gmail.com">Vasu Mariyala</reporter>
                        <labels>
                    </labels>
                <created>Sat, 15 Feb 2014 01:00:43 +0000</created>
                <updated>Wed, 26 Feb 2014 04:45:38 +0000</updated>
                            <resolved>Tue, 18 Feb 2014 19:34:46 +0000</resolved>
                                                    <fixVersion>0.96.2</fixVersion>
                    <fixVersion>0.98.1</fixVersion>
                    <fixVersion>0.99.0</fixVersion>
                    <fixVersion>0.94.17</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13902231" author="yuzhihong@gmail.com" created="Sat, 15 Feb 2014 01:13:42 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13902300" author="lhofhansl" created="Sat, 15 Feb 2014 03:14:14 +0000"  >&lt;p&gt;Looks good. +1&lt;/p&gt;</comment>
                            <comment id="13902780" author="lhofhansl" created="Sun, 16 Feb 2014 18:57:13 +0000"  >&lt;p&gt;For 0.94, would it be safer to leave the initialize calls in place? I find it hard looking at the code that this will not cause any issues if somebody subclassed any of the involved classes. Seems safer to just have the change in restart (in the worst case we create a close a scanner per input split).&lt;/p&gt;</comment>
                            <comment id="13902900" author="lhofhansl" created="Mon, 17 Feb 2014 01:25:55 +0000"  >&lt;p&gt;Also see &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6069&quot; title=&quot;TableInputFormatBase#createRecordReader() doesn&amp;#39;t initialize TableRecordReader which causes NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6069&quot;&gt;&lt;del&gt;HBASE-6069&lt;/del&gt;&lt;/a&gt;, which &lt;b&gt;added&lt;/b&gt; the initialize we&apos;re removing now (to avoid an NPE with Hive).&lt;br/&gt;
With that in mind, we should not remove the initialize() calls.&lt;/p&gt;

&lt;p&gt;Let&apos;s just fix restart(...)&lt;/p&gt;</comment>
                            <comment id="13903567" author="lhofhansl" created="Mon, 17 Feb 2014 22:37:35 +0000"  >&lt;p&gt;Unless there are objections I&apos;ll commit to trunk version of the patch to all branches. We can always go back later and remove spurious calls to initialize. Right now I&apos;d prefer to keep them (&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vmariyala&quot; class=&quot;user-hover&quot; rel=&quot;vmariyala&quot;&gt;Vasu Mariyala&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="13904458" author="lhofhansl" created="Tue, 18 Feb 2014 19:34:46 +0000"  >&lt;p&gt;Committed trunk version to all branches.&lt;br/&gt;
Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vasu.mariyala%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;vasu.mariyala@gmail.com&quot;&gt;Vasu Mariyala&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13904538" author="hudson" created="Tue, 18 Feb 2014 20:23:14 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-security #417 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/417/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/417/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569487)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13904582" author="hudson" created="Tue, 18 Feb 2014 21:01:47 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-on-Hadoop-2 #29 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-on-Hadoop-2/29/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-on-Hadoop-2/29/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569487)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13904626" author="hudson" created="Tue, 18 Feb 2014 21:24:51 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94-JDK7 #58 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-JDK7/58/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-JDK7/58/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569487)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13904648" author="hudson" created="Tue, 18 Feb 2014 21:43:11 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-0.94 #1294 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/1294/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/1294/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569487)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13904747" author="hudson" created="Tue, 18 Feb 2014 22:51:49 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98 #165 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98/165/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98/165/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569495)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13904782" author="hudson" created="Tue, 18 Feb 2014 23:18:21 +0000"  >&lt;p&gt;FAILURE: Integrated in hbase-0.96 #299 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.96/299/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.96/299/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569493)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13904791" author="hudson" created="Tue, 18 Feb 2014 23:21:55 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-0.98-on-Hadoop-1.1 #154 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/154/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.98-on-Hadoop-1.1/154/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569495)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.98/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13904887" author="hudson" created="Wed, 19 Feb 2014 00:43:36 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-TRUNK #4928 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/4928/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/4928/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569500)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13904903" author="hudson" created="Wed, 19 Feb 2014 00:50:29 +0000"  >&lt;p&gt;FAILURE: Integrated in hbase-0.96-hadoop2 #207 (See &lt;a href=&quot;https://builds.apache.org/job/hbase-0.96-hadoop2/207/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/hbase-0.96-hadoop2/207/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569493)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.96/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13905032" author="hudson" created="Wed, 19 Feb 2014 02:21:17 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK-on-Hadoop-1.1 #93 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-1.1/93/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-on-Hadoop-1.1/93/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-10546&quot; title=&quot;Two scanner objects are open for each hbase map task but only one scanner object is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-10546&quot;&gt;&lt;del&gt;HBASE-10546&lt;/del&gt;&lt;/a&gt; Two scanner objects are open for each hbase map task but only one scanner object is closed. (Vasu Mariyala) (larsh: rev 1569500)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/hbase-server/src/main/java/org/apache/hadoop/hbase/mapreduce/TableRecordReaderImpl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12629171" name="0.94-HBASE-10546.patch" size="2174" author="vasu.mariyala@gmail.com" created="Sat, 15 Feb 2014 01:01:35 +0000"/>
                            <attachment id="12629173" name="trunk-HBASE-10546.patch" size="935" author="vasu.mariyala@gmail.com" created="Sat, 15 Feb 2014 01:06:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 15 Feb 2014 01:13:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>373837</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 43 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1sf8f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374137</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>