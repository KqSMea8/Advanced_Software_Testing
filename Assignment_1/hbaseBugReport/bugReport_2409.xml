<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:01:38 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2409/HBASE-2409.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2409] Daughters deployed to parents regionserver node, always</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2409</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Ryan apparently said this 6 months ago, that on split, the regions are assigned back to the parent hosting regionserver almost always.  Then, to keep up some kinda balance, the load balancer kicks and closes the just opened daughters &amp;#8211; which have just been opened a moment ago &amp;#8211; to deploy them elsewhere in the name of keeping good balance.&lt;/p&gt;

&lt;p&gt;This issue is to confirm the above behavior indeed happens and then to take action to make it so at least one of the daughters is held up so it doesn&apos;t go back to the current heartbeating host, the parent hosting server.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12461177">HBASE-2409</key>
            <summary>Daughters deployed to parents regionserver node, always</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                            <label>moved_from_0_20_5</label>
                    </labels>
                <created>Mon, 5 Apr 2010 21:35:01 +0000</created>
                <updated>Fri, 20 Nov 2015 12:40:58 +0000</updated>
                            <resolved>Tue, 1 Jun 2010 23:35:26 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12853571" author="streamy" created="Mon, 5 Apr 2010 22:30:53 +0000"  >&lt;p&gt;This kind of happens.&lt;/p&gt;

&lt;p&gt;It&apos;s always been the case that daughters of a split region get assigned back to the original regionserver.  In small clusters without lots of existing regions, this can cause the load balancer to kick in and close the just opened daughters.&lt;/p&gt;

&lt;p&gt;The story is kind of worse than that on a small cluster without lots of existing regions.&lt;/p&gt;

&lt;p&gt;If you are writing fast enough, it&apos;s quite easy to get regions that are 4X or more the split size.  This is because of stuff we&apos;re starting to deal with in other issues (&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2375&quot; title=&quot;Revisit compaction configuration parameters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2375&quot;&gt;&lt;del&gt;HBASE-2375&lt;/del&gt;&lt;/a&gt;, double flush optimization, etc).  By the time compaction finishes on a loaded cluster, you&apos;ve managed to snapshot/flush a bunch of additional StoreFiles for that same region.  So compaction finishes, decides to split, we close the region, flush the memstore, split, regions get assigned back, we open them, we compact them (we always compact opened regions when they contain references because we do not support splitting splits).  When the daughters get compacted, we decide to split again.  We close them, flush them, and again they get reassigned back.&lt;/p&gt;

&lt;p&gt;We had cases on 5 node clusters where you would see one server hosting root, one server hosting meta, two emtpy servers, and one server with 8 regions.&lt;/p&gt;

&lt;p&gt;If you keep the regions in this loop where they decide to split post initial compaction, that regionserver continues to get swamped.&lt;/p&gt;

&lt;p&gt;Anyways, we clearly need to have one of the daughters go to a different rs &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  Would also be good if it was not done in a fixed way that could cause the second daughter to always go to the same (different) server.&lt;/p&gt;</comment>
                            <comment id="12859204" author="stack" created="Wed, 21 Apr 2010 05:25:42 +0000"  >&lt;p&gt;Just to note that this does not happen all the time.  I&apos;ve seen it where daughters go to different regionservers.  We need to fix it though so the load balancer only cuts in at an extreme.  Currently its responsible for reams of needless churn, least as best as I can see.&lt;/p&gt;</comment>
                            <comment id="12866827" author="stack" created="Wed, 12 May 2010 23:48:43 +0000"  >&lt;p&gt;Bulk move of 0.20.5 issues into 0.21.0 after vote that we merge branch into TRUNK up on list.&lt;/p&gt;</comment>
                            <comment id="12874298" author="stack" created="Tue, 1 Jun 2010 23:35:26 +0000"  >&lt;p&gt;Daughters don&apos;t always go to the same RS.  Sometimes they do, especially before &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2167&quot; title=&quot;PE for IHBase&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2167&quot;&gt;&lt;del&gt;HBASE-2167&lt;/del&gt;&lt;/a&gt;  was fixed. Resolving as invalid.&lt;/p&gt;</comment>
                            <comment id="12874356" author="streamy" created="Wed, 2 Jun 2010 01:14:08 +0000"  >&lt;p&gt;IMO this &quot;issue&quot; still exists where splits almost always both go back to same RS.  To change that behavior requires explicit work to be done.  The &quot;tendencies&quot; that region transitions follow today will no longer hold with the master rewrite stuff going on as the piggybacking behavior is going away.  We need to define what we want to happen.&lt;/p&gt;

&lt;p&gt;I think this still might be an invalid issue or won&apos;t fix because we may not care about that behavior anymore.  Or we may actually want it.&lt;/p&gt;

&lt;p&gt;The primary reason this was problematic before was during an import into a new table.  With the new createTable api that allows you to specify a bunch of regions up front, it doesn&apos;t really matter as much if splits go to the same server.&lt;/p&gt;

&lt;p&gt;If we could do anything then and we aren&apos;t concerned about achieving immediate load balancing, it might be preferable for splits to stay on the same server.  This allows for a split to be totally contained on the RS without any interaction with the Master so we can have data unavailability really short, no need to reassignment.  This also lets client requests for both regions to still go to the right server, reducing META fetches.  Normal load balancing will balance overall cluster load over time.&lt;/p&gt;</comment>
                            <comment id="12874401" author="stack" created="Wed, 2 Jun 2010 03:48:44 +0000"  >&lt;p&gt;I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2652&quot; title=&quot;Open daughters immediately on parent&amp;#39;s regionserver&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2652&quot;&gt;&lt;del&gt;HBASE-2652&lt;/del&gt;&lt;/a&gt; to have daughters open immediately on parent&apos;s regionserver.&lt;/p&gt;</comment>
                            <comment id="12874407" author="streamy" created="Wed, 2 Jun 2010 04:03:35 +0000"  >&lt;p&gt;Awesome thanks stack&lt;/p&gt;
</comment>
                            <comment id="15016845" author="lars_francke" created="Fri, 20 Nov 2015 12:40:58 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 5 Apr 2010 22:30:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26293</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hhmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>