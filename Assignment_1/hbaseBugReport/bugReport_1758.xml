<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:56:07 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1758/HBASE-1758.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1758] Extract interface out of HTable</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1758</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;As per discussions in Hackathon, we have extracted interface out of HTable and named it as HTableInterface. This will make unit testing client code easier and simplify client API. &lt;/p&gt;

&lt;p&gt;It opens other possibilities such as creating a HTable that does not do any RPC calls, MockHTable etc.&lt;/p&gt;

&lt;p&gt;HTablePool still returns HTable instances. But we haxxve added a setter method for HTableInterfaceFactory on it. Thus developers can write their own HTableInterfaceFactory impl to return their own HTableInterface implementation. &lt;/p&gt;

&lt;p&gt;I have assigned this issue to 0.21 but you may consider it to move it to 0.20 if possible.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12432779">HBASE-1758</key>
            <summary>Extract interface out of HTable</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="pvaibhav">Vaibhav Puranik</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Aug 2009 14:19:34 +0000</created>
                <updated>Fri, 20 Nov 2015 13:02:02 +0000</updated>
                            <resolved>Tue, 13 Apr 2010 16:25:21 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                    <component>Client</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12741892" author="pvaibhav" created="Tue, 11 Aug 2009 14:20:15 +0000"  >&lt;p&gt;Attaching patch for HTableInterface&lt;/p&gt;</comment>
                            <comment id="12742182" author="apurtell" created="Wed, 12 Aug 2009 02:04:47 +0000"  >&lt;p&gt;+1, patch looks good.&lt;/p&gt;</comment>
                            <comment id="12742194" author="stack" created="Wed, 12 Aug 2009 03:19:51 +0000"  >&lt;p&gt;I like the @since 0.21.0&lt;/p&gt;

&lt;p&gt;newHTableInterface should be createHTableInterface?  (Just a suggestion &amp;#8211; whats usual factory semantics?  If you change it here, would need to change in HTablePool too where you do newHTable)&lt;/p&gt;

&lt;p&gt;New classes need the apache license on top.  Steal from another class and just make sure year is 2009.&lt;/p&gt;

&lt;p&gt;In the interface, should the methods be public?  Maybe it doesn&apos;t matter in an interface?&lt;/p&gt;

&lt;p&gt;I&apos;d remove the setTableFactory in HTablePool method.  Add a constructor that optionally takes a factory I&apos;d say that allows inserting other than HTableFactory.... but not as a method.&lt;/p&gt;

&lt;p&gt;HTableFactory should just be an inner-class of HTablePool?&lt;/p&gt;

&lt;p&gt;All of above are just suggestions.  Do as you will with them.  Only change required is addition of the apache license.&lt;/p&gt;

&lt;p&gt;Patch looks great.&lt;/p&gt;</comment>
                            <comment id="12742504" author="pvaibhav" created="Wed, 12 Aug 2009 18:16:32 +0000"  >&lt;p&gt;Stack, agreed with most of the comments.&lt;/p&gt;

&lt;p&gt;In a java interface all the methods are public by default, that is why I haven&apos;t mentioned the word public explicitly. &lt;/p&gt;

&lt;p&gt;In my opinion it is better to have the HTableFactory as a outer class. If somebody writes a new HTablePool impl that returns HTable, this outer class will be beneficial.&lt;/p&gt;

&lt;p&gt;I will submit the patch with all of the changes except the inner class one and explicitly mentioning public in the interface.. Hope that&apos;s ok.&lt;/p&gt;</comment>
                            <comment id="12742516" author="stack" created="Wed, 12 Aug 2009 18:45:51 +0000"  >&lt;p&gt;.bq Hope that&apos;s ok.&lt;/p&gt;

&lt;p&gt;Yes.&lt;/p&gt;</comment>
                            <comment id="12742899" author="pvaibhav" created="Thu, 13 Aug 2009 17:31:36 +0000"  >
&lt;p&gt;We have removed region awareness (methods such as getTableRegions etc) from the HTableInterface to simplify it. (As most of the clients won&apos;t really need it).&lt;/p&gt;

&lt;p&gt;There is one class in Stargate - RegionResource.  This class has a method - getTableRegions. We think that the method is just exposing HTable.getTableRegions through the REST interface.&lt;/p&gt;

&lt;p&gt;Now that we have removed getTableRegions from the HTableInterface, I think that this class RegionResource should be deleted.&lt;/p&gt;

&lt;p&gt;Andy, can you please comment? Is RegionResource  really needed?&lt;/p&gt;</comment>
                            <comment id="12743023" author="kweiner" created="Thu, 13 Aug 2009 23:50:31 +0000"  >&lt;p&gt;Vaibhav, rather than just to &quot;simplify&quot; things, I think the value in removing the concept of regions from the HTableInterface is more about defining the concept of a Table contract without imposing the notion that the table is split into regions.  Obviously everything within HBase needs to understand how table storage is implemented with regions, but client applications really don&apos;t need that knowledge.  They should be able to put, get, delete, etc. without thinking about the implementation.  A regionless-HTableInterface also allows for implementations that ignore the concept of regions such as for testing.&lt;/p&gt;</comment>
                            <comment id="12743513" author="apurtell" created="Sat, 15 Aug 2009 01:22:31 +0000"  >&lt;p&gt;RegionResource is not really needed IMO. Stargate has this because the other REST interface for HBase had a similar feature.&lt;/p&gt;</comment>
                            <comment id="12743524" author="pvaibhav" created="Sat, 15 Aug 2009 02:24:20 +0000"  >&lt;p&gt;Great. I will delete the class.&lt;/p&gt;</comment>
                            <comment id="12744133" author="pvaibhav" created="Mon, 17 Aug 2009 17:02:54 +0000"  >&lt;p&gt;This new patch includes:&lt;br/&gt;
1) Stack suggested changes&lt;br/&gt;
2) Stargate code changes for HTableInterface&lt;/p&gt;</comment>
                            <comment id="12744328" author="apurtell" created="Tue, 18 Aug 2009 01:51:01 +0000"  >&lt;p&gt;+1. The patch has a lot of whitespace changes but the actual code changes are fine. I&apos;ll commit this if all local HBase and Stargate tests pass. &lt;/p&gt;</comment>
                            <comment id="12744487" author="apurtell" created="Tue, 18 Aug 2009 12:48:20 +0000"  >&lt;p&gt;Committed to trunk. Passes all local tests except Stargate&apos;s TestTableResource but I fixed that up on commit.&lt;/p&gt;</comment>
                            <comment id="12744703" author="pvaibhav" created="Tue, 18 Aug 2009 20:57:31 +0000"  >&lt;p&gt;Thanks Andy!&lt;/p&gt;</comment>
                            <comment id="12785164" author="lars_francke" created="Thu, 3 Dec 2009 03:30:45 +0000"  >&lt;p&gt;Stumbled across these two things: &lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;delete(List&amp;lt;Delete&amp;gt;) is missing from the interface (but present in HTable)&lt;/li&gt;
	&lt;li&gt;I think get(Get) should mention what happens when the row could not be found so I edited the JavaDoc for this one&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I hope this is the right place for this. Didn&apos;t know if I should open a new ticket for it.&lt;/p&gt;</comment>
                            <comment id="12785181" author="stack" created="Thu, 3 Dec 2009 04:56:18 +0000"  >&lt;p&gt;In future, its best if you make a new issue once something has been closed.  Let me reopen.&lt;/p&gt;</comment>
                            <comment id="12785183" author="stack" created="Thu, 3 Dec 2009 04:57:51 +0000"  >&lt;p&gt;Reopening to getd Lars findings in&lt;/p&gt;</comment>
                            <comment id="12785346" author="lars_francke" created="Thu, 3 Dec 2009 14:46:53 +0000"  >&lt;p&gt;Thanks stack. Next time I&apos;ll open a new ticket!&lt;/p&gt;

&lt;p&gt;Two more things I found (attached a new patch, the old one is obsolete):&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Added documentation about what happens when incrementColumnValue is called and the specified column doesn&apos;t exist. I&apos;ve looked through the source code and I believe this to be correct but I&apos;d appreciate it if anyone could check. And please feel free to reword the text as I&apos;m not a native speaker&lt;/li&gt;
	&lt;li&gt;Added the incrementColumnValue method that allows disabling the WAL for this call&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;There are a lot of methods in HTable that are not exposed in HTableInterface (getStartKeys, isTableEnabled, getRegionsInfo etc.) but I suppose that is by design so I chose not to include them.&lt;/p&gt;</comment>
                            <comment id="12786501" author="stack" created="Sat, 5 Dec 2009 21:06:00 +0000"  >&lt;p&gt;Applied to TRUNK.  @Vaibhav Should we apply this patch to the branch?&lt;/p&gt;

&lt;p&gt;Thanks for the nice patch Lars.  FYI, make patches at $HBASE_HOME rather than in the classes&apos;s directory; i.e. this patch was made at $HBASE_HOME/src/java/org/apache/hadoop/client.... but not worrries... next time.  Thanks for fix.&lt;/p&gt;</comment>
                            <comment id="12788395" author="pvaibhav" created="Wed, 9 Dec 2009 23:51:00 +0000"  >&lt;p&gt;Lars, changes look good. You are right. We purposely omitted &apos;region awareness methods&apos; (getStartKeys, isTableEnabled, getRegionsInfo etc).&lt;/p&gt;

&lt;p&gt;@Stack,&lt;br/&gt;
I am little confused because of reopening of the same issue? We have to file a new issue if I understand the process rightly. we cannot make change to the released product, right?&lt;br/&gt;
In that case which branch were you talking about applying this patch to?&lt;/p&gt;</comment>
                            <comment id="12788397" author="stack" created="Wed, 9 Dec 2009 23:57:00 +0000"  >&lt;p&gt;@Vaibhav: I&apos;ll open new issue for applying on branch (I was letting process slip here to be easy on the new fella Lars &amp;#8211; he can do it &apos;proper&apos; way next time).&lt;/p&gt;</comment>
                            <comment id="12788398" author="stack" created="Wed, 9 Dec 2009 23:57:48 +0000"  >&lt;p&gt;Although on second thoughts, lets just not apply to branch.  Its needed in trunk only I believe.&lt;/p&gt;</comment>
                            <comment id="12790140" author="lars_francke" created="Mon, 14 Dec 2009 13:24:41 +0000"  >&lt;p&gt;@stack: Thanks for applying this and sorry for not following the correct process. I&apos;ll do better next time (this includes the correct base location of my patches).&lt;/p&gt;

&lt;p&gt;After a bit more reading of the code I think it might be a good idea to change the javadoc of incrementColumnValue once more to also include a note that a new row is inserted even if the row didn&apos;t exist before (the current version only mentions missing qualifiers). But I&apos;ll open a ticket for this and other doc fixes later.&lt;/p&gt;</comment>
                            <comment id="12790198" author="pvaibhav" created="Mon, 14 Dec 2009 15:10:45 +0000"  >&lt;p&gt;@Lars - Good catch. I had to send time to discover it. I had this in mind too. Thanks. If you are changing it, can you also change the doc in HTable? I don&apos;t know whether it&apos;s setup to inherit the doc.&lt;/p&gt;</comment>
                            <comment id="12856474" author="apurtell" created="Tue, 13 Apr 2010 16:25:21 +0000"  >&lt;p&gt;Committed to trunk. Comments indicate follow on issues opened to address remaining items (if any).&lt;/p&gt;</comment>
                            <comment id="15017961" author="lars_francke" created="Fri, 20 Nov 2015 13:02:02 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12416781" name="HTableInterface.patch" size="76198" author="pvaibhav" created="Mon, 17 Aug 2009 17:02:54 +0000"/>
                            <attachment id="12416205" name="HTableInterface.patch" size="10044" author="pvaibhav" created="Tue, 11 Aug 2009 14:21:07 +0000"/>
                            <attachment id="12426745" name="HTableinterface-deletes.patch" size="951" author="lars_francke" created="Thu, 3 Dec 2009 03:30:45 +0000"/>
                            <attachment id="12426781" name="HTableinterface.patch" size="2171" author="lars_francke" created="Thu, 3 Dec 2009 14:46:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 12 Aug 2009 02:04:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32251</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hf3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99709</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>