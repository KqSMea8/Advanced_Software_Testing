<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:52:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14391/HBASE-14391.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14391] Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14391</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When I restarted the hbase cluster in which there was few data, I found there are two directories for one host with different timestamp which indicates that the old regionserver wal directory is not deleted.&lt;br/&gt;
FHLog#989&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 @Override
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void close() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    shutdown();
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; FileStatus[] files = getFiles();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; != files &amp;amp;&amp;amp; 0 != files.length) {
      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (FileStatus file : files) {
        Path p = getWALArchivePath(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fullPathArchiveDir, file.getPath());
        &lt;span class=&quot;code-comment&quot;&gt;// Tell our listeners that a log is going to be archived.
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.listeners.isEmpty()) {
          &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (WALActionsListener i : &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.listeners) {
            i.preLogArchive(file.getPath(), p);
          }
        }

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!FSUtils.renameAndSetModifyTime(fs, file.getPath(), p)) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to rename &quot;&lt;/span&gt; + file.getPath() + &lt;span class=&quot;code-quote&quot;&gt;&quot; to &quot;&lt;/span&gt; + p);
        }
        &lt;span class=&quot;code-comment&quot;&gt;// Tell our listeners that a log was archived.
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.listeners.isEmpty()) {
          &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (WALActionsListener i : &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.listeners) {
            i.postLogArchive(file.getPath(), p);
          }
        }
      }
      LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Moved &quot;&lt;/span&gt; + files.length + &lt;span class=&quot;code-quote&quot;&gt;&quot; WAL file(s) to &quot;&lt;/span&gt; +
        FSUtils.getPath(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fullPathArchiveDir));
    }
    LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Closed WAL: &quot;&lt;/span&gt; + toString());
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When regionserver is stopped, the hlog will be archived, so wal/regionserver is empty in hdfs.&lt;/p&gt;

&lt;p&gt;MasterFileSystem#252&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (curLogFiles == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || curLogFiles.length == 0) {
            &lt;span class=&quot;code-comment&quot;&gt;// Empty log folder. No recovery needed
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;;
          }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The regionserver directory will be not splitted, it makes sense. But it will be not deleted.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12862692">HBASE-14391</key>
            <summary>Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="qianxiZhang">Qianxi Zhang</assignee>
                                    <reporter username="qianxiZhang">Qianxi Zhang</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Sep 2015 08:12:48 +0000</created>
                <updated>Mon, 3 Oct 2016 16:11:37 +0000</updated>
                                            <version>1.0.2</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.3.1</fixVersion>
                    <fixVersion>1.1.7</fixVersion>
                    <fixVersion>1.2.5</fixVersion>
                                    <component>wal</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="14737139" author="jinghe" created="Wed, 9 Sep 2015 16:30:50 +0000"  >&lt;p&gt;I have seen the same problem.  There werea bunch of empty region server log directories stayed around if there were many region severs.&lt;br/&gt;
See attached.&lt;br/&gt;
This seems to be a regression from the refactoring in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12522&quot; title=&quot;Backport WAL refactoring to branch-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12522&quot;&gt;&lt;del&gt;HBASE-12522&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="14737894" author="qianxizhang" created="Thu, 10 Sep 2015 00:39:39 +0000"  >&lt;p&gt;Yeah, I think so. I intend to fix this bug this weekend&lt;/p&gt;</comment>
                            <comment id="14738018" author="jinghe" created="Thu, 10 Sep 2015 02:19:49 +0000"  >&lt;p&gt;Sure.  Attach a patch when you are ready.&lt;/p&gt;</comment>
                            <comment id="14738064" author="qianxizhang" created="Thu, 10 Sep 2015 03:02:51 +0000"  >&lt;p&gt;Hey, Jerry&lt;/p&gt;

&lt;p&gt;I think there are two methods.&lt;br/&gt;
1. When the regionserver nomal stops(not abort) and closes the WAL, delete the regionserver WAL directory ( HBase 0.98 uses this method)&lt;br/&gt;
2. When the cluster starts, master checks all the regionserver directory, If the directory in empty then delete it.&lt;/p&gt;

&lt;p&gt;I incline to the first method.&lt;/p&gt;

&lt;p&gt;How do you think about it?&lt;/p&gt;
</comment>
                            <comment id="14738066" author="qianxizhang" created="Thu, 10 Sep 2015 03:02:53 +0000"  >&lt;p&gt;Hey, Jerry&lt;/p&gt;

&lt;p&gt;I think there are two methods.&lt;br/&gt;
1. When the regionserver nomal stops(not abort) and closes the WAL, delete the regionserver WAL directory ( HBase 0.98 uses this method)&lt;br/&gt;
2. When the cluster starts, master checks all the regionserver directory, If the directory in empty then delete it.&lt;/p&gt;

&lt;p&gt;I incline to the first method.&lt;/p&gt;

&lt;p&gt;How do you think about it?&lt;/p&gt;
</comment>
                            <comment id="14738067" author="qianxizhang" created="Thu, 10 Sep 2015 03:02:54 +0000"  >&lt;p&gt;Hey, Jerry&lt;/p&gt;

&lt;p&gt;I think there are two methods.&lt;br/&gt;
1. When the regionserver nomal stops(not abort) and closes the WAL, delete the regionserver WAL directory ( HBase 0.98 uses this method)&lt;br/&gt;
2. When the cluster starts, master checks all the regionserver directory, If the directory in empty then delete it.&lt;/p&gt;

&lt;p&gt;I incline to the first method.&lt;/p&gt;

&lt;p&gt;How do you think about it?&lt;/p&gt;
</comment>
                            <comment id="14738068" author="qianxizhang" created="Thu, 10 Sep 2015 03:02:57 +0000"  >&lt;p&gt;Hey, Jerry&lt;/p&gt;

&lt;p&gt;I think there are two methods.&lt;br/&gt;
1. When the regionserver nomal stops(not abort) and closes the WAL, delete the regionserver WAL directory ( HBase 0.98 uses this method)&lt;br/&gt;
2. When the cluster starts, master checks all the regionserver directory, If the directory in empty then delete it.&lt;/p&gt;

&lt;p&gt;I incline to the first method.&lt;/p&gt;

&lt;p&gt;How do you think about it?&lt;/p&gt;
</comment>
                            <comment id="14738168" author="jinghe" created="Thu, 10 Sep 2015 04:57:40 +0000"  >&lt;p&gt;The patch looks good.&lt;br/&gt;
Or you want to be a little conservative by setting recursive to false.  You can look at SplitLogManager.splitLogDistributed().  It cleans up the split log dirs.&lt;/p&gt;</comment>
                            <comment id="14738192" author="jinghe" created="Thu, 10 Sep 2015 05:27:10 +0000"  >&lt;p&gt;On the other hand, there isn&apos;t a real need to be conservative here.  In the SplitLogManager, we want to be conservative because those logs are for recovery.&lt;br/&gt;
+1 on your patch.&lt;/p&gt;</comment>
                            <comment id="14738243" author="eclark" created="Thu, 10 Sep 2015 06:14:52 +0000"  >&lt;p&gt;We&apos;ve seen hadoop moves fail before, why not be more conservative and not delete recursive ?&lt;/p&gt;</comment>
                            <comment id="14738249" author="qianxizhang" created="Thu, 10 Sep 2015 06:21:26 +0000"  >&lt;p&gt;Sorry Elliott, maybe I did not catch your idea. There are no fail moves, in fact we did not delete it before this patch.&lt;/p&gt;</comment>
                            <comment id="14739431" author="jinghe" created="Thu, 10 Sep 2015 19:30:27 +0000"  >&lt;p&gt;We throw exception and error out if fs rename call fails:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!FSUtils.renameAndSetModifyTime(fs, file.getPath(), p)) {
   &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to rename &quot;&lt;/span&gt; + file.getPath() + &lt;span class=&quot;code-quote&quot;&gt;&quot; to &quot;&lt;/span&gt; + p);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is this enough, Elliott?&lt;/p&gt;</comment>
                            <comment id="14739442" author="eclark" created="Thu, 10 Sep 2015 19:38:14 +0000"  >&lt;p&gt;Nope. I&apos;ve seen moves fail silently before. There&apos;s no harm asking to remove the directory non-recursive. It should always be empty. If it&apos;s not then something went wrong and deleting is not the right thing to do&lt;/p&gt;</comment>
                            <comment id="14739553" author="jinghe" created="Thu, 10 Sep 2015 20:43:24 +0000"  >&lt;p&gt;Ok, Let&apos;s set recursive to false, and give appropriate warning if we can not delete the directory.&lt;/p&gt;</comment>
                            <comment id="14739960" author="qianxizhang" created="Fri, 11 Sep 2015 01:05:25 +0000"  >&lt;p&gt;Thanks, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryhe&quot; class=&quot;user-hover&quot; rel=&quot;jerryhe&quot;&gt;Jerry He&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;&lt;br/&gt;
I will update the patch.&lt;/p&gt;</comment>
                            <comment id="14740145" author="eclark" created="Fri, 11 Sep 2015 04:16:07 +0000"  >&lt;p&gt;Thanks so much that looks awesome to me.&lt;/p&gt;</comment>
                            <comment id="14740231" author="jinghe" created="Fri, 11 Sep 2015 05:44:40 +0000"  >&lt;p&gt;Can you &apos;Submit the patch&apos; so that we have &apos;PATCH AVAILABLE&apos; to get a QA run?&lt;/p&gt;</comment>
                            <comment id="14742493" author="hadoopqa" created="Sun, 13 Sep 2015 13:50:43 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12755304/HBASE_14391_trunk_v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12755304/HBASE_14391_trunk_v2.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a9157379a3046a9d4c377675c932257c4ecb6597.&lt;br/&gt;
  ATTACHMENT ID: 12755304&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestKeepDeletes&lt;br/&gt;
                  org.apache.hadoop.hbase.client.TestIntraRowPagination&lt;br/&gt;
                  org.apache.hadoop.hbase.filter.TestColumnPrefixFilter&lt;br/&gt;
                  org.apache.hadoop.hbase.filter.TestMultipleColumnPrefixFilter&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestColumnSeeking&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestHRegionInfo&lt;br/&gt;
                  org.apache.hadoop.hbase.filter.TestInvocationRecordFilter&lt;br/&gt;
                  org.apache.hadoop.hbase.io.encoding.TestPrefixTree&lt;br/&gt;
                  org.apache.hadoop.hbase.io.encoding.TestSeekBeforeWithReverseScan&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestRegionObserverStacking&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestRegionMergeTransaction&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestMinVersions&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestScanner&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestDefaultCompactSelection&lt;br/&gt;
                  org.apache.hadoop.hbase.io.hfile.TestScannerSelectionUsingKeyRange&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestLogRollingNoCluster&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.wal.TestWALActionsListener&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestSplitTransaction&lt;br/&gt;
                  org.apache.hadoop.hbase.filter.TestDependentColumnFilter&lt;br/&gt;
                  org.apache.hadoop.hbase.filter.TestFilter&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestResettingCounters&lt;br/&gt;
                  org.apache.hadoop.hbase.coprocessor.TestCoprocessorInterface&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestWideScanner&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestScanWithBloomError&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15576//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15576//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15576//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15576//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15576//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15576//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15576//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15576//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14742740" author="jinghe" created="Mon, 14 Sep 2015 00:09:45 +0000"  >&lt;p&gt;The test failure are related. &lt;br/&gt;
There is a mistake in v2.  The delete should be on this.fullPathLogDir, not this.fullPathArchiveDir.&lt;/p&gt;</comment>
                            <comment id="14875940" author="jinghe" created="Fri, 18 Sep 2015 16:53:58 +0000"  >&lt;p&gt;I attached a v3 patch, which I tested it on a cluster.&lt;br/&gt;
The patch still does not work.&lt;br/&gt;
Now I understand why &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12522&quot; title=&quot;Backport WAL refactoring to branch-1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12522&quot;&gt;&lt;del&gt;HBASE-12522&lt;/del&gt;&lt;/a&gt; removed the code to delete the logDir.  Because now there can be multiple WALProvider sharing the same logDir.&lt;br/&gt;
For example, there is metaProvider and a default provider on the region server that holds the meta.  There are two FSHLog instances.&lt;br/&gt;
When we close the metaProvider, we only archive its log files.  We can not delete logDir because it may still contain log files from the other instance.&lt;/p&gt;</comment>
                            <comment id="14876075" author="hadoopqa" created="Fri, 18 Sep 2015 18:11:15 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12761139/HBASE-14391-master-v3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12761139/HBASE-14391-master-v3.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit d81fba59cfab5ed368fe888ff811a7f5064b18cc.&lt;br/&gt;
  ATTACHMENT ID: 12761139&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildBase&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestHRegion&lt;br/&gt;
                  org.apache.hadoop.hbase.regionserver.TestFailedAppendAndSync&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15633//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15633//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15633//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15633//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15633//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15633//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15633//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15633//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14876151" author="jinghe" created="Fri, 18 Sep 2015 18:58:52 +0000"  >&lt;p&gt;Continue from my last comment. In theory, it looks like deleting the logDir should be done at the WALFactory level since it knows all Providers are closed and will do a final cleanup for what is shared by the WALFactory.&lt;br/&gt;
But it does not make logical sense for the WALFactory to go down to the FSHLog level and know the FS layout in this case. &lt;br/&gt;
There are still holes in the the abstraction work for WALFactory and WALProvider.&lt;/p&gt;

&lt;p&gt;Maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt; has some insight suggestion.&lt;/p&gt;</comment>
                            <comment id="14900020" author="jinghe" created="Sun, 20 Sep 2015 18:37:36 +0000"  >&lt;p&gt;We can do some workaround fix to make the patch work, but it probably won&apos;t be a good one.&lt;br/&gt;
On the other hand, we can try to clean the empty logDirs during master startup.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qianxiZhang&quot; class=&quot;user-hover&quot; rel=&quot;qianxiZhang&quot;&gt;Qianxi Zhang&lt;/a&gt;, do you want to provide another patch?&lt;/p&gt;</comment>
                            <comment id="14900237" author="qianxizhang" created="Mon, 21 Sep 2015 05:57:16 +0000"  >&lt;p&gt;Of course. Thanks for the good advice.&lt;/p&gt;</comment>
                            <comment id="14900238" author="qianxizhang" created="Mon, 21 Sep 2015 05:57:20 +0000"  >&lt;p&gt;Of course. Thanks for the good advice.&lt;/p&gt;</comment>
                            <comment id="14900539" author="hadoopqa" created="Mon, 21 Sep 2015 11:44:38 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12761384/HBASE_14391_master_v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12761384/HBASE_14391_master_v4.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a7afc132e2db7ebbb571b43ae17161bff40b59c5.&lt;br/&gt;
  ATTACHMENT ID: 12761384&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15648//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15648//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15648//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15648//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15648//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15648//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15648//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15648//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14900998" author="jinghe" created="Mon, 21 Sep 2015 17:09:47 +0000"  >&lt;p&gt;v4 patch looks good.&lt;/p&gt;

&lt;p&gt;Will do some brief testing shortly and commit if there is no objection.  Will fix nit (e.g add warning message if delete failed) on commit.&lt;/p&gt;</comment>
                            <comment id="14901181" author="stack" created="Mon, 21 Sep 2015 18:50:06 +0000"  >&lt;p&gt;Patch LGTM. Thanks for doing a bit of testing &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryhe&quot; class=&quot;user-hover&quot; rel=&quot;jerryhe&quot;&gt;Jerry He&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14901513" author="jinghe" created="Mon, 21 Sep 2015 22:19:34 +0000"  >&lt;p&gt;I ran the patch on a cluster. It works well.&lt;br/&gt;
Committed to branch 1.1+&lt;/p&gt;

&lt;p&gt;Thanks for the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qianxiZhang&quot; class=&quot;user-hover&quot; rel=&quot;qianxiZhang&quot;&gt;Qianxi Zhang&lt;/a&gt;. Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14901663" author="hudson" created="Tue, 22 Sep 2015 00:19:20 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #190 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/190/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/190/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (Qianxi Zhang) (jerryjch: rev 9574c67610cf30eaad58de64171726eac954be9c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14901674" author="hudson" created="Tue, 22 Sep 2015 00:28:41 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.1 #671 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/671/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/671/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (Qianxi Zhang) (jerryjch: rev 242594d0b65ede977282520b5d4edecf3d2b9e26)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14901703" author="hudson" created="Tue, 22 Sep 2015 01:03:57 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2-IT #160 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2-IT/160/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2-IT/160/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (Qianxi Zhang) (jerryjch: rev 7e9f7b53a2c3900ba7a305dd8effab252c55e8f4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14901708" author="hudson" created="Tue, 22 Sep 2015 01:07:27 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.2 #189 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/189/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/189/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (Qianxi Zhang) (jerryjch: rev 7e9f7b53a2c3900ba7a305dd8effab252c55e8f4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14901720" author="hudson" created="Tue, 22 Sep 2015 01:15:28 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #171 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/171/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/171/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (Qianxi Zhang) (jerryjch: rev 9574c67610cf30eaad58de64171726eac954be9c)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14901724" author="hudson" created="Tue, 22 Sep 2015 01:18:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6825 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6825/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6825/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (Qianxi Zhang) (jerryjch: rev 8765ffb0ca2b1c39d864ac495f0b3ee2abc520ed)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14901803" author="jinghe" created="Tue, 22 Sep 2015 02:26:34 +0000"  >&lt;p&gt;Some of the test case failures seem to be related to the patch.&lt;br/&gt;
I will take a look and revert if needed.&lt;/p&gt;</comment>
                            <comment id="14901843" author="jinghe" created="Tue, 22 Sep 2015 03:04:39 +0000"  >&lt;p&gt;Reverted from all branches.&lt;/p&gt;</comment>
                            <comment id="14901849" author="stack" created="Tue, 22 Sep 2015 03:16:09 +0000"  >&lt;p&gt;For sure failures are related &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jerryhe&quot; class=&quot;user-hover&quot; rel=&quot;jerryhe&quot;&gt;Jerry He&lt;/a&gt;? Often we see failure on integration....&lt;/p&gt;</comment>
                            <comment id="14901938" author="jinghe" created="Tue, 22 Sep 2015 04:53:24 +0000"  >&lt;p&gt;Yes. They are.&lt;br/&gt;
The original patch is possibly deleting newly created logDir that does not yet have a writer created yet in a race.  My bad.&lt;/p&gt;</comment>
                            <comment id="14901971" author="hudson" created="Tue, 22 Sep 2015 05:34:34 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2-IT #161 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2-IT/161/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2-IT/161/&lt;/a&gt;)&lt;br/&gt;
Revert: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (jerryjch: rev 05cb051423953b913156e4950b67f3d9b28ada5f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14901992" author="hudson" created="Tue, 22 Sep 2015 05:55:45 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.1 #672 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/672/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/672/&lt;/a&gt;)&lt;br/&gt;
Revert: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (jerryjch: rev 489dd6427a499d09fb8cde4fbdd46303f0a57b20)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14902001" author="hudson" created="Tue, 22 Sep 2015 06:01:32 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6827 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6827/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6827/&lt;/a&gt;)&lt;br/&gt;
Revert: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (jerryjch: rev 45d67435adc9195325bfccc78b7e1a0202a446e5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14902162" author="hudson" created="Tue, 22 Sep 2015 07:40:55 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #192 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/192/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/192/&lt;/a&gt;)&lt;br/&gt;
Revert: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (jerryjch: rev 73ec3fdd5c64354ae8339baceed4ed0de229712d)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14902253" author="hudson" created="Tue, 22 Sep 2015 08:58:30 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.2 #191 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/191/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/191/&lt;/a&gt;)&lt;br/&gt;
Revert: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (jerryjch: rev 05cb051423953b913156e4950b67f3d9b28ada5f)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14902261" author="hudson" created="Tue, 22 Sep 2015 09:02:32 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #173 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/173/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/173/&lt;/a&gt;)&lt;br/&gt;
Revert: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14391&quot; title=&quot;Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14391&quot;&gt;HBASE-14391&lt;/a&gt; Empty regionserver WAL will never be deleted although the coresponding regionserver has been stale (jerryjch: rev 73ec3fdd5c64354ae8339baceed4ed0de229712d)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15265885" author="ndimiduk" created="Sun, 1 May 2016 19:06:04 +0000"  >&lt;p&gt;This one looks committed. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jinghe&quot; class=&quot;user-hover&quot; rel=&quot;jinghe&quot;&gt;Jerry He&lt;/a&gt; please mark it resolved with the fixVersion field set appropriately for all branches.&lt;/p&gt;</comment>
                            <comment id="15265886" author="ndimiduk" created="Sun, 1 May 2016 19:06:41 +0000"  >&lt;p&gt;Reading more carefully. Please disregard.&lt;/p&gt;</comment>
                            <comment id="15422240" author="stack" created="Tue, 16 Aug 2016 05:54:34 +0000"  >&lt;p&gt;Moved fix version to 1.2.4 from 1.2.3 (patch was committed and then reverted)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12761139" name="HBASE-14391-master-v3.patch" size="728" author="jinghe" created="Fri, 18 Sep 2015 16:39:53 +0000"/>
                            <attachment id="12761384" name="HBASE_14391_master_v4.patch" size="859" author="qianxiZhang" created="Mon, 21 Sep 2015 08:27:03 +0000"/>
                            <attachment id="12755062" name="HBASE_14391_trunk_v1.patch" size="717" author="qianxiZhang" created="Thu, 10 Sep 2015 04:21:00 +0000"/>
                            <attachment id="12755304" name="HBASE_14391_trunk_v2.patch" size="726" author="qianxiZhang" created="Fri, 11 Sep 2015 02:26:01 +0000"/>
                            <attachment id="12754942" name="WALs-leftover-dir.txt" size="13880" author="jinghe" created="Wed, 9 Sep 2015 16:23:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 9 Sep 2015 16:30:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jxq7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>