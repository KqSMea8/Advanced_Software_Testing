<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 21:13:45 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-16401/HBASE-16401.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-16401] Enable HeapMemoryManager by default in 2.0</title>
                <link>https://issues.apache.org/jira/browse/HBASE-16401</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Back in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5349&quot; title=&quot;Automagically tweak global memstore and block cache sizes based on workload&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5349&quot;&gt;&lt;del&gt;HBASE-5349&lt;/del&gt;&lt;/a&gt;, on the end of the issue, we talked about enabling HeapMemoryManager by default. Lets do it for 2.0 with some conservative boundaries. Do it now so we have some experience running it before release.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12996726">HBASE-16401</key>
            <summary>Enable HeapMemoryManager by default in 2.0</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Aug 2016 18:57:56 +0000</created>
                <updated>Tue, 8 Nov 2016 18:29:39 +0000</updated>
                                                            <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                            <comments>
                            <comment id="15417750" author="stack" created="Thu, 11 Aug 2016 19:00:19 +0000"  >&lt;p&gt;Make sure the metrics in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14743&quot; title=&quot;Add metrics around HeapMemoryManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14743&quot;&gt;&lt;del&gt;HBASE-14743&lt;/del&gt;&lt;/a&gt;  help when we enable HeapMemoryManager as our default.&lt;/p&gt;</comment>
                            <comment id="15417779" author="stack" created="Thu, 11 Aug 2016 19:18:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt; Any suggestion for what ranges to use as defaults? Thanks boss.&lt;/p&gt;</comment>
                            <comment id="15418728" author="anoop.hbase" created="Fri, 12 Aug 2016 11:55:40 +0000"  >&lt;p&gt;Created 2 subtasks. These were missed in 1st phase.   Now with off heaping also in place (Read path we have) and write path also will be coming soon, we might have to consider tuning that also?  Need to see.  Let me complete these 2 subtasks before making it ON by default.&lt;/p&gt;</comment>
                            <comment id="15420058" author="larsgeorge" created="Sat, 13 Aug 2016 20:02:11 +0000"  >&lt;p&gt;I&apos;d suggest something like 20-40% for both. We now have 40% + 40% as default. I would say a sensible min range would be 20% for both, and leave the 40% as maximum?&lt;/p&gt;</comment>
                            <comment id="15420987" author="larsgeorge" created="Mon, 15 Aug 2016 13:42:48 +0000"  >&lt;p&gt;Whoops, I meant 20%-60% for each, so that it makes 80% in total.&lt;/p&gt;</comment>
                            <comment id="15501288" author="anoop.hbase" created="Sun, 18 Sep 2016 16:59:19 +0000"  >&lt;p&gt;I am checking this more and raising sub tasks for issues..  Related to evicted block count which is used for the tune decision there is some issue&lt;br/&gt;
1. We use the stat evictedBlocksCount - A block can get evicted because of eviction thread due to lack of space or because of removal of an HFile itself (After a compaction). We should not consider the latter in the tune decision at all.  These are actually invalidation of blocks.  Should the stat counter itself not use this count of evicted blocks? I think yes.  This will give wrong message to users that there are lot of real eviction happening.&lt;br/&gt;
2. In case L1+ L2 combined block cache, what we use is the sum of evictions from both.  But we will be tuning L1 size alone. Eviction count from L2 should not affect the tuning of L1&lt;br/&gt;
Will raise a sub task to fix this issue.&lt;/p&gt;</comment>
                            <comment id="15644898" author="anoop.hbase" created="Mon, 7 Nov 2016 18:06:36 +0000"  >&lt;p&gt;I think we need to keep it lower. 2.0 we recommend G1GC ?  It would be better not to keep permanent reserved heap at a so high rate.&lt;br/&gt;
Block cache we allow to be 0% even and till 40% as def.  On side note, after the off heaping work, we can suggest off heap L2 cache as default for the data cache now. We can keep L1 cache for index data.  This should be very less size requirement.&lt;br/&gt;
Even memstore also 20 - 40% is good enough? Or may be 20 - 50%?  Just saying.&lt;/p&gt;</comment>
                            <comment id="15645117" author="stack" created="Mon, 7 Nov 2016 19:14:22 +0000"  >&lt;p&gt;So what is to be done in here then &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;? Should it be blocker on 2.0?&lt;/p&gt;</comment>
                            <comment id="15646353" author="anoop.hbase" created="Tue, 8 Nov 2016 03:32:30 +0000"  >&lt;p&gt;I think so. Missing sub tasks all are closed.. Will see E2E once more.  The algo for tune decision is more matured now after some followup tasks.  Only thing is we need to have good default values for the max and min sizes for memstore size and BC size.  May be the L2 off heap BC enabling also we need to consider? There is one bug abt the L2 cache fragmentation which is another blocker for the L2 enabling IMO.  Will visit these tasks once the pending 2, 3 tasks in off heap write path is over.&lt;/p&gt;</comment>
                            <comment id="15648305" author="ram_krish" created="Tue, 8 Nov 2016 18:09:05 +0000"  >&lt;p&gt;Working on one of the subtasks of offheap write path. WE may have to do two things before we enable it in 2.0&lt;br/&gt;
-&amp;gt; If we have offheap write path support do not auto tune memstore size. As offheap memstore is adding a new config for global.offheap.memstore.size - this heap memory tuner is going to adjust the memstore size on heap. It may or may not be relevant.&lt;br/&gt;
-&amp;gt; Add support in such a way that based on the flush request, we should determine if the flush happened due to offheap global memstore limit or was it due to the memstore heap limit ( that happens due to references). How ever, in case of offheap generally we won&apos;t be hitting the memstore heap limit and in that case decreasing the global memstore heap percent is not ideally correct which may also lead to decrease in memstore chunk pool size. &lt;/p&gt;</comment>
                            <comment id="15648367" author="anoop.hbase" created="Tue, 8 Nov 2016 18:29:39 +0000"  >&lt;p&gt;Ya there should be some way to do #2.  Hope the sub task in off heap write, will do this.&lt;br/&gt;
#1 It should be ok to consider the flushes due to heap pressure , even if it is off heap memstore.  Any way we need to make sure to pass only heap related stats to tuner. After all it is HeapMemoryManger/Tuner.    We might need Off heap tuning also?  May be later. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12909764">HBASE-14743</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12952284">HBASE-15513</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12996926">HBASE-16407</subtask>
                            <subtask id="12996927">HBASE-16408</subtask>
                            <subtask id="13005774">HBASE-16650</subtask>
                            <subtask id="13020023">HBASE-17071</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Aug 2016 11:55:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i327zr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>