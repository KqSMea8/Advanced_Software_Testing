<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:15:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4025/HBASE-4025.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4025] Server startup fails during startup due to failure in loading all table descriptors. We should ignore .logs,.oldlogs,.corrupt,.META.,-ROOT- folders while reading descriptors </title>
                <link>https://issues.apache.org/jira/browse/HBASE-4025</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;2011-06-23 21:39:52,524 WARN org.apache.hadoop.hbase.monitoring.TaskMonitor: Status org.apache.hadoop.hbase.monitoring.MonitoredTaskImpl@2f56f920 appears to have been leaked&lt;br/&gt;
2011-06-23 21:40:06,465 WARN org.apache.hadoop.hbase.master.HMaster: Failed getting all descriptors&lt;br/&gt;
java.io.FileNotFoundException: No status for hdfs://ciq.com:9000/hbase/.corrupt&lt;br/&gt;
	at org.apache.hadoop.hbase.util.FSUtils.getTableInfoModtime(FSUtils.java:888)&lt;br/&gt;
	at org.apache.hadoop.hbase.util.FSTableDescriptors.get(FSTableDescriptors.java:122)&lt;br/&gt;
	at org.apache.hadoop.hbase.util.FSTableDescriptors.getAll(FSTableDescriptors.java:149)&lt;br/&gt;
	at org.apache.hadoop.hbase.master.HMaster.getHTableDescriptors(HMaster.java:1442)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.WritableRpcEngine$Server.call(WritableRpcEngine.java:340)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1138)&lt;br/&gt;
2011-06-23 21:40:26,790 WARN org.apache.hadoop.hbase.master.HMaster: Failed getting all descriptors&lt;br/&gt;
java.io.FileNotFoundException: No status for hdfs://ciq.com:9000/hbase/.corrupt&lt;br/&gt;
	at org.apache.hadoop.hbase.util.FSUtils.getTableInfoModtime(FSUtils.java:888)&lt;br/&gt;
	at org.apache.hadoop.hbase.util.FSTableDescriptors.get(FSTableDescriptors.java:122)&lt;br/&gt;
	at org.apache.hadoop.hbase.util.FSTableDescriptors.getAll(FSTableDescriptors.java:149)&lt;br/&gt;
	at org.apache.hadoop.hbase.master.HMaster.getHTableDescriptors(HMaster.java:1442)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.WritableRpcEngine$Server.call(WritableRpcEngine.java:340)&lt;br/&gt;
	at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1138)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12511423">HBASE-4025</key>
            <summary>Server startup fails during startup due to failure in loading all table descriptors. We should ignore .logs,.oldlogs,.corrupt,.META.,-ROOT- folders while reading descriptors </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="iamknome">Subbu M Iyer</assignee>
                                    <reporter username="iamknome">Subbu M Iyer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Jun 2011 23:54:00 +0000</created>
                <updated>Tue, 28 Aug 2012 22:55:10 +0000</updated>
                            <resolved>Tue, 28 Aug 2012 22:55:10 +0000</resolved>
                                    <version>0.92.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="13054587" author="iamknome" created="Fri, 24 Jun 2011 18:01:39 +0000"  >&lt;p&gt;First draft to ignore the .corrupt folder during getAll descriptor API call.&lt;/p&gt;</comment>
                            <comment id="13054590" author="iamknome" created="Fri, 24 Jun 2011 18:06:27 +0000"  >&lt;p&gt;May be we should create all tables under /hbase/tables/&amp;lt;table name&amp;gt; instead of /hbase/&amp;lt;table name&amp;gt; so that we can avoid future cases where we create other folder under /hbase such as .logs,.corrupt et al that does not contain table descriptors?&lt;/p&gt;

&lt;p&gt;So, this pattern will have some thing like:&lt;/p&gt;

&lt;p&gt;/hbase/.logs&lt;br/&gt;
/hbase/.corrupt&lt;br/&gt;
/hbase/.oldlogs&lt;br/&gt;
/hbase/.META.&lt;br/&gt;
/hbase/&lt;del&gt;ROOT&lt;/del&gt;&lt;br/&gt;
/hbase/&amp;lt;future non user system folders&amp;gt;&lt;br/&gt;
/hbase/UserTables/&amp;lt;user table folder&amp;gt;/.tableinfo&lt;/p&gt;

&lt;p&gt;and when we need to retrieve all the table descriptors we simply iterate over the /hbase/UserTables folder rather than the /hbase and ignore all system folders.&lt;/p&gt;

&lt;p&gt;Other option would be:&lt;br/&gt;
/hbase/System/.logs, .oldlogs, .corrupt et al.&lt;br/&gt;
/hbase/UserTables/&amp;lt;user tables&amp;gt;&lt;/p&gt;

&lt;p&gt;This way we can avoid adding a band-aid fix to this read table descriptor logic every time we have a new system folder.&lt;/p&gt;

&lt;p&gt;thoughts?&lt;/p&gt;
</comment>
                            <comment id="13054599" author="yuzhihong@gmail.com" created="Fri, 24 Jun 2011 18:13:59 +0000"  >&lt;p&gt;A third option &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
/hbase/System/.logs, .oldlogs, .corrupt et al.&lt;br/&gt;
/hbase/&amp;lt;user tables&amp;gt;&lt;/p&gt;

&lt;p&gt;Users/developers are used to the current hdfs structure. This would introduce relatively small impact to existing user tables.&lt;/p&gt;

&lt;p&gt;Let&apos;s see what other developers think.&lt;/p&gt;</comment>
                            <comment id="13054610" author="yuzhihong@gmail.com" created="Fri, 24 Jun 2011 18:23:37 +0000"  >&lt;p&gt;Overall +1&lt;br/&gt;
I am running test suite.&lt;/p&gt;

&lt;p&gt;Minor comment, maybe there is a better place for hbaseNonTableDirs but I don&apos;t have strong opinion.&lt;br/&gt;
In HConstants, all constants are in upper case. How about renaming it to HBASE_NON_USER_TABLE_DIRS ?&lt;/p&gt;</comment>
                            <comment id="13054685" author="iamknome" created="Fri, 24 Jun 2011 21:24:09 +0000"  >&lt;p&gt;Agree regarding the naming of variable to HBASE_NON_USER_TABLE_DIRS and as far as where it should go, I don&apos;t have a strong opinion either.&lt;/p&gt;

&lt;p&gt;As far as other issue is concerned, we can go either way as long as we have unique way of identifying all the user tables.&lt;/p&gt;</comment>
                            <comment id="13054740" author="ghelmling" created="Fri, 24 Jun 2011 23:13:41 +0000"  >&lt;p&gt;Since we already have rules for valid user table names, why not just apply those in the directory listing?&lt;/p&gt;

&lt;p&gt;User tables are not allowed to start with &apos;.&apos; or &apos;&lt;del&gt;&apos;, so ignore directory entries beginning with those.  Special case &apos;.META.&apos; and &apos;-ROOT&lt;/del&gt;&apos;, since that&apos;s what we do most places for those 2 tables anyway.&lt;/p&gt;

&lt;p&gt;We already generally are following a convention of &quot;system&quot; directories starting with &apos;.&apos;, so this seems sufficient to me.  No need to move anything around.&lt;/p&gt;</comment>
                            <comment id="13054742" author="ghelmling" created="Fri, 24 Jun 2011 23:15:16 +0000"  >&lt;p&gt;(repeating above but with formatting fixed)...&lt;/p&gt;

&lt;p&gt;Since we already have rules for valid user table names, why not just apply those in the directory listing?&lt;/p&gt;

&lt;p&gt;User tables are not allowed to start with &apos;.&apos; or &apos;&amp;#45;&apos;, so ignore directory entries beginning with those. Special case &apos;.META.&apos; and &apos;&amp;#45;ROOT&amp;#45;&apos;, since that&apos;s what we do most places for those 2 tables anyway.&lt;/p&gt;

&lt;p&gt;We already generally are following a convention of &quot;system&quot; directories starting with &apos;.&apos;, so this seems sufficient to me. No need to move anything around.&lt;/p&gt;</comment>
                            <comment id="13054920" author="yuzhihong@gmail.com" created="Sat, 25 Jun 2011 15:22:33 +0000"  >&lt;p&gt;Integrated to TRUNK after renaming hbaseNonTableDirs.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Subbu.&lt;/p&gt;</comment>
                            <comment id="13056278" author="stack" created="Tue, 28 Jun 2011 04:08:54 +0000"  >&lt;p&gt;Just to say that what Gary remarks is indeed the intent of the &apos;.&apos; prefix naming of log dirs, etc.  This patch has hard-coding of dirs to exclude when we could have done an FS filter that skips all dirs that begin &apos;.&apos;.  No harm.  Next time through we&apos;ll change it.&lt;/p&gt;</comment>
                            <comment id="13056842" author="hudson" created="Tue, 28 Jun 2011 22:42:48 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #1995 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/1995/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/1995/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="13443616" author="lhofhansl" created="Tue, 28 Aug 2012 22:55:10 +0000"  >&lt;p&gt;This was committed, marking it such.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12483751" name="HBASE-4025_-_Server_startup_fails_while_reading_table_descriptor_from__corrupt_folder_1.patch" size="4025" author="iamknome" created="Fri, 24 Jun 2011 18:01:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 24 Jun 2011 18:13:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27134</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hp1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>101320</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>