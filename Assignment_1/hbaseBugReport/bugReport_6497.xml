<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:37:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6497/HBASE-6497.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6497] Revisit HLog sizing and roll parameters</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6497</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The last major update to the HLog sizing and roll features were done in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1394&quot; title=&quot;Uploads sometimes fall to 0 requests/second (Binding up on HLog#append?)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1394&quot;&gt;&lt;del&gt;HBASE-1394&lt;/del&gt;&lt;/a&gt;. I am proposing to revisit these settings to overcome recent issues where the HLog becomes a major bottleneck.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12601165">HBASE-6497</key>
            <summary>Revisit HLog sizing and roll parameters</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="larsgeorge">Lars George</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Aug 2012 05:43:28 +0000</created>
                <updated>Mon, 6 Aug 2012 19:02:44 +0000</updated>
                                                                            <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                <comments>
                            <comment id="13427130" author="larsgeorge" created="Thu, 2 Aug 2012 06:08:23 +0000"  >&lt;p&gt;The goal in designing a proper HBase schema is to maximize heap usage across all regions, which can lead to the situation where the WALs (aka HLog&apos;s) are required to be kept for a considerable amount of time. &lt;/p&gt;

&lt;p&gt;The last iteration on WAL properties added a configurable block size, as well as threshold percentage to roll the log before it completely fills the single HDFS block (see &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1394&quot; title=&quot;Uploads sometimes fall to 0 requests/second (Binding up on HLog#append?)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1394&quot;&gt;&lt;del&gt;HBASE-1394&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;I am questioning if this is still in issue, maybe even in the light of recent improvements on log performance, for example &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5699&quot; title=&quot;Run with &amp;gt; 1 WAL in HRegionServer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5699&quot;&gt;&lt;del&gt;HBASE-5699&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4608&quot; title=&quot;HLog Compression&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4608&quot;&gt;&lt;del&gt;HBASE-4608&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;At the least, I would like to figure out, if we should increase the WAL size to 512MB, to avoid getting into early flushing situations, impacting the overall I/O. Isn&apos;t &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1364&quot; title=&quot;[performance] Distributed splitting of regionserver commit logs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1364&quot;&gt;&lt;del&gt;HBASE-1364&lt;/del&gt;&lt;/a&gt; helping to split larger logs (though not the logs themselves but distributed across the region servers obviously). I am not sure if the log splitting prefers block local nodes first, so that there is no remote reading though.&lt;/p&gt;

&lt;p&gt;Questions:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Is there a need to keep the logs small (typically 64-128 depending on the HDFS config)?&lt;/li&gt;
	&lt;li&gt;Should we go multiple blocks?&lt;/li&gt;
	&lt;li&gt;Do we still need the logroll multiplier?&lt;/li&gt;
	&lt;li&gt;Should we increase the maxlogs number (default is 32)?&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13427260" author="qwertymaniac" created="Thu, 2 Aug 2012 12:09:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;Should we increase the maxlogs number (default is 32)?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We should decrease the maxlogs number for recovery to be faster, right? Increasing help prevents any premature form of flushes on regions caused by the log roller during heavy writes, but impacts recovery time as all HLogs will then get unnecessarily processed.&lt;/p&gt;

&lt;p&gt;In order to keep the recovery times same as today, we can switch the numbers this way:&lt;/p&gt;

&lt;p&gt;If current is 128 MB x 32 = 4096 MB (4 GB) of logs approx. before full flush, then lets change that to have fewer than 32 files (reduces NN RPCs during recovery and increases the sequential read length) on to 8 maxlogs at 512 MB default size (8x512 = 4096 again). Or we could set a target of 8 GB and work out from that?&lt;/p&gt;</comment>
                            <comment id="13427403" author="apurtell" created="Thu, 2 Aug 2012 15:57:31 +0000"  >&lt;p&gt;&amp;gt; Is there a need to keep the logs small (typically 64-128 depending on the HDFS config)?&lt;/p&gt;

&lt;p&gt;At least for the case of replication being active, then yes we do want to hold down the log size. But that would not be the default case.&lt;/p&gt;

&lt;p&gt;&amp;gt; Should we increase the maxlogs number (default is 32)?&lt;/p&gt;

&lt;p&gt;With distributed splitting, I think we can.&lt;/p&gt;</comment>
                            <comment id="13427615" author="jdcryans" created="Thu, 2 Aug 2012 21:13:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;Is there a need to keep the logs small (typically 64-128 depending on the HDFS config)?&lt;/p&gt;&lt;/blockquote&gt;

&lt;blockquote&gt;&lt;p&gt;If current is 128 MB x 32 = 4096 MB (4 GB) of logs approx. before full flush, then lets change that to have fewer than 32 files (reduces NN RPCs during recovery and increases the sequential read length) on to 8 maxlogs at 512 MB default size (8x512 = 4096 again).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Issues with bigger files while having less of them:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Less parallelization during distributed splitting since the unit of distribution is a file.&lt;/li&gt;
	&lt;li&gt;Less opportunities to get rid of logs without having to force flush regions. The worst case would be having max 1 file meaning that when you roll you need to force flush everything that hasn&apos;t been flushed yet.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13428544" author="qwertymaniac" created="Sat, 4 Aug 2012 02:56:10 +0000"  >&lt;blockquote&gt;&lt;p&gt;Less parallelization during distributed splitting since the unit of distribution is a file.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Less parallelization per RS. If you have a lot of RSes, lowering file count does help reduce HBase RPCs too?&lt;/p&gt;</comment>
                            <comment id="13429350" author="jdcryans" created="Mon, 6 Aug 2012 19:02:44 +0000"  >&lt;blockquote&gt;&lt;p&gt;Less parallelization per RS. If you have a lot of RSes, lowering file count does help reduce HBase RPCs too?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m not sure I understand what you mean. HBase RPCs in which context?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 2 Aug 2012 12:09:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241871</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 19 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02fhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12111</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>