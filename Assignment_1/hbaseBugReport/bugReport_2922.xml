<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:05:53 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2922/HBASE-2922.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2922] HLog preparation and cleanup are done under the updateLock, major slowdown</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2922</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Something I&apos;ve seen quite often in our production environment:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;2010-08-16 16:17:27,104 INFO org.apache.hadoop.hbase.regionserver.HLog: removing old hlog file /hbase/.logs/rs22,60020,1280909840873/hlog.dat.1282000385321 whose highest sequence/edit id is 64837079950&lt;br/&gt;
2010-08-16 16:17:27,286 INFO org.apache.hadoop.hbase.regionserver.HLog: removing old hlog file /hbase/.logs/rs22,60020,1280909840873/hlog.dat.1282000392770 whose highest sequence/edit id is 64837088260&lt;br/&gt;
2010-08-16 16:17:27,452 INFO org.apache.hadoop.hbase.regionserver.HLog: removing old hlog file /hbase/.logs/rs22,60020,1280909840873/hlog.dat.1282000399300 whose highest sequence/edit id is 64837096566&lt;br/&gt;
2010-08-16 16:17:27,635 INFO org.apache.hadoop.hbase.regionserver.HLog: removing old hlog file /hbase/.logs/rs22,60020,1280909840873/hlog.dat.1282000406997 whose highest sequence/edit id is 64837104865&lt;br/&gt;
2010-08-16 16:17:27,827 INFO org.apache.hadoop.hbase.regionserver.HLog: removing old hlog file /hbase/.logs/rs22,60020,1280909840873/hlog.dat.1282000413803 whose highest sequence/edit id is 64837113153&lt;br/&gt;
2010-08-16 16:17:27,993 INFO org.apache.hadoop.hbase.regionserver.HLog: removing old hlog file /hbase/.logs/rs22,60020,1280909840873/hlog.dat.1282000421709 whose highest sequence/edit id is 64837121467&lt;br/&gt;
2010-08-16 16:17:28,160 INFO org.apache.hadoop.hbase.regionserver.HLog: removing old hlog file /hbase/.logs/rs22,60020,1280909840873/hlog.dat.1282000427333 whose highest sequence/edit id is 64837129775&lt;br/&gt;
2010-08-16 16:17:28,432 INFO org.apache.hadoop.hbase.regionserver.HLog: removing old hlog file /hbase/.logs/rs22,60020,1280909840873/hlog.dat.1282000434365 whose highest sequence/edit id is 64837138074&lt;br/&gt;
2010-08-16 16:17:28,518 INFO org.apache.hadoop.hbase.regionserver.HLog: removing old hlog file /hbase/.logs/rs22,60020,1280909840873/hlog.dat.1282000440347 whose highest sequence/edit id is 64837146376&lt;br/&gt;
2010-08-16 16:17:28,612 WARN org.apache.hadoop.hbase.regionserver.HLog: IPC Server handler 39 on 60020 took 1801ms appending an edit to hlog; editcount=0&lt;br/&gt;
2010-08-16 16:17:28,615 WARN org.apache.hadoop.hbase.regionserver.HLog: IPC Server handler 37 on 60020 took 1804ms appending an edit to hlog; editcount=1&lt;br/&gt;
2010-08-16 16:17:28,615 WARN org.apache.hadoop.hbase.regionserver.HLog: IPC Server handler 25 on 60020 took 1805ms appending an edit to hlog; editcount=2&lt;br/&gt;
...&lt;br/&gt;
2010-08-16 16:17:28,619 WARN org.apache.hadoop.hbase.regionserver.HLog: IPC Server handler 41 on 60020 took 1875ms appending an edit to hlog; editcount=50&lt;br/&gt;
2010-08-16 16:17:28,619 WARN org.apache.hadoop.hbase.regionserver.HLog: IPC Server handler 24 on 60020 took 1876ms appending an edit to hlog; editcount=51&lt;br/&gt;
2010-08-16 16:17:28,619 WARN org.apache.hadoop.hbase.regionserver.HLog: IPC Server handler 48 on 60020 took 1881ms appending an edit to hlog; editcount=54&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;And looking at HLog.rollWriter, we roll then cleanup those unused hlog files under updateLock, which blocks all the appenders (as shown). We should only do the first part under that lock&lt;/p&gt;</description>
                <environment></environment>
        <key id="12471762">HBASE-2922</key>
            <summary>HLog preparation and cleanup are done under the updateLock, major slowdown</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdcryans">Jean-Daniel Cryans</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Aug 2010 23:31:44 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:31 +0000</updated>
                            <resolved>Sat, 21 Aug 2010 00:27:27 +0000</resolved>
                                    <version>0.20.6</version>
                    <version>0.89.20100621</version>
                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12900548" author="hbasereviewboard" created="Fri, 20 Aug 2010 01:11:12 +0000"  >&lt;p&gt;Message from: &quot;Jean-Daniel Cryans&quot; &amp;lt;jdcryans@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/694/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Simply moves the LogActionListeners and outputfiles handling out of the updateLock synchronization.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2922&quot; title=&quot;HLog preparation and cleanup are done under the updateLock, major slowdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2922&quot;&gt;&lt;del&gt;HBASE-2922&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-2922&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-2922&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  /trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java 987355 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/694/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests and some PEs.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jean-Daniel&lt;/p&gt;

</comment>
                            <comment id="12900903" author="hbasereviewboard" created="Fri, 20 Aug 2010 22:57:16 +0000"  >&lt;p&gt;Message from: &quot;Jean-Daniel Cryans&quot; &amp;lt;jdcryans@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/694/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-08-20 15:51:17.366257)&lt;/p&gt;


&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;New patch, I decided to dig even more into this problem as I&apos;m thinking that what happens in the updateLock should be as quick as possible. The difference with the previous patch is that the new HLog is created before we take the updateLock, as well as all the preparation surrounding that. Then I tested on a randomWrite 4 + 6 incrementing threads on a single RS that was instrumented to sysout the time it took to go through the sync block in rollWriter.&lt;/p&gt;

&lt;p&gt;Without the patch:&lt;br/&gt;
Test duration: 406835ms&lt;br/&gt;
Total sync block duration: 56048ms&lt;br/&gt;
Percentage of the time updates were blocked: 13.7%&lt;br/&gt;
Average time in sync block: 610ms&lt;br/&gt;
Median time in sync block: 37ms&lt;/p&gt;

&lt;p&gt;With the patch:&lt;br/&gt;
Test duration: 383503ms&lt;br/&gt;
Total sync block duration: 14072ms&lt;br/&gt;
Percentage of the time updates were blocked: 3.6%&lt;br/&gt;
Average time in sync block: 142ms&lt;br/&gt;
Median time in sync block: 3ms&lt;/p&gt;

&lt;p&gt;Comments:&lt;br/&gt;
I was surprised by how closing a HLog could take a wildly varying time. In both cases I saw multi-seconds to close a writer (as you can tell by the averages compared to medians). In any case, my patch makes it much faster and less blocking. Your mileage may vary.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Simply moves the LogActionListeners and outputfiles handling out of the updateLock synchronization.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2922&quot; title=&quot;HLog preparation and cleanup are done under the updateLock, major slowdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2922&quot;&gt;&lt;del&gt;HBASE-2922&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-2922&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-2922&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  /trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java 987355 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/694/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests and some PEs.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jean-Daniel&lt;/p&gt;

</comment>
                            <comment id="12900909" author="hbasereviewboard" created="Fri, 20 Aug 2010 23:12:29 +0000"  >&lt;p&gt;Message from: &quot;Jean-Daniel Cryans&quot; &amp;lt;jdcryans@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/694/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2010-08-20 15:58:27.771023)&lt;/p&gt;


&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary (updated)&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Simply moves the LogActionListeners and outputfiles handling out of the updateLock synchronization, as well as the creation of the next log file.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2922&quot; title=&quot;HLog preparation and cleanup are done under the updateLock, major slowdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2922&quot;&gt;&lt;del&gt;HBASE-2922&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;http://issues.apache.org/jira/browse/HBASE-2922&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/HBASE-2922&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  /trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java 987355 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;http://review.cloudera.org/r/694/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Unit tests and some PEs.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Jean-Daniel&lt;/p&gt;

</comment>
                            <comment id="12900913" author="hbasereviewboard" created="Fri, 20 Aug 2010 23:22:08 +0000"  >&lt;p&gt;Message from: stack@duboce.net&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/694/#review976&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/#review976&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/694/#comment3169&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/#comment3169&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This is an invariant?  Will multiple threads arriving here at same time pickup same filenum?&lt;/p&gt;



&lt;p&gt;/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/694/#comment3168&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/#comment3168&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Should this be inside the update lock?  If many threads, each will create a writer?  Or is thought that this is mostly single-threaded and that if multiple threads arrive here at same time, its unusual and just let each roll?&lt;/p&gt;



&lt;p&gt;/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/694/#comment3170&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/#comment3170&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Yeah, should this be inside the update lock so many concurrent threads don&apos;t all create instances of these streams?&lt;/p&gt;



&lt;p&gt;/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/694/#comment3172&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/#comment3172&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Yes, this should be outside of the sync block.&lt;/p&gt;



&lt;p&gt;/trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/694/#comment3171&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/#comment3171&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Yeah, is this safe?  If two threads come in here at same time, they proceed in series but when the second gets to here he&apos;s going to claim he rolled the wrong old file?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;stack&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12900915" author="hbasereviewboard" created="Fri, 20 Aug 2010 23:31:46 +0000"  >&lt;p&gt;Message from: stack@duboce.net&lt;/p&gt;

&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/694/#review980&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/#review980&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Ship it!&lt;/p&gt;


&lt;p&gt;OK&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;stack&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12900918" author="hbasereviewboard" created="Fri, 20 Aug 2010 23:37:21 +0000"  >&lt;p&gt;Message from: &quot;Jean-Daniel Cryans&quot; &amp;lt;jdcryans@apache.org&amp;gt;&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-08-20 16:08:22, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; /trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java, line 449&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/694/diff/2/?file=7677#file7677line449&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/diff/2/?file=7677#file7677line449&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     This is an invariant?  Will multiple threads arriving here at same time pickup same filenum?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Can&apos;t have multiple threads there, it&apos;s under this.cacheFlushLock.lock();&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-08-20 16:08:22, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; /trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java, line 452&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/694/diff/2/?file=7677#file7677line452&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/diff/2/?file=7677#file7677line452&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Should this be inside the update lock?  If many threads, each will create a writer?  Or is thought that this is mostly single-threaded and that if multiple threads arrive here at same time, its unusual and just let each roll?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Still under this.cacheFlushLock.lock();&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-08-20 16:08:22, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; /trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java, line 457&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/694/diff/2/?file=7677#file7677line457&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/diff/2/?file=7677#file7677line457&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Yeah, should this be inside the update lock so many concurrent threads don&apos;t all create instances of these streams?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Still under this.cacheFlushLock.lock();&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2010-08-20 16:08:22, stack wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; /trunk/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLog.java, line 682&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;http://review.cloudera.org/r/694/diff/2/?file=7677#file7677line682&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/diff/2/?file=7677#file7677line682&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Yeah, is this safe?  If two threads come in here at same time, they proceed in series but when the second gets to here he&apos;s going to claim he rolled the wrong old file?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Still under this.cacheFlushLock.lock();&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Jean-Daniel&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;http://review.cloudera.org/r/694/#review976&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://review.cloudera.org/r/694/#review976&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


</comment>
                            <comment id="12900921" author="jdcryans" created="Fri, 20 Aug 2010 23:43:18 +0000"  >&lt;p&gt;Patch that was +1ed and that I&apos;m committing.&lt;/p&gt;</comment>
                            <comment id="12900942" author="jdcryans" created="Sat, 21 Aug 2010 00:27:26 +0000"  >&lt;p&gt;Committed to trunk&lt;/p&gt;</comment>
                            <comment id="15016999" author="lars_francke" created="Fri, 20 Nov 2015 12:41:31 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12452682" name="HBASE-2922-v2.patch" size="5281" author="jdcryans" created="Fri, 20 Aug 2010 23:43:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Aug 2010 01:11:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32834</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hjuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100477</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>