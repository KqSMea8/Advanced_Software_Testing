<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 18:57:22 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1910/HBASE-1910.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1910] IndexedRegion RPC deadlock</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1910</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;From Tatsuya Kawano up on hbase-user@&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;50 client threads who try to put millions of records, autoFlush(false), flushCommits() on every 5,000 put. After inserting about 3 million records, a deadlock occurred on a region server who has both the table and index regions loaded.&lt;/p&gt;

&lt;p&gt;I have attached a full thread dump of the deadlocked region server, and you can see IPC Server handlers are blocked in org.apache.hadoop.hbase.regionserver.tableindexed.IndexedRegion.updateIndex().&lt;/p&gt;

&lt;p&gt;I found the flowing FIXME comment on updateIndex() method, and it seems this is the deadlock I&apos;m having.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-comment&quot;&gt;// FIXME: This call takes place in an RPC, and requires an RPC. This makes &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;
&lt;/span&gt;  &lt;span class=&quot;code-comment&quot;&gt;// a likely deadlock &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the number of RPCs we are trying to serve is &amp;gt;= the
&lt;/span&gt;  &lt;span class=&quot;code-comment&quot;&gt;// number of handler threads.
&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void updateIndex(IndexSpecification indexSpec, &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] row,
      SortedMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[], &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[]&amp;gt; columnValues) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I use HBase 0.20.1 and my region servers were running with 10 RPC handler threads on each (default).&lt;/p&gt;

&lt;p&gt;Maybe you can workaround this by adding more RPC handlers (increase the value of &quot;hbase.regionserver.handler.count&quot; in hbase-site.xml)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Opening this issue to track the FIXME.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12438262">HBASE-1910</key>
            <summary>IndexedRegion RPC deadlock</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Oct 2009 01:31:31 +0000</created>
                <updated>Sun, 5 Jun 2011 09:46:59 +0000</updated>
                            <resolved>Sun, 5 Jun 2011 09:46:58 +0000</resolved>
                                    <version>0.20.1</version>
                    <version>0.90.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12766368" author="ryanobjc" created="Fri, 16 Oct 2009 01:34:14 +0000"  >&lt;p&gt;I doubt we could fix this in 0.20.x, (especially not in 0.20.1), since it would require a completely different RPC architecture....&lt;/p&gt;

&lt;p&gt;I think this might be fixable in 0.22.&lt;/p&gt;</comment>
                            <comment id="12766369" author="apurtell" created="Fri, 16 Oct 2009 01:39:05 +0000"  >&lt;p&gt;Attached thread dump provided by user for reference.&lt;/p&gt;</comment>
                            <comment id="12969004" author="stack" created="Tue, 7 Dec 2010 21:30:48 +0000"  >&lt;p&gt;indexed has been removed from hbase. &lt;/p&gt;</comment>
                            <comment id="13044481" author="ghelmling" created="Sun, 5 Jun 2011 09:45:59 +0000"  >&lt;p&gt;Re-opening to fix up resolution and fix version&lt;/p&gt;</comment>
                            <comment id="13044482" author="ghelmling" created="Sun, 5 Jun 2011 09:46:59 +0000"  >&lt;p&gt;Re-resolving as won&apos;t fix since indexed is moved out.  Also dropping fix version &amp;#8211; we shouldn&apos;t be showing this against 0.92.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12455264">HBASE-2182</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12422313" name="thread.dump.gz" size="4374" author="apurtell" created="Fri, 16 Oct 2009 01:39:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 16 Oct 2009 01:34:14 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26053</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 28 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hfun:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99830</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>