<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:21:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4682/HBASE-4682.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4682] Support deleted rows using Import/Export</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4682</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Parent allows keeping deleted rows around. Would be nice if those could be exported and imported as well.&lt;br/&gt;
All the building blocks are there.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12528978">HBASE-4682</key>
            <summary>Support deleted rows using Import/Export</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12525597">HBASE-4536</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lhofhansl">Lars Hofhansl</assignee>
                                    <reporter username="lhofhansl">Lars Hofhansl</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Oct 2011 22:03:22 +0000</created>
                <updated>Fri, 12 Oct 2012 05:35:10 +0000</updated>
                            <resolved>Thu, 8 Dec 2011 23:27:32 +0000</resolved>
                                    <version>0.94.0</version>
                                    <fixVersion>0.94.0</fixVersion>
                                    <component>mapreduce</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13164859" author="lhofhansl" created="Thu, 8 Dec 2011 00:03:42 +0000"  >&lt;p&gt;Have a patch for this in place, will test a bit. Change will be simple (all the heavy lifting is in parent).&lt;/p&gt;</comment>
                            <comment id="13165029" author="lhofhansl" created="Thu, 8 Dec 2011 06:34:22 +0000"  >&lt;p&gt;Straight forward patch.&lt;/p&gt;

&lt;p&gt;I found there&apos;s actually a bug in the Scan(Scan) constructor, which did not copy the passed Scan&apos;s attributes.&lt;/p&gt;

&lt;p&gt;Will add some tests soon, but want to get a test run in tonight.&lt;/p&gt;</comment>
                            <comment id="13165048" author="yuzhihong@gmail.com" created="Thu, 8 Dec 2011 06:54:07 +0000"  >&lt;p&gt;In the new Delete ctor, row key should be included in the IOE. &lt;/p&gt;</comment>
                            <comment id="13165057" author="hadoopqa" created="Thu, 8 Dec 2011 07:26:48 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12506578/4682-v1.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12506578/4682-v1.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -160 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 74 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/474//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/474//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/474//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/474//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/474//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/474//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13165060" author="lhofhansl" created="Thu, 8 Dec 2011 07:30:00 +0000"  >&lt;p&gt;@Ted: Will add that. Also instead of ignoring TableInputFormat.SCAN_COLUMN_FAMILY when keep deleted cells is specified, I should probably just let is pass, and have it fail with a IOException soon after.&lt;/p&gt;</comment>
                            <comment id="13165458" author="lhofhansl" created="Thu, 8 Dec 2011 19:21:10 +0000"  >&lt;p&gt;I did some more testing with this and everything works fine.&lt;br/&gt;
Apparently there are no tests for import/export anywhere, so I am adding a test for existing functionality as well.&lt;/p&gt;</comment>
                            <comment id="13165582" author="lhofhansl" created="Thu, 8 Dec 2011 21:28:19 +0000"  >&lt;p&gt;Addressed Ted&apos;s comment.&lt;br/&gt;
Added an Import/Export test (there were NO tests for Import/Export before)&lt;/p&gt;</comment>
                            <comment id="13165589" author="stack" created="Thu, 8 Dec 2011 21:36:11 +0000"  >&lt;p&gt;Nice test.  For sure its medium sized?   Takes &amp;lt; 50 seconds?&lt;/p&gt;

&lt;p&gt;This bit seems a little messy:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-        put.add(kv);
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (kv.isDelete()) {
+          context.write(key, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Delete(kv));
+        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
+          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (put == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) { 
+            put = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Put(key.get());
+          }
+          put.add(kv);
+        }
       }
-      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; put;
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (put != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+        context.write(key, put);
+      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We write the context if its a delete but if a put, we make a put instance and then do the context.write later... can they not both do context.write in same place or share the context.write invocation (if context.write takes a Mutation).&lt;/p&gt;</comment>
                            <comment id="13165606" author="lhofhansl" created="Thu, 8 Dec 2011 21:53:26 +0000"  >&lt;p&gt;Heh... It takes 46 secs on my machine. Can make it large, too.&lt;/p&gt;

&lt;p&gt;As for the messy-ness... The problem is that Delete has strange rules as what you can do in a single Delete (when you add a deleteFamily all prior deleteColumn(s) are removed, etc). So deletes have to be written one-by-one to be correct (that is also why I added the Delete(kv) constructor, rather than an delete(kv) method).&lt;/p&gt;

&lt;p&gt;A put, on the other hand, allows adding all put-related KVs of the same row into a single Put object. That&apos;s why delete-kvs are issued immediately, and put-kvs are collected into a single Put (that&apos;s also what the existing code does).&lt;br/&gt;
It is possible that particular row only has delete markers, so the Put is created when needed, and only written to the HBase when there were any put-kvs.&lt;/p&gt;</comment>
                            <comment id="13165621" author="stack" created="Thu, 8 Dec 2011 22:09:38 +0000"  >&lt;p&gt;Thanks for explaination.  +1 on commit.&lt;/p&gt;</comment>
                            <comment id="13165631" author="hadoopqa" created="Thu, 8 Dec 2011 22:23:01 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12506658/4682-v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12506658/4682-v2.txt&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated -160 warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 74 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/476//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/476//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/476//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/476//artifact/trunk/patchprocess/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/476//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/476//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13165674" author="lhofhansl" created="Thu, 8 Dec 2011 23:27:32 +0000"  >&lt;p&gt;Committed to trunk&lt;/p&gt;</comment>
                            <comment id="13165679" author="lhofhansl" created="Thu, 8 Dec 2011 23:32:39 +0000"  >&lt;p&gt;Thanks for the review stack (I added comments to the pieces in Import)&lt;/p&gt;</comment>
                            <comment id="13165971" author="hudson" created="Fri, 9 Dec 2011 09:22:53 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2532 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2532/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2532/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4682&quot; title=&quot;Support deleted rows using Import/Export&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4682&quot;&gt;&lt;del&gt;HBASE-4682&lt;/del&gt;&lt;/a&gt; Support deleted rows using Import/Export (Lars H)&lt;/p&gt;

&lt;p&gt;larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/Delete.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/Scan.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/Export.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/Import.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/mapreduce/TestImportExport.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13166173" author="hudson" created="Fri, 9 Dec 2011 13:41:35 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #26 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/26/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/26/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4682&quot; title=&quot;Support deleted rows using Import/Export&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4682&quot;&gt;&lt;del&gt;HBASE-4682&lt;/del&gt;&lt;/a&gt; Support deleted rows using Import/Export (Lars H)&lt;/p&gt;

&lt;p&gt;larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/Delete.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/client/Scan.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/Export.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/main/java/org/apache/hadoop/hbase/mapreduce/Import.java&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/test/java/org/apache/hadoop/hbase/mapreduce/TestImportExport.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12506578" name="4682-v1.txt" size="5900" author="lhofhansl" created="Thu, 8 Dec 2011 06:34:22 +0000"/>
                            <attachment id="12506658" name="4682-v2.txt" size="13699" author="lhofhansl" created="Thu, 8 Dec 2011 21:28:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 8 Dec 2011 06:54:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>214838</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08ql3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48907</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>