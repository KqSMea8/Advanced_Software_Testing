<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 20:12:02 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-10256/HBASE-10256.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-10256] Handling of value argument being null for checkAndDelete</title>
                <link>https://issues.apache.org/jira/browse/HBASE-10256</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;IMO, it would be more useful if when a null is supplied as the value for checkAndDelete, that it add the Delete marker if the row exists rather than if it doesn&apos;t exist (i.e. the opposite of checkAndPut). I think the most common use case for checkAndDelete is to delete a row if it exists and tell me that you deleted it. With the current implementation, it adds a Delete marker only if the row does not exist when you supply a null value which IMO is not very useful.&lt;/p&gt;

&lt;p&gt;My workaround is to add another &quot;known&quot; KeyValue to my row with a fixed value and then call checkAndDelete passing in this known value. Also, FWIW, if an empty byte array is passed through (a valid value), it treats it the same as if null was passed through, which is another separate bug.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12686702">HBASE-10256</key>
            <summary>Handling of value argument being null for checkAndDelete</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jamestaylor">James Taylor</reporter>
                        <labels>
                    </labels>
                <created>Sun, 29 Dec 2013 19:51:08 +0000</created>
                <updated>Wed, 1 Jan 2014 07:35:55 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13858419" author="jamestaylor" created="Sun, 29 Dec 2013 19:52:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; - another one for you that came up in my sequence implementation for Phoenix. This one is more of a nice-to-have, as I have a reasonable workaround.&lt;/p&gt;</comment>
                            <comment id="13858635" author="lhofhansl" created="Mon, 30 Dec 2013 07:34:15 +0000"  >&lt;p&gt;Not sure I follow. If you can issue a checkAndDelete you do have a row-key, right? In that case how is a checkAndDelete with a null value different from just a Delete?&lt;br/&gt;
In this case you have a row-key, but you do now know whether it actually exists?&lt;/p&gt;</comment>
                            <comment id="13858669" author="jamestaylor" created="Mon, 30 Dec 2013 08:57:32 +0000"  >&lt;p&gt;Here&apos;s my use case:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I have a row key&lt;/li&gt;
	&lt;li&gt;I want to delete the row&lt;/li&gt;
	&lt;li&gt;I want to know that the row existed when deleted so I can notify the client if it didn&apos;t.&lt;/li&gt;
	&lt;li&gt;I want to be able to do this with a single atomic call so I don&apos;t have a race condition.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I thought that if I provide a null for the value argument of a checkAndDelete, it would do the above, but it doesn&apos;t. I think this would be a better default behavior, as with the current behavior specifying a null for the value argument is not very useful. This can probably not be solved with the current API as it would break b/w compat, but perhaps a new API could be added down the road.&lt;/p&gt;</comment>
                            <comment id="13859193" author="lhofhansl" created="Tue, 31 Dec 2013 00:06:30 +0000"  >&lt;p&gt;I see. I think that could be accomplished if in addition to the value to be compared we&apos;d pass the compareOp, and then use != as compareOp, right?&lt;/p&gt;</comment>
                            <comment id="13859211" author="giacomotaylor@gmail.com" created="Tue, 31 Dec 2013 00:39:58 +0000"  >&lt;p&gt;Yes, that would work too.&lt;/p&gt;


</comment>
                            <comment id="13859213" author="lhofhansl" created="Tue, 31 Dec 2013 00:42:50 +0000"  >&lt;p&gt;I had started a long time ago on this in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5923&quot; title=&quot;Cleanup checkAndXXX logic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5923&quot;&gt;&lt;del&gt;HBASE-5923&lt;/del&gt;&lt;/a&gt;. Then ran into problems with the API and lost interest &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13859816" author="jamestaylor" created="Wed, 1 Jan 2014 01:19:50 +0000"  >&lt;p&gt;Another deficiency of this API - there&apos;s no way to specify the TimeRange that is used for the Get. Any operation that does a Get underneath (checkAndDelete, checkAndPut, Increment, IncrementColumnValue), should allow for a TimeRange to be passed through (Increment already supports this).&lt;/p&gt;</comment>
                            <comment id="13859818" author="lhofhansl" created="Wed, 1 Jan 2014 01:31:57 +0000"  >&lt;p&gt;Maybe the right solution is to just hand over a Get request. That can be setup with timerange, Filter, etc. If the Get returns anything update that row otherwise don&apos;t.&lt;/p&gt;

&lt;p&gt;(And now I&apos;m on my way to a new year&apos;s party &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; )&lt;/p&gt;</comment>
                            <comment id="13859845" author="jamestaylor" created="Wed, 1 Jan 2014 07:35:55 +0000"  >&lt;p&gt;One other change that would be useful. Instead of returning a boolean return a Long with null meaning that check failed and otherwise the Long represents the timestamp of the Delete (or Put). This conveys more information, as Phoenix caches based on the timestamp of the mutation. If we can get the actual timestamp (in the case where HConstants.LATEST_TIMESTAMP was used in the Delete/Put), then knowing the server timestamp is useful information. Without this, an extra round trip ends up being required later.&lt;/p&gt;

&lt;p&gt;FWIW, I&apos;ve been able to work around all these issues with region observers which is really nice. It&apos;s just more work than it needs to be, though. Plus I&apos;m not sure perf-wise if my Get/Put in the region observer will perform as well as the other methods (I suspect it&apos;s probably equivalent, though).&lt;/p&gt;

&lt;p&gt;Happy New Years!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 30 Dec 2013 07:34:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365695</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 50 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1r1br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>366002</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Phoenix</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>