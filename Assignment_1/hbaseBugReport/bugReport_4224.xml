<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 16 19:17:02 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-4224/HBASE-4224.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-4224] Need a flush by regionserver rather than by table option</title>
                <link>https://issues.apache.org/jira/browse/HBASE-4224</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;This evening needed to clean out logs on the cluster.  logs are by regionserver.  to let go of logs, we need to have all edits emptied from memory.  only flush is by table or region.  We need to be able to flush the regionserver.  Need to add this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12519246">HBASE-4224</key>
            <summary>Need a flush by regionserver rather than by table option</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="3" iconUrl="https://issues.apache.org/jira/images/icons/statuses/inprogress.png" description="This issue is being actively worked on at the moment by the assignee.">In Progress</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="thehellmaker">Akash Ashok</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Aug 2011 06:48:08 +0000</created>
                <updated>Tue, 6 Jan 2015 16:18:41 +0000</updated>
                                                                            <component>shell</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13086843" author="stack" created="Thu, 18 Aug 2011 07:04:25 +0000"  >&lt;p&gt;We need by regionserver because doing it by table, its not possible to control how much flush is done.  Imagine cluster has one table only.  If you flush it, then all regionservers all flush at same time killing any other server going on concurrently because of the i/o load on hdfs.  If you could do it by regionserver, you&apos;d have some means of doing other than a big-bang flush, and so on.&lt;/p&gt;</comment>
                            <comment id="13086846" author="stack" created="Thu, 18 Aug 2011 07:16:08 +0000"  >&lt;p&gt;An important bit I left off the top is that this &apos;flush by regionserver&apos; needs to also clean up WAL logs too after the flushing is done.  If everything has been flushed, then should be able to clean up any outstanding WAL logs.&lt;/p&gt;

&lt;p&gt;Scenario is the following. Your hosting service tells you that they are going to do a risky operation that could cause you to lose network connectivity or power to your racks.  You know that a disaster may be coming and you want to mitigate the damage.&lt;/p&gt;

&lt;p&gt;A facility that flushed and cleaned up all WAL logs by the regionserver (so could throttle i/o) so if bad crash there is little to replay is what I&apos;m talking about here.&lt;/p&gt;</comment>
                            <comment id="13086862" author="stack" created="Thu, 18 Aug 2011 07:39:05 +0000"  >&lt;p&gt;I&apos;m seeing that a script that flushes all tables on the cluster does not bring on a log cleanup when expectation is that it should.&lt;/p&gt;</comment>
                            <comment id="13086867" author="stack" created="Thu, 18 Aug 2011 07:50:46 +0000"  >&lt;p&gt;We need a means of forcing a roll of wal log.  That&apos;ll bring on check for whether we can let go of any old WALs.&lt;/p&gt;</comment>
                            <comment id="13096584" author="thehellmaker" created="Sat, 3 Sep 2011 05:31:03 +0000"  >&lt;p&gt;Hey Stack,&lt;br/&gt;
I would actually like to work on this. I don&apos;t know If I am able to grasp the true gravity and understand how big a problem this is or even If I am equipped enough to handle this. But with a little help I could work on this. &lt;/p&gt;

&lt;p&gt;Please let me know.&lt;/p&gt;</comment>
                            <comment id="13096799" author="stack" created="Sun, 4 Sep 2011 03:22:20 +0000"  >&lt;p&gt;@Akash Thanks for volunteering.  I don&apos;t think this one too hard to do.  You&apos;ll be able to figure it.  Study what happens when you flush in the shell.  See how it passes a command to the master.  In master, see how it fans it out by region or by table.  I think whats needed is a flush command that takes a machine name.  The shell code would figure distingush the flush of a region or table from a flush of a regionserver (a bit of regexing should be able to distingush whats wanted &amp;#8211; I&apos;d imagine the flush a machine would take a ServerName; i.e. &amp;lt;hostname&amp;gt; &apos;,&apos; &amp;lt;port&amp;gt; &apos;,&apos; &amp;lt;startcode&amp;gt;).  The flush of a regionserver would require adding a new API to HRegionInterface I&apos;d imagine.  It&apos;d flush all regions on the regionserver.  Then on the end, after all flushed, it&apos;d run the check if we can let go of WAL logs.  This method currently is checked on WAL log roll.  See in the HLog under the wal package.  Ask questions if you help figuring stuff.  Thanks Akash.&lt;/p&gt;</comment>
                            <comment id="13100437" author="thehellmaker" created="Thu, 8 Sep 2011 16:39:36 +0000"  >&lt;p&gt;Thanks Stack. I&apos;ll start workin on it then.&lt;/p&gt;</comment>
                            <comment id="13132305" author="thehellmaker" created="Fri, 21 Oct 2011 03:33:55 +0000"  >&lt;p&gt;This one had totally slipped my mind. I&apos;ll start workin on this right away &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13133320" author="thehellmaker" created="Sat, 22 Oct 2011 08:52:03 +0000"  >&lt;p&gt;My assumption is that I&apos;d do a logRoll after &quot;Table Flush&quot; or &quot;Region Server Flush&quot; and not for a &quot;Ragion Flush&quot; . For &quot;Region Server Flush&quot; I&apos;d roll the logs if there has been atleast one successful &quot;RegionFlush&quot;.&lt;/p&gt;

&lt;p&gt;I&apos;d presume that&apos;s a fair assumption. Please do let me know in case of any concerns.&lt;/p&gt;</comment>
                            <comment id="13133899" author="thehellmaker" created="Mon, 24 Oct 2011 08:50:53 +0000"  >&lt;p&gt;This is not tested completly. I&apos;m yet to do a complete round of testing and write test cases. &lt;br/&gt;
I&apos;ve attached the patch so that If there are any review comments I could incorporate them.&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;</comment>
                            <comment id="13134355" author="yuzhihong@gmail.com" created="Mon, 24 Oct 2011 18:55:42 +0000"  >&lt;p&gt;Overall, patch looks good.&lt;/p&gt;

&lt;p&gt;A better name for getRegionServerPairs() would be getRegionServerPairsForTable().&lt;br/&gt;
The LOG.info() in isValidRegionServerPair() should be LOG.debug(). Also, offline region isn&apos;t covered in the log message.&lt;/p&gt;

&lt;p&gt;There are some formatting improvements, such as:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(flush(serverName, pair.getFirst())) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;There should be a space between if and (.&lt;/p&gt;

&lt;p&gt;Please also add support for this feature to hbase shell.&lt;/p&gt;</comment>
                            <comment id="13136040" author="thehellmaker" created="Wed, 26 Oct 2011 15:28:54 +0000"  >&lt;p&gt;Thanks Ted. I shall make those changes. &lt;/p&gt;

&lt;p&gt;I was testing a few more things and have a few queries&lt;/p&gt;

&lt;p&gt;As per the Javadoc the flush() method in HBaseAdmin is supposed to be asynchronous but its actually not.&lt;br/&gt;
   1. It might make sense to make this async for table flushes, where the regions on different Region Servers can be flushed simultaneously instead of waiting for each flush to complete.&lt;br/&gt;
   2. Same holds good for log rolling &lt;/p&gt;

&lt;p&gt;Also it might even make sense to have a method to flush a list of regions belonging to a particular region server to support table flushes, instead of making round trip to and from the server for every region.&lt;/p&gt;

&lt;p&gt;Does this sound reasonable ?&lt;/p&gt;

</comment>
                            <comment id="13136059" author="yuzhihong@gmail.com" created="Wed, 26 Oct 2011 16:00:07 +0000"  >&lt;p&gt;For #1 above, I think we should keep the current behavior. People may have become dependent on the current behavior.&lt;br/&gt;
For #2, we can introduce async log rolling.&lt;br/&gt;
For #3, supporting list of regions is nice to have.&lt;/p&gt;

&lt;p&gt;All new commands and parameters should be documented in respective .rb files.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13136066" author="stack" created="Wed, 26 Oct 2011 16:07:38 +0000"  >&lt;p&gt;On #1, sounds great.  Add a new API?&lt;br/&gt;
On #2, ditto.&lt;br/&gt;
On #3, that&apos;d be useful, for sure.&lt;/p&gt;</comment>
                            <comment id="13136093" author="thehellmaker" created="Wed, 26 Oct 2011 16:39:59 +0000"  >&lt;p&gt;For #1: I was thinking I&apos;d be better to incorporate withing the same flush() function instead of a new API. &lt;br/&gt;
Considering Ted&apos;s comment, It actually makes sense to retain the behavior, thus we could still have the same behavior for the flush() function but make sure it only exit after all the required regions have been flushed, by having waits within the function. That way we don&apos;t have to add a new API. The behavior would remain the same. Just that thing would be a little faster as flushes happen in parallel.&lt;/p&gt;</comment>
                            <comment id="13136128" author="yuzhihong@gmail.com" created="Wed, 26 Oct 2011 17:27:11 +0000"  >&lt;p&gt;That sounds good, Akash.&lt;/p&gt;</comment>
                            <comment id="13136858" author="thehellmaker" created="Thu, 27 Oct 2011 07:14:26 +0000"  >&lt;p&gt;Cool. Just taking a deeper look so that we make sure we&apos;re making the right decision &lt;/p&gt;

&lt;p&gt;1. New API &lt;br/&gt;
   -&amp;gt; Use of RegionServer side threading &lt;br/&gt;
   -&amp;gt; Synchronize on HBaseAdmin side using zookeeper &lt;br/&gt;
2. Existing API&lt;br/&gt;
   -&amp;gt; Threading on client side &lt;/p&gt;

&lt;p&gt;I am in favour of 2. Any suggestions or concerns ?&lt;/p&gt;</comment>
                            <comment id="13137180" author="thehellmaker" created="Thu, 27 Oct 2011 14:37:20 +0000"  >&lt;p&gt;Also in HBaseAdmin.java &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt;  &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[][] rollHLogWriter(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; serverName)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I don&apos;t find a need for this to be synchronized. These are anyways synchronized on the HLog side. Am I missing something here or can I remove &quot;synchronized&quot; ?&lt;/p&gt;</comment>
                            <comment id="13141451" author="jdcryans" created="Tue, 1 Nov 2011 18:39:10 +0000"  >&lt;p&gt;Regarding how flush currently works with HBA, I did this analysis a few months ago: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4198&quot; title=&quot;Harmonize HBA flush, compact and majorCompact&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4198&quot;&gt;&lt;del&gt;HBASE-4198&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;About this:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I don&apos;t find a need for this to be synchronized. These are anyways synchronized on the HLog side. Am I missing something here or can I remove &quot;synchronized&quot; ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Actually there are a few synchronized methods in HBA, and I have no clue why they are.&lt;/p&gt;</comment>
                            <comment id="13164130" author="thehellmaker" created="Wed, 7 Dec 2011 04:30:24 +0000"  >&lt;p&gt;I am done with the testing for this patch. But though when I was writing the test cases I could only think of one. Could some1 please help me out as to what different test cases should I be looking to cover for this patch ?&lt;/p&gt;
</comment>
                            <comment id="13164599" author="yuzhihong@gmail.com" created="Wed, 7 Dec 2011 18:33:13 +0000"  >&lt;p&gt;@Akash:&lt;br/&gt;
Do you have a newer patch ?&lt;br/&gt;
If so, please upload to this JIRA.&lt;/p&gt;</comment>
                            <comment id="13175433" author="thehellmaker" created="Fri, 23 Dec 2011 13:57:45 +0000"  >&lt;p&gt;2nd Version of Patch. Just looked into HBase-5041. Have to incorporate those changes too for better condition handling.&lt;/p&gt;</comment>
                            <comment id="13175461" author="zhihyu@ebaysf.com" created="Fri, 23 Dec 2011 15:15:08 +0000"  >&lt;p&gt;Just started looking at patch v2.&lt;br/&gt;
For HBaseAdmin.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.collect.Lists;
+&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.collect.Maps;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Dependency on third party jar shouldn&apos;t be introduced into client package.&lt;/p&gt;</comment>
                            <comment id="13175518" author="zhihyu@ebaysf.com" created="Fri, 23 Dec 2011 17:50:00 +0000"  >&lt;p&gt;Putting the diff on review board allows me to see the changes easily.&lt;br/&gt;
Please submit review request there.&lt;/p&gt;

&lt;p&gt;For ServerName.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * 2. post &amp;gt; 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The above should read &apos;port &amp;gt; 0&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isValid() {
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(StringUtils.isNotBlank(hostname) &amp;amp;&amp;amp; port &amp;gt; 0 &amp;amp;&amp;amp; startcode &amp;gt; 0)
+      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;A single return statement should be enough.&lt;/p&gt;

&lt;p&gt;For HBaseAdmin.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; ExecutorService executorService= Executors.newCachedThreadPool();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please give ExecutorService better name and add javadoc for it.&lt;/p&gt;</comment>
                            <comment id="13175520" author="zhihyu@ebaysf.com" created="Fri, 23 Dec 2011 17:55:42 +0000"  >&lt;p&gt;On review board, the white spaces are easy to see.&lt;br/&gt;
Please remove them.&lt;/p&gt;</comment>
                            <comment id="13175643" author="thehellmaker" created="Sat, 24 Dec 2011 02:47:55 +0000"  >&lt;p&gt;&quot;Dependency on third party jar shouldn&apos;t be introduced into client package.&quot;&lt;br/&gt;
We already have dependency on Apache Commons for logging. When we run HBase admin its usually through the HBaseor hadoop command which anyways load the libs into the environment right? So I presume it should be ok ?&lt;/p&gt;

&lt;p&gt;I shall post to the review board. Thanks.&lt;/p&gt;</comment>
                            <comment id="13175649" author="zhihyu@ebaysf.com" created="Sat, 24 Dec 2011 03:30:28 +0000"  >&lt;p&gt;com.google.common.collect isn&apos;t Apache Commons. No dependency on additional third party jar should be introduced.&lt;/p&gt;</comment>
                            <comment id="13175655" author="thehellmaker" created="Sat, 24 Dec 2011 04:24:27 +0000"  >&lt;p&gt;Com.google.common.collect is guava I know, but what I meant to say is that ApacheCommons itself is a third party jar with respect to HBase. Is there any particular reason why we shouldn&apos;t add additional third party dependencies other than the fact that its a client side code ?&lt;/p&gt;

&lt;p&gt;Let me give an example:&lt;br/&gt;
Assume we are using HBaseAdmin in our code to create a table. Now to run this code we need to add dependency on HBase*.jar. Now since there&apos;s a dependency on apache commons logging so this additional step of adding this into your classpath is anyways already there, along with which u need to add one more dependency. &lt;/p&gt;

&lt;p&gt;Here since it&apos;s its basic usage of guava I could remove the dependency. But could you help me understand as to why this is to be done ?&lt;/p&gt;

</comment>
                            <comment id="13175657" author="jiraposter@reviews.apache.org" created="Sat, 24 Dec 2011 04:32:30 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3308/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Flush by RegionServer&lt;/p&gt;


&lt;p&gt;This addresses bug HBase-4224.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBase-4224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBase-4224&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  /src/main/java/org/apache/hadoop/hbase/ServerName.java 1222902 &lt;br/&gt;
  /src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java 1222902 &lt;br/&gt;
  /src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java 1222902 &lt;br/&gt;
  /src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1222902 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3308/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Akash&lt;/p&gt;
</comment>
                            <comment id="13175658" author="thehellmaker" created="Sat, 24 Dec 2011 04:33:04 +0000"  >&lt;p&gt;Have subbmitted on the review board. &lt;a href=&quot;https://reviews.apache.org/r/3308/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/&lt;/a&gt;.&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="13175844" author="jiraposter@reviews.apache.org" created="Sun, 25 Dec 2011 17:54:30 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3308/#review4116&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#review4116&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;Please give us some results from testing in cluster.&lt;/p&gt;


&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9269&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9269&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I think we should perform stricter checking on hostname, without using DNS.&lt;br/&gt;
    See &lt;a href=&quot;http://regexlib.com/DisplayPatterns.aspx?cattabindex=1&amp;amp;categoryId=2&amp;amp;AspxAutoDetectCookieSupport=1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://regexlib.com/DisplayPatterns.aspx?cattabindex=1&amp;amp;categoryId=2&amp;amp;AspxAutoDetectCookieSupport=1&lt;/a&gt;&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9270&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9270&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    The &apos;execute&apos; after &apos;the&apos; should be removed.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9271&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9271&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    The ctor with ThreadFactory parameter should be used so that threads in this pool can have names.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9272&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9272&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Second component should read &apos;all regions on a region server&apos;&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9273&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9273&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    serverRegionsMap might be null upon return.&lt;br/&gt;
    I don&apos;t see null check below.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9274&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9274&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Should read &apos;every region server&apos;&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9275&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9275&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Should read &apos;whose WAL&apos;&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9276&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9276&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I think Future.get(long timeout, TimeUnit unit) should be used here so that we don&apos;t wait indefinitely.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ted&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-12-24 04:31:50, Akash  Ashok wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/3308/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-12-24 04:31:50)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Flush by RegionServer&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug HBase-4224.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBase-4224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBase-4224&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3308/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Akash&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13176063" author="lhofhansl" created="Tue, 27 Dec 2011 02:00:26 +0000"  >&lt;p&gt;Sorry for coming late to this.&lt;/p&gt;

&lt;p&gt;It seems we&apos;re bundling two unrelated changes into the same issue:&lt;br/&gt;
1. flush per region server&lt;br/&gt;
2. asynchronous flush for tables (with tread pool in HBaseAdmin).&lt;/p&gt;

&lt;p&gt;I think these should be two separate issues.&lt;/p&gt;</comment>
                            <comment id="13176064" author="jiraposter@reviews.apache.org" created="Tue, 27 Dec 2011 02:02:30 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3308/#review4120&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#review4120&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;See minor comments inline.&lt;br/&gt;
Generally I don&apos;t understand why this change needs to be so big (but I haven&apos;t had time to look through the new code in detail, yet).&lt;/p&gt;


&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9293&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9293&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I would echo Ted&apos;s sentiment here that we shouldn&apos;t add more dependencies to the client side code.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9294&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9294&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Also, should only instantiate this pool when needed.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Lars&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2011-12-24 04:31:50, Akash  Ashok wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/3308/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-12-24 04:31:50)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Flush by RegionServer&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug HBase-4224.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBase-4224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBase-4224&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3308/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Akash&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13178176" author="zhihyu@ebaysf.com" created="Sun, 1 Jan 2012 15:30:25 +0000"  >&lt;p&gt;@Akash:&lt;br/&gt;
Can you address the review comments and upload a new patch ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13178216" author="jiraposter@reviews.apache.org" created="Sun, 1 Jan 2012 18:39:30 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-12-25 17:53:31, Ted Yu wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; /src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java, line 1392&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/diff/2/?file=65853#file65853line1392&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff/2/?file=65853#file65853line1392&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     I think Future.get(long timeout, TimeUnit unit) should be used here so that we don&apos;t wait indefinitely.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The flush would depend on the number of regions the Regions Server is hosting and ofcourse other system dependent factors. So how do we decide the timeouts. Secondly if the get times out then that RegionServer&apos;s WAL will not be rolled, as the logic to roll is on the client side currently. Could move this to server side so that roll happens after a flush ?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Akash&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3308/#review4116&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#review4116&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-12-24 04:31:50, Akash  Ashok wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/3308/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-12-24 04:31:50)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Flush by RegionServer&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug HBase-4224.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBase-4224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBase-4224&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3308/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Akash&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13178259" author="zhihyu@ebaysf.com" created="Mon, 2 Jan 2012 02:10:58 +0000"  >&lt;p&gt;I searched 0.92 codebase for HBA.rollHLogWriter() and only found two references in test code.&lt;/p&gt;</comment>
                            <comment id="13178260" author="thehellmaker" created="Mon, 2 Jan 2012 02:27:50 +0000"  >&lt;p&gt;I was talking about the call to rollHLogWriter() from the HBA.flush() function. This call is made after the flush is successful. If we use Future.get(timeout). Then even if the flush is taking long time due to some reason it would time out and the log roll wouldn&apos;t happen. Should we move this to flush on the Region Server side so that even if the client doesn&apos;t want the roll happens after the flush finishes ?&lt;/p&gt;</comment>
                            <comment id="13178263" author="thehellmaker" created="Mon, 2 Jan 2012 02:55:37 +0000"  >&lt;p&gt;I&apos;m sorry It came out wrong. What I meant to ask is that&lt;br/&gt;
&quot;Should we move the call to Log Roll to the flush on the Region Server side so that even if the client times out the roll happens after the flush finishes ?&quot;&lt;/p&gt;</comment>
                            <comment id="13178265" author="zhihyu@ebaysf.com" created="Mon, 2 Jan 2012 03:03:58 +0000"  >&lt;p&gt;@Akash:&lt;br/&gt;
As Stack commented @ 04/Sep/11 03:22, we should be adding a new method to HRegionInterface.&lt;br/&gt;
In the patch, you have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      isRollWAL = regionServer.flushRegions(regions);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think your suggestion @ 02/Jan/12 02:55 resonates with Stack&apos;s comment. That is, the log roll should be carried out on region server side.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13178664" author="thehellmaker" created="Tue, 3 Jan 2012 08:21:50 +0000"  >&lt;p&gt;Coming back to the timeout on Future.get(), which can be so unpredictable, I feel it makes sense not to have a timeout and just let it be completly async and not wait for the flush to finish.&lt;/p&gt;</comment>
                            <comment id="13178839" author="zhihyu@ebaysf.com" created="Tue, 3 Jan 2012 17:28:02 +0000"  >&lt;p&gt;If you read Stack&apos;s comment again, you should find that it may not be necessary to use Future.get() since you should have a new method in HRegionInterface.&lt;/p&gt;</comment>
                            <comment id="13179216" author="thehellmaker" created="Wed, 4 Jan 2012 01:42:10 +0000"  >&lt;p&gt;Agreed Ted. But on the client side the method is still the same. Considering your concern regarding async flushes&lt;/p&gt;

&lt;p&gt;&quot;For #1 above, I think we should keep the current behavior. People may have become dependent on the current behavior.&quot;&lt;/p&gt;

&lt;p&gt;This behavior would change for table flushes too. Earlier they were sync flushes, now they becomes async if we remove Future.get().&lt;/p&gt;

&lt;p&gt;This was the reason why I revisited this issue.&lt;/p&gt;</comment>
                            <comment id="13179217" author="jdcryans" created="Wed, 4 Jan 2012 01:48:11 +0000"  >&lt;p&gt;There&apos;s already a jira opened for the async flushes and friends, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4198&quot; title=&quot;Harmonize HBA flush, compact and majorCompact&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4198&quot;&gt;&lt;del&gt;HBASE-4198&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Sync flush in my experience is useless. On a big enough table it takes hours to run and by the time it&apos;s done data might have been inserted already and other flushes might have run. Plus, compactions are still async.&lt;/p&gt;</comment>
                            <comment id="13179230" author="thehellmaker" created="Wed, 4 Jan 2012 02:04:56 +0000"  >&lt;p&gt;JD can we make &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4198&quot; title=&quot;Harmonize HBA flush, compact and majorCompact&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4198&quot;&gt;&lt;del&gt;HBASE-4198&lt;/del&gt;&lt;/a&gt; as sub-task of this as Its already included in the current patch ? &lt;/p&gt;</comment>
                            <comment id="13181456" author="jiraposter@reviews.apache.org" created="Fri, 6 Jan 2012 17:30:39 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2011-12-25 17:53:31, Ted Yu wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; /src/main/java/org/apache/hadoop/hbase/ServerName.java, line 277&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/diff/2/?file=65852#file65852line277&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff/2/?file=65852#file65852line277&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     I think we should perform stricter checking on hostname, without using DNS.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     See &lt;a href=&quot;http://regexlib.com/DisplayPatterns.aspx?cattabindex=1&amp;amp;categoryId=2&amp;amp;AspxAutoDetectCookieSupport=1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://regexlib.com/DisplayPatterns.aspx?cattabindex=1&amp;amp;categoryId=2&amp;amp;AspxAutoDetectCookieSupport=1&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I am assuming hostname can be either a DNS address or IPv4 address. Is IPv6 supported yet ?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Akash&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3308/#review4116&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#review4116&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2011-12-24 04:31:50, Akash  Ashok wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/3308/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2011-12-24 04:31:50)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Flush by RegionServer&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug HBase-4224.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBase-4224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBase-4224&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1222902 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3308/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Akash&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13181461" author="zhihyu@ebaysf.com" created="Fri, 6 Jan 2012 17:36:08 +0000"  >&lt;p&gt;Advice to HBase users is to turn off IPv6. e.g. see thread entitled &apos;hbase master is not starting @ 60010 on new ubutnu 11.04 system&apos; on user@hbase.&lt;/p&gt;

&lt;p&gt;You can leave a comment or TODO stating the need to revisit when IPv6 support is added.&lt;/p&gt;</comment>
                            <comment id="13181512" author="jiraposter@reviews.apache.org" created="Fri, 6 Jan 2012 18:49:39 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3308/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2012-01-06 18:48:11.359389)&lt;/p&gt;


&lt;p&gt;Review request for hbase.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Changes:&lt;br/&gt;
1. Stricter hostname checking in ServerName.java&lt;br/&gt;
2. Flushes made completly Async.&lt;br/&gt;
3. WAL Roll moved to HRegionServer.java only for RegionServer flushes&lt;br/&gt;
4. Executor Service with named ThreadFactory&lt;br/&gt;
5. Dependency on Google Guava removed&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Flush by RegionServer&lt;/p&gt;


&lt;p&gt;This addresses bug HBase-4224.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBase-4224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBase-4224&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  /src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java 1226330 &lt;br/&gt;
  /src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1226330 &lt;br/&gt;
  /src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java 1226330 &lt;br/&gt;
  /src/main/java/org/apache/hadoop/hbase/ServerName.java 1226330 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3308/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Akash&lt;/p&gt;
</comment>
                            <comment id="13182038" author="jiraposter@reviews.apache.org" created="Sat, 7 Jan 2012 17:29:38 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3308/#review4236&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#review4236&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9579&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9579&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Please enclose the assignment on line 292 in curly braces.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9580&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9580&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Since IPv4 support is built in, I suggest naming this method isValidHost.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9581&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9581&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why the extra line here ?&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9587&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9587&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I think threadPool is a better name for this field.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9582&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9582&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    I think Async is unnecessary here - that&apos;s what threads provide.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9584&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9584&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Why not call tableExists() directly ?&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9583&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9583&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Should include the actual name passed in exception message.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9585&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9585&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Should read &apos;Exception parsing server name&apos;&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9586&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9586&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Since serverToRegionsMap has been created, you can return serverToRegionsMap here.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9588&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9588&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    regions could be empty, right ?&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9589&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9589&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    This and flushAllRegions() are similar.&lt;br/&gt;
    Can we introduce just one new method which checks whether the list is empty to decide what to do ?&lt;br/&gt;
    i.e. move the check @ line 1403 of HBaseAdmin to the implementation of the new method.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9590&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9590&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Curly braces, please.&lt;/p&gt;



&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;br/&gt;
&amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/#comment9591&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#comment9591&lt;/a&gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;    Do we need to place a try/catch block around line 2795 ?&lt;br/&gt;
    Currently the first failure would stop subsequent flushes.&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ted&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 2012-01-06 18:48:11, Akash  Ashok wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/3308/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2012-01-06 18:48:11)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Flush by RegionServer&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug HBase-4224.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBase-4224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBase-4224&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java 1226330 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1226330 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java 1226330 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java 1226330 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3308/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Akash&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13182231" author="jiraposter@reviews.apache.org" created="Sun, 8 Jan 2012 14:49:38 +0000"  >

&lt;blockquote&gt;&lt;p&gt;On 2012-01-07 17:27:49, Ted Yu wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; /src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java, line 2794&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/diff/3/?file=66890#file66890line2794&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff/3/?file=66890#file66890line2794&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Do we need to place a try/catch block around line 2795 ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Currently the first failure would stop subsequent flushes.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ted this sounds good and we&apos;d want to surround it with a try catch. But then we&apos;d be masking those errors right? &lt;/p&gt;

&lt;p&gt;If I were the user and called flush through the shell, I&apos;d not only wanna know that all flushes didn&apos;t go successful but I&apos;d also want to know how many of them were unsuccessful and which region flushes failed due to what reason. So do you think it would be a good idea to return a status object which gives the client more information regarding the flushes ?&lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;On 2012-01-07 17:27:49, Ted Yu wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; /src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java, line 486&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/diff/3/?file=66889#file66889line486&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff/3/?file=66889#file66889line486&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     This and flushAllRegions() are similar.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     Can we introduce just one new method which checks whether the list is empty to decide what to do ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     i.e. move the check @ line 1403 of HBaseAdmin to the implementation of the new method.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is rather a flag defined on the client which means when the regions == null then u flush the entire RegionServer. IF we move this to the region server side then we&apos;d be making this an API level definition. I think flushAllRegions is more intuitive as a RegionServer API than an API which flushes the Region Server when the regions parameter is null. &lt;/p&gt;

&lt;p&gt;Assume a new person wants to flushAllRegions. flush(List&amp;lt;HRegionInfo&amp;gt; regions) tells him that hey I can flush a list of regions and unless he looks at the implementation or the javadoc he&apos;d miss the fact that this API can also flush all the regions. On the other hand flushAllRegions invites the person with open arms saying that hey i&apos;ll flush all the regions for you. &lt;/p&gt;



&lt;blockquote&gt;&lt;p&gt;On 2012-01-07 17:27:49, Ted Yu wrote:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; /src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java, line 1409&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt; &amp;lt;&lt;a href=&quot;https://reviews.apache.org/r/3308/diff/3/?file=66888#file66888line1409&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff/3/?file=66888#file66888line1409&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&amp;gt;     regions could be empty, right ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The only condition when regions could be empty is when the name to be flushed is a RegionServer and not a single Region or table.&lt;/p&gt;

&lt;p&gt;This is based on the presumption that MetaReader.getTableRegionsAndLocations doesn&apos;t return null regions and isRegionsName is null then it never executes the flush. &lt;/p&gt;

&lt;p&gt;So this is fine ?&lt;/p&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Akash&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/3308/#review4236&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/#review4236&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;


&lt;p&gt;On 2012-01-06 18:48:11, Akash  Ashok wrote:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This is an automatically generated e-mail. To reply, visit:&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/3308/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----------------------------------------------------------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;(Updated 2012-01-06 18:48:11)&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Review request for hbase.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Summary&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Flush by RegionServer&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;This addresses bug HBase-4224.&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBase-4224&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBase-4224&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diffs&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-----&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ipc/HRegionInterface.java 1226330 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java 1226330 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/client/HBaseAdmin.java 1226330 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;/src/main/java/org/apache/hadoop/hbase/ServerName.java 1226330 &lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/3308/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/3308/diff&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Testing&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;-------&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks,&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;Akash&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;/blockquote&gt;
</comment>
                            <comment id="13182234" author="zhihyu@ebaysf.com" created="Sun, 8 Jan 2012 15:30:55 +0000"  >&lt;p&gt;w.r.t. whether flushAllRegions() should be introduced into HRegionInterface. In your patch HBaseAdmin has this method:&lt;/p&gt;
{ocde}&lt;br/&gt;
private boolean flush(ServerName serverName, List&amp;lt;HRegionInfo&amp;gt; regions){ocde}
&lt;p&gt;which decides the scope of flushing by checking regions. I think this check can be performed on region server side.&lt;/p&gt;

&lt;p&gt;Your argument about javadoc makes sense. We should clearly document the functionality of the (single) new method added to HRegionInterface.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But then we&apos;d be masking those errors right?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Please refer to HRegion.bulkLoadHFiles() for example of buffering multiple IOE&apos;s:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ioes.size() != 0) {
        LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;There were IO errors when checking &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; bulk load is ok.  &quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;throwing exception!&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; MultipleIOException.createIOException(ioes);
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13182262" author="thehellmaker" created="Sun, 8 Jan 2012 18:26:25 +0000"  >&lt;p&gt;&quot;Your argument about javadoc makes sense. We should clearly document the functionality of the (single) new method added to HRegionInterface.&quot;&lt;/p&gt;

&lt;p&gt;What I meant to say was that it&apos;s easy enough to over look this functionality even with good amount of javadoc. I think it would make a lot of difference if we have this extra new method flushAllRegions(). &lt;/p&gt;

&lt;p&gt;I am just trying to understand if you see any issue with this new extra API being added on the Region Server ?&lt;/p&gt;

&lt;p&gt;+1 on the MultipleIOException. Thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. I like that class &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13182266" author="zhihyu@ebaysf.com" created="Sun, 8 Jan 2012 18:41:52 +0000"  >&lt;p&gt;I am not strongly opposed to adding a new method. &lt;br/&gt;
Comment from other committers is welcome. &lt;/p&gt;</comment>
                            <comment id="13184281" author="qwertymaniac" created="Wed, 11 Jan 2012 18:55:08 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Dropping by from the dev lists&#8230;, have not followed otherwise&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I&apos;d certainly like reading flushAllRegions() over flushRegions(null). Can we not also have it as a utility function in HRServer instead if HRI/f, if the interface changing is much to be worried about?&lt;/p&gt;</comment>
                            <comment id="13185244" author="jdcryans" created="Thu, 12 Jan 2012 21:21:24 +0000"  >&lt;p&gt;Not a fan of the patch, the first problem I see is that flushing a list of regions and keeping the handler open will trigger socket exceptions too easily when you have more than a handful of regions. Also it adds a lot of code.&lt;/p&gt;

&lt;p&gt;Unfortunately I don&apos;t have a better option in mind and the original problem seems sketchy to me. There&apos;s no easy way to tell when all flushes are done (as shown by the acrobatics of the latest patch) and currently flushes are done in sync with the client call. At this point I&apos;m of the opinion that we should just:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;add an async call to flush (that does what compact currently does).&lt;/li&gt;
	&lt;li&gt;add the functionality in HBA to request the flushing of all regions on one region server. It would call the RS x times and those calls would be quick since it just queues the flush request.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;You can then ask for the flush queue size through JMX (and I&apos;m sure there are other means) so that when you are close to one you call for the log roll. This last step could also be manual or scripted.&lt;/p&gt;</comment>
                            <comment id="14266330" author="clehene" created="Tue, 6 Jan 2015 16:18:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=saint.ack%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;saint.ack@gmail.com&quot;&gt;Stack&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thehellmaker&quot; class=&quot;user-hover&quot; rel=&quot;thehellmaker&quot;&gt;Akash Ashok&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdcryans&quot; class=&quot;user-hover&quot; rel=&quot;jdcryans&quot;&gt;Jean-Daniel Cryans&lt;/a&gt; is this still valid?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12508542" name="HBase-4224-v2.patch" size="22957" author="thehellmaker" created="Fri, 23 Dec 2011 13:57:44 +0000"/>
                            <attachment id="12500411" name="HBase-4224.patch" size="12751" author="thehellmaker" created="Mon, 24 Oct 2011 08:50:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 3 Sep 2011 05:31:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27227</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 49 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02cin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11629</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>